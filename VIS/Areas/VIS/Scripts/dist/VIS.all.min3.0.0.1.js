(()=>{var e={2839:()=>{!function(e,t){e.themeMgr=function(){function i(e){var t=document.documentElement,i=e.split("|");t.style.setProperty("--v-c-primary",i[0]),t.style.setProperty("--v-c-on-primary",i[1]),t.style.setProperty("--v-c-secondary",i[2]),t.style.setProperty("--v-c-on-secondary",i[3])}return{init:function(){var n=t("#vis_theme");if(n.on("click","div.vis-theme-rec",(function(e){i(t(e.currentTarget).data("color"))})),e.Application.theme&&""!=e.Application.theme)i(e.Application.theme);else{var a=n.find("div.vis-theme-rec");a.length>0&&i(t(a[0]).data("color"))}},applyTheme:i}}()}(VIS,jQuery)},2105:()=>{VIS=window.VIS||{},function(){function e(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var e=null,t=null,i=null,n=null,a=null,s=$('<div style="height:100%;width:100%;padding:15px"></div>');this.init=function(){var l='<div class="vis-testPanel-Div"><span class="vis-testPanel-Span">Name: </span><label class="vis-testPanel-Label" id="'+this.windowNo+'lblName"></label> </div><div class="vis-testPanel-Div"><span class="vis-testPanel-Span">Location: </span><label class="vis-testPanel-Label" id="'+this.windowNo+'lblLocation"></label> </div><div class="vis-testPanel-Div"><span class="vis-testPanel-Span">Business Partner: </span><label class="vis-testPanel-Label" id="'+this.windowNo+'lblBPartner"></label> </div><div class="vis-testPanel-Div"><span class="vis-testPanel-Span">Date Time: </span><label class="vis-testPanel-Label" id="'+this.windowNo+'lblDateTime"></label> </div><div class="vis-testPanel-Div"><span class="vis-testPanel-Span">Amount: </span><label class="vis-testPanel-Label" id="'+this.windowNo+'lblAmount"></label> </div>';s.append(l),e=s.find("#"+this.windowNo+"lblName"),t=s.find("#"+this.windowNo+"lblLocation"),i=s.find("#"+this.windowNo+"lblBPartner"),n=s.find("#"+this.windowNo+"lblDateTime"),a=s.find("#"+this.windowNo+"lblAmount")},this.getRoot=function(){return s},this.update=function(s){e.text(VIS.context.getWindowContext(this.windowNo,"Name"));try{var l="C_Location_ID",o=this.selectedRow[l.toLower()];(VIS.DisplayType.IsLookup(this.curTab.getField(l).getDisplayType())||VIS.DisplayType.Location==this.curTab.getField(l).getDisplayType())&&(o&&(o=this.curTab.getField(l.toLower()).lookup.getDisplay(o)),t.text(o)),o=null;l="C_BPartner_ID";o=this.selectedRow[l.toLower()],(VIS.DisplayType.IsLookup(this.curTab.getField(l).getDisplayType())||VIS.DisplayType.Location==this.curTab.getField(l).getDisplayType())&&(o&&(o=this.curTab.getField(l.toLower()).lookup.getDisplay(o)),i.text(o)),o=null,l="T_DateTime",VIS.DisplayType.IsDate(this.curTab.getField(l).getDisplayType())&&(o=this.curTab.getField(l).value,o=new Date(o).toLocaleString(),n.text(o)),o=null,l="T_Amount",o=this.selectedRow[l.toLower()],a.text(o)}catch(e){}},this.disposeComponent=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,e.remove(),e=null,t.remove(),t=null,i.remove(),i=null,n.remove(),n=null,a.remove(),a=null,s.remove(),s=null}}e.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init()},e.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.update(e)},e.prototype.sizeChanged=function(e){this.panelWidth=e},e.prototype.dispose=function(){this.disposeComponent()},VIS.TestPanel=e}()},3547:()=>{VIS=window.VIS||{},function(e,t){e.UploadAmountDimension=function(i,n){var a=null,s=[],l=[],o=0,r=0,d=Date.now().toString(),c=1048576,p=0,u=0,g=[],h=null;t(window).width(),t(window).height(),d=Date.now().toString();savedFileName="";var v=t("<div id='progress_bar' class='vis-ui-progress-bar vis-ui-container' style='top:40%;width: 40%;left: 32%;position:absolute;z-index:99999;'>"),f=null,m=null;this.isWait=!1,self=this;var y=function(t){if(null!=s&&0!=s.length){if(!(r>=s.length)){var i=new XMLHttpRequest,n=new FormData,l=s[r].name.substring(0,s[r].name.lastIndexOf("."))+d+s[r].name.substring(s[r].name.lastIndexOf("."));savedFileName=l,n.append("file",s[r].slice(u*c,u*c+Number(c))),i.open("POST",e.Application.contextUrl+"AmountDivision/SaveFileinTemp?fileName="+l+"&folderKey="+d+"&orgFileName="+s[r].name,!1),i.send(n),a=i.responseText,o++,u++;var g=parseInt(s[r].size/c);s[r].size%c>0&&g++,u==g&&(r++,u=0),o<=p&&D(parseInt(o/p*80)),window.setTimeout((function(){y()}),2)}}else I(!1)},I=function(e){if(t("body").find("#progressbar").remove(),e){f=t("<div class='vis-ui-progress' style='width: 0%; display: block;position:absolute;height: 35px;'>"),m=t("<span class='vis-ui-label'  style='position:absolute;left: 60%;top: 4px;'>").append("0%"),f.append(m),v.append(f);var i=t("<div id='progressbar' style='z-index: 999999;' class='VIS-AMTD-Busy-Progress'></div>");i.append(v),i.appendTo("<body>")}else t("body").find("progressbar").remove()},D=function(e){f.css("width",e+"%"),m.empty(),m.append(e+"%")};return this.getFolderKey=d,this.getSavedFileName=savedFileName,this.GetUploadedExcelColumns=function(){if(r>=s.length){var t=[],i=e.Application.contextUrl+"contextUrl/SaveAttachmentEntries";t.push({Files:JSON.stringify(g)}),t.push({FolderKey:d}),t.push({FileName:savedFileName}),t.push({Mapping:n});var a=e.ControllerRequestAjaxParameter1(i,t,!1);return n.ExcelCol=a.ExcelCol,n.FileName=a.FileName,a}},I(!0),function(t){for(var i=[],n=0;n<t.files.length;n++){if(null==(h=t.files[n]))return;if(h.size<=0)return s=[],l=[],o=0,r=0,d=null,c=null,p=0,u=0,g=[],h=null,e.ADialog.info("VADMS_FileSizeShouldGreaterThan0KB"),I(!1),!1;if(h.name.indexOf("&")>-1||h.name.indexOf("?")>-1||h.name.indexOf("#")>-1||h.name.indexOf("/")>-1||h.name.indexOf("\\")>-1)i.push(h.name);else{for(var a in s)if(h.name==s[a].name)return void window.setTimeout((function(){I(!1),e.ADialog.info("fileAlreadyAttached")}),20);if(null!=l)for(var a in l)if(h.name==l[a].Name&&!l[a].IsDeleted)return void window.setTimeout((function(){I(!1),e.ADialog.info("fileAlreadyAttached")}),20);var v={};v.Name=h.name,v.Size=h.size,s.push(h)}}if(i.length>0){var f="";for(var m in i)f+=i[m].toString()+"\n";1==i.length?f+="File has":f+="Files have",f+=" invalid name. Please change the file name and try again.",I(!1),e.ADialog.info("",!0,f)}}(i),function(){var e=null,t=0;for(var i in s)t=parseInt(s[i].size/c),h.size%c>0&&t++,p+=t,(e={}).Name=s[i].name,e.Size=s[i].size,g.push(e);y()}(),a}}(VIS,jQuery)},4869:()=>{!function(e,t){function i(i,n,a,s){this.onClose=null;var l=t("<div style='position:relative;'>"),o=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),r=this,d=i,c=n,p=a,u=e.Env.getWindowNo(),g=new e.Controls.VLabel,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=null,q=null,H=null,z=null,Q=null,J=!1,$=!1,K=!1,Y=!1,X=!1,Z=!1,ee=!1,te=!1,ie=!1,ne=e.Application.contextUrl,ae=ne+"JsonData/JDataSetWithCode",se=ne+"JsonData/ExecuteNonQuer",le=ne+"Form/JDataSet",oe=function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return de(s,a,(function(t){i=(new e.DB.DataSet).toJson(t);var i=(new e.DB.DataSet).toJson(t);l=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null,i.dispose(),i=null,a&&n(l)})),l},re=function(i,n,a){var s=!!a,l={sql:i,page:1,pageSize:0};n&&(l.param=n);var o=null;return function(i,n,a){var s=null;i.sql=e.secureEngine.encrypt(i.sql),t.ajax({url:le,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:n,data:JSON.stringify(i)}).done((function(e){s=e,a&&a(e)}))}(l,s,(function(t){o=(new e.DB.DataReader).toJson(t),a&&a(o)})),o};function de(e,i,n){var a=null;return t.ajax({url:ae,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){a=e,n&&n(e)})),a}this.log=e.Logging.VLogger.getVLogger("AccountForm"),this.log.config("C_AcctSchema_ID="+p+", C_ValidCombination_ID="+c.C_ValidCombination_ID);var ce="AC",pe="AY",ue="BP",ge="LF",he="LT",ve="MC",fe="OO",me="OT",ye="PJ",Ie="PR",De="SA",we="SR",be="U1",Ce="U2",_e="X1",Se="X2",xe="X3",Ae="X4",Te="X5",Ve="X6",Ne="X7",Me="X8",ke="X9",Oe=t("<table>");Oe.css("width","100%");var Le=t("<tr>"),Re=null,Ee=null,Pe=null,Ue=null,Fe=null,Be=null,We=null,je=null,Ge=null,qe=null,He=null,ze=null,Qe=null,Je=null,$e=null,Ke=null;this.load=function(){l.load(e.Application.contextUrl+"AccountForm/Index/?windowno="+u,(function(e){r.setBusy(!0),r.init(l),r.setBusy(!1)}))},this.setBusy=function(e){o.css("display",e?"block":"none")},this.init=function(i){function n(i,n,a,s,l){r.log.fine("Field="+i),Le=t("<tr>"),Oe.append(Le);var o=e.VControlFactory.getLabel(i);n.setReadOnly(!1),n.setMandatory(a),i.setPropertyChangeListener(n);var d=t("<td>");Le.append(d.css("padding","4px 0px 2px 0px")),d.append(o.getControl().addClass("VIS_Pref_Label_Font")),null==l||"X1"!=l&&"X2"!=l&&"X3"!=l&&"X4"!=l&&"X5"!=l&&"X6"!=l&&"X7"!=l&&"X8"!=l&&"X9"!=l||d.find("label").text(s),Le=t("<tr>"),Oe.append(Le);var c=t("<td>");if(n.getBtnCount()>=2){Le.append(c);var p=t("<Div class='vis-act-frm-parm'>");c.append(p),window.innerHeight>700?(p.append(n.getControl().css("width","85%")),p.append(n.getBtn(0))):(p.append(n.getControl().css("width","85%")),p.append(n.getBtn(0).css("width","30px").css("-webkit-appearance","none").css("height","30px").css("padding","0px").css("border-color","#BBBBBB")))}else Le.append(c),c.append(n.getControl().css("width","100%"))}function a(e){return null==e||0==e}function l(t){var i,n=null;(n=null!=He?jQuery.extend(!0,{},He):new e.Query,t&&null!=h&&h.getValue().toString().length>0)&&((i=h.getValue().toString().toUpperCase()).endsWith("%")||(i+="%"),n.addRestriction("UPPER(Alias)",n.LIKE,i));t&&v.getValue().toString().length>0&&((i=v.getValue().toString().toUpperCase()).endsWith("%")||(i+="%"),n.addRestriction("UPPER(Combination)",n.LIKE,i));null!=f&&null!=f.getValue()&&n.addRestriction("AD_Org_ID",n.EQUAL,e.Utility.Util.getValueOfInt(f.getValue())),null==m||a(m.getValue())||n.addRestriction("Account_ID",n.EQUAL,e.Utility.Util.getValueOfInt(m.getValue())),null==y||a(y.getValue())||n.addRestriction("C_SubAcct_ID",n.EQUAL,e.Utility.Util.getValueOfInt(y.getValue())),null==I||a(I.getValue())||n.addRestriction("M_Product_ID",n.EQUAL,e.Utility.Util.getValueOfInt(I.getValue())),null==D||a(D.getValue())||n.addRestriction("C_BPartner_ID",n.EQUAL,e.Utility.Util.getValueOfInt(D.getValue())),null==w||a(w.getValue())||n.addRestriction("C_Campaign_ID",n.EQUAL,e.Utility.Util.getValueOfInt(w.getValue())),null==b||a(b.getValue())||n.addRestriction("C_LocFrom_ID",n.EQUAL,e.Utility.Util.getValueOfInt(b.getValue())),null==C||a(C.getValue())||n.addRestriction("C_LocTo_ID",n.EQUAL,e.Utility.Util.getValueOfInt(C.getValue())),null==_||a(_.getValue())||n.addRestriction("C_Project_ID",n.EQUAL,e.Utility.Util.getValueOfInt(_.getValue())),null==S||a(S.getValue())||n.addRestriction("C_SalesRegion_ID",n.EQUAL,e.Utility.Util.getValueOfInt(S.getValue())),null==x||a(x.getValue())||n.addRestriction("AD_OrgTrx_ID",n.EQUAL,e.Utility.Util.getValueOfInt(x.getValue())),null==A||a(A.getValue())||n.addRestriction("C_Activity_ID",n.EQUAL,e.Utility.Util.getValueOfInt(A.getValue())),null==T||a(T.getValue())||n.addRestriction("User1_ID",n.EQUAL,e.Utility.Util.getValueOfInt(T.getValue())),null==V||a(V.getValue())||n.addRestriction("User2_ID",n.EQUAL,e.Utility.Util.getValueOfInt(V.getValue())),null==N||a(N.getValue())||n.addRestriction("UserElement1_ID",n.EQUAL,e.Utility.Util.getValueOfInt(N.getValue())),null==M||a(M.getValue())||n.addRestriction("UserElement2_ID",n.EQUAL,e.Utility.Util.getValueOfInt(M.getValue())),null==k||a(k.getValue())||n.addRestriction("UserElement3_ID",n.EQUAL,e.Utility.Util.getValueOfInt(k.getValue())),null==O||a(O.getValue())||n.addRestriction("UserElement4_ID",n.EQUAL,e.Utility.Util.getValueOfInt(O.getValue())),null==L||a(L.getValue())||n.addRestriction("UserElement5_ID",n.EQUAL,e.Utility.Util.getValueOfInt(L.getValue())),null==R||a(R.getValue())||n.addRestriction("UserElement6_ID",n.EQUAL,e.Utility.Util.getValueOfInt(R.getValue())),null==E||a(E.getValue())||n.addRestriction("UserElement7_ID",n.EQUAL,e.Utility.Util.getValueOfInt(E.getValue())),null==P||a(P.getValue())||n.addRestriction("UserElement8_ID",n.EQUAL,e.Utility.Util.getValueOfInt(P.getValue())),null==U||a(U.getValue())||n.addRestriction("UserElement9_ID",n.EQUAL,e.Utility.Util.getValueOfInt(U.getValue())),ze.setQuery(n),Ge.query(0,0,!1)}function o(){var i=null,n="",s=null;Ke.IsHasAlies&&null==(s=h.getValue())&&null!=i&&(i=i.concat(e.Msg.translate(e.Env.getCtx(),"Alias")).concat(", "));for(var l=[],o=0;o<Ke.Elements.length;o++){var c=Ke.Elements[o];l.push(c.Name)}if(t.ajax({url:e.Application.contextUrl+"AccountForm/GetValidCombination",dataType:"json",type:"POST",async:!1,data:{accountSchemaElements:JSON.stringify(Ke),Elements:JSON.stringify(Ke.Elements),aseList:JSON.stringify(l),value:s,strinB:i},success:function(e){n=e},error:function(e){console.log(e)}}),null==i)if(null!=f&&null!=f.getValue()){if(null==m||a(m.getValue()))return e.ADialog.info("FillMandatory",!0,e.Msg.getElement(e.Env.getCtx(),"Account_ID"),null),void r.setBusy(!1);n=n.concat("AD_Client_ID="+e.Env.getCtx().getAD_Client_ID()+" AND C_AcctSchema_ID="+p),r.log.fine("Check = "+n.toString());h.getValue().toString();var u=0,g=null,v=h.getValue().toString(),ne=null;try{(ne=re(n,null)).read()&&(u=ne.tables[0].rows[0].cells.c_validcombination_id,g=ne.tables[0].rows[0].cells.alias),ne.close(),ne=null}catch(e){u=0,null!=ne&&(ne.close(),ne=null)}if(r.log.fine("ID="+u+", Alias="+g),null==g&&(g=""),0!=u&&Ke.IsHasAlies&&v.equals(g)){var ae=[];0==v.toString().length?(n="VIS_127",ae[0]=new e.DB.SqlParam("@IDvalue",u)):(n="VIS_128",ae[0]=new e.DB.SqlParam("@f_alies",v),ae[1]=new e.DB.SqlParam("@IDvalue",u));o=0;try{!function(e,i,n){var a=!!n,s=null,l={sql:e,param:i};t.ajax({url:se+"yWithCode",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(l)}).done((function(e){s=e,n&&n(e)}))}(n,ae)}catch(e){}}if(0==u){r.log.config("New"),g=null,null!=h&&(g=h.getValue().toString());var le=0;null!=y&&null!=y.getValue()&&(le=y.getValue());var oe=0;null==I||a(I.getValue())||(oe=I.getValue());var de=0;null==D||a(D.getValue())||(de=D.getValue());var ce=0;null==x||a(x.getValue())||(ce=x.getValue());var pe=0;null==b||a(b.getValue())||(pe=b.getValue());var ue=0;null==C||a(C.getValue())||(ue=C.getValue());var ge=0;null==S||a(S.getValue())||(ge=S.getValue());var he=0;null==_||a(_.getValue())||(he=_.getValue());var ve=0;null==w||a(w.getValue())||(ve=w.getValue());var fe=0;null==A||a(A.getValue())||(fe=A.getValue());var me=0;null==T||a(T.getValue())||(me=T.getValue());var ye=0;null==V||a(V.getValue())||(ye=V.getValue());var Ie=0;null==N||a(N.getValue())||(Ie=N.getValue());var De=0;null==M||a(M.getValue())||(De=M.getValue());var we=0;null==k||a(k.getValue())||(we=k.getValue());var be=0;null==O||a(O.getValue())||(be=O.getValue());var Ce=0;null==L||a(L.getValue())||(Ce=L.getValue());var _e=0;null==R||a(R.getValue())||(_e=R.getValue());var Se=0;null==E||a(E.getValue())||(Se=E.getValue());var xe=0;null==P||a(P.getValue())||(xe=P.getValue());var Ae=0;null==U||a(U.getValue())||(Ae=U.getValue());var Te=f.getValue(),Ve=m.getValue();J&&null!=F&&(Ie=F),$&&null!=B&&(De=B),K&&null!=W&&(we=W),Y&&null!=j&&(be=j),X&&null!=G&&(Ce=G),Z&&null!=q&&(_e=q),ee&&null!=H&&(Se=H),te&&null!=z&&(xe=z),ie&&null!=Q&&(Ae=Q),t.ajax({url:e.Application.contextUrl+"AccountForm/Save",dataType:"json",data:{AD_Client_ID:e.Env.getCtx().getAD_Client_ID(),AD_Org_ID:Te,C_AcctSchema_ID:p,AD_Account_ID:Ve,C_SubAcct_ID:le,M_Product_ID:oe,C_BPartner_ID:de,AD_OrgTrx_ID:ce,C_LocFrom_ID:pe,C_LocTo_ID:ue,C_SRegion_ID:ge,C_Project_ID:he,C_Campaign_ID:ve,C_Activity_ID:fe,User1_ID:me,User2_ID:ye,UserElement1_ID:Ie,UserElement2_ID:De,UserElement3_ID:we,UserElement4_ID:be,UserElement5_ID:Ce,UserElement6_ID:_e,UserElement7_ID:Se,UserElement8_ID:xe,UserElement9_ID:Ae,Alias:g},success:function(e){returnValue=e.result,d(returnValue.C_ValidCombination_ID,returnValue.C_AcctSchema_ID)}})}else d(u,p)}else e.ADialog.info("FillMandatory",!0,e.Msg.getElement(e.Env.getCtx(),"AD_Org_ID"),null);else e.ADialog.info("FillMandatory",!0,i.ToString().Substring(0,i.Length-2),null)}function d(t,i){var n=null;try{var a=[];a[0]=new e.DB.SqlParam("@C_ValidCombination_ID",t),a[1]=new e.DB.SqlParam("@C_AcctSchema_ID",i),n=function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return de(s,a,(function(t){l=(new e.DB.DataReader).toJson(t),n&&n(l)})),l}("VIS_124",a),n.read()&&(null!=h&&h.setValue(n.getString("Alias")),null!=v&&v.setValue(n.getString("Combination")),null!=f&&f.setValue(n.getInt("AD_Org_ID")),null!=m&&m.setValue(n.getInt("Account_ID")),null!=y&&y.setValue(n.getInt("C_SubAcct_ID")),null!=I&&0!=n.getInt("M_Product_ID")&&I.setValue(n.getInt("M_Product_ID")),null!=D&&0!=n.getInt("C_BPartner_ID")&&D.setValue(n.getInt("C_BPartner_ID")),null!=w&&w.setValue(n.getInt("C_Campaign_ID")),null!=b&&b.setValue(n.getInt("C_LocFrom_ID")),null!=C&&C.setValue(n.getInt("C_LocTo_ID")),null!=_&&_.setValue(n.getInt("C_Project_ID")),null!=S&&S.setValue(n.getInt("C_SalesRegion_ID")),null!=x&&x.setValue(n.getInt("AD_OrgTrx_ID")),null!=A&&A.setValue(n.getInt("C_Activity_ID")),null!=T&&T.setValue(n.getInt("User1_ID")),null!=V&&V.setValue(n.getInt("User2_ID")),null!=N&&0!=n.getInt("UserElement1_ID")&&N.setValue(n.getInt("UserElement1_ID")),null!=M&&0!=n.getInt("UserElement2_ID")&&M.setValue(n.getInt("UserElement2_ID")),null!=k&&0!=n.getInt("UserElement3_ID")&&k.setValue(n.getInt("UserElement3_ID")),null!=O&&0!=n.getInt("UserElement4_ID")&&O.setValue(n.getInt("UserElement4_ID")),null!=L&&0!=n.getInt("UserElement5_ID")&&L.setValue(n.getInt("UserElement5_ID")),null!=R&&0!=n.getInt("UserElement6_ID")&&R.setValue(n.getInt("UserElement6_ID")),null!=E&&0!=n.getInt("UserElement7_ID")&&E.setValue(n.getInt("UserElement7_ID")),null!=P&&0!=n.getInt("UserElement8_ID")&&P.setValue(n.getInt("UserElement8_ID")),null!=U&&0!=n.getInt("UserElement9_ID")&&U.setValue(n.getInt("UserElement9_ID")),null!=$e&&$e.text(n.getString("Description"))),n.close(),n=null}catch(e){null!=n&&(n.close(),n=null)}l(!1)}Re=i.find("#btnOk_"+u),Ee=i.find("#btnCancel_"+u),Pe=i.find("#btnRefresh_"+u),Ue=i.find("#btnUndo_"+u),Fe=i.find("#btnSave_"+u),Be=i.find("#lblParameter_"+u),We=i.find("#parameterDiv_"+u),i.find("#bottumDiv_"+u),i.find("#discriptionDiv_"+u),je=i.find("#accDiv_"+u),i.find("#acctbl_"+u),Qe=i.find("#lblbottumMsg_"+u),Je=i.find("#lblCount_"+u),$e=i.find("#lblbottumMsg2_"+u),e.Application.isRTL&&(Re.css("margin-right","-128px"),Ee.css("margin-right","55px")),Re.val(e.Msg.getMsg("OK")),Ee.val(e.Utility.Util.cleanMnemonic(e.Msg.getMsg("Cancel"))),Be.val(e.Msg.getMsg("Parameter")),e.Env.getCtx().setContext(u,"C_AcctSchema_ID",p),t.ajax({url:e.Application.contextUrl+"AccountForm/LoadControls",dataType:"json",data:{windowNo:u,C_AcctSchema_ID:p},success:function(i){var a,l;returnValue=i.result,a=returnValue,l=153,e.AEnv.getGridWindow(u,l,(function(i){if(null!=i.error)return e.ADialog.error(i.error),self.dispose(),void(self=null);var l=JSON.parse(i.result);e.context.setContextOfWindow(JSON.parse(i.wCtx),u);var o=new e.GridWindow(l);if(null!=o){(ze=o.getTabs()[0]).getField("Alias").setDisplayLength(15),ze.getField("Combination").setDisplayLength(15),ze.getField("AD_Client_ID").setDisplayed(!1),ze.getField("C_AcctSchema_ID").setDisplayed(!1),ze.getField("IsActive").setDisplayed(!1),ze.getField("IsFullyQualified").setDisplayed(!1);for(var d=0;d<ze.getFieldCount();d++)(Ee=ze.getField(d)).getIsDisplayed(!0)||Ee.setDisplayed(!1);var g=u+"_"+p;if((Ge=new e.GridController(!1,!1,g)).initGrid(!0,u,r,ze),Ge.setVisible(!0),window.innerHeight>700?Ge.sizeChanged(window.innerHeight-230,window.innerWidth):Ge.sizeChanged(window.innerHeight-215,window.innerWidth),je.append(Ge.getRoot()),Ge.activate(),a.IsHasAlies){var ne=ze.getField("Alias");n(ne,h=e.VControlFactory.getControl(ze,ne,!1),!1)}var ae,se=ze.getField("Combination");for(n(se,v=e.VControlFactory.getControl(ze,se,!1),!1),d=0;d<a.Elements.length;d++){var le=returnValue.Elements[d].Type,re=returnValue.Elements[d].IsMandatory,de=returnValue.Elements[d].IsHeavyData,Le=returnValue.Elements[d].Name;if(le.equals(fe)){function Re(){var t=f.getValue();e.Env.getCtx().setContext(u,"AcctOrg_ID",t)}n(Ee=ze.getField("AD_Org_ID"),f=e.VControlFactory.getControl(ze,Ee,!1),re,Le,fe),f.fireValueChanged=Re}else if(le.equals(ce)){var Ee=ze.getField("Account_ID");(m=e.VControlFactory.getControl(ze,Ee,!1)).setValue(p),n(Ee,m,re,Le,ce)}else if(le.equals(De))n(Ee=ze.getField("C_SubAcct_ID"),y=e.VControlFactory.getControl(ze,Ee,!1),re,Le,De);else if(le.equals(Ie))Ee=ze.getField("M_Product_ID"),(I=e.VControlFactory.getControl(ze,Ee,!1)).getBtn(),n(Ee,I,re,Le,Ie);else if(le.equals(ue))n(Ee=ze.getField("C_BPartner_ID"),D=e.VControlFactory.getControl(ze,Ee,!1),re,Le,ue);else if(le.equals(ve))n(Ee=ze.getField("C_Campaign_ID"),w=e.VControlFactory.getControl(ze,Ee,!1),re,Le,ve);else if(le.equals(ge))n(Ee=ze.getField("C_LocFrom_ID"),b=e.VControlFactory.getControl(ze,Ee,!1),re,Le,ge);else if(le.equals(he))n(Ee=ze.getField("C_LocTo_ID"),C=e.VControlFactory.getControl(ze,Ee,!1),re,Le,he);else if(le.equals(ye))n(Ee=ze.getField("C_Project_ID"),_=e.VControlFactory.getControl(ze,Ee,!1),re,Le,ye);else if(le.equals(we))n(Ee=ze.getField("C_SalesRegion_ID"),S=e.VControlFactory.getControl(ze,Ee,!1),re,Le,we);else if(le.equals(me))n(Ee=ze.getField("AD_OrgTrx_ID"),x=e.VControlFactory.getControl(ze,Ee,!1),re,Le,me);else if(le.equals(pe))n(Ee=ze.getField("C_Activity_ID"),A=e.VControlFactory.getControl(ze,Ee,!1),re,Le,pe);else if(le.equals(be))n(Ee=ze.getField("User1_ID"),T=e.VControlFactory.getControl(ze,Ee,!1),re,Le,be);else if(le.equals(Ce))n(Ee=ze.getField("User2_ID"),V=e.VControlFactory.getControl(ze,Ee,!1),re,Le,Ce);else if(le.equals(_e)){if(Ee=ze.getField("UserElement1_ID"),!(a.Elements[d].AD_Column_ID>0))continue;var Pe="VIS_125";(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID);var Ue=oe(Pe,ae);if(de){var Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search);function Be(){F=N.getValue(),J=!0}n(Ee,N=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,_e),N.fireValueChanged=Be}else{var qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir);n(Ee,N=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,_e),J=!1}}else if(le.equals(Se)){if(Ee=ze.getField("UserElement2_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){B=M.getValue(),$=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,M=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,Se),M.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,M=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,Se),$=!1}else if(le.equals(xe)){if(Ee=ze.getField("UserElement3_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){W=k.getValue(),K=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,k=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,xe),k.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,k=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,xe),K=!1}else if(le.equals(Ae)){if(Ee=ze.getField("UserElement4_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){j=O.getValue(),Y=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,O=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,Ae),O.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,O=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,Ae),Y=!1}else if(le.equals(Te)){if(Ee=ze.getField("UserElement5_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){G=L.getValue(),X=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,L=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,Te),L.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,L=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,Te),X=!1}else if(le.equals(Ve)){if(Ee=ze.getField("UserElement6_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){q=R.getValue(),Z=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,R=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,Ve),R.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,R=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,Ve),Z=!1}else if(le.equals(Ne)){if(Ee=ze.getField("UserElement7_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){H=E.getValue(),ee=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,E=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,Ne),E.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,E=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,Ne),ee=!1}else if(le.equals(Me)){if(Ee=ze.getField("UserElement8_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){z=P.getValue(),te=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,P=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,Me),P.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,P=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,Me),te=!1}else if(le.equals(ke)){if(Ee=ze.getField("UserElement9_ID"),!(a.Elements[d].AD_Column_ID>0))continue;if(Pe="VIS_125",(ae=[])[0]=new e.DB.SqlParam("@AD_Column_ID",a.Elements[d].AD_Column_ID),Ue=oe(Pe,ae),de){function Be(){Q=U.getValue(),ie=!0}Fe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.Search),n(Ee,U=new e.Controls.VTextBoxButton(Ue,re,!1,!0,e.DisplayType.Search,Fe),re,Le,ke),U.fireValueChanged=Be}else qe=e.MLookupFactory.getMLookUp(e.Env.getCtx(),u,a.Elements[d].AD_Column_ID,e.DisplayType.TableDir),n(Ee,U=new e.Controls.VComboBox(Ue,!1,!1,!0,qe,150,e.DisplayType.TableDir,0),re,Le,ke),ie=!1}}if($e.css("display","none"),We.html(Oe),(He=new e.Query).addRestriction("C_AcctSchema_ID",e.Query.prototype.EQUAL,p),Pe="VIS_126",(ae=[])[0]=new e.DB.SqlParam("@tblID_s",s),"GL_JournalLine"==oe(Pe,ae)&&He.addRestriction("IsFullyQualified",e.Query.prototype.EQUAL,"Y"),0==c.C_ValidCombination_ID)ze.setQuery(e.Query.prototype.getEqualQuery("1","2"));else{var Je=new e.Query;Je.addRestriction("C_AcctSchema_ID",e.Query.prototype.EQUAL,p),Je.addRestriction("C_ValidCombination_ID",e.Query.prototype.EQUAL,c.C_ValidCombination_ID),ze.setQuery(Je)}Ge.query(0,0,!1),Qe.text(a.Description);var Ke=Oe.find('[name="AD_Org_ID"]');window.setTimeout((function(){je.css("width","73%"),We.parent().css({width:"27%",padding:"0 10px 0 0"}),t(Oe.find("button").parent().find("input")[0]).width();var i="VIS_126",n=[];n[0]=new e.DB.SqlParam("@tblID_s",s),"GL_JournalLine"==oe(i,n)&&Ke.on("click",(function(){0!=Ke.find("option[value=0]").length&&Ke.find("option[value=0]").remove()}))}),200)}})),Ke=returnValue}}),Re.on("click",(function(){r.setBusy(!0),qe=ze.getValue("C_ValidCombination_ID"),r.onClose&&r.onClose(qe),i.dialog("close"),r.setBusy(!1)})),Ee.on("click",(function(){i.dialog("close")})),Pe.on("click",(function(){r.setBusy(!0),l(!0),r.setBusy(!1)})),Ue.on("click",(function(){null!=h&&h.setValue(""),v.setValue(""),g.Content="",g.Visible=!1,$e.val(""),f.setValue(null),m.setValue(null),null!=y&&y.setValue(null),null!=I&&I.setValue(null),null!=D&&D.setValue(null),null!=w&&w.setValue(null),null!=b&&b.setValue(null),null!=C&&C.setValue(null),null!=_&&_.setValue(null),null!=S&&S.setValue(null),null!=x&&x.setValue(null),null!=A&&A.setValue(null),null!=T&&T.setValue(null),null!=V&&V.setValue(null),null!=N&&N.setValue(null),null!=M&&M.setValue(null),null!=k&&k.setValue(null),null!=O&&O.setValue(null),null!=L&&L.setValue(null),null!=R&&R.setValue(null),null!=E&&E.setValue(null),null!=P&&P.setValue(null),null!=U&&U.setValue(null)})),Fe.on("click",(function(){r.setBusy(!0),o(),r.setBusy(!1)}))},this.showDialog=function(){var e=t(window).width()-50,i=t(window).height()-60;o.height(i),o.width(e),l.append(o),l.dialog({modal:!1,resizable:!1,title:d,width:e,height:i,position:{at:"center top",of:window},close:function(){r.dispose(),l.dialog("destroy"),l=null,r=null}})},this.dataStatusChanged=function(e){var t=ze.getValue("Description");ze.getValue("COMBINATION"),null!=t&&t.length>0?$e.css("display","inline-block"):$e.css("display","none"),$e.text(t),Je.text(e.totalRecords)},this.disposeComponent=function(){Re&&Re.off("click"),Ee&&Ee.off("click"),Pe&&Pe.off("click"),Ue&&Ue.off("click"),Fe&&Fe.off("click"),d=null,c=null,p=null,u=null,null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,this.log=null,null,ce=null,pe=null,ue=null,ge=null,he=null,ve=null,fe=null,me=null,ye=null,Ie=null,De=null,we=null,be=null,Ce=null,_e=null,Se=null,xe=null,Ae=null,Te=null,Ve=null,Ne=null,Me=null,ke=null,Oe=null,Le=null,Re=null,Ee=null,Pe=null,Ue=null,Fe=null,Be=null,We=null,null,null,je=null,null,Ge=null,!1,qe=null,He=null,ze=null,Qe=null,Je=null,$e=null,Ke=null}}i.prototype.dispose=function(){this.disposeComponent()},e.AccountForm=i}(VIS,jQuery)},6674:()=>{!function(e,t){var i,n,a,s=this,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=t("<label></label>"),b=null,C=null;e.AddUpdateMProduct=function(_){var S=t("<div>");(b=t("<div class='vis-apanel-busy'>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),S.append(b),S.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="Value_'+s.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="Name_'+s.windowNo+'"></div></div></div>'),S.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="C_UOM_ID_'+s.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="UPC_'+s.windowNo+'"></div></div></div>'),S.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="ProductType_'+s.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="M_Product_Category_ID_'+s.windowNo+'"></div></div></div>'),S.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="C_TaxCategory_ID_'+s.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="M_AttributeSet_ID_'+s.windowNo+'"></div></div></div>'),S.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="IsPurchased_'+s.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="IsSold_'+s.windowNo+'"></div></div><div class= "VIS_Pref_dd"><div class="input-group vis-input-wrap" id="IsStocked_'+s.windowNo+'"></div></div></div>'),S.append('<div class="VIS_Pref_show vis-formouterwrpdiv"><div class= "VIS_Pref_dd p-0"><div class="input-group vis-input-wrap vis-ev-full-h" id="Description_'+s.windowNo+'"></div></div></div>'),S.append('<div class="vis-ctrfrm-btnwrp"><input id="closeBtn'+s.windowNo+'" class= "VIS_Pref_btn-2" type = "button" value = "'+e.Msg.getMsg("close")+'"><input id="okBtn_'+s.windowNo+'" class="VIS_Pref_btn-2" type="button" value="'+e.Msg.getMsg("OK")+'"><div class="vis-ad-w-p-s-main pull-left"><div class="vis-ad-w-p-s-infoline"></div><div class="vis-ad-w-p-s-msg" style="align-items:flex-end;" id="lblBottomMsg_'+s.windowNo+'"></div></div></div>'),srcCtrl=S.find("#Value_"+s.windowNo),nameCtrl=S.find("#Name_"+s.windowNo),uomCtrl=S.find("#C_UOM_ID_"+s.windowNo),upcCtrl=S.find("#UPC_"+s.windowNo),pTypeCtrl=S.find("#ProductType_"+s.windowNo),pCatCtrl=S.find("#M_Product_Category_ID_"+s.windowNo),taxCtrl=S.find("#C_TaxCategory_ID_"+s.windowNo),attCtrl=S.find("#M_AttributeSet_ID_"+s.windowNo),purCtrl=S.find("#IsPurchased_"+s.windowNo),soldCtrl=S.find("#IsSold_"+s.windowNo),stockCtrl=S.find("#IsStocked_"+s.windowNo),desCtrl=S.find("#Description_"+s.windowNo),a=S.find("#closeBtn"+s.windowNo),n=S.find("#okBtn_"+s.windowNo),w=S.find("#lblBottomMsg_"+s.windowNo);var x=t('<div class="vis-control-wrap">'),A=t('<div class="vis-control-wrap">'),T=t('<div class="vis-control-wrap">'),V=t('<div class="vis-control-wrap">'),N=t('<div class="vis-control-wrap">'),M=t('<div class="vis-control-wrap">'),k=t('<div class="vis-control-wrap">'),O=t('<div class="vis-control-wrap">'),L=t('<div class="vis-control-wrap">'),R=t('<div class="vis-control-wrap">'),E=t('<div class="vis-control-wrap">'),P=t('<div class="vis-control-wrap">');function U(e){b[0].style.visibility=e?"visible":"hidden"}function F(e){null!=e.getValue()&&""!=e.getValue()?e.getControl().removeClass("vis-ev-col-mandatory"):e.getControl().addClass("vis-ev-col-mandatory")}function B(){U(!1),o.setValue(""),l.setValue(""),r.setValue(""),c.setValue(""),i.setValue(""),u.setValue(""),g.setValue(""),v.setValue(""),D.setValue(""),m.setValue(!1),y.setValue(!1),I.setValue(!1),o.getControl().addClass("vis-ev-col-mandatory"),l.getControl().addClass("vis-ev-col-mandatory"),r.getControl().addClass("vis-ev-col-mandatory"),i.getControl().addClass("vis-ev-col-mandatory"),u.getControl().addClass("vis-ev-col-mandatory"),g.getControl().addClass("vis-ev-col-mandatory")}o=new e.Controls.VTextBox("Value",!0,!1,!0),srcCtrl.append(x),x.append(o.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("autocomplete","off")).append("<label>"+e.Msg.getMsg("EnterSearchKey")+"</label>"),l=new e.Controls.VTextBox("Name",!0,!1,!0),nameCtrl.append(A),A.append(l.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("autocomplete","off")).append("<label>"+e.Msg.getMsg("Name")+"</label>"),d=e.MLookupFactory.get(e.Env.getCtx(),_,0,e.DisplayType.TableDir,"C_UOM_ID",0,!0,"IsActive='Y'"),r=new e.Controls.VComboBox("C_UOM_ID",!0,!1,!0,d),uomCtrl.append(T),T.append(r.getControl()).append("<label>"+e.Msg.getMsg("UomName")+"</label>"),c=new e.Controls.VTextBox("UPC",!1,!1,!0),upcCtrl.append(V),V.append(c.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("autocomplete","off")).append("<label>"+e.Msg.getMsg("VIS_UPC_EAN")+"</label>"),p=e.MLookupFactory.get(e.Env.getCtx(),_,0,e.DisplayType.List,"ProductType",270,!0,"IsActive='Y'"),i=new e.Controls.VComboBox("ProductType",!0,!1,!0,p),pTypeCtrl.append(N),N.append(i.getControl()).append("<label>"+e.Msg.getMsg("VIS_Product_Type")+"</label>"),lookupProductCategory=e.MLookupFactory.get(e.Env.getCtx(),_,0,e.DisplayType.TableDir,"M_Product_Category_ID",0,!0,"IsActive='Y'"),u=new e.Controls.VComboBox("M_Product_Category_ID",!0,!1,!0,lookupProductCategory),pCatCtrl.append(M),M.append(u.getControl()).append("<label>"+e.Msg.getMsg("VIS_Product_Category")+"</label>"),h=e.MLookupFactory.get(e.Env.getCtx(),_,0,e.DisplayType.TableDir,"C_TaxCategory_ID",0,!0,"IsActive='Y'"),g=new e.Controls.VComboBox("C_TaxCategory_ID",!0,!1,!0,h),taxCtrl.append(k),k.append(g.getControl()).append("<label>"+e.Msg.getMsg("VIS_Tax_Category")+"</label>"),f=e.MLookupFactory.get(e.Env.getCtx(),_,0,e.DisplayType.TableDir,"M_AttributeSet_ID",0,!0,"IsActive='Y'"),v=new e.Controls.VComboBox("M_AttributeSet_ID",!1,!1,!0,f),attCtrl.append(O),O.append(v.getControl()).append("<label>"+e.Msg.getMsg("VIS_Attribute_Set")+"</label>"),m=new e.Controls.VCheckBox("IsPurchased",!1,!1,!0,e.Msg.getMsg("VIS_Is_Purchased"),null,!1),purCtrl.append(L),L.append(m.getControl().addClass("vis-ec-col-lblchkbox")),y=new e.Controls.VCheckBox("IsSold",!1,!1,!0,e.Msg.getMsg("VIS_Is_Sold"),null,!1),soldCtrl.append(R),R.append(y.getControl().addClass("vis-ec-col-lblchkbox")),I=new e.Controls.VCheckBox("IsStocked",!1,!1,!0,e.Msg.getMsg("VIS_Is_Stocked"),null,!1),stockCtrl.append(E),E.append(I.getControl().addClass("vis-ec-col-lblchkbox")),D=new e.Controls.VTextArea("Description",!1,!1,!0),desCtrl.append(P),P.append(D.getControl().attr("placeholder"," ").attr("data-placeholder","")).append("<label>"+e.Msg.getMsg("Description")+"</label>"),n.on(e.Events.onClick,(function(){w.text(" "),function(){var n=!1,a=e.Msg.getMsg("FillMandatory")+" ";if(0==o.getValue().trim().length&&(a+=e.Msg.getMsg("EnterSearchKey")+", ",n=!0),0==l.getValue().trim().length&&(a+=e.Msg.getMsg("Name")+", ",n=!0),0!=r.getValue()&&null!=r.getValue()||(a+=e.Msg.getMsg("UomName")+", ",n=!0),0!=i.getValue()&&null!=i.getValue()||(a+=e.Msg.getMsg("VIS_Product_Type")+", ",n=!0),0!=u.getValue()&&null!=u.getValue()||(a+=e.Msg.getMsg("VIS_Product_Category")+", ",n=!0),0!=g.getValue()&&null!=g.getValue()||(a+=e.Msg.getMsg("VIS_Tax_Category")+", ",n=!0),n)return e.ADialog.error("","",a.slice(0,-2)),!1;var s={searchKey:o.getValue(),name:l.getValue(),uom:r.getValue(),upc:c.getValue(),proType:i.getValue(),proCategory:u.getValue(),taxCategory:g.getValue(),attribute:v.getValue(),purchased:m.getValue(),sold:y.getValue(),stocked:I.getValue(),description:D.getValue()};U(!0),t.ajax({url:e.Application.contextUrl+"AddProduct/AddNewProduct",type:"POST",data:s,success:function(t){"OK"==t?(w.text(e.Msg.getMsg("VIS_Product_Save")),B()):(U(!1),w.text(t))},error:function(t){U(!1),message=e.Msg.getMsg("VIS_SomethingWentWrong"),e.ADialog.error(message)}})}()})),a.on(e.Events.onClick,(function(){B(),C.close(),null!=S&&S.remove(),S=null,n&&n.off(e.Events.onClick),n=null,a&&a.off(e.Events.onClick),a=null,l=null,o=null,r=null,d=null,c=null,i=null,p=null,u=null,lookupProductCategory=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null})),o.fireValueChanged=function(e){F(o),o.setValue(e.newValue)},l.fireValueChanged=function(e){F(l),l.setValue(e.newValue)},r.fireValueChanged=function(e){F(r),r.setValue(e.newValue)},c.fireValueChanged=function(e){c.setValue(e.newValue)},i.fireValueChanged=function(e){F(i),i.setValue(e.newValue)},u.fireValueChanged=function(e){F(u),u.setValue(e.newValue)},g.fireValueChanged=function(e){F(g),g.setValue(e.newValue)},v.fireValueChanged=function(e){v.setValue(e.newValue)},m.fireValueChanged=function(e){m.setValue(e.newValue)},y.fireValueChanged=function(e){y.setValue(e.newValue)},I.fireValueChanged=function(e){I.setValue(e.newValue)},D.fireValueChanged=function(e){D.setValue(e.newValue)},function(i){(C=new e.ChildDialog).setContent(i),t(window).width()>=1366?C.setWidth(870):C.setWidth(670);C.setTitle(e.Msg.getMsg("AddProduct")),C.setEnableResize(!0),C.setModal(!0),C.show(),C.hideButtons(),C.getRoot().dialog({position:[200,130]})}(S),U(!1)}}(VIS,jQuery)},6893:()=>{!function(e,t){e.AmountDivision=function(i,n,a,s){i&&i.toString().indexOf("<")>-1&&(i=0),this.onClose=null,this.onClosing=null;var l,o,r,d,c,p,u,g,h,v,f,m,y,I,D,w,C,_,S,x,A,T,V,N,M,k,O,L,R,E,P,U,F,B,W,j,G,q,H,z,Q,J,$,K,Y,X,Z,ee,te,ie,ne,ae,se,le,oe,re,de,ce,pe,ue,ge,he,ve,fe=t("<div style='width:100%;height:100%;position:relative;display: flex;'>"),me=t("<div class='VIS-AMTD-MainContent vis-formouterwrpdiv'>"),ye=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),Ie=(t("<table>"),null),De=null,we=null,be=null,Ce=null,_e=null,Se=e.Env.getWindowNo(),xe=null,Ae=null,Te=null,Ve=null,Ne=null,Me=null,ke="",Oe=null,Le=null,Re=null,Ee=null,Pe=null,Ue=new e.ChildDialog,Fe=null,Be=null,We=null,je=null,Ge=null,qe=null,He=null,ze=null,Qe=null,Je=null,$e=null,Ke=null,Ye=null,Xe=null,Ze=this,et=null,tt=null,it=null,nt=null,at=null,st=null,lt=null,ot=null,rt=null,dt=null,ct=null,pt=null,ut=null,gt=null,ht=null,vt=null,ft=null,mt=null,yt=null,It=null,Dt=null,wt=null,bt=null,Ct=null,_t=null,St=null,xt=null,At=null,Tt=null,Vt=null,Nt=null,Mt=null,kt=null;this.dotFormatter=e.Env.isDecimalPoint();var Ot=e.Env.getCtx().getContextAsInt("#StdPrecision"),Lt=null,Rt=null,Et=null,Pt=0,Ut=0,Ft=!0,Bt=0,Wt=null,jt=null,Gt=0;function qt(){""==o.val()||0==o.val()?(Ye.css("display","none"),p.css("display","none"),""==Nt.html()?Ue.getRoot().parent().css("height","390px"):Ue.getRoot().parent().css("height","410px")):(Ye.css("display","block"),p.css("display","block"),""==Nt.html()?Ue.getRoot().parent().css("height","448px"):Ue.getRoot().parent().css("height","469px"))}function Ht(){var t=!1,n="",s="";Nt.empty(),Nt.append("");var l=e.dataContext.getJSONRecord("AmountDivision/GetDimMaxAmount",{dAmtId:i});for(maxDimension=(new e.DB.DataReader).toJson(JSON.stringify(l));maxDimension.read();)null!=maxDimension.getInt(0)?(Mt.css("display","block"),t=!0,s=kt.GetFormatedValue(maxDimension.getString(0)),n+=""==n?maxDimension.getString(1):","+maxDimension.getString(1)):(Nt.append(""),t=!1,window.setTimeout((function(){Ue.getRoot().parent().css("height","448px")}),200));if(t&&(n.length>55&&(n=n.substring(0,55)+"..."),Nt.append(e.Msg.getMsg("MaxDimensionAmount")+" : "+s+" "+e.Msg.getMsg("ForAcctSchema")+" : "+n),window.setTimeout((function(){Ue.getRoot().parent().css("height","470px")}),200)),0!=i){var o=e.dataContext.getJSONRecord("AmountDivision/GetDimAmount",{dAmtId:i});Math.abs(parseFloat(a))>0?r.setValue(a):r.setValue(o)}else a?r.setValue(a):r.setValue(0);""==Nt.html()&&(Mt.css("display","none"),Ue.getRoot().parent().css("height","448px"))}function zt(){return 0==r.getValue()||""==r.getValue()&&0==r.getValue().trim().length?(e.ADialog.warn("ValidateTotalAmount"),r.getControl().focus(),$t("hidden"),!1):""==l.val()||-1==l.val()?(e.ADialog.warn("ValidateAcctSchema"),l.focus(),$t("hidden"),!1):""==o.val()||0==o.val()?(e.ADialog.warn("ValidateDimType"),o.focus(),$t("hidden"),!1):0==r.getValue()||""==r.getValue()&&0==r.getValue().trim().length?(e.ADialog.warn("ValidateTotalAmount"),r.getControl().focus(),$t("hidden"),!1):Ae?Ae?0==q.getValue()||""==q.getValue()&&0==q.getValue().trim().length?(e.ADialog.warn("ValidateAmount"),q.getControl().focus(),$t("hidden"),!1):Math.abs(parseFloat(q.getValue()))>Math.abs(parseFloat(r.getValue()))?(e.ADialog.warn("LineTotalNotGrater"),q.getControl().focus(),$t("hidden"),!1):parseFloat(q.getValue())>0&&parseFloat(r.getValue())<0?(e.ADialog.warn("VIS_NegativeAmount"),c.getControl().focus(),$t("hidden"),!1):parseFloat(q.getValue())<0&&parseFloat(r.getValue())>0?(e.ADialog.warn("VIS_PositiveAmount"),c.getControl().focus(),$t("hidden"),!1):Qt()?($t("hidden"),!0):($t("hidden"),!1):($t("hidden"),!0):0==c.getValue()||""==c.getValue()&&0==c.getValue().trim().length?(e.ADialog.warn("ValidateAmount"),c.getControl().focus(),$t("hidden"),!1):Math.abs(parseFloat(c.getValue()))>Math.abs(parseFloat(r.getValue()))?(e.ADialog.warn("LineTotalNotGrater"),c.getControl().focus(),$t("hidden"),!1):parseFloat(c.getValue())>0&&parseFloat(r.getValue())<0?(e.ADialog.warn("VIS_NegativeAmount"),c.getControl().focus(),$t("hidden"),!1):parseFloat(c.getValue())<0&&parseFloat(r.getValue())>0?(e.ADialog.warn("VIS_PositiveAmount"),c.getControl().focus(),$t("hidden"),!1):Qt()?($t("hidden"),!0):($t("hidden"),!1)}function Qt(){if(0!=o.val())if(Ae){if("AC"==o.val())return""==he.val()?(e.ADialog.warn("ValidateAcctElement"),he.focus(),$t("hidden"),!1):($t("hidden"),!0);if("AY"==o.val())return-1==K.val()||null==K.val()?(e.ADialog.warn("ValidateActivity"),K.focus(),$t("hidden"),!1):($t("hidden"),!0);if("BP"==o.val())return""==ae.val()?(e.ADialog.warn("ValidateBPartner"),ae.focus(),$t("hidden"),!1):($t("hidden"),!0);if("LF"==o.val()||"LT"==o.val())return""==le.val()?(e.ADialog.warn("ValidateLocation"),le.focus(),$t("hidden"),!1):($t("hidden"),!0);if("MC"==o.val())return-1==X.val()||null==X.val()?(e.ADialog.warn("ValidateCamp"),S.focus(),$t("hidden"),!1):($t("hidden"),!0);if("OO"==o.val()||"OT"==o.val())return-1==G.val()||null==G.val()?(e.ADialog.warn("ValidateOrg"),G.focus(),$t("hidden"),!1):($t("hidden"),!0);if("PJ"==o.val())return""==re.val()?(e.ADialog.warn("ValidateProject"),re.focus(),$t("hidden"),!1):($t("hidden"),!0);if("PR"==o.val())return""==ce.val()?(e.ADialog.warn("ValidateProduct"),ce.focus(),$t("hidden"),!1):($t("hidden"),!0);if("SA"==o.val())return!0;if("SR"==o.val())return-1==ee.val()||null==ee.val()?(e.ADialog.warn("ValidateSales"),ee.focus(),$t("hidden"),!1):($t("hidden"),!0);if("U1"==o.val()||"U2"==o.val())return-1==ge.val()||null==ge.val()?(e.ADialog.warn("ValidateElement"),ge.focus(),$t("hidden"),!1):""==he.val()?(e.ADialog.warn("ValidateAcctElement"),he.focus(),$t("hidden"),!1):($t("hidden"),!0);if("X1"==o.val()||"X2"==o.val()||"X3"==o.val()||"X4"==o.val()||"X5"==o.val()||"X6"==o.val()||"X7"==o.val()||"X8"==o.val()||"X9"==o.val())return-1==ie.val()||null==ie.val()?(e.ADialog.warn("ValidateUElement"),ie.focus(),$t("hidden"),!1):($t("hidden"),!0)}else{if("AC"==o.val())return""==W.val()?(e.ADialog.warn("ValidateAcctElement"),W.focus(),$t("hidden"),!1):($t("hidden"),!0);if("AY"==o.val())return-1==C.val()||null==C.val()?(e.ADialog.warn("ValidateActivity"),C.focus(),$t("hidden"),!1):($t("hidden"),!0);if("BP"==o.val())return""==M.val()?(e.ADialog.warn("ValidateBPartner"),M.focus(),$t("hidden"),!1):($t("hidden"),!0);if("LF"==o.val()||"LT"==o.val())return""==O.val()?(e.ADialog.warn("ValidateLocation"),O.focus(),$t("hidden"),!1):($t("hidden"),!0);if("MC"==o.val())return-1==S.val()||null==S.val()?(e.ADialog.warn("ValidateCamp"),S.focus(),$t("hidden"),!1):($t("hidden"),!0);if("OO"==o.val()||"OT"==o.val())return-1==d.val()||null==d.val()?(e.ADialog.warn("ValidateOrg"),d.focus(),$t("hidden"),!1):($t("hidden"),!0);if("PJ"==o.val())return""==R.val()?(e.ADialog.warn("ValidateProject"),R.focus(),$t("hidden"),!1):($t("hidden"),!0);if("PR"==o.val())return""==P.val()?(e.ADialog.warn("ValidateProduct"),P.focus(),$t("hidden"),!1):($t("hidden"),!0);if("SA"==o.val())return!0;if("SR"==o.val())return-1==A.val()||null==A.val()?(e.ADialog.warn("ValidateSales"),A.focus(),$t("hidden"),!1):($t("hidden"),!0);if("U1"==o.val()||"U2"==o.val())return-1==W.val()||null==W.val()?(e.ADialog.warn("ValidateElement"),W.focus(),$t("hidden"),!1):""==W.val()?(e.ADialog.warn("ValidateAcctElement"),W.focus(),$t("hidden"),!1):($t("hidden"),!0);if("X1"==o.val()||"X2"==o.val()||"X3"==o.val()||"X4"==o.val()||"X5"==o.val()||"X6"==o.val()||"X7"==o.val()||"X8"==o.val()||"X9"==o.val())return-1==V.val()||null==V.val()?(e.ADialog.warn("ValidateUElement"),V.focus(),$t("hidden"),!1):($t("hidden"),!0)}}function Jt(n,a,s){var r=[];return t.ajax({dataType:"json",type:"POST",url:e.Application.contextUrl+"AmountDivision/GetDiminsionLine",data:{accountingSchema:JSON.stringify(n),dimensionID:i,DimensionLineID:0,pageNo:De,pSize:Ie},success:function(t){if(t){if(t=JSON.parse(t),xt=!0,t.length>0){for(var i=0;i<t.length;i++)if(0==i&&xt){Pt=t[i].TotalRecord;var n=Kt();for(Ct.empty(),b=1;b<n+1;b++)Ct.empty().append("<option value="+b+">"+b+"</option>");Ct.val(1),xt=!1}a&&(l.val(t[0].AcctSchema),ui(l.val(),(function(){o.val(t[0].DimensionTypeVal),ti(o.val()),Lt=t[0].DimensionTypeVal,Rt=t[0].AcctSchema,I.setValue(kt.GetFormatedValue(t[0].TotalLineAmount))}))),a||(Lt=t[0].DimensionTypeVal,Rt=t[0].AcctSchema,I.setValue(kt.GetFormatedValue(t[0].TotalLineAmount)))}else Ct.empty().append('<option value="1">1</option>'),I.setValue(kt.GetFormatedValue(0));xe=t.length,c.setValue(0),Ae=!1,p.empty().append(e.Msg.getMsg("Add")),r=t,s&&s(t)}else e.ADialog.error("ErrorGettingData"),$t("hidden")},error:function(){$t("hidden"),e.ADialog.error("ErrorGettingData")}}),r}function $t(e){ye[0].style.visibility=e}function Kt(){return 0!=Pt%Ie?parseInt(Pt/Ie)+1:parseInt(Pt/Ie)}function Yt(n,a,s,l,o,r,d,c,p,u,g,h,v,f){$t("visible"),a=kt.GetFormatedValue(a),s=kt.GetFormatedValue(s),t.ajax({dataType:"json",type:"POST",url:e.Application.contextUrl+"AmountDivision/InsertDimensionLine",data:{recordId:n,totalAmount:a,lineAmount:s,acctSchemaID:JSON.stringify(l),elementTypeID:r,dimensionValue:c,elementID:p,oldDimensionName:u,bpartner_ID:e.Utility.Util.getValueOfInt(g),oldBPartner_ID:v},success:function(t){if(""!=(t=JSON.parse(t))[0]){if(i=t[0],Ht(),Ae){e.ADialog.info("UpdatedDimLine"),w2ui[At].set(xe,{DimensionName:d}),w2ui[At].set(xe,{DimensionValueAmount:s}),w2ui[At].set(xe,{CalculateDimValAmt:s}),"AC"!=r&&"U1"!=r&&"U2"!=r||(w2ui[At].set(xe,{C_BPartner:h}),w2ui[At].set(xe,{C_BPartner_ID:g}));a=kt.GetFormatedValue((parseFloat(parseFloat(I.getValue())-parseFloat(Vt))+parseFloat(s)).toFixed(Ot));I.setValue(a)}else{var n=w2ui[At].records.length;"AC"==r||"U1"==r||"U2"==r?w2ui[At].add({recid:n+1,DimensionType:o,DimensionName:d,C_BPartner:h,DimensionValueAmount:s,lineAmountID:t[1],CalculateDimValAmt:s,C_BPartner_ID:g}):w2ui[At].add({recid:n+1,DimensionType:o,DimensionName:d,DimensionValueAmount:s,lineAmountID:t[1],CalculateDimValAmt:s});var a=kt.GetFormatedValue((parseFloat(I.getValue())+parseFloat(s)).toFixed(Ot));I.setValue(a)}$t("hidden")}else e.ADialog.error("ErrorGettingData"),$t("hidden");f&&f()},error:function(){$t("hidden"),e.ADialog.error("ErrorGettingData"),retval=!1,loading=!1}})}function Xt(t,n,a,s,l,o,d,p,u,g,h){a=kt.GetFormatedValue(a.toFixed(Ot));var v="";if(Pe=[],0==l?Pe=Xe:Pe[0]=l,Ae){if((f={}).dTypeVal=o,f.dAmtId=i,f.acctSchemaId=Pe.toString(),f.dLineId=u,f.dNameVal=d,f.cbPartId=g,!(null==(v=e.dataContext.getJSONRecord("AmountDivision/CheckDuplicate",f))||v<1))return e.ADialog.warn("NameExists"),q.setValue(0),$t("hidden"),!1;var f=u.toString(),m=e.dataContext.getJSONRecord("AmountDivision/GetTempDimLineAmount",f);Math.abs(parseFloat(I.getValue())+parseFloat(a)-parseFloat(m))<=Math.abs(parseFloat(r.getValue()))?Yt(i,r.getValue(),a,Pe,t,o,n,d,p,Et,g,h,Bt,(function(){Zt()})):(e.ADialog.warn("LineTotalNotGrater"),q.setValue(0),q.getControl().focus(),Zt())}else if(Math.abs(parseFloat(I.getValue())+parseFloat(a))<=Math.abs(parseFloat(r.getValue()))){if((f={}).dTypeVal=o,f.dAmtId=i,f.acctSchemaId=Pe.toString(),f.dLineId="0",f.dNameVal=d,f.cbPartId=g,!(null==(v=e.dataContext.getJSONRecord("AmountDivision/CheckDuplicate",f))||v<1))return e.ADialog.warn("NameExists"),1,c.setValue(0),$t("hidden"),!1;Yt(i,r.getValue(),a,Pe,t,o,n,d,p,0,g,h,0,(function(){Zt()}))}else e.ADialog.warn("LineTotalNotGrater"),c.setValue(0),c.getControl().focus(),1,Zt()}function Zt(){c.setValue(0),Ae=!1,g.css("display","none"),it.css("display","none"),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?Ye.css("width","26%"):Ye.css("width","33.3%"),p.empty().append(e.Msg.getMsg("Add"))}function ei(){m=null,d=null,w=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,Q=null,G=null,$=null,K=null,Y=null,X=null,Z=null,ee=null,te=null,ie=null,ne=null,ae=null,oe=null,re=null,de=null,ce=null,pe=null,ue=null,ge=null,_e.empty(),yt.empty(),Ut=0,Ft=!0}function ti(e,t){ei(),"AC"==e?pi():"AY"==e?ni():"BP"==e?oi():"LF"==e||"LT"==e?ri():"MC"==e?ai():"OO"==e||"OT"==e?ii(e):"PJ"==e?di():"PR"==e?ci():"SA"==e||("SR"==e?si():"U1"==e||"U2"==e?pi():"X1"!=e&&"X2"!=e&&"X3"!=e&&"X4"!=e&&"X5"!=e&&"X6"!=e&&"X7"!=e&&"X8"!=e&&"X9"!=e||li())}this.vetoablechange=function(e){"Amount"==e.propertyName?c.setValue(e.newValue):"ModalAmount"==e.propertyName&&q.setValue(e.newValue)};var ii=function(i){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),m=t("<label>"),Q=t("<label>");var n="";n="OO"==i?" AND IsSummary='N' AND IsCostCenter='N' AND IsProfitCenter='N'":" AND IsSummary='N' AND (IsCostCenter='Y' OR IsProfitCenter='Y')";var a=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"AD_Org_ID",0,!1,"AD_Org_ID<>0"+n),s=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"AD_Org_ID",0,!1,"AD_Org_ID<>0"+n),l=new e.Controls.VComboBox("Org_ID",!1,!1,!0,a,50),o=new e.Controls.VComboBox("Org_ID",!1,!1,!0,s,50);(d=l.getControl().attr("placeholder"," ").attr("data-placeholder","")).find("option[value=0]").remove(),d.attr("tabindex","4"),(G=o.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","9"),m.append(e.Msg.translate(e.Env.getCtx(),"Org_ID")),Q.append(e.Msg.translate(e.Env.getCtx(),"Org_ID")),(Be=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var r=t('<div class="vis-control-wrap">');(lt=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");t('<div class="vis-control-wrap">');Be.append(r),r.append(d).append(m),_e.append(Be),lt.append(lt),lt.append(G).append(Q),yt.append(lt),d.focus(),G.focus()},ni=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),w=t("<label>"),$=t("<label>");var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Activity_ID",0,!1,null),n=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Activity_ID",0,!1,null),a=new e.Controls.VComboBox("C_Activity_ID",!1,!1,!0,i,50),s=new e.Controls.VComboBox("C_Activity_ID",!1,!1,!0,n,50);(C=a.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","4"),(K=s.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","9"),w.append(e.Msg.translate(e.Env.getCtx(),"C_Activity_ID")),(Ge=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var l=t("<div class='vis-control-wrap'>");Ge.append(l),l.append(C).append(w),_e.append(Ge),C.focus(),$.append(e.Msg.translate(e.Env.getCtx(),"C_Activity_ID")),(dt=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var o=t("<div class='vis-control-wrap'>");dt.append(o),o.append(K).append($),yt.append(dt),K.focus()},ai=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),_=t("<label>"),Y=t("<label>");var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Campaign_ID",0,!1,null),n=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Campaign_ID",0,!1,null),a=new e.Controls.VComboBox("C_Campaign_ID",!1,!1,!0,i,50),s=new e.Controls.VComboBox("C_Campaign_ID",!1,!1,!0,n,50);(S=a.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","4"),(X=s.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","9"),_.append(e.Msg.translate(e.Env.getCtx(),"C_Campaign_ID")),(ze=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var l=t("<div class='vis-control-wrap'>");ze.append(l),l.append(S).append(_),_e.append(ze),S.focus(),Y.append(e.Msg.translate(e.Env.getCtx(),"C_Campaign_ID")),(ut=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var o=t("<div class='vis-control-wrap'>");ut.append(o),o.append(X).append(Y),yt.append(ut),X.focus()},si=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),x=t("<label>"),Z=t("<label>");var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_SalesRegion_ID",0,!1,null),n=new e.Controls.VComboBox("C_SalesRegion_ID",!1,!1,!0,i,50);(A=n.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","4"),x.append(e.Msg.translate(e.Env.getCtx(),"C_SalesRegion_ID")),($e=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var a=t("<div class='vis-control-wrap'>");$e.append(a),a.append(A).append(x),_e.append($e),A.focus();var s=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_SalesRegion_ID",0,!1,null),l=new e.Controls.VComboBox("C_SalesRegion_ID",!1,!1,!0,s,50);(ee=l.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","9"),Z.append(e.Msg.translate(e.Env.getCtx(),"C_SalesRegion_ID")),(vt=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var o=t("<div class='vis-control-wrap'>");vt.append(o),o.append(ee).append(Z),yt.append(vt),ee.focus()},li=function(){V=t("<select>"),ie=t("<select>");var i=e.dataContext.getJSONRecord("AmountDivision/GetUserElement",{aid:Pe[0],eType:o.find("option:selected").val()}),n=(new e.DB.DataReader).toJson(JSON.stringify(i));for(_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),T=t("<label>"),V.empty().append("<option value=-1></option>"),ie.empty().append("<option value=-1></option>");n.read();)V.append("<option value="+n.getInt(0)+">"+n.getString(1)+"</option>"),ie.append("<option value="+n.getInt(0)+">"+n.getString(1)+"</option>");V.attr("tabindex","4"),T.append(e.Msg.translate(e.Env.getCtx(),"AD_Column_ID")),(Ke=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var a=t("<div class='vis-control-wrap'>");Ke.append(a),a.append(V).append(T),_e.append(Ke),V.focus(),te=t("<label>"),ie.attr("tabindex","9"),te.append(e.Msg.translate(e.Env.getCtx(),"AD_Column_ID")),(ft=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>")).css("width","100%");var s=t("<div class='vis-control-wrap'>");ft.append(s),s.append(ie).append(te),yt.append(ft),ie.focus()},oi=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),N=t("<label>");var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_BPartner_ID",0,!1,null);Ve=new e.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,e.DisplayType.Search,i),(M=Ve.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","4"),N.append(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),qe=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var n=t('<div class="vis-control-wrap">'),a=t('<div class="input-group-append">');qe.css("width","100%"),qe.append(n),qe.append(a),n.append(M).append(N),a.append(Ve.getBtn(0)),_e.append(qe),ne=t("<label>");var s=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_BPartner_ID",0,!1,null);Oe=new e.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,e.DisplayType.Search,s),(ae=Oe.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","9"),ne.append(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),ct=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var l=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');ct.css("width","100%"),ct.append(l),ct.append(o),l.append(ae).append(ne),o.append(Oe.getBtn(0)),yt.append(ct)},ri=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),k=t("<label>");var i=new e.MLocationLookup(e.Env.getCtx(),Se);Ne=new e.Controls.VLocation("C_Location_ID",!1,!1,!0,e.DisplayType.Location,i),(O=Ne.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","4"),k.append(e.Msg.translate(e.Env.getCtx(),"C_Location_ID")),He=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var n=t('<div class="vis-control-wrap">'),a=t('<div class="input-group-append">');He.css("width","100%"),He.append(n),He.append(a),n.append(O).append(k),a.append(Ne.getBtn(1)),_e.append(He),se=t("<label>");var s=new e.MLocationLookup(e.Env.getCtx(),Se);Le=new e.Controls.VLocation("C_Location_ID",!1,!1,!0,e.DisplayType.Location,s),(le=Le.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","9"),se.append(e.Msg.translate(e.Env.getCtx(),"C_Location_ID")),pt=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var l=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');pt.css("width","100%"),pt.append(l),pt.append(o),l.append(le).append(se),o.append(Le.getBtn(1)),yt.append(pt)},di=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),L=t("<label>");var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Project_ID",0,!1,null);Me=new e.Controls.VTextBoxButton("C_Project_ID",!1,!1,!0,e.DisplayType.Search,i),(R=Me.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","4"),L.append(e.Msg.translate(e.Env.getCtx(),"C_Project_ID")),Je=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var n=t('<div class="vis-control-wrap">'),a=t('<div class="input-group-append">');Je.css("width","100%"),Je.append(n),Je.append(a),n.append(R).append(L),a.append(Me.getBtn(0)),_e.append(Je),oe=t("<label>");var s=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Project_ID",0,!1,null);Re=new e.Controls.VTextBoxButton("C_Project_ID",!1,!1,!0,e.DisplayType.Search,s),(re=Re.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","9"),oe.append(e.Msg.translate(e.Env.getCtx(),"C_Project_ID")),ht=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var l=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');ht.css("width","100%"),ht.append(l),ht.append(o),l.append(re).append(oe),o.append(Re.getBtn(0)),yt.append(ht)},ci=function(){_e.css({width:"33.3%"}),yt.css({width:"33.3%"}),Ye.css("width","33.3%"),E=t("<label>");var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"M_Product_ID",0,!1,null);ke=new e.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,e.DisplayType.Search,i),(P=ke.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","4"),E.append(e.Msg.translate(e.Env.getCtx(),"M_Product_ID")),Qe=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var n=t('<div class="vis-control-wrap">'),a=t('<div class="input-group-append">');Qe.css("width","100%"),Qe.append(n),Qe.append(a),n.append(P).append(E),a.append(ke.getBtn(0)),_e.append(Qe),de=t("<label>");var s=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"M_Product_ID",0,!1,null);Ee=new e.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,e.DisplayType.Search,s),(ce=Ee.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","9"),de.append(e.Msg.translate(e.Env.getCtx(),"M_Product_ID")),gt=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var l=t('<div class="vis-control-wrap">'),o=t('<div class="input-group-append">');gt.css("width","100%"),gt.append(l),gt.append(o),l.append(ce).append(de),o.append(Ee.getBtn(0)),yt.append(gt)},pi=function(){if(0==(Ut=e.dataContext.getJSONData(e.Application.contextUrl+"AmountDivision/GetElementID",{accountingSchema:JSON.stringify(Pe)},null)))return Ft=!1,!1;_e.css({width:"66.6%"}),yt.css({width:"66.6%","margin-right":"9px"}),Ye.css("width","26.5%"),mt.css("width","26.5%"),U=t("<label>"),F=t("<label>"),U.append(e.Msg.translate(e.Env.getCtx(),"C_Element_ID")),F.append(e.Msg.translate(e.Env.getCtx(),"C_ElementValue_ID"));var i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Element_ID",0,!1,null),n=new e.Controls.VComboBox("C_Element_ID",!1,!1,!0,i,50);(B=n.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","4"),We=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>");var a=t('<div class="vis-control-wrap">');We.css("width","50%"),We.append(a),a.append(B).append(U),_e.append(We),We.hide();var s=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_ElementValue_ID",0,!1,"C_Element_ID="+Ut);j=new e.Controls.VTextBoxButton("C_ElementValue_ID",!1,!1,!0,e.DisplayType.Search,s),(W=j.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","4"),je=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var l=t('<div class="vis-control-wrap">'),r=t('<div class="input-group-append">');je.css("width","50%"),je.append(l),je.append(r),l.append(W).append(F),r.append(j.getBtn(0)),_e.append(je),B.on("change",(function(){var t=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_ElementValue_ID",0,!1,"C_Element_ID="+B.val());W.lookup=t})),W.focus(),N=t("<label>");i=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_BPartner_ID",0,!1,null);Ve=new e.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,e.DisplayType.Search,i),(M=Ve.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","5"),N.append(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),qe=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var d=t('<div class="vis-control-wrap">'),c=t('<div class="input-group-append">');qe.css("width","50%"),qe.append(d),qe.append(c),d.append(M).append(N),c.append(Ve.getBtn(0)),_e.append(qe),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?(be.showColumn("C_BPartner"),je.css("width","49%"),qe.css("width","49%").css("margin-left","9px"),Ye.css("width","26%"),mt.css("width","26%")):(je.css("width","51%"),qe.css("width","49%").css("margin-left",""),Ye.css("width","26.5%"),mt.css("width","26.5%")),pe=t("<label>"),ue=t("<label>"),pe.append(e.Msg.translate(e.Env.getCtx(),"C_Element_ID")),ue.append(e.Msg.translate(e.Env.getCtx(),"C_ElementValue_ID"));var p=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_Element_ID",0,!1,null),u=new e.Controls.VComboBox("C_Element_ID",!1,!1,!0,p,50);(ge=u.getControl().attr("placeholder"," ").attr("data-placeholder","")).attr("tabindex","9"),ot=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>");var g=t('<div class="vis-control-wrap">');ot.css("width","50%"),ot.append(g),g.append(ge).append(pe),yt.append(ot),ot.hide();var h=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_ElementValue_ID",0,!1,"C_Element_ID="+Ut);ve=new e.Controls.VTextBoxButton("C_ElementValue_ID",!1,!1,!0,e.DisplayType.Search,h),(he=ve.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","9"),rt=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var v=t('<div class="vis-control-wrap">'),f=t('<div class="input-group-append">');rt.css("width","50%"),rt.append(v),rt.append(f),v.append(he).append(ue),f.append(ve.getBtn(0)),yt.append(rt),ge.on("change",(function(){var t=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_ElementValue_ID",0,!1,"C_Element_ID="+ge.val());he.lookup=t})),he.focus(),ne=t("<label>");p=e.MLookupFactory.get(e.Env.getCtx(),Se,0,e.DisplayType.TableDir,"C_BPartner_ID",0,!1,null);Oe=new e.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,e.DisplayType.Search,p),(ae=Oe.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," ")).attr("tabindex","10"),ne.append(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),ct=t("<div class='VIS-AMTD-formData VIS-AMTD-InputBtns input-group vis-input-wrap'>");var m=t('<div class="vis-control-wrap">'),y=t('<div class="input-group-append">');ct.css("width","49%"),ct.append(m),ct.append(y),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?(rt.css("width","49%"),ct.css("width","48%").css("margin-left","9px"),mt.css("width","26%")):(rt.css("width","51%"),ct.css("width","49%"),mt.css("width","26.5%")),m.append(ae).append(ne),y.append(Oe.getBtn(0)),yt.append(ct)};function ui(i,n){$t("visible"),t.ajax({url:e.Application.contextUrl+"AmountDivision/GetDiminsionType",dataType:"json",data:"{}",type:"POST",error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),$t("hidden")},success:function(a){var s=JSON.parse(a);if(s.Error)return e.ADialog.error(s.Error),void $t("hidden");a=e.dataContext.getJSONData(e.Application.contextUrl+"AmountDivision/GetElementType",{acctSchemaId:i,allAcctIds:Xe},null);var l=(new e.DB.DataReader).toJson(a.eleType);for(o.empty().append('<option selected="selected" value="0">Please select</option>');l.read();)for(var r=0;r<s.length;r++)if(s[r].Key==l.getString(0)){o.append(t("<option></option>").val(s[r].Key).html(l.getString(1)));break}n&&n(),$t("hidden")}})}var gi=function(n){var a=[];a.push({field:"DimensionType",caption:"Dimension Type",size:"30%",min:217}),a.push({field:"DimensionName",caption:"Dimension Name",size:"30%",min:217}),a.push({field:"C_BPartner",caption:"Business Partner",size:"30%",min:217,hidden:!0}),a.push({field:"DimensionValueAmount",caption:"Dimension Value Amount",size:"30%",min:216,render:function(t,i,n){return e.Utility.Util.getValueOfDecimal(t.DimensionValueAmount).toLocaleString()}}),a.push({field:"Edit",caption:"",size:"5%",resizable:!1,render:function(){return'<a  tabindex="8"><div><img src="'+e.Application.contextUrl+'Areas/VIS/Images/base/Edit_sub16.png" alt="Edit record" title="Edit record" style="opacity: 1;cursor:pointer"></div></a>'}}),a.push({field:"Delete",caption:"",size:"5%",resizable:!1,render:function(){return'<a id="a1" tabindex="14"><div><img src="'+e.Application.contextUrl+'Areas/VIS/Images/base/delete10.png" alt="Delete record" title="Delete record" style="opacity: 1;cursor:pointer"></div></a>'}}),a.push({field:"lineAmountID",caption:"lineAmountID",hidden:!0,resizable:!1,min:0,max:0}),a.push({field:"CalculateDimValAmt",caption:"CalculateDimValAmt",hidden:!0,resizable:!1,min:0,max:0}),a.push({field:"C_BPartner_ID",caption:"C_BPartner",hidden:!0,resizable:!1,min:0,max:0}),we=(we="gridAmountDivision"+Math.random()).replace(".",""),At=we,w2utils.encodeTags([]),be=t(Ce).w2grid({name:we,recordHeight:20,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!1,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:a,records:n,onClick:function(n){if(4==n.column&&be.records.length>0){Te=n.recid;var a=be.get(n.recid).lineAmountID,s=[];-1==a.search(",")?s[0]=a:s=a.split(","),function(n,a,s){$t("visible");var r=[];it.css("display","table"),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?mt.css({width:"11%","padding-right":"0"}):(Ye.css("width","33.3%"),null!=mt&&null!=mt&&mt.css("width","33.3%"));Ae=!0,Pe=[],0==l.val()?Pe=Xe:Pe[0]=l.val();t.ajax({dataType:"json",type:"POST",url:e.Application.contextUrl+"AmountDivision/GetDiminsionLine",data:{accountingSchema:JSON.stringify(Pe),dimensionID:i,DimensionLineID:n[0],pageNo:De,pSize:Ie},success:function(e){if(e){r=JSON.parse(e),xe=s,Tt=n.toString();var t=o.val();DimensionNameVal=r[0].DimensionNameVal,Et=r[0].DimensionNameVal,q.setValue(r[0].CalculateDimValAmt),Vt=r[0].CalculateDimValAmt,Bt=r[0].C_BPartner_ID,"AC"==o.val()?(Ut=r[0].ElementID,ve.setValue(DimensionNameVal),Oe.setValue(r[0].C_BPartner_ID>0?r[0].C_BPartner_ID:-1)):"AY"==t?(K.focus(),K.val(DimensionNameVal)):"BP"==t?(Oe.getControl(0).val(Oe.getDisplay()),Oe.setValue(DimensionNameVal)):"LF"==t||"LT"==t?(Le.getControl(0).val(Le.getDisplay()),Le.setValue(DimensionNameVal)):"MC"==t?(X.focus(),X.val(DimensionNameVal)):"OO"==t||"OT"==t?(G.focus(),G.val(DimensionNameVal)):"PJ"==t?(Re.getControl(0).val(Re.getDisplay()),Re.setValue(DimensionNameVal)):"PR"==t?(Ee.getControl(0).val(Ee.getDisplay()),Ee.setValue(DimensionNameVal)):"SA"==t||("SR"==t?(ee.focus(),ee.val(DimensionNameVal)):"U1"==t||"U2"==t?(Ut=r[0].ElementID,ve.setValue(DimensionNameVal),Oe.setValue(r[0].C_BPartner_ID>0?r[0].C_BPartner_ID:-1)):"X1"!=t&&"X2"!=t&&"X3"!=t&&"X4"!=t&&"X5"!=t&&"X6"!=t&&"X7"!=t&&"X8"!=t&&"X9"!=t||(ie.focus(),ie.val(DimensionNameVal))),$t("hidden")}}})}(s,be.get(n.recid).CalculateDimValAmt,n.recid)}5==n.column&&be.records.length>0&&(p.html()==e.Msg.getMsg("Update")&&Te==n.recid?e.ADialog.warn("PleaseFirstUpdateThisRecord"):function(t,n,a){e.ADialog.confirm("DeleteConfirm",!0,"","Confirm",(function(s){if(s){$t("visible"),e.dataContext.getJSONRecord("AmountDivision/SetDimLine",{dLineId:t,acctId:Pe[0],dAmtId:i}),w2ui[At].select(a),console.log("selected Rows : "+w2ui[At].getSelection().length),w2ui[At].delete(!0);var l=parseFloat((I.getValue()-parseFloat(n)).toFixed(Ot));I.setValue(l),Ht(),$t("hidden")}}))}(be.get(n.recid).lineAmountID,be.get(n.recid).CalculateDimValAmt,n.recid))}}),"AC"!=o.val()&&"U1"!=o.val()&&"U2"!=o.val()||be.showColumn("C_BPartner")};this.show=function(){var a,s;hi(),Ue.getRoot(),$t("visible"),c.addVetoableChangeListener(this),q.addVetoableChangeListener(this),a=n,s=function(){Jt(Xe,!0,(function(e){gi(e),Pe[0]=l.val(),Ht(),0==i||0==e.length?(Ye.css("display","none"),p.css("display","none"),Ue.getRoot().parent().css("height","390px")):(Ye.css("display","block"),p.css("display","block"),""==Nt.html()?Ue.getRoot().parent().css("height","448px"):Ue.getRoot().parent().css("height","469px")),$t("hidden")}))},t.ajax({url:e.Application.contextUrl+"AmountDivision/GetAccountingSchema",dataType:"json",data:{OrgID:a},type:"POST",error:function(){$t("hidden"),alert(e.Msg.getMsg("ErrorWhileGettingData"))},success:function(n){var a=n.dAcctId,o=!1,r=JSON.parse(n.acctData);if(r.Error)return e.ADialog.error(r.Error),void $t("hidden");l.empty().append('<option selected="selected" value="-1">Please select</option>');for(var d=0;d<r.length;d++)0==d&&l.append('<option precision="'+Ot+'" value="0">ALL</option>'),a==r[d].Key&&(o=!0),l.append(t('<option precision="'+r[d].Precision+'"></option>').val(r[d].Key).html(r[d].Value)),Xe.push(r[d].Key);if(o){var c=e.dataContext.getJSONRecord("AmountDivision/GetAcctSchemaByActId",{dAmtId:i});(""==c||null==c||c<1)&&(l.val(a),ui(a))}s&&($t("visible"),s(),$t("hidden"))}})},function(){h=t("<label>"),v=t("<label>"),f=t("<label>"),y=t("<label>"),J=t("<label>"),D=t("<label>"),Nt=t("<label>"),l=t("<select tabindex='2'>"),o=t("<select tabindex='3'>"),B=t("<select>"),c=new e.Controls.VAmountTextBox("Amount",!1,!1,!0,50,100,e.DisplayType.Amount,e.Msg.getMsg("Amount")),q=new e.Controls.VAmountTextBox("ModalAmount",!1,!1,!0,50,100,e.DisplayType.Amount,e.Msg.getMsg("Amount")),r=new e.Controls.VAmountTextBox("TotalAmount",!1,!0,!0,50,100,e.DisplayType.Amount,e.Msg.getMsg("Amount")),I=new e.Controls.VAmountTextBox("Total",!1,!0,!0,50,100,e.DisplayType.Amount,e.Msg.getMsg("Amount")),p=t("<a style='cursor:pointer;' tabindex='7'>"),g=t("<a>"),H=t("<a style='cursor:pointer;' tabindex='12'>"),z=t("<a style='cursor:pointer;' tabindex='13'>"),st=t("<div class='VIS-AMTD-Grid'>"),Ce=t("<div class='VIS-AMTD-SubGrid'>"),_e=t("<div class='VIS-AMTD-formDynmicInput'>"),yt=t("<div class='VIS-AMTD-formDynmicInput'>"),t("<button>"),t("<button>"),it=t("<div class='VIS-AMTD-Modal' id='updateModal'>"),nt=t("<div class='VIS-AMTD-Modal-Content'>"),at=t("<span class='VIS-AMTD-Close'>"),statusSpanShowRecordNo=t("<label>"),statusSpanShowRecordNo.addClass("vis-statusbar-pageMsg"),at.append("X"),Dt=t('<ul class="vis-statusbar-ul"></ul>'),It=t('<div class="VIS-AMTD-StatusContainer"></div>'),wt=t('<li  style="opacity: 0.6;"><div><i class="vis vis-shiftleft" style="opacity: 1;" action="first" title="First Page" ></i></div></li>'),Dt.append(wt),bt=t('<li style="opacity: 0.6;"><div><i class="vis vis-pageup" style="opacity: 1;" action="prev" title="Page Down" ></i></div></li>'),Dt.append(bt),Ct=t('<select class="vis-statusbar-combo" style="width:50px;"></select>');var n=t("<li></li>");n.append(Ct),Dt.append(n),_t=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" style="opacity: 1;" action="next" title="Page Up" alt="Page Down" src="'+e.Application.contextUrl+'Areas/VIS/Images/base/PageDown16.png"></div></li>'),Dt.append(_t),St=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" style="opacity: 1;" action="last" title="Last Page" ></i></div></li>'),Dt.append(St),It.append(Dt),new Array,xe=0,Ae=!1,0,0,Te="",Ve="",Ne="",Me="",ke="",Oe="",Le="",Re="",Ee="",Xe="",At="",0,Xe=[],Pe=[],Vt=0,xt=!0,Tt=0,Ie=30,De=1,0,Lt=0,Rt=-1,Et=0,kt=e.DisplayType.GetNumberFormat(e.DisplayType.Amount),Fe=t("<div class='VIS-AMTD-formWrap'>"),u=t("<input type='button' class='VIS_Pref_btn-2 pull-left' tabindex='16' >"),p.append(e.Msg.getMsg("Add")),g.append(e.Msg.getMsg("Cancel")),H.append(e.Msg.getMsg("Update")),z.append(e.Msg.getMsg("Cancel")),u.val(e.Msg.getMsg("OK")),h.append(e.Msg.translate(e.Env.getCtx(),"C_AcctSchema_ID")),v.append(e.Msg.translate(e.Env.getCtx(),"ElementType")),f.append(e.Msg.getMsg("TotalAmount")),y.append(e.Msg.getMsg("Amount")),J.append(e.Msg.getMsg("Amount")),g.css("display","none"),D.append(e.Msg.getMsg("Total"));var a=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>"),m=t("<div class='vis-control-wrap'>");a.append(m),m.append(l).append(h);var w=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>"),b=t("<div class='vis-control-wrap'>"),_=t('<div class="vis-excelimportbtn VIS-AMTD-formBtns" style=" display: block; "><a tabindex="" class="vis vis-doc-excel"></a></div>');w.append(b),w.append(_),b.append(o).append(v);var x=t('<div style="float: right;margin-right: 5px;display:none" ><input id="VIS-AMTD-file-input" style="display:none" type="file"  accept=".xls,.xlsx"><label title="'+e.Msg.getMsg("VIS_ExcelImport")+'"  for="VIS-AMTD-file-input" ></label></div>');w.append(x),jt=w.find("#VIS-AMTD-file-input");var T=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>"),N=t("<div class='vis-control-wrap'>");T.append(N),N.append(r.getControl().attr("placeholder"," ").attr("data-placeholder","")).append(f),Ye=t("<div class='VIS-AMTD-formData VIS-AMTD-amountTxt input-group vis-input-wrap'>");var k=t("<div class='vis-control-wrap'>");Ye.append(k),k.append(c.getControl().attr("placeholder"," ").attr("data-placeholder","")).append(y),mt=t("<div class='VIS-AMTD-formData VIS-AMTD-amountTxt input-group vis-input-wrap'>");var L=t("<div class='vis-control-wrap'>");mt.append(L),mt.append(q.getControl().attr("placeholder"," ").attr("data-placeholder","")).append(J),et=t("<div class='VIS-AMTD-formBtns'>");var E=t("<div>");E.append(p),et.append(E),tt=t("<div class='VIS-AMTD-ModalformBtns'>");var U=t("<div>");U.append(H).append(z),tt.append(U);var F=t("<div class='VIS-AMTD-formData input-group vis-input-wrap'>"),Q=t("<div class='vis-control-wrap'>");function $(t){t&&(Rt=l.find("option:selected").val()),De=1,Pe=[],0!=l.val()?Pe[0]=l.val():Pe=Xe,Jt(Pe,null,(function(t){gi(t);ui(l.val(),(function(){0!=t.length?(o.val(t[0].DimensionTypeVal),ti(o.val()),c.setValue(0),Ae=!1,p.empty().append(e.Msg.getMsg("Add")),-1!=l.val()&&0!=o.val()?(Ye.css("display","block"),p.css("display","block"),""==Nt.html()?Ue.getRoot().parent().css("height","448px"):Ue.getRoot().parent().css("height","469px")):(Ye.css("display","none"),p.css("display","none"),""==Nt.html()?Ue.getRoot().parent().css("height","390px"):Ue.getRoot().parent().css("height","410px"))):(ti(o.val()),-1!=l.val()&&0!=o.val()?(Ye.css("display","block"),p.css("display","block"),""==Nt.html()?Ue.getRoot().parent().css("height","448px"):Ue.getRoot().parent().css("height","469px")):(Ye.css("display","none"),p.css("display","none"),""==Nt.html()?Ue.getRoot().parent().css("height","390px"):Ue.getRoot().parent().css("height","410px")))}))}))}nt.append(yt).append(mt).append(tt),it.append(nt),st.append(Ce).append(it).append(It),F.append(Q),Q.append(I.getControl().attr("placeholder"," ").attr("data-placeholder","")).append(D),(Mt=t("<div style='color:green;font-size:small'>")).append(Nt),Fe.append(Mt).append(T).append(a).append(w).append(_e).append(Ye).append(et),me.append(Fe).append(st).append(F).append(u),fe.append(me).append(ye),s&&me.addClass("VIS-AMTD-ReadOnly"),l.on("change",(function(){$t("visible");var t=!0;0==l.val()&&(t=!1,Jt(Xe,null,(function(t){0!=t.length&&e.ADialog.confirm("ConfirmSelectAllAcctSchema",!0,"","Confirm",(function(t){t?($t("visible"),Xe.length&&e.dataContext.getJSONRecord("AmountDivision/SetDAcctType",{allAcctSchemaID:Xe,did:i}),Ht(),Jt(Xe,null,(function(t){$t("visible"),gi(t),Rt=l.find("option:selected").val(),xe=0,c.setValue(0),Ae=!1,g.css("display","none"),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?Ye.css("width","26%"):Ye.css("width","33.3%"),p.empty().append(e.Msg.getMsg("Add")),I.setValue(0),$(!1)}))):(l.val(Rt),o.val(Lt),$(!1))}))}))),Jt(Xe,null,(function(e){$(t),$t("hidden")})),Ot=l.find("option:selected").attr("precision")})),o.on("change",(function(t){$t("visible"),Jt(Pe,null,(function(t){if(0!=t.length)e.ADialog.confirm("ConfirmChangeDimensionType",!0,"","Confirm",(function(t){if(!t)return o.val(Lt),qt(),$t("hidden"),!1;$t("visible"),ti(o.val()),Lt=o.find("option:selected").val(),c.setValue(0),Ae=!1,g.css("display","none"),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?Ye.css("width","26%"):Ye.css("width","33.3%"),p.empty().append(e.Msg.getMsg("Add")),Xe.length&&e.dataContext.getJSONRecord("AmountDivision/SetDAcctType",{allAcctSchemaID:Xe,did:i}),Jt(Pe,null,(function(e){gi(e),Ht(),I.setValue(0)})),$t("hidden"),qt()}));else{if(ti(o.val()),!Ft)return $t("hidden"),e.ADialog.warn("VIS_ElementDifferent"),!1;Lt=o.find("option:selected").val(),"AC"==o.val()?be.showColumn("C_BPartner"):be.hideColumn("C_BPartner")}qt(),o.focus(),$t("hidden")}))})),p.on("keydown",(function(e){if(13==e.keyCode&&($t("visible"),zt())){Ae||xe++;var t=o.find("option:selected").val();"AC"==t?(Xt(o.find("option:selected").text(),W.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),j.getValue(),Ut,0,Ve.getValue(),M.val()),B.val("-1"),j.setValue("-1")):"AY"==t?(Xt(o.find("option:selected").text(),C.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),C.find("option:selected").val(),-1,0,0,""),C.val(-1)):"BP"==t?(Xt(o.find("option:selected").text(),M.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Ve.getValue(),-1,0,0,""),M.val(""),Ve.setValue("-1")):"LF"==t||"LT"==t?(Xt(o.find("option:selected").text(),O.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Ne.getValue(),-1,0,0,""),O.val(""),Ne.setValue("-1")):"MC"==t?(Xt(o.find("option:selected").text(),S.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),S.find("option:selected").val(),-1,0,0,""),S.val(-1)):"OO"==t||"OT"==t?(Xt(o.find("option:selected").text(),d.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),d.find("option:selected").val(),-1,0,0,""),d.val("-1")):"PJ"==t?(Xt(o.find("option:selected").text(),R.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Me.getValue(),-1,0,0,""),R.val(""),Me.setValue("-1")):"PR"==t?(Xt(o.find("option:selected").text(),P.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ke.getValue(),-1,0,0,""),P.val(""),ke.setValue("-1")):"SA"==t?Xt(o.find("option:selected").text(),"",c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),"",-1,0,0,""):"SR"==t?(Xt(o.find("option:selected").text(),A.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),A.find("option:selected").val(),-1,0,0,""),A.val("-1")):"U1"==t||"U2"==t?(Xt(o.find("option:selected").text(),W.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),j.getValue(),Ut,0,Ve.getValue(),M.val()),B.val("-1"),W.val(""),j.setValue("-1")):"X1"!=t&&"X2"!=t&&"X3"!=t&&"X4"!=t&&"X5"!=t&&"X6"!=t&&"X7"!=t&&"X8"!=t&&"X9"!=t||(Xt(o.find("option:selected").text(),V.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),V.find("option:selected").val(),-1,0,0,""),V.val(-1))}})),p.on("click",(function(){if($t("visible"),zt()){Ae||xe++;var e=o.find("option:selected").val();"AC"==e?(Xt(o.find("option:selected").text(),W.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),j.getValue(),Ut,0,Ve.getValue(),M.val()),B.val("-1"),j.setValue("-1"),M.val(""),Ve.setValue("-1")):"AY"==e?(Xt(o.find("option:selected").text(),C.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),C.find("option:selected").val(),-1,0,0,""),C.val(-1)):"BP"==e?(Xt(o.find("option:selected").text(),M.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Ve.getValue(),-1,0,0,""),M.val(""),Ve.setValue("-1")):"LF"==e||"LT"==e?(Xt(o.find("option:selected").text(),O.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Ne.getValue(),-1,0,0,""),O.val(""),Ne.setValue("-1")):"MC"==e?(Xt(o.find("option:selected").text(),S.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),S.find("option:selected").val(),-1,0,0,""),S.val(-1)):"OO"==e||"OT"==e?(Xt(o.find("option:selected").text(),d.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),d.find("option:selected").val(),-1,0,0,""),d.val("-1")):"PJ"==e?(Xt(o.find("option:selected").text(),R.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Me.getValue(),-1,0,0,""),R.val(""),Me.setValue("-1")):"PR"==e?(Xt(o.find("option:selected").text(),P.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ke.getValue(),-1,0,0,""),P.val(""),ke.setValue("-1")):"SA"==e?Xt(o.find("option:selected").text(),"",c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),"",-1,0,0,""):"SR"==e?(Xt(o.find("option:selected").text(),A.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),A.find("option:selected").val(),-1,0,0,""),A.val("-1")):"U1"==e||"U2"==e?(Xt(o.find("option:selected").text(),W.val(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),j.getValue(),Ut,0,Ve.getValue(),M.val()),B.val("-1"),W.val(""),j.setValue("-1")):"X1"!=e&&"X2"!=e&&"X3"!=e&&"X4"!=e&&"X5"!=e&&"X6"!=e&&"X7"!=e&&"X8"!=e&&"X9"!=e||(Xt(o.find("option:selected").text(),V.find("option:selected").text(),c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),V.find("option:selected").val(),-1,0,0,""),V.val(-1))}})),_.on("click",(function(){if(t("#VIS-AMTD-file-input").val(""),"0"==o.val())return e.ADialog.error("VIS_DimensionType",!0,"",""),!1;jt.trigger("click")})),jt.on("change",(function(i){var n=this,a=new Array(".xlsx",".xls"),s=t("#VIS-AMTD-file-input").val();if(s=s.substring(s.lastIndexOf(".")),a.indexOf(s)<0)return e.ADialog.error("VIS_InValidFile",!0,"",""),!1;window.setTimeout((function(){$t("visible"),_result=t.parseJSON(e.UploadAmountDimension(n,null)),function(i){if(null!=i){if(null==i._filename||""==i._filename||null==i._path||""==i._path)return;if(null!=i._error&&""!=i._error)return void e.ADialog.info(i._error,null,"","");var n=i._path,a=(i._filename,o.find("option:selected").val()),s=l.find("Option:selected").val(),d=parseFloat(r.getValue()),c=[];c.push(n),c.push(a),c.push(s),c.push(d),t.ajax({url:e.Application.contextUrl+"AmountDivision/GetDataFromExcelOrText",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify(c),success:function(t){var i=!0;i=function(t){var i=parseFloat(r.getValue());t=JSON.parse(t);var n=parseFloat(t.result[0].TotalAmount);if(i>0&&n>i||i<0&&Math.abs(n)>Math.abs(i))return e.ADialog.warn("LineTotalNotGrater"),$t("hidden"),!1;Gt=0;for(var a=0;a<t.result.length;a++){var s=o.find("option:selected").val();"AY"==s||"BP"==s||"MC"==s||"OO"==s||"OT"==s||"PJ"==s||"PR"==s||"SR"==s?parseInt(t.result[a].Record_ID)>0&&(Xt(o.find("option:selected").text(),t.result[a]["Search Key/Name"],t.result[a].Amount,xe,l.find("Option:selected").val(),o.find("option:selected").val(),t.result[a].Record_ID,-1,Tt,0,""),Gt++):"U1"==s||"U2"==s||"AC"==s?0!=t.result[a].AccoutId&&0!=t.result[a].BPartnerId&&(Xt(o.find("option:selected").text(),t.result[a].AccountValue,t.result[a].Amount,xe,l.find("Option:selected").val(),o.find("option:selected").val(),t.result[a].AccoutId,t.result[a].C_Element_ID,Tt,t.result[a].BPartnerId,t.result[a]["Search Key/Name"]),ge.val("-1"),he.val(""),ve.setValue("-1"),Gt++):"X1"!=s&&"X2"!=s&&"X3"!=s&&"X4"!=s&&"X5"!=s&&"X6"!=s&&"X7"!=s&&"X8"!=s&&"X9"!=s||0!=parseInt(t.result[a].Record_ID)&&(Xt(o.find("option:selected").text(),t.result[a]["Search Key/Name"],t.result[a].Amount,xe,l.find("Option:selected").val(),o.find("option:selected").val(),t.result[a].Record_ID,-1,Tt,0,""),ie.val(-1),Gt++)}$t("hidden")}(t),0==Gt&&i&&e.ADialog.warn("VIS_InCorrectData",null,"","")},error:function(){Wt[0].style.visibility="hidden",e.ADialog.info(e.Msg.getMsg("error"),null,"","")}})}}(_result)}),400)})),g.on("click",(function(){$t("visible"),ti(o.val()),c.setValue(0),Ae=!1,g.css("display","none"),"AC"==o.val()||"U1"==o.val()||"U2"==o.val()?Ye.css("width","26%"):Ye.css("width","33.3%"),p.empty().append(e.Msg.getMsg("Add")),$t("hidden")})),H.on("keydown",(function(e){if(13==e.keyCode&&($t("visible"),zt())){var t=o.find("option:selected").val();"AC"==t?(Xt(o.find("option:selected").text(),he.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ve.getValue(),Ut,Tt,Oe.getValue(),ae.val()),ge.val("-1"),ve.setValue("-1"),ae.val(""),Oe.setValue("-1")):"AY"==t?(Xt(o.find("option:selected").text(),K.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),K.find("option:selected").val(),-1,Tt,0,""),K.val(-1)):"BP"==t?(Xt(o.find("option:selected").text(),ae.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Oe.getValue(),-1,Tt,0,""),ae.val(""),Oe.setValue("-1")):"LF"==t||"LT"==t?(Xt(o.find("option:selected").text(),le.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Le.getValue(),-1,Tt,0,""),le.val(""),Le.setValue("-1")):"MC"==t?(Xt(o.find("option:selected").text(),X.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),X.find("option:selected").val(),-1,Tt,0,""),X.val(-1)):"OO"==t||"OT"==t?(Xt(o.find("option:selected").text(),G.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),G.find("option:selected").val(),-1,Tt,0,""),G.val("-1")):"PJ"==t?(Xt(o.find("option:selected").text(),re.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Re.getValue(),-1,Tt,0,""),re.val(""),Re.setValue("-1")):"PR"==t?(Xt(o.find("option:selected").text(),ce.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Ee.getValue(),-1,Tt,0,""),ce.val(""),Ee.setValue("-1")):"SA"==t?Xt(o.find("option:selected").text(),"",c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),"",-1,Tt,0,""):"SR"==t?(Xt(o.find("option:selected").text(),ee.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ee.find("option:selected").val(),-1,Tt,0,""),ee.val("-1")):"U1"==t||"U2"==t?(Xt(o.find("option:selected").text(),he.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ve.getValue(),Ut,Tt,0,""),ge.val("-1"),he.val(""),ve.setValue("-1")):"X1"!=t&&"X2"!=t&&"X3"!=t&&"X4"!=t&&"X5"!=t&&"X6"!=t&&"X7"!=t&&"X8"!=t&&"X9"!=t||(Xt(o.find("option:selected").text(),ie.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ie.find("option:selected").val(),-1,Tt,0,""),ie.val(-1))}})),H.on("click",(function(){if($t("visible"),zt()){var e=o.find("option:selected").val();"AC"==e?(Xt(o.find("option:selected").text(),he.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ve.getValue(),Ut,Tt,Oe.getValue(),ae.val()),ge.val("-1"),ve.setValue("-1"),ae.val(""),Oe.setValue("-1")):"AY"==e?(Xt(o.find("option:selected").text(),K.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),K.find("option:selected").val(),-1,Tt,0,""),K.val(-1)):"BP"==e?(Xt(o.find("option:selected").text(),ae.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Oe.getValue(),-1,Tt,0,""),ae.val(""),Oe.setValue("-1")):"LF"==e||"LT"==e?(Xt(o.find("option:selected").text(),le.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Le.getValue(),-1,Tt,0,""),le.val(""),Le.setValue("-1")):"MC"==e?(Xt(o.find("option:selected").text(),X.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),X.find("option:selected").val(),-1,Tt,0,""),X.val(-1)):"OO"==e||"OT"==e?(Xt(o.find("option:selected").text(),G.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),G.find("option:selected").val(),-1,Tt,0,""),G.val("-1")):"PJ"==e?(Xt(o.find("option:selected").text(),re.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Re.getValue(),-1,Tt,0,""),re.val(""),Re.setValue("-1")):"PR"==e?(Xt(o.find("option:selected").text(),ce.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),Ee.getValue(),-1,Tt,0,""),ce.val(""),Ee.setValue("-1")):"SA"==e?Xt(o.find("option:selected").text(),"",c.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),"",-1,Tt,0,""):"SR"==e?(Xt(o.find("option:selected").text(),ee.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ee.find("option:selected").val(),-1,Tt,0,""),ee.val("-1")):"U1"==e||"U2"==e?(Xt(o.find("option:selected").text(),he.val(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ve.getValue(),Ut,Tt,0,""),ge.val("-1"),he.val(""),ve.setValue("-1")):"X1"!=e&&"X2"!=e&&"X3"!=e&&"X4"!=e&&"X5"!=e&&"X6"!=e&&"X7"!=e&&"X8"!=e&&"X9"!=e||(Xt(o.find("option:selected").text(),ie.find("option:selected").text(),q.getValue(),xe,l.find("Option:selected").val(),o.find("option:selected").val(),ie.find("option:selected").val(),-1,Tt,0,""),ie.val(-1))}})),z.on("click",(function(){Ae=!1,it.css("display","none")})),z.on("keydown",(function(e){13==e.keyCode&&(Ae=!1,it.css("display","none"))})),Dt.on(e.Events.onTouchStartOrClick,"LI",(function(e){if($t("visible"),"first"==t(e.target).attr("action"))1!=De&&(De=1,Jt(Pe,null,(function(e){gi(e),Ct.val(De)})));else if("prev"==t(e.target).attr("action"))1!=De&&(De--,Jt(Pe,null,(function(e){gi(e),Ct.val(De)})));else if("next"==t(e.target).attr("action")){var i=Kt();if(De>=i)return void $t("hidden");De++,Jt(Pe,null,(function(e){gi(e),Ct.val(De)}))}else if("last"==t(e.target).attr("action")){i=Kt();if(De>=i)return void $t("hidden");De=i,Jt(Pe,null,(function(e){gi(e),Ct.val(De)}))}$t("hidden")})),Ct.on("change",(function(){$t("visible"),De!=Ct.val()&&(De=Ct.val(),Jt(Pe,null,(function(e){gi(e),Ct.val(De)}))),$t("hidden")})),u.on("click",(function(){$t("visible"),Math.abs(parseFloat(I.getValue()))>Math.abs(parseFloat(r.getValue()))?(e.ADialog.warn("LineTotalNotGrater"),r.getControl().focus(),$t("hidden")):""!=r.getValue()&&0!=r.getValue()?(Pe=[],0==l.val()?Pe=Xe:Pe[0]=l.val(),Yt(i,r.getValue(),-1,Pe,"","","",-1,-1,-1,0,"",0,(function(){Ze.onClosing(i),Ue.close()}))):(Ze.onClosing(i),Ue.close())}))}();var hi=function(){Ue.setContent(fe),Ue.setWidth(750),Ue.setTitle(e.Msg.getMsg("AmountDimension")),Ue.setModal(!0),Ue.setEnableResize(!1),Ue.show(),Ue.hideButtons(),Ue.onClose=function(){Ze.onClosing(i),Ze.onClose&&Ze.onClose()}}}}(VIS,jQuery)},8448:()=>{!function(e,t){e.AppointmentsForm={init:function(e,i,n,a,s,l){if(window.WSP){var o=t("<div id='divAptBusy' class='wsp-busy-indicater'></div>");t("body").append(o),0==s?(o.show(),WSP.AppointmentsForm.init(e,i,n,a,o,l)):(o.show(),WSP.TaskForm.init(e,i,n,a,o,l))}else alert("please download WSP !!!")}}}(VIS,jQuery)},9740:()=>{!function(e,t){e.Apps=e.Apps||{},e.Apps.AForms=e.Apps.AForms||{};e.Application.contextUrl;function i(){this.log=e.Logging.VLogger.getVLogger("VIS.ArchiveViewer"),this.frame,this.windowNo;var i=0,n=0,a=this,s=!1,l=t("<div class='vis-forms-container' style='width: 100%; height: 100%; background-color: white;'>"),o=t('<div class="vis-busyindicatorouterwrap" style="visibility: hidden"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),r=[],d=null,c=0,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=null;this.btnToggal=null;var q=null,H=null,z=null,Q=null,J=null,$=null,K=null,Y=null,X=260,Z=50,ee=t(window).width()-X,te=t(window).width()-Z,ie=(t(window).height(),t(window).height()-382),ne=t(window).height()-(ie+55+118);function ae(){var t="",s=p.find("input").prop("checked"),l=null;l=e.MRole.getDefault();try{if(!l.getIsCanReport())return void a.log.warning("User/Role cannot Report AD_User_ID="+e.context.getAD_User_ID());var o;if(t=t.concat(" AND IsReport=").concat(s?"'Y'":"'N'"),s)""!=(o=x.getControl().find("option:selected").val())&&null!=o&&(t=t.concat(" AND AD_Process_ID=").concat(o));if(i>0)t=t.concat(" AND ((AD_Table_ID=").concat(i),n>0&&(t=t.concat(" AND Record_ID=").concat(n)),t=t.concat(")"),i==X_C_BPartner.Table_ID&&n>0&&(t=t.concat(" OR C_BPartner_ID=").concat(n)),t=t.concat(")"),i=0,n=0;else""!=(o=w.getControl().find("option:selected").val())&&null!=o&&(t=t.concat(" AND AD_Table_ID=").concat(o));if(!s){var r=D.getValue();t=null!=r?t.concat(" AND C_BPartner_ID=").concat(r):t.concat(" AND C_BPartner_ID IS NOT NULL")}var d=b.getControl().val();null!=d&&"%%"!=d&&d.length>0&&(t=-1!=d.indexOf("%")||-1!=d.indexOf("_")?t.concat(" AND LOWER(Name) LIKE LOWER( ").concat("'").concat(d).concat("')"):t.concat(" AND LOWER(Name)= LOWER(").concat("'").concat(d).concat("')")),null!=(d=C.getControl().val())&&"%%"!=d&&d.length>0&&(t=-1!=d.indexOf("%")||-1!=d.indexOf("_")?t.concat(" AND LOWER(Description) LIKE LOWER( ").concat("'").concat(d).concat("')"):t.concat(" AND LOWER(Description)= LOWER(").concat("'").concat(d).concat("')")),null!=(d=_.getControl().val())&&"%%"!=d&&d.length>0&&(t=-1!=d.indexOf("%")||-1!=d.indexOf("_")?t.concat(" AND LOWER(Help) LIKE LOWER( ").concat("'").concat(d).concat("')"):t.concat(" AND LOWER(Help)= LOWER(").concat("'").concat(d).concat("')"));var c,u=S.getControl().find("option:selected").val();null!=u&&u>0&&(t=t.concat(" AND CreatedBy=").concat(u)),""!=(c=A.val())&&(t=t.concat(" AND ").concat("TRUNC(").concat("Created,'DD') >= ").concat(e.DB.to_date(c))),""!=(c=T.val())&&(t=t.concat(" AND ").concat("TRUNC(").concat("Created,'DD') <= ").concat(e.DB.to_date(c))),a.log.fine(t.toString()),t=(t=t.concat(" AND (AD_Process_ID IS NULL OR AD_Process_ID IN (SELECT AD_Process_ID FROM AD_Process_Access WHERE AD_Role_ID=").concat(e.context.getAD_Role_ID()).concat("))")).concat(" AND (AD_Table_ID IS NULL OR (AD_Table_ID IS NOT NULL AND AD_Process_ID IS NOT NULL) OR AD_Table_ID IN (SELECT t.AD_Table_ID FROM AD_Tab t INNER JOIN AD_Window_Access wa ON (t.AD_Window_ID=wa.AD_Window_ID) WHERE wa.AD_Role_ID=").concat(e.context.getAD_Role_ID()).concat("))"),a.log.finest(t.toString())}catch(e){}!function(t){var i=[];try{for(var n=e.dataContext.getJSONData(e.Application.contextUrl+"ArchiveViewer/GetArchieveData",{whereClause:t}),a=(new e.DB.DataReader).toJson(JSON.stringify(n)),s=1;a.read();){var l={};l.NAME=a.getString("NAME"),l.DESCRIPTION=a.getString("DESCRIPTION"),l.HELP=a.getString("HELP"),l.CREATEDBY=oe(a.getString("CREATEDBY"));var o=a.getString("CREATED"),r=new Date(o);CreatedOn=r.toLocaleDateString(),l.CREATED=CreatedOn,l.AD_ARCHIVE_ID=a.getInt("AD_ARCHIVE_ID"),l.recid=s,s++,i.push(l)}a.close()}catch(e){}le(i)}(t)}function se(e,t){return null==e?null==t:null!=t&&e.equals(t)}function le(i){null!=d&&(d.destroy(),d=null),0==r.length&&(r.push({field:"NAME",caption:e.Msg.translate(e.Env.getCtx(),"NAME"),sortable:!0,size:"16%",min:150,hidden:!1}),r.push({field:"DESCRIPTION",caption:e.Msg.translate(e.Env.getCtx(),"DESCRIPTION"),sortable:!0,size:"16%",min:150,hidden:!1}),r.push({field:"HELP",caption:e.Msg.getElement(e.Env.getCtx(),"HELP"),sortable:!0,size:"16%",min:150,hidden:!1}),r.push({field:"CREATEDBY",caption:e.Msg.getElement(e.Env.getCtx(),"CREATEDBY"),sortable:!0,size:"16%",min:150,hidden:!1}),r.push({field:"CREATED",caption:e.Msg.getElement(e.Env.getCtx(),"CREATED"),sortable:!0,size:"16%",min:150,hidden:!1}),r.push({field:"View",caption:e.Msg.translate(e.Env.getCtx(),"View"),sortable:!0,size:"80px",min:150,hidden:!1,render:function(){return'<div><i class="vis vis-download" title="View record" style="opacity: 1; font-size: 1rem"></i></div>'}}),r.push({field:"AD_ARCHIVE_ID",caption:e.Msg.translate(e.Env.getCtx(),"AD_ARCHIVE_ID"),hidden:!0})),setTimeout(10),w2utils.encodeTags(i),d=t($).w2grid({name:"gridArchive"+a.windowNo,recordHeight:40,columns:r,records:i,onClick:function(i){var n;5==i.column&&d.records.length>0&&(n=i.recid,c=d.get(n).AD_ARCHIVE_ID,t.ajax({url:e.Application.contextUrl+"Common/DownloadPdf",dataType:"json",data:{archiveId:c},success:function(t){null!=t.result&&(t.result.indexOf("TempDownload")>-1?window.open(e.Application.contextUrl+t.result):window.open("data:application/pdf;base64, "+t.result))}})),function(e){L.getControl().val(d.get(e).NAME),R.getControl().val(d.get(e).DESCRIPTION),E.getControl().val(d.get(e).HELP),P.getControl().val(d.get(e).CREATEDBY),null!=d.get(e).CREATED&&U.val(d.get(e).CREATED);c=d.get(e).AD_ARCHIVE_ID}(i.recid)}})}function oe(t){var i="";try{var n=e.dataContext.getJSONData(e.Application.contextUrl+"ArchiveViewer/GetUserName",{userId:t}),a=(new e.DB.DataReader).toJson(JSON.stringify(n));a.read()&&(i=a.getString("Name")),a.close()}catch(e){}return i}function re(){if(null!=B&&B.on(e.Events.onTouchStartOrClick,(function(){o[0].style.visibility="visible",ae(),L.getControl().val(""),R.getControl().val(""),E.getControl().val(""),P.getControl().val(""),U.val(null),o[0].style.visibility="hidden"})),null!=W&&W.on(e.Events.onTouchStartOrClick,(function(){o[0].style.visibility="visible",function(){if(!(d.getSelection().length<0)){var i=L.getControl().val(),n=R.getControl().val(),a=E.getControl().val(),s=Number(d.getSelection().toString());if(null!=d.get(s)){var l=!1;se(i,d.get(s).NAME)||null!=i&&i.length>0&&(l=!0),se(n,d.get(s).DESCRIPTION)||(l=!0),se(a,d.get(s).HELP)||(l=!0),c=d.get(s).AD_ARCHIVE_ID,l&&t.ajax({url:e.Application.contextUrl+"Common/UpdateArchive",dataType:"json",data:{name:i,des:n,help:a,archiveId:c},success:function(e){e.result&&ae()}})}}}(),o[0].style.visibility="hidden"})),null!=j&&j.on(e.Events.onTouchStartOrClick,(function(){alert("btnNext")})),null!=G&&G.on(e.Events.onTouchStartOrClick,(function(){alert("btnPre")})),null!=this.btnToggal)var i=0;this.btnToggal.on(e.Events.onTouchStartOrClick,(function(){s?(i=e.Application.isRTL?180:0,btnToggal.animate({borderSpacing:i},{step:function(e,i){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!1,q.animate({width:X},"slow"),z.animate({width:X},"slow"),z.find("table").css("display","block"),B.css("display","block"),H.animate({width:ee},"slow",null,(function(){d.resize()}))):(i=e.Application.isRTL?0:180,btnToggal.animate({borderSpacing:i},{step:function(e,i){t(this).css("-webkit-transform","rotate("+e+"deg)"),t(this).css("-moz-transform","rotate("+e+"deg)"),t(this).css("transform","rotate("+e+"deg)")},duration:"slow"},"linear"),s=!0,q.animate({width:Z},"slow"),z.animate({width:Z},"slow"),z.find("table").css("display","none"),B.css("display","none"),H.animate({width:te},"slow",null,(function(){d.resize()})))})),p.change((function(){x.getControl().hide(),g.getControl().hide(),t(".VIS-Search-hide").show(),p.find("input").prop("checked")&&(x.getControl().show(),g.getControl().show(),t(".VIS-Search-hide").hide())}))}this.sizeChanged=function(e,t){ee=t-261,te=t-51,1==s?(q.animate({width:Z},"slow"),z.animate({width:Z},"slow"),z.find("table").css("display","none"),B.css("display","none"),H.animate({width:te},"slow",null,(function(){d.resize()}))):(q.animate({width:X},"slow"),z.animate({width:X},"slow"),z.find("table").css("display","block"),B.css("display","block"),H.animate({width:ee},"slow",null,(function(){d.resize()})))},this.display=function(){le()},this.load=function(){!function(){p=t("<label id='lblReportQ_"+a.windowNo+"' class='vis-ec-col-lblchkbox'><input id='chkReportQ_"+a.windowNo+"' type='checkbox' style='margin-left: 0px;' class='VIS_Pref_automatic'>"+e.Msg.translate(e.Env.getCtx(),"IsReport")+"</label>"),u=new e.Controls.VLabel,g=new e.Controls.VLabel,h=new e.Controls.VLabel,v=new e.Controls.VLabel,f=new e.Controls.VLabel,m=new e.Controls.VLabel,y=new e.Controls.VLabel,I=new e.Controls.VLabel;var i=e.MLookupFactory.get(e.Env.getCtx(),a.windowNo,0,e.DisplayType.Search,"C_BPartner_ID",0,!1,null);D=new e.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,e.DisplayType.Search,i),w=new e.Controls.VComboBox("",!1,!1,!0),x=new e.Controls.VComboBox("",!1,!1,!0),b=new e.Controls.VTextBox("NameQ",!1,!1,!0,50,50,"NameQ"),C=new e.Controls.VTextBox("DescriptionQ",!1,!1,!0,50,50,"DescriptionQ"),_=new e.Controls.VTextBox("CommentQ",!1,!1,!0,50,50,"CommentQ"),b.getControl().val("%%"),C.getControl().val("%%"),_.getControl().val("%%"),S=new e.Controls.VComboBox("",!1,!1,!0),A=t("<input id='dtpCreatedFromQ_"+a.windowNo+"' type='date'>"),T=t("<input id='dtpCreatedToQ_"+a.windowNo+"' type='date'>"),V=new e.Controls.VLabel,N=new e.Controls.VLabel,M=new e.Controls.VLabel,k=new e.Controls.VLabel,O=new e.Controls.VLabel,P=new e.Controls.VTextBox("CreatedBy",!1,!0,!0,50,50,"CreatedBy"),L=new e.Controls.VTextBox("Name",!1,!1,!0,50,50,"Name"),R=new e.Controls.VTextBox("Description",!1,!1,!0,50,50,"Description"),E=new e.Controls.VTextArea("Comment",!1,!1,!0,200,200),U=t("<input id='dtpCreatedOn_"+a.windowNo+"' readonly class='vis-gc-vpanel-table-readOnly'>"),F=new e.Controls.VLabel,B=t("<input id='btnOk_"+a.windowNo+"' class='VIS_Pref_btn-2 vis-frm-button' style=' margin-top: 0px; margin-right: 0px;' type='button' value='Ok'>"),W=t("<input id='btnSave_"+a.windowNo+"' class='VIS_Pref_btn-2' style='margin-top: 0px;float: right;' type='button' value='Save'>"),j=t("<input id='btnNext_"+a.windowNo+"' class='VIS_Pref_btn-2' style='margin: 10px; display: none;'  type='button' value='>>'>"),G=t("<input id='btnPre_"+a.windowNo+"' class='VIS_Pref_btn-2' style='margin: 10px; display: none;' type='button' value='<<'>"),W.val(e.Msg.getMsg("Save")),B.val(e.Msg.getMsg("OK")),e.Application.contextUrl,q=t("<div class='vis-archive-left-sidebar' id='topLeftDiv_"+a.windowNo+"'><div id='topToggalDiv_"+a.windowNo+"' class='vis-archive-l-s-head'><button id='btnToggal_"+a.windowNo+"' class='vis-archive-sb-t-button'><i class='vis vis-arrow-left'></i></button></div></div>"),this.btnToggal=q.find("#btnToggal_"+a.windowNo),z=t("<div class='vis-archive-l-s-content vis-leftsidebarouterwrap' id='topleftparaDiv_"+a.windowNo+"'>"),Q=t("<div  class='vis-archive-l-s-content-inner' id='topleftInnerParaDiv_"+a.windowNo+"'>"),z.append(Q),q.append(z),q.css("width",X);var n=t("<table style='width: 100%' class='vis-formouterwrpdiv'>"),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">');Q.append(n),n.append(s),s.append(r),r.append(d),d.append(c),c.append(p),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">');var Z=t('<div class="input-group-append">');n.append(s),s.append(r),r.append(d),d.append(c),d.append(Z),c.append(D.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ").addClass("VIS-Search-hide")),Z.append(D.getBtn(0).addClass("VIS-Search-hide")),c.append(u.getControl().addClass("VIS-Search-hide").addClass("VIS_Pref_Label_Font")),c.append(x.getControl()),c.append(g.getControl().addClass("VIS_Pref_Label_Font")),g.getControl().hide(),x.getControl().hide(),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(w.getControl()),c.append(h.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(b.getControl().attr("data-placeholder","").attr("placeholder"," ")),c.append(v.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(C.getControl().attr("data-placeholder","").attr("placeholder"," ")),c.append(f.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(_.getControl().attr("data-placeholder","").attr("placeholder"," ")),c.append(m.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(S.getControl()),c.append(y.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(A),c.append(I.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td style='padding: 0px 10px 0px;'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(T),J=t("<div class='vis-frm-bot-btn-wrp' id='leftBottomDiv_"+a.windowNo+"'>"),q.append(J),J.append(B),H=t("<div id='topRightDiv_"+a.windowNo+"' class='vis-frm-grid-wrap'>"),$=t("<div id='rightTopDiv_"+a.windowNo+"' style='float: left; width: 100%; height: 55%;'>"),K=t("<div id='rightBottomDiv_"+a.windowNo+"' style='float: left; width: 100%;margin-top: 5px; margin-bottom: 10px; '>"),$.css("height","calc(100% - 274px)"),K.css("height",ne),n=t("<table style='width: 100%; ' class='vis-formouterwrpdiv'>"),s=t("<tr>"),r=t("<td colspan='4' style='text-align: right; height: 10px;'>"),K.append(n),n.append(s),s.append(r),r.append(G).append(F.getControl().css("display","inline-block").css("margin-top","20px").css("margin-right","10px").css("margin-left","10px").addClass("VIS_Pref_Label_Font")).append(j),F.getControl().css("display","none"),s=t("<tr>"),r=t("<td colspan='2' class='VIS-archive-table-padding'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(P.getControl().attr("data-placeholder","").attr("placeholder"," ").addClass("VIS_Pref_Label_Font")),c.append(V.getControl().addClass("VIS_Pref_Label_Font")),r=t("<td colspan='2' class='VIS-archive-table-padding'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(U.addClass("VIS_Pref_Label_Font")),c.append(N.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td colspan='2' class='VIS-archive-table-padding'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(L.getControl().attr("data-placeholder","").attr("placeholder"," ").addClass("VIS_Pref_Label_Font")),c.append(M.getControl().addClass("VIS_Pref_Label_Font")),r=t("<td colspan='2' class='VIS-archive-table-padding'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(R.getControl().attr("data-placeholder","").attr("placeholder"," ").addClass("VIS_Pref_Label_Font")),c.append(k.getControl().addClass("VIS_Pref_Label_Font")),s=t("<tr>"),r=t("<td colspan='4' class='VIS-archive-table-padding'>"),d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">'),n.append(s),s.append(r),r.append(d),d.append(c),c.append(E.getControl().attr("data-placeholder","").attr("placeholder"," ").addClass("VIS_Pref_Label_Font")),c.append(O.getControl().addClass("VIS_Pref_Label_Font")),(Y=t("<div style='float: left; width: 100%;height: 40px;position: relative;' id='rightBottomSaveDiv_"+a.windowNo+"'>")).append(W),H.append($).append(K).append(Y),l.append(o),l.append(q).append(H)}(),g.getControl().text(e.Msg.translate(e.Env.getCtx(),"AD_Process_ID")),h.getControl().text(e.Msg.translate(e.Env.getCtx(),"AD_Table_ID")),u.getControl().text(e.Msg.translate(e.Env.getCtx(),"C_BPartner_ID")),v.getControl().text(e.Msg.translate(e.Env.getCtx(),"Name")),f.getControl().text(e.Msg.translate(e.Env.getCtx(),"Description")),m.getControl().text(e.Msg.translate(e.Env.getCtx(),"Help")),y.getControl().text(e.Msg.translate(e.Env.getCtx(),"CreatedBy")),I.getControl().text(e.Msg.translate(e.Env.getCtx(),"Created")),V.getControl().text(e.Msg.translate(e.Env.getCtx(),"CreatedBy")),N.getControl().text(e.Msg.translate(e.Env.getCtx(),"Created")),M.getControl().text(e.Msg.translate(e.Env.getCtx(),"Name")),k.getControl().text(e.Msg.translate(e.Env.getCtx(),"Description")),O.getControl().text(e.Msg.translate(e.Env.getCtx(),"Help")),F.getControl().text(e.Msg.translate(e.Env.getCtx(),"NoRecordFound")),function(){var t,n=e.context.getAD_Role_ID(),a=!0,s="VIS_153";(t=[])[0]=new e.DB.SqlParam("@param1",n);for(var l,o,r={sql:s,param:t},d=e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/JDataSetWithCode",r),c=(new e.DB.DataReader).toJson(JSON.stringify(d));c.read();)l=e.Utility.Util.getValueOfInt(c.getString(0)),o=e.Utility.encodeText(c.getString(1)),a&&(x.getControl().append(" <option></option>"),a=!1),x.getControl().append(" <option value="+l+">"+o+"</option>");for(c.close(),a=!0,x.getControl().prop("selectedIndex",0),s="VIS_154",(t=[])[0]=new e.DB.SqlParam("@param1",n),r={sql:s,param:t},d=e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/JDataSetWithCode",r),c=(new e.DB.DataReader).toJson(JSON.stringify(d));c.read();)l=e.Utility.Util.getValueOfInt(c.getString(0)),o=e.Utility.encodeText(c.getString(1)),a&&(w.getControl().append(" <option></option>"),a=!1),w.getControl().append(" <option value="+l+">"+o+"</option>");for(c.close(),a=!0,w.getControl().prop("selectedIndex",0),d=e.dataContext.getJSONData(e.Application.contextUrl+"ArchiveViewer/GetUserList",{}),c=(new e.DB.DataReader).toJson(JSON.stringify(d));c.read();)l=e.Utility.Util.getValueOfInt(c.getString(0)),o=e.Utility.encodeText(c.getString(1)),a&&(S.getControl().append(" <option></option>"),a=!1),S.getControl().append(" <option value="+l+">"+o+"</option>");c.close(),a=!0,S.getControl().prop("selectedIndex",0),i>0&&(p.find("input").prop("checked",!0),ae())}(),re()},this.getRoot=function(){return l},this.disposeComponent=function(){l=null}}i.prototype.sizeChanged=function(e,t){},i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.load(),this.frame.getContentGrid().append(this.getRoot()),this.display()},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.ArchiveViewer=i}(VIS,jQuery)},1087:()=>{!function(e,t){e.AttachmentHistory=function(i,n,a,s,l){e.Env.getWindowNo(),e.Env.getCtx();var o,r,d,c,p,u,g,h,v,f,m,y,I,D,w,b,C,_,S,x,A,T,V,N,M,k,O,L,R,E,P,U,F,B,W,j,G,q,H,z,Q,J,$,K,Y,X,Z,ee,te,ie,ne,ae,se,le,oe,re,de,ce,pe,ue,ge,he,ve,fe,me,ye,Ie,De,we,be,Ce,_e,Se,xe,Ae,Te,Ve,Ne,Me,ke,Oe,Le,Re,Ee,Pe,Ue,Fe,Be,We,je,Ge,qe,He=[],ze=[],Qe=[],Je=[],$e=[],Ke=[],Ye=[],Xe=[],Ze=this,et=50;function tt(a){ne[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"AttachmentHistory/LoadRecordDataCount",datatype:"json",async:!1,type:"get",cache:!1,data:{searchText:a,_AD_Table_ID:i,_Record_ID:n},success:function(e){le=JSON.parse(e)}});var s=parseInt(le/et);de=s+(le%et>0?1:0),ae=1,(Ie=ye.find("select")).empty();for(var l=1;l<=de;l++)Ie.append("<option>"+l+"</option>");he.css("opacity","0.6"),me.css("opacity","0.6")}function it(a){t.ajax({url:e.Application.contextUrl+"AttachmentHistory/LoadRecordData",datatype:"json",type:"get",async:!1,cache:!1,data:{searchText:a,_AD_Table_ID:i,_Record_ID:n,historyPageNo:ae,pageSize:et},success:function(t){!function(t){ze=[],(He=[]).push({field:"id",caption:e.Msg.getMsg("id"),size:"150px",hidden:!0}),He.push({field:"record_id",caption:e.Msg.getMsg("record_id"),size:"150px",hidden:!0}),He.push({field:"created",caption:e.Msg.getMsg("Date"),size:"150px",hidden:!1}),He.push({field:"type",caption:e.Msg.getMsg("Type"),size:"150px",hidden:!1}),He.push({field:"name",caption:e.Msg.getMsg("CreatedBy"),size:"150px",hidden:!1}),1==we?He.push({field:"subject",caption:e.Msg.getMsg("Subject"),size:"150px",hidden:!1}):He.push({field:"subject",caption:e.Msg.getMsg("Subject"),size:"230px",hidden:!1});t.length>0&&(Qe=Object.keys(t[0]));for(var i=0;i<t.length;i++){var n={};n.recid=i;for(var a=0;a<Qe.length;a++){var s=Qe[a];"created"==Qe[a]?n[s]=new Date(t[i][s]).toLocaleString():n[s]=e.Utility.encodeText(t[i][s])}ze.push(n)}}(t=JSON.parse(t))},error:function(e){}})}function nt(i){null!=i&&null!=i||(i=""),t.ajax({url:e.Application.contextUrl+"AttachmentHistory/RelatedHistory",datatype:"json",type:"get",cache:!1,data:{keyColumnID:n,pageSize:et,pageNo:se,searchText:e.Utility.encodeText(i),keyColName:l},success:function(i){var n=JSON.parse(i);if(function(i){Je=[],$e=[];var n=i.RHistory;Je.push({field:"ID",caption:e.Msg.getMsg("id"),size:"150px",hidden:!0}),Je.push({field:"Record_ID",caption:e.Msg.getMsg("record_id"),size:"150px",hidden:!0}),Je.push({field:"Created",caption:e.Msg.getMsg("Date"),size:"150px",hidden:!1}),Je.push({field:"Type",caption:e.Msg.getMsg("Type"),size:"150px",hidden:!1}),e.Application.isRTL?Je.push({field:"TableName",caption:e.Msg.getMsg("Table"),size:"150px",hidden:!1,resizable:!0,style:"text-align: right",render:function(e){var i=t('<i class="findImg vis vis-find" data-ids="'+e.Record_ID+"-"+e.AD_Table_ID+'"></i>');return t("<div >").append(i).append(e.TableName).html()}}):Je.push({field:"TableName",caption:e.Msg.getMsg("Table"),size:"150px",hidden:!1,resizable:!0,style:"text-align: left",render:function(e){var i=t('<i class="findImg vis vis-find" data-ids="'+e.Record_ID+"-"+e.AD_Table_ID+'"></i>');return t("<div >").append(i).append(e.TableName).html()}});Je.push({field:"Subject",caption:e.Msg.getMsg("Subject"),size:"150px",hidden:!1}),n.length>0&&(Qe=Object.keys(n[0]));for(var a=0;a<Qe.length;a++)"ID"!=Qe[a]&&"Record_ID"!=Qe[a]&&"Created"!=Qe[a]&&"Type"!=Qe[a]&&"TableName"!=Qe[a]&&"Subject"!=Qe[a]&&Je.push({field:Qe[a],caption:e.Msg.getMsg(Qe[a]),size:"100px",hidden:!0});for(var s=0;s<n.length;s++){var l={};l.recid=s;for(a=0;a<Qe.length;a++)"Created"==Qe[a]?l[Qe[a]]=new Date(n[s][Qe[a]]).toLocaleString():"Type"==Qe[a]?"A"==n[s][Qe[a]]?l[Qe[a]]=e.Msg.getMsg("Appointment"):"T"==n[s][Qe[a]]?l[Qe[a]]=e.Msg.getMsg("Task"):"L"==n[s][Qe[a]]?l[Qe[a]]=e.Msg.getMsg("Letter"):"M"==n[s][Qe[a]]?l[Qe[a]]=e.Msg.getMsg("SentMail"):"I"==n[s][Qe[a]]&&(l[Qe[a]]=e.Msg.getMsg("InboxMail")):l[Qe[a]]=e.Utility.encodeText(n[s][Qe[a]]);$e.push(l)}}(n),null==oe||0==oe||1==rt){oe=n.TotalRecords;var a=parseInt(oe/et);se=1,ce=a+(oe%et>0?1:0),(Ie=ye.find("select")).empty();for(var s=1;s<=ce;s++)Ie.append("<option>"+s+"</option>");he.css("opacity","0.6"),me.css("opacity","0.6"),function(){null!=g&&null!=g&&(g.destroy(),g=null);(g=u.w2grid({name:"realtedhistorygrid",recordHeight:30,show:{toolbar:!0},multiSelect:!1,columns:Je,records:$e})).on("select",wt),g.on("search",It),$e.length>0?(g.select(0),N.hide(),_.show()):(N.show(),_.hide());t(".findImg").on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[1],n[0])}))}()}else!function(){g.destroy(),g=null,(g=u.w2grid({name:"realtedhistorygrid",recordHeight:30,show:{toolbar:!0},multiSelect:!1,columns:Je,records:$e})).on("select",wt),g.on("search",It),$e.length>0?(g.select(0),N.hide(),_.show()):(N.show(),_.hide());ne[0].style.visibility="hidden",t(".findImg").off("click"),t(".findImg").on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[1],n[0])}))}();ne[0].style.visibility="hidden",rt=!1},error:function(e){console.log(e),ne[0].style.visibility="hidden",rt=!1}})}function at(i){null!=i&&null!=i||(i=""),t.ajax({url:e.Application.contextUrl+"AttachmentHistory/UserHistory",datatype:"json",type:"get",cache:!1,data:{C_BPartner_ID:a,pageSize:et,pageNo:ue,searchText:e.Utility.encodeText(i)},success:function(i){var n=JSON.parse(i);if(null!=n.RHistory&&function(i){Ke=[],Ye=[];var n=i.RHistory;Ke.push({field:"ID",caption:e.Msg.getMsg("id"),size:"150px",hidden:!0}),Ke.push({field:"Record_ID",caption:e.Msg.getMsg("record_id"),size:"150px",hidden:!0}),Ke.push({field:"Created",caption:e.Msg.getMsg("Date"),size:"150px",hidden:!1}),Ke.push({field:"Type",caption:e.Msg.getMsg("Type"),size:"150px",hidden:!1}),e.Application.isRTL?Ke.push({field:"TableName",caption:e.Msg.getMsg("Table"),size:"150px",hidden:!1,resizable:!0,style:"text-align: right",render:function(e){var i=t('<i class="findImg vis vis-find" data-ids="'+e.Record_ID+"-"+e.AD_Table_ID+'" ></i>');return t("<div >").append(i).append(e.TableName).html()}}):Ke.push({field:"TableName",caption:e.Msg.getMsg("Table"),size:"150px",hidden:!1,resizable:!0,style:"text-align: left",render:function(e){var i=t('<i class="findImg vis vis-find" data-ids="'+e.Record_ID+"-"+e.AD_Table_ID+'" ></i>');return t("<div >").append(i).append(e.TableName).html()}});Ke.push({field:"Subject",caption:e.Msg.getMsg("Subject"),size:"150px",hidden:!1}),Ke.push({field:"UserName",caption:e.Msg.getMsg("UserName"),size:"150px",hidden:!1}),n.length>0&&(Xe=Object.keys(n[0]));for(var a=0;a<Xe.length;a++)"ID"!=Xe[a]&&"Record_ID"!=Xe[a]&&"Created"!=Xe[a]&&"Type"!=Xe[a]&&"TableName"!=Xe[a]&&"Subject"!=Xe[a]&&"UserName"!=Xe[a]&&Ke.push({field:Xe[a],caption:e.Msg.getMsg(Xe[a]),size:"100px",hidden:!0});for(var s=0;s<n.length;s++){var l={};l.recid=s;for(a=0;a<Xe.length;a++)"Created"==Xe[a]?l[Xe[a]]=new Date(n[s][Xe[a]]).toLocaleString():"Type"==Xe[a]?"A"==n[s][Xe[a]]?l[Xe[a]]=e.Msg.getMsg("Appointment"):"T"==n[s][Xe[a]]?l[Xe[a]]=e.Msg.getMsg("Task"):"L"==n[s][Xe[a]]?l[Xe[a]]=e.Msg.getMsg("Letter"):"M"==n[s][Xe[a]]?l[Xe[a]]=e.Msg.getMsg("SentMail"):"Z"!=n[s][Xe[a]]&&"I"!=n[s][Xe[a]]||(l[Xe[a]]=e.Msg.getMsg("InboxMail")):l[Xe[a]]=e.Utility.encodeText(n[s][Xe[a]]);Ye.push(l)}}(n),null==re||0==re||1==rt){re=n.TotalRecords;var a=parseInt(re/et);ue=1,pe=a+(re%et>0?1:0),(Ie=ye.find("select")).empty();for(var s=1;s<=pe;s++)Ie.append("<option>"+s+"</option>");he.css("opacity","0.6"),me.css("opacity","0.6"),function(){null!=h&&null!=h&&(h.destroy(),h=null);(h=v.w2grid({name:"userhistorygrid",recordHeight:30,show:{toolbar:!0},multiSelect:!1,columns:Ke,records:Ye})).on("select",wt),h.on("search",It),Ye.length>0?(h.select(0),N.hide(),_.show()):(N.show(),_.hide());t(".findImg").on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[1],n[0])}))}()}else!function(){h.destroy(),h=null,(h=v.w2grid({name:"userhistorygrid",recordHeight:30,show:{toolbar:!0},multiSelect:!1,columns:Ke,records:Ye})).on("select",wt),h.on("search",It),Ye.length>0?(h.select(0),N.hide(),_.show()):(N.show(),_.hide());ne[0].style.visibility="hidden",t(".findImg").off("click"),t(".findImg").on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[1],n[0])}))}();ne[0].style.visibility="hidden",rt=!1},error:function(e){console.log(e),ne[0].style.visibility="hidden",rt=!1}})}function st(){p.destroy(),p=null,(p=c.w2grid({name:"historyinboxgrid",recordHeight:30,show:{toolbar:!0},multiSelect:!1,columns:He,records:ze})).on("select",wt),p.on("search",It),ze.length>0?(p.select(0),N.hide(),_.show()):(N.show(),_.hide()),ne[0].style.visibility="hidden",ne[0].style.visibility="hidden"}function lt(e){null!=A&&1==A.is(":visible")?(t(".vis-attachhistory-right-row > ul > li").css("float","left"),t(".vis-attachhistory-right-row > ul").css("height","auto"),ot(A.html()),t(".vis-attachhistory-right-row > ul > li").css("float","none"),t(".vis-attachhistory-right-row > ul").css("height","45px")):null!=O&&1==O.is(":visible")&&(t(".vis-attachhistory-right-row > ul > li").css("float","left"),t(".vis-attachhistory-right-row > ul").css("height","auto"),t(t(".vis-attachhistory-to").find("p")).text(t(t(".vis-attachhistory-to").find("p")).text().replace(/;/g,"; ")),t(t(".vis-attachhistory-bcc").find("p")).text(t(t(".vis-attachhistory-bcc").find("p")).text().replace(/;/g,"; ")),t(t(".vis-attachhistory-cc").find("p")).text(t(t(".vis-attachhistory-cc").find("p")).text().replace(/;/g,"; ")),ot(O.html()),t(".vis-attachhistory-right-row > ul > li").css("float","none"),t(".vis-attachhistory-right-row > ul").css("height","45px"),t(t(".vis-attachhistory-to").find("p")).text(t(t(".vis-attachhistory-to").find("p")).text().replace(/; /g,";")),t(t(".vis-attachhistory-bcc").find("p")).text(t(t(".vis-attachhistory-bcc").find("p")).text().replace(/; /g,";")),t(t(".vis-attachhistory-cc").find("p")).text(t(t(".vis-attachhistory-cc").find("p")).text().replace(/; /g,";")))}function ot(t){var i=window.open(),n='<link rel="stylesheet" href="'+e.Application.contextUrl+'Areas/VIS/Content/VIS.all.min.css" />';i.document.write(n+t),setTimeout((function(){i.print(),i.close()}),300)}this.initializeComponent=function(){we=/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase()),ae=1,se=1,ue=1,ge=t('<ul style="margin-top:10px" class="vis-statusbar-ul pull-right">'),he=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" style="opacity: 0.6;"></i></div></li>'),me=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" style="opacity: 0.6;"></i></div></li>'),ye=t('<li><select class="vis-statusbar-combo"></select></li>'),fe=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" style="opacity: 0.6;"></i></div></li>'),ve=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" style="opacity: 0.6;"></i></div></li>'),ge.append(he).append(me).append(ye).append(fe).append(ve),function(){d=t('<div class="vis-forms-container" style="height:100%">'),c=t('<div class="vis-history-inboxDiv">'),u=t('<div style="display:none" class="vis-history-mainRelatedDiv">'),v=t('<div style="display:none" class="vis-history-mainRelatedDiv">'),f=t('<div class="vis-attachhistory-content-wrap">'),m=t('<div class="vis-attachhistory-left-wrap">'),D=t('<div class="vis-attachhistory-table-top">'),I=t('<div class="vis-attachhistory-search-wrap">'),y=t('<div class="vis-attachhistory-search">').append(' <input placeholder="'+e.Msg.getMsg("Search")+'" type="text">').append('<span class="vis-attachhistory-search-icon vis vis-search"></span>'),I.append('<i class="prthistory vis vis-print" title="'+e.Msg.getMsg("Print")+'"></i>').append(y),_=t('<div class="vis-attachhistory-right-wrap">'),N=t('<div class="vis-attachhistory-right-wrap">').hide(),1==we?N.append('<label class="vis-attachhistory-noRecFoundforIP" > '+e.Msg.getMsg("NoRecordFound")+" </label>"):N.append('<label class="vis-attachhistory-noRecFound" > '+e.Msg.getMsg("NoRecordFound")+" </label>");w=t('<div class="vis-attachhistory-apanel-tabcontrol">'),(b=t('<ul class="vis-attachhistory-appsaction-ul vis-attachhistory-apanel-tabcontrol-ul">')).append('<li data-type="History" class="vis-attachhistory-apanel-tab-selected" style="opacity: 1;">'+e.Msg.getMsg("History")+'</li><li  data-type="RelatedHistory"  style="opacity: 1;">'+e.Msg.getMsg("RelatedHistory")+"</li>"),a>0&&b.append('<li  data-type="UserHistory"  style="opacity: 1;">'+e.Msg.getMsg("UserHistory")+"</li>");D.append(w.append(b)),C=t('<div class="vis-attachhistory-table-wrap">').append(c).append(u).append(v).append(ge),d.append(f.append(m.append(D).append(C))),f.append(I).append(_).append(N),De=I.find("input"),y.find(".prthistory"),L=t('<ul class="vis-his-attachs">'),je=t('<ul class="vis-his-attachs">'),(Se=t("<ul class='vis-apanel-rb-ul'>")).append('<li style="display:none" data-type="R"><a><span class="vis-attachhistory-email-icon vis-attachhistory-reply-icon"></span>'+e.Msg.getMsg("Reply")+'</a></li> <li data-type="F"><a><span class="vis-attachhistory-email-icon vis-attachhistory-forword-icon vis vis-undo2"></span>'+e.Msg.getMsg("Forward")+"</a></li>")}(),(ne=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",d.append(ne),tt(),it(),b.on("click",yt),I.find("input").on("keydown",dt),I.find("i").on("click",lt),L.on("click",kt),je.on("click",Ot),_.on("keydown",Lt),_.on("click",Lt),fe.on("click",ct),me.on("click",pt),ye.on("change",ut),he.on("click",gt),ve.on("click",ht),Se.on(e.Events.onTouchStartOrClick,"LI",(function(a){!function(t,a){var s=null;"R"==t||"F"==t&&(s=new e.Email("",null,null,n,!0,!0,i,U.html(),R.text(),At));var l=new e.CFrame;l.setName(e.Msg.getMsg("EMail")),l.setTitle(e.Msg.getMsg("EMail")),l.hideHeader(!0),l.setContent(s),l.show(),s.initializeComponent(),r.close()}(t(this).data("type"))}))},this.displayInboxDiv=function(){(p=c.w2grid({name:"historyinboxgrid",recordHeight:30,show:{toolbar:!0},multiSelect:!1,columns:He,records:ze})).on("select",wt),p.on("search",It),ze.length>0?(p.select(0),N.hide(),_.show()):(N.show(),_.hide()),ne[0].style.visibility="hidden",t(".vis-attachhistory-search-icon").on("click",dt)};var rt=!1;function dt(e){null!=e.keyCode&&13!=e.keyCode||null!=De&&null!=De&&(rt=!0,c.is(":visible")?(ne[0].style.visibility="visible",tt(De.val()),it(De.val()),be=De.val(),st()):u.is(":visible")?(ne[0].style.visibility="visible",nt(De.val()),Ce=De.val()):(ne[0].style.visibility="visible",at(De.val()),_e=De.val()))}function ct(e){c.is(":visible")?(ae<de&&(ne[0].style.visibility="visible",ae++,Ie.val(ae),it(),st()),vt()):u.is(":visible")?se<ce&&(ne[0].style.visibility="visible",se++,Ie.val(se),nt(),ft()):ue<pe&&(ne[0].style.visibility="visible",ue++,Ie.val(ue),at(),mt())}function pt(e){c.is(":visible")?(ae>1&&(ne[0].style.visibility="visible",ae--,Ie.val(ae),it(),st()),vt()):u.is(":visible")?(se>1&&(ne[0].style.visibility="visible",se--,Ie.val(se),nt()),ft()):(ue>1&&(ne[0].style.visibility="visible",ue--,Ie.val(ue),at()),mt())}function ut(e){c.is(":visible")?(ne[0].style.visibility="visible",ae=Ie.val(),it(),st(),vt()):u.is(":visible")?(ne[0].style.visibility="visible",se=Ie.val(),nt(),ft()):(ne[0].style.visibility="visible",ue=Ie.val(),at(),mt())}function gt(e){c.is(":visible")?(ne[0].style.visibility="visible",ae=1,Ie.val(ae),it(),st(),vt()):u.is(":visible")?(ne[0].style.visibility="visible",se=1,Ie.val(se),nt(),ft()):(ne[0].style.visibility="visible",ue=1,Ie.val(ue),at(),mt())}function ht(e){c.is(":visible")?(ne[0].style.visibility="visible",ae=de,Ie.val(ae),it(),st(),vt()):u.is(":visible")?(ne[0].style.visibility="visible",se=ce,Ie.val(se),nt(),ft()):(ne[0].style.visibility="visible",ue=pe,Ie.val(ue),at(),mt())}function vt(){1==ae&&ae<de?(he.css("opacity","0.6"),me.css("opacity","0.6"),fe.css("opacity","1"),ve.css("opacity","1")):ae>1&&ae<de?(he.css("opacity","1"),me.css("opacity","1"),fe.css("opacity","1"),ve.css("opacity","1")):ae==de&&1==de?(he.css("opacity","0.6"),me.css("opacity","0.6"),fe.css("opacity","0.6"),ve.css("opacity","0.6")):ae==de&&(he.css("opacity","1"),me.css("opacity","1"),fe.css("opacity","0.6"),ve.css("opacity","0.6"))}function ft(){1==se&&se<ce?(he.css("opacity","0.6"),me.css("opacity","0.6"),fe.css("opacity","1"),ve.css("opacity","1")):se>1&&se<ce?(he.css("opacity","1"),me.css("opacity","1"),fe.css("opacity","1"),ve.css("opacity","1")):se==ce&&1==ce?(he.css("opacity","0.6"),me.css("opacity","0.6"),fe.css("opacity","0.6"),ve.css("opacity","0.6")):se==ce&&(he.css("opacity","1"),me.css("opacity","1"),fe.css("opacity","0.6"),ve.css("opacity","0.6"))}function mt(){1==ue&&ue<pe?(he.css("opacity","0.6"),me.css("opacity","0.6"),fe.css("opacity","1"),ve.css("opacity","1")):ue>1&&ue<pe?(he.css("opacity","1"),me.css("opacity","1"),fe.css("opacity","1"),ve.css("opacity","1")):ue==pe&&1==pe?(he.css("opacity","0.6"),me.css("opacity","0.6"),fe.css("opacity","0.6"),ve.css("opacity","0.6")):ue==pe&&(he.css("opacity","1"),me.css("opacity","1"),fe.css("opacity","0.6"),ve.css("opacity","0.6"))}function yt(i){var n=t(i.target).data("type");if("History"==n){"undefined"==De&&null==De||De.val(be),(Ie=ye.find("select")).empty();for(var s=1;s<=de;s++)Ie.append("<option>"+s+"</option>");vt(),c.show(),v.hide(),u.hide(),Ie.val(ae),ze.length>0?(p.select(0),p.refresh(),N.hide(),_.show()):(N.show(),_.hide())}else if("RelatedHistory"==n){"undefined"==De&&null==De||De.val(Ce),(Ie=ye.find("select")).empty();for(s=1;s<=ce;s++)Ie.append("<option>"+s+"</option>");null==g||null==g?(ne[0].style.visibility="visible",nt(),Ie.val(se)):(_.find("*").show(),$e.length>0&&(g.select(0),g.refresh(),Ie.val(se))),t(".findImg").on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[1],n[0])})),$e.length>0?(g.select(0),N.hide(),_.show()):(N.show(),_.hide()),c.hide(),v.hide(),u.show()}else if("UserHistory"==n){if("undefined"==De&&null==De||De.val(_e),null==a||0==a)return void e.ADialog.info("BPartnerNotFound");(Ie=ye.find("select")).empty();for(s=1;s<=pe;s++)Ie.append("<option>"+s+"</option>");null==h||null==h?(ne[0].style.visibility="visible",at(),Ie.val(ue)):(_.find("*").show(),Ye.length>0&&(h.select(0),h.refresh(),Ie.val(ue))),t(".findImg").on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[1],n[0])})),Ye.length>0?(h.select(0),N.hide(),_.show()):(N.show(),_.hide()),c.hide(),u.hide(),v.show()}t(i.target).addClass("vis-attachhistory-apanel-tab-selected"),t(i.target).siblings("li").removeClass("vis-attachhistory-apanel-tab-selected")}function It(e){e.onComplete=function(e){c.is(":visible")?p.last.searchIds.length>0&&p.select(p.last.searchIds[0]):g.last.searchIds.length>0&&g.select(g.last.searchIds[0])}}var Dt=0;function wt(i){var n;if(ne[0].style.visibility="visible",n="historyinboxgrid"==i.target?p.get(i.recid):"realtedhistorygrid"==i.target?g.get(i.recid):h.get(i.recid),t(".vis-attachhistory-view-comments").text(e.Msg.getMsg("ViewMoreComments")),n.type==e.Msg.getMsg("Appointment")||"Appointment"==n.Type||n.type==e.Msg.getMsg("Task")||"Task"==n.Type?null!=A&&0==A.is(":visible")&&(t(x[0].children[0]).hide(),A.show()):n.type==e.Msg.getMsg("VA048_CallType")||"Call"==n.Type?null!=Ve&&0==Ve.is(":visible")&&(t(Te[0].children[0]).hide(),Ve.show()):null!=O&&0==O.is(":visible")&&(t(S[0].children[0]).hide(),O.show()),null!=n.type)switch(n.type){case e.Msg.getMsg("Appointment"):case e.Msg.getMsg("Task"):bt(n.id),window.setTimeout((function(){Rt(Dt=n.id,o=!0,We=!1)}),200);break;case e.Msg.getMsg("SentMail"):Ct(n.id),window.setTimeout((function(){Rt(Dt=n.id,o=!1,We=!1)}),200);break;case e.Msg.getMsg("InboxMail"):_t(n.id),window.setTimeout((function(){Rt(Dt=n.id,o=!1,We=!1)}),200);break;case e.Msg.getMsg("Letter"):St(n.id),window.setTimeout((function(){Rt(Dt=n.id,o=!1,We=!1)}),200);break;case e.Msg.getMsg("VA048_CallType"):xt(n.id),window.setTimeout((function(){Rt(Dt=n.id,o=!1,We=!0)}),200)}else switch(n.Type){case e.Msg.getMsg("Appointment"):case e.Msg.getMsg("Task"):bt(n.ID),window.setTimeout((function(){Rt(Dt=n.ID,o=!0,We=!1)}),200);break;case e.Msg.getMsg("SentMail"):Ct(n.ID),window.setTimeout((function(){bt(n.ID),Rt(Dt=n.ID,o=!1,We=!1)}),200);break;case e.Msg.getMsg("InboxMail"):_t(n.ID),window.setTimeout((function(){bt(n.ID),Rt(Dt=n.ID,o=!1,We=!1)}),200);break;case e.Msg.getMsg("Letter"):St(n.ID),window.setTimeout((function(){bt(n.ID),Rt(Dt=n.ID,o=!1,We=!1)}),200);break;case e.Msg.getMsg("VA048_CallType"):xt(n.ID),window.setTimeout((function(){Rt(Dt=n.ID,o=!1,We=!0)}),200)}}function bt(i){var n=e.dataContext.getJSONData(e.Application.contextUrl+"AttachmentHistory/GetAppointmentData",{AppQry:i},null);if(null!=n){var a=0;a=c.is(":visible")?0:n.AD_Table_ID+"-"+n.Record_ID,strApp="";var s=n.AttendeeInfo;if(null!=s&&""!=s&&(names=e.dataContext.getJSONData(e.Application.contextUrl+"AttachmentHistory/GetUser",{UserQry:s},null),null!=names&&names.length>0)){strApp="";for(var l=0;l<names.length;l++)strApp+=names[l]+", ";strApp=strApp.substring(0,strApp.length-2)}!function(i,n,a,s,l,r,d,c,p,u,g,h,v,f,m){null!=S&&S.hide();null!=Te&&Te.hide();if(o=!0,We=!1,null==ee||null==ee){$=t("<p>"+e.Utility.encodeText(n)+"</p>"),J=t("<p>"+e.Utility.encodeText(g)+"</p>"),K=t("<p>"+e.Utility.encodeText(a)+"</p>"),Y=t("<p>"+e.Utility.encodeText(h)+"</p>"),X=t("<p>"+e.Utility.encodeText(m)+"</p>"),Z=t("<p>"+e.Utility.encodeText(s)+"</p>"),ee=l.indexOf("Z")>0?t("<p>"+e.Utility.encodeText(new Date(l).toLocaleString())+"</p>"):t("<p>"+e.Utility.encodeText(new Date(l+"Z").toLocaleString())+"</p>"),te=r.indexOf("Z")>0?t(" <p>"+e.Utility.encodeText(new Date(r).toLocaleString())+"</p>"):t(" <p>"+e.Utility.encodeText(new Date(r+"Z").toLocaleString())+"</p>"),ie=t("<p>"+e.Utility.encodeText(d)+"</p>"),null!=q&&null!=q||(q=t('<input type="text" placeholder="'+e.Msg.getMsg("TypeComment")+'"></input>')),z=t('<i class=" vis vis-find" data-ids="'+u+'" >'),x=t('<div class="vis-attachhistory-right-content">'),A=t('<div class="vis-attachhistory-grid-data" >');var y=t('<div style="float:left;width:100%" ></div>');y.append(t('<div class="vis-attachhistory-right-row2">').append(t("<h6>"+e.Msg.getMsg("Title")+' <i class="vis vis-appointment"></i></h6>').append(z)).append(J)),0==u?z.hide():z.show(),y.append(t('<div class="vis-attachhistory-right-row3"  style="margin-bottom:11px" >').append("<h6>"+e.Msg.getMsg("Location")+"</h6> ").append($)),("undefined"==n||null==n&&""==n)&&A.find(".vis-attachhistory-right-row").last().hide(),A.append(y);var I=t('<div style="float:left;width:100%" ></div>');I.append(t('<div  class="vis-attachhistory-right-row2"> ').append("<h6>"+e.Msg.getMsg("StartDate")+"</h6> ").append(ee)),I.append(t('<div class="vis-attachhistory-right-row3"  style="margin-bottom:11px" >').append("<h6>"+e.Msg.getMsg("EndDate")+"</h6>").append(te)),A.append(I);var D=t('<div style="float:left;width:100%" ></div>');D.append(t('<div class="vis-attachhistory-right-row2">').append("<h6>"+e.Msg.getMsg("AllDay")+"</h6>").append(ie)),D.append(t('<div class="vis-attachhistory-right-row3"  style="margin-bottom:11px" >').append("<h6>"+e.Msg.getMsg("Category")+"</h6> ").append(Y)),A.append(D),A.append(t('<div class="vis-attachhistory-right-row">').append("<h6>"+e.Msg.getMsg("Contacts")+"</h6> ").append(X)),Ae=t('<div class="vis-attachhistory-right-row" >'),A.append(t('<div class="vis-attachhistory-right-row">').append("<h6>"+e.Msg.getMsg("Description")+"</h6> ").append(K)).append(Ae),("undefined"==a||null==a&&""==a)&&A.find(".vis-attachhistory-right-row").last().hide(),V=t('<div class="vis-attachhistory-bottom"></div>'),(k=t('<div class="vis-attachhistory-comments vis-feedMessage"></div>')).append(q).append('<span class="vis-attachhistory-comment-icon vis vis-sms"></span>'),V.append(t('<div class="vis-attachhistory-right-row" style="margin-top:0px">').append(k).append('<p class="vis-attachhistory-view-comments">'+e.Msg.getMsg("ViewMoreComments")+"</p>")),x.append('<div style="display:none" class="vis-attachhistory-grid-data">').append(A).append(V),_.append(x),z.on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[0],n[1])}))}else x.show(),J.text(e.Utility.encodeText(g)),$.text(e.Utility.encodeText(n)),"undefined"==a||null==a||""==a?t(K.parent()).hide():(K.text(e.Utility.encodeText(a)),t(K.parent()).show()),X.text(e.Utility.encodeText(m)),"undefined"==h||null==h||""==h?Y.text(e.Utility.encodeText("")):Y.text(e.Utility.encodeText(h)),z.data("ids",u),0==u?z.hide():z.show(),ee.text(e.Utility.encodeText(new Date(l).toLocaleString())),te.text(e.Utility.encodeText(new Date(r).toLocaleString())),ie.text(e.Utility.encodeText(d)),t(x[0].children[0]).hide();t(".vis-attachhistory-view-comments").off("click"),t(".vis-attachhistory-view-comments").on("click",(function(){Vt(f,!0,!1,this)})),null!=p?q.val(e.Utility.encodeText(p)):q.val("");t(".vis-attachhistory-comment-icon").data("ID",i),ne[0].style.visibility="hidden"}(i,n.Location,n.Description,n.label,n.StartDate,n.EndDate,n.Allday,0,n.comments,a,n.Subject,n.caname,0,n.AppointmentsInfo_ID,strApp)}else ne[0].style.visibility="hidden"}function Ct(i){t.ajax({url:e.Application.contextUrl+"AttachmentHistory/LoadSentMails",datatype:"json",type:"get",cache:!1,data:{ID:i},success:function(e){var t=JSON.parse(e),n=0;n=c.is(":visible")?0:t.AD_Table_ID+"-"+t.Record_ID,Tt(i,t.Title,t.To,t.From,t.Date,t.Detail,t.Bcc,t.Cc,t.Comments,t.IsMail,t.IsLetter,t.Attach,n,t.ID)}})}function _t(i){t.ajax({url:e.Application.contextUrl+"AttachmentHistory/LoadInboxMails",datatype:"json",type:"get",cache:!1,data:{ID:i},success:function(e){var t=JSON.parse(e),n=0;n=c.is(":visible")?0:t.AD_Table_ID+"-"+t.Record_ID,Tt(i,t.Title,t.To,t.From,t.Date,t.Detail,t.Bcc,t.Cc,t.Comments,t.IsMail,t.IsLetter,t.Attach,n,t.ID)}})}function St(i){t.ajax({url:e.Application.contextUrl+"AttachmentHistory/LoadLetters",datatype:"json",type:"get",cache:!1,data:{ID:i},success:function(e){var t=JSON.parse(e),n=0;n=c.is(":visible")?0:t.AD_Table_ID+"-"+t.Record_ID,Tt(i,t.Title,"","",t.Date,t.Detail,"","",t.Comments,!1,!0,t.Attach,n,t.ID)}})}function xt(i){t.ajax({url:e.Application.contextUrl+"AttachmentHistory/LoadCall",datatype:"json",type:"get",cache:!1,data:{ID:i},success:function(n){var a=JSON.parse(n),s=0;s=c.is(":visible")?0:a.AD_Table_ID+"-"+a.Record_ID,function(i,n,a,s,l,o,r,d,c,p,u,g,h,v,f,m,y){null!=S&&S.hide();null!=x&&x.hide();l=l>=60?function(t){var i=~~(t%3600/60),n=t%60,a="";~~(t/3600)>0&&(a+=hrs+":"+(i<10?"0":""));return a+=i+":"+(n<10?"0":""),(a+=""+n)+" "+e.Msg.getMsg("VA048_Minutes")}(l):l+" "+e.Msg.getMsg("VA048_Seconds");if(null==qe||null==qe||""==qe){qe=t("<p>"+e.Utility.encodeText(a)+"</p>"),E=t("<p>"+e.Utility.encodeText(s)+"</p>"),Me=t("<p>"+e.Utility.encodeText(l)+"</p>"),ke=t("<p>"+e.Utility.encodeText(d)+"</p>"),Oe=t("<p>"+e.Utility.encodeText(o)+"</p>"),Le=t("<p>"+e.Utility.encodeText(r)+"</p>"),Re=t(" <p>"+e.Utility.encodeText(new Date(p).toLocaleString())+"</p>"),Y=t("<p>"+e.Utility.encodeText(v)+"</p>"),Ee=t('<p style="max-height:120px;overflow-y: scroll;">'+e.Utility.encodeText(c)+"</p>"),Ue=t("<p>"+e.Utility.encodeText(m)+"</p>"),Pe=t("<p>"+("Y"==n?e.Msg.getMsg("VA048_Conference"):e.Msg.getMsg("VA048_CallType"))+"</p>"),z=t('<i class=" vis vis-find" data-ids="'+h+'">'),0==h?z.hide():z.show(),Te=t('<div class="vis-attachhistory-right-content">'),Ve=t('<div class="vis-attachhistory-grid-data" >');var I=t('<div style="float:left;width:100%;margin-bottom:10px"></div>').append(t('<div class="vis-attachhistory-right-row2">').append(t("<h6>"+e.Msg.getMsg("Title")+' <i class="fa fa-phone"></i></h6>').append(z)).append(Pe)).append(t('<div class="vis-attachhistory-right-row3" style="margin-right: 4px;" >').append("<h6>"+e.Msg.getMsg("User")+"</h6> ").append(Ue));Ve.append(I);var D=t('<div style="float:left;width:100%;margin-bottom:10px" ></div>').append(t('<div class="vis-attachhistory-right-row2">').append(t("<h6>"+e.Msg.getMsg("VA048_From")+"</h6>")).append(qe)).append(t('<div class="vis-attachhistory-right-row3" style="margin-right: 4px;" >').append("<h6>"+e.Msg.getMsg("VA048_To")+"</h6> ").append(E));Ve.append(D);var w=t('<div style="float:left;width:100%;margin-bottom:10px" ></div>').append(t('<div class="vis-attachhistory-right-row2"> ').append("<h6>"+e.Msg.getMsg("VA048_Duration")+"</h6> ").append(Me)).append(t('<div class="vis-attachhistory-right-row3" style="margin-right: 4px;" >').append("<h6>"+e.Msg.getMsg("VA048_Status")+"</h6>").append(ke));Ve.append(w);var b=t('<div style="float:left;width:100%;margin-bottom:10px" ></div>').append(t('<div class="vis-attachhistory-right-row2">').append("<h6>"+e.Msg.getMsg("VA048_Price")+"</h6>").append(Oe)).append(t('<div class="vis-attachhistory-right-row3" style="margin-right: 4px;" >').append("<h6>"+e.Msg.getMsg("VA048_PriceUnit")+"</h6> ").append(Le));Ve.append(b);var C=t('<div style="float:left;width:100%;margin-bottom:10px" ></div>').append(t('<div class="vis-attachhistory-right-row2">').append("<h6>"+e.Msg.getMsg("Created")+"</h6>").append(Re)).append(t('<div class="vis-attachhistory-right-row3" style="margin-right: 4px;" >').append("<h6>"+e.Msg.getMsg("Category")+"</h6> ").append(Y));if(Ve.append(C),Ve.append(t('<div class="vis-attachhistory-right-row" style="margin-bottom:20px;margin-right: 4px;">').append("<h6>"+e.Msg.getMsg("VA048_Notes")+"</h6> ").append(Ee)),Ve.append(t('<div class="vis-attachhistory-right-row">').append("<h6>"+e.Msg.getMsg("Attachments")+"</h6>")),null!=y&&y.length>0)for(var A=0;A<y.length;A++)je.append('<li><span class="vis-attachhistory-attach-download"><i class="fa fa-long-arrow-down"></i></span><a data-attid="'+y[A].AttID+'" data-id="'+y[A].ID+'">'+e.Utility.encodeText(y[A].Name)+"</a></li>");else Ve.find(".vis-attachhistory-right-row").last().hide();Ve.find(".vis-attachhistory-right-row").last().append(je),null!=Ne&&null!=Ne||(Ne=t('<input type="text" placeholder="'+e.Msg.getMsg("TypeComment")+'"></input>')),Be=t('<div class="vis-attachhistory-bottom"></div>'),(Fe=t('<div class="vis-attachhistory-comments vis-feedMessage"></div>')).append(Ne).append('<span class="vis-attachhistory-comment-icon vis vis-sms"></span>'),Be.append(t('<div class="vis-attachhistory-right-row" style="margin-top:0px">').append(Fe).append('<p class="vis-attachhistory-view-comments">'+e.Msg.getMsg("ViewMoreComments")+"</p>")),Te.append('<div style="display:none" class="vis-attachhistory-grid-data">').append(Ve).append(Be),Ge=t('<div class="vis-attachhistory-right-row" >'),Ve.append(Ge),_.append(Te),z.on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[0],n[1])}))}else{if(Te.show(),qe.text(e.Utility.encodeText(a)),E.text(e.Utility.encodeText(s)),Me.text(e.Utility.encodeText(l)),ke.text(e.Utility.encodeText(d)),Oe.text(e.Utility.encodeText(o)),Le.text(e.Utility.encodeText(r)),Re.text(e.Utility.encodeText(new Date(p).toLocaleString())),Y.text(e.Utility.encodeText(v)),Ee.text(e.Utility.encodeText(c)),Ue.text(e.Utility.encodeText(m)),Pe.text(e.Utility.encodeText("Y"==n?e.Msg.getMsg("VA048_Conference"):e.Msg.getMsg("VA048_CallType"))),null!=y&&y.length>0){je.empty();for(A=0;A<y.length;A++)je.append('<li><span class="vis-attachhistory-attach-download"><i class="fa fa-long-arrow-down"></i></span><a data-attid="'+y[A].AttID+'" data-id="'+y[A].ID+'">'+e.Utility.encodeText(y[A].Name)+"</a></li>");t(je.parent()).show()}else t(je.parent()).hide();z.data("ids",h),0==h?z.hide():z.show(),t(Te[0].children[0]).hide()}t(".vis-attachhistory-view-comments").off("click"),t(".vis-attachhistory-view-comments").on("click",(function(){Vt(i,!1,!0,this)})),null!=f?Ne.val(e.Utility.encodeText(f)):Ne.val("");t(".vis-attachhistory-comment-icon").data("ID",i),ne[0].style.visibility="hidden"}(i,a.VA048_IsConference,a.VA048_From,a.VA048_To,a.VA048_Duration,a.VA048_Price,a.VA048_Price_Unit,a.VA048_Status,a.VA048_CallNotes,a.Created,a.AD_Table_ID,a.Record_ID,s,e.Msg.getMsg("VA048_CallType"),"",a.VA048_FullName,a.Attach)}})}var At=0;function Tt(i,n,a,s,l,r,d,c,p,u,g,h,v,f){if(null!=x&&x.hide(),null!=Te&&Te.hide(),o=!1,We=!1,null==F||null==F){if(R=t("<p>"+e.Utility.encodeText(n)+"</p>"),E=t("<p>"+e.Utility.encodeText(a)+"</p>"),W=t("<p>"+e.Utility.encodeText(d)+"</p>"),j=t("<p>"+e.Utility.encodeText(c)+"</p>"),P=t(" <p>"+e.Utility.encodeText(s)+"</p>"),F=t("<p>"+e.Utility.encodeText(l)+"</p>"),Q=t('<a class="vis-attachhistory-email-dropdown fa fa-ellipsis-v" tabindex=""></a>'),null!=U&&null!=U||(U=t('<p class="vis-attachhistory-detail"></p>')),U.html(r),null!=B&&null!=B||(B=t('<input type="text" placeholder="'+e.Msg.getMsg("TypeComment")+'"></input>')),G=t('<i class="vis vis-email"></i>'),H=t('<i class="vis vis-find pull-right" data-ids="'+v+'" ></i>'),S=t('<div class="vis-attachhistory-right-content">'),(O=t('<div class="vis-attachhistory-grid-data">')).append(t('<div class="vis-attachhistory-right-row2">').append(t("<h6>"+e.Msg.getMsg("Title")+"</h6>").append(G)).append(R)),O.append(t('<div class="vis-attachhistory-right-row3"></div>').append(Q).append(H)),1==g&&O.find(".vis-attachhistory-right-row").last().hide(),1==g&&O.append(t('<div class="vis-attachhistory-right-row3">').append(F)),0==v?H.hide():H.show(),1==u?G.removeClass("vis vis-letter").addClass("vis vis-email"):1==g&&G.removeClass("vis vis-email").addClass("vis vis-letter"),O.append(t('<div class="vis-attachhistory-right-row vis-attachhistory-to">').append("<h6>"+e.Msg.getMsg("To")+"</h6> ").append(E)),"undefined"!=a&&null!=a&&""!=a&&1!=g||O.find(".vis-attachhistory-right-row").last().hide(),O.append(t('<div value="bccDiv" class="vis-attachhistory-right-row  vis-attachhistory-bcc">').append("<h6>"+e.Msg.getMsg("Bcc")+"</h6> ").append(W)),"undefined"!=d&&null!=d&&""!=d&&1!=g||O.find(".vis-attachhistory-right-row").last().hide(),O.append(t('<div  value="ccDiv"  class="vis-attachhistory-right-row vis-attachhistory-cc">').append("<h6>"+e.Msg.getMsg("Cc")+"</h6> ").append(j)),"undefined"!=c&&null!=c&&""!=c&&1!=g||O.find(".vis-attachhistory-right-row").last().hide(),O.append(t('<div class="vis-attachhistory-right-row">').append("<h6>"+e.Msg.getMsg("From")+"</h6>").append(P)),O.append(t('<div class="vis-attachhistory-right-row">').append("<h6>"+e.Msg.getMsg("Attachments")+"</h6>")),null!=h&&h.length>0)for(var m=0;m<h.length;m++)L.append('<li><span class="vis-attachhistory-attach-download"><i class="fa fa-long-arrow-down"></i></span><a data-IDs="'+h[m].ID+'">'+e.Utility.encodeText(h[m].Name)+"</a></li>");else O.find(".vis-attachhistory-right-row").last().hide();O.find(".vis-attachhistory-right-row").last().append(L),xe=t('<div class="vis-attachhistory-right-row">'),O.append(t('<div class="vis-attachhistory-right-row">').append("<h6>"+e.Msg.getMsg("Details")+"</h6>").append(U)).append(xe),T=t('<div class="vis-attachhistory-bottom"></div>'),(M=t('<div class="vis-attachhistory-comments vis-feedMessage"></div>')).append(B).append('<span class="vis-attachhistory-comment-icon vis vis-sms"></span>'),T.append(t('<div class="vis-attachhistory-right-row" style="margin-top:0px">').append(M).append('<p class="vis-attachhistory-view-comments" style="float:right;width:auto">'+e.Msg.getMsg("ViewMoreComments")+"</p>")),S.append('<div style="display:none" class="vis-attachhistory-grid-data">').append(O).append(T),I.parent(),_.append(S),H.on("click",(function(i){var n=t(i.target).data("ids").split("-");e.AEnv.zoom(n[0],n[1])}))}else{if(S.show(),t(S[0].children[0]).hide(),null!=Q&&null!=Q||(Q=t('<a class="vis-attachhistory-email-dropdown fa fa-ellipsis-v" tabindex=""></a>')),1==u?(G.removeClass("vis vis-letter").addClass("vis vis-email"),Q.show()):1==g&&(G.removeClass("vis vis-email").addClass("vis vis-letter"),Q.hide()),R.text(e.Utility.encodeText(n)),"undefined"==a||null==a&&""==a||1==g?t(E.parent()).hide():(E.text(e.Utility.encodeText(a)),t(E.parent()).show()),"undefined"==d||null==d||""==d||1==g?t(W.parent()).hide():(W.text(e.Utility.encodeText(d)),t(W.parent()).show()),"undefined"==c||null==c||""==c||1==g?t(j.parent()).hide():(j.text(e.Utility.encodeText(c)),t(j.parent()).show()),1==g?t(P.parent()).hide():(P.text(e.Utility.encodeText(s)),t(P.parent()).show()),H.data("ids",v),0==v?H.hide():H.show(),F.text(e.Utility.encodeText(l)),null!=h&&h.length>0){L.empty();for(m=0;m<h.length;m++)L.append('<li><span class="vis-attachhistory-attach-download"><i class="fa fa-long-arrow-down"></i></span><a  data-IDs="'+h[m].ID+'">'+e.Utility.encodeText(h[m].Name)+"</a></li>");t(L.parent()).show()}else t(L.parent()).hide();U.html(r)}t(".vis-attachhistory-view-comments").off("click"),t(".vis-attachhistory-view-comments").on("click",(function(){Vt(f,!1,!1,this)})),u?(At=f,Q.show(),t(".vis-attachhistory-email-dropdown").off("click"),t(".vis-attachhistory-email-dropdown").on("click",(function(){t(this).w2overlay(Se.clone(!0),{css:{height:"300px"}})}))):Q.hide(),t(".vis-attachhistory-comment-icon").data("ID",i),null!=p?B.val(e.Utility.encodeText(p)):B.val(""),ne[0].style.visibility="hidden"}function Vt(i,n,a,s){1==n?A.is(":visible")?(t.ajax({url:e.Application.contextUrl+"AttachmentHistory/ViewChatonHistory",datatype:"json",type:"POST",cache:!1,data:{record_ID:i,isAppointment:n,isCall:a},success:function(e){Mt(JSON.parse(e),n,a)},error:function(t){e.ADialog.error("RecordNotSaved")}}),t(s).text(e.Msg.getMsg("HideComments"))):(A.show(),t(x[0].children[0]).hide(),t(s).text(e.Msg.getMsg("ViewMoreComments"))):1==a?Ve.is(":visible")?(t.ajax({url:e.Application.contextUrl+"AttachmentHistory/ViewChatonHistory",datatype:"json",type:"POST",cache:!1,data:{record_ID:i,isAppointment:n,isCall:a},success:function(e){Mt(JSON.parse(e),n,a)},error:function(t){e.ADialog.error("RecordNotSaved")}}),t(s).text(e.Msg.getMsg("HideComments"))):(Ve.show(),t(Te[0].children[0]).hide(),t(s).text(e.Msg.getMsg("ViewMoreComments"))):O.is(":visible")?(t.ajax({url:e.Application.contextUrl+"AttachmentHistory/ViewChatonHistory",datatype:"json",type:"POST",cache:!1,data:{record_ID:i,isAppointment:n,isCall:a},success:function(e){Mt(JSON.parse(e),n,a)},error:function(t){e.ADialog.error("RecordNotSaved")}}),t(s).text(e.Msg.getMsg("HideComments"))):(O.show(),t(S[0].children[0]).hide(),t(s).text(e.Msg.getMsg("ViewMoreComments")))}function Nt(t,i){return t+='   <div class="vis-attachhistory-comment-data"><div class="vis-attachhistory-comment-detail vis-feedDetails-cmnt">',"NoRecordFound"!=i.UserImage&&"FileDoesn'tExist"!=i.UserImage&&null!=i.UserImage?t+='<img  class="userAvatar-Feeds"  src="'+i.UserImage+"?"+new Date+'">':t+='<i class="fa fa-user userAvatar-Feeds"></i>',t+='<div class="vis-attachhistory-comment-text">',i.CreatedBy==e.Env.getCtx().getAD_User_ID()?t+="<h6>"+e.Msg.getMsg("Me")+" </h6>":t+="<h6>"+i.UserName+"</h6>",t+=" <p>"+i.CharacterData+'</p></div><div class="vis-attachhistory-comment-dateTime"><p>'+new Date(i.Created).toLocaleString()+"</p></div></div></div>"}function Mt(e,i,n){if(e.length>0){for(var a=' <div class="vis-attachhistory-comments-container">',s=0;s<e.length;s++)a=Nt(a,e[s]);a+="</div>"}1==n?Ve.is(":visible")?(t(Te[0].children[0]).show(),t(Te[0].children[0]).empty(),t(Te[0].children[0]).append(a),Ve.hide()):(Ve.show(),t(Te[0].children[0]).hide()):1==i?A.is(":visible")?(t(x[0].children[0]).show(),t(x[0].children[0]).empty(),t(x[0].children[0]).append(a),A.hide()):(A.show(),t(x[0].children[0]).hide()):O.is(":visible")?(t(S[0].children[0]).show(),t(S[0].children[0]).empty(),t(S[0].children[0]).append(a),O.hide()):(O.show(),t(S[0].children[0]).hide())}function kt(i){var n=i.target,a="",s="";t(n).is("a")?(a=t(n).text(),s=t(n).data("ids")):t(n).is("i")?(a=t(t(n).parent()).siblings().text(),s=t(t(n).parent()).siblings().data("ids")):t(n).is("span")&&(a=t(n).siblings().text(),s=t(n).siblings().data("ids")),null!=s&&0!=s&&(ne[0].style.visibility="hidden",t.ajax({url:e.Application.contextUrl+"AttachmentHistory/DownloadAttachment",datatype:"json",type:"get",cache:!1,data:{ID:s,Name:a},success:function(t){var i=JSON.parse(t),n=e.Application.contextUrl+"TempDownload/"+i;window.open(n),ne[0].style.visibility="hidden"}}))}function Ot(i){var n=i.target,a="",s="",l="";t(n).is("a")?(a=t(n).text(),l=t(n).data("attid"),s=t(n).data("id")):t(n).is("img")?(a=t(t(n).parent()).siblings().text(),l=t(t(n).parent()).siblings().data("attid"),s=t(t(n).parent()).siblings().data("id")):t(n).is("span")&&(a=t(n).siblings().text(),l=t(n).siblings().data("attid"),s=t(t(n).parent()).siblings().data("id")),null!=s&&0!=s&&(ne[0].style.visibility="hidden",t.ajax({url:e.Application.contextUrl+"AttachmentHistory/DownloadAttachmentCall",datatype:"json",type:"get",cache:!1,data:{AttID:l,ID:s,Name:a},success:function(t){var i=JSON.parse(t);if(null!=i&&""!=i){var n=e.Application.contextUrl+"TempDownload/"+i;window.open(n)}else e.ADialog.error("AttachmentNotFound");ne[0].style.visibility="hidden"}}))}function Lt(i){var n=i.target;if((null==i.keyCode||13==i.keyCode)&&(null!=i.keyCode||t(n).hasClass("vis-attachhistory-comment-icon"))){var a;if(0!=(a=t(".vis-attachhistory-comment-icon").data("ID"))){var s="";0!=(s=1==o?q.val():1==We?Ne.val():B.val()).length&&t.ajax({url:e.Application.contextUrl+"AttachmentHistory/SaveComment",datatype:"json",type:"POST",cache:!1,data:{ID:a,Text:s,isAppointment:o,isCall:We},success:function(e){var i=JSON.parse(e),n=!0;if(1==We?(Ne.val(""),Ve.is(":visible")&&(n=!1)):1==o?(q.val(""),A.is(":visible")&&(n=!1)):(B.val(""),O.is(":visible")&&(n=!1)),1==n){if(i.length>0){for(var a=' <div class="vis-attachhistory-comments-container">',s=0;s<i.length;s++)a=Nt(a,i[s]);a+="</div>"}1==o?(t(x[0].children[0]).empty(),t(x[0].children[0]).append(a)):1==We?(t(Te[0].children[0]).empty(),t(Te[0].children[0]).append(a)):(t(S[0].children[0]).empty(),t(S[0].children[0]).append(a))}else Rt(Dt,o,We)},error:function(t){e.ADialog.error("RecordNotSaved")}})}}}function Rt(i,n,a){t.ajax({url:e.Application.contextUrl+"AttachmentHistory/ViewChatonLastHistory",datatype:"json",type:"POST",cache:!1,data:{record_ID:i,isAppointment:n,isCall:a},success:function(e){var t=JSON.parse(e);if(t.length>0)if(n){var i='<div style="height:88px"></div>';Ae.empty();for(var s=0;s<t.length;s++)i=Nt(i,t[s]),Ae.append(i)}else if(a){i="<div></div>";Ge.empty();for(s=0;s<t.length;s++)i=Nt(i,t[s]),Ge.append(i)}else{i='<div style="height:120px"></div>';xe.empty();for(s=0;s<t.length;s++)i=Nt(i,t[s]),xe.append(i)}else a?Ge.empty():n?Ae.empty():xe.empty()}})}this.getRoot=function(){return d},this.show=function(){r=new e.ChildDialog,this.initializeComponent(),r.setContent(d),1==we?(r.setHeight(650),r.setWidth(800)):(r.setHeight(650),r.setWidth(1e3)),r.setTitle(e.Msg.getMsg("History")),r.setModal(!0),r.show(),r.hideButtons(),this.displayInboxDiv(),r.onClose=function(){Ze.dispose()}},this.dispose=function(){0,null,He=[],He=null,ze=[],ze=null,Qe=[],Qe=null,null!=f&&f.remove(),null!=m&&m.remove(),null!=D&&D.remove(),null!=w&&w.remove(),null!=b&&b.remove(),null!=C&&C.remove(),null!=_&&_.remove(),null!=S&&S.remove(),null!=x&&x.remove(),null!=A&&A.remove(),null!=T&&T.remove(),null!=V&&V.remove(),null!=N&&N.remove(),null!=O&&O.remove(),null!=L&&L.remove(),null!=je&&je.remove(),null!=R&&R.remove(),null!=E&&E.remove(),null!=P&&P.remove(),null!=qe&&qe.remove(),null!=U&&U.remove(),null!=F&&F.remove(),null!=B&&B.remove(),null!=W&&W.remove(),null!=j&&j.remove(),null!=G&&G.remove(),null!=q&&q.remove(),null!=$&&$.remove(),null!=J&&J.remove(),null!=K&&K.remove(),null!=Z&&Z.remove(),null!=ee&&ee.remove(),null!=te&&te.remove(),null!=ie&&ie.remove(),null!=ne&&ne.remove(),null!=ge&&ge.remove(),null!=he&&he.remove(),null!=ve&&ve.remove(),null!=fe&&fe.remove(),null!=me&&me.remove(),null!=ye&&ye.remove(),null!=Ie&&Ie.remove(),null!=c&&null!=c&&c.remove(),c=null,null!=p&&null!=p&&p.destroy(),p=null,null!=w2ui.historyinboxgrid&&w2ui.historyinboxgrid.destroy(),null!=g&&null!=g&&g.destroy(),g=null,null!=w2ui.realtedhistorygrid&&w2ui.realtedhistorygrid.destroy(),null!=h&&null!=h&&h.destroy(),h=null,null!=w2ui.userhistorygrid&&w2ui.userhistorygrid.destroy(),Ze=null}}}(VIS,jQuery)},297:()=>{!function(e,t){function i(i,n,a,s,l,o,r,d,c){var p="",u=!1;this.isWindowAction=!1;var g=null,h=null,v=null,f=null;this.windowNo=i;n=0;function m(){g.empty(),g=null,h.empty(),h=null,v.empty(),v=null,w=null,b=null,C=null,_=null,S=null,D=null,M=null,x=null,A=null,T=null,V=null,N=null,k=null,D=null,W=null,progresBar=null,q=null,null!=I&&(I.dialog("destroy"),I.remove()),I=null}o||(o=0),d||(d=!1),r||(r=!1),this.onClose=null;var y=this,I=null;I=(e.Application.isRTL,t("<div style='overflow:hidden;width:100%;height:100%;'>"));var D=t("<ul style='height:30px;display:none;list-style:none;width:97%;margin-left:-41px'>"),w=t("<li>");w.css("float","left"),w.css("margin","1px"),w.css("padding","5px"),w.css("display","block"),w.css("position","relative"),w.css("font-weight","700"),w.css("border","0px"),w.css("border-bottom","none"),w.css("border-width","1px"),w.css("color","#999"),w.css("cursor","default"),w.css("height","35px"),w.css("margin-bottom","-1px"),w.css("margin-right","5px"),w.css("border-top-left-radius","3px"),w.css("border-top-right-radius","3px"),w.append(e.Msg.getMsg("FileAttachment")),D.append(w);var b=t("<li>");b.css("float","left"),b.css("margin","1px"),b.css("padding","5px"),b.css("display","block"),b.css("position","relative"),b.css("font-weight","700"),w.css("border","0px"),b.css("border-bottom","none"),b.css("border-width","1px"),b.css("color","#999"),b.css("cursor","default"),b.css("height","35px"),b.css("margin-bottom","-1px"),b.css("margin-right","5px"),b.css("border-top-left-radius","3px"),b.css("border-top-right-radius","3px"),b.append(e.Msg.getMsg("InboxMailAttachment")),D.append(b);var C=t("<li>");C.css("float","left"),C.css("margin","1px"),C.css("padding","5px"),C.css("display","block"),C.css("position","relative"),C.css("font-weight","700"),w.css("border","0px"),C.css("border-bottom","none"),C.css("border-width","1px"),C.css("color","#999"),C.css("cursor","default"),C.css("height","35px"),C.css("margin-bottom","-1px"),C.css("margin-right","5px"),C.css("border-top-left-radius","3px"),C.css("border-top-right-radius","3px"),C.append(e.Msg.getMsg("SentMailAttachment")),D.append(C);var _=t("<li>");_.css("float","left"),_.css("margin","1px"),_.css("padding","5px"),_.css("display","block"),_.css("position","relative"),_.css("font-weight","700"),w.css("border","0px"),_.css("border-bottom","none"),_.css("border-width","1px"),_.css("color","#999"),_.css("cursor","default"),_.css("height","35px"),_.css("margin-bottom","-1px"),_.css("margin-right","5px"),_.css("border-top-left-radius","3px"),_.css("border-top-right-radius","3px"),_.append(e.Msg.getMsg("Letter")),D.append(_);var S=t("<li>");S.css("float","left"),S.css("margin","1px"),S.css("padding","5px"),S.css("display","block"),S.css("position","relative"),S.css("font-weight","700"),w.css("border","0px"),S.css("border-bottom","none"),S.css("border-width","1px"),S.css("color","#999"),S.css("cursor","default"),S.css("height","35px"),S.css("margin-bottom","-1px"),S.css("margin-right","5px"),S.css("border-top-left-radius","3px"),S.css("border-top-right-radius","3px"),S.append(e.Msg.getMsg("Appointments")),D.append(S),I.append(D);var x=t("<div class='vis-pu-outerwrap'>"),A=t("<div class='vis-pu-innerwrap'>");x.append(A);var T=t("<div>");T.append("Inbox Mail Att"),T.css("width","100%"),T.css("height","100%"),T.css("position","absolute"),x.append(T);var V=t("<div>");V.append("SENT MAIL Att"),V.css("width","100%"),V.css("height","100%"),V.css("position","absolute"),x.append(V);var N=t("<div>");N.append("Leter Att"),N.css("width","100%"),N.css("height","100%"),N.css("position","absolute"),x.append(N);var M=t("<div>");M.append("Appointment Att"),M.css("width","100%"),M.css("height","100%"),M.css("position","absolute"),x.append(M);var k=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>');x.append(k);var O=t("<div style='width: 100%;height: 100%;background:black;opacity: .1;display:none; position:absolute;top:0;left:0'>");x.append(O);var L=t("<div style='width: 100%;height: 100%;background:transparent;text-align: center;display:none ;vertical-align: middle;position:absolute;top:0;left:0'>");x.append(L);var R=null;R=e.Application.isRTL?t("<div id='progress_bar' class='vis-ui-progress-bar vis-ui-container' style='top:41%;width: 80%;right: 9%;'>"):t("<div id='progress_bar' class='vis-ui-progress-bar vis-ui-container' style='top:41%;width: 80%;left: 9%;'>");var E=t("<div class='vis-ui-progress' style='width: 0%; display: block;position:absolute'>"),P=t("<span class='vis-ui-label'  style='position:absolute'>").append("0%");E.append(P),R.append(E),L.append(R),I.append(x),A[0].style.visibility="visible",T[0].style.visibility="hidden",V[0].style.visibility="hidden",N[0].style.visibility="hidden",M[0].style.visibility="hidden",k[0].style.visibility="hidden",w.css("background","#fff"),w.css("color","#0088CC");var U=function(e,t){t?(e.css("background","#fff"),e.css("color","#0088CC")):(e.css("background","#eee"),e.css("color","#999"))};function F(){y.onClose&&y.onClose(),m()}w.on("click",(function(){A[0].style.visibility="visible",T[0].style.visibility="hidden",V[0].style.visibility="hidden",N[0].style.visibility="hidden",M[0].style.visibility="hidden",k[0].style.visibility="hidden",U(w,!0),U(b,!1),U(C,!1),U(_,!1),U(S,!1),j()})),b.on("click",(function(){A[0].style.visibility="hidden",T[0].style.visibility="visible",V[0].style.visibility="hidden",N[0].style.visibility="hidden",M[0].style.visibility="hidden",k[0].style.visibility="hidden",U(w,!1),U(b,!0),U(C,!1),U(_,!1),U(S,!1)})),C.on("click",(function(){A[0].style.visibility="hidden",T[0].style.visibility="hidden",V[0].style.visibility="visible",N[0].style.visibility="hidden",M[0].style.visibility="hidden",k[0].style.visibility="hidden",U(w,!1),U(b,!1),U(C,!0),U(_,!1),U(S,!1)})),_.on("click",(function(){A[0].style.visibility="hidden",T[0].style.visibility="hidden",V[0].style.visibility="hidden",N[0].style.visibility="visible",M[0].style.visibility="hidden",k[0].style.visibility="hidden",U(w,!1),U(b,!1),U(C,!1),U(_,!0),U(S,!1)})),S.on("click",(function(){A[0].style.visibility="hidden",T[0].style.visibility="hidden",V[0].style.visibility="hidden",N[0].style.visibility="hidden",M[0].style.visibility="visible",k[0].style.visibility="hidden",U(w,!1),U(b,!1),U(C,!1),U(_,!1),U(S,!0)})),this.show=function(){A[0].style.visibility="visible",T[0].style.visibility="hidden",V[0].style.visibility="hidden",N[0].style.visibility="hidden",M[0].style.visibility="hidden",k[0].style.visibility="hidden",U(w,!0),U(b,!1),U(C,!1),U(_,!1),U(S,!1),""!=(p=e.dataContext.getJSONRecord("Attachment/GetTableName",a))&&(p=p.toLowerCase()),j(),I.dialog({width:841,height:502,title:e.Msg.getMsg("Attachment"),resizable:!1,modal:!0,close:F})};var B=t("<div class='vis-pu-uploadsbtnswrap'>"),W=[];function j(){u||(k[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Attachment/GetAttachment",dataType:"json",data:{AD_Table_ID:a,Record_ID:s},error:function(){e.ADialog.info("ERRORGettingAttachment"),k[0].style.visibility="hidden"},success:function(i){var a=i.result.FLocation,s=i.result.Attachment;if(null==a)return e.ADialog.info("ERRORGettingAttachment"),void(k[0].style.visibility="hidden");var l=t("<div class='vis-latest-attachments'>");c||A.append(l);var o=t("<div class='vis-attach-top'>");l.append(o);var d=t("<div class='vis-attach-file-location'>"),I=t("<div class='input-group vis-input-wrap' style='margin-bottom: 0;'>"),D=t("<div class='vis-control-wrap'>");for(var w in o.append(d),d.append(I),I.append(D),(f=t('<select class="vis-custom-select">')).attr("disabled",!0),a.values){var b=t("<option value="+a.values[w].Key+">");b.append(a.values[w].Name),f.append(b),a.selectedvalue==a.values[w].Key&&f.val(a.selectedvalue)}D.append(f);var C=t("<label>").append(e.Msg.getMsg("FileLocation"));D.append(C);var _=t("<div class='vis-attach-top-btns'>");o.append(_);var S=t("<input type='file' multiple='true' style='display:none;'>");_.append(S),S.change((function(){G(this)})),S.click((function(){this.value=null}));var x=t("<a title='"+e.Msg.getMsg("SelectFile")+"' class='vis-attach-ico'><i class='fa fa-paperclip' style='font-size: 35px; color: rgba(var(--v-c-primary),1)' aria-hidden='true'></i></a>");_.append(x),x.on("click",(function(){p.endsWith("_ver")||S.trigger("click")})),r&&x.hide();var T=t("<div class='vis-dropdown pull-left'>");_.append(T);var V=t("<a class='vis-btn vis-btn-arrange vis-dropdown-toggle' type='button' data-toggle='dropdown' style='color: #fff;display:none;'>");V.append(e.Msg.getMsg("Arrange")),V.append(t("<span class='vis-caret'>")),T.append(V);var N=t("<ul class='dropdown-menu' role='menu' aria-labelledby='dropdownMenu1' id='dropdownMenu' style='margin-left: -33px;'>");T.append(N);var M=t("<li role='presentation'>"),O=t("<a role='menuitem' tabindex='-1' href='#'>");O.append(e.Msg.getMsg("Type")),M.append(O),M.on("click",(function(){})),N.append(M);var L=t("<li role='presentation'>"),R=t("<a role='menuitem' tabindex='-1' href='#'>");R.append(e.Msg.getMsg("Size")),L.append(R),L.on("click",(function(){})),N.append(L);var E=t("<li role='presentation'>"),P=t("<a role='menuitem' tabindex='-1' href='#'>");P.append(e.Msg.getMsg("Name")),E.append(P),E.on("click",(function(){})),N.append(E),g=t("<div class='vis-attach-content-wrap' style='display:none;'>"),l.append(g),l.append(B);var U=t("<div style='text-align:center;'>");B.append(U);var F=t("<a title='"+e.Msg.getMsg("Upload")+"' href='javascript:void(0)' style='font-size: 35px; background: none;' class='vis-attach-ico'><i class='fa fa-upload' aria-hidden='true'></i></a>");U.append(F),F.on("click",(function(){Z()}));var j=t("<a title='"+e.Msg.getMsg("Cancel")+"' href='javascript:void(0)' style='font-size: 35px; background: none;'  class='vis-attach-ico'><i class='fa fa-times-circle-o' aria-hidden='true'></i></a>");if(U.append(j),j.on("click",(function(){g.empty(),X=[],W=[],g.hide(),B.hide(),v.css("height","353px")})),h=t("<div class='vis-old-attachments'>"),A.append(h),v=t("<div class='vis-attach-content-wrap' style='height: 353px;'>"),h.append(v),null!=s&&(n=s.AD_Attachment_ID),null!=s&&null!=s._lines)for(var z in n=s.AD_Attachment_ID,s._lines)H(s._lines[z],z);var Q=t("<div class='vis-attach-footer'>");A.append(Q);var J=t("<div class='vis-attach-btns pull-right' style='margin-top: 5px;'>");Q.append(J);var $=t('<a  title="'+e.Msg.getMsg("DeleteAll")+'" class="vis-btn">').append(e.Msg.getMsg("DeleteAll"));c||J.append($),$.on("click",(function(){p.endsWith("_ver")?e.ADialog.info("AccessCannotDelete"):0==q.length||r||e.ADialog.confirm("DeleteRecord?",!0,"","Confirm",(function(i){if(i){var n="";for(var a in q)n+=q[a].Line_ID+",";k[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Attachment/DeleteAttachment",dataType:"json",data:{AttachmentLines:n},error:function(){e.ADialog.info("ERRORDeletingFile"),k[0].style.visibility="hidden"},success:function(t){-1==t.result?e.ADialog.info("ErrorDeletingFile"):(v.empty(),q=[]),k[0].style.visibility="hidden"}})}}))}));var K=t('<a title="'+e.Msg.getMsg("close")+'" class="vis-btn">').append(e.Msg.getMsg("close"));K.on("click",(function(){y.onClose&&y.onClose(),m()})),J.append(K),u=!0,k[0].style.visibility="hidden"}}))}var G=function(i){for(var n=[],a=[],s=0;s<i.files.length;s++){if(file=i.files[s],null==file)return;var l=e.context.getContext("#ALLOWED_FILE_EXTENSION");if(l&&l.length>0&&-1==l.split(",").indexOf("."+file.name.split(".").pop()))a.push(file.name);else if(file.name.indexOf("&")>-1||file.name.indexOf("?")>-1||file.name.indexOf("#")>-1||file.name.indexOf("/")>-1||file.name.indexOf("\\")>-1)n.push(file.name);else{for(var o in W)if(file.name==W[o].name)return void window.setTimeout((function(){e.ADialog.info("AlreadyExists")}),20);if(null!=q)for(var o in q)if(file.name==q[o].Name&&!q[o].IsDeleted)return void window.setTimeout((function(){e.ADialog.info("AlreadyExists")}),20);var r={},d=t("<div class='vis-attach-file-wrapla' style='opacity: 0.5'>");g.append(d);var c=t("<div class='vis-attach-file-top'>"),p=t("<a class='vis-file-close-ico'><i class='fa fa-times' aria-hidden='true'></i></a>");c.append(p),d.append(c),g.show(),B.show(),p.on("click",(function(){var e=t(t(this).parent()).parent();e.css("display","none");var i=e.html();for(var n in e.empty(),e=null,W)if(String(i).indexOf(W[n].name)>-1){W.splice(n,1);break}W.length>4?(g.css("height","135px"),v.css("height","135px")):(g.css("height","97px"),v.css("height","180px")),0==W.length&&(g.hide(),B.hide(),g.css("height","0px"),v.css("height","353px"))}));var u=t("<div class='vis-attach-file-content'>");d.append(u);var h=t("<div class='vis-attach-file-icon'>"),f=ae(file.name);h.append(t("<img src='"+f+"'>")),u.append(h);var m=t("<div class='vis-attach-file-text' style='margin-bottom:10px'>"),y="",I=t("<p>");if(file.name.length>17){y=file.name.toString().substr(0,17),I.append(y);var D=t("<a href='#' class='VIS_Pref_tooltip'>").append("..."),w=t("<span style='width: inherit;'>");w.append(t("<img class='VIS_Pref_callout'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/ccc.png").append("ToolTip Text")),w.append(t("<label class='VIS_Pref_Label_Font'>").append(file.name)),D.append(w),I.append(D)}else I.append(file.name);m.append(I),m.append(t("<p>").append((Number(file.size)/1024).toFixed(2)+"KB")),u.append(m),r.Name=file.name,r.Size=file.size,W.push(file),W.length>4?(g.css("height","135px"),v.css("height","135px")):(g.css("height","97px"),v.css("height","180px"))}}if(n.length>0){var b="";for(var C in n)b+=n[C].toString()+"\n";1==n.length?b+="File has":b+="Files have",b+=" invalid name. Please change the file name and try again.",e.ADialog.info(b)}if(a&&a.length>0){var _="";for(var C in a)_.length>0&&(_+=", "),_+=a[C].toString();b="";1==a.length?b+="FileInvalidExtension":b+="FilesInvalidExtension",e.ADialog.warn(b,!0,_)}},q=[],H=function(i,n){var a=t("<div class='vis-attach-file-wrap'>");v.append(a);var s={},l=t("<div class='vis-attach-file-content'>");a.append(l);var o=t("<div class='vis-attach-file-icon'>");o.append(t("<img src='"+ae(i.FileName)+"'>")),l.append(o);var d=t("<div class='vis-attach-file-text'>"),u="",g=t("<p>");if(i.FileName.length>17){u=i.FileName.toString().substr(0,17),g.append(u);var h=t("<a href='#' class='VIS_Pref_tooltip'>").append("..."),f=t("<span style='width: inherit;'>");f.append(t("<img class='VIS_Pref_callout'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/ccc.png").append("ToolTip Text")),f.append(t("<label class='VIS_Pref_Label_Font'>").append(i.FileName)),h.append(f),g.append(h)}else g.append(i.FileName);d.append(g),d.append(t("<p>").append((Number(i.Size)/1024).toFixed(2)+"KB")),l.append(d);var m=t("<div class='vis-attach-BottomRight'>"),y=t("<a href='javascript:void(0)'  class='vis-attach-ico' data-id='"+n+"'><i class='fa fa-long-arrow-down' aria-hidden='true'></i></a>");m.append(y),y.on("click",(function(e){var i=t(this).data("id");q[i].HaveSource?window.open(q[n].Source,"_blank"):ie(i,this)}));var I=t("<a class='vis-attach-ico' data-id='"+n+"'><i class='vis vis-delete' aria-hidden='true'></i></a>");c||m.append(I),I.on("click",(function(){if(p.endsWith("_ver"))e.ADialog.info("AccessCannotDelete");else{if(r)return!1;var i=t(this);e.ADialog.confirm("DeleteRecord?",!0,"","Confirm",(function(n){if(n){var a=i.data("id");k[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Attachment/DeleteAttachment",dataType:"json",data:{AttachmentLines:q[a].Line_ID},error:function(){e.ADialog.info("ERRORDeletingFile"),k[0].style.visibility="hidden"},success:function(t){if(-1==t.result)e.ADialog.info("ErrorDeletingFile");else{var n=i.parent().parent();n.css("display","none"),n.empty(),n=null,q[a].IsDeleted=!0}k[0].style.visibility="hidden"}})}}))}})),a.append(m),s.Name=i.FileName,s.Size=i.Size,s.Line_ID=i.Line_ID,s.HaveSource=!1,s.Source=null,s.IsDeleted=!1,q.push(s)},z=0,Q=0,J=Date.now().toString(),$=1048576,K=0,Y=0,X=[],Z=function(){var e=null;te(!0);var t=0;for(var i in W)t=parseInt(W[i].size/$),file.size%$>0&&t++,K+=t,(e={}).Name=W[i].name,e.Size=W[i].size,X.push(e);ee()},ee=function(){if(null==W||0==W.length)return te(!1),void e.ADialog.info("NothingToUpload");if(Q>=W.length)t.ajax({url:e.Application.contextUrl+"Attachment/SaveAttachmentEntries",dataType:"json",type:"POST",data:{files:JSON.stringify(X),AD_Attachment_ID:n,folderKey:J,AD_Table_ID:a,Record_ID:s,fileLocation:f.val(),NewRecord_ID:o,IsDMSAttachment:d},error:function(){te(!1),X=[],k[0].style.visibility="hidden"},success:function(i){var l=i.result.Error;if(""==l){if(d){var o=t(".vis-old-attachments").find(".vis-attach-file-wrap");o.length>1&&t(o[0]).remove()}ne(100),window.setTimeout((function(){te(!1)}),500),X=[];var r;r={to:v,className:"vis-Att-ui-effects-transfer"},g.effect("transfer",r,500,(function(){window.setTimeout((function(){q=[],v.empty(),t.ajax({url:e.Application.contextUrl+"Attachment/GetAttachment",dataType:"json",data:{AD_Table_ID:a,Record_ID:s},error:function(){e.ADialog.info("ERRORGettingAttachment"),k[0].style.visibility="hidden"},success:function(e){var t=e.result.Attachment;if(null!=t&&(n=t.AD_Attachment_ID),null!=t&&null!=t._lines)for(var i in n=t.AD_Attachment_ID,t._lines)H(t._lines[i],i);k[0].style.visibility="hidden"}}),W=[],g.empty(),g.hide(),B.hide(),g.css("height","0px"),v.css("height","353px"),E.css("width","O%")}),500)}))}else X=[],te(!1),e.ADialog.info(l);z=0,Q=0,K=0,Y=0,k[0].style.visibility="hidden"}});else{var i=new XMLHttpRequest,l=new FormData;l.append("file",W[Q].slice(Y*$,Y*$+Number($))),i.open("POST",e.Application.contextUrl+"Attachment/SaveFileinTemp/?filename="+W[Q].name+"&folderKey="+J,!1),i.onload=function(){if(i.readyState===i.DONE&&200===i.status){if(i.responseText&&i.responseText.indexOf("ERROR")>-1){var t=i.responseText;for(var n in t=t.replace("ERROR: ",""),W)String(t).indexOf(W[n].name)>-1&&W.splice(n,1);return e.ADialog.warn("FilesInvalidExtension",!0,i.responseText),te(!1),void(k[0].style.visibility="hidden")}z++,Y++;var a=parseInt(W[Q].size/$);W[Q].size%$>0&&a++,Y==a&&(Q++,Y=0),z<=K&&ne(parseInt(z/K*80)),window.setTimeout((function(){ee()}),2)}},i.send(l)}},te=function(e){e?(O.show(),R.show(),L.show()):(O.hide(),R.hide(),L.hide())},ie=function(i,l){var o=e.ProcessCtl.prototype.ORIGIN_WINDOW;y.isWindowAction||(o=e.ProcessCtl.prototype.ORIGIN_FORM),k[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Attachment/DownloadAttachment",dataType:"json",data:{fileName:q[i].Name,AD_Attachment_ID:n,AD_AttachmentLine_ID:q[i].Line_ID,actionOrigin:o,originName:e.context.getWindowContext(y.windowNo,"WindowName"),AD_Table_ID:a,recordID:s},error:function(){e.ADialog.info("ERRORGettingFile"),k[0].style.visibility="hidden"},success:function(t){var n=new Date,a=t.result,s=e.Application.contextUrl+"TempDownload/"+a+"/"+q[i].Name+"?"+n.getTime();q[i].Name;q[i].HaveSource=!0,k[0].style.visibility="hidden",window.open(s,"_blank"),q[i].Source=s}})},ne=function(e){E.css("width",e+"%"),P.empty(),P.append(e+"%")},ae=function(t){if(null==t||0==t.length)return"";var i=t.lastIndexOf("."),n=e.Application.contextUrl+"Areas/VIS/Images/";if(i<1)return n+="defult.png";var a=t.substr(i,t.length-i);return n+=".xlsx"==a||".xls"==a?"excel.png":".html"==a||".htm"==a?"html.png":".pdf"==a?"pdf.png":".ppt"==a?"ppt.png":".txt"==a?"text.png":".docx"==a||".doc"==a?"word.png":".xml"==a?"xml.png":".jpg"==a||".gif"==a||".png"==a?"image.png":".mp3"==a?"audio.png":".zip"==a||".rar"==a?"compresed.png":"defult.png"}}i.prototype.setIsWindowAction=function(e){this.isWindowAction=e},e.attachmentForm=i}(VIS,jQuery)},8037:()=>{!function(e,t){var i=e.Application.contextUrl;function n(n,a,s){var l,o=a.getAD_Table_ID(),r=a.getTableName(),d=a.getFields();this.btnfields=[];var c=t("<div class='vis-forms-container'>"),p=this,u=null;this.onClose=null;var g,h,v,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null;function T(e){A[0].style.visibility=e?"visible":"hidden"}function V(e){var t=null;null!=(t=l)&&t.setValue(null)}function N(e,i){var n=i.children()[1],a=null;i.children().length>2&&(a=i.children()[2]),a?t(a).prop("disabled",!e).prop("readonly",!e):null!=n&&t(n).prop("disabled",!e).prop("readonly",!e)}function M(e){if(null==e||0==e.length)return null;for(var t=0;t<d.length;t++){var i=d[t];if(e.equals(i.getColumnName()))return i}return null}function k(e,t){e.prop("disabled",!t)}function O(i,n,a){l=null;var s=null,o=null;i&&(s=a.children()[1],a.children().length>2&&(o=a.children()[2])),null!=s&&(t(s).remove(),null!=o&&t(o).remove(),s=null);var r=null;if(null!=(r=null!=n?n.getIsKey()?new e.Controls.VNumTextBox(n.getColumnName(),!1,!1,!0,n.getDisplayLength(),n.getFieldLength(),n.getColumnName()):e.VControlFactory.getControl(null,n,!0,!1,!1):new e.Controls.VTextBox("columnName",!1,!0,!1,20,20,"format","GetObscureType",!1))&&null!=n){r.setReadOnly(!1),n.getDisplayType()==e.DisplayType.AmtDimension&&(r.hideButton(!1),r.setReadOnlyTextbox(!1)),e.DisplayType.Text==n.getDisplayType()||e.DisplayType.TextLong==n.getDisplayType()?(r.getControl().attr("rows","1"),r.getControl().css("width","100%")):e.DisplayType.YesNo==n.getDisplayType()?r.getControl().css("clear","both"):e.DisplayType.IsDate(n.getDisplayType())&&r.getControl().css("line-height","1");var d=null;r.getBtnCount()>0&&!(r instanceof e.Controls.VComboBox)&&(d=r.getBtn(0)),i&&(a.append(r.getControl()),l=r,d&&(a.append(d),r.getControl().css("width","calc(100% - 30px)"),d.css("max-width","30px"))),n.getDisplayType()==e.DisplayType.AmtDimension&&r.getControl().css("width","100%")}else a.append(r.getControl()),y.show()}function L(){var e=null;return null!=(e=l)?e.getDisplayType():0}function R(){var e=I.val();if(!e||"-1"==e)return!1;var t=I.find("option:selected").text();if(null==t||0==t.trim().length)return!1;e.toString(),S.find('tbody [data-cVal="'+e+'"]').length}function E(){var t=f.val();if(!t||"-1"==t)return!1;var i=f.find("option:selected").text();if(null==i||0==i.trim().length)return!1;if(t.toString(),S.find('tbody [data-cVal="'+t+'"]').length>0)e.ADialog.info("AlreadyAdded");else{var n,a=(n=null,!0&&(n=l),null!=n?n.getDisplayType()==e.DisplayType.YesNo?"true"==n.getValue().toString().toLowerCase()?"Y":"N":n.displayType==e.DisplayType.AmtDimension?n.getText():n.getValue():"");L()==e.DisplayType.Date&&(a=a.replace("Z",""));var s='<tr class="vis-advancedSearchTableRowBatch"><td data-cVal="'+t+'">'+i+'</td><td data-settype="'+L()+'" data-setVal="'+a+'">'+a+'</td><td class="vis-batchUpdate-deletewrap"><i style="cursor:pointer;" class="vis vis-delete" onclick="$(this).closest(\'tr\').remove()"></i></td></tr>';S.find("tbody").append(s),O(!0,null,m),f.val(-1),V()}}function P(){u.close(),c&&c.remove(),c=null,g&&g.off(e.Events.onClick),g=null,h&&h.off(e.Events.onClick),h=null,o=null,r=null,d=null,l=null,u=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,T(!1)}v='<div class="vis-BatchUpdateContentArea" > <div class="vis-advanedSearch-InputsWrap vis-advs-inputwraps ">  <div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-v">    <label id="lblSetColumn_'+n+'"  for="Column">'+e.Msg.getMsg("Column")+'</label>  <select id="drpSetColumn_'+n+'"></select></div><div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-op"><label id="lblSetOperator_'+n+'" for="Oprator">'+e.Msg.getMsg("Operator")+'</label><input id="drpSetOperator_'+n+'"value="=" disabled></div> <div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-v" id="divSetValue1_'+n+'">   <label  id="lblSetQryValue_'+n+'" for="QueryValue">'+e.Msg.getMsg("QueryValue")+'</label> <input class="vis-batchUpdate-font" id="txtSetQryValue_'+n+'" type="text" name="QueryValue"></div><div class="vis-advancedSearch-calender-Icon "><ul><li class=""><button id="btnSetSave_'+n+'" disabled class="vis-ads-icon"><i class="vis vis-plus" aria-hidden="true"></i></button></li></ul></div></div><div class="vis-advanedSearch-InputsWrap vis-advs-inputwraps vis-batchUpdate-inputwrap"><table id="tblSetValue_'+n+'" rules="rows" class="vis-advancedSearchTable"><thead><tr class="vis-advancedSearchTableHeadBatch"><th>'+e.Msg.translate(e.Env.getCtx(),"AD_Column_ID")+"</th><th>"+e.Msg.translate(e.Env.getCtx(),"QueryValue")+'</th><th class="vis-batchUpdate-deletewrap">'+e.Msg.translate(e.Env.getCtx(),"Action")+"</th></tr></thead><div><tbody></tbody></div></table></div></div>",v+='<div class="vis-advcedfooterBtn vis-batchUpdate-footerbtn"><div class="vis-ctrfrm-btnwrp"><button id="btnCancel_'+n+'" class="ui-button ui-widget vis-pull-right ml-2 mr-2" style="border-radius: 0.1rem">'+e.Msg.getMsg("close")+'</button><button id="btnOk_'+n+'" class="ui-button ui-widget vis-pull-right ml-2" style="border-radius: 0.1rem">'+e.Msg.getMsg("Apply")+'</button><div class="vis-ad-w-p-s-main pull-left"><div class="vis-ad-w-p-s-infoline"></div><div class="vis-ad-w-p-s-msg" style="align-items:flex-end;" id="divMessage_'+n+'"></div></div></div></div>',(A=t("<div class='vis-apanel-busy'>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),c.append(A),c.append(v),function(){f=c.find("#drpSetColumn_"+n),m=c.find("#divSetValue1_"+n),y=c.find("#lblSetQryValue_"+n),S=c.find("#tblSetValue_"+n),I=c.find("#drpColumn_"+n),D=c.find("#drpOperator_"+n),C=c.find("#btnSave_"+n),_=c.find("#btnSetSave_"+n),g=c.find("#btnOk_"+n),h=c.find("#btnCancel_"+n),x=c.find("#divMessage_"+n);for(var t='<option value="-1"> </option>',i=[],a=0;a<d.length;a++){var s=d[a],l=s.getColumnName();if(s.getDisplayType()!=e.DisplayType.Image&&s.getDisplayType()!=e.DisplayType.Button){var o=s.getHeader();(null!=o&&0!=o.length||null!=(o=e.Msg.getElement(e.context,l))&&0!=o.Length)&&s.vo.IsUpdateable&&(s.getIsKey()||s.getIsReadOnly()||!s.getIsDisplayed()||s.getIsEncrypted()||""!=s.getCallout()||i.push({value:l,text:o}))}}i.sort((function(e,t){var i=e.text.toUpperCase(),n=t.text.toUpperCase();return i>n?1:i<n?-1:0}));for(var r=0;r<i.length;r++)t+='<option value="'+i[r].value+'">'+i[r].text+"</option>";f.html(t),I.html(t)}(),f.on("change",(function(){var t=f.val();if(V(),t&&"-1"!=t){var i=a.getField(t);c.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 150px)"),p.getIsUserColumn(t)&&c.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 195px)"),i.getDisplayType()==e.DisplayType.YesNo?y.hide():y.show(),O(!0,M(t),m),k(_,!0)}N(!0,m)})),I.on("change",(function(){var t=I.val();if(V(),t&&"-1"!=t){var i=null;i=t.endsWith("_ID")||t.endsWith("_Acct")||t.endsWith("_ID_1")||t.endsWith("_ID_2")||t.endsWith("_ID_3")?p.getOperatorsQuery(e.Query.prototype.OPERATORS_ID):t.startsWith("Is")?p.getOperatorsQuery(e.Query.prototype.OPERATORS_YN):p.getOperatorsQuery(e.Query.prototype.OPERATORS);var n=a.getField(t);c.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 150px)"),p.getIsUserColumn(t)&&c.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 195px)"),n.getDisplayType()==e.DisplayType.YesNo?b.hide():b.show(),D.html(i),D[0].SelectedIndex=0,O(!0,M(t),w),k(C,!0),D.prop("disabled",!1)}N(!0,w)})),D.on("change",(function(){var t=D.val();t||(t="");var i=I.val(),n=M(i);t&&"0"!=t?e.Query.prototype.BETWEEN.equals(t)?O(!1,n,w):n=M(i=I.val()):(k(C,!1),V())})),_.on("click",E),C.on("click",R),g.on("click",(function(){!function(){var n=[],l=[];if(S.find("tbody tr").each((function(){n.push({column:t(this).find("td:eq(0)").data("cval"),setValue:t(this).find("td:eq(1)").data("setval"),setType:t(this).find("td:eq(1)").data("settype")})})),0==n.length)return x.text(e.Msg.getMsg("VIS_AddAction"));for(var d=0;d<s.length;d++)l.push(s[d][(r+"_ID").toLower()]);var c={AD_Table_ID:o,setValue:n,recordIds:l};e.ADialog.confirm("UpdateRecord",!0,"","Confirm",(function(e){e&&(T(!0),t.ajax({url:i+"BatchUpdate/ExcuteBatchUpdate",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify(c),success:function(e){"OK"==e?(a.dataRefreshAll(),P()):(x.text(e),T(!1))},error:function(e){x.text(e)}}))}))}(),a.dataRefreshAll()})),h.on("click",(function(){P()})),this.show=function(){u=new e.ChildDialog,t(window).width()>=1366?(u.setHeight(550),u.setWidth(870)):(u.setHeight(450),u.setWidth(670)),u.setTitle(e.Msg.getMsg("BatchUpdate")),u.setEnableResize(!0),u.setModal(!0),u.onClose=function(){p.onClose(),p.dispose()},u.show(),u.setContent(c),u.hideButtons(),T(!1)},this.disposeComponent=function(){c&&c.remove(),c=null}}n.prototype.getOperatorsQuery=function(t,i){var n="",a="";for(var s in t)a=t[s],i&&(a=e.Msg.getMsg(a)),n+='<option value="'+s+'">'+a+"</option>";return n},n.prototype.getIsUserColumn=function(e){return!(!e.endsWith("atedBy")&&!e.equals("AD_User_ID"))||!!e.equals("SalesRep_ID")},n.prototype.getIsCreated=function(){return this.created},n.prototype.dispose=function(){this.disposeComponent()},e.BatchUpdate=n}(VIS,jQuery)},1634:()=>{!function(e,t){var i=null,n=null,a=null,s=null,l=null,o=null,r=null;function d(i,n){var a=null,s="";url=e.Application.contextUrl+"WSP/Contacts/GetBPLocation?WinNo="+n.windowNo+"&bpartnerID="+i,t.ajax({type:"GET",async:!1,url,dataType:"json",success:function(e){a=JSON.parse(e);for(var t=0;t<a.lstBPLocation.length;t++)s+="<option value='"+a.lstBPLocation[t].ID+"'>"+a.lstBPLocation[t].Name+"</option>";o.empty(),o.append(s)}})}function c(l,o,r){i.onOkClick=function(i){var d=t("#divBPartner_"+a.windowNo).find("img"),c=.5*t(window).height(),p=.5*t(window).width();l.css("margin-top",c),l.css("margin-left",p),r.show(),d.css("visibility","visible");var u=t("#txtName_"+a.windowNo).val(),g=t("#txtSearchKey_"+a.windowNo).val(),h=t("#ddlGreeting1_"+a.windowNo).val(),v=t("#txtName2_"+a.windowNo).val(),f=t("#ddlBPGroup_"+a.windowNo).val(),m=t("#ddlBPRelation_"+a.windowNo).val(),y=t("#ddlBPLoaction_"+a.windowNo).val(),I=t("#txtContact_"+a.windowNo).val(),D=t("#ddlGreeting_"+a.windowNo).val(),w=t("#txtTitle_"+a.windowNo).val(),b=t("#txtEmail_"+a.windowNo).val(),C=s.getValue(),_=t("#txtPhone_"+a.windowNo).val(),S=t("#txtPhone2_"+a.windowNo).val(),x=t("#txtFax_"+a.windowNo).val();if(""==u.trim()||""==g.trim())return e.ADialog.info("NameMandatory"),r.hide(),void d.css("visibility","collapse");var A=null;"Customer"==o?A=e.Msg.getMsg("Customer"):"Employee"==o?A=e.Msg.getMsg("Employee"):"Vendor"==o?A=e.Msg.getMsg("Vendor"):"Prospect"==o&&(A=e.Msg.getMsg("Prospect")),url=e.Application.contextUrl+"WSP/Contacts/AddBPartnerInfo","0"==f&&(f=void 0),"0"==m&&(m=void 0),"0"==y&&(y=void 0),"0"==D&&(D=void 0),"0"==h&&(h=void 0),null==C&&(C=void 0),""==_&&(_=void 0),""==S&&(S=void 0),""==I&&(I=void 0),null==u&&(u=void 0),""==x&&(x=void 0),""==g&&(g=void 0),""==w&&(w=void 0),""==b&&(b=void 0),""==A&&(A=void 0),t.ajax({type:"Post",async:!1,url,dataType:"json",data:{searchKey:g,name:u,name2:v,greeting:D,bpGroup:f,bpRelation:m,bpLocation:y,contact:I,greeting1:h,title:w,email:b,address:C,phoneNo:_,phoneNo2:S,fax:x,windowNo:a.windowNo,BPtype:A},success:function(e){r.hide(),d.css("visibility","collapse"),n.empty()}})}}function p(i,n,c,p,u,g){var h=t("<table id='tableBPartner_"+a.windowNo+"'><tr><td><div style='margin-top: 0px; float: right' class='wsp-BPartner'>"+e.Msg.getMsg("SearchKey")+" </div></td><td style='width:300px'><div style='margin-top: 0px;width:100%' class='wsp-BPartner'><input id='txtSearchKey_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td><td style='width:50px'></td> <td style='margin-left:10px'><div style='margin-top: 0px; float: right;margin-right: 5px' class='wsp-BPartner'>"+e.Msg.getMsg("Greeting")+"  </div></td><td style='width:300px'><div style='margin-top: 0px;margin-right:5px' class='wsp-BPartner'><select id='ddlGreeting1_"+a.windowNo+"' style='width:100%'>"+i+"</select></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Name")+"  </div></td><td style='width:300px'><div style='width:100%' class='wsp-BPartner'><input id='txtName_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Name2")+"  </div></td><td style='width:300px'><div style='width:100%' class='wsp-BPartner'><input id='txtName2_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td><td style='width:50px'> </td> <td style='margin-left:10px'><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("BPGroup")+"  </div></td><td style='width:300px'><div style='margin-right: 5px' class='wsp-BPartner'><select id='ddlBPGroup_"+a.windowNo+"' style='width: 100%'>"+n+"</select></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("BPRelation")+"  </div></td><td style='width:300px'><div style='width:100%' class='wsp-BPartner'><select style='width:100%' id='ddlBPRelation_"+a.windowNo+"' >"+p+"</select></div></td> <td style='width:50px'></td><td style='margin-left:10px'><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("BPLoaction")+"  </div></td><td style='width:300px'><div  class='wsp-BPartner' style='margin-right: 5px'><select id='ddlBPLoaction_"+a.windowNo+"' style='width:100%'></select></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Contact")+"  </div></td><td style='width:300px'><div style='width:100%' class='wsp-BPartner'><input id='txtContact_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td> <td style='width:50px'></td><td style='margin-left:10px'><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Greeting")+"  </div></td><td style='width:300px'><div  class='wsp-BPartner' style='margin-right: 5px'><select id='ddlGreeting_"+a.windowNo+"' style='width: 100%'>"+i+"</select></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Title")+"  </div></td><td style='width:300px'><div style='width:100%' class='wsp-BPartner'><input id='txtTitle_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td> <td style='width:50px'></td><td style='margin-left:10px'><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("EmailAddress")+"  </div></td><td style='width:300px'><div  class='wsp-BPartner' style='margin-right: 5px'><input id='txtEmail_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Address")+"  </div></td><td style='width:300px'><div style='width:100%' id='divAddress_"+a.windowNo+"' class='wsp-BPartner' ></div> </td> <td style='width:50px'></td><td style='margin-left:10px'><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Phone")+"  </div></td><td style='width:300px'><div  class='wsp-BPartner' style='margin-right: 5px'><input id='txtPhone_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td></tr><tr><td><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("2ndPhone")+"  </div></td><td style='width:300px'><div class='wsp-BPartner' style='width:100%;'><input id='txtPhone2_"+a.windowNo+"' style='height: 25px;width:100%' type='text'></div></td> <td style='width:50px'></td><td style='margin-left:10px'><div style='float: right' class='wsp-BPartner'>"+e.Msg.getMsg("Fax")+"  </div></td><td style='width:300px' ><div style='margin-bottom:7px;margin-right: 5px' class='wsp-BPartner' ><input id='txtFax_"+a.windowNo+"' style='height: 25px;width:100%;' type='text'></div></td></tr></table>"),v=h.find("#divAddress_"+a.windowNo);return h.find("#ddlBPRelation_"+a.windowNo).val(u),l=h.find("#ddlBPRelation_"+a.windowNo),o=h.find("#ddlBPLoaction_"+a.windowNo),r=h.find("#ddlBPGroup_"+a.windowNo).val(g),d(u,a),s.getBtn(0).css("width","10%"),s.getBtn(0).css("height","10%"),s.getBtn(0).css("padding","0px"),s.getBtn(1).css("width","10%"),s.getBtn(1).css("height","10%"),s.getBtn(1).css("padding","0px"),v.append(s.getControl().css("width","80%")).append(s.getBtn(0)).append(s.getBtn(1)),h}e.BPartner=function(o,r,u,g,h,v,f){null!=n&&n.empty(),function(a,o,r,u,g,h,v){var f=null,m="",y="",I="",D="",w=new e.MLocationLookup(e.context.ctx,a.windowNo);(s=new e.Controls.VLocation("C_Location_ID",!0,!1,!0,e.DisplayType.Location,w)).getBtnCount();n=t("<div id='divBPartner_"+a.windowNo+"' style='width:auto;height:auto;margin-right:5px'> <img src='/ViennaAdvantageWeb1/Areas/VIS/Images/busy.gif' style=' margin-top: 120px; margin-left: 327px; z-index:9999;position:absolute;visibility:collapse'>");var b=e.Application.contextUrl+"WSP/Contacts/AddBusinessPartner?WinNo="+a.windowNo+"&UserID="+o;t.ajax({type:"GET",async:!1,url:b,dataType:"json",success:function(e){for(var t=JSON.parse(e),i=0;i<t.lstGreeting.length;i++)m+="<option value='"+t.lstGreeting[i].ID+"'>"+t.lstGreeting[i].Name+"</option>";for(i=0;i<t.lstBPGroup.length;i++)y+="<option value='"+t.lstBPGroup[i].ID+"'>"+t.lstBPGroup[i].Name+"</option>";for(i=0;i<t.lstBPRelation.length;i++)I+="<option value='"+t.lstBPRelation[i].ID+"'>"+t.lstBPRelation[i].Name+"</option>";for(i=0;i<t.lstBPLocation.length;i++)D+="<option value='"+t.lstBPLocation[i].ID+"'>"+t.lstBPLocation[i].Name+"</option>";f=p(m,y,D,I,r,u)}}),n.append(f),n.load(),function(t,n,a,s,l,o){(i=new e.ChildDialog).setContent(t),"Customer"==n?i.setTitle(e.Msg.getMsg("Customer")):"Employee"==n?i.setTitle(e.Msg.getMsg("Employee")):"Vendor"==n?i.setTitle(e.Msg.getMsg("Vendor")):"Prospect"==n&&i.setTitle(e.Msg.getMsg("Prospect"));i.setEnableResize(!1),i.setModal(!0),i.show(),c(l,n,o),a.on("change",(function(){d(a.val(),s)}))}(n,g,l,a,h,v)}(a=o,r,u,g,h,v,f)},e.AddUpdateBPartner=function(a,d,c,p,u,g){var h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=(D=null,null),x=null,A=null,T=0,V=0,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P="",U=null,F=null,B=null;function W(e,t,i){return"<DIV class='vis-BPsplitter' style='width:"+e+"'><span style='background-color: white; position: relative;top: -0.8em;margin-left: "+i+"px;'> "+t+" </span></DIV>"}function j(){v.off("focusout"),h.off("focusout"),r.off("focusout"),S.off("focusout"),x.off("focusout"),y.off("focusout"),s.dispose(),s=null,h=null,m=null,S=null,y=null,w=null,_=null,f=null,I=null,b=null,C=null,v=null,D=null,c=null,n.remove(),n.empty()}function G(n,a,d){i.onOkClick=function(i){if(null!=A){A.show();t(window).height(),t(window).width()}else t(".vis-apanel-busy").css("visibility","visible");if(N=s.getValue(),""==v.val().trim())return e.ADialog.info("SearchKeyMandatory"),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden"),!1;if(""==h.val().trim())return e.ADialog.info("NameMandatory"),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden"),!1;if("0"==r.val().trim())return e.ADialog.info("BPGroupMandatory"),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden"),!1;if(""==y.val().trim())return e.ADialog.info("ContactMandatory"),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden"),!1;if(N<=0||null==N)return e.ADialog.info("AddressMandatory"),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden"),!1;if(0==M.is(":checked")&&0==k.is(":checked")&&0==O.is(":checked")&&0==L.is(":checked"))return e.ADialog.info("PleaseSelectBusinessType"),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden"),!1;var c;c=a,url=e.Application.contextUrl+"BPartner/AddBPartnerInfo";var p=v.val(),u=h.val(),g=h.val(),m=f.val(),C=r.val(),S=l.val(),x=o.val(),T=y.val(),V=(I.val(),D.val()),R=w.val(),P=b.val(),U=b.val(),W=_.val(),j=M.is(":checked"),G=k.is(":checked"),q=O.is(":checked"),H=L.is(":checked"),z=F.val(),Q=B.val();window.setTimeout((function(){t.ajax({type:"Post",async:!1,url,dataType:"json",data:{C_BPartner_ID:d,searchKey:p,name:u,name2:g,greeting:m,bpGroup:C,bpRelation:S,bpLocation:x,contact:T,greeting1:m,title:V,email:R,address:N,phoneNo:P,phoneNo2:U,fax:W,windowNo:n,BPtype:c,isCustomer:j,isVendor:G,isProspect:q,fileName:E,mobile:z,webUrl:Q,isEmployee:H},success:function(i){e.ADialog.info("","",JSON.parse(i)),null!=A&&A.hide(),t(".vis-apanel-busy").css("visibility","hidden")}})}),2)}}function q(i,n,a){var s=null,l="";url=e.Application.contextUrl+"BPartner/GetBPLocation?WinNo="+n+"&bpartnerID="+i,t.ajax({type:"GET",async:!1,url,dataType:"json",success:function(t){s=JSON.parse(t);for(var i=0;i<s.lstBPLocation.length;i++)l+="<option value='"+s.lstBPLocation[i].ID+"'>"+e.Utility.encodeText(s.lstBPLocation[i].Name)+"</option>";o.empty(),o.append(l),o.val(a)}})}null==p&&(t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","9999999")),A=p,null!=n&&n.empty(),T=u,V=g,function(a,d,c){!function(a,d,c){var p=null,u="",g="",N=new e.MLocationLookup(e.context.ctx,a);(s=new e.Controls.VLocation("C_Location_ID",!0,!1,!0,e.DisplayType.Location,N)).getBtnCount();n=t("<div id='divBPartner_"+a+"' style='width:auto;height:auto;margin-right:5px'> <img src='/ViennaAdvantageWeb1/Areas/VIS/Images/busy.gif' style=' margin-top: 120px; margin-left: 327px; z-index:9999;position:absolute;visibility:collapse'>"),function(n,a,s,l){(i=new e.ChildDialog).setContent(n),i.onClose=function(){j()},t(window).width()>=1366?(i.setHeight(620),i.setWidth(870)):(i.setHeight(520),i.setWidth(670));i.setTitle(e.Msg.getMsg("BusinessPartner")),i.setEnableResize(!1),i.setModal(!0),i.show(),i.getRoot().dialog({position:[200,130]})}(n);var H=e.Application.contextUrl+"BPartner/InitBP?WinNo="+a+"&bPartnerID="+d+"&bpType="+c;t.ajax({type:"GET",async:!1,url:H,dataType:"json",success:function(i){for(var n=JSON.parse(i),A=0;A<n.lstGreeting.length;A++)u+="<option value='"+n.lstGreeting[A].ID+"'>"+e.Utility.encodeText(n.lstGreeting[A].Name)+"</option>";for(A=0;A<n.lstBPGroup.length;A++)g+="<option value='"+n.lstBPGroup[A].ID+"'>"+e.Utility.encodeText(n.lstBPGroup[A].Name)+"</option>";p=function(i,n,a,d,c,p,u,g){var A=t("<DIV class='vis-MainDivBPartnerPopUp'><DIV class='vis-DivBPartnerLeft' ><DIV class='vis-FirstDivBPartnerPopUp' > </DIV>"+W("50%","Phone Number",5)+W("50%","Internet",100)+"<DIV class='vis-SecondDivBPartnerPopUp'> </DIV>"+W("100%","Address",5)+"<DIV class='vis-ThirdDivBPartnerPopUp'> </DIV> </DIV><DIV class='vis-FourthDivBPartnerPopUp'> </DIV> </DIV>");A.find(".vis-FirstDivBPartnerPopUp").append("<DIV class='vis-FirstDivCotrol' ></DIV>"),A.find(".vis-FirstDivBPartnerPopUp").append("<DIV class='vis-DivBPartnerRight' > </DIV>"),A.find(".vis-SecondDivBPartnerPopUp").append("<DIV class='vis-SecondDivCotrol' ></DIV> "),A.find(".vis-SecondDivBPartnerPopUp").append("<DIV class='vis-SecondDivImgCotrol'></DIV> "),A.find(".vis-ThirdDivBPartnerPopUp").append("<DIV class='vis-ThirdDivCotrol' ></DIV>"),A.find(".vis-FourthDivBPartnerPopUp").append("<DIV class='vis-FourthDivHeader' > "+e.Msg.getMsg("BPType")+" </DIV> <DIV class='vis-FourthDivControl'></DIV>"),A.find(".vis-DivBPartnerRight").append("<div class='image-upload' style='float: right; position: absolute; z-index: 999; top:40px;overflow:hidden;right:20px'><label for='file-input' class='vis-file-label-bp'><span style='margin-right:8px' class='vis-change-picture-ico vis vis-pencil'></span></label><input type='file' id='VISFileDialog_"+i+"' accept='image/*' class='wsp-file-input' value='Add Pic' style='opacity: 0; width: 100%; margin-top: 0px; float: right; z-index: 999; position: absolute; right: 0px; cursor: pointer;'></div>"),A.find(".vis-DivBPartnerRight").append("<DIV class='vis-FirstDivImgCotrol'></DIV>"),A.find(".vis-FirstDivCotrol").append("<DIV class='vis-FirstDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("SearchKeyValue")+"  </div> <div class='vis-all-control'><input class='vis-gc-vpanel-table-mandatory'  id='txtSearchKey_"+i+"' style='height: 25px;width:100%' type='text'></div></DIV>"),A.find(".vis-FirstDivCotrol").append("<DIV class='vis-FirstDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("Greeting")+"  </div> <div class='vis-all-control'><select id='ddlGreeting_"+i+"' style='width: 100%'>"+c+"</select></div></DIV>"),A.find(".vis-FirstDivCotrol").append("<DIV class='vis-FirstDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("ContactName")+"  </div> <div class='vis-all-control'><input class='vis-gc-vpanel-table-mandatory' id='txtContact_"+i+"' style='height: 25px;width:100%' type='text'> </div></DIV>"),A.find(".vis-FirstDivCotrol").append("<DIV class='vis-FirstDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("CompanyName")+"  </div> <div class='vis-all-control'><input class='vis-gc-vpanel-table-mandatory' id='txtName_"+i+"' style='height: 25px;width:100%' type='text'> </div></DIV>"),A.find(".vis-FirstDivCotrol").append("<DIV class='vis-FirstDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("BusinessPartnerGroup")+"  </div> <div class='vis-all-control'><select class='vis-gc-vpanel-table-mandatory' id='ddlBPGroup_"+i+"' style='width: 100%;float:left'>"+p+"</select> </div></DIV>"),A.find(".vis-FirstDivImgCotrol").append("<DIV class='vis-FirstDivCotrolChild' >  <div style='float: left;width:100%;height:242px;line-height:236px;background: none repeat scroll 0% 0% #EEE;padding:0px;text-align:center;margin-top:20px' ><img id='imgBPartner_"+i+"' /></div> "),A.find(".vis-SecondDivCotrol").append("<DIV class='vis-SecondDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("Phone")+"  </div> <div class='vis-all-control'><input id='txtPhone_"+i+"' style='height: 25px;width:100%' type='text'></div></DIV>"),A.find(".vis-SecondDivCotrol").append("<DIV class='vis-SecondDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("Mobile")+"  </div> <div class='vis-all-control'><input id='txtMobile_"+i+"' style='height: 25px;width:100%' type='text'></div></DIV>"),A.find(".vis-SecondDivCotrol").append("<DIV class='vis-SecondDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("Fax")+"  </div> <div class='vis-all-control'><input id='txtFax_"+i+"' style='height: 25px;width:100%;' type='text'> </div></DIV>"),A.find(".vis-SecondDivImgCotrol").append("<DIV class='vis-SecondDivCotrolChild' > <div class='vis-all-lable'>"+e.Msg.getMsg("EmailAddress")+"  </div> <div class='vis-all-control'><input id='txtEmail_"+i+"' style='height: 25px;width:100%' type='text'> </div></DIV>"),A.find(".vis-SecondDivImgCotrol").append("<DIV class='vis-SecondDivCotrolChild' > <div class='vis-all-lable'>"+e.Msg.getMsg("WebUrl")+"  </div> <div class='vis-all-control'><input id='txtWebUrl_"+i+"' style='height: 25px;width:100%' type='text'> </div></DIV>"),A.find(".vis-ThirdDivCotrol").append("<DIV class='vis-ThirdDivCotrolChild'> <div class='vis-all-lable'>"+e.Msg.getMsg("Address")+"  </div> <div id='divAddress_"+i+"' class='vis-all-control'></div></DIV>"),A.find(".vis-FourthDivControl").append("<DIV style='float: left;width:25%'> <div style='float: left;width:100%' class='wsp-BPartner'><input id='chkCustomer_"+i+"' type='checkbox'> "+e.Msg.getMsg("Customer")+"</div></DIV>"),A.find(".vis-FourthDivControl").append("<DIV style='float: left;width:25%'> <div style='float: left;width:100%' class='wsp-BPartner'><input id='chkVendor_"+i+"' type='checkbox'>  "+e.Msg.getMsg("Vendor")+" </div></DIV>"),A.find(".vis-FourthDivControl").append("<DIV style='float: left;width:25%'> <div style='float: left;width:100%' class='wsp-BPartner'><input id='chkProspect_"+i+"' type='checkbox'> "+e.Msg.getMsg("Prospect")+"</div></DIV>"),A.find(".vis-FourthDivControl").append("<DIV style='float: left;width:25%'> <div style='float: left;width:100%' class='wsp-BPartner'><input id='chkEmployee_"+i+"' type='checkbox'> "+e.Msg.getMsg("Employee")+"</div></DIV>");var N=A.find("#divAddress_"+i);l=A.find("#ddlBPRelation_"+i),o=A.find("#ddlBPLoaction_"+i),r=A.find("#ddlBPGroup_"+i),h=A.find("#txtName_"+i),v=A.find("#txtSearchKey_"+i),I=A.find("#ddlGreeting1_"+i),m=A.find("#txtName2_"+i),y=A.find("#txtContact_"+i),f=A.find("#ddlGreeting_"+i),D=A.find("#txtTitle_"+i),w=A.find("#txtEmail_"+i),b=A.find("#txtPhone_"+i),C=A.find("#txtPhone2_"+i),_=A.find("#txtFax_"+i),M=A.find("#chkCustomer_"+i),k=A.find("#chkVendor_"+i),O=A.find("#chkProspect_"+i),L=A.find("#chkEmployee_"+i),s.setValue(d.location),R=A.find("#VISFileDialog_"+i),U=A.find("#imgBPartner_"+i),F=A.find("#txtMobile_"+i),B=A.find("#txtWebUrl_"+i),void R.on("change",(function(t){P=Date.now().toString();var i=new XMLHttpRequest,n=new FormData;n.append("file",R[0].files[0]),n.append("fileKey",P),i.open("POST",e.Application.contextUrl+"BPartner/SaveImageAsByte",!0),i.setRequestHeader("Cache-Control","no-cache"),i.setRequestHeader("Pragma","no-cache"),i.send(n),i.addEventListener("load",(function(e){var t=e.target.response,i=JSON.parse(t),n=JSON.parse(i);U.removeAttr("src").attr("src","data:image/jpg;base64,"+n[0]),E=n[1]}),!1)})),n>0?(l.val(d.bpRelationID),r.val(d.bpGroupID),o.val(d.bpLocationID),h.val(e.Utility.decodeText(d.name)),v.val(e.Utility.decodeText(d.searchKey)),I.val(),m.val(e.Utility.decodeText(d.name2)),U.removeAttr("src").attr("src",d.userImage),y.val(e.Utility.decodeText(d.contact)),f.val(),D.val(e.Utility.decodeText(d.title)),w.val(e.Utility.decodeText(d.email)),b.val(e.Utility.decodeText(d.phoneNo)),C.val(e.Utility.decodeText(d.phoneNo2)),_.val(e.Utility.decodeText(d.fax)),f.val(d.greeting),I.val(d.greeting1),s.setValue(d.location),F.val(d.mobile),B.val(d.WebUrl),d.isCustomer&&M.attr("checked","checked"),d.isVendor&&k.attr("checked","checked"),d.isEmployee&&L.attr("checked","checked"),q(e.Utility.Util.getValueOfInt(l.val()),i,d.bpLocationID)):T>0&&V>0&&(A.find("#ddlBPRelation_"+i).val(T),A.find("#ddlBPGroup_"+i).val(V),q(e.Utility.Util.getValueOfInt(l.val()),i,d.bpLocationID));return s.getBtn(0).css("width","10%"),s.getBtn(0).css("height","30px"),s.getBtn(0).css("padding","0px"),s.getBtn(1).css("width","10%"),s.getBtn(1).css("height","30px"),s.getBtn(1).css("padding","0px"),N.append(s.getControl().css("width","80%")).append(s.getBtn(0)).append(s.getBtn(1)),S=A.find("#divAddress_"+i).find("Input"),x=A.find("#divAddress_"+i).find("Button").eq(1),G(i,a,n),l.on("change",(function(){q(e.Utility.Util.getValueOfInt(l.val()),i)})),v.on("focusout",(function(){""==v.val()?t("#divSearchKey").css("visibility","visible"):t("#divSearchKey").css("visibility","collapse ")})),h.on("focusout",(function(){""==h.val()?t("#divName").css("visibility","visible"):t("#divName").css("visibility","collapse")})),r.on("focusout",(function(){"0"==r.val()||""==r.val()?t("#divBPGroup").css("visibility","visible"):t("#divBPGroup").css("visibility","collapse ")})),S.on("focusout",(function(){s.getValue()<=0?t("#divAddressValidate_"+i).css("visibility","visible"):t("#divAddressValidate_"+i).css("visibility","collapse ")})),x.on("focusout",(function(){s.getValue()<=0?t("#divAddressValidate_"+i).css("visibility","visible"):t("#divAddressValidate_"+i).css("visibility","collapse ")})),y.on("focusout",(function(){""==y.val()?t("#divContact_"+i).css("visibility","visible"):t("#divContact_"+i).css("visibility","collapse")})),A}(a,d,c,n,u,g)}}),window.setTimeout((function(){null!=i&&(n.append(p),n.load(),t(".vis-apanel-busy").css("visibility","hidden"),t(".vis-apanel-busy").css("height","460px"),t(".vis-apanel-busy").css("z-index","99"),null!=A&&A.hide())}),500)}(a,d,c)}(a,d,c)}}(VIS,jQuery)},4058:()=>{!function(e,t){e.BulkDownload=function(i,n){this.onClose=null;var a=t("<div></div>"),s=(t('<div style="overflow-y:auto;margin-bottom:15px"></div>'),t('<p id="forreportcreate"></p><div class="vis-ui-progress-bar hide" id="reportcreate"><div class="progress-bar vis-ui-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><br /><p class="hide" id="reportcreateresult"></p> <div style="margin-bottom: 15px;"></div>')),l=t('<p id="forreportdownload" class="hide"></p><div class="vis-ui-progress-bar hide" id="reportdownload"><div class="progress-bar vis-ui-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><br /><p class="hide" id="reportdownloadresult"></p>'),o=t("<div class='vis-apanel-busy' style='width:98%;height:98%;position:absolute'>");a.append(o).append(s).append(l),this.winNo=i;var r=null;this.prop={WindowNo:i},function(t,i,n,a){s.filter("p#forreportcreate").text(e.Msg.getMsg("Generating"+a+"File")),l.filter("p#forreportdownload").text(e.Msg.getMsg("Downloading"+a+"File"))}(0,0,this.prop,n);var d=this;this.show=function(){(r=new e.ChildDialog).setContent(a),r.setHeight(450),r.setWidth(650),r.setTitle(e.Msg.getMsg("Reports")),r.setModal(!0),r.onClose=function(){d.onClose&&d.onClose(),d.dispose()},r.show(),r.hidebuttons()},this.onClose=function(){r.close()},this.setBulkBusy=function(e){o.css("display",e?"block":"none")},this.dispose=function(){this.prop=null,null,a=null,r=null,d=null,this.setBulkBusy(!1)}}}(VIS,jQuery)},792:()=>{!function(e,t){function i(){this.frame;var i=this,n=e.Env.getWindowNo(),a=null,s=1,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=!1,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=[],U=2,F=null,B=!1,W=null,j=null,G=null,q=null,H=null,z=null,Q=null,J=null,$=null,K=0,Y=null,X=null,Z=null,ee={},te=null,ie=!1,ne=[],ae=0,se=["px","%","cm","mm","in","pc","pt","ch","em","rem","vh","vw","vmin","vmax"],le={width:{proprty:"width",value:"",measurment:!0},minWidth:{proprty:"min-width",value:"",measurment:!0},height:{proprty:"height",value:"",measurment:!0},minHeight:{proprty:"min-height",value:"",measurment:!0},fontSize:{proprty:"font-size",value:"",measurment:!0},fontFamily:{proprty:"font-family",value:"",measurment:!1},color:{proprty:"color",value:"",measurment:!1},border:{proprty:"border",value:"",measurment:!0},borderType:{proprty:"border-style",value:"",measurment:!1},borderColor:{proprty:"border-color",value:"",measurment:!1},borderLeft:{proprty:"border-left-width",value:"",measurment:!0},borderLeftStyle:{proprty:"border-left-style",value:"",measurment:!1},borderLeftColor:{proprty:"border-left-color",value:"",measurment:!1},borderTop:{proprty:"border-top-width",value:"",measurment:!0},borderTopStyle:{proprty:"border-top-style",value:"",measurment:!1},borderTopColor:{proprty:"border-top-color",value:"",measurment:!1},borderRight:{proprty:"border-right-width",value:"",measurment:!0},borderRightStyle:{proprty:"border-right-style",value:"",measurment:!1},borderRightColor:{proprty:"border-right-color",value:"",measurment:!1},borderBottom:{proprty:"border-bottom-width",value:"",measurment:!0},borderBottomStyle:{proprty:"border-bottom-style",value:"",measurment:!1},borderBottomColor:{proprty:"border-bottom-color",value:"",measurment:!1},borderRadius:{proprty:"border-radius",value:"",measurment:!0},borderTopLeftRadius:{proprty:"border-top-left-radius",value:"",measurment:!0},borderTopRightRadius:{proprty:"border-top-right-radius",value:"",measurment:!0},borderBottomRightRadius:{proprty:"border-bottom-right-radius",value:"",measurment:!0},borderBottomLeftRadius:{proprty:"border-bottom-left-radius",value:"",measurment:!0},padding:{proprty:"padding",value:"",measurment:!0},paddingLeft:{proprty:"padding-left",value:"",measurment:!0},paddingTop:{proprty:"padding-top",value:"",measurment:!0},paddingRight:{proprty:"padding-right",value:"",measurment:!0},paddingBottom:{proprty:"padding-bottom",value:"",measurment:!0},margin:{proprty:"margin",value:"",measurment:!0},marginLeft:{proprty:"margin-left",value:"",measurment:!0},marginTop:{proprty:"margin-top",value:"",measurment:!0},marginRight:{proprty:"margin-right",value:"",measurment:!0},marginBottom:{proprty:"margin-bottom",value:"",measurment:!0},opacity:{proprty:"opacity",value:"",measurment:!1},backgroundColor:{proprty:"background-color",value:"",measurment:!1},gradientInput:{proprty:"background",value:"",measurment:!1},gradient:{proprty:"background",value:"",measurment:!1},boxShadow:{proprty:"box-shadow",value:"",measurment:!0},flexDirection:{proprty:"flex-direction",value:"",measurment:!1},bold:{proprty:"font-weight",value:"bold",measurment:!1},italic:{proprty:"font-style",value:"italic",measurment:!1},underline:{proprty:"text-decoration",value:"underline",measurment:!1},upperCase:{proprty:"text-transform",value:"uppercase",measurment:!1},capitalize:{proprty:"text-transform",value:"capitalize",measurment:!1},textLeft:{proprty:"text-align",value:"left",measurment:!1},textCenter:{proprty:"text-align",value:"center",measurment:!1},textJustify:{proprty:"text-align",value:"justify",measurment:!1},textRight:{proprty:"text-align",value:"right",measurment:!1},lowerCase:{proprty:"text-transform",value:"lowercase",measurment:!1},flexJustifyCenter:{proprty:"justify-content",value:"center",measurment:!1},flexJustifyStart:{proprty:"justify-content",value:"flex-start",measurment:!1},flexJustifyEnd:{proprty:"justify-content",value:"flex-end",measurment:!1},flexJustifySpaceBetween:{proprty:"justify-content",value:"space-between",measurment:!1},flexJustifySpaceAround:{proprty:"justify-content",value:"space-around",measurment:!1},flexAlignCenter:{proprty:"align-items",value:"center",measurment:!1},flexAlignEnd:{proprty:"align-items",value:"flex-end",measurment:!1},flexAlignStart:{proprty:"align-items",value:"flex-start",measurment:!1},maxTextmultiline:{proprty:"-webkit-line-clamp",value:"",measurment:!1},objectFit:{proprty:"object-fit",value:"",measurment:!1}},oe=t('<div style="height:100%"><div class="vis-apanel-busy vis-cardviewmainbusy" style="display:block"></div></div>'),re=t("<div class='vis-apanel-busy vis-cardviewmainbusy'></div> ");function de(e){e&&null!=re&&re.css({display:"block"}),e||null==re||re.css({display:"none"})}var ce=function(e,t){var i=0,n=e.parent().offset(),a=n.left,s=n.top;if(D){var l={x:t.clientX-a,y:t.clientY-s};return i=-Math.atan2(l.x-9,l.y-9)/(Math.PI/180)+180,i=Math.ceil(i)}};function pe(){var i=l.find(".vis-active-template").clone(!0);i.attr("lastupdated")&&h.text(e.Msg.getMsg("LastSaved")+" "+i.attr("lastupdated")),i.find(".mainTemplate").css("zoom",1),CardCreatedby=i.attr("createdBy"),i.attr("isSystemTemplate"),X.val("0"==i.attr("category")?"":i.attr("category")),p=i.find(".mainTemplate").attr("templateid"),I=p,templateName=i.find(".mainTemplate").attr("name"),"0"==p&&i.find(".mainTemplate").html(t('<div name="Section 1" sectionCount="1" class="section1 vis-wizard-section" style="padding:5px;"></div>')),i.find("[contenteditable]").attr("contenteditable",!0),E.val(i.find(".mainTemplate").attr("name")),p=i.find(".mainTemplate").attr("templateid"),""==i.html()&&null==i.html()||(i.find(".vis-wizard-section").each((function(){for(var e=t(this).attr("row"),i=t(this).attr("col"),n=[],a=0;a<e*i;a++)n.push('<div class="grdDiv" style="display:none"></div>');t(this).find(".grdDiv").each((function(){var e=t(this).css("grid-area").split("/"),a=i*(t.trim(e[0])-1)+(t.trim(e[1])-1);t.trim(e[0])==t.trim(e[2])-1&&t.trim(e[1])==t.trim(e[3])-1||t(this).append('<span class="vis-split-cell"></span>'),n[a]=t(this)[0].outerHTML})),t(this).html(n.join(" "))})),d.find(".vis-viewBlock").attr("style",i.find(".mainTemplate").attr("style")||""),d.find(".vis-viewBlock").html(i.find(".mainTemplate").html()),d.find(".vis-viewBlock").find(".fieldValue").attr("contenteditable",!0),d.find(".vis-viewBlock").find(".fieldLbl").attr("contenteditable",!0),d.find(".fieldGroup").each((function(){t(this).find(".imgField").length>0&&t(this).find(".fieldValue").length>0?t(this).find(".fieldLbl").attr("title","Image+Text"):t(this).find(".imgField").length>0&&t(this).find(".fieldLbl").attr("title","Image")})),d.find(".grdDiv").unbind("mouseover"),d.find(".grdDiv").mouseover((function(e){D&&0==t(this).find(".vis-split-cell").length&&fe(t(this))})))}var ue=function(){ee={};var e=v.find(".grid-Section:first").clone(!0);e.removeClass("displayNone"),v.find(".grid-Section:not(:first)").remove(),d.find(".vis-wizard-section").each((function(i){var n=t(this).attr("sectionCount");0==i&&(e.addClass("section-active"),t(this).addClass("vis-active-block")),e.attr("sectionCount",n);var a=t(this).attr("name");if(e.find(".vis-grey-disp-ttl").text(a),v.find(".vis-sectionAdd").append(e),(e=v.find(".grid-Section:first").clone(!0)).removeClass("displayNone"),!ee["section"+n]){var s=t(this).attr("row"),l=t(this).attr("col"),o=t(this)[0].style.gridTemplateColumns.split(" "),r=t(this)[0].style.gridTemplateRows.split(" "),d={};for(i=0;i<s;i++)if(r.length>0&&"auto"!=r[i]){var c=r[i].replace(/\'/g,"").split(/(\d+)/).filter(Boolean);d["row_"+i]={val:c[0],msr:c[1]}}else d["row_"+i]={val:1,msr:"auto"};for(var p=0;p<l;p++)if(o.length>0&&"auto"!=o[p]){var u=o[p].replace(/\'/g,"").split(/(\d+)/).filter(Boolean);d["col_"+p]={val:u[0],msr:u[1]}}else d["col_"+p]={val:1,msr:"auto"};d.sectionNo=n,d.sectionName=a,d.rowGap=0,d.colGap=0,d.totalRow=s,d.totalCol=l,ee["section"+n]=d}})),v.find(".vis-sectionAdd").sortable({disabled:!1,update:function(e,t){var i=t.item.attr("sectioncount"),n=(t.item.index(),t.item.next().attr("sectioncount"));if(n)d.find('[sectioncount="'+n+'"]').before(d.find('[sectioncount="'+i+'"]'));else{var a=t.item.prev().attr("sectioncount");d.find('[sectioncount="'+a+'"]').after(d.find('[sectioncount="'+i+'"]'))}}}),v.find(".section-active .vis-grey-disp-el").click(),v.find(".vis-grey-disp-el-xross").eq(1).hide()};function ge(){var e=f;e.find(".grdDiv").unbind("mouseover"),e.find(".grdDiv").mouseover((function(e){D&&0==t(this).find(".vis-split-cell").length&&fe(t(this))}))}function he(e,i){e||(e=0),i||(i=0);var n=v.find(".section-active").attr("sectionCount"),a=v.find(".section-active .vis-grey-disp-ttl").text(),s={},l="";v.find(".rowBox:not(:first)").each((function(e){0==e&&t(this).find(".grdRowDel").hide(),"auto"==t(this).find("select :selected").val()?l+=t(this).find("select :selected").val()+" ":l+=t(this).find("input").val()+""+t(this).find("select :selected").val()+" ",s["row_"+e]={val:t(this).find("input").val(),msr:t(this).find("select :selected").val()}}));var o="";v.find(".colBox:not(:first)").each((function(e){0==e&&t(this).find(".grdColDel").hide(),"auto"==t(this).find("select :selected").val()?o+=t(this).find("select :selected").val()+" ":o+=t(this).find("input").val()+""+t(this).find("select :selected").val()+" ",s["col_"+e]={val:t(this).find("input").val(),msr:t(this).find("select :selected").val()}}));var r=v.find(".rowBox:not(:first)").length,d=v.find(".colBox:not(:first)").length;s.sectionNo=n,s.sectionName=a,s.rowGap=A.val(),s.colGap=T.val(),s.totalRow=r,s.totalCol=d,ee["section"+n]=s;var c=f;c.attr("row",r),c.attr("col",d),c.css({"grid-template-columns":o,"grid-template-rows":l,gap:A.val()+"px "+T.val()+"px"});var p=!1,u=L,g=R;-1==e&&u--,-1==i&&g--;var h=0,m=P;c.find(".grdDiv").each((function(n){var a=t(this).css("grid-area").split("/"),s=Number(t.trim(a[0])),l=Number(t.trim(a[2])),o=Number(t.trim(a[1])),r=Number(t.trim(a[3])),v=Math.floor(n/d)+1;if(null!=L){if(L>s-1&&L<l-1&&(t(this).css("grid-area",s+"/"+o+"/"+(l+e)+"/"+r),p=!0),p&&e>0){for(var f=Number(s);f<=Number(l);f++){for(var y=o;y<r;y++){var I=d*f+y;c.find(".grdDiv").eq(I-1).css("display","none")}if(L==f)break}p=!1,L=null}}else if(null!=R&&(R>o-1&&R<r-1&&(t(this).css("grid-area",s+"/"+o+"/"+l+"/"+(r+i)),p=!0,c.find(".grdDiv").eq(m[h]).css("display","none")),h++,p&&i>0)){for(f=0;f<P.length;f++){var D=Math.floor(P[f]/d)+1;D>s-1&&D<l&&c.find(".grdDiv").eq(P[f]).css("display","none")}p=!1,P=[]}a=t(this).css("grid-area").split("/"),s=Number(t.trim(a[0])),l=Number(t.trim(a[2])),o=Number(t.trim(a[1])),r=Number(t.trim(a[3]));var w=n%d+1;0==t(this).find(".vis-split-cell").length?t(this).css("grid-area",v+"/"+w+"/"+(v+1)+"/"+(w+1)):0!=i?i>0?w>g&&t(this).css("grid-area",s+"/"+(o+i)+"/"+l+"/"+(r+i)):w>g&&t(this).css("grid-area",s+"/"+(o-1)+"/"+l+"/"+(r-1)):0!=e&&(e>0?v>u&&t(this).css("grid-area",s+e+"/"+o+"/"+(l+e)+"/"+r):v>u&&t(this).css("grid-area",s-1+"/"+o+"/"+(l-1)+"/"+r))})),R=null}function ve(){var e=v.find(".rowBox"),t=v.find(".colBox"),i=e.length-1,n=t.length-1,a=f;if(n>0&&i>0){var s=a.attr("row"),l=a.attr("col");if(l==n||B)for(var o=i*n-a.find(".grdDiv").length,r=0;r<o;r++)a.append("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>");else for(var d=1;d<=s;d++){var c=d*l+(d-1);a.find(".grdDiv").eq(c-1).after("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>")}ge(),B=!1}he()}function fe(e){var t=v.find(".colBox").length-1,i=f.find(e).index();if(!(i<0)){var n,a,s,l,o=Math.ceil((i+1)/t)-1,r=i-t*o;o<m?(n=o,a=m):(n=m,a=o),r<y?(s=r,l=y):(s=y,l=r),d.find(".vis-active-block").removeClass("vis-active-block");for(var c=n;c<=a;c++)for(var p=s;p<=l;p++)f.find(".grdDiv").eq(t*c+p).addClass("vis-active-block");d.find(".vis-active-block").length>1?g.find('[command="Merge"]').parent().show():g.find('[command="Merge"]').parent().hide()}}function me(){var e=0,i=0,n=0,a=1,s=0,l=1,o=f.find(".vis-active-block").length,r=1,d=0,c=v.find(".colBox").length-1;f.find(".grdDiv").each((function(p){s++;var u=Math.ceil((p+1)/c);u!=r&&(s=1),r=u,t(this).hasClass("vis-active-block")&&(0==d&&(d=u),0==e&&0==n&&(e=u,n=s,a=s),d==u&&a++,l==o&&(i=u+1),l++,t(this)[0].style.removeProperty("grid-area"),t(this)[0].style.removeProperty("display"))}));var p=t('<span class="vis-split-cell"></span>');f.find(".vis-active-block:not(:first)").hide().removeClass("vis-active-block"),f.find(".vis-active-block:first").css("grid-area",e+"/"+n+"/"+i+"/"+a).append(p),p.click((function(){ye(t(this).parent()),t(this).remove()}))}function ye(e){for(var i=e.css("grid-area").split("/"),n=v.find(".colBox").length-1,a=f.find(".grdDiv"),s=Number(t.trim(i[0]));s<Number(t.trim(i[2]));s++)for(var l=Number(t.trim(i[1]));l<Number(t.trim(i[3]));l++){var o=n*(s-1)+(l-1);a.eq(o)[0].style.removeProperty("grid-area"),a.eq(o)[0].style.removeProperty("display")}he()}function Ie(e,i,n){var a=n.attr("style"),s=!1;return a&&a.split(";").forEach((function(n){var a=n.split(":");i&&t.trim(a[0])===e&&t.trim(a[1])===i?s=!0:i||t.trim(a[0])!==e||(s=!0)})),s}function De(e,i){d.css({width:o.find(".vis-cardViewTemplateHead")[0].offsetWidth,overflow:"auto"});var n=d.find(".vis-active-block");if("flex-direction"==le[e].proprty&&(n[0].style.removeProperty("display"),n.find(".fieldGroup").removeAttr("style")),"maxTextmultiline"==e&&(""==i||null==i?(n[0].style.removeProperty("overflow"),n[0].style.removeProperty("display"),n[0].style.removeProperty("-webkit-box-orient")):n.css({overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical"})),"gradient"==e||""!=i&&null!=i){if("gradient"==e){var a=r.find("."+e+"1").val(),s=r.find("."+e+"2").val(),l=r.find(".percent1").val(),c=r.find(".percent2").val(),p=r.find(".grdDirection option:selected").val();i="linear-gradient("+p+","+a+" "+l+"%,  "+s+" "+c+"%)",r.find('[data-command="gradientInput"]').val("("+p+","+a+" "+l+"%,  "+s+" "+c+"%)")}if("gradientInput"==e&&(i="linear-gradient"+i),"boxShadow"==e)i=r.find(".boxX").val()+" "+r.find(".boxY").val()+" "+r.find(".boxB").val()+" "+r.find(".boxC").val();if("justify-content"!=le[e].proprty&&"align-items"!=le[e].proprty&&"flex-direction"!=le[e].proprty||(n.css("display","flex"),"flex-direction"==le[e].proprty&&n.find(".fieldGroup").css({display:"flex","flex-direction":t.trim(i)})),"column"==i||"column-reverse"==i?r.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").addClass("vis-disable-event"):r.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").removeClass("vis-disable-event"),"width"==e||"height"==e){var u=n.attr("style")+";"+le[e].proprty+":"+t.trim(i)+" !important";n.attr("style",u)}else n.css(le[e].proprty,t.trim(i));Ae()}else n[0].style.removeProperty(le[e].proprty)}function we(e){try{if(/^#[0-9A-F]{6}$/i.test(e))return e;function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])}catch(i){return e}}function be(e,t){t.closest(".fieldGroup").remove(),t.remove(),g.hide()}function Ce(){de(!0);var i=e.Application.contextUrl+"CardView/GetSystemTemplateDesign";l.find('.mainTemplate[templateid="0"]').parent().click(),l.find(".vis-cardSingleViewTemplate:not(:first)").remove();t.ajax({type:"POST",url:i,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({}),success:function(e){for(var i=JSON.parse(e),n=0;n<i.length;n++)l.find(".vis-cardTemplateContainer").append(t(i[n].template));de(!1),1==l.find(".vis-cardSingleViewTemplate:not(:hidden)").length?l.find(".vis-noTemplateIcon").show():l.find(".vis-noTemplateIcon").hide()},error:function(e){alert(e.statusText),de(!1)},complete:function(){l.find(".vis-cardSingleViewTemplate").click((function(e){t(e.target).hasClass("chkMark")||(0==t(e.target).index()?Z.hide():Z.show(),l.find(".vis-cardSingleViewTemplate").removeClass("vis-active-template"),t(this).addClass("vis-active-template"),l.find(".chkMark").prop("checked",!1),t(this).find(".chkMark").prop("checked",!0),oe.find(".chkMark").change())})),l.find(".vis-deleteTemplate").click((function(){var i,n;i=Number(t(this).next().attr("templateID")),n=t(this),e.ADialog.confirm("SureWantToDelete",!0,"",e.Msg.getMsg("Confirm"),(function(a){if(a){var s=e.Application.contextUrl+"CardView/DeleteTemplate";t.ajax({type:"POST",async:!1,url:s,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({tempID:i}),success:function(e){JSON.parse(e),n.parent().remove()},error:function(e){alert(e.statusText)}})}}))})),Se(),t.each(oe.find('[issystemtemplate="Y"]:not(:first)'),(function(){var e='<div style="position: absolute;left: 5px;top: 5px;z-index:9"><input type="checkbox" value="'+t(this).find(".mainTemplate").attr("templateid")+'" class="pull-right vis-styledCheckbox m-0 chkMark" style="width:20px;height:20px;position: absolute;" ><label></label></div>';t(this).append(e)})),_e(),oe.find(".chkMark").change((function(){oe.find(".chkMark:checked").length>0?Z.show():Z.hide(),oe.find(".chkMark:checked").length>1?c.hide():c.show()}))}})}function _e(){oe.find(".vis-removeExport").remove();var i=e.dataContext.getJSONData(e.Application.contextUrl+"CardView/GetExportTemplateIDs",null,null);if(null!=i){for(var n in i)oe.find('.mainTemplate[templateid="'+i[n].split("|")[0]+'"]').closest(".vis-cardSingleViewTemplate").prepend('<i data-id="'+i[n]+'" class="vis vis-remove-export-data vis-removeExport" title="Remove export" style=""></i>');oe.find(".vis-removeExport").click((function(){var i=t(this),n=i.data("id").split("|")[0];e.ADialog.confirm("SureWantToRemove",!0,"",e.Msg.getMsg("Confirm"),(function(t){if(t){var a={templateID:n},s=e.dataContext.getJSONData(e.Application.contextUrl+"CardView/RemoveExportTemplate",a,null);null!=s&&s>0&&i.remove()}}))}))}}function Se(){l.find(".vis-cardSingleViewTemplate").each((function(){var e=t(this).height(),i=t(this).width(),n=t(this).find(".mainTemplate"),a=1,s=e/n.height(),l=i/n.width();a=s>l?l:s,n.css("zoom",a)}))}function xe(e,i,n,a){var s='<div class="fieldGroup" draggable="true">';if(t.trim(a.val()).length>0){if(n){var l=d.find(".vis-active-block");l.removeAttr("class"),l.addClass("imgField vis-active-block"),l.addClass(t.trim(a.val())),Ae()}else if(i){s+='<span class="fieldLbl" title="Image+Text" contenteditable="true">Label</span>',s+='<i class="imgField '+t.trim(a.val())+'"></i>',s+='<span class="fieldValue" contenteditable="true">:Value</span>',s+="</div>";var o=d.find(".vis-active-block");o.hasClass("grdDiv")&&o.append(t(s)),Ae()}}else{var r=e[0].files[0],c=URL.createObjectURL(r),p=new Image;p.src=c,p.onerror=function(){URL.revokeObjectURL(this.src),console.log("Cannot load image")},p.onload=function(){URL.revokeObjectURL(this.src);var e=function(e,t,i){var n=e.width,a=e.height;n>a?n>t&&(a=Math.round(a*t/n),n=t):a>i&&(n=Math.round(n*i/a),a=i);return{width:n,height:a}}(p,320,180);newWidth=e.width,newHeight=e.height;var a=document.createElement("canvas");if(a.width=newWidth,a.height=newHeight,a.getContext("2d").drawImage(p,0,0,newWidth,newHeight),a.toBlob((function(e){}),"image/jpeg",.7),n)d.find(".vis-active-block").attr("src",a.toDataURL()),Ae();else{i?(s+='<span class="fieldLbl" title="Image+Text" contenteditable="true">Label</span>',s+='<img class="imgField" style="width:30px; height:30px" src="'+a.toDataURL()+'">',s+='<span class="fieldValue" contenteditable="true">:Value</span>'):(s+='<span class="fieldLbl displayNone" title="Image" contenteditable="true" showfieldtext="true" >Label</span>',s+='<img class="imgField" style="width:100px; height:100px" src="'+a.toDataURL()+'">'),s+="</div>";var l=d.find(".vis-active-block");l.hasClass("grdDiv")&&l.append(t(s)),Ae()}}}}function Ae(){var e=d.find(".vis-viewBlock").html();ae<ne.length-1&&(ne=ne.slice(0,ae+1),ae++);var t=JSON.stringify(e);t==ne[ae]&&1!=K||(ne.push(t),ne.length>11&&ne.shift(),ae=ne.length-1),o.find(".vis-v-rowcol").hide(),G.attr("disabled","disabled"),j.removeAttr("disabled")}function Te(){return te.close(),!0}this.getRoot=function(){return oe},this.show=function(i,n){var a=t("<div>"),s=t('<input type="file" name="" maxlength="50" style="height: 45px;padding: 10px" class="" accept="image/*" placeholder=" " data-placeholder="">'),l=t('<label for="">'+e.Msg.getMsg("SelectFromFiles")+"</label>"),o=t('<div class="input-group vis-input-wrap"></div>'),r=t('<div class="vis-control-wrap"></div>');if(r.append(s).append(l),o.append(r),a.append(o),IconInput=t('<input type="text" name="" class="" placeholder=" " data-placeholder="">'),i){var d=t('<div class="mb-2"><center>OR</center></div>');o=t('<div class="input-group vis-input-wrap"></div>'),l=t('<label style="left:10px" for="">'+e.Msg.getMsg("Icon")+"</label>"),(r=t('<div class="vis-control-wrap"></div>')).append(IconInput).append(l),o.append(r),a.append(d).append(o),a.append('<div class="input-group vis-input-wrap "><div class="vis-control-wrap"><p style="word-break: break-all" for="">'+e.Msg.getMsg("IconLinkMsg")+"</p></div></div>")}s.change((function(){IconInput.val(""),t(this).val().length>0?IconInput.attr("disabled","disabled"):IconInput.removeAttr("disabled")})),IconInput.change((function(){s.val(""),t(this).val().length>0?s.attr("disabled","disabled"):s.removeAttr("disabled"),-1!=IconInput.val().indexOf("fa-")&&-1==IconInput.val().indexOf("fa ")?IconInput.val("fa "+IconInput.val()):-1!=IconInput.val().indexOf("vis-")&&-1==IconInput.val().indexOf("vis ")&&IconInput.val("vis "+IconInput.val())})),ch=new e.ChildDialog,ch.setTitle(e.Msg.getMsg("InsertImage")),ch.setWidth("30%"),ch.setContent(a),ch.onOkClick=function(e){xe(s,i,n,IconInput)},ch.onCancelClick=Te,ch.onClose=Te,ch.show()},this.disposeComponent=function(){i=null,oe.remove(),oe=null},oe.load(e.Application.contextUrl+"CardViewWizard/GetCardTemplate/?windowno="+n,(function(K){oe.append(re),a=oe.find("#BtnTemplateBack_"+n),l=oe.find("#DivTemplate_"+n),oe.find("#DivCardFieldSec_"+n),o=oe.find("#DivCardStep2_"+n),d=oe.find("#DivViewBlock_"+n),r=oe.find("#DivStyleSec1_"+n),c=oe.find("#BtnLayoutSetting_"+n),u=oe.find("#BtnChangeTemplate_"+n),g=o.find(".vis-topNavigator"),v=oe.find("#DivGridSec_"+n),f=d.find(".section1"),w=oe.find("#chkAllBorderRadius_"+n),b=oe.find("#chkAllPadding_"+n),C=oe.find("#chkAllMargin_"+n),_=oe.find("#chkAllBorder_"+n),E=oe.find("#txtTemplateName_"+n),O=oe.find("#BtnFinesh_"+n),S=oe.find("#txtCustomStyle_"+n),x=oe.find("#txtSQLQuery_"+n),A=v.find(".rowGap"),T=v.find(".colGap"),k=oe.find("#Btn_BlockCancel_"+n),V=oe.find("#BtnAddField_"+n),N=oe.find("#BtnAddImgField_"+n),M=oe.find("#BtnAddImgTxtField_"+n),h=oe.find("#spnLastSaved_"+n),F=oe.find("#btnEditIcon_"+n),W=oe.find("#btnaddBlankTemplate_"+n),j=oe.find("#btnUndo_"+n),G=oe.find("#btnRedo_"+n),H=oe.find("#btnVaddrow_"+n),z=oe.find("#btnVaddCol_"+n),Q=oe.find("#btnVdelrow_"+n),J=oe.find("#btnVdelCol_"+n),Z=oe.find("#BtnExport_"+n),$=oe.find("#BtnRefreshTemplate_"+n),Y=oe.find("#CmbTemplateCategory_"+n),X=oe.find("#CmbViwBlockTemplateCategory_"+n),r.find(".nav-tabs li:last").hide(),a.hide(),Ce(),Y.find("option").remove(),X.find("option").remove(),Y.append('<option value="">All</option>'),X.append('<option value="">--Select Category--</option>'),t.ajax({type:"POST",url:e.Application.contextUrl+"CardView/GetTemplateCategory",dataType:"json",contentType:"application/json; charset=utf-8",data:{},success:function(e){var t=JSON.parse(e);if(t)for(var i=0;i<t.length;i++)Y.append('<option value="'+t[i].TemplateCategoryID+'">'+t[i].Name+"</option>"),X.append('<option value="'+t[i].TemplateCategoryID+'">'+t[i].Name+"</option>");de(!1)},error:function(e){alert(e.statusText),de(!1)}}),t("body").mouseup((function(e){D=!1})),V.click((function(){g.hide();var e=t('<div class="fieldGroup" draggable="true"><span class="fieldLbl" title="Label" contenteditable="true">Label</span><span class="fieldValue" contenteditable="true">:Value</span></div>'),i=d.find(".vis-active-block");i.hasClass("grdDiv")&&i.append(e),Ae()})),N.click((function(){g.hide(),i.show(!1)})),M.click((function(){g.hide(),i.show(!0)})),F.click((function(){g.hide();var e=d.find(".vis-active-block").closest(".fieldGroup");e.find(".imgField").length>0&&e.find(".fieldValue").length>0?i.show(!0,!0):i.show(!1,!0)})),a.click((function(e){s++,l.hide(),o.find(".vis-two-sec-two").show(),r.show()})),c.click((function(){pe(),s++,ue(),l.hide(),o.find(".vis-two-sec-two").show(),r.show(),0==p&&1==v.find(".rowBox").length&&(v.find(".addGridCol").click(),v.find(".addGridRow").click()),0==p&&d.find(".vis-viewBlock").css("backgroundColor","#fff"),F.hide(),ie=!1,ne=[],!0,ae=0,Ae(),j.attr("disabled","disabled")})),u.click((function(){a.show(),g.hide(),s--,l.show(),r.hide(),o.find(".vis-two-sec-two").hide(),l.find('[templateid="'+I+'"]').click(),Se(),Y.val(""),l.find('[issystemtemplate="Y"]').removeClass("displayNone")})),O.click((function(i){!function(i){if(i.preventDefault(),""==E.val())return e.ADialog.error("FillMandatory",!0,"Template Name"),!1;var n=!1;if(0==p&&l.find(".mainTemplate").each((function(){if(t(this).attr("name")&&t.trim(t(this).attr("name").toUpperCase())==t.trim(E.val().toUpperCase()))return n=!0,e.ADialog.error("TempalteAlreadyExist",!0,""),!1})),n)return!1;de(!0);var a=[],s=10,o=[];cardViewColArray=[],d.find(".grdDiv:not(:hidden)").each((function(e){var i=t(this).css("grid-area").split("/"),n=t(this).closest(".vis-wizard-section").attr("sectioncount");ee["section"+n].style=t(this).closest(".vis-wizard-section").attr("style"),ee["section"+n].sectionID=t(this).closest(".vis-wizard-section").attr("sectionid")||0;var l=10*(t(this).closest(".vis-wizard-section").index()+1);ee["section"+n].sectionSeq=l,ee["section"+n].sectionName=t(this).closest(".vis-wizard-section").attr("name");var o=null;if(t(this).find("sql").length>0&&(o=t(this).attr("query")||null),t(this).find(".fieldGroup:not(:hidden)").length>0)t(this).find(".fieldGroup:not(:hidden)").each((function(e){var n="",d=t(this).find(".fieldLbl").text(),c="";if(t(this).find(".imgField").length>0&&t(this).find(".fieldValue").length>0){if(t(this).find(".imgField").attr("src"))n='<img class="imgField" src="'+t(this).find(".imgField").attr("src")+'" style="'+t(this).find(".imgField").attr("style")+'">';else{var p=t(this).find(".imgField").attr("class");n='<i class="imgField '+(p=p.replace("vis-active-block",""))+'" style="'+t(this).find(".imgField").attr("style")+'"></i>'}n+=" |"+t(this).find(".fieldValue").text();var u=t(this).find("br").length;t(this).find(".imgField").next(".fieldValue").length>0?(c="@img::"+t(this).find(".imgField").attr("style")||0,u>0&&(c+="|<br>"),c+=" |@value::"+t(this).find(".fieldValue").attr("style")||0):(c="@value::"+t(this).find(".fieldValue").attr("style")||0,u>0&&(c+="|<br>"),c+=" |@img::"+t(this).find(".imgField").attr("style")||0)}else t(this).find(".imgField").length>0?(n='<img class="imgField" src="'+t(this).find(".imgField").attr("src")+'" style="'+t(this).find(".imgField").attr("style")+'">',c="@value::"+t(this).find(".fieldValue").attr("style")||0,c+=" |@img::"+t(this).find(".imgField").attr("style")||0):(n=t(this).find(".fieldValue").text(),c=t(this).find(".fieldValue").attr("style")||"");var g=!0;0==t(this).find(".fa-star").length&&(g=!0),t(this).find(".fieldLbl").attr("showfieldicon")&&(g="true"==t(this).find(".fieldLbl").attr("showfieldicon")),r={cardFieldID:t(this).attr("cardfieldid"),sectionNo:l,rowStart:t.trim(i[0]),rowEnd:t.trim(i[2]),colStart:t.trim(i[1]),colEnd:t.trim(i[3]),seq:s,style:t(this).closest(".grdDiv").attr("style"),fieldID:t(this).find(".fieldLbl").attr("fieldid"),valueStyle:c,fieldStyle:t(this).find(".fieldLbl").attr("style")||"",hideFieldIcon:g,hideFieldText:"true"==t(this).find(".fieldLbl").attr("showfieldtext"),columnSQL:o,contentFieldValue:n,contentFieldLabel:d},a.push(r)}));else{var r={cardFieldID:null,sectionNo:l,rowStart:t.trim(i[0]),rowEnd:t.trim(i[2]),colStart:t.trim(i[1]),colEnd:t.trim(i[3]),seq:s,style:t(this).attr("style"),fieldID:null,valueStyle:"",fieldStyle:"",hideFieldIcon:!1,hideFieldText:!1,columnSQL:o,contentFieldValue:null,contentFieldLable:null};a.push(r)}s+=10})),Object.keys(ee).forEach((function(e){var t={sectionName:ee[e].sectionName,sectionID:ee[e].sectionID,sectionNo:ee[e].sectionSeq,style:ee[e].style,totalRow:ee[e].totalRow,totalCol:ee[e].totalCol,rowGap:ee[e].rowGap,colGap:ee[e].colGap};o.push(t)}));var r={CardViewID:0,templateID:p||0,templateName:E.val(),templateCategory:X.find("option:selected").val()||0,style:d.find(".vis-viewBlock").attr("style"),cardSection:o,cardTempField:a,isSystemTemplate:"Y",refTempID:0},c=e.Application.contextUrl+"CardView/SaveCardTemplate";t.ajax({type:"POST",async:!1,url:c,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(r),success:function(t){var i=JSON.parse(t);if(isNaN(i))return toastr.error(i,"",{timeOut:3e3,positionClass:"toast-top-center",closeButton:!0}),void de(!1);p=i,"Y",toastr.success(e.Msg.getMsg("SavedSuccessfully"),"",{timeOut:3e3,positionClass:"toast-top-center",closeButton:!0}),de(!1);var n=oe.find('.mainTemplate[templateid="'+i+'"] ').closest(".vis-cardSingleViewTemplate").find(".vis-removeExport");if(n.length>0){var a=n.data("id").split("|");t={moduleId:a[1],_strRecordID:a[0]},e.dataContext.getJSONData(e.Application.contextUrl+"CardView/SaveCardExportData",t)}Ce()},error:function(e){alert(e.statusText),de(!1)}})}(i)})),Z.click((function(){!function(){rootMI=t("<div>");var i=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>');i[0].style.visibility="visible",rootMI.append(i);var n=t("<div>"),a=t("<div class='vis-markmodulemainwrap'>");n.append(a);var s=t("<div>");n.append(s);var l=e.Msg.getMsg("Cancel"),o=e.Msg.getMsg("Ok"),r=t("<button class='VIS_Pref_btn-2' style='margin-top: 5px;margin-bottom: -10px;'>").append(l),d=t("<button class='VIS_Pref_btn-2' style='margin-top: 5px;margin-bottom: -10px;margin-right:5px'>").append(o);s.append(r),s.append(d),rootMI.append(n);var c=t("<table>");if((te=new e.ChildDialog).setTitle(e.Msg.getMsg("Module")),te.setWidth("30%"),te.setContent(rootMI),te.onOkClick=function(e){},te.onCancelClick=Te,te.onClose=Te,te.show(),te.hideButtons(),lstModules=[],null!=(v=e.dataContext.getJSONData(e.Application.contextUrl+"MarkModule/LoadModules",null,null)))for(var p in v){var u={AD_ModuleInfo_ID:v[p].AD_ModuleInfo_ID,Name:v[p].Name};lstModules.push(u)}var g="";t.each(oe.find(".chkMark:checked"),(function(){g+=this.value+","})),g=g.replace(/,(\s+)?$/,"");var h=[];if(g.length>0){var v,f={_strRecordID:g};if(null!=(v=e.dataContext.getJSONData(e.Application.contextUrl+"CardView/GetCardExportData",f,null)))for(var p in v)h.push(v[p])}var m=null,y=null,I=null,D=null,w=[];if(0==h.length)for(p=0;p<lstModules.length;p++)m=t("<tr>"),y=t("<td>"),I=t('<label class="vis-gc-vpanel-table-label-checkbox" style="display: inline-block; opacity: 1;">'),D=t("<input type='checkbox'>"),I.append(D),I.append(lstModules[p].Name),y.append(I),m.append(y),c.append(m),(C={}).Ctrl=D,C.AD_ModuleInfo_ID=lstModules[p].AD_ModuleInfo_ID,w.push(C);else for(var b=0;b<lstModules.length;b++){var C;m=t("<tr>"),y=t("<td>"),I=t('<label class="vis-gc-vpanel-table-label-checkbox" style="display: inline-block; opacity: 1;">'),D=h.indexOf(lstModules[b].AD_ModuleInfo_ID)>-1?t("<input type='checkbox' checked>"):t("<input type='checkbox'>"),I.append(D),I.append(lstModules[b].Name),y.append(I),m.append(y),c.append(m),(C={}).Ctrl=D,C.AD_ModuleInfo_ID=lstModules[b].AD_ModuleInfo_ID,w.push(C)}a.append(c),i[0].style.visibility="hidden",d.on("click",(function(){i[0].style.visibility="visible";for(var t=[],n=0;n<w.length;n++)w[n].Ctrl.prop("checked")&&t.push(w[n].AD_ModuleInfo_ID);var a={moduleId:t,_strRecordID:g},s=e.dataContext.getJSONData(e.Application.contextUrl+"CardView/SaveCardExportData",a);"OK"!=s.result?alert(s.result):(Te(),toastr.success(e.Msg.getMsg("SavedSuccessfully"),"",{timeOut:3e3,positionClass:"toast-top-center",closeButton:!0}),_e()),i[0].style.visibility="hidden"})),r.on("click",(function(){Te()}))}()})),$.click((function(){Y.val(""),Ce()})),l.find(".vis-cardSingleViewTemplate").click((function(e){t(e.target).hasClass("chkMark")||(0==t(e.target).index()?Z.hide():Z.show(),l.find(".vis-cardSingleViewTemplate").removeClass("vis-active-template"),t(this).addClass("vis-active-template"),l.find(".chkMark").prop("checked",!1),t(this).find(".chkMark").prop("checked",!0),oe.find(".chkMark").change())})),w.change((function(){t(this).is(":checked")?(r.find(".allBorderRadius").removeClass("displayNone"),r.find(".singleBorderRadius").addClass("displayNone")):(r.find(".allBorderRadius").addClass("displayNone"),r.find(".singleBorderRadius").removeClass("displayNone"))})),b.change((function(){t(this).is(":checked")?(r.find(".allPadding").removeClass("displayNone"),r.find(".singlePadding").addClass("displayNone")):(r.find(".allPadding").addClass("displayNone"),r.find(".singlePadding").removeClass("displayNone"))})),C.change((function(){t(this).is(":checked")?(r.find(".allMargin").removeClass("displayNone"),r.find(".singleMargin").addClass("displayNone")):(r.find(".allMargin").addClass("displayNone"),r.find(".singleMargin").removeClass("displayNone"))})),_.change((function(){t(this).is(":checked")?(r.find(".allBorder").removeClass("displayNone"),r.find(".singleBorder").addClass("displayNone")):(r.find(".allBorder").addClass("displayNone"),r.find(".singleBorder").removeClass("displayNone"))})),r.find(".vis-circular-slider-circle").mousedown((function(e){D=!0})).mousemove((function(e){if(D){var t=r.find(".vis-circular-slider-dot"),i=ce(t,e);t.css({WebkitTransform:"rotate("+i+"deg)"}),t.css({"-moz-transform":"rotate("+i+"deg)"}),t.attr("deg",i),De("gradient",i)}})),g.find("i").click((function(){var e=d.find(".vis-active-block"),i=t(this).attr("command"),n=e.closest(".fieldGroup").find(".fieldLbl");if("Show"==i)"I"!=e.prop("tagName")||e.hasClass("imgField")?(n.attr("showFieldText",!1),n.removeClass("displayNone")):(e.attr("class","fa fa-star"),e.next().attr("showFieldIcon",!1)),g.find('[command="Hide"]').parent().show(),g.find('[command="Show"]').parent().hide(),g.hide(),Ae();else if("Hide"==i)"I"!=e.prop("tagName")||e.hasClass("imgField")?e.hasClass("imgField")||e.hasClass("fieldValue")?e.css("display","none"):(e.attr("showFieldText",!0),e.addClass("displayNone")):(e.attr("class",""),e.next().attr("showFieldIcon",!0)),g.find('[command="Hide"]').parent().hide(),g.find('[command="Show"]').parent().show(),g.hide(),F.hide(),Ae();else if("SelectParent"==i)e.parent().hasClass("fieldGroup")?e.parent().parent().mousedown().mouseup():e.parent().mousedown().mouseup();else if("Separate"==i)ye(e),e.find(".vis-split-cell:first").remove(),t(this).parent().hide(),Ae();else if("Merge"==i)me(),g.find('[command="Merge"]').parent().hide(),Ae();else if("Unlink"==i){g.hide();var a=e.closest(".fieldGroup").find(".fieldLbl");be(a.attr("title"),a),F.hide(),Ae()}else"ShowImg"==i?(e.closest(".fieldGroup").find(".imgField").css("display","unset"),g.find('[command="ShowImg"]').parent().hide(),Ae()):"ShowValue"==i&&(e.closest(".fieldGroup").find(".fieldValue").css("display","unset"),g.find('[command="ShowValue"]').parent().hide(),Ae())})),d.find(".canvas *").mousedown((function(e){setTimeout((function(){if("SQL"!=e.target.tagName&&!t(e.target).hasClass("fieldGroup")&&!t(e.target).hasClass("vis-addRemoveRowCol"))if(e.ctrlKey)t(e.target).attr("contenteditable")&&t(e.target).attr("contenteditable",!1);else{if(t(e.target).attr("contenteditable")&&t(e.target).attr("contenteditable",!0),o.find(".vis-v-rowcol").hide(),t(e.target).hasClass("grdDiv")?(e.preventDefault(),V.removeClass("vis-disable-event"),N.removeClass("vis-disable-event"),M.removeClass("vis-disable-event"),function(e){o.find(".vis-v-rowcol").show();var i=t(e.target).index(),n=function(e){var t=v.find(".colBox").length-1,i=Math.floor(e/t)+1,n=e%t+1;return{rowNo:i,colNo:n}}(i);1==n.rowNo&&Q.hide(),1==n.colNo&&J.hide(),H.css({left:t(e.target).closest(".vis-viewBlock")[0].offsetLeft-38,top:t(e.target).height()+t(e.target)[0].offsetTop}),Q.css({left:t(e.target).closest(".vis-viewBlock")[0].offsetLeft-20,top:t(e.target).height()+t(e.target)[0].offsetTop}),z.css({top:t(e.target).closest(".vis-viewBlock")[0].offsetTop-20,left:t(e.target).width()-8+t(e.target)[0].offsetLeft}),J.css({top:t(e.target).closest(".vis-viewBlock")[0].offsetTop-20,left:t(e.target).width()-5+t(e.target)[0].offsetLeft+15})}(e)):(V.addClass("vis-disable-event"),N.addClass("vis-disable-event"),M.addClass("vis-disable-event")),g.find('[command="Merge"]').parent().hide(),g.find('[command="ShowImg"]').parent().hide(),g.find('[command="ShowValue"]').parent().hide(),r.find(".imgTextCont").addClass("vis-disable-event"),d.find(".vis-active-block").removeClass("vis-active-block"),1==s)d.find(".vis-viewBlock").addClass("vis-active-block");else{var i=t(e.target).closest(".vis-wizard-section").attr("sectionCount");v.find("[sectionCount='"+i+"']").hasClass("section-active")||v.find("[sectionCount='"+i+"'] .vis-grey-disp-el").click(),t(e.target).addClass("vis-active-block");var n=e.target.offsetTop-g.outerHeight(),a=e.target.offsetLeft;if(g.css({top:n,left:a}),g.show(),g.find('[command="fieldName"]').text("").hide(),t(e.target).hasClass("imgField")?(F.show(),"I"==e.target.tagName?F.css({left:t(e.target).closest(".grdDiv")[0].offsetLeft+22,top:t(e.target).closest(".grdDiv")[0].offsetTop+6}):F.css({left:e.target.offsetLeft+(e.target.width||0)-12,top:e.target.offsetTop})):F.hide(),t(e.target).closest(".fieldGroup").length>0?g.find('[command="Unlink"]').parent().show():g.find('[command="Unlink"]').parent().hide(),t(e.target).hasClass("fieldLbl")){g.find('[command="fieldName"]').text(t(e.target).closest(".fieldGroup").find(".fieldLbl").attr("title")).show();var l="true"==t(e.target).attr("showFieldText");e.target.hasAttribute("showFieldText")&&l?(g.find('[command="Hide"]').parent().hide(),g.find('[command="Show"]').parent().show()):(g.find('[command="Show"]').parent().hide(),g.find('[command="Hide"]').parent().show())}else if("I"==e.target.tagName&&0==t(e.target).closest(".fieldGroup").find(".imgField").length)l="true"==t(e.target).next().attr("showFieldIcon"),t(e.target).next().attr("showFieldIcon")&&l?(g.find('[command="Hide"]').parent().hide(),g.find('[command="Show"]').parent().show()):(g.find('[command="Show"]').parent().hide(),g.find('[command="Hide"]').parent().show());else{if(g.find('[command="Show"]').parent().hide(),g.find('[command="Hide"]').parent().hide(),t(e.target).closest(".fieldGroup").length>0){var c=t(e.target).closest(".fieldGroup").find(".fieldLbl"),p=t(e.target).closest(".fieldGroup");p.find(".imgField:hidden").length>0?(g.find('[command="ShowImg"]').parent().show(),g.find('[command="Hide"]').parent().hide()):p.find(".fieldValue:hidden").length>0?(g.find('[command="Hide"]').parent().hide(),g.find('[command="ShowValue"]').parent().show()):1==p.find(".imgField").length&&1==p.find(".fieldValue").length?(g.find('[command="Hide"]').parent().show(),r.find(".imgTextCont").removeClass("vis-disable-event")):r.find(".imgTextCont").addClass("vis-disable-event"),l="true"==c.attr("showFieldText"),g.find('[command="fieldName"]').text(c.attr("title")).show()}l&&g.find('[command="Show"]').parent().show()}0==t(e.target).find(".vis-split-cell").length?(g.find('[command="Separate"]').parent().hide(),t(e.target).hasClass("grdDiv")&&(D=!0),f.find(".grdDiv").each((function(e){var i=v.find(".colBox").length-1,n=Math.ceil((e+1)/i);t(this).hasClass("vis-active-block")&&(y=e-i*(m=n-1))}))):g.find('[command="Separate"]').parent().show()}t(e.target).hasClass("vis-wizard-section")&&g.find('[command="fieldName"]').text("Section "+t(e.target).attr("sectioncount")).show(),t(e.target).hasClass("vis-viewBlock")&&g.find('[command="fieldName"]').text("Main container").show()}}),30)})).mouseup((function(i){setTimeout((function(){D=!1,function(i){r.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").removeClass("vis-disable-event"),r.find("#master001_"+n+" input").val(""),r.find("#master001_"+n+" select").val(""),r.find(".gradient1").val("#000"),r.find(".gradient2").val("#000"),r.find(".percent1").val("0"),r.find(".percent2").val("100"),r.find(".grdDirection").val("to bottom"),r.find("[data-command1]").parent().removeClass("vis-hr-elm-inn-active");var a=i.attr("style");i.find("sql").length>0?x.val(e.secureEngine.decrypt(i.attr("query"))):x.val(""),S.val(a),a&&a.split(";").forEach((function(e){var n=e.split(":");for(const e in le)if("border-left"!=t.trim(n[0])&&"border-right"!=t.trim(n[0])&&"border-top"!=t.trim(n[0])&&"border-bottom"!=t.trim(n[0])||(n[0]=n[0]+"-width"),t.trim(n[0])==t.trim(le[e].proprty)){var a=t.trim(n[1]);if(""==le[e].value){if("width"!=e&&"height"!=e||(a=a.replaceAll("!important","")),"fontFamily"==e&&(a=a.replaceAll('"',"")),"padding"==e&&t.trim(a).split(" ").length>1?(b.prop("checked",!1),r.find(".allPadding").addClass("displayNone"),r.find(".singlePadding").removeClass("displayNone"),r.find("[data-command='paddingLeft']").val(i.css("padding-left")),r.find("[data-command='paddingTop']").val(i.css("padding-top")),r.find("[data-command='paddingRight']").val(i.css("padding-right")),r.find("[data-command='paddingBottom']").val(i.css("padding-bottom"))):"padding"==e?(b.prop("checked",!0),r.find(".allPadding").removeClass("displayNone"),r.find(".singlePadding").addClass("displayNone"),r.find("[data-command='"+e+"']").val(a)):"margin"==e&&t.trim(a).split(" ").length>1?(C.prop("checked",!1),r.find(".allMargin").addClass("displayNone"),r.find(".singleMargin").removeClass("displayNone"),r.find("[data-command='marginLeft']").val(i.css("margin-left")),r.find("[data-command='marginTop']").val(i.css("margin-top")),r.find("[data-command='marginRight']").val(i.css("margin-right")),r.find("[data-command='marginBottom']").val(i.css("margin-bottom"))):"margin"==e?(C.prop("checked",!0),r.find(".allMargin").removeClass("displayNone"),r.find(".singleMargin").addClass("displayNone"),r.find("[data-command='"+e+"']").val(a)):"borderRadius"==e&&t.trim(a).split(" ").length>1?(w.prop("checked",!1),r.find(".allBorderRadius").addClass("displayNone"),r.find(".singleBorderRadius").removeClass("displayNone"),r.find("[data-command='borderTopLeftRadius']").val(i.css("border-top-left-radius")),r.find("[data-command='borderTopRightRadius']").val(i.css("border-top-right-radius")),r.find("[data-command='borderBottomRightRadius']").val(i.css("border-bottom-right-radius")),r.find("[data-command='borderBottomLeftRadius']").val(i.css("border-bottom-left-radius"))):"borderRadius"==e?(w.prop("checked",!0),r.find(".allBorderRadius").removeClass("displayNone"),r.find(".singleBorderRadius").addClass("displayNone"),r.find("[data-command='"+e+"']").val(a)):r.find("[data-command='"+e+"']").val(a),"backgroundColor"==e)r.find(".vis-zero-BTopLeftBLeft:first").css("background-color",a),r.find("[data-command='"+e+"'][type='color']").val(we(a));else if("color"==e)r.find(".vis-zero-BTopLeftBLeft:last").css("background-color",a),r.find("[data-command='"+e+"'][type='color']").val(we(a));else if(-1!=e.indexOf("border")&&-1==e.indexOf("radius")){var s=i[0].style;if(""==s.border)""!=s.borderLeftWidth&&(r.find("[data-command='borderLeft']").val(s.borderLeftWidth),r.find("[data-command='borderLeftStyle']").val(s.borderLeftStyle),r.find("[data-command='borderLeftColor']").val(we(s.borderLeftColor)),r.find("[data-command='borderLeftColor']").parent().css("background-color",s.borderLeftColor)),""!=s.borderRightWidth&&(r.find("[data-command='borderRight']").val(s.borderRightWidth),r.find("[data-command='borderRightStyle']").val(s.borderRightStyle),r.find("[data-command='borderRightColor']").val(we(s.borderRightColor)),r.find("[data-command='borderRightColor']").parent().css("background-color",s.borderRightColor)),""!=s.borderTopWidth&&(r.find("[data-command='borderTop']").val(s.borderTopWidth),r.find("[data-command='borderTopStyle']").val(s.borderTopStyle),r.find("[data-command='borderTopColor']").val(we(s.borderTopColor)),r.find("[data-command='borderTopColor']").parent().css("background-color",s.borderTopColor)),""!=s.borderBottomWidth&&(r.find("[data-command='borderBottom']").val(s.borderBottomWidth),r.find("[data-command='borderBottomStyle']").val(s.borderBottomStyle),r.find("[data-command='borderBottomColor']").val(we(s.borderBottomColor)),r.find("[data-command='borderBottomColor']").parent().css("background-color",s.borderBottomColor));else{var l=a.split("rgb");l.length>1&&(a=a.replace("rgb"+l[1],we("rgb"+l[1]))),r.find("[data-command='"+e+"']").val(a)}""!=s.border||""==s.borderTopWidth&&""==s.borderRightWidth&&""==s.borderTopWidth&&""==s.borderBottomWidth?(_.prop("checked",!0),r.find(".allBorder").removeClass("displayNone"),r.find(".singleBorder").addClass("displayNone")):(_.prop("checked",!1),r.find(".allBorder").addClass("displayNone"),r.find(".singleBorder").removeClass("displayNone"))}break}if(le[e].value==a){r.find("[data-command1='"+e+"']").parent().addClass("vis-hr-elm-inn-active");break}}})),("column"==r.find("[data-command='flexDirection'] option:selected").val()||"column-reverse"==r.find("[data-command='flexDirection'] option:selected").val())&&r.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").addClass("vis-disable-event")}(t(i.target))}),30)})),r.find("[data-command]").on("change",(function(e){t(this).removeClass("vis-editor-validate");var i=t(this).data("command"),n=t(this).val(),a=!1;-1!=i.indexOf("margin")&&-1!=n.indexOf("-")&&(a=!0);var s=n.replace(/\d+/g,"").replace(".",""),l=n.replace(n.replace(/\d+/g,""),"");if(le[i]&&le[i].measurment&&""!=n&&"color"!=t(this).attr("type"))if(se.indexOf(s)<0){if(isNaN(Number(l)))return void t(this).addClass("vis-editor-validate");a?t(this).val("-"+l+"px"):t(this).val(l+"px")}else if(isNaN(Number(l)))return void t(this).addClass("vis-editor-validate");"backgroundColor"==i?(r.find(".vis-zero-BTopLeftBLeft:first").css("background-color",n),r.find('[data-command="backgroundColor"]').val(n)):"color"==i?(r.find(".vis-zero-BTopLeftBLeft:last").css("background-color",n),r.find('[data-command="color"]').val(n)):"borderColor"!=i&&"borderLeftColor"!=i&&"borderRightColor"!=i&&"borderTopColor"!=i&&"borderBottomColor"!=i||r.find("[data-command='"+i+"']").closest(".vis-prop-pan-cont").find(".vis-back-color03").css("background-color",n),De(i,t(this).val())})),r.find("[data-command1]").on("click",(function(e){var i=t(this).data("command1"),n=d.find(".vis-active-block"),a=!1;a=le[i].measurment?Ie(le[i].proprty,le[i].value,n):Ie(le[i].proprty,!1,n);var s=t(this).closest(".vis-horz-align-d").find(".vis-hr-elm-inn-active");s.removeClass("vis-hr-elm-inn-active"),"justify-content"!=le[i].proprty&&"align-items"!=le[i].proprty||!Ie("display","flex",n)?"text-align"==le[i].proprty||"text-transform"==le[i].proprty?(De(i,""),s.find("[data-command1]").attr("data-command1")!=i&&(t(this).parent().addClass("vis-hr-elm-inn-active"),De(i,le[i].value))):a?(t(this).parent().removeClass("vis-hr-elm-inn-active"),De(i,"")):(t(this).parent().addClass("vis-hr-elm-inn-active"),De(i,le[i].value)):(n[0].style.removeProperty("display"),De(i,""),s.find("[data-command1]").attr("data-command1")!=i&&(t(this).parent().addClass("vis-hr-elm-inn-active"),De(i,le[i].value))),-1==n.attr("style").indexOf("justify-content")&&-1==n.attr("style").indexOf("align-items")&&-1==n.attr("style").indexOf("flex-direction")||n.css("display","flex")})),r.find("[data-command2]").on("click",(function(e){g.hide();var i=f.find(".vis-active-block").closest(".fieldGroup"),n=t(this).data("command2");i.find(".fieldValue").attr("style"),i.find(".fieldValue").attr("class"),i.find(".fieldValue br").remove(),"SwapImgTxt"==n?i.find(".imgField").before(i.find(".fieldValue")):"SwapTxtImg"==n?i.find(".fieldValue").before(i.find(".imgField")):"SwapTxtImgBr"==n?(i.find(".fieldValue").before(i.find(".imgField")),i.find(".fieldValue").prepend("<br>")):"SwapImgTxtBr"==n&&(i.find(".imgField").before(i.find(".fieldValue")),i.find(".fieldValue").append("<br>")),Ae()})),S.change((function(){d.find(".vis-active-block").attr("style",t(this).val()),Ae()})),x.change((function(){var i=d.find(".vis-active-block");if(null==t(this).val()||""==t(this).val())i.find("sql").remove(),i.attr("query","");else{var n=e.secureEngine.encrypt(t(this).val());i.attr("query",n),0==i.find("sql").length&&i.append("<sql>SQL</sql>")}Ae()})),v.find(".addGridRow").click((function(){var e=v.find(".rowBox:first").clone(!0);e.show(),v.find(".DivRowBox").append(e),ve(),Ae()})),v.find(".addGridCol").click((function(){var e=v.find(".colBox:first").clone(!0);e.show(),v.find(".DivColBox").append(e),ve(),Ae()})),v.find(".addGridSection").click((function(){B=!0,v.find(".section-active").removeClass("section-active");var e=v.find(".grid-Section:first").clone(!0);e.removeClass("displayNone"),e.addClass("section-active"),U=v.find(".grid-Section").length,e.attr("sectionCount",U),e.find(".vis-grey-disp-ttl").text("Section "+U),v.find(".vis-sectionAdd").append(e),f=t('<div name="Section '+U+'" sectionCount="'+U+'"  class="section'+U+' vis-wizard-section" style="padding:5px"></div>'),d.find(".vis-viewBlock").append(f),v.find(".rowBox:not(:first)").remove(),v.find(".colBox:not(:first)").remove(),v.find(".addGridRow").click(),v.find(".addGridCol").click(),v.find(".vis-sectionAdd").sortable({disabled:!1,update:function(e,t){var i=t.item.attr("sectioncount"),n=(t.item.index(),t.item.next().attr("sectioncount"));if(n)d.find('[sectioncount="'+n+'"]').before(d.find('[sectioncount="'+i+'"]'));else{var a=t.item.prev().attr("sectioncount");d.find('[sectioncount="'+a+'"]').after(d.find('[sectioncount="'+i+'"]'))}Ae()}}),Ae()})),v.find(".grid-Section .vis-grey-disp-el-xross").click((function(){var e=t(this).closest(".grid-Section").attr("sectionCount");t(this).closest(".grid-Section").hasClass("section-active")&&(v.find(".grid-Section").eq(1).addClass("section-active"),v.find(".grid-Section").eq(1).find(".vis-grey-disp-el").click()),t(this).closest(".grid-Section").remove();var i=d.find(".vis-viewBlock .section"+e);i.find(".fieldLbl").each((function(){t(this).attr("title")&&t(this).attr("title").length>0&&be(t(this).attr("title"),t(this))})),i.remove(),delete ee["section"+e],e=v.find(".section-active").attr("sectionCount"),f=d.find(".vis-viewBlock .section"+e),Ae()})),v.find(".grid-Section .vis-grey-disp-el").click((function(){v.find(".section-active").removeClass("section-active"),t(this).parent().addClass("section-active");var e=v.find(".section-active").attr("sectionCount");f=d.find(".vis-viewBlock .section"+e),d.find(".vis-active-block").removeClass("vis-active-block"),f.addClass("vis-active-block"),function(){v.find(".rowBox:not(:first)").remove();var e=v.find(".section-active").attr("sectionCount"),t=ee["section"+e],i=v.find(".rowBox:first").clone(!0);i.show(),v.find(".colBox:not(:first)").remove();var n=v.find(".colBox:first").clone(!0);if(n.show(),t){for(let e in t){var a=t[e];-1!=e.indexOf("row_")?(i.find("input").val(a.val),i.find("select").val(a.msr),v.find(".DivRowBox").append(i),i=v.find(".rowBox:last").clone(!0)):-1!=e.indexOf("col_")&&(n.find("input").val(a.val),n.find("select").val(a.msr),v.find(".DivColBox").append(n),n=v.find(".colBox:last").clone(!0))}A.val(t.rowGap),T.val(t.colGap),v.find(".rowBox .grdRowDel").eq(1).hide(),v.find(".colBox .grdColDel").eq(1).hide()}}(),ie?ie=!1:Ae()})),H.click((function(){var e=d.find(".vis-active-block").css("grid-area").split("/");v.find(".grdRowAdd").eq(Number(e[2])-1).click()})),Q.click((function(){var e=d.find(".vis-active-block").css("grid-area").split("/");v.find(".grdRowDel").eq(Number(e[2])-1).click()})),z.click((function(){var e=d.find(".vis-active-block").css("grid-area").split("/");v.find(".grdColAdd").eq(Number(e[3])-1).click()})),J.click((function(){var e=d.find(".vis-active-block").css("grid-area").split("/");v.find(".grdColDel").eq(Number(e[3])-1).click()})),v.find(".grdRowDel").click((function(){var e=t(this).closest(".rowBox").index();L=e,v.find(".rowBox").length;for(var i=v.find(".colBox").length-1,n=e*i+1-i,a=n;a<n+i;a++){f.find(".grdDiv").eq(a-1).addClass("del");var s=f.find(".grdDiv").eq(a-1).find(".fieldLbl");s&&s.attr("title")&&s.attr("title").length>0&&be(s.attr("title"),s)}f.find(".del").remove(),t(this).closest(".rowBox").remove(),he(-1,0),Ae()})),v.find(".grdRowAdd").click((function(){var e=t(this).closest(".rowBox").index()-1,i=v.find(".rowBox:first").clone(!0);i.show(),v.find(".DivRowBox").append(i),v.find(".rowBox").length;var n=v.find(".colBox").length-1,a=(e+1)*n;L=e+1;for(var s=0;s<n;s++)f.find(".grdDiv").eq(a-1).after("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>");ge(),he(1,0),Ae()})),v.find(".grdColDel").click((function(){var e=t(this).closest(".colBox").index()-1,i=v.find(".rowBox").length-1,n=v.find(".colBox").length-1;R=e+1;for(var a=0;a<i;a++)for(var s=0;s<n;s++)if(s==e){var l=n*a+s;f.find(".grdDiv").eq(l).addClass("del");var o=f.find(".grdDiv").eq(l).find(".fieldLbl");o&&o.attr("title")&&o.attr("title").length>0&&be(o.attr("title"),o)}f.find(".del").remove(),t(this).closest(".colBox").remove(),he(0,-1),Ae()})),v.find(".grdColAdd").click((function(){var e=v.find(".colBox:first").clone(!0);e.show(),v.find(".DivColBox").append(e),P=[];var i=t(this).closest(".colBox").index()-1,n=v.find(".rowBox").length-1,a=v.find(".colBox").length-1;R=i+1;for(var s=0;s<n;s++)for(var l=0;l<a;l++)if(l==i){var o=a*s+l;P.push(o+1),f.find(".grdDiv").eq(o).after("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>")}ge(),he(0,1),Ae()})),v.find(".mergeCell").click((function(){me(),Ae()})),T.change((function(){he(),Ae()})),A.change((function(){he(),Ae()})),v.find(".rowBox input,select").change((function(){he(),Ae()})),v.find(".colBox input,select").change((function(){he(),Ae()})),k.click((function(){l.find('.mainTemplate[templateid="'+p+'"]').parent().click(),s>1&&(pe(),ue()),k.hide()})),W.click((function(){l.find('.mainTemplate[templateid="0"]').parent().click(),c.click()})),d.find(".vis-viewBlock")[0].addEventListener("dragstart",(function(e){(q=t(e.target)).hasClass("grdDiv")||!e.ctrlKey?e.preventDefault():(g.hide(),D=!1)}),!1),d.find(".vis-viewBlock")[0].addEventListener("dragover",(function(e){e.preventDefault()})),d.find(".vis-viewBlock")[0].addEventListener("drop",(function(e){e.preventDefault(),d.find(".vis-active-block").removeClass("vis-active-block");var i=t(e.target);i.hasClass("grdDiv")&&(i.append(q),Ae())})),j.click((function(e){ae>0?(ie=!0,!1,canv_data=JSON.parse(ne[ae-1]),d.find(".vis-viewBlock").html(canv_data),ae--,G.removeAttr("disabled"),ae<=0&&j.attr("disabled","disabled"),ue(),d.find(".grdDiv").unbind("mouseover"),d.find(".grdDiv").mouseover((function(e){D&&0==t(this).find(".vis-split-cell").length&&fe(t(this))}))):j.attr("disabled","disabled")})),G.click((function(e){ne[ae+1]?(ie=!0,!1,canv_data=JSON.parse(ne[ae+1]),d.find(".vis-viewBlock").html(canv_data),ae++,j.removeAttr("disabled"),ue(),ae>=ne.length-1&&G.attr("disabled","disabled"),d.find(".grdDiv").unbind("mouseover"),d.find(".grdDiv").mouseover((function(e){D&&0==t(this).find(".vis-split-cell").length&&fe(t(this))}))):G.attr("disabled","disabled")})),Y.change((function(){""!=t(this).val()?(l.find('[issystemtemplate="Y"]').not(".blankTemp").addClass("displayNone"),l.find('[issystemtemplate="Y"][category="'+t(this).val()+'"]').removeClass("displayNone")):l.find('[issystemtemplate="Y"]').removeClass("displayNone"),1==l.find(".vis-cardSingleViewTemplate:not(:hidden)").length?l.find(".vis-noTemplateIcon").show():l.find(".vis-noTemplateIcon").hide()})),d.find(".vis-viewBlock").on("DOMSubtreeModified",(function(){var e=d.height(),t=d.find(".canvas").height();e&&t&&t>e?d.find(".canvas").addClass("canvasOverFlow"):d.find(".canvas").removeClass("canvasOverFlow")}))}))}i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.frame.getContentGrid().append(this.getRoot())},i.prototype.dispose=function(){this.disposeComponent()},e.CardTemplateMaster=i}(VIS,jQuery)},6949:()=>{!function(e,t){function n(n,s){var l,o,r=this,d=n.curGC,c=d.getMTab(),p=c.getWindowNo(),u=d.vCardView,g=c.getAD_Window_ID(),h=c.getAD_Tab_ID(),v=u.getAD_CardView_ID(),f=u.getField_Group_ID(),m=c.getFields(),y=c.getFields().slice(),I=null,D=null,w=[],b=[],C=[],_=[],S=null,x=[],A=null,T=null,V=null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=null,U=1,F=null,B=null,W=[],G=null,q=null,H=null,z=null,Q=null,J=null,$=null,K=null,Y="ASC",X=null,Z=null,ee=null,te=null,ie=null,ne=null,ae=null,se=null,le=null,oe=null,re=null,de=null,ce=!1,pe=!1,ue=!0,ge=null,he=null,ve=!0,fe=null,me=!1,ye=null,Ie=null,De=null,we=null,be=null,Ce=null,_e=null,Se=null,xe=null,Ae=null,Te=null,Ve=null,Ne=null,Me=null,ke=2,Oe=0,Le=0,Re=null,Ee=null,Pe=null,Ue=null,Fe=null,Be=null,We=null,je=null,Ge=!1,qe="Y",He=!1,ze=null,Qe=null,Je=null,$e=[],Ke=!1,Ye=!1,Xe=null,Ze=null,et=null,tt=null,it=null,nt=null,at={},st=null,lt=null,ot=null,rt=null,dt=!1,ct=[],pt=0,ut=0,gt=null,ht=!1,vt=null;function ft(){l=t('<div style="height:100%"><div class="vis-apanel-busy vis-cardviewmainbusy" style="display:block"></div></div>'),he=t("<div class='vis-apanel-busy vis-cardviewmainbusy'></div> ");var i=e.Application.contextUrl+"CardView/GetTemplateDesign",n={ad_Window_ID:c.getAD_Window_ID(),ad_Tab_ID:c.getAD_Tab_ID()};t.ajax({type:"POST",url:i,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(i){var n,a=JSON.parse(i);n=a,l.load(e.Application.contextUrl+"CardViewWizard/Index/?windowno="+p,(function(i){l.append(he),mt(!0),(O=l.find("#DivCardStep1_"+p)).hide(),N=l.find("#btnCardCustomization_"+p),k=l.find("#btnSaveCloseStep1_"+p),ot=l.find("#btnApplyStep1_"+p),R=l.find("#BtnLayoutSetting_"+p),M=l.find("#BtnChangeTemplate_"+p),We=l.find("#BtnTemplateBack_"+p),btnBack=l.find("#BtnBack_"+p),E=l.find("#BtnFinesh_"+p),P=l.find("#btnOnlySave_"+p),G=l.find("#DivCardList_"+p),q=l.find("#txtCardName_"+p),Q=l.find("#cmbGroupField_"+p),J=l.find("#GroupSequenceFeilds_"+p),S=l.find("#conditionTable_"+p),H=l.find("#cmbColumn_"+p),z=l.find("#ddlOperator_"+p),D=l.find("#valcontainer_"+p),$=l.find("#cmbOrderClause_"+p),K=l.find("#sortList_"+p),T=l.find("#chkDefault_"+p),V=l.find("#chkPublic_"+p),btnNewCard=l.find("#btnNewCard_"+p),X=l.find("#btnCopy_"+p),Z=l.find("#btnDelete_"+p),ee=l.find("#btnCancle_"+p),te=l.find("#chkGradient_"+p),ie=l.find("#txtBgColor_"+p),ne=l.find("#DivGrdntBlock_"+p),ae=l.find("#txtGrdntColor1_"+p),se=l.find("#txtGrdntColor2_"+p),le=l.find("#txtGrdntPrcnt_"+p),oe=l.find("#txtGrdntPrcnt2_"+p),re=l.find("#cmbGrdntDirection_"+p),de=l.find("#btnAddCondition_"+p),btnCardAsc=l.find("#btnCardAsc_"+p),btnCardDesc=l.find("#btnCardDesc_"+p),ge=l.find("#btnAddOrder_"+p),je=l.find("#spnLastSaved_"+p),it=l.find("#txtFilterField_"+p),nt=l.find("#btnClearFilter_"+p),L=l.find("#DivCardStep2_"+p),ye=l.find("#DivViewBlock_"+p),Ie=l.find("#DivStyleSec1_"+p),De=l.find("#chkAllBorderRadius_"+p),we=l.find("#chkAllPadding_"+p),be=l.find("#chkAllMargin_"+p),Ce=l.find("#chkAllBorder_"+p),Se=l.find("#DivGridSec_"+p),_e=l.find("#DivTemplate_"+p),Ne=l.find("#DivCardField_"+p),DivCardFieldSec=l.find("#DivCardFieldSec_"+p),Ee=l.find("#txtCustomStyle_"+p),Pe=l.find("#txtSQLQuery_"+p),Ue=l.find("#txtZoomInOut_"+p),Be=l.find("#Btn_BlockCancel_"+p),st=l.find("#btnUndo_"+p),lt=l.find("#btnRedo_"+p),Fe=L.find(".vis-topNavigator"),Te=Se.find(".rowGap"),Ve=Se.find(".colGap"),Xe=l.find("#btnVaddrow_"+p),Ze=l.find("#btnVaddCol_"+p),et=l.find("#btnVdelrow_"+p),tt=l.find("#btnVdelCol_"+p),rt=l.find("#CmbTemplateCategory_"+p),vt=l.find("#BtnRefreshTemplate_"+p),Me=ye.find(".section1"),ce=!0,pe=!1,Ct();for(var a=0;a<n.length;a++)_e.find(".vis-cardTemplateContainer").append(t(n[a].template));setTimeout((function(){di(),1==_e.find(".vis-cardSingleViewTemplate:not(:hidden)").length?_e.find(".vis-noTemplateIcon").show():_e.find(".vis-noTemplateIcon").hide(),_e.find(".vis-cardSingleViewTemplate").click((function(){_e.find(".vis-cardSingleViewTemplate").removeClass("vis-active-template"),t(this).addClass("vis-active-template")})),O.show(),_t(),rt.find("option").remove(),rt.append('<option value="">All</option>'),t.ajax({type:"POST",url:e.Application.contextUrl+"CardView/GetTemplateCategory",dataType:"json",contentType:"application/json; charset=utf-8",data:{},success:function(e){var t=JSON.parse(e);if(t)for(var i=0;i<t.length;i++)rt.append('<option value="'+t[i].TemplateCategoryID+'">'+t[i].Name+"</option>");mt(!1)},error:function(e){alert(e.statusText),mt(!1)}}),xt(!0,!1),Tt(),Nt(),yt(),Kt(),bt(),C.sort((function(t,i){var n=t.getHeader().toUpperCase();null!=n&&0!=n.length||(n=e.Msg.getElement(e.context,t.getColumnName()));var a=i.getHeader().toUpperCase();return null!=a&&0!=a.length||(a=e.Msg.getElement(e.context,i.getColumnName())),n>a?1:n<a?-1:0})),Lt(!1),$.find("option").remove(),$.append('<option value="-1"></option>)');for(var i=0;i<C.length;i++){var n=C[i].getHeader();(null!=n&&0!=n.length||null!=(n=e.Msg.getElement(e.context,C[i].getColumnName()))&&0!=n.Length)&&$.append('<option value="'+C[i].getColumnName()+'">'+n+"</option>")}W&&0==W.length?(ve=!0,btnNewCard.click(),Z.addClass("vis-disable-event"),ee.addClass("vis-disable-event"),X.addClass("vis-disable-event")):2==e.context.getContext("CardDialogLaststepSelected_"+p)&&N.click(),mt(!1)}),1e3)}))},error:function(e){alert(e.statusText)},complete:function(){}})}function mt(e){e&&null!=he&&he.css({display:"block"}),e||null==he||he.css({display:"none"})}function yt(){N.click((function(e){ue=!1,Fe.hide(),U=1,_e.show(),DivCardFieldSec.hide(),O.hide(),L.show(),_e.find('.mainTemplate[templateid="'+Oe+'"]').parent().click(),Ie.hide(),L.find(".vis-two-sec-two").hide(),di(),pe||R.click()})),k.click((function(t){ue=!0,b=[],e.context.setContext("CardDialogLaststepSelected_"+p,1),Rt(t)})),We.click((function(e){"undefined"==v?btnBack.click():(U++,_e.hide(),DivCardFieldSec.show(),L.find(".vis-two-sec-two").show(),Ie.show())})),btnNewCard.click((function(){ce=!1,pe=!0,Ut(),Lt(!0),fe=G.find(".crd-active").attr("idx"),G.find(".crd-active").removeClass("crd-active"),k.removeClass("vis-disable-event"),E.removeClass("vis-disable-event"),P.removeClass("vis-disable-event"),M.removeClass("vis-disable-event"),Oe=0,Le=0,v="undefined",rt.val(""),_e.find('[issystemtemplate="Y"]').removeClass("displayNone"),We.text(e.Msg.getMsg("Back")),R.text(e.Msg.getMsg("NextLayout")),ht||ai(),N.click()})),ot.click((function(e){ue=!1,mt(!0),Rt(e)})),X.click((function(){(gt=new a).show(),gt.btnCopySave.click((function(){var t=gt.getName();t&&t.length>0&&(mt(!0),function(t){if(null==t||""==t)return e.ADialog.info("FileNameMendatory"),!1;for(var i=0;i<W.length;i++)if(W[i].CardViewName.trim()==t.trim())return e.ADialog.error("cardAlreadyExist",!0,""),mt(!1),!1;q.val(t),He=!0,N.click(),gt.close()}(t))})),gt.btnCopyCancle.click((function(){gt.close()}))})),ee.click((function(){pe=!1,ce=!0,Lt(!1),G.find('[idx="'+fe+'"]').click()})),R.click((function(){it.val(""),Ne.find(".fieldLbl:not(:first)").show(),Qt(),U++,St(),_e.hide(),DivCardFieldSec.show(),L.find(".vis-two-sec-two").show(),Ie.show(),0==Oe&&1==Se.find(".rowBox").length&&(Se.find(".addGridCol").click(),Se.find(".addGridRow").click()),0!=Oe||He||ye.find(".vis-viewBlock").css("backgroundColor","#fff"),He&&setTimeout((function(){E.click()}),2e3);var e=DivCardFieldSec.find(".vis-templatePreview"),t=_e.find(".vis-active-template .mainTemplate").clone(!0);e.html(t);var i=e.height(),n=e.width(),a=1,s=i/t.height(),l=n/t.width();a=s>l?l:s,e.find(".mainTemplate").css("zoom",a),dt=!1,ct=[],!0,pt=0,ui(),st.attr("disabled","disabled")})),M.click((function(){We.text(e.Msg.getMsg("Cancle")),R.text(e.Msg.getMsg("Ok")),Fe.hide(),U--,_e.show(),DivCardFieldSec.hide(),Ie.hide(),L.find(".vis-two-sec-two").hide(),ht?di():ai(),Ye=!0,rt.val(""),_e.find('[issystemtemplate="Y"]').removeClass("displayNone")})),E.click((function(t){Ge=!1,ue=!0,b=[],e.context.setContext("CardDialogLaststepSelected_"+p,2),si(t)})),P.click((function(t){Ge=!0,si(t);var i,n=new Date,a=n.getHours(),s=n.getMinutes(),l=n.getSeconds(),o=a>=12?"PM":"AM";(a=(a%=12)||12)<10&&(a="0"+a),s<10&&(s="0"+s),l<10&&(l="0"+l),i=a+":"+s+":"+l+" "+o,je.text(e.Msg.getMsg("LastSaved")+" "+i),_e.find('.mainTemplate[templateid="'+Oe+'"]').parent().attr("lastupdated",i)})),btnBack.click((function(){Ut(),O.show(),L.hide(),ee.click()})),Z.click((function(){e.ADialog.confirm("SureWantToDelete",!0,"",e.Msg.getMsg("Confirm"),(function(e){e&&kt()}))})),btnCardAsc.on("click",(function(){-1!=$.val()&&null!=$.val()&&(btnCardAsc.css("color","rgba(var(--v-c-primary), 1)"),btnCardDesc.css("color","rgba(var(--v-c-on-secondary), 1)"),Y="ASC")})),btnCardDesc.on("click",(function(){-1!=$.val()&&null!=$.val()&&(btnCardAsc.css("color","rgba(var(--v-c-on-secondary), 1)"),btnCardDesc.css("color","rgba(var(--v-c-primary), 1)"),Y="DESC")})),wt(),J.find(".grpChk").click((function(){t(this).hasClass("fa-check-square-o")?t(this).removeClass("fa-check-square-o").addClass("fa-square-o"):t(this).removeClass("fa-square-o").addClass("fa-check-square-o")})),te.click((function(){t(this).is(":checked")?(ne.show(),ie.hide()):(ne.hide(),ie.show())})),ae.on("input",(function(){bt()})),se.on("input",(function(){bt()})),le.on("input",(function(){bt()})),oe.on("input",(function(){bt()})),re.on("change",(function(){bt()})),t("body").mouseup((function(e){me=!1})),de.click((function(){if(-1!=H.find(":selected").val())if(!I.isMandatory||null!=Bt(!0)&&""!=Bt(!0)){var i={};A={};var n="";n=te.is(":checked")?ne.find(".grd-preview").css("background"):Modernizr.inputtypes.color?ie.val():ctrColor.spectrum("get");var a=t.map(x,(function(e,t){if(e.Color==n)return t}));a.length<=0?(A.Color=n.toString(),A.Condition=[],i.ColHeader=H.find(":selected").text(),i.ColName=H.find(":selected").val(),i.Operator=z.val(),i.OperatorText=z.find(":selected").text(),i.QueryValue=Bt(!0),i.QueryText=Wt(!0),A.Condition.push(i),x.push(A)):(i.ColHeader=H.find(":selected").text(),i.ColName=H.find(":selected").val(),i.Operator=z.val(),i.OperatorText=z.find(":selected").text(),i.QueryValue=Bt(!0),i.QueryText=Wt(!0),x[a[0]].Condition.push(i)),Mt(x),H.val("-1"),z[0].SelectedIndex=-1,function(t){var i=null;t&&(i=I);if(null!=i){if(i.getDisplayType()==e.DisplayType.YesNo)return"true"==i.getValue().toString().toLowerCase()?"Y":"N";i.setValue(null)}}(!0),function(e){var t=null;e&&(t=I);if(null!=t)return t.getDisplayType("")}(!0),ae.val("#000"),se.val("#000"),le.val(0),oe.val(0),re.val("to bottom"),ne.find(".grd-preview").css("background","#000")}else e.ADialog.error("FillMandatory",!0,I.colName)})),ge.on("click",(function(t){var i=$.val();if(-1!=i)if(btnCardAsc.css("color","rgba(var(--v-c-on-secondary), 1)"),btnCardDesc.css("color","rgba(var(--v-c-on-secondary), 1)"),sortOrderArray&&sortOrderArray.length<3){var n=$.find(":selected").text();if(sortOrderArray.indexOf(i+" ASC")>-1||sortOrderArray.indexOf(i+" DESC")>-1)return void e.ADialog.warn("CardSortColAdded");zt(n,i,Y),sortOrderArray.push(i+" "+Y),$.val(-1)}else e.ADialog.warn("MaxSortColumn")})),K.on("click",(function(e){if(ce||pe){var i=t(e.target);if(i.hasClass("fa-close")&&(i=i.parent()),i.hasClass("vis-sortListItemClose")){const e=sortOrderArray.indexOf(i.data("text"));sortOrderArray.splice(e,1),i.closest(".vis-sortListItem").remove()}}})),null!=H&&H.on("change",(function(i){i.stopPropagation();var n=H.val();if(jt(!0),n&&"-1"!=n){var a=null;a=n.endsWith("_ID")||n.endsWith("_Acct")||n.endsWith("_ID_1")||n.endsWith("_ID_2")||n.endsWith("_ID_3")?r.getOperatorsQuery(e.Query.prototype.CVOPERATORS_ID):n.startsWith("Is")?r.getOperatorsQuery(e.Query.prototype.OPERATORS_YN):r.getOperatorsQuery(e.Query.prototype.CVOPERATORS);c.getField(n);z.html(a),z[0].SelectedIndex=0,Gt(!0,Ft(n)),z.prop("disabled",!1)}!function(e){var i=D.children()[1],n=null;D.children().length>2&&(n=D.children()[2]);n?t(n).prop("disabled",!e).prop("readonly",!e):null!=i&&t(i).prop("disabled",!e).prop("readonly",!e)}(!0)})),null!=z&&z.on("change",(function(){var t=z.val();t||(t="");var i,n;t&&"0"!=t?e.Query.prototype.BETWEEN.equals(t)&&Gt(!1,Ft(H.val())):(i=btnSave,n=!1,i.prop("disabled",!n),jt(!0))})),null!=Q&&Q.on("change",(function(){f=parseInt(t(this).find(":selected").val()),Vt(f)})),null!=S&&S.on("click","tr .td_Action i",(function(){if(ce||pe){var e=t(this).parent().parent().index(),n=t(this).parent().parent().children().eq(0).attr("value"),a=t(this).parent().parent().children().eq(1).attr("value");S.find("tr").eq(e).remove();var s=t.map(x,(function(e,t){if(e.Color==n)return t}));for(i=0;i<x[s].Condition.length;i++)if(a==x[s].Condition[i].ColName&&x[s].Condition.splice(i,1),x[s].Condition.length<=0){x.splice(s,1);break}}0==x.length&&Mt("")})),Ee.change((function(){ye.find(".vis-active-block").attr("style",t(this).val())})),Pe.change((function(){var i=ye.find(".vis-active-block");if(null==t(this).val()||""==t(this).val())i.find("sql").remove(),i.attr("query","");else{var n=e.secureEngine.encrypt(t(this).val());i.attr("query",n),0==i.find("sql").length&&i.append("<sql>SQL</sql>")}})),Ue.on("input",(function(){ye.find(".canvas").css("zoom",t(this).val())})),ye.find(".vis-viewBlock")[0].addEventListener("dragstart",(function(e){(ze=t(e.target)).hasClass("grdDiv")||!e.ctrlKey?e.preventDefault():(Fe.hide(),me=!1)}),!1),ye.find(".vis-viewBlock")[0].addEventListener("dragover",(function(e){e.preventDefault()})),ye.find(".vis-viewBlock")[0].addEventListener("drop",(function(e){e.preventDefault(),ye.find(".vis-active-block").removeClass("vis-active-block");var i=null,n=t(e.target);n.hasClass("grdDiv")&&(ze.hasClass(".fieldLbl")||(i=ze.find(".fieldLbl")),i.length>0?n.append(ze):(n.addClass("vis-active-block"),ri(ze)),ui())})),st.click((function(e){pt>0?(dt=!0,!1,canv_data=JSON.parse(ct[pt-1]),ye.find(".vis-viewBlock").html(canv_data),pt--,lt.removeAttr("disabled"),St(),dt=!1,pt<=0&&st.attr("disabled","disabled")):st.attr("disabled","disabled"),It()})),lt.click((function(e){ct[pt+1]?(dt=!0,!1,canv_data=JSON.parse(ct[pt+1]),ye.find(".vis-viewBlock").html(canv_data),pt++,st.removeAttr("disabled"),St(),dt=!1,pt>=ct.length-1&&lt.attr("disabled","disabled")):lt.attr("disabled","disabled"),It()})),it.keyup((function(){var e=t(this).val();""==e?Ne.find(".fieldLbl:not(:first)").show():(Ne.find(".fieldLbl").hide(),Ne.find(".fieldLbl:contains("+e+")").show())})),nt.click((function(){it.val(""),it.focus(),Ne.find(".fieldLbl:not(:first)").show()})),rt.change((function(){""!=t(this).val()?(_e.find('[issystemtemplate="Y"]').not(".blankTemp").addClass("displayNone"),_e.find('[issystemtemplate="Y"][category="'+t(this).val()+'"]').removeClass("displayNone")):_e.find('[issystemtemplate="Y"]').removeClass("displayNone"),1==_e.find(".vis-cardSingleViewTemplate:not(:hidden)").length?_e.find(".vis-noTemplateIcon").show():_e.find(".vis-noTemplateIcon").hide()})),jQuery.expr[":"].contains=function(e,t,i){return jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())>=0},ye.find(".vis-viewBlock").on("DOMSubtreeModified",(function(){var e=ye.height(),t=ye.find(".canvas").height();e&&t&&t>e?ye.find(".canvas").addClass("canvasOverFlow"):ye.find(".canvas").removeClass("canvasOverFlow")})),vt.click((function(){ai()}))}function It(){Ne.find(".linked").removeClass("linked vis-succes-clr"),Ne.find(".fieldLbl:not(:first)").prop("draggable",!0),ye.find(".vis-viewBlock").find(".fieldLbl").each((function(){var e=Ne.find('[fieldid="'+t(this).attr("fieldid")+'"]');e.find(".fa-circle").addClass("linked vis-succes-clr"),e.prop("draggable",!1)})),Ne.find('[draggable="true"]:not(:first)').sort(Dt).appendTo(Ne),ye.find(".grdDiv").unbind("mouseover"),ye.find(".grdDiv").mouseover((function(e){me&&!t(this).hasClass("vis-split-cell")&&Zt(t(this))}))}function Dt(e,i){return t(i).attr("title").toUpperCase()<t(e).attr("title").toUpperCase()?1:-1}function wt(){G.find("div").unbind("click"),G.find("div").click((function(){G.find(".crd-active").removeClass("crd-active"),t(this).addClass("crd-active"),$.val(-1),sortOrderArray=[],lastSortOrderArray=[],LastCVCondition=[];var e=t(this).attr("idx");fe=e,W&&0!=W.length&&(Ot(e),q.val(W[e].CardViewName),v=W[e].CardViewID,cardViewUserID=W[e].CreatedBy,T.prop("checked",!!W[e].DefaultID),V.prop("checked",0!=W[e].UserID),Oe=W[e].AD_HeaderLayout_ID,W&&W[e].OrderByClause&&W[e].OrderByClause.length?qt(W[e].OrderByClause):Ht(),xt(v>0,!1),Tt())}))}var bt=function(){var e=ae.val(),t=se.val(),i=le.val(),n=oe.val(),a="linear-gradient("+re.find("option:selected").val()+","+e+" "+i+"%,  "+t+" "+n+"%)";ne.find(".grd-preview").css("background",a)},Ct=function(){for(var e=0;e<c.getFields().length;e++)C.push(c.getFields()[e]);for(e=0;e<u.fields.length;e++)_.push(u.fields[e].getAD_Field_ID())},_t=function(i){var n=e.Application.contextUrl+"CardView/GetCardView";G.html(""),t.ajax({type:"GET",async:!1,url:n,dataType:"json",contentType:"application/json; charset=utf-8",data:{ad_Window_ID:g,ad_Tab_ID:h},success:function(e){if(B=JSON.parse(e),W=B[0].lstCardViewData,F=B[0].lstCardViewConditonData,null!=W&&W.length>0){Z.removeClass("vis-disable-event");for(var n=!1,a=0;a<W.length;a++){var s="";!i&&v?s=W[a].CardViewID==v?'<div idx="'+a+'" class="vis-lft-sgl p-2 d-flex flex-column mb-2 crd-active">':'<div idx="'+a+'" class="vis-lft-sgl p-2 d-flex flex-column mb-2">':W[a].DefaultID&&!i?(n=!0,s='<div idx="'+a+'" class="vis-lft-sgl p-2 d-flex flex-column mb-2 crd-active">'):s=i&&W[a].CardViewID==v?'<div idx="'+a+'" class="vis-lft-sgl p-2 d-flex flex-column mb-2 crd-active">':'<div idx="'+a+'" class="vis-lft-sgl p-2 d-flex flex-column mb-2">',s+='<span class="vis-lft-sgl-title">'+w2utils.encodeTags(W[a].CardViewName)+'</span>    <span class="vis-lft-sgl-sub-title">Created By: '+W[a].CreatedName+'</span>    <span class="vis-lft-sgl-sub-title">Last Modified: '+new Date(W[a].Updated).toLocaleDateString()+"</span></div>",G.append(t(s))}n||i||v||(G.find("div:first").addClass("crd-active"),i=!0);var l=G.find(".crd-active").attr("idx");fe=l,v=W[l].CardViewID,q.val(W[l].CardViewName),Oe=W[l].AD_HeaderLayout_ID,Ot(l),V.attr("checked",W[l].UserID>0),T.attr("checked",!!W[l].DefaultID),l&&W[l].OrderByClause&&W[l].OrderByClause.length>0?qt(W[l].OrderByClause):Ht()}else Z.addClass("vis-disable-event"),W=[];wt(),G.scrollTop(G.find(".crd-active").offset().top-G.find(".crd-active").height()-100)},error:function(e){alert(e.statusText)}})};var St=function(){at={};var i=Se.find(".grid-Section:first").clone(!0);if(i.removeClass("displayNone"),Se.find(".grid-Section:not(:first)").remove(),ye.find(".vis-wizard-section").each((function(e){var n=t(this).attr("sectionCount");0==e&&(i.addClass("section-active"),t(this).addClass("vis-active-block")),i.attr("sectionCount",n);var a=t(this).attr("name");if(i.find(".vis-grey-disp-ttl").text(a),Se.find(".vis-sectionAdd").append(i),(i=Se.find(".grid-Section:first").clone(!0)).removeClass("displayNone"),!at["section"+n]){var s=t(this).attr("row"),l=t(this).attr("col"),o=t(this)[0].style.gridTemplateColumns.split(" "),r=t(this)[0].style.gridTemplateRows.split(" "),d={};for(e=0;e<s;e++)if(r.length>0&&r[e]&&"auto"!=r[e]){var c=r[e].replace(/\'/g,"").split(/(\d+)/).filter(Boolean);d["row_"+e]={val:c[0],msr:c[1]}}else d["row_"+e]={val:1,msr:"auto"};for(var p=0;p<l;p++)if(o.length>0&&o[p]&&"auto"!=o[p]){var u=o[p].replace(/\'/g,"").split(/(\d+)/).filter(Boolean);d["col_"+p]={val:u[0],msr:u[1]}}else d["col_"+p]={val:1,msr:"auto"};d.sectionNo=n,d.sectionName=a,d.rowGap=0,d.colGap=0,d.totalRow=s,d.totalCol=l,at["section"+n]=d}})),Se.find(".vis-sectionAdd").sortable({disabled:!1,update:function(e,t){var i=t.item.attr("sectioncount"),n=(t.item.index(),t.item.next().attr("sectioncount"));if(n)ye.find('[sectioncount="'+n+'"]').before(ye.find('[sectioncount="'+i+'"]'));else{var a=t.item.prev().attr("sectioncount");ye.find('[sectioncount="'+a+'"]').after(ye.find('[sectioncount="'+i+'"]'))}}}),Se.find(".section-active .vis-grey-disp-el").click(),Se.find(".vis-grey-disp-el-xross").eq(1).hide(),pe||Ye){if(Ye=!1,dt)return;Ne.find(".fieldLbl[seqNo]").each((function(){if(t(this).attr("title")&&t(this).attr("title").length>0){t(this).find(".linked").removeClass("linked vis-succes-clr"),t(this).removeAttr("seqNo");t(this).attr("title");t(this).prop("draggable",!0)}})),Ne.find('[draggable="true"]:not(:first)').sort(Dt).appendTo(Ne)}else Ne.find(".fieldLbl[seqNo]").each((function(i){var n=t(this).attr("fieldid");if(0==ye.find('[fieldid="'+n+'"]').length){var a=t(this).text(),s=ye.find('[seqNo="'+t(this).attr("seqNo")+'"]');if(0==s.length)t(this).find(".linked").removeClass("linked vis-succes-clr");else{t(this).find(".fa-circle").addClass("linked vis-succes-clr"),t(this).prop("draggable",!1);var l="",o="",r=!1,d=0,p=s.attr("fieldValuestyle");if(p&&p.indexOf("|")>-1){var u=p.split("<br>");if((p=p.split("|"))&&p.length>0){p[0].indexOf("@img::")>-1&&(r=!0);for(var g=0;g<p.length;g++)p[g].indexOf("@img::")>-1?o=p[g].replace("@img::",""):p[g].indexOf("@value::")>-1?l=p[g].replace("@value::",""):p[g].indexOf("@span::")>-1&&p[g].replace("@span::","");null!=u&&u.length>1&&(d=p[0].indexOf("@img::")>-1?1:2)}}else l=p}if(s.length>0){var h=s.attr("style"),v=h.indexOf("flex-direction"),f="";if(v>-1){var m=h.indexOf(";",v+14);f="display:flex; "+h.substring(v,m)}var y=t('<div class="fieldGroup" style="'+f+'" draggable="true"></div>'),I="Y"==s.attr("showfieldicon"),D="Y"==s.attr("showfieldtext");c.getFieldById(Number(n)).getShowIcon()&&(I?y.append(t('<i class="">&nbsp;</i>')):y.append(t('<i class="fa fa-star">&nbsp;</i>')));var w=D?"displayNone":"",b="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='50' height='50'%3E%3Cdefs%3E%3Cpath d='M23 31l-3.97-2.9L19 28l-.24-.09.19.13L13 33v2h24v-2l-3-9-5-3-6 10zm-2-12c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3zm-11-8c-.55 0-1 .45-1 1v26c0 .55.45 1 1 1h30c.55 0 1-.45 1-1V12c0-.55-.45-1-1-1H10zm28 26H12c-.55 0-1-.45-1-1V14c0-.55.45-1 1-1h26c.55 0 1 .45 1 1v22c-.3.67-.63 1-1 1z' id='a'/%3E%3C/defs%3E%3Cuse xlink:href='%23a' fill='%23fff'/%3E%3Cuse xlink:href='%23a' fill-opacity='0' stroke='%23000' stroke-opacity='0'/%3E%3C/svg%3E",C=c.getFieldById(Number(n)).getDisplayType();if(C==e.DisplayType.Image)y.append(t('<span style="'+s.attr("fieldValueLabel")+'" class="fieldLbl '+w+'" draggable="false" showFieldText="'+D+'" showFieldIcon="'+I+'"  title="'+a+'" fieldid="'+n+'" id="'+t(this).attr("id")+'" >'+a+'</span><img class="vis-colorInvert imgField" style="'+o+'" src="'+b+'"/>'));else if(C==e.DisplayType.TableDir||C==e.DisplayType.Table||C==e.DisplayType.List||C==e.DisplayType.Search){var _='<span style="'+s.attr("fieldValueLabel")+'" class="fieldLbl '+w+'" draggable="false" showFieldText="'+D+'" showFieldIcon="'+I+'" ondragstart="drag(event)" title="'+a+'" fieldid="'+n+'" id="'+t(this).attr("id")+'" >'+a+"</span>",S='<img class="vis-colorInvert imgField" style="'+o+'" src="'+(b="data:image/svg+xml,%3Csvg width='30' height='30' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cdefs%3E%3Cpath id='a' d='m23,31l-3.97,-2.9l-0.03,-0.1l-0.24,-0.09l0.19,0.13l-5.95,4.96l0,2l24,0l0,-2l-3,-9l-5,-3l-6,10zm-2,-12c0,-1.66 -1.34,-3 -3,-3s-3,1.34 -3,3s1.34,3 3,3s3,-1.34 3,-3zm-11,-8c-0.55,0 -1,0.45 -1,1l0,26c0,0.55 0.45,1 1,1l30,0c0.55,0 1,-0.45 1,-1l0,-26c0,-0.55 -0.45,-1 -1,-1l-30,0zm28,26l-26,0c-0.55,0 -1,-0.45 -1,-1l0,-22c0,-0.55 0.45,-1 1,-1l26,0c0.55,0 1,0.45 1,1l0,22c-0.3,0.67 -0.63,1 -1,1z'/%3E%3C/defs%3E%3Cg%3E%3Cuse transform='matrix(0.567292 0 0 0.499809 0.901418 2.3385)' x='0' y='0' stroke='null' id='svg_1' fill='%23fff' xlink:href='%23a'/%3E%3C/g%3E%3C/svg%3E")+'"/>',x="";0==d?x='<span class="fieldValue" style="'+l+'">Value</span>':1==d?x='<span class="fieldValue" style="'+l+'"><br>Value</span>':2==d&&(x='<span class="fieldValue" style="'+l+'">Value<br></span>'),r?(_+=S,_+=x):(_+=x,_+=S),y.append(t(_))}else y.append(t('<span style="'+s.attr("fieldValueLabel")+'" class="fieldLbl '+w+'" draggable="false" showFieldText="'+D+'" showFieldIcon="'+I+'" ondragstart="drag(event)" title="'+a+'" fieldid="'+n+'" id="'+t(this).attr("id")+'" >'+a+'</span><span class="fieldValue" style="'+l+'">:Value</span>'));null!=s.attr("query")&&""!=s.attr("query")&&y.append("<sql>SQL</sql>"),s.append(y)}}})),ye.find(".canvas [query]").each((function(){""!=t(this).attr("query")&&null!=t(this).attr("query")&&null!=t(this).attr("query")&&t(this).append("<sql>SQL</sql>")}))},xt=function(t,i){if(fields=null,B=null,(m=c.getFields()).sort((function(e,t){var i=e.getHeader().toLower(),n=t.getHeader().toLower();return i==n?0:i>n?1:-1})),At(t),null!=c&&c.getFields().length>0){var n=Ne.find(".fieldLbl:first").clone(!0);n.removeClass("displayNone");for(var a=0;a<m.length;a++){var s=m[a].getColumnName().toLower();if("created"!=s&&"createdby"!=s&&"updated"!=s&&"updatedby"!=s&&!e.DisplayType.IsLOB(m[a].getDisplayType())){if(!i)if(jQuery.grep(w,(function(e){return e==m[a].getAD_Field_ID()})).length>0)continue;n.prepend(m[a].getHeader()).attr("title",m[a].getHeader()),m[a].getShowIcon()&&n.attr("showfieldicon",!1),n.attr("fieldid",m[a].getAD_Field_ID()),n.attr("id",p+"_"+m[a].getAD_Field_ID()),Ne.append(n),(n=Ne.find(".fieldLbl:first").clone(!0)).removeClass("displayNone")}}}},At=function(i){var n=Ne.find(".fieldLbl:first").clone(!0);if(Ne.find(".fieldLbl:not(:first)").remove(),n.removeClass("displayNone"),b=[],[],w=[],i&&(v>0||void 0===v)){void 0===v&&(v=0);var a=e.Application.contextUrl+"CardView/GetCardViewColumns";t.ajax({type:"GET",async:!1,url:a,dataType:"json",contentType:"application/json; charset=utf-8",data:{ad_CardView_ID:v},success:function(e){var i=(B=JSON.parse(e))[0].lstCardViewData;if(F=B[0].lstCardViewConditonData,null!=i&&i.length>0){f=i[0].AD_GroupField_ID,cardViewUserID=i[0].CreatedBy;for(var a=0;a<i.length;a++)if(0!=i[a].AD_Field_ID){var s=jQuery.grep(C,(function(e){return e.getAD_Field_ID()==i[a].AD_Field_ID}));s.length>0&&w.push(s[0].getAD_Field_ID()),n.prepend(i[a].FieldName).attr("title",i[a].FieldName),c.getFieldById(i[a].AD_Field_ID).getShowIcon()&&n.attr("showfieldicon",!1),n.attr("fieldid",i[a].AD_Field_ID).attr("seqNo",i[a].SeqNo),n.attr("id",p+"_"+i[a].AD_Field_ID),Ne.append(n),(n=Ne.find(".fieldLbl:first").clone(!0)).removeClass("displayNone")}Ne[0].addEventListener("dragstart",(function(e){ze=t(e.target)}))}null!=F&&F.length>0?(x=[],function(e){var t={};A={};for(var i="",n="",a=null,s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=0;u<e.length;u++){(A={}).Color=e[u].Color,A.Condition=[],i=e[u].ConditionValue.split("&"),n=e[u].ConditionText.split("&");for(var g=0;g<i.length;g++)t={},i[g].contains("!")?(a=i[g].trim().split("!"),c="!",p="!=",l=(s=n[g].trim().split("!"))[0].trim().substring(1,s[0].lastIndexOf("@")),o=a[0].trim().substring(1,a[0].lastIndexOf("@")),d=s[1],r=a[1]):i[g].contains("=")?(a=i[g].split("="),c="=",p="=",l=(s=n[g].split("="))[0].trim().substring(1,s[0].lastIndexOf("@")),o=a[0].trim().substring(1,a[0].lastIndexOf("@")),d=s[1],r=a[1]):i[g].contains("<")?(a=i[g].split("<"),c="<",p="<",l=(s=n[g].split("<"))[0].trim().substring(1,s[0].lastIndexOf("@")),o=a[0].trim().substring(1,a[0].lastIndexOf("@")),d=s[1],r=a[1]):i[g].contains(">")&&(a=i[g].split(">"),c=">",p=">",l=(s=n[g].split(">"))[0].trim().substring(1,s[0].lastIndexOf("@")),o=a[0].trim().substring(1,a[0].lastIndexOf("@")),d=s[1],r=a[1]),t.ColHeader=l,t.ColName=o,t.Operator=c,t.OperatorText=p,t.QueryValue=r,t.QueryText=d,A.Condition.push(t);x.push(A)}Mt(x)}(F)):Mt(x=[]),qt(i[0].OrderByClause)},error:function(e){alert(e.statusText)}})}else if(u.hasIncludedCols){var s=null;w=[];var l=u.fields;if(null!=l&&l.length>0)for(var o=0;o<l.length;o++)(s=jQuery.grep(C,(function(e){return e.getAD_Field_ID()==l[o].getAD_Field_ID()}))).length>0&&w.push(s[0].getAD_Field_ID()),b.push({AD_Field_ID:l[o].getAD_Field_ID(),CardViewID:v,SeqNo:0,FieldName:l[o].getHeader()}),n.prepend(l[o].getHeader()).attr("title",l[o].getHeader()),c.getFieldById(l[o].getAD_Field_ID()).getShowIcon()&&n.attr("showfieldicon",!1),n.attr("fieldid",l[o].getAD_Field_ID()).attr("seqNo",l[o].SeqNo),n.attr("id",p+"_"+l[o].getAD_Field_ID()),Ne.append(n),(n=Ne.find(".fieldLbl:first").clone(!0)).removeClass("displayNone")}},Tt=function(){null!=Q&&Q.children().remove();if(lovcardList={},null!=c&&c.getFields().length>0){Q.append("<Option value=-1></Option>"),m=c.getFields();for(var t=0;t<m.length;t++){var i=m[t].getColumnName().toLower();"created"!=i&&"createdby"!=i&&"updated"!=i&&"updatedby"!=i&&((e.DisplayType.IsLookup(m[t].getDisplayType())&&m[t].getLookup()&&m[t].getLookup().getIsValidated()&&m[t].getIsDisplayed()||m[t].getDisplayType()==e.DisplayType.YesNo)&&(Q.append("<Option value="+m[t].getAD_Field_ID()+"> "+e.Utility.Util.getIdentifierDisplayVal(m[t].getHeader())+"</Option>"),m[t].getDisplayType()!=e.DisplayType.List&&m[t].getDisplayType()!=e.DisplayType.TableDir&&m[t].getDisplayType()!=e.DisplayType.Table&&m[t].getDisplayType()!=e.DisplayType.Search||m[t].lookup&&m[t].lookup.getData()&&(lovcardList[m[t].getAD_Field_ID()]=m[t].lookup.getData())))}}if(null!=f&&f>0){jQuery.grep(m,(function(e){return e.getAD_Field_ID()==f}));Q.find("[value='"+f+"']").attr("selected","selected")}Vt(f)},Vt=function(i){J.find(".onlyLOV").remove();var n=J.find(".vis-sec-2-sub-itm:hidden").clone(!0);if(n.removeClass("displayNone"),J.find(".vis-sec-2-sub-itm:not(:hidden)").remove(),lovcardList[i]){for(var a=0,s=lovcardList[i];a<s.length;a++)s[a].Key.toString().length>0&&s[a].Name.toString().length>0&&(n.attr("key",s[a].Key),n.find(".vis-sub-itm-title").text(e.Utility.Util.getIdentifierDisplayVal(s[a].Name)),J.append(n),n=J.find(".vis-sec-2-sub-itm:last").clone(!0));var l=G.find(".crd-active").attr("idx"),o=W[l].groupSequence,r=W[l].excludedGroup;if(o){o=o.split(","),r=r.split(",");for(var d=0;d<o.length;d++){var c=J.find("[key='"+o[d]+"']");-1!=r.lastIndexOf(o[d])&&c.find(".fa-check-square-o").removeClass("fa-check-square-o").addClass("fa-square-o");var p=J.find(".vis-sec-2-sub-itm").eq(d);c.insertBefore(p)}}J.closest(".vis-sec-2-wrapper").css("height","100%");var u=t(window).height()-248;J.css("height",u+"px"),J.sortable({disabled:!1})}else J.closest(".vis-sec-2-wrapper").css("height","100%"),J.append('<div class="onlyLOV"  key=""><span>'+e.Msg.getMsg("OnlyForLOV")+"</span></div>"),J.sortable({disabled:!0})},Nt=function(){for(var t='<option value="-1"> </option>',i=0;i<y.length;i++){var n=y[i];if(n.getDisplayType()!=e.DisplayType.Image&&!n.getIsEncrypted()){var a=n.getColumnName();if(n.getDisplayType()==e.DisplayType.Button){if(0==n.getAD_Reference_Value_ID())continue;a.endsWith("_ID")?n.setDisplayType(e.DisplayType.Table):n.setDisplayType(e.DisplayType.List)}var s=n.getHeader();(null!=s&&0!=s.length||null!=(s=e.Msg.getElement(e.context,a))&&0!=s.Length)&&(n.getIsKey()&&(s+=" (ID)"),t+='<option value="'+a+'">'+s+"</option>")}}H.html(t)};var Mt=function(t){var i=S.find("tr:first").clone(!0);if(i.removeAttr("style"),S.find("tr:not(:first)").remove(),t.length>0)for(var n=0;n<t.length;n++)for(var a=0;a<t[n].Condition.length;a++)i.find(".td_bgColor i").css({background:t[n].Color,color:"transparent"}),i.find(".td_bgColor").attr("value",t[n].Color),i.find(".td_column").text(t[n].Condition[a].ColHeader).attr("value",t[n].Condition[a].ColName),i.find(".td_operator").text(t[n].Condition[a].Operator).attr("value",t[n].Condition[a].OperatorText),i.find(".td_queryValue").text(t[n].Condition[a].QueryValue).attr("value",t[n].Condition[a].QueryText),S.append(i),i=S.find("tr:last").clone(!0);else S.append("<tr style='height:100%'><td colspan='5' style='background-color: #f1f1f173;'><div class='align-items-center d-flex justify-content-center'><i class='fa fa-database mr-1 fa-2x' aria-hidden='true'></i>"+e.Msg.getMsg("NoResult")+"</div></td></tr>")},kt=function(){var i=e.Application.contextUrl+"CardView/DeleteCardViewRecord";t.ajax({type:"POST",async:!1,url:i,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({ad_CardView_ID:v}),success:function(e){JSON.parse(e);isDefaultcard=!1,v=0,_t(!1)},error:function(e){alert(e.statusText)}})},Ot=function(t){t&&W&&W[t]&&W[t].CreatedBy==e.context.getAD_User_ID()&&W[t].IsEditable?(ve=!0,Z.removeClass("vis-disable-event"),k.removeClass("vis-disable-event"),ot.removeClass("vis-disable-event"),E.removeClass("vis-disable-event"),P.removeClass("vis-disable-event"),M.removeClass("vis-disable-event")):(ve=!1,Z.addClass("vis-disable-event"),k.addClass("vis-disable-event"),ot.addClass("vis-disable-event"),E.addClass("vis-disable-event"),P.addClass("vis-disable-event"),M.addClass("vis-disable-event"))},Lt=function(e){(pe||ce)&&(pe?Z.addClass("vis-disable-event"):Z.removeClass("vis-disable-event"),ce&&!ve&&Z.addClass("vis-disable-event"))};function Rt(t){mt(!0),window.setTimeout((function(){var n="",a="";strConditionArray=[];for(i=0;i<x.length;i++){for(n="",a="",j=0;j<x[i].Condition.length;j++)0==j?(n+="@"+x[i].Condition[j].ColName+"@"+x[i].Condition[j].Operator+x[i].Condition[j].QueryValue,a+="@"+x[i].Condition[j].ColHeader+"@"+x[i].Condition[j].Operator+x[i].Condition[j].QueryText):(n+=" & @"+x[i].Condition[j].ColName+"@"+x[i].Condition[j].Operator+x[i].Condition[j].QueryValue,a+=" & @"+x[i].Condition[j].ColHeader+"@"+x[i].Condition[j].Operator+x[i].Condition[j].QueryText);strConditionArray.push({Color:x[i].Color.toString(),ConditionValue:n,ConditionText:a})}if(pe){if(""==q.val())return e.ADialog.error("FillMandatory",!0,"Name"),mt(!1),!1}else if(!pe&&v<1&&e.MRole.isAdministrator)return e.ADialog.error("ClickNew",!0,""),mt(!1),!1;Et(),t.stopPropagation(),t.preventDefault()}),50)}var Et=function(){var t=G.find(".crd-active").attr("idx");if(t&&null!=W&&W.length>0?cardViewUserID=parseInt(W[t].CreatedBy):cardViewUserID=e.context.getAD_User_ID(),AD_User_ID=e.context.getAD_User_ID(),He&&(pe=!0,He=!1),pe&&null!=W)for(var i=0;i<W.length;i++)if(W[i].CardViewName.trim()==q.val().trim())return e.ADialog.error("cardAlreadyExist",!0,""),mt(!1),!1;cardViewName=q.val().trim(),ce||pe?Pt():(mt(!1),ue?(o.close(),ce=!1,pe=!1,d.isCardRow&&!s&&u.getCardViewData(c,v)):(ce=!0,pe=!1,Ge||(O.show(),L.hide())))},Pt=function(){var i="",n="";t.each(J.find(".vis-sec-2-sub-itm"),(function(){i+=t(this).attr("key")+",",t(this).find(".grpChk").hasClass("fa-check-square-o")||(n+=t(this).attr("key")+",")}));var a=G.find(".crd-active").attr("idx");i=i.replace(/,\s*$/,""),n=n.replace(/,\s*$/,"");var l=sortOrderArray.join(",");cardViewArray=[];var r=v;pe&&(r=0),cardViewArray.push({AD_Window_ID:g,AD_Tab_ID:h,UserID:AD_User_ID,AD_GroupField_ID:Q.find(":selected").val(),isNewRecord:pe,CardViewName:cardViewName,CardViewID:r,IsDefault:T.is(":checked"),AD_HeaderLayout_ID:Oe,isPublic:1!=V.is(":checked"),groupSequence:i});var p=e.Application.contextUrl+"CardView/SaveCardViewColumns";t.ajax({type:"POST",async:!1,url:p,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({lstCardView:cardViewArray,lstCardViewColumns:b,lstCardViewCondition:strConditionArray,excludeGrp:n,orderByClause:l}),success:function(r){var p=JSON.parse(r);v=p,toastr.success(e.Msg.getMsg("SavedSuccessfully"),"",{timeOut:3e3,positionClass:"toast-top-center",closeButton:!0}),ue?(pe=!1,ce=!1,d.isCardRow&&!s&&u.getCardViewData(c,v),o.close()):(pe?_t(!0):(W[a].groupSequence=i,W[a].excludedGroup=n,W[a].AD_GroupField_ID=Q.find(":selected").attr("fieldid"),W[a].CardViewName=cardViewName,W[a].UserID=AD_User_ID,W[a].OrderByClause=l,W[a].Updated=(new Date).toLocaleDateString(),G.find(".crd-active .vis-lft-sgl-title").text(cardViewName)),function(){var i=e.Application.contextUrl+"CardView/getTemplateDesign";_e.find('.vis-cardSingleViewTemplate[issystemtemplate="N"]').remove();var n={ad_Window_ID:c.getAD_Window_ID(),ad_Tab_ID:c.getAD_Tab_ID()};t.ajax({type:"POST",url:i,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),success:function(e){for(var i=JSON.parse(e),n=0;n<i.length;n++)_e.find(".vis-cardTemplateContainer").append(t(i[n].template));mt(!1)},error:function(e){alert(e.statusText),mt(!1)},complete:function(){_e.find(".vis-cardSingleViewTemplate").click((function(){_e.find(".vis-cardSingleViewTemplate").removeClass("vis-active-template"),t(this).addClass("vis-active-template")}))}})}(),ce=!0,pe=!1,Ge||(O.show(),L.hide(),xt(!0,!1))),mt(!1),X.removeClass("vis-disable-event")},error:function(e){alert(e.statusText),mt(!1)}})},Ut=function(){q.val(""),Q.val("-1"),Q.change(),$.val("-1"),sortOrderArray=[],lastSortOrderArray=[],LastCVCondition=[],Mt(x=[]),Ht(),Z.addClass("vis-disable-event"),ee.addClass("vis-disable-event"),T.prop("checked",!1),V.prop("checked",!1),T.parent().show()};function Ft(e){if(null==e||0==e.length)return null;for(var t=0;t<c.getFields().length;t++){var i=c.getFields()[t];if(e.equals(i.getColumnName()))return i}return null}function Bt(t){var i=null;if(t&&(i=I),null!=i){if(i.getDisplayType()==e.DisplayType.YesNo)return"true"==i.getValue().toString().toLowerCase()?"Y":"N";if(e.DisplayType.IsDate(i.getDisplayType())){var n=i.getValue();return n&&n.endsWith(".000Z")&&(n=n.replace(".000Z","Z")),n}return e.DisplayType.IsNumeric(i.getDisplayType()),""==i.getValue()?null:i.getValue()}return""}function Wt(e){var t=null;return e&&(t=I),null!=t?t.getDisplay():""}function jt(e){var t=null;e&&(t=I),null!=t&&t.setValue(null)}function Gt(i,n){i&&(I=null),null;var a=null,s=null;i&&(a=D.children()[0],D.children().length>1&&(s=D.children()[1])),null!=a&&(t(a).remove(),null!=s&&t(s).remove(),a=null);var l=null;if(null!=(l=null!=n?n.getIsKey()?new e.Controls.VNumTextBox(n.getColumnName(),!1,!1,!0,n.getDisplayLength(),n.getFieldLength(),n.getColumnName()):e.VControlFactory.getControl(null,n,!0,!0,!1):new e.Controls.VTextBox("columnName",!1,!0,!1,20,20,"format","GetObscureType",!1))){l.setReadOnly(!1),e.DisplayType.Text==n.getDisplayType()||e.DisplayType.TextLong==n.getDisplayType()?(l.getControl().attr("rows","1"),l.getControl().css("width","100%")):e.DisplayType.YesNo==n.getDisplayType()?l.getControl().css("clear","both"):e.DisplayType.IsDate(n.getDisplayType())&&l.getControl().css("line-height","1");var o=null;l.getBtnCount()>0&&!(l instanceof e.Controls.VComboBox)&&(o=l.getBtn(0)),i&&(D.find("label").remove(),D.append(l.getControl().css("width","95%")),I=l,o&&(D.append(o),o.css("max-width","35px")),e.DisplayType.YesNo!=n.getDisplayType()&&D.append('<label for="txtQueryValue">'+e.Msg.getMsg("QueryValue")+"</label>"))}}function qt(e){if(Ht(),e&&e.length>0){sortOrderArray=e.split(",");for(var t=0;t<sortOrderArray.length;t++){var i=sortOrderArray[t].split(" ");zt(c.getField(i[0]).getHeader(),i[0],i[1])}}}function Ht(){K.empty(),sortOrderArray=[],lastSortOrderArray=[]}function zt(e,t,i){var n='<div class="vis-sortListItem"><p>'+e+'</p><div class="vis-sortListIcons"><span class="vis-sortAsc">';n+="ASC"==i?'<i class="fa fa-sort-amount-asc"></i>':'<i class="fa fa-sort-amount-asc" style="transform: rotate(180deg);padding-top:1px"></i>',n+='</span><span class="vis-sortIcon vis-sortListItemClose" data-text="'+t+" "+i+'"><i class="fa fa-close"></i></span></div></div>',K.append(n)}function Qt(){var i=_e.find(".vis-active-template").clone(!0);i.attr("lastupdated")&&je.text(e.Msg.getMsg("LastSaved")+" "+i.attr("lastupdated")),i.find(".grdDiv").html(""),i.find(".mainTemplate").css("zoom",1),i.attr("createdBy"),qe=i.attr("isSystemTemplate"),Oe=i.find(".mainTemplate").attr("templateid"),Le=Number(Oe),Re=i.find(".mainTemplate").attr("name"),"0"==Oe&&i.find(".mainTemplate").html(t('<div name="Section 1" sectionCount="1" class="section1 vis-wizard-section" style="padding:5px;"></div>')),""==i.html()&&null==i.html()||(i.find(".vis-wizard-section").each((function(){for(var e=t(this).attr("row"),i=t(this).attr("col"),n=[],a=0;a<e*i;a++)n.push('<div class="grdDiv" style="display:none"></div>');t(this).find(".grdDiv").each((function(){var e=t(this).css("grid-area").split("/"),a=i*(t.trim(e[0])-1)+(t.trim(e[1])-1);t.trim(e[0])==t.trim(e[2])-1&&t.trim(e[1])==t.trim(e[3])-1||t(this).addClass("vis-split-cell"),n[a]=t(this)[0].outerHTML})),t(this).html(n.join(" "))})),ye.find(".grdDiv").unbind("mouseover"),ye.find(".vis-viewBlock").attr("style",i.find(".mainTemplate").attr("style")||""),ye.find(".vis-viewBlock").html(i.find(".mainTemplate").html()),ye.find(".grdDiv").mouseover((function(e){me&&!t(this).hasClass("vis-split-cell")&&Zt(t(this))})),ye.find(".vis-viewBlock")[0].addEventListener("dragstart",(function(e){(ze=t(e.target)).hasClass("grdDiv")?e.preventDefault():(Fe.hide(),me=!1)}),!1))}var Jt=["px","%","cm","mm","in","pc","pt","ch","em","rem","vh","vw","vmin","vmax"],$t={width:{proprty:"width",value:"",measurment:!0},minWidth:{proprty:"min-width",value:"",measurment:!0},height:{proprty:"height",value:"",measurment:!0},minHeight:{proprty:"min-height",value:"",measurment:!0},fontSize:{proprty:"font-size",value:"",measurment:!0},fontFamily:{proprty:"font-family",value:"",measurment:!1},color:{proprty:"color",value:"",measurment:!1},border:{proprty:"border",value:"",measurment:!0},borderType:{proprty:"border-style",value:"",measurment:!1},borderColor:{proprty:"border-color",value:"",measurment:!1},borderLeft:{proprty:"border-left-width",value:"",measurment:!0},borderLeftStyle:{proprty:"border-left-style",value:"",measurment:!1},borderLeftColor:{proprty:"border-left-color",value:"",measurment:!1},borderTop:{proprty:"border-top-width",value:"",measurment:!0},borderTopStyle:{proprty:"border-top-style",value:"",measurment:!1},borderTopColor:{proprty:"border-top-color",value:"",measurment:!1},borderRight:{proprty:"border-right-width",value:"",measurment:!0},borderRightStyle:{proprty:"border-right-style",value:"",measurment:!1},borderRightColor:{proprty:"border-right-color",value:"",measurment:!1},borderBottom:{proprty:"border-bottom-width",value:"",measurment:!0},borderBottomStyle:{proprty:"border-bottom-style",value:"",measurment:!1},borderBottomColor:{proprty:"border-bottom-color",value:"",measurment:!1},borderRadius:{proprty:"border-radius",value:"",measurment:!0},borderTopLeftRadius:{proprty:"border-top-left-radius",value:"",measurment:!0},borderTopRightRadius:{proprty:"border-top-right-radius",value:"",measurment:!0},borderBottomRightRadius:{proprty:"border-bottom-right-radius",value:"",measurment:!0},borderBottomLeftRadius:{proprty:"border-bottom-left-radius",value:"",measurment:!0},padding:{proprty:"padding",value:"",measurment:!0},paddingLeft:{proprty:"padding-left",value:"",measurment:!0},paddingTop:{proprty:"padding-top",value:"",measurment:!0},paddingRight:{proprty:"padding-right",value:"",measurment:!0},paddingBottom:{proprty:"padding-bottom",value:"",measurment:!0},margin:{proprty:"margin",value:"",measurment:!0},marginLeft:{proprty:"margin-left",value:"",measurment:!0},marginTop:{proprty:"margin-top",value:"",measurment:!0},marginRight:{proprty:"margin-right",value:"",measurment:!0},marginBottom:{proprty:"margin-bottom",value:"",measurment:!0},opacity:{proprty:"opacity",value:"",measurment:!1},backgroundColor:{proprty:"background-color",value:"",measurment:!1},gradientInput:{proprty:"background",value:"",measurment:!1},gradient:{proprty:"background",value:"",measurment:!1},boxShadow:{proprty:"box-shadow",value:"",measurment:!0},flexDirection:{proprty:"flex-direction",value:"",measurment:!1},bold:{proprty:"font-weight",value:"bold",measurment:!1},italic:{proprty:"font-style",value:"italic",measurment:!1},underline:{proprty:"text-decoration",value:"underline",measurment:!1},textLeft:{proprty:"text-align",value:"left",measurment:!1},textCenter:{proprty:"text-align",value:"center",measurment:!1},textJustify:{proprty:"text-align",value:"justify",measurment:!1},textRight:{proprty:"text-align",value:"right",measurment:!1},upperCase:{proprty:"text-transform",value:"uppercase",measurment:!1},capitalize:{proprty:"text-transform",value:"capitalize",measurment:!1},lowerCase:{proprty:"text-transform",value:"lowercase",measurment:!1},flexJustifyCenter:{proprty:"justify-content",value:"center",measurment:!1},flexJustifyStart:{proprty:"justify-content",value:"flex-start",measurment:!1},flexJustifyEnd:{proprty:"justify-content",value:"flex-end",measurment:!1},flexJustifySpaceBetween:{proprty:"justify-content",value:"space-between",measurment:!1},flexJustifySpaceAround:{proprty:"justify-content",value:"space-around",measurment:!1},flexAlignCenter:{proprty:"align-items",value:"center",measurment:!1},flexAlignEnd:{proprty:"align-items",value:"flex-end",measurment:!1},flexAlignStart:{proprty:"align-items",value:"flex-start",measurment:!1},maxTextmultiline:{proprty:"-webkit-line-clamp",value:"",measurment:!1},objectFit:{proprty:"object-fit",value:"",measurment:!1}},Kt=function(){De.change((function(){t(this).is(":checked")?(Ie.find(".allBorderRadius").removeClass("displayNone"),Ie.find(".singleBorderRadius").addClass("displayNone")):(Ie.find(".allBorderRadius").addClass("displayNone"),Ie.find(".singleBorderRadius").removeClass("displayNone"))})),we.change((function(){t(this).is(":checked")?(Ie.find(".allPadding").removeClass("displayNone"),Ie.find(".singlePadding").addClass("displayNone")):(Ie.find(".allPadding").addClass("displayNone"),Ie.find(".singlePadding").removeClass("displayNone"))})),be.change((function(){t(this).is(":checked")?(Ie.find(".allMargin").removeClass("displayNone"),Ie.find(".singleMargin").addClass("displayNone")):(Ie.find(".allMargin").addClass("displayNone"),Ie.find(".singleMargin").removeClass("displayNone"))})),Ce.change((function(){t(this).is(":checked")?(Ie.find(".allBorder").removeClass("displayNone"),Ie.find(".singleBorder").addClass("displayNone")):(Ie.find(".allBorder").addClass("displayNone"),Ie.find(".singleBorder").removeClass("displayNone"))})),Fe.find("i").click((function(){var e=ye.find(".vis-active-block"),i=t(this).attr("command"),n=e.closest(".fieldGroup").find(".fieldLbl");if("Show"==i)"I"!=e.prop("tagName")||e.hasClass("imgField")?(n.attr("showFieldText",!1),n.removeClass("displayNone")):(e.attr("class","fa fa-star"),e.next().attr("showFieldIcon",!1)),Fe.find('[command="Hide"]').parent().show(),Fe.find('[command="Show"]').parent().hide(),Fe.hide(),ui();else if("Hide"==i)"I"!=e.prop("tagName")||e.hasClass("imgField")?e.hasClass("imgField")?(e.css("display","none"),ui()):(e.hasClass("fieldValue")?e.css("display","none"):(e.attr("showFieldText",!0),e.addClass("displayNone")),ui()):(e.attr("class",""),e.next().attr("showFieldIcon",!0),ui()),Fe.find('[command="Hide"]').parent().hide(),Fe.find('[command="Show"]').parent().show(),Fe.hide();else if("SelectParent"==i)e.parent().hasClass("fieldGroup")?e.parent().parent().mousedown().mouseup():e.parent().mousedown().mouseup();else if("Separate"==i)ti(e),e.removeClass("vis-split-cell"),t(this).parent().hide(),ui();else if("Merge"==i)ei(),Fe.find('[command="Merge"]').parent().hide(),ui();else if("Unlink"==i){Fe.hide();var a=e.closest(".fieldGroup").find(".fieldLbl");oi(a.attr("title"),a),ui()}else"ShowImg"==i?(e.closest(".fieldGroup").find(".imgField").css("display","unset"),Fe.find('[command="ShowImg"]').parent().hide(),ui()):"ShowValue"==i&&(e.closest(".fieldGroup").find(".fieldValue").css("display","unset"),Fe.find('[command="ShowValue"]').parent().hide(),ui())})),ye.find(".canvas *").mousedown((function(i){setTimeout((function(){if("SQL"!=i.target.tagName&&!t(i.target).hasClass("fieldGroup")&&!i.ctrlKey){if(L.find(".vis-v-rowcol").hide(),t(i.target).hasClass("grdDiv")&&(i.preventDefault(),function(e){L.find(".vis-v-rowcol").show();var i=t(e.target).index(),n=function(e){var t=Se.find(".colBox").length-1,i=Math.floor(e/t)+1,n=e%t+1;return{rowNo:i,colNo:n}}(i);1==n.rowNo&&et.hide();1==n.colNo&&tt.hide();Xe.css({left:t(e.target).closest(".vis-viewBlock")[0].offsetLeft-38,top:t(e.target).height()+t(e.target)[0].offsetTop}),et.css({left:t(e.target).closest(".vis-viewBlock")[0].offsetLeft-20,top:t(e.target).height()+t(e.target)[0].offsetTop}),Ze.css({top:t(e.target).closest(".vis-viewBlock")[0].offsetTop-20,left:t(e.target).width()-8+t(e.target)[0].offsetLeft}),tt.css({top:t(e.target).closest(".vis-viewBlock")[0].offsetTop-20,left:t(e.target).width()-5+t(e.target)[0].offsetLeft+15})}(i)),Fe.find('[command="Merge"]').parent().hide(),Fe.find('[command="ShowImg"]').parent().hide(),Fe.find('[command="ShowValue"]').parent().hide(),Ie.find(".imgTextCont").addClass("vis-disable-event"),ye.find(".vis-active-block").removeClass("vis-active-block"),1==U)ye.find(".vis-viewBlock").addClass("vis-active-block");else{var n=t(i.target).closest(".vis-wizard-section").attr("sectionCount");Se.find("[sectionCount='"+n+"']").hasClass("section-active")||Se.find("[sectionCount='"+n+"'] .vis-grey-disp-el").click(),t(i.target).addClass("vis-active-block");var a=i.target.offsetTop-Fe.outerHeight(),s=i.target.offsetLeft;if(Fe.css({top:a,left:s}),Fe.show(),t(i.target).closest(".fieldGroup").length>0?Fe.find('[command="Unlink"]').parent().show():Fe.find('[command="Unlink"]').parent().hide(),Fe.find('[command="fieldName"]').text("").hide(),t(i.target).hasClass("fieldLbl")){Fe.find('[command="fieldName"]').text(t(i.target).closest(".fieldGroup").find(".fieldLbl").attr("title")).show();var l="true"==t(i.target).attr("showFieldText");i.target.hasAttribute("showFieldText")&&l?(Fe.find('[command="Hide"]').parent().hide(),Fe.find('[command="Show"]').parent().show()):(Fe.find('[command="Show"]').parent().hide(),Fe.find('[command="Hide"]').parent().show())}else if("I"==i.target.tagName&&0==t(i.target).closest(".fieldGroup").find(".imgField").length){l="true"==t(i.target).next().attr("showFieldIcon");t(i.target).next().attr("showFieldIcon")&&l?(Fe.find('[command="Hide"]').parent().hide(),Fe.find('[command="Show"]').parent().show()):(Fe.find('[command="Show"]').parent().hide(),Fe.find('[command="Hide"]').parent().show())}else{if(Fe.find('[command="Show"]').parent().hide(),Fe.find('[command="Hide"]').parent().hide(),t(i.target).closest(".fieldGroup").length>0){var o=t(i.target).closest(".fieldGroup").find(".fieldLbl"),r=c.getFieldById(Number(o.attr("fieldid"))).getDisplayType();if(r==e.DisplayType.TableDir||r==e.DisplayType.Table||r==e.DisplayType.List||r==e.DisplayType.Search){var d=t(i.target).closest(".fieldGroup");d.find(".imgField:hidden").length>0?(Fe.find('[command="ShowImg"]').parent().show(),Fe.find('[command="Hide"]').parent().hide()):d.find(".fieldValue:hidden").length>0?(Fe.find('[command="Hide"]').parent().hide(),Fe.find('[command="ShowValue"]').parent().show()):1==d.find(".imgField").length&&1==d.find(".fieldValue").length?(Fe.find('[command="Hide"]').parent().show(),Ie.find(".imgTextCont").removeClass("vis-disable-event")):Ie.find(".imgTextCont").addClass("vis-disable-event")}l="true"==o.attr("showFieldText");Fe.find('[command="fieldName"]').text(o.attr("title")).show()}l&&Fe.find('[command="Show"]').parent().show()}if(t(i.target).hasClass("vis-split-cell"))Fe.find('[command="Separate"]').parent().show();else{Fe.find('[command="Separate"]').parent().hide(),t(i.target).hasClass("grdDiv")&&(me=!0);var p=Se.find(".colBox").length-1;Me.find(".grdDiv").each((function(e){var i=Math.ceil((e+1)/p);t(this).hasClass("vis-active-block")&&(Ae=e-p*(xe=i-1))}))}}t(i.target).hasClass("vis-wizard-section")&&Fe.find('[command="fieldName"]').text("Section "+t(i.target).attr("sectioncount")).show(),t(i.target).hasClass("vis-viewBlock")&&Fe.find('[command="fieldName"]').text("Main container").show()}}),30)})).mouseup((function(i){setTimeout((function(){me=!1,function(i){Ie.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").removeClass("vis-disable-event"),Ie.find("#master001_"+p+" input").val(""),Ie.find("#master001_"+p+" select").val(""),Ie.find(".vis-back-color03").css("background-color","teal"),Ie.find(".gradient2").val("#000"),Ie.find(".percent1").val("0"),Ie.find(".percent2").val("100"),Ie.find(".grdDirection").val("to bottom"),De.prop("checked",!0),Ie.find(".allBorderRadius").removeClass("displayNone"),Ie.find(".singleBorderRadius").addClass("displayNone"),Ie.find("[data-command1]").parent().removeClass("vis-hr-elm-inn-active");var n=i.attr("style");i.find("sql").length>0&&i.attr("query")?Pe.val(e.secureEngine.decrypt(i.attr("query"))):Pe.val("");Ee.val(n),n&&n.split(";").forEach((function(e){var n=e.split(":");for(const e in $t)if("border-left"!=t.trim(n[0])&&"border-right"!=t.trim(n[0])&&"border-top"!=t.trim(n[0])&&"border-bottom"!=t.trim(n[0])||(n[0]=n[0]+"-width"),t.trim(n[0])==t.trim($t[e].proprty)){var a=t.trim(n[1]);if(""==$t[e].value){if("width"!=e&&"height"!=e||(a=a.replaceAll("!important","")),"fontFamily"==e&&(a=a.replaceAll('"',"")),"padding"==e&&t.trim(a).split(" ").length>1?(we.prop("checked",!1),Ie.find(".allPadding").addClass("displayNone"),Ie.find(".singlePadding").removeClass("displayNone"),Ie.find("[data-command='paddingLeft']").val(i.css("padding-left")),Ie.find("[data-command='paddingTop']").val(i.css("padding-top")),Ie.find("[data-command='paddingRight']").val(i.css("padding-right")),Ie.find("[data-command='paddingBottom']").val(i.css("padding-bottom"))):"padding"==e?(we.prop("checked",!0),Ie.find(".allPadding").removeClass("displayNone"),Ie.find(".singlePadding").addClass("displayNone"),Ie.find("[data-command='"+e+"']").val(a)):"margin"==e&&t.trim(a).split(" ").length>1?(be.prop("checked",!1),Ie.find(".allMargin").addClass("displayNone"),Ie.find(".singleMargin").removeClass("displayNone"),Ie.find("[data-command='marginLeft']").val(i.css("margin-left")),Ie.find("[data-command='marginTop']").val(i.css("margin-top")),Ie.find("[data-command='marginRight']").val(i.css("margin-right")),Ie.find("[data-command='marginBottom']").val(i.css("margin-bottom"))):"margin"==e?(be.prop("checked",!0),Ie.find(".allMargin").removeClass("displayNone"),Ie.find(".singleMargin").addClass("displayNone"),Ie.find("[data-command='"+e+"']").val(a)):"borderRadius"==e&&t.trim(a).split(" ").length>1?(De.prop("checked",!1),Ie.find(".allBorderRadius").addClass("displayNone"),Ie.find(".singleBorderRadius").removeClass("displayNone"),Ie.find("[data-command='borderTopLeftRadius']").val(i.css("border-top-left-radius")),Ie.find("[data-command='borderTopRightRadius']").val(i.css("border-top-right-radius")),Ie.find("[data-command='borderBottomRightRadius']").val(i.css("border-bottom-right-radius")),Ie.find("[data-command='borderBottomLeftRadius']").val(i.css("border-bottom-left-radius"))):"borderRadius"==e?(De.prop("checked",!0),Ie.find(".allBorderRadius").removeClass("displayNone"),Ie.find(".singleBorderRadius").addClass("displayNone"),Ie.find("[data-command='"+e+"']").val(a)):Ie.find("[data-command='"+e+"']").val(a),"backgroundColor"==e)Ie.find(".vis-zero-BTopLeftBLeft:first").css("background-color",a),Ie.find("[data-command='"+e+"'][type='color']").val(li(a));else if("color"==e)Ie.find(".vis-zero-BTopLeftBLeft:last").css("background-color",a),Ie.find("[data-command='"+e+"'][type='color']").val(li(a));else if(-1!=e.indexOf("border")&&-1==e.indexOf("radius")){var s=i[0].style;if(""==s.border)""!=s.borderLeftWidth&&(Ie.find("[data-command='borderLeft']").val(s.borderLeftWidth),Ie.find("[data-command='borderLeftStyle']").val(s.borderLeftStyle),Ie.find("[data-command='borderLeftColor']").val(li(s.borderLeftColor)),Ie.find("[data-command='borderLeftColor']").parent().css("background-color",s.borderLeftColor)),""!=s.borderRightWidth&&(Ie.find("[data-command='borderRight']").val(s.borderRightWidth),Ie.find("[data-command='borderRightStyle']").val(s.borderRightStyle),Ie.find("[data-command='borderRightColor']").val(li(s.borderRightColor)),Ie.find("[data-command='borderRightColor']").parent().css("background-color",s.borderRightColor)),""!=s.borderTopWidth&&(Ie.find("[data-command='borderTop']").val(s.borderTopWidth),Ie.find("[data-command='borderTopStyle']").val(s.borderTopStyle),Ie.find("[data-command='borderTopColor']").val(li(s.borderTopColor)),Ie.find("[data-command='borderTopColor']").parent().css("background-color",s.borderTopColor)),""!=s.borderBottomWidth&&(Ie.find("[data-command='borderBottom']").val(s.borderBottomWidth),Ie.find("[data-command='borderBottomStyle']").val(s.borderBottomStyle),Ie.find("[data-command='borderBottomColor']").val(li(s.borderBottomColor)),Ie.find("[data-command='borderBottomColor']").parent().css("background-color",s.borderBottomColor));else{var l=a.split("rgb");l.length>1&&(a=a.replace("rgb"+l[1],li("rgb"+l[1]))),Ie.find("[data-command='"+e+"']").val(a)}""!=s.border||""==s.borderTopWidth&&""==s.borderRightWidth&&""==s.borderTopWidth&&""==s.borderBottomWidth?(Ce.prop("checked",!0),Ie.find(".allBorder").removeClass("displayNone"),Ie.find(".singleBorder").addClass("displayNone")):(Ce.prop("checked",!1),Ie.find(".allBorder").addClass("displayNone"),Ie.find(".singleBorder").removeClass("displayNone"))}break}if($t[e].value==a){Ie.find("[data-command1='"+e+"']").parent().addClass("vis-hr-elm-inn-active");break}}})),("column"==Ie.find("[data-command='flexDirection'] option:selected").val()||"column-reverse"==Ie.find("[data-command='flexDirection'] option:selected").val())&&Ie.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").addClass("vis-disable-event")}(t(i.target))}),30)})),Ie.find("[data-command]").on("change",(function(e){t(this).removeClass("vis-editor-validate");var i=t(this).data("command"),n=t(this).val(),a=!1;-1!=i.indexOf("margin")&&-1!=n.indexOf("-")&&(a=!0);var s=n.replace(/\d+/g,"").replace(".",""),l=n.replace(n.replace(/\d+/g,""),"");if($t[i]&&$t[i].measurment&&""!=n&&"color"!=t(this).attr("type"))if(Jt.indexOf(s)<0){if(isNaN(Number(l)))return void t(this).addClass("vis-editor-validate");a?t(this).val("-"+l+"px"):t(this).val(l+"px")}else if(isNaN(Number(l)))return void t(this).addClass("vis-editor-validate");if("backgroundColor"==i)Ie.find(".vis-zero-BTopLeftBLeft:first").css("background-color",n),Ie.find('[data-command="backgroundColor"]').val(n);else if("color"==i)Ie.find(".vis-zero-BTopLeftBLeft:last").css("background-color",n),Ie.find('[data-command="color"]').val(n);else if("borderColor"==i||"borderLeftColor"==i||"borderRightColor"==i||"borderTopColor"==i||"borderBottomColor"==i){Ie.find("[data-command='"+i+"']").closest(".vis-prop-pan-cont").find(".vis-back-color03").css("background-color",n)}ni(i,t(this).val())})),Ie.find("[data-command2]").on("click",(function(e){Fe.hide();var i=Me.find(".vis-active-block").closest(".fieldGroup"),n=t(this).data("command2");i.find(".fieldValue").attr("style"),i.find(".fieldValue").attr("class");i.find(".fieldValue br").remove(),"SwapImgTxt"==n?i.find(".imgField").before(i.find(".fieldValue")):"SwapTxtImg"==n?i.find(".fieldValue").before(i.find(".imgField")):"SwapTxtImgBr"==n?(i.find(".fieldValue").before(i.find(".imgField")),i.find(".fieldValue").prepend("<br>")):"SwapImgTxtBr"==n&&(i.find(".imgField").before(i.find(".fieldValue")),i.find(".fieldValue").append("<br>"))})),Ie.find("[data-command1]").on("click",(function(e){var i=t(this).data("command1"),n=ye.find(".vis-active-block"),a=!1;a=$t[i].measurment?ii($t[i].proprty,$t[i].value,n):ii($t[i].proprty,!1,n);var s=t(this).closest(".vis-horz-align-d").find(".vis-hr-elm-inn-active");s.removeClass("vis-hr-elm-inn-active"),"justify-content"!=$t[i].proprty&&"align-items"!=$t[i].proprty||!ii("display","flex",n)?"text-align"==$t[i].proprty||"text-transform"==$t[i].proprty?(ni(i,""),s.find("[data-command1]").attr("data-command1")!=i&&(t(this).parent().addClass("vis-hr-elm-inn-active"),ni(i,$t[i].value))):a?(t(this).parent().removeClass("vis-hr-elm-inn-active"),ni(i,"")):(t(this).parent().addClass("vis-hr-elm-inn-active"),ni(i,$t[i].value)):(n[0].style.removeProperty("display"),ni(i,""),s.find("[data-command1]").attr("data-command1")!=i&&(t(this).parent().addClass("vis-hr-elm-inn-active"),ni(i,$t[i].value))),-1==n.attr("style").indexOf("justify-content")&&-1==n.attr("style").indexOf("align-items")&&-1==n.attr("style").indexOf("flex-direction")||n.css("display","flex")})),Se.find(".addGridRow").click((function(){var e=Se.find(".rowBox:first").clone(!0);e.show(),Se.find(".DivRowBox").append(e),Xt(),ui()})),Se.find(".addGridCol").click((function(){var e=Se.find(".colBox:first").clone(!0);e.show(),Se.find(".DivColBox").append(e),Xt(),ui()})),Se.find(".addGridSection").click((function(){Ke=!0,Se.find(".section-active").removeClass("section-active");var e=Se.find(".grid-Section:first").clone(!0);e.removeClass("displayNone"),e.addClass("section-active"),ke=Se.find(".grid-Section").length,e.attr("sectionCount",ke),e.find(".vis-grey-disp-ttl").text("Section "+ke),Se.find(".vis-sectionAdd").append(e),Me=t('<div name="Section '+ke+'" sectionCount="'+ke+'"  class="section'+ke+' vis-wizard-section" style="padding:5px"></div>'),ye.find(".vis-viewBlock").append(Me),Se.find(".rowBox:not(:first)").remove(),Se.find(".colBox:not(:first)").remove(),Se.find(".addGridRow").click(),Se.find(".addGridCol").click(),Se.find(".vis-sectionAdd").sortable({disabled:!1,update:function(e,t){var i=t.item.attr("sectioncount"),n=(t.item.index(),t.item.next().attr("sectioncount"));if(n)ye.find('[sectioncount="'+n+'"]').before(ye.find('[sectioncount="'+i+'"]'));else{var a=t.item.prev().attr("sectioncount");ye.find('[sectioncount="'+a+'"]').after(ye.find('[sectioncount="'+i+'"]'))}}})})),Se.find(".grid-Section .vis-grey-disp-el-xross").click((function(){var e=t(this).closest(".grid-Section").attr("sectionCount");t(this).closest(".grid-Section").hasClass("section-active")&&(Se.find(".grid-Section").eq(1).addClass("section-active"),Se.find(".grid-Section").eq(1).find(".vis-grey-disp-el").click()),t(this).closest(".grid-Section").remove();var i=ye.find(".vis-viewBlock .section"+e);i.find(".fieldLbl").each((function(){t(this).attr("title")&&t(this).attr("title").length>0&&oi(t(this).attr("title"),t(this))})),i.remove(),delete at["section"+e],e=Se.find(".section-active").attr("sectionCount"),Me=ye.find(".vis-viewBlock .section"+e),ui()})),Se.find(".grid-Section .vis-grey-disp-el").click((function(){Se.find(".section-active").removeClass("section-active"),t(this).parent().addClass("section-active");var e=Se.find(".section-active").attr("sectionCount");Me=ye.find(".vis-viewBlock .section"+e),ye.find(".vis-active-block").removeClass("vis-active-block"),Me.addClass("vis-active-block"),function(){Se.find(".rowBox:not(:first)").remove();var e=Se.find(".section-active").attr("sectionCount"),t=at["section"+e],i=Se.find(".rowBox:first").clone(!0);i.show(),Se.find(".colBox:not(:first)").remove();var n=Se.find(".colBox:first").clone(!0);if(n.show(),t){for(let e in t){var a=t[e];-1!=e.indexOf("row_")?(i.find("input").val(a.val),i.find("select").val(a.msr),Se.find(".DivRowBox").append(i),i=Se.find(".rowBox:last").clone(!0)):-1!=e.indexOf("col_")&&(n.find("input").val(a.val),n.find("select").val(a.msr),Se.find(".DivColBox").append(n),n=Se.find(".colBox:last").clone(!0))}Te.val(t.rowGap),Ve.val(t.colGap),Se.find(".rowBox .grdRowDel").eq(1).hide(),Se.find(".colBox .grdColDel").eq(1).hide()}}(),dt||ui()})),Xe.click((function(){var e=ye.find(".vis-active-block").css("grid-area").split("/");Se.find(".grdRowAdd").eq(Number(e[2])-1).click()})),et.click((function(){var e=ye.find(".vis-active-block").css("grid-area").split("/");Se.find(".grdRowDel").eq(Number(e[2])-1).click()})),Ze.click((function(){var e=ye.find(".vis-active-block").css("grid-area").split("/");Se.find(".grdColAdd").eq(Number(e[3])-1).click()})),tt.click((function(){var e=ye.find(".vis-active-block").css("grid-area").split("/");Se.find(".grdColDel").eq(Number(e[3])-1).click()})),Se.find(".grdRowDel").click((function(){var e=t(this).closest(".rowBox").index();Qe=e;Se.find(".rowBox").length;for(var i=Se.find(".colBox").length-1,n=e*i+1-i,a=n;a<n+i;a++){Me.find(".grdDiv").eq(a-1).addClass("del");var s=Me.find(".grdDiv").eq(a-1).find(".fieldLbl");s&&s.attr("title")&&s.attr("title").length>0&&oi(s.attr("title"),s)}Me.find(".del").remove(),t(this).closest(".rowBox").remove(),Yt(-1,0),ui()})),Se.find(".grdRowAdd").click((function(){var e=t(this).closest(".rowBox").index()-1,i=Se.find(".rowBox:first").clone(!0);i.show(),Se.find(".DivRowBox").append(i);Se.find(".rowBox").length;var n=Se.find(".colBox").length-1,a=(e+1)*n;Qe=e+1;for(var s=0;s<n;s++)Me.find(".grdDiv").eq(a-1).after("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>");Yt(1,0),ui()})),Se.find(".grdColDel").click((function(){var e=t(this).closest(".colBox").index()-1,i=Se.find(".rowBox").length-1,n=Se.find(".colBox").length-1;Je=e+1;for(var a=0;a<i;a++)for(var s=0;s<n;s++)if(s==e){var l=n*a+s;Me.find(".grdDiv").eq(l).addClass("del");var o=Me.find(".grdDiv").eq(l).find(".fieldLbl");o&&o.attr("title")&&o.attr("title").length>0&&oi(o.attr("title"),o)}Me.find(".del").remove(),t(this).closest(".colBox").remove(),Yt(0,-1),ui()})),Se.find(".grdColAdd").click((function(){var e=Se.find(".colBox:first").clone(!0);e.show(),Se.find(".DivColBox").append(e),$e=[];var i=t(this).closest(".colBox").index()-1,n=Se.find(".rowBox").length-1,a=Se.find(".colBox").length-1;Je=i+1;for(var s=0;s<n;s++)for(var l=0;l<a;l++)if(l==i){var o=a*s+l;$e.push(o+1),Me.find(".grdDiv").eq(o).after("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>")}Yt(0,1),ui()})),Se.find(".mergeCell").click((function(){ei()})),Ve.change((function(){Yt(),ui()})),Te.change((function(){Yt(),ui()})),Se.find(".rowBox input,select").change((function(){Yt(),ui()})),Se.find(".colBox input,select").change((function(){Yt(),ui()})),Ne.find(".vis-grey-icon .fa-circle").click((function(){if(t(this).hasClass("vis-succes-clr")){var e=t(this).closest(".fieldLbl").attr("fieldid");ye.find('[fieldid="'+e+'"]').mousedown().mouseup(),setTimeout((function(){Fe.find('[command="Unlink"]').click()}),100)}else ri(t(this).closest(".fieldLbl"));ui()})),Be.click((function(){_e.find('.mainTemplate[templateid="'+Oe+'"]').parent().click(),U>1&&(Qt(),St()),Be.hide()}))};function Yt(e,i){e||(e=0),i||(i=0);var n=Se.find(".section-active").attr("sectionCount"),a=Se.find(".section-active .vis-grey-disp-ttl").text(),s={},l="";Se.find(".rowBox:not(:first)").each((function(e){0==e&&t(this).find(".grdRowDel").hide(),"auto"==t(this).find("select :selected").val()?l+=t(this).find("select :selected").val()+" ":l+=t(this).find("input").val()+""+t(this).find("select :selected").val()+" ",s["row_"+e]={val:t(this).find("input").val(),msr:t(this).find("select :selected").val()}}));var o="";Se.find(".colBox:not(:first)").each((function(e){0==e&&t(this).find(".grdColDel").hide(),"auto"==t(this).find("select :selected").val()?o+=t(this).find("select :selected").val()+" ":o+=t(this).find("input").val()+""+t(this).find("select :selected").val()+" ",s["col_"+e]={val:t(this).find("input").val(),msr:t(this).find("select :selected").val()}}));var r=Se.find(".rowBox:not(:first)").length,d=Se.find(".colBox:not(:first)").length;s.sectionNo=n,s.sectionName=a,s.rowGap=Te.val(),s.colGap=Ve.val(),s.totalRow=r,s.totalCol=d,at["section"+n]=s;var c=Me;c.attr("row",r),c.attr("col",d),c.css({"grid-template-columns":o,"grid-template-rows":l,gap:Te.val()+"px "+Ve.val()+"px"});var p=!1,u=Qe,g=Je;-1==e&&u--,-1==i&&g--;var h=0,v=$e;c.find(".grdDiv").each((function(n){var a=t(this).css("grid-area").split("/"),s=Number(t.trim(a[0])),l=Number(t.trim(a[2])),o=Number(t.trim(a[1])),r=Number(t.trim(a[3])),f=Math.floor(n/d)+1;if(null!=Qe){if(Qe>s-1&&Qe<l-1&&(t(this).css("grid-area",s+"/"+o+"/"+(l+e)+"/"+r),p=!0),p&&e>0){for(var m=Number(s);m<=Number(l);m++){for(var y=o;y<r;y++){var I=d*m+y;c.find(".grdDiv").eq(I-1).css("display","none")}if(Qe==m)break}p=!1,Qe=null}}else if(null!=Je&&(Je>o-1&&Je<r-1&&(t(this).css("grid-area",s+"/"+o+"/"+l+"/"+(r+i)),p=!0,c.find(".grdDiv").eq(v[h]).css("display","none")),h++,p&&i>0)){for(m=0;m<$e.length;m++){var D=Math.floor($e[m]/d)+1;D>s-1&&D<l&&c.find(".grdDiv").eq($e[m]).css("display","none")}p=!1,$e=[]}a=t(this).css("grid-area").split("/"),s=Number(t.trim(a[0])),l=Number(t.trim(a[2])),o=Number(t.trim(a[1])),r=Number(t.trim(a[3]));var w=n%d+1;t(this).hasClass("vis-split-cell")?0!=i?i>0?w>g&&t(this).css("grid-area",s+"/"+(o+i)+"/"+l+"/"+(r+i)):w>g&&t(this).css("grid-area",s+"/"+(o-1)+"/"+l+"/"+(r-1)):0!=e&&(e>0?f>u&&t(this).css("grid-area",s+e+"/"+o+"/"+(l+e)+"/"+r):f>u&&t(this).css("grid-area",s-1+"/"+o+"/"+(l-1)+"/"+r)):t(this).css("grid-area",f+"/"+w+"/"+(f+1)+"/"+(w+1))})),Je=null}function Xt(){var e=Se.find(".rowBox"),i=Se.find(".colBox"),n=e.length-1,a=i.length-1,s=Me;if(a>0&&n>0){var l=s.attr("row"),o=s.attr("col");if(o==a||Ke)for(var r=n*a-s.find(".grdDiv").length,d=0;d<r;d++)s.append("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>");else for(var c=1;c<=l;c++){var p=c*o+(c-1);s.find(".grdDiv").eq(p-1).after("<div class='grdDiv' style='padding:5px;display: flex; flex-direction: row;'></div>")}s.find(".grdDiv").unbind("mouseover"),s.find(".grdDiv").mouseover((function(e){e.preventDefault(),me&&!t(this).hasClass("vis-split-cell")&&Zt(t(this))})),Ke=!1}Yt()}function Zt(e){var t=Se.find(".colBox").length-1,i=Me.find(e).index();if(!(i<0)){var n,a,s,l,o=Math.ceil((i+1)/t)-1,r=i-t*o;o<xe?(n=o,a=xe):(n=xe,a=o),r<Ae?(s=r,l=Ae):(s=Ae,l=r),ye.find(".vis-active-block").removeClass("vis-active-block");for(var d=n;d<=a;d++)for(var c=s;c<=l;c++)Me.find(".grdDiv").eq(t*d+c).addClass("vis-active-block");ye.find(".vis-active-block").length>1?Fe.find('[command="Merge"]').parent().show():Fe.find('[command="Merge"]').parent().hide()}}function ei(){var e=0,i=0,n=0,a=1,s=0,l=1,o=Me.find(".vis-active-block").length,r=1,d=0,c=Se.find(".colBox").length-1;Me.find(".grdDiv").each((function(p){s++;var u=Math.ceil((p+1)/c);u!=r&&(s=1),r=u,t(this).hasClass("vis-active-block")&&(0==d&&(d=u),0==e&&0==n&&(e=u,n=s,a=s),d==u&&a++,l==o&&(i=u+1),l++,t(this)[0].style.removeProperty("grid-area"),t(this)[0].style.removeProperty("display"))}));var p=t('<span class="vis-split-cell"></span>');Me.find(".vis-active-block:not(:first)").hide().removeClass("vis-active-block"),Me.find(".vis-active-block:first").css("grid-area",e+"/"+n+"/"+i+"/"+a).addClass("vis-split-cell"),p.click((function(){ti(t(this).parent()),t(this).remove()}))}function ti(e){for(var i=e.css("grid-area").split("/"),n=Se.find(".colBox").length-1,a=Me.find(".grdDiv"),s=Number(t.trim(i[0]));s<Number(t.trim(i[2]));s++)for(var l=Number(t.trim(i[1]));l<Number(t.trim(i[3]));l++){var o=n*(s-1)+(l-1);a.eq(o)[0].style.removeProperty("grid-area"),a.eq(o)[0].style.removeProperty("display")}Yt()}function ii(e,i,n){var a=n.attr("style"),s=!1;return a&&a.split(";").forEach((function(n){var a=n.split(":");i&&t.trim(a[0])===e&&t.trim(a[1])===i?s=!0:i||t.trim(a[0])!==e||(s=!0)})),s}function ni(e,i){var n=ye.find(".vis-active-block");if("flex-direction"==$t[e].proprty&&(n[0].style.removeProperty("display"),n.find(".fieldGroup").removeAttr("style")),"maxTextmultiline"==e&&(""==i||null==i?(n[0].style.removeProperty("overflow"),n[0].style.removeProperty("display"),n[0].style.removeProperty("-webkit-box-orient")):n.css({overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical"})),"gradient"==e||""!=i&&null!=i){if("gradient"==e){var a=Ie.find("."+e+"1").val(),s=Ie.find("."+e+"2").val(),l=Ie.find(".percent1").val(),o=Ie.find(".percent2").val(),r=Ie.find(".grdDirection option:selected").val();i="linear-gradient("+r+","+a+" "+l+"%,  "+s+" "+o+"%)",Ie.find('[data-command="gradientInput"]').val("("+r+","+a+" "+l+"%,  "+s+" "+o+"%)")}if("gradientInput"==e&&(i="linear-gradient"+i),"boxShadow"==e)i=Ie.find(".boxX").val()+" "+Ie.find(".boxY").val()+" "+Ie.find(".boxB").val()+" "+Ie.find(".boxC").val();if("justify-content"!=$t[e].proprty&&"align-items"!=$t[e].proprty&&"flex-direction"!=$t[e].proprty||(n.css("display","flex"),"flex-direction"==$t[e].proprty&&n.find(".fieldGroup").css({display:"flex","flex-direction":t.trim(i)})),"column"==i||"column-reverse"==i?Ie.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").addClass("vis-disable-event"):Ie.find('[data-command1="flexJustifyStart"]').closest(".vis-horz-align-d").removeClass("vis-disable-event"),n.css($t[e].proprty,t.trim(i)),"width"==e||"height"==e){var d=n.attr("style");d=d.replace($t[e].proprty+": "+t.trim(i),$t[e].proprty+":"+t.trim(i)+"!important"),n.attr("style",d)}ui()}else n[0].style.removeProperty($t[e].proprty)}function ai(){mt(!0);var i=e.Application.contextUrl+"CardView/GetSystemTemplateDesign";_e.find('.vis-cardSingleViewTemplate[issystemtemplate="Y"]:not(:first)').remove();t.ajax({type:"POST",url:i,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({}),success:function(e){ht=!0;for(var i=JSON.parse(e),n=0;n<i.length;n++)_e.find(".vis-cardTemplateContainer").append(t(i[n].template));_e.find(".vis-deleteTemplate").remove(),di(),setTimeout((function(){di(),mt(!1),1==_e.find(".vis-cardSingleViewTemplate:not(:hidden)").length?_e.find(".vis-noTemplateIcon").show():_e.find(".vis-noTemplateIcon").hide()}),1e3)},error:function(e){alert(e.statusText),mt(!1)},complete:function(){_e.find(".vis-cardSingleViewTemplate").click((function(){_e.find(".vis-cardSingleViewTemplate").removeClass("vis-active-template"),t(this).addClass("vis-active-template")}))}})}function si(i){if(pe&&""==q.val())return e.ADialog.error("FillMandatory",!0,"Name"),mt(!1),!1;if(pe&&null!=W)for(var n=0;n<W.length;n++)if(W[n].CardViewName.trim()==q.val().trim())return e.ADialog.error("cardAlreadyExist",!0,""),mt(!1),!1;mt(!0);var a=[],s=10,l=[];b=[];var o=!1;if(ye.find(".grdDiv:not(:hidden)").each((function(e){var i=t(this).css("grid-area").split("/"),n=t(this).closest(".vis-wizard-section").attr("sectioncount");at["section"+n].style=t(this).closest(".vis-wizard-section").attr("style"),at["section"+n].sectionID=t(this).closest(".vis-wizard-section").attr("sectionid")||0;var l=10*(t(this).closest(".vis-wizard-section").index()+1);at["section"+n].sectionSeq=l,at["section"+n].sectionName=t(this).closest(".vis-wizard-section").attr("name");var r=null;if(t(this).find("sql").length>0&&(r=t(this).attr("query")||null),t(this).find(".fieldGroup:not(:hidden)").length>0)t(this).find(".fieldGroup:not(:hidden)").each((function(e){o=!0;var n="";if(t(this).find(".imgField").length>0){var d=t(this).find("br").length;t(this).find(".imgField").next(".fieldValue").length>0?(n="@img::"+t(this).find(".imgField").attr("style")||0,d>0&&(n+="|<br>"),n+=" |@value::"+t(this).find(".fieldValue").attr("style")||0):(n="@value::"+t(this).find(".fieldValue").attr("style")||0,d>0&&(n+="|<br>"),n+=" |@img::"+t(this).find(".imgField").attr("style")||0)}else n=t(this).find(".fieldValue").attr("style")||"";var c=!0;0==t(this).find(".fa-star").length&&(c=!0),t(this).find(".fieldLbl").attr("showfieldicon")&&(c="true"==t(this).find(".fieldLbl").attr("showfieldicon"));var p={cardFieldID:t(this).attr("cardfieldid"),sectionNo:l,rowStart:t.trim(i[0]),rowEnd:t.trim(i[2]),colStart:t.trim(i[1]),colEnd:t.trim(i[3]),seq:s,style:t(this).closest(".grdDiv").attr("style"),fieldID:t(this).find(".fieldLbl").attr("fieldid"),valueStyle:n,fieldStyle:t(this).find(".fieldLbl").attr("style")||"",hideFieldIcon:c,hideFieldText:"true"==t(this).find(".fieldLbl").attr("showfieldtext"),columnSQL:r,contentFieldValue:null,contentFieldLabel:null},u={};u.AD_Field_ID=p.fieldID,u.CardViewID=v,u.SeqNo=p.seq,b.push(u),a.push(p)}));else{var d=!1;t(this).attr("showfieldtext")&&(d="Y"==t(this).attr("showfieldtext"));var c=!1;t(this).attr("showfieldicon")&&(c="Y"==t(this).attr("showfieldicon"));var p={cardFieldID:null,sectionNo:l,rowStart:t.trim(i[0]),rowEnd:t.trim(i[2]),colStart:t.trim(i[1]),colEnd:t.trim(i[3]),seq:s,style:t(this).attr("style"),fieldID:null,valueStyle:t(this).attr("fieldValuestyle"),fieldStyle:t(this).attr("fieldValueLabel"),hideFieldIcon:c,hideFieldText:d,columnSQL:r,contentFieldValue:null,contentFieldLabel:null},u={};u.AD_Field_ID=p.fieldID,u.CardViewID=v,u.SeqNo=p.seq,b.push(u),a.push(p)}s+=10})),!o)return e.ADialog.error("FillMandatory",!0,"Link atleast one field"),mt(!1),!1;Object.keys(at).forEach((function(e){var t={sectionName:at[e].sectionName,sectionID:at[e].sectionID,sectionNo:at[e].sectionSeq,style:at[e].style,totalRow:at[e].totalRow,totalCol:at[e].totalCol,rowGap:at[e].rowGap,colGap:at[e].colGap};l.push(t)})),"Y"==qe&&(Re=(Re||q.val())+"_"+Math.floor(1e4*Math.random()),Oe=0),He&&(Re=q.val()+"_"+Math.floor(1e4*Math.random()),Oe=0,v="undefined",pe=!0);var r=v;"undefined"==r&&(r=0),pe&&(r=0);var d={CardViewID:r,templateID:Oe||0,templateName:Re,templateCategory:0,style:ye.find(".vis-viewBlock").attr("style"),cardSection:l,cardTempField:a,isSystemTemplate:"N",refTempID:Le||0},c=e.Application.contextUrl+"CardView/SaveCardTemplate";t.ajax({type:"POST",async:!1,url:c,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(d),success:function(e){var t=JSON.parse(e);if(isNaN(t))return toastr.error(t,"",{timeOut:3e3,positionClass:"toast-top-center",closeButton:!0}),void mt(!1);Oe=t,qe="N",pe||(ce=!0),mt(!1),Rt(i)},error:function(e){alert(e.statusText),mt(!1)}})}function li(e){try{if(/^#[0-9A-F]{6}$/i.test(e))return e;function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])}catch(i){return e}}function oi(e,t){t.closest(".fieldGroup").remove();var i=Ne.find('[fieldid="'+t.attr("fieldid")+'"]');i.find(".linked").removeClass("linked vis-succes-clr"),i.removeAttr("seqNo"),i.prop("draggable",!0),Ne.find('[draggable="true"]:not(:first)').sort(Dt).appendTo(Ne),t.remove(),Fe.hide()}function ri(i){if(i){var n=ye.find(".vis-active-block");if(n.hasClass("grdDiv")){var a=t('<div class="fieldGroup" draggable="true"></div>'),s=i.attr("fieldid"),l=i.clone(!0);l.attr("showfieldicon",!0),i.find(".vis-grey-icon").remove(),i.attr("draggable",!1),c.getFieldById(Number(s)).getShowIcon()&&a.append(t('<i class="fa fa-star">&nbsp;</i>')),n.append(a),a.append(i);var o=c.getFieldById(Number(s)).getDisplayType(),r="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='50' height='50'%3E%3Cdefs%3E%3Cpath d='M23 31l-3.97-2.9L19 28l-.24-.09.19.13L13 33v2h24v-2l-3-9-5-3-6 10zm-2-12c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3zm-11-8c-.55 0-1 .45-1 1v26c0 .55.45 1 1 1h30c.55 0 1-.45 1-1V12c0-.55-.45-1-1-1H10zm28 26H12c-.55 0-1-.45-1-1V14c0-.55.45-1 1-1h26c.55 0 1 .45 1 1v22c-.3.67-.63 1-1 1z' id='a'/%3E%3C/defs%3E%3Cuse xlink:href='%23a' fill='%23fff'/%3E%3Cuse xlink:href='%23a' fill-opacity='0' stroke='%23000' stroke-opacity='0'/%3E%3C/svg%3E";o==e.DisplayType.Image?a.append(t('<img class="vis-colorInvert imgField" style="width:100px;height:100px" src="'+r+'"/>')):o==e.DisplayType.TableDir||o==e.DisplayType.Table||o==e.DisplayType.List||o==e.DisplayType.Search?(r="data:image/svg+xml,%3Csvg width='30' height='30' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cdefs%3E%3Cpath id='a' d='m23,31l-3.97,-2.9l-0.03,-0.1l-0.24,-0.09l0.19,0.13l-5.95,4.96l0,2l24,0l0,-2l-3,-9l-5,-3l-6,10zm-2,-12c0,-1.66 -1.34,-3 -3,-3s-3,1.34 -3,3s1.34,3 3,3s3,-1.34 3,-3zm-11,-8c-0.55,0 -1,0.45 -1,1l0,26c0,0.55 0.45,1 1,1l30,0c0.55,0 1,-0.45 1,-1l0,-26c0,-0.55 -0.45,-1 -1,-1l-30,0zm28,26l-26,0c-0.55,0 -1,-0.45 -1,-1l0,-22c0,-0.55 0.45,-1 1,-1l26,0c0.55,0 1,0.45 1,1l0,22c-0.3,0.67 -0.63,1 -1,1z'/%3E%3C/defs%3E%3Cg%3E%3Cuse transform='matrix(0.567292 0 0 0.499809 0.901418 2.3385)' x='0' y='0' stroke='null' id='svg_1' fill='%23fff' xlink:href='%23a'/%3E%3C/g%3E%3C/svg%3E",a.append(t('<img class="vis-colorInvert imgField" style="width:30px;height:30px" style="display:none" src="'+r+'"/>')),a.append(t('<span class="fieldValue">:Value</span>'))):a.append(t('<span class="fieldValue">:Value</span>'));var d=Ne.find(".linked").length;l.find(".fa-circle").addClass("linked vis-succes-clr"),l.prop("draggable",!1),l.attr("seqNo",a.attr("seqNo")||10*d),Ne.find(".fieldLbl").eq(d).after(l),function(e){var t="",i="",n=0,a=e.attr("fieldValuestyle");if(a&&a.indexOf("|")>-1){var s=a.split("<br>");if((a=a.split("|"))&&a.length>0){a[0].indexOf("@img::")>-1&&!0;for(var l=0;l<a.length;l++)a[l].indexOf("@img::")>-1?i=a[l].replace("@img::",""):a[l].indexOf("@value::")>-1?t=a[l].replace("@value::",""):a[l].indexOf("@span::")>-1&&a[l].replace("@span::","");null!=s&&s.length>1&&(n=a[0].indexOf("@img::")>-1?1:2)}}else a&&a.indexOf("@img::")>-1?i=a.replace("@img::",""):t=a&&a.indexOf("@value::")>-1?a.replace("@value::",""):a;var o="";if(e.attr("showfieldicon")){var r="Y"==e.attr("showfieldicon");e.find(".fieldLbl").attr("showfieldtext",r)}if(e.attr("showfieldtext")){var d="Y"==e.attr("showfieldtext");o=d?"displayNone":"",e.find(".fieldLbl").attr("showfieldtext",d)}e.find(".fieldValue").attr("style",t),e.find(".fieldLbl").attr("style",e.attr("fieldValueLabel")),e.find(".fieldLbl").addClass(o),""!=i&&null!=i&&e.find(".imgField").attr("style",i);1==n?e.find(".fieldValue").prepend("<br>"):2==n&&e.find(".fieldValue").append("<br>");var c=e.attr("style"),p=c.indexOf("flex-direction"),u="";if(p>-1){var g=c.indexOf(";",p+14);u="display:flex; "+c.substring(p,g),e.find(".fieldGroup").attr("style",u)}e.attr("fieldValuestyle")&&-1==e.attr("fieldValuestyle").indexOf("@img::")&&e.find(".fieldGroup .fieldValue").length>0&&e.find(".fieldGroup .imgField").length>0&&e.find(".fieldGroup .imgField").css("display","none")}(n)}}}function di(){_e.find(".vis-cardSingleViewTemplate").each((function(){var e=t(this).height(),i=t(this).width(),n=t(this).find(".mainTemplate"),a=1,s=e/n.height(),l=i/n.width();a=s>l?l:s,n.css("zoom",a)}))}if(s){url=e.Application.contextUrl+"JsonData/GetGridWindowSkipRole";var ci={windowNo:p,AD_Window_ID:c.getField("AD_Window_ID").value};t.ajax({type:"GET",async:!1,url,dataType:"json",contentType:"application/json; charset=utf-8",data:ci,success:function(t){B=JSON.parse(t.result);var i=new e.GridWindow(B);if(null!=i){for(var n=null,a=i.getTabs(),s=0;a.length>0;s++)if(a[s].getAD_Tab_ID()==c.getRecord_ID()){n=a[s];break}if(null!=n){var l=p+"_"+n.getRecord_ID();(d=new e.GridController(!1,!1,l)).initGrid(!0,p,r,n),c=d.getMTab(),u=d.vCardView,g=c.getAD_Window_ID(),h=c.getAD_Tab_ID(),tabName=c.getName(),v=u.getAD_CardView_ID(),f=u.getField_Group_ID(),m=c.getFields(),y=c.getFields().slice(),ft()}}},error:function(e){alert(e.statusText)}})}else ft();function pi(){return o.close(),!0}function ui(){var e=ye.find(".vis-viewBlock").html();pt<ct.length-1&&(ct=ct.slice(0,pt+1),pt++);var t=JSON.stringify(e);t==ct[pt]&&1!=ut||(ct.push(t),ct.length>11&&ct.shift(),pt=ct.length-1),L.find(".vis-v-rowcol").hide(),lt.attr("disabled","disabled"),st.removeAttr("disabled")}this.getRoot=function(){return l},this.show=function(){var i=t(window).width()-150,n=t(window).height()-10;(o=new e.ChildDialog).setTitle(e.Msg.getMsg("Card")),o.setWidth(i),o.setHeight(n),o.setContent(l),o.onOkClick=function(e){},o.onCancelClick=pi,o.onClose=pi,o.show(),o.hideButtons()},this.disposeComponent=function(){r=null,l.remove(),l=null}}function a(){var i=this,n=t("<div>"),a=t('<div class="input-group vis-input-wrap mb-0" >'),s=t('<div class="vis-control-wrap d-block mt-1" >'),l=t('<span style="display:block;margin-bottom:5px;">'+e.Msg.getMsg("NewCardInfo")+"</span>");a.append(l).append(s);var o=t('<input type="text">'),r=t("<label>"+e.Msg.getMsg("EnterName")+"</label>");s.append(o).append(r);var d=t('<div class="d-flex align-items-center justify-content-end mt-2">');function c(){return null==o.val()||""==o.val()?(e.ADialog.info("FileNameMendatory"),!1):(i.onSave(),!0)}function p(){return chCopy.close(),!0}i.btnCopySave=t('<button class="vis-save-cont mr-2">'+e.Msg.getMsg("Ok")+"</button>"),i.btnCopyCancle=t('<button class="vis-save-cont mr-2">'+e.Msg.getMsg("Cancle")+"</button>"),d.append(i.btnCopySave).append(i.btnCopyCancle),n.append(a).append(d),this.show=function(){chCopy=new e.ChildDialog,chCopy.setTitle(e.Msg.getMsg("CardName")),chCopy.setModal(!0),chCopy.setContent(n),chCopy.setWidth("50%"),chCopy.show(),chCopy.onOkClick=c,chCopy.onCancelClick=p,chCopy.onClose=p,chCopy.hideButtons()},this.getName=function(){return o.val()},i.close=function(){chCopy.close()}}n.prototype.getOperatorsQuery=function(t,i){var n="",a="";for(var s in t)a=t[s],i&&(a=e.Msg.getMsg(a)),n+='<option value="'+s+'">'+a+"</option>";return n},n.prototype.sizeChanged=function(e,t){console.log(e,t)},n.prototype.dispose=function(){this.disposeComponent()},e.CVDialog=n,e.CardCopyDialog=a}(VIS,jQuery)},2640:()=>{!function(e,t){e.Chat=function(i,n,a,s,l){this.onClose=null;var o=t('<div class="vis-forms-container"></div>'),r=t('<div class="vis-chatdetailouterwrap"></div>'),d=t('<textarea  id="input-chat-new" class="vis-chat-msgbox"  maxlength="500" />');o.append(r).append(d),this.winNo=l;var c=null;this.prop={WindowNo:l,ChatID:n,AD_Table_ID:a,Record_ID:i,Description:s,TrxName:null,ChatText:"",page:0,pageSize:10},function(i,n,a){e.dataContext.getChatRecords(a,(function(t){var n=JSON.parse(t);p.prop.ChatID=n.chatId;var a="";for(var s in n.subChat){var l=new Date(n.subChat[s].ChatDate).toLocaleString(),o='   <div class="vis-chatboxwrap">';e.Application.isRTL,o+='<div class="vis-chatimgwrap">';var r=!1;if(0==n.subChat[s].AD_Image_ID)o+="<i class='fa fa-user' data-uID='"+n.subChat[s].AD_User_ID+"'></i>",r=!0;else for(var d in n.userimages)if(n.userimages[d].AD_Image_ID==n.subChat[s].AD_Image_ID&&"NoRecordFound"!=n.userimages[d].UserImg&&"FileDoesn'tExist"!=n.userimages[d].UserImg){o+='<img  data-uID="'+n.subChat[s].AD_User_ID+'" src="'+e.Application.contextUrl+n.userimages[d].UserImg+'" />',r=!0;break}0==r&&(o+="<i class='fa fa-user' data-uID='"+n.subChat[s].AD_User_ID+"'></i>"),o+='</div><div class="vis-chatdetailwrap"><div style="display: flex;">',e.Application.isRTL,o+='<span data-uID="'+n.subChat[s].AD_User_ID+'" class="vis-chatusername">',e.Env.getCtx().getAD_User_ID()==n.subChat[s].AD_User_ID?o+="Me":o+=n.subChat[s].UserName,e.Application.isRTL?o+='</span><span style="font-size: .75rem; padding-right: 5px;">'+l+'</span></div><div  style="overflow:auto">':o+='</span><span style="font-size: .75rem; padding-right: 5px;">'+l+"</span></div><div>",e.Application.isRTL,o+='<span style="font-size: .75rem;padding-right:5px">'+e.Utility.encodeText(n.subChat[s].ChatData)+"</span></div>",o+="</div>",a+=o+="            </div>  "}i.html(a)})),i.on("click",(function(i){if(t(i.target).is("span")||t(i.target).is("img")){var a=t(i.target).data("uid");if(null!=a&&null!=a&&a>0)new e.ContactInfo(a,n).show(),c.close()}}))}(r,l,this.prop);var p=this;this.show=function(){(c=new e.ChildDialog).setContent(o),c.setHeight(450),c.setWidth(655),c.setTitle(e.Msg.getMsg("Chat")),c.setModal(!0),c.onClose=function(){p.onClose&&p.onClose(),p.dispose()},c.show(),c.onOkClick=function(i){var n=d.val();if(""==t.trim(n)||""==n||null==n)return e.ADialog.info("EnterData"),null!=i&&i.preventDefault(),!1;p.prop.ChatText=n,e.dataContext.saveChat(p.prop)},c.onCancelClick=function(){}},this.dispose=function(){this.prop=null,r=null,o.remove(),o=null,c=null,p=null}}}(VIS,jQuery)},2972:()=>{!function(e,t){var i=0,n=t(document).width(),a=(t(document).height(),null),s=0,l=null,o=null,r=null,d=null,c=null,p=null,u=null;n=t(document).width(),t(document).height();e.ContactInfo=function(g,h){if(e.Application.isBasicDB)return e.ADialog.error("VIS_NotSupported"),void self.dispose();s=g,i=h,t(".vis-apanel-busy").css("visibility","visible"),l=e.Application.contextUrl+"WSP/Contacts/UserContactInfo?WinNo="+i+"&userID="+s+"&isPartialViewLoad="+!0,a=null,o=null,r=null,$mainUserInfo=null,d=800,c=1048576,p=10,a=t(" <div id='mainUserInfoDiv_"+i+"'><div class='vis-view_left_part'><input type='hidden' value='0' id='userID_"+i+"'></input> <p id='hduserName_"+i+"' style='display: none;'></p>  <p id='userName_"+i+"' class='vis-view_profile_name'></p> <a id='dotImg_"+i+"' href='javascript:void(0)' style='display: none;'></a><div id='popUpDiv_"+i+"' style='display: none;'></div><input type='hidden' value='0' id='BPID_"+i+"'></input><input type='hidden' value='0' id='BPGroupID_"+i+"'></input><input type='hidden' value='' id='userTableID_"+i+"'><p id='companyName_"+i+"' class='vis-view_profile_possession'></p><p class='vis-view_profile_possession' style='border-bottom: 1px solid rgba(var(--v-c-secondary), 1); padding-bottom: 10px;' id='pContactTypeCategory_"+i+"'></p><div class='vis-profile_big_img_mobile'><span id='editMobileImage_"+i+"' class='mobilespan' style='width:24px;float:right;'><input type='file' id='vis-fileinput_"+i+"' class='vis-file-input' value='Add Pic' style='opacity: 0; width: 7%; margin-top: -6px; float: left; z-index: 999; position: absolute; cursor: pointer;'><img src='"+e.Application.contextUrl+"Areas/WSP/Images/Edit-icon.png' style='z-index: 100; position: absolute;'></span><img id='mobileImg_"+i+"' width='100%' alt='Image is not available' src='Areas/VIS/Images/home/User.png'></div><div id='divTeam_"+i+"' class='vis-view_team'></div><div id='divContactDetails_"+i+"' class='vis-view_team'></div><div id='divcompanyDetails_"+i+"' class='vis-view_team'></div><div id='divRole_"+i+"' class='vis-view_team'></div></div><div class='vis-view_right_part'  style='float:left;width: 55%;' id='WSP_view_right_part_"+i+"'><div id='userBigImg_"+i+"' class='vis-profile_big_img' style='width: 322px;'><div class='vis-image-upload'> <label for='file-input' class='vis-fileupload-label'><i class='vis vis-pencil'></i></label><input type='file' id='vis-file-input_"+i+"' class='vis-file-input' value='Add Pic' style='opacity: 0; width: 30%; margin-top: 0px; float: right; z-index: 999; position: absolute; right: 0px; cursor: pointer;'></div><div class='vis-bigimg'> <i id='bigUserImage_"+i+"' class='vis vis-user'></i></div></div><div class='vis-actionswrp'><table id='actionTable_"+i+"' class='vis-tableRightContent'><tbody><tr style='height:30px'> <td class='vis-tdactionlist'><a id='edit_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon'> <i class='vis vis-edit'></i></span> <p>Edit </p> </a> </td> <td class='vis-tdactionlist'> <a id='sendSMS_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon'> <i class='vis vis-sms'></i></span> <p> Send Sms </p> </a> </td> </tr>  <tr style='height:30px'>       <td class='vis-tdactionlist'><a id='email_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon email_icon'>           <i class='vis vis-email'></i></span>           <p>Email </p>       </a>       </td>       <td class='vis-tdactionlist'><a id='appointment_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon'>           <i class='vis vis-appointment'></i></span>           <p>Appointment </p>       </a>       </td>   </tr>   <tr style='height:30px'>       <td class='vis-tdactionlist'><a id='activity_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon'>            <i class='vis vis-cog'></i></span>           <p>Activity</p>       </a>       </td>        <td class='vis-tdactionlist'><a id='createOrder_"+i+"' href='javascript:void(0)' class='vis-tableaction'><span class='vis-left_icon'>           <i class='vis vis-createdocument'></i></span>           <p>Create Order</p>       </a>        </td>    </tr>   <tr style='height:30px'>       <td class='vis-tdactionlist'><a id='BPInfo_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon'>           <i class='vis vis-info'></i></span>           <p>BP Info</p>       </a>        </td>        <td class='vis-tdactionlist'><a id='addBPartner_"+i+"' href='javascript:void(0)' class='vis-tableaction'><span class='vis-left_icon'>           <i class='vis vis-addbp'></i></span>           <p style=''>Add BPartner </p>       </a>       </td>   </tr> <tr style='height:30px'><td class='vis-tdactionlist'><a id='History_"+i+"' class='vis-tableaction' href='javascript:void(0)'><span class='vis-left_icon'><i class='vis vis-history'></i></span><p>"+e.Msg.getMsg("History")+"</p></a></td></tr>   <tr>   </tr></tbody></table></div><div id='divBirthday_"+i+"' class='vis-birthday_container' style='display: none;'></div></div></div>"),this.show=function(){if(!window.WSP)return alert("please download WSP !!!"),void t(".vis-apanel-busy").css("visibility","hidden");window.setTimeout((function(){(u=new e.ChildDialog).setContent(a),u.setWidth(610),u.setTitle(e.Msg.getMsg("ContactInfo")),u.setEnableResize(!1),u.setModal(!0),u.show(),u.getRoot().dialog({position:[400,0]}),u.onClose=function(){dispose()},t.ajax({type:"GET",async:!1,url:l,dataType:"json",success:function(s){var g=JSON.parse(s),h="";""!=g[0].Customer&&(h+=g[0].Customer),""!=g[0].Vendor&&(""!=g[0].Customer&&(h+=","),h+=g[0].Vendor),""!=g[0].Employee&&(""==g[0].Customer&&""==g[0].Vendor||(h+=","),h+=g[0].Employee),""!=g[0].Prospect&&(""==g[0].Customer&&""==g[0].Vendor&&""==g[0].Employee||(h+=","),h+=g[0].Prospect);var v=a.find("#divRole_"+i),f=a.find("#divTeam_"+i),m=a.find("#divContactDetails_"+i),y=a.find("#dotImg_"+i),I=a.find("#userID_"+i),D=a.find("#userTableID_"+i),w=a.find("#hduserName_"+i),b=a.find("#userName_"+i),C=a.find("#BPID_"+i),_=a.find("#BPGroupID_"+i),S=a.find("#companyName_"+i),x=a.find("#pContactTypeCategory_"+i),A=a.find("#mobileImg_"+i),T=(a.find("#team_"+i),a.find("#teamNotFound_"+i),a.find("#address_"+i)),V=a.find("#country_"+i),N=a.find("#postal_"+i),M=a.find("#phone_"+i),k=a.find("#userEmail_"+i),O=(a.find("#emailNotFound_"+i),a.find("#divcompanyDetails_"+i)),L=a.find("#companyNotFound"+i),R=(a.find("#role_"+i),a.find("#roleNotFound_"+i)),E=a.find("#bigUserImage_"+i),P=a.find("#divBirthday_"+i),U=(a.find("#userBigImg_"+i),a.find("#edit_"+i));r=a.find("#WSP_dots_"+i);var F=a.find("#sendSMS_"+i),B=a.find("#email_"+i),W=a.find("#BPInfo_"+i),j=a.find("#createOrder_"+i),G=a.find("#addBPartner_"+i),q=a.find("#History_"+i),H=a.find("#appointment_"+i),z=a.find("#activity_"+i),Q=a.find("#ImportContacts_"+i),J=a.find("#wsp-file-input_"+i),$=a.find("#wsp-fileinput_"+i),K=(a.find(".WSP_profile_big_img"),a.find(".WSP_profile_big_img_mobile")),Y=a.find("#mainUserInfoDiv_"+i),X=!1,Z=!1,ee=(g=JSON.parse(s),""),te="";I.empty(),I.append(g[0].UserID),w.empty(),w.append(g[0].FirstName),w.hide(),b.empty(),y.empty(),""==h||null==h?(U.removeAttr("href"),U.css("cursor","auto"),U.find("p").css("color","black"),W.removeAttr("href"),W.css("cursor","auto"),W.find("p").css("color","black")):(U.attr("href","javascript:void(0)"),U.css("cursor","pointer"),U.removeAttr("style"),W.attr("href","javascript:void(0)"),W.css("cursor","pointer"),W.removeAttr("style")),n>=1e3&&n<=1024?g[0].FirstName.length>15?(y.show(),b.append(g[0].FirstName.substring(0,15)).append(y.append("..."))):b.append(g[0].FirstName):g[0].FirstName.length>20?(y.show(),b.append(g[0].FirstName.substring(0,20)).append(y.append("..."))):b.append(g[0].FirstName),C.empty(),C.append(g[0].BPartnerID),D.append(g[0].TableID),_.empty(),_.append(g[0].BPGroupID),S.empty(),S.append(g[0].CompanyName),x.empty(),x.append(h),A.removeAttr("src").attr("src",g[0].Image),f.empty(),f.append("<p>"+e.Msg.getMsg("Teams")+"</p>");for(var ie=0;ie<g.length;ie++)""!=g[ie].Team&&null!=g[ie].Team&&(X=!0,te+=0==ie||""==te?g[ie].Team:", "+g[ie].Team);X||f.append(" <p  id='teamNotFound_"+i+"' style='word-break: break-all; font-style: italic;'>"+e.Msg.getMsg("NotFound")+"</p>"),X&&f.append(" <p id='team_"+i+"' >"+te+"</p>"),T.empty(),m.empty(),m.append("<p style='word-break: break-all;'> "+e.Msg.getMsg("ContactDetails")+" <a href='javascript:void(0)'> <i id='showAddressOnGoogleMap_"+i+"' class='vis vis-location'></i> </a></p> ");for(ie=0;ie<g.length;ie++)""==g[ie].FirstName&&""!=g[ie].Address&&null!=g[ie].Address&&(!0,m.append("<p id='address_"+i+"' style='word-break: break-all'>"+g[ie].Address+"</p>"));V.empty(),""!=g[0].CountryName&&null!=g[0].CountryName&&(!0,m.append("<p id='country_"+i+"' style='word-break: break-all'>"+g[0].City+"("+g[0].CountryName+")</p> ")),N.empty(),""!=g[0].Postal&&null!=g[0].Postal&&(!0,m.append("<p id='postal_"+i+"' style='word-break: break-all'>"+e.Msg.getMsg("ZipCode")+": "+g[0].Postal+"</p>")),M.empty();for(ie=0;ie<g.length;ie++)""==g[ie].FirstName&&""!=g[ie].PhoneNo&&null!=g[ie].PhoneNo&&(!0,n<=1024?m.append("<a href='tel:"+g[ie].PhoneNo+"'><p id='phone_"+i+"' style='word-break: break-all'><span class='vis-caller'><i class='fa fa-phone'></i></span>"+g[ie].PhoneNo+"</p></a>"):m.append("<p id='phone_"+i+"' style='word-break: break-all'><span class='vis-caller'><i class='fa fa-phone'></i></span>"+g[ie].PhoneNo+"</p>"));k.empty(),""!=g[0].Email&&null!=g[0].Email&&(!0,m.append("<p id='userEmail_"+i+"' style='word-break: break-all;display: inline-flex;margin-top: 0;'> <span class='vis-caller'><i class='vis vis-email'></i></span>"+g[0].Email+"</p>")),O.empty(),O.append("<p>"+e.Msg.getMsg("Company")+"</p>"),O.append("<p id='companyDetails_"+i+"' style='word-break: break-all'>"+g[0].CompanyName+"</p>"),L.empty(),""!=g[0].CompanyName&&null!=g[0].CompanyName&&L.append(e.Msg.getMsg("NotFound")),v.empty(),v.append("<p>"+e.Msg.getMsg("RoleAssign")+"</p>");for(ie=0;ie<g.length;ie++)""!=g[ie].Role&&null!=g[ie].Role&&(Z=!0,ee+=0==ie?g[ie].Role:", "+g[ie].Role);Z&&v.append("<p id='role_"+i+"'>"+ee+"</p>"),R.empty(),Z||v.append("<p id='roleNotFound_"+i+"' style='word-break: break-all; font-style: italic;'>"+e.Msg.getMsg("NotFound")+"</p>"),g[0].Image.indexOf("User")>0?E.removeAttr("src").attr("src",e.Application.contextUrl+"Areas/VIS/Images/home/User.png"):E.removeAttr("src").attr("src",g[0].Image),P.empty();var ne=new Date,ae=new Date(g[0].Birthday),se=ne.getMonth()+1+"/"+ne.getDate(),le=ae.getMonth()+1+"/"+ae.getDate();if(""!=g[0].Birthday){P.show(),P.css("border","1px solid #1886BF");var oe=t("<div class='vis-birthdat_text'>");le==se&&oe.append("<p> "+e.Msg.getMsg("Today")+" "+e.Msg.getMsg("is")+" <span class='vis-birthday_text_highlight'>"+g[0].FirstName+"</span> "+e.Msg.getMsg("Birthday")+"</p>"),oe.append("<p>"+g[0].FirstName+" "+e.Msg.getMsg("Birthday")+" "+e.Msg.getMsg("on")+"  <span class='vis-birthday_text_highlight'>"+g[0].Birthday+"</span></p> </div>"),P.append(oe)}else P.hide();y.on("click",(function(e){$popUp.show();var t=a.find("<div class='arrow_box'> <p style='margin-left:5px;margin-top:5px;margin-right:5px'>"+w.text()+"</p></div>");$popUp.append(t),$popUp.delay(2e3).fadeOut(),e.stopPropagation()})),null!=r&&r.on("click",(function(e){Y.animate({right:"-1000px"},d),e.stopPropagation()})),t(".ui-dialog-content").on("click",(function(e){t("#w2ui-overlay").hide(),e.stopPropagation()}));var re=t("<ul id='ulEditOption' class='vis-apanel-rb-ul'>"),de=t("<ul id='ulCreateOrder' class='vis-apanel-rb-ul'>");function ce(i,n,a){a.stopPropagation(),t.ajax({type:"GET",async:!1,url:i,dataType:"json",success:function(t){var i=JSON.parse(t),a=new e.Query;n?(a.addRestriction("C_BPartner_ID",e.Query.prototype.EQUAL,i[1]),e.viewManager.startWindow(i[0],a),U.find("p").removeAttr("style"),u.close()):(a.addRestriction("C_Order_ID",e.Query.prototype.EQUAL,i[1]),win=e.viewManager.startWindow(i[0],a),win.onLoad=function(){var e=win.cPanel.curGC;e.onRowInserting=function(){win.cPanel.cmd_new(!1)},e.onRowInserted=function(){tab=win.cPanel.curTab,tab.setValue("C_BPartner_ID",C.text())}},j.find("p").removeAttr("style"),u.close())}})}U.on("click",(function(n){if(""==h||null==h)return n.preventDefault(),!1;U.find("p").css("background-color","#e0e0e0"),n.stopPropagation();var a=I.text(),s=h.split(",");if(s.length>1){t("#w2ui-overlay").show(),null!=re&&re.empty();var l=t("<div/>");l.css("width","auto"),l.css("height","100%"),re.css("width","auto"),re.css("height","100%");for(var r="",d=0;d<s.length;d++)r+="<li style='margin-top:15px;margin-left:10px;margin-right:13px;font-size: 15px' id='"+s[d].trim()+"_"+i+"'>"+e.Msg.getMsg(s[d].trim())+"</li>";re.append(r),l.append(re),U.w2overlay(l.clone(!0),{css:{height:"300px"}}),l.css("top","395px"),re.load()}else h==e.Msg.getMsg("Employee")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Employee Master&userID="+a),h==e.Msg.getMsg("Customer")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Customer Master&userID="+a),h==e.Msg.getMsg("Vendor")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Vendor Master&userID="+a),h==e.Msg.getMsg("Prospect")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Prospects&userID="+a),ce(o,!0,n)})),re.on("click","LI",(function(i){t("#w2ui-overlay").hide();var n=t(this).text();n==e.Msg.getMsg("Employee")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Employee Master&userID="+I.text()),n==e.Msg.getMsg("Customer")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Customer Master&userID="+I.text()),n==e.Msg.getMsg("Vendor")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Vendor Master&userID="+I.text()),n==e.Msg.getMsg("Prospect")&&(o=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Prospects&userID="+I.text()),ce(o,!0,i),i.stopPropagation()})),F.on("click",(function(i){F.find("p").css("background-color","#e0e0e0"),t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999"),i.stopPropagation(),window.setTimeout((function(){var i=new e.Sms(null,null,0,!0),n=new e.CFrame;n.setName(e.Msg.getMsg("Sms")),n.setTitle(e.Msg.getMsg("Sms")),n.hideHeader(!0),n.setContent(i),n.show(),i.initializeComponent(),t(".vis-apanel-busy").css("visibility","hidden"),u.close()}),2)})),B.on("click",(function(n){B.find("p").css("background-color","#e0e0e0"),t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999"),n.stopPropagation(),window.setTimeout((function(){var n=new e.Email(t("#userEmail_"+i).text(),null,null,I.text(),!0,!0,D.text()),a=new e.CFrame;a.setName(e.Msg.getMsg("EMail")),a.setTitle(e.Msg.getMsg("EMail")),a.hideHeader(!0),a.setContent(n),a.show(),n.initializeComponent(),t(".vis-apanel-busy").css("visibility","hidden"),u.close()}),2)})),W.on("click",(function(i){if(""==h||null==h)return i.preventDefault(),!1;W.find("p").css("background-color","#e0e0e0"),window.setTimeout((function(){var i,n=I.text();i=e.Application.contextUrl+"WSP/Contacts/GetWindowID?windowName=Business Partner Info&userID="+n,t.ajax({type:"GET",async:!1,url:i,dataType:"json",success:function(t){var i=JSON.parse(t),n=new e.Query;n.addRestriction("C_BPartner_ID",e.Query.prototype.EQUAL,i[1]),e.viewManager.startWindow(i[0],n),W.find("p").removeAttr("style"),u.close()}})}),500)})),j.on("click",(function(n){j.find("p").css("background-color","#e0e0e0"),t("#w2ui-overlay").show(),t("#w2ui-overlay").find("div").empty(),null!=de&&de.empty();var a=t("<div/>");a.css("width","auto"),a.css("height","100%"),de.css("width","auto"),de.css("height","100%");var s=t("<li style='margin-top:15px;margin-left:10px;margin-right:13px;font-size: 15px' id='SaleOrder_"+i+"'>"+e.Msg.getMsg("Sales Order")+"</li> <li  style='margin-top:10px;margin-left:10px;margin-right:13px;font-size: 15px' id='PurchaseOrder_"+i+"' >"+e.Msg.getMsg("PurchaseOrder")+"</li>");de.append(s),a.append(de),j.w2overlay(a.clone(!0),{css:{height:"300px"}}),a.css("top","395px"),n.stopPropagation(),de.load()})),de.on("click","LI",(function(i){t("#w2ui-overlay").hide();var n=t(this).text();ce(l=e.Application.contextUrl+"WSP/Contacts/GetWindowAndOrderID?windowName="+n+"&userID="+I.text(),!1,i),i.stopPropagation()})),G.on("click",(function(t){G.find("p").css("background-color","#e0e0e0"),t.stopPropagation(),$saleOrder=null,$purchaseOrder=null,e.AddUpdateBPartner(i,0,h,null,C.text(),_.text()),G.find("p").removeAttr("style")})),q.on("click",(function(t){new e.AttachmentHistory(D.text(),I.text(),C.text(),0,"AD_User_ID").show()})),H.on("click",(function(n){n.stopPropagation(),H.find("p").css("background-color","#e0e0e0"),t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999"),window.setTimeout((function(){e.AppointmentsForm.init(D.text(),t("#userID_"+i).text(),e.context.getAD_User_ID(),w.text(),!1),H.find("p").removeAttr("style"),t(".vis-apanel-busy").css("visibility","hidden"),u.close()}),500)})),Q.on("click",(function(e){e.stopPropagation(),t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999"),window.setTimeout((function(){WSP.importcontacts(self),t(".vis-apanel-busy").css("visibility","hidden")}),50)})),z.on("click",(function(n){n.stopPropagation(),z.find("p").css("background-color","#e0e0e0"),t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999"),window.setTimeout((function(){e.AppointmentsForm.init(0,t("#userID_"+i).text(),e.context.getAD_User_ID(),w.text(),!0),z.find("p").removeAttr("style"),t(".vis-apanel-busy").css("visibility","hidden")}),500)})),J.on("change",(function(){t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999");var i=I.text(),n=new XMLHttpRequest,a=new FormData,s=J;if(a.append("file",s[0].files[0]),a.append("userID",i),s[0].files[0].size/c>p)return alert(e.Msg.getMsg("UploadedFileSizeLimit")),void J.replaceWith(J.val("").clone(!0));n.open("POST",e.Application.contextUrl+"WSP/Contacts/SaveImageAsByte",!0),n.setRequestHeader("Cache-Control","no-cache"),n.setRequestHeader("Pragma","no-cache"),n.send(a),n.addEventListener("load",(function(e){var i=e.target.response,n=JSON.parse(i);image=JSON.parse(n),E.removeAttr("src").attr("src","data:image/jpg;base64,"+image[1]),t(".vis-apanel-busy").css("visibility","hidden")}),!1),J.val("")})),$.on("change",(function(){t(".vis-apanel-busy").css("visibility","visible"),t(".vis-apanel-busy").css("z-index","999999999999");var i=I.text(),n=new XMLHttpRequest,a=new FormData,s=J;a.append("file",s[0].files[0]),a.append("userID",i),s[0].files[0].size/c>p?alert(e.Msg.getMsg("UploadedFileSizeLimit")):(n.open("POST",e.Application.contextUrl+"WSP/Contacts/SaveImageAsByte",!0),n.setRequestHeader("Cache-Control","no-cache"),n.setRequestHeader("Pragma","no-cache"),n.send(a),n.addEventListener("load",(function(e){var i=e.target.response,n=JSON.parse(i);image=JSON.parse(n),E.removeAttr("src").attr("src","data:image/jpg;base64,"+image[1]),K.removeAttr("src").attr("src","data:image/jpg;base64,"+image[1]),t(".vis-apanel-busy").css("visibility","hidden")}),!1))})),m.find("#showAddressOnGoogleMap_"+i).on("click",(function(){var e="http://local.google.com/maps?q="+(m.find("#address_"+i).text()+m.find("#country_"+i).text());window.open(e)})),t(".vis-apanel-busy").css("visibility","hidden")}})}),2)}}}(VIS,jQuery)},2604:()=>{!function(e,t){function i(i,n,a,s,l,o,r,d,c,p){this.frame=null,this.windowNo=e.Env.getWindowNo();var u,g,h=e.Env.getCtx(),v=null,f="C_BPARTNER_ID",m=null,y=null,I=0,D=[],w=null,b=0;p&&(b=p);var C,_,S,x,A,T,V,N,M=!0,k=!1,O=0,L=[],R=!1,E=[],P=[],U=null,F=null,B=null,W=null,j=null,G=null,q=null,H=null,z=null,Q=null,J=null,$=null,K=null,Y=null,X=null,Z=null,ee=null,te=null,ie=null,ne=null,ae=null,se=null,le=null,oe=t('<div class="vis-awindow-header vis-menuTitle">'),re=this,de=0,ce=0;re.windowNo;F=t('<div class="vis-email-rootDiv vis-forms-container"></div>');var pe,ue,ge,he=t('<div class="vis-email-rootDivBusy"></div>'),ve=t("<ul id='ulAttachmentOption' class='vis-apanel-rb-ul'>"),fe=null,me=!1,ye=!1,Ie=t("<div style='width: 100%;height: 100%;background:black;opacity: .1;display:none'>"),De=null;De=e.Application.isRTL?t("<div id='progress_bar' class='vis-ui-progress-bar ui-container' style='top:41%;width: 80%;right: 10%;'>"):t("<div id='progress_bar' class='vis-ui-progress-bar ui-container' style='top:41%;width: 80%;left: 9%;'>"),Ie.append(De);var we=t("<div class='vis-ui-progress' style='width: 0%; display: block;position:absolute;margin-top:2px'>");De.append(we);var be=t("<span class='ui-label' >").append("0%");De.append(be);var Ce,_e,Se=0,xe=0,Ae=Date.now().toString(),Te=1048576,Ve=0,Ne=0,Me=[],ke=null,Oe=null,Le=0,Re=null,Ee=null,Pe="",Ue="";function Fe(){""==ee.value()&&""==X.val()||(Le=1)}function Be(e){if(1==e&&(m=a.getSelectedRows(),y=n.getRecords()[n.getCurrentRow()]),a.singleRow&&0==m.length)We();else if(m.length>0){for(var t="",i=0;i<m.length;i++)if(l&&null!=m[i].email){l=!0;var s=m[i][n.getKeyColumnName().toLower()];t+='<li class="vis-list-li-bcc"  data-email="'+m[i].email+'"><input data-currentrec="Y" data-recID="'+s+'" id="'+re.windowNo+"_"+m[i].email+'_CheckBoxList1" type="checkbox" value="'+m[i].email+'" checked/><label class="vis-chcklist-label"  for="'+re.windowNo+"_"+m[i].email+'_CheckBoxList1">'+m[i].email+"("+s+")</label></li>"}H.append(t),t=null}else We();e||j.append(H)}function We(){if(l&&null!=y.email){l=!0;var e=y[n.getKeyColumnName().toLower()];H.append('<li class="vis-list-li-bcc" data-email="'+y.email+'"><input id="'+re.windowNo+"_"+y.email+'_CheckBoxList1" type="checkbox" value="'+y.email+'" checked /><label class="vis-chcklist-label" for="'+re.windowNo+"_"+y.email+'_CheckBoxList1">'+y.email+"("+e+")</label></li>")}}function je(i){i?U.empty():(pe=t('<div class="vis-apanel-lb-toggle">'),q=t('<i class="fa fa-bars"></i>'),ue=t('<div class="vis-apanel-lb-toggle" style="border:none;height:100%;overflow-x:hidden;overflow-y: hidden;"></div>'),(_e=t("<div class='vis-apanel-lb-oflow' style='border-top:0;display:none' >")).html("<a data-dir='u' href='javascript:void(0)'><i class='vis vis-arrow-up' data-dir='u'></i></a><a data-dir='d' href='javascript:void(0)' ><i class='vis vis-arrow-down' data-dir='d'></i></a>"),(ge=t('<div class="vis-apanel-lb-toggle" style="padding: 5px 10px;overflow-x:hidden;overflow-y: hidden;"></div>')).append(_e),pe.append(q),B.append(pe),B.append(ue),B.append(ge),(U=t('<ul class="vis-apanel-lb-ul"></ul>')).css({overflow:"auto","overflow-x":"hidden","white-space":"nowrap",width:"100%"}));for(var a="",s=0;s<n.gridTable.getFields().length;s++){var l=n.gridTable.getFields(0)[s].getColumnName().toUpper()==n.getKeyColumnName().toUpper();if(n.gridTable.getFields(0)[s].getIsDisplayed()||l){l||(a+="<li>"+n.gridTable.getFields(0)[s].getHeader()+"</li>");var o=[],r=[];if(n.gridTable.getFields(0)[s].getColumnName().toUpper().equals(f))for(var d=0;d<m.length;d++)e.DisplayType.IsLookup(n.getField(f).getDisplayType()),null!=m[d][f.toLower()]&&(o.push(m[d][f.toLower()]),r.push(m[d][n.getKeyColumnName().toLower()]));qe(o,r)}}l||U.append(a),i||ue.append(U),U.children("li").on("click",at)}function Ge(){if(!R)if(U.height()>t(U.parent()).height()){ue.css("border-bottom","1px solid rgba(var(--v-c-secondary), 1)"),_e.css("display","block");var e=ge.height()+pe.height()+37;ue.height(B.height()-e),B.css("overflow","hidden"),ue.css({"overflow-x":"hidden",width:"100%","overflow-y":"visible"})}else ue.css("border-bottom","none"),_e.css("display","none")}function qe(i,n){for(var a=0;a<i.length;a++){var s=e.dataContext.getJSONData(e.Application.contextUrl+"Email/GetUser",{BPartner_ID:i[a]},null),l="";if(null!=s)for(var o in s)if(null!=s[o].Email){if(null==s[o].Email||""==s[o].Email)continue;if(t(H.children("li").data(s[o].Email+n[a])).length>0)continue;l+='<li  class="vis-list-li-bcc"><input data-currentrec="N" data-recid="'+n[a]+'" id="'+re.windowNo+"_"+s[o].Email+'_CheckBoxList1" type="checkbox"  value="'+s[o].Email+'" checked/><label class="vis-chcklist-label"  for="'+re.windowNo+"_"+s[o].Email+'_CheckBoxList1">'+s[o].Email+"("+n[a]+")</label></li>"}H.append(l),l=null}}function He(e){1==z.prop("checked")?40==B.width()?(l?(middleDivWidth=ce-(F.find(".vis-email-leftDiv").width()+200),F.find(".vis-Email-leftWrap").width(middleDivWidth-355),F.find(".vis-form-data-sub").width(F.find(".vis-Email-leftWrap").width()-45),W.width(middleDivWidth)):(middleDivWidth=ce-(F.find(".vis-email-leftDiv").width()+200),F.find(".vis-Email-leftWrap").width(middleDivWidth-15),F.find(".vis-form-data-sub").width(middleDivWidth-40),W.width(middleDivWidth)),B.css("width","200px"),B.find("ul").show(),Ge(),null!=ee&&null!=ee&&(ee.body.style.width=ee.body.style.width-160)):(ze(),ue.css("border-bottom","none"),R||_e.css("display","none")):40!=B.width()&&ze(),e.stopPropagation()}function ze(){B.css({width:"40px"}),B.find("ul").hide(),l?(middleDivWidth=ce-(F.find(".vis-email-leftDiv").width()+40),F.find(".vis-Email-leftWrap").width(middleDivWidth-355),F.find(".vis-form-data-sub").width(F.find(".vis-Email-leftWrap").width()-45),W.width(middleDivWidth)):(middleDivWidth=ce-(F.find(".vis-email-leftDiv").width()+40),F.find(".vis-Email-leftWrap").width(middleDivWidth-15),F.find(".vis-form-data-sub").width(middleDivWidth-40),W.width(middleDivWidth)),null!=ee&&null!=ee&&(ee.body.style.width=ee.body.style.width+160)}function Qe(){_=t("<div></div>");var e=t("<div></div>");F.find(".vis-email-attachmentContainer").append(e),0==M&&(S=t('<a class="vis-attach-ico browse-ico" style="margin-right:8px;float:right;height:30px;width:30px;margin-top:6px;"></a>'),_.append(S),e.append(S)),x=t("<div></div>"),e.append(x),(w=t("<div class='vis-attach-content-wrap' style='height:83px;border-bottom:2px solid rgba(var(--v-c-secondary), 1);padding-bottom:0px'>")).append(t('<div style="height:auto;overflow:auto" ></div>')),x.append(w),F.find(".vis-email-attachmentContainer").append(Ie),0==M&&(A=t("<div></div>"),e.append(A),N=t('<a href="javascript:void(0)" class="vis-attach-ico uploadall-ico" style="height:30px;width:30px;margin-right: 7px;float:right"></a>'),A.append(N),N.on("click",(function(){Ze()})))}!function(){(R=o)?null!=r&&null!=r&&(O=r):(O=n.gridTable.AD_Table_ID,m=a.getSelectedRows(),y=n.getRecords()[n.getCurrentRow()]);H=t('<ul class="vis-email-ul" ></ul>'),(C=t("<div>")).css("position","absolute"),C.css("bottom","0"),C.css("background","url('"+e.Application.contextUrl+"Areas/VIS/Images/LoadingCircle.gif') no-repeat"),C.css("background-position","center center"),C.css("width","98%"),C.css("height","98%"),C.css("text-align","center"),C.css("opacity",".1"),C[0].style.visibility="hidden"}(),this.initializeComponent=function(){var s,o,r=null;1==l?(r=t('<a href="javascript:void(0)"  class="vis-icon-menuclose"><i class="vis vis-cross"></i></a>'),s=t(R?"<p>"+e.Msg.getMsg("EMail")+" ("+e.Msg.getMsg("Contacts")+") </p>":"<p>"+e.Msg.getMsg("EMail")+" ("+a.aPanel.$parentWindow.getName()+") </p>")):(r=t('<a href="javascript:void(0)"  class="vis-icon-menuclose"><i class="vis vis-cross"></i></a>'),s=t(R?"<p>"+e.Msg.getMsg("Letter")+" ("+e.Msg.getMsg("Contacts")+") </p>":"<p>"+e.Msg.getMsg("Letter")+" ("+a.aPanel.$parentWindow.getName()+") </p>")),F.append(oe.append(r).append(s)),r.click((function(e){re.dispose(),re=null,e.stopPropagation()})),o={windowNo:re.windowNo,language:e.Env.getAD_Language(e.Env.getCtx())},t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Email/Init",data:o,success:function(e){!function(e){F.append(t(e));var n=0;z=F.find("#"+re.windowNo+"_dyndis"),Re=F.find("#"+re.windowNo+"_dynPF"),Ee=F.find("#"+re.windowNo+"_dynPFType"),F.find(".vis-email-attachmentContainer").hide(),B=F.find(".vis-email-leftDiv"),j=F.find(".vis-Email-BccList"),X=F.find("#"+re.windowNo+"_emailSubject"),G=F.find(".vis-DMSAttachDocList"),Oe=F.find(".vis-dmsdocumentheader"),window.VADMS||(G.css("display","none"),Oe.css("display","none")),null!=c&&null!=c&&X.val(c),Y=F.find("#"+re.windowNo+"_vis-email-attacImg"),Z=F.find("#"+re.windowNo+"_vis-Email-textarea"),te=F.find(".vis-Email-leftFooter"),F.find(".contentArea").css("height",F.height()-44),F.find(".vis-Email-textarea-div").css({"margin-top":"10px"}),1==/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase())&&F.find(".vis-Email-textarea-div").css({overflow:"auto"}),F.find(".vis-email-leftDiv").height(F.find(".contentArea").height()),R?(F.find(".vis-form-data-sub").css("margin-top","0px"),F.find(".vis-email-leftDiv").hide(),F.find(".vis-Email-rytWrap").hide(),Q=F.find("#"+re.windowNo+"_emailToTop"),J=F.find("#"+re.windowNo+"_emailBccTop"),$=F.find("#"+re.windowNo+"_eamilCcTop"),null!=Pe&&null!=Pe&&""!=Pe?$.val(Pe):$.hide(),null!=Ue&&null!=Ue&&""!=Ue?J.val(Ue):J.hide(),F.find(".vis-Email-textarea-div").height(F.height()-180),F.find(".vis-Email-leftWrap").css("width","100%"),F.find(".vis-Email-leftFooter").hide(),n=F.width()-40,z.prop("checked",!1),F.find(".vis-Email-topinputWrap").css("overflow","auto"),z.hide(),Re.prop("checked",!1),Re.parent().hide(),Ee.prop("checked",!1),Ee.parent().hide(),null!=i&&null!=i&&Q.val(i),F.find(".vis-form-data-sub").width(F.width()-85)):l?(F.find(".vis-Email-topinputWrap").hide(),Q=F.find("#"+re.windowNo+"_emailTo"),J=F.find("#"+re.windowNo+"_emailBcc"),$=F.find("#"+re.windowNo+"_eamilCc"),F.find(".vis-Email-textarea-div").height(F.height()-145),K=F.find("#"+re.windowNo+"_emailRefresh"),n=F.width()-90,F.find(".vis-Email-leftWrap").width(n-350),F.find(".vis-form-data-sub").width(F.find(".vis-Email-leftWrap").width()-60)):(F.find(".vis-Email-rytWrap").hide(),F.find(".vis-Email-topinputWrap").hide(),Y.hide(),F.find(".vis-Email-textarea-div").height(F.height()-142),F.find(".vis-Email-leftWrap").css("margin-right","20px"),n=F.width()-240,F.find(".vis-Email-leftWrap").width(n-25),F.find(".vis-form-data-sub").width(F.find(".vis-Email-leftWrap").width()-60)),window.VADMS?F.find(".vis-Email-BccList").height(F.find(".vis-Email-rytContent").height()-(F.find(".vis-Email-rytForm").height()+70)-520):F.find(".vis-Email-BccList").height(F.find(".vis-Email-rytContent").height()-(F.find(".vis-Email-rytForm").height()+70)-280),(W=F.find(".vis-Email-ContentWrap")).css("width",n),null!=ee&&null!=ee&&(ee.body.style.width=n-370+"px"),me=!0,1==l?(Re.show(),Re.next().show()):(Re.hide(),Re.next().hide())}(e)}}),0!=function(){try{Z.kendoEditor({tools:["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","insertImage","insertFile","subscript","superscript","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn","viewHtml","formatting","cleanFormatting","fontName",{name:"fontSize",items:[].concat([{text:"8px",value:"8px"}],[{text:"12px",value:"12px"}],[{text:"16px",value:"16px"}],[{text:"20px",value:"20px"}],[{text:"24px",value:"24px"}])},"foreColor","backColor"],keyup:Fe,encoded:!1}),(ee=Z.data("kendoEditor")).value(""),null!=d&&null!=d&&ee.value(d)}catch(t){return console.log(t),e.ADialog.error("PleaseInstallKendoUIModule"),re.dispose(),re=null,!1}return!0}()&&(F.append(C),function(){l?(ne=t('<i class="vis-email-sendbtn vis vis-paper-plane"  title="'+e.Msg.getMsg("SendMail").replace("&","")+'"></i>'),oe.append(ne)):(ne=t('<i class="vis-email-saveAttachbtn vis vis-save-attach"  title="'+e.Msg.getMsg("SaveAttachment").replace("&","")+'" ></i>'),oe.append(ne));R||(ie=t('<i class="vis-email-btns vis vis-viewdocument"  title="'+e.Msg.getMsg("Preview").replace("&","")+'" ></i>'),oe.append(ie),se=t('<i class="vis-email-btns vis vis-save-as" title="'+e.Msg.getMsg("SaveAs").replace("&","")+'" ></i>'),oe.append(se),le=t('<i class="vis-email-btns vis vis-save" title="'+e.Msg.getMsg("Save").replace("&","")+'"></i>'),oe.append(le),ae=t('<i class="vis-email-btns vis vis-open-file" title="'+e.Msg.getMsg("Open").replace("&","")+'" ></i>'),oe.append(ae));l||(T=t('<i class="vis-email-btns vis vis-save-pdf" title="'+e.Msg.getMsg("SavePdf").replace("&","")+'"></i>'),V=t('<i class="vis-email-btns vis vis-new" title="'+e.Msg.getMsg("NewLetter").replace("&","")+'" ></i>'),oe.append(T).append(V))}(),R||l&&Be(!1),R||(je(!1),t.ajax({url:e.Application.contextUrl+"JsonData/GetReportFileTypes",datatype:"json",type:"post",cache:!1,data:{AD_Process_ID:n.getAD_Process_ID()},success:function(e){if(null!=e){var i=jQuery.parseJSON(e);if(0!=i.length)for(var n=0;n<i.length;n++)Ee.append(t("<option value="+i[n].Key+">"+i[n].Name+"</option>"))}}})),function(){X.on("change",Fe),R||_e.on("click",(function(e){e.stopPropagation();var i=t(e.target).data("dir");if(i){var n=U.parent().height(),a=U.height(),s=U.parent().scrollTop(),l=Math.ceil(n/2),o=0;if("d"==i){if(s+l>=a-l)return;var r=a-n;o=s+l,U.parent().animate({scrollTop:o>r?r:o},1e3)}else if("u"==i){if(0==s)return;o=s-l,U.parent().animate({scrollTop:o<0?0:o},1e3)}}}));Y.on("click",(function(){!function(){null!=ve&&ve.empty();var i=t("<div/>");i.css("width","auto"),i.css("height","100%"),ve.css("width","auto"),ve.css("height","100%");var n="<li class='vis-filesystem' value='0'>"+e.Msg.getMsg("FileSystem")+"</li> ";window.VADMS&&(n+="<li class='vis-dms' value='1'>"+e.Msg.getMsg("DMS")+"</li>");ve.append(n),i.append(ve),Y.w2overlay(i.clone(!0),{css:{height:"300px"}}),i.css("top","395px"),ve.load()}()})),ve.on("click","li",(function(i){i.stopPropagation();var n=t(this).attr("value");if(0==parseInt(n))!function(e){if(0==M)if(F.find(".vis-email-attachmentContainer").is(":visible"))F.find(".vis-email-attachmentContainer").hide(),F.find(".vis-Email-textarea-div").height(F.find(".vis-Email-textarea-div").height()+(F.find(".vis-email-attachmentContainer").height()+13));else{F.find(".vis-Email-ContentArea").height();F.find(".vis-email-attachmentContainer").show(),F.find(".vis-Email-textarea-div").height(F.find(".vis-Email-textarea-div").height()-(F.find(".vis-email-attachmentContainer").height()+13)),null!=ke&&null!=ke||(Qe(),ke=F.find("<input type='file' multiple='true' style='display:none;'>"),_.append(ke),S.on("click",(function(){ke.trigger("click")})),ke.change((function(){Ke(this)})))}else{if(!F.find(".vis-email-attachmentContainer").is(":visible")){F.find(".vis-Email-ContentArea").height();null!=ke&&null!=ke||(Qe(),(ke=t("<input type='file' multiple='true' style='display:none;'>")).change((function(){this.files.length<1||(F.find(".vis-email-attachmentContainer").show(),Ke(this),R?F.find(".vis-Email-textarea-div").height(F.find(".vis-Email-ContentArea").height()-(F.find(".vis-form-horizontal").height()+30)):F.find(".vis-Email-textarea-div").height(F.find(".vis-Email-ContentArea").height()-(F.find(".vis-form-horizontal").height()+50)),D&&D.length>0&&Ze())})))}ke.trigger("click")}}();else if(1==parseInt(n)){if(t("#w2ui-overlay").hide(),null!=fe&&fe.GetDmsCloseOrNot())return void e.ADialog.info("DMSAlreadyOpen");var a=new e.CFrame;fe=new VADMS.DocumentManagementSystem,a.setName(e.Msg.getMsg("VADMS_Document")),a.setTitle(e.Msg.getMsg("VADMS_Document")),a.hideHeader(!0),fe.setWindowNo(re.windowNo),fe.OpenFromEmail(!0),a.setContent(fe),fe.initialize(),a.show()}})),l?(ne.on("click",lt),null!=K&&null!=K&&K.on("click",It)):ne.on("click",dt);l||(T.on("click",ct),V.on("click",ut));R?F.find(".vis-Email-CcBcc").on("click",wt):(q.on("click",He),z.on("click",it),ie.on("click",st),ae.on("click",ft),se.on("click",mt),le.on("click",yt),q.trigger("click"),Re.on("click",nt));St(),l||X.keyup((function(e){Le=""!=X.val()&&""!=ee.value()?1:0}))}())},this.getRoot=function(){return F},this.leftULsize=function(){if(!R){var e=ge.height()+pe.height()+53;t(U.parent()).height(B.height()-e),1==ye&&Ge()}};var Je=function(e){e?(Ie.show(),De.show()):(Ie.hide(),De.hide())},$e=[],Ke=function(i){$e=[];for(var n=0;n<i.files.length;n++){if(null==(Ce=i.files[n]))return;if(0!=Ce.size){var a=e.context.getContext("#ALLOWED_FILE_EXTENSION");if(a&&a.length>0&&-1==a.split(",").indexOf("."+Ce.name.split(".").pop()))$e.push(Ce.name);else{for(var s in D)if(Ce.name==D[s].name)return void window.setTimeout((function(){e.ADialog.info("fileAlreadyAttached")}),2);if(null!=E)for(var l=0;l<E.length;l++)if(Ce.name==E[l])return void window.setTimeout((function(){e.ADialog.info("fileAlreadyAttached")}),2);for(var s in Ve=0,D)Ve+=D[s].size;if(Ve+Ce.size>25165824)return void window.setTimeout((function(){e.ADialog.info("MaxFileSize25MB")}),2);if(Ce.size>25165824)return void window.setTimeout((function(){e.ADialog.info("MaxFileSize25MB")}),2);var o={},r=t("<div style='margin-bottom:3px' class='vis-attach-file-wrapla'>");w.children(0).append(r);var d=t("<div class='vis-attach-file-top'>"),c=t("<a class='vis-file-close-ico'><i class='vis vis-mark'></i></a>");d.append(c),r.append(d),w.show(),c.on("click",(function(){var e=t(t(this).parent()).parent(),i=e.html();for(var n in e.remove(),e=null,D)if(String(i).indexOf(D[n].name)>-1){Ve-=n.size,D.splice(n,1);break}for(var n in P.splice(0,P.length),D)P.push(D[n].name);Ye()||(F.find(".vis-attach-content-wrap").height(83),F.find(".vis-email-attachmentContainer").height(90),R?F.find(".vis-Email-textarea-div").height(t(".vis-Email-ContentArea").height()-(t(".vis-form-horizontal").height()+30)):F.find(".vis-Email-textarea-div").height(t(".vis-Email-ContentArea").height()-(t(".vis-form-horizontal").height()+50))),0==D.length&&(F.find(".vis-email-attachmentContainer").hide(),F.find(".vis-email-attachmentContainer").height(90),F.find(".vis-attach-content-wrap").height(83),R?F.find(".vis-Email-textarea-div").height(t(".vis-Email-ContentArea").height()-(t(".vis-form-horizontal").height()+30)):F.find(".vis-Email-textarea-div").height(t(".vis-Email-ContentArea").height()-(t(".vis-form-horizontal").height()+50))),xe--}));var p=t("<div class='vis-attach-file-content'>");r.append(p);var u=t("<div class='vis-attach-file-icon'>"),g=Xe(Ce.name);u.append(t("<img src='"+g+"'>")),p.append(u);var h=t("<div class='vis-attach-file-text' style='margin-bottom:10px'>"),v="",f=t("<p>");if(Ce.name.length>17){v=Ce.name.toString().substr(0,17),f.append(v);var m=t("<a href='javascript:void(0)' class='VIS_Pref_tooltip'>").append("..."),y=t("<span style='width: inherit;'>");y.append(t("<img class='VIS_Pref_callout'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/email-ccc.png").append("ToolTip Text")),y.append(t("<label class='VIS_Pref_Label_Font'>").append(Ce.name)),m.append(y),f.append(m)}else f.append(Ce.name);h.append(f),h.append(t("<p>").append((Number(Ce.size)/1024).toFixed(2)+"KB")),p.append(h),o.Name=Ce.name,o.Size=Ce.size,D.push(Ce),Ye()&&90==F.find(".vis-email-attachmentContainer").height()&&(F.find(".vis-email-attachmentContainer").height(155),F.find(".vis-attach-content-wrap").height(145))}}}if($e&&$e.length>0){var I="";for(var b in $e)I+=$e[b].toString()+", ";var C="";1==$e.length?C+="FileInvalidExtension":C+="FilesInvalidExtension",e.ADialog.warn(C,!0,I)}};function Ye(){return!(w.children(0).height()<75)}var Xe=function(t){if(null==t||0==t.length)return"";var i=t.lastIndexOf("."),n=e.Application.contextUrl+"Areas/VIS/Images/";if(i<1)return n+="defult.png";var a=t.substr(i,t.length-i);return n+=".xlsx"==a||".xls"==a?"excel.png":".html"==a||".htm"==a?"html.png":".pdf"==a?"pdf.png":".ppt"==a?"ppt.png":".txt"==a?"text.png":".docx"==a||".doc"==a?"word.png":".xml"==a?"xml.png":"defult.png"},Ze=function(){var e=null,t=0,i=0;for(var n in Ve=0,D)t=parseInt(D[n].size/Te),Ce.size%Te>0&&t++,Ve+=t,i+=D[n].size,e={},P.push(D[n].name),e.Name=D[n].name,e.Size=D[n].size,Me.push(e);i>25165824||(Je(!0),et())},et=function(){if(null!=D&&0!=D.length||(Je(!1),F.find(".vis-email-attachmentContainer").hide(),F.find(".vis-Email-textarea-div").height(F.find(".vis-Email-textarea-div").height()+(F.find(".vis-email-attachmentContainer").height()+13)),window.setTimeout((function(){e.ADialog.info("NothingToUpload")}),2)),xe>=D.length)Je(!1);else{var t=new XMLHttpRequest,i=new FormData;i.append("file",D[xe].slice(Ne*Te,Ne*Te+Number(Te))),t.open("POST",e.Application.contextUrl+"Email/SaveAttachmentinTemp?filename="+D[xe].name+"&folderKey="+Ae,!1),t.onload=function(){if(t.readyState===t.DONE&&200===t.status){if(t.responseText&&t.responseText.indexOf("ERROR")>-1){var i=t.responseText;for(var n in i=i.replace("ERROR: ",""),D)String(i).indexOf(D[n].name)>-1&&D.splice(n,1);return e.ADialog.warn("FilesInvalidExtension",!0,t.responseText),Je(!1),void IsBusy(!1)}i=(i=t.responseText).replace("ERROR: ",""),Se++,Ne++;var a=parseInt(D[xe].size/Te);D[xe].size%Te>0&&a++,Ne==a&&(xe++,Ne=0),Se<=Ve&&tt(parseInt(Se/Ve*100)),window.setTimeout((function(){et()}),2)}},t.send(i)}},tt=function(e){we.css("width",e+"%"),be.empty(),be.append(e+"%")};function it(e){this.checked?(40!=B.width()&&B.find("ul").show(),1==l&&0==a.singleRow&&m.length>1&&(Q.val(""),Q.prop("disabled",!0),$.val(""),$.prop("disabled",!0),J.val(""),J.prop("disabled",!0)),ye=!0):(40!=B.width()&&ze(),1==l&&0==a.singleRow&&m.length>1&&0==Re.prop("checked")&&(Q.prop("disabled",!1),$.prop("disabled",!1),J.prop("disabled",!1)),ye=!1,ue.css("border-bottom","none"),R||_e.css("display","none"))}function nt(e){this.checked?(Ee.parent().show(),1==l&&0==a.singleRow&&m.length>1&&(Q.val(""),Q.prop("disabled",!0),$.val(""),$.prop("disabled",!0),J.val(""),J.prop("disabled",!0))):(Ee.parent().hide(),1==l&&0==a.singleRow&&m.length>1&&0==z.prop("checked")&&(Q.prop("disabled",!1),$.prop("disabled",!1),J.prop("disabled",!1)))}function at(e){ee.paste("@@"+t(this).text()+"@@")}function st(i){var s=ee.value(),l="";l=0==a.singleRow||m.length>0?function(t,i){var s=t,l=t;for(;l.indexOf("@@")>-1;){var o=(l=l.substring(l.indexOf("@@")+2)).substring(0,l.indexOf("@@")),r=null,d=Object.keys(a.getColumnNames()).filter((function(e){return a.getColumnNames()[e]===o}))[0];if(null!=d&&null!=d)if(e.DisplayType.IsLookup(n.getField(d).getDisplayType())||e.DisplayType.Location==n.getField(d).getDisplayType())null!=m[i][d.toLower()]&&null!=m[i][d.toLower()]&&(r=n.getField(d.toLower()).lookup.getDisplay(m[i][d.toLower()]));else if(e.DisplayType.IsDate(n.getField(d).getDisplayType())){var c=n.getField(d).getDisplayType();r=n.getField(d).value,r=e.DisplayType.Date==c?new Date(r).toLocaleDateString():e.DisplayType.Time==c?new Date(r).toLocaleTimeString():new Date(r).toLocaleString()}else r=m[i][d.toLower()];l=l.substring(l.indexOf("@@")+2),s=null!=r&&null!=r?s.replace("@@"+o+"@@",r):s.replace("@@"+o+"@@","")}return s}(s,0):function(t){var i=t;for(;i.indexOf("@@")>-1;){var s=(i=i.substring(i.indexOf("@@")+2)).substring(0,i.indexOf("@@")),l=null,o=Object.keys(a.getColumnNames()).filter((function(e){return a.getColumnNames()[e]===s}))[0];if(null!=o&&null!=o)if(e.DisplayType.IsLookup(n.getField(o).getDisplayType())||e.DisplayType.Location==n.getField(o).getDisplayType())l=null!=y[o.toLower()]&&null!=y[o.toLower()]?n.getField(o.toLower()).lookup.getDisplay(y[o.toLower()]):"";else if(e.DisplayType.IsDate(n.getField(o).getDisplayType())){var r=n.getField(o).getDisplayType();l=n.getField(o).value,l=e.DisplayType.Date==r?new Date(l).toLocaleDateString():e.DisplayType.Time==r?new Date(l).toLocaleTimeString():new Date(l).toLocaleString()}else 1==a.singleRow&&0==m.length?null==(l=n.getField(o).value)&&(l=""):l=y[o.toLower()];i=i.substring(i.indexOf("@@")+2),t=t.replace("@@"+s+"@@",l)}return t}(s);var o=t("<div></div>");o.append(l),t(o.find("table")).css({width:"100%",border:"1px solid Black"}),t(o.find("td")).css({border:"1px solid Black"});var r=new e.ChildDialog;r.setHeight(420),r.setWidth(850),r.setTitle(e.Msg.getMsg("Preview")),r.setModal(!0),r.setContent(o),r.show(),r.hidebuttons()}function lt(t){var i=X.val(),n=ee.value(),a=!0;return null!=i&&""!=i&&0!=i.trim().length||null!=n&&""!=n&&0!=n.trim().length?null==i||""==i||0==i.trim().length?(a=!1,void e.ADialog.confirm("SendWithoutSubject",!0,"","Confirm",(function(e){e&&ot(t,i,n)}))):null==n||""==n||0==n.trim().length?(a=!1,void e.ADialog.confirm("SendWithoutBody",!0,"","Confirm",(function(e){e&&ot(t,i,n)}))):void(a&&ot(t,i,n)):(a=!1,void e.ADialog.confirm("SendWithoutSubjectandBody",!0,"","Confirm",(function(e){e&&ot(t,i,n)})))}function ot(i,l,o){k=!1;var r=Q.val(),d=J.val(),c=$.val();if(r.trim().length>0)if(r.contains(";")){for(var p=r.split(";"),u=0;u<p.length;u++)if(null!=p[u]&&""!=p[u]){if(!rt(p[u].trim()))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+p[u])}),2);k=!0}}else{if(!rt(r.trim()))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+r)}),2);k=!0}if(c.trim().length>0)if(c.contains(";")){for(p=c.split(";"),u=0;u<p.length;u++)if(null!=p[u]&&""!=p[u]){if(!rt(p[u].trim()))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+p[u])}),2);k=!0}}else{if(!rt(c.trim()))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+c)}),2);k=!0}if(d.trim().length>0)if(d.contains(";")){for(p=d.split(";"),u=0;u<p.length;u++)if(null!=p[u]&&""!=p[u]){if(!rt(p[u].trim()))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+p[u])}),2);k=!0}}else{if(!rt(d.trim()))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+d)}),2);k=!0}var g=[];if(0==z.prop("checked")&&0==Re.prop("checked")){var v=!1,f={};if(f.To=r,f.Cc=c,f.Bcc=[],d.contains(";"))for(p=d.split(";"),u=0;u<p.length;u++)null!=p[u]&&""!=p[u]&&f.Bcc.push(p[u]);else null!=d&&""!=d&&f.Bcc.push(d);if(null!=H&&null!=H&&(L=[],t("[id*=CheckBoxList1]:checked").each((function(){L.push(t(this).val())})),L.length>0))for(var I=0;I<L.length;I++){if(!rt(L[I]))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+L[I])}),2);v=!0,f.Bcc.push(L[I])}if(f.Subject=l,f.TableID=O,f.Recordids="",null!=y)if(0==a.singleRow||m.length>0){for(var D="",w=0;w<m.length;w++)D+=m[w][n.keyColumnName.toLower()]+",";f.Recordids=D}else s>0?f.Recordids=s:1==a.singleRow?f.Recordids=n.getField(n.keyColumnName.toLower()).value:f.Recordids=y[n.keyColumnName.toLower()];else s>0&&(f.Recordids=s);if(f.AttachmentFolder=Ae,!v&&!k)return void window.setTimeout((function(){e.ADialog.info("NoEmailAddressFound")}),2);g.push(f)}else{L=[];var _=[],S=[];if(t("[id*=CheckBoxList1]:checked").each((function(){L.push(t(this).val()),_.push(t(this).data("recid")),S.push(t(this).data("currentrec"))})),L.length>0){for(I=0;I<L.length;I++)if(!rt(L[I]))return void window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+L[I])}),2);for(var x=0;x<L.length;x++)if(1==a.singleRow&&0==m.length){if(null==(A=bt(y,0))||null==A)return;g.push(A)}else for(w=0;w<m.length;w++)if(_[x]==m[w][n.getKeyColumnName().toLower()]){var A=null;if(null==(A="N"==S[x]?bt(m[w],w,L[x]):bt(m[w],w))||null==A)continue;g.push(A)}}else if(k)if(1==a.singleRow&&0==m.length){if(null==(A=bt(y,0))||null==A)return;g.push(A)}else for(w=0;w<m.length;w++){null!=(A=bt(m[w],w))&&null!=A&&g.push(A)}}if(0!=g.length){var T=JSON.stringify(g),V=!1,N="X";Re.prop("checked")&&(N=Ee.val()),e.ADialog.confirm("WantAlertMessage",!0,"","Confirm",(function(i){i&&(V=!0),C[0].style.visibility="visible";var a={mails:e.Utility.encodeText(T),AD_User_ID:h.getAD_User_ID(),AD_Client_ID:h.getAD_Client_ID(),AD_Org_ID:h.getAD_Org_ID(),attachment_ID:b,fileNamesFornNewAttach:JSON.stringify(P),fileNamesForopenFormat:JSON.stringify(E),mailFormat:e.Utility.encodeText(ee.value()),notify:V,strDocAttach:e.context.getContext("DocumentAttachViaEmail_"+re.windowNo),AD_Process_ID:null!=n?n.getAD_Process_ID():0,printformatfileType:N};t.ajax({url:e.Application.contextUrl+"Email/SendMail",data:a,datatype:"json",type:"post",cache:!1,async:!0,success:function(t){C[0].style.visibility="hidden";var i=JSON.parse(t);""==i?(re.dispose(),re=null,null!=fe&&fe.dispose(),fe=null):window.setTimeout((function(){e.ADialog.info(i),i.contains("MailSent")&&e.context.setContext("DocumentAttachViaEmail_"+re.windowNo,"")}),2)}})}))}else window.setTimeout((function(){e.ADialog.info("NoEmailAddressFound")}),2)}function rt(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function dt(i){var l=X.val();if(null!=l&&""!=l&&0!=l.trim().length){var o=ee.value();if(!(null==o||""==o||null==o||o.trim().length<1)){var r={};if(m=a.getSelectedRows(),y=n.getRecords()[n.getCurrentRow()],0==a.singleRow||m.length>0)for(var d=0;d<m.length;d++)r[m[d][n.keyColumnName.toLower()]]=Ct(o,d);else s>0?r[s]=_t(o):r[y[n.keyColumnName.toLower()]]=_t(o);C[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Email/SaveAttachment",datatype:"json",type:"post",cache:!1,data:{subject:l,AD_Table_ID:O,html:e.Utility.encodeText(o),values:JSON.stringify(r)},success:function(t){C[0].style.visibility="hidden",e.ADialog.info("Saved")},error:function(e){console.log(e)}})}}else e.ADialog.info("PleaseAddSubject")}function ct(i){var s=ee.value();if(!(null==s||""==s||null==s||s.trim().length<1)){var l=[];if(m=a.getSelectedRows(),y=n.getRecords()[n.getCurrentRow()],0==a.singleRow||m.length>0)for(var o=0;o<m.length;o++)l.push(Ct(s,o));else l.push(_t(s));C[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Email/InsertAttachmentText",datatype:"json",type:"post",cache:!1,data:{html:e.Utility.encodeText(s),values:JSON.stringify(l)},success:function(t){C[0].style.visibility="hidden";var i=JSON.parse(t),n=i;window.open(e.Application.contextUrl+n)}})}}var pt=0;function ut(t){ht=!1,pt=0,1==Le?""==ee.value()&&""==X.val()||e.ADialog.confirm("DoYouWantToSave",!0,"","Confirm",(function(e){e?(yt(t),Le=0,pt=1):(X.val(""),ee.value(""),I=0,le.css("opacity","1"),Le=0)})):(X.val(""),ee.value(""),I=0,le.css("opacity","1"),Le=0)}var gt=h.getAD_Client_ID(),ht=!1,vt=0;function ft(t){var i=0;vt=0;var n=new e.Openmailformat(a.gTab.getAD_Window_ID(),l);n,l||(pt=0,""!=ee.value()&&""!=X.val()&&1==Le&&(e.ADialog.confirm("DoYouWantToSave",!0,"","Confirm",(function(e){e?(yt(t),vt=1,ht=!0):(I=0,le.css("opacity","1"),Le=0,n.show())})),i=1)),0==i&&n.show(),n.onClose=function(){Le=0;var e=n.getSelectedRow();null!=e&&null!=e&&(I=e.AD_TEXTTEMPLATE_ID,gt=e.AD_CLIENT_ID,X.val(e.SUBJECT),gt!=h.getAD_Client_ID()?le.css("opacity","0.4"):le.css("opacity","1"),"Y"==e.ISDYNAMICCONTENT?z.prop("checked",!1).trigger("click"):z.prop("checked",!0).trigger("click"),g=!(null!=e.AD_Window_ID&&null!=e.AD_Window_ID&&e.AD_Window_ID>0),u=e.NAME,ee.value(e.MAILTEXT)),ht=!1}}function mt(t){var i=ee.value();if(null!=i&&""!=i.trim()&&null!=i){var n=new e.Newmailformat(l);n.show(),n.onClose=function(){u=n.getName(),g=n.saveForAll(),Dt(0)}}}function yt(e){if(gt==h.getAD_Client_ID()){var t=ee.value();null!=t&&""!=t&&null!=t&&(I>0?Dt(I):mt())}}function It(e){H.empty(),Be(!0),je(!0)}function Dt(i){var a={id:i,AD_Client_ID:h.getAD_Client_ID(),AD_Org_ID:h.getAD_Org_ID(),name:e.Utility.encodeText(u),isDynamic:z.prop("checked"),subject:e.Utility.encodeText(X.val()),text:e.Utility.encodeText(ee.value()),saveforAll:g,AD_Window_ID:n.getAD_Window_ID(),folderName:Ae,attachmentID:b};t.ajax({type:"POST",url:e.Application.contextUrl+"Email/SaveFormats",data:a,success:function(e){I=parseInt(e),gt=h.getAD_Client_ID(),le.css("opacity","1"),Le=0,l||(1==pt&&(X.val(""),ee.value("")),1==ht&&window.setTimeout((function(){1==vt&&(ft(),ht=!1)}),200))}})}function wt(e){J.is(":visible")?(J.hide(),$.hide(),F.find(".vis-email-attachmentContainer").is(":visible")?F.find(".vis-Email-textarea-div").height(F.height()-365):F.find(".vis-Email-textarea-div").height(F.height()-180)):(J.show(),$.show(),F.find(".vis-email-attachmentContainer").is(":visible")?F.find(".vis-Email-textarea-div").height(F.height()-440):F.find(".vis-Email-textarea-div").height(F.height()-255))}function bt(t,i,l){var o=!1,r={};if(r.To=Q.val(),r.Cc=$.val(),r.Bcc=[],J.val().contains(";")){var d=J.val().split(";");for(i=0;i<d.length;i++)null!=d[i]&&""!=d[i]&&r.Bcc.push(d[i])}else null!=J.val()&&""!=J.val()&&r.Bcc.push(J.val());if(l)rt(l)||window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+l)}),2),r.Bcc.push(l),o=!0;else if(null!=H&&null!=H)if(Object.keys(t).indexOf("email")>-1&&L.indexOf(t.email)>-1)rt(t.email)||window.setTimeout((function(){e.ADialog.info("NotValidEmail",!0,":"+t.email)}),2),r.Bcc.push(t.email),o=!0;else if(0==!a.singleRow&&1==m.length);else if(0==!a.singleRow||m.length>1)return;var c=X.val();if(0==c.trim().length&&(c="  "),r.Subject=c,r.TableID=O,1==a.singleRow&&0==m.length?r.Recordids=s:r.Recordids=t[n.keyColumnName.toLower()],0==a.singleRow?r.Body=Ct(ee.value(),i):r.Body=_t(ee.value()),r.AttachmentFolder=Ae,1!=a.singleRow&&1!=m.length||o||k)return r}function Ct(t,i){for(var s=t,l={};s.indexOf("@@")>-1;){var o=(s=s.substring(s.indexOf("@@")+2)).substring(0,s.indexOf("@@")),r=null,d=Object.keys(a.getColumnNames()).filter((function(e){return a.getColumnNames()[e]===o}))[0];if(null!=d&&null!=d)if(e.DisplayType.IsLookup(n.getField(d).getDisplayType())||e.DisplayType.Location==n.getField(d).getDisplayType())null!=m[i][d.toLower()]&&null!=m[i][d.toLower()]&&(r=n.getField(d.toLower()).lookup.getDisplay(m[i][d.toLower()]));else if(e.DisplayType.IsDate(n.getField(d).getDisplayType())){var c=n.getField(d).getDisplayType();r=n.getField(d).value,r=e.DisplayType.Date==c?new Date(r).toLocaleDateString():e.DisplayType.Time==c?new Date(r).toLocaleTimeString():new Date(r).toLocaleString()}else r=m[i][d.toLower()];s=s.substring(s.indexOf("@@")+2),l["@@"+o+"@@"]=r}return l}function _t(t){for(var i=t,s={};i.indexOf("@@")>-1;){var l=(i=i.substring(i.indexOf("@@")+2)).substring(0,i.indexOf("@@")),o=null,r=Object.keys(a.getColumnNames()).filter((function(e){return a.getColumnNames()[e]===l}))[0];if(null!=r&&null!=r)if(e.DisplayType.IsLookup(n.getField(r).getDisplayType())||e.DisplayType.Location==n.getField(r).getDisplayType())m.length>0&&null!=m[0][r.toLower()]&&null!=m[0][r.toLower()]?o=n.getField(r.toLower()).lookup.getDisplay(m[0][r.toLower()]):null!=y[r.toLower()]&&null!=y[r.toLower()]&&(o=n.getField(r.toLower()).lookup.getDisplay(y[r.toLower()]));else if(e.DisplayType.IsDate(n.getField(r).getDisplayType())){var d=n.getField(r).getDisplayType();o=n.getField(r).value,o=e.DisplayType.Date==d?new Date(o).toLocaleDateString():e.DisplayType.Time==d?new Date(o).toLocaleTimeString():new Date(o).toLocaleString()}else o=1==a.singleRow&&0==m.length?n.getField(r).value:m&&m.length>0?m[0][r.toLower()]:y[r.toLower()];i=i.substring(i.indexOf("@@")+2),s["@@"+l+"@@"]=o}return s}function St(){var e=0;F.height(de),F.width(ce),F.find(".contentArea").css("height",F.height()-42),F.find(".vis-Email-BccList").height(1),F.find(".vis-email-leftDiv").height(F.find(".contentArea").height()),R?(F.find(".vis-email-attachmentContainer").is(":visible")?F.find(".vis-Email-textarea-div").height(F.height()-345):F.find(".vis-Email-textarea-div").height(F.height()-180),F.find(".vis-form-data-sub").width(F.find(".vis-Email-leftWrap").width()-85),e=F.width()-40):l?(F.find(".vis-email-attachmentContainer").is(":visible")?F.find(".vis-Email-textarea-div").height(F.height()-(F.find(".vis-email-attachmentContainer").height()+150)):F.find(".vis-Email-textarea-div").height(F.height()-(F.find(".vis-email-attachmentContainer").height()+70)),e=ce-(F.find(".vis-email-leftDiv").width()+30),F.find(".vis-Email-leftWrap").width(e-355),F.find(".vis-form-data-sub").width(F.find(".vis-Email-leftWrap").width()-45)):(F.find(".vis-Email-textarea-div").height(F.height()-155),e=ce-(F.find(".vis-email-leftDiv").width()+30),F.find(".vis-Email-leftWrap").width(e-15),F.find(".vis-form-data-sub").width(e-40)),null!=W&&W.css("width",e-10),null!=ee&&null!=ee&&(ee.body.style.width=e-370+"px"),R||(window.VADMS?F.find(".vis-Email-BccList").height(F.find(".vis-Email-rytContent").height()-(F.find(".vis-Email-rytForm").height()+310)):F.find(".vis-Email-BccList").height(F.find(".vis-Email-rytContent").height()-(F.find(".vis-Email-rytForm").height()+70)))}this.showCcBccMails=function(e,t){null!=e&&null!=e&&""!=e&&(Pe=e),null!=t&&null!=t&&""!=t&&(Ue=t)},this.show=function(){(v=new e.ChildDialog).setHeight(800),v.setWidth(1600),v.setTitle(e.Msg.getMsg("EMail")),v.setModal(!0),v.show(),v.setContent(F),initializeComponent()},this.disposeComponent=function(){h=null,v=null,f="",O=0,L=null,R||(null!=ae&&ae.off("click"),null!=ie&&ie.off("click"),null!=le&&le.off("click"),null!=se&&se.off("click"),null!=q&&q.off("click"),null!=U&&U.remove(),null!=q&&q.remove(),null!=H&&H.remove(),null!=z&&z.remove(),null!=Z&&Z.remove()),null!=ne&&ne.off("click"),null!=ke&&null!=ke&&(ke.off("change"),ke.off("click")),U=null,null!=F&&F.remove(),F=null,null!=B&&B.remove(),B=null,null!=W&&W.remove(),W=null,null!=j&&j.remove(),j=null,q=null,H=null,z=null,l&&(null!=Q&&Q.remove(),Q=null,null!=J&&J.remove(),J=null,null!=$&&$.remove(),$=null),null!=X&&X.remove(),X=null,Z=null,null!=ee&&null!=ee&&ee.destroy(),ee=null,null!=te&&te.remove(),te=null,ie=null,ne=null,null,ae=null,le=null,se=null,null!=Re&&(Re.off("click"),Re=null),null!=Ee&&(Ee=null)},this.sizeChanged=function(e,t){de=e,ce=t,1==me&&(St(),this.leftULsize())},this.ShowDMSDocumentAttchment=function(){var i=null,n=null;G.children().remove();var a=t("<ul></ul>");if(""!=e.context.getContext("DocumentAttachViaEmail_"+re.windowNo)){Oe.empty(),Oe.append(e.Msg.getMsg("Documents")),i=e.context.getContext("DocumentAttachViaEmail_"+re.windowNo).split(",");for(var s=0;s<i.length;s++)""!=i[s].trim()&&(n=i[s].split("-"),a.append("<Li><input type='checkbox' checked value='"+n[0]+"'> "+n[1]+"</Li>"));G.append(a)}else Oe.empty();a.on("click","input",(function(){var i="",n=t(this).attr("value");if(t(this).is(":checked")){if(t(this).is(":checked")){var a=n+"-"+t(this).text();i=e.context.getContext("DocumentAttachViaEmail_"+re.windowNo),i+=""!=i?","+a:a}}else for(var s=e.context.getContext("DocumentAttachViaEmail_"+re.windowNo).split(","),l=jQuery.grep(s,(function(e){if(!e.trim().contains(n.toString().trim()))return e})),o=0;o<l.length;o++)i+=0==o?l[o].trim():","+l[o].trim();e.context.setContext("DocumentAttachViaEmail_"+re.windowNo,i)}))},this.IsBusy=function(e){e?he.css("display","block"):he.css("display","none"),he.appendTo(F)}}i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,t.hideHeader(!0),this.initializeComponent(),this.frame.getContentGrid().append(this.getRoot())},i.prototype.refresh=function(){window.VADMS&&this.ShowDMSDocumentAttchment(),this.leftULsize()},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Email=i}(VIS,jQuery)},7053:()=>{!function(e,t){var i=e.Application.contextUrl+"JsonData/ExecuteNonQuer",n={alreadyExist:!1,id:0,getData:function(t,i,n,a){t.getAD_Client_ID();var s=null;try{s=e.dataContext.getJSONData(e.Application.contextUrl+"ASearch/GetData",{ColumnName:a,Tab_ID:i,Table_ID:n},null)}catch(e){console.log(e)}return s},getQueryLines:function(t){var i=null,n=[];try{i=e.dataContext.getJSONData(e.Application.contextUrl+"ASearch/GetQueryLines",{UserQuery_ID:t},null);var a="",s="";if(null!=i)for(var l in i){var o={};o.KEYNAME=i[l].KEYNAME,o.KEYVALUE=i[l].KEYVALUE,o.OPERATORNAME=i[l].OPERATORNAME,o.VALUE1NAME=i[l].VALUE1NAME,o.VALUE1VALUE=i[l].VALUE1VALUE,o.VALUE2NAME=i[l].VALUE2NAME,o.VALUE2VALUE=i[l].VALUE2VALUE,o.AD_USERQUERYLINE_ID=i[l].AD_USERQUERYLINE_ID,o.FULLDAY=i[l].FULLDAY,a=i[l].OPERATORNAME,s=e.Query.prototype.OPERATORS[a],o.OPERATOR=s,n.push(o)}}catch(e){}return n},deleteLines:function(n){var a=[];return a[0]=new e.DB.SqlParam("@AD_UserQuery_ID",n),function(e,n,a){var s=!!a,l=null,o={sql:e,param:n};return t.ajax({url:i+"yWithCode",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:s,data:JSON.stringify(o)}).done((function(e){l=e,a&&a(e)})),l}("VIS_147",a,null)>=0},deleteUserQuery:function(i){var n=-1;return t.ajax({url:e.Application.contextUrl+"ASearch/DeleteQuery",type:"POST",datatype:"json",async:!1,data:{id:i}}).done((function(e){n=parseInt(e)})),n>=0},insertOrUpdate:function(i,a,s,l,o,r,d){var c=-1;return s&&(s=e.secureEngine.encrypt(s)),t.ajax({url:e.Application.contextUrl+"ASearch/InsertOrUpdateQuery",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({id:i,name:a,where:s,tabid:l,tid:o,qLines:r})}).done((function(e){-5==(c=parseInt(e))&&(n.alreadyExist=!0)})),c>0&&(n.id=c),c>=0}};function a(i,a,s){a.getName();var l=a.getAD_Tab_ID(),o=a.getAD_Table_ID(),r=a.getTableName(),d=a.getWhereClause(),c=a.getFields();this.btnfields=[];var p,u,g,h,v,f,m,y,I,D,w,b,C,_,S,x,A,T,V,N,M,k,O,L,R,E,P,U,F,B,W=t("<div  class='vis-forms-container' style='height:100%'>"),j=null,G=this,q=null,H=0,z=!1,Q=null,J=e.Logging.VLogger.getVLogger("Find");this.onClose=null,this.created=!1,this.days=0,this.okPressed=!1,this.okBtnPressed=!1,this.needRefreshWindow=!1;var $,K,Y="";this.saveQueryID=-1;var X,Z=!1,ee=0,te=new e.Query(r);function ie(){y[0].selectedIndex=0,I[0].selectedIndex=0,be(),be(!0),ce(!1),de(!0),w.prop("checked",!1),x.prop("checked",!1),N.hide(),W.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 100px)")}function ne(e){if(G.saveQueryID=e,Z=!1,e&&"-1"!=e){ge(Q=n.getQueryLines(e)),f.val(m.find("option:selected").text()),f.prop("readonly",!1),pe(g,!0)}else pe(g,!1),f.val(""),f.prop("readonly",!0),Q=null,ge(null)}function ae(t){var i="",n="";if(null!=t)for(var a in t){var s=e.Utility.encodeText(t[a].Name),l=s;s.length>25&&(s=s.substr(0,25)+"..."),i+='<li data-value="'+t[a].Code+'" title="'+l+'">'+s+"</li>",n+='<option value="'+t[a].AD_UserQuery_ID+'" title="'+l+'">'+s+"</option>"}i.length>0&&V.append(i),m.html("<option value='-1' > </option>"+n)}function se(e){var t=D[0].selectedIndex;if(e)return M.hide(),k.hide(),void O.hide();M.show(),k.show(),w.is(":checked")?O.show():O.hide(),_.prop("readonly",!1),C.prop("min",1),3==t||6==t?(C.prop("min",0),_.val(0),C.val(0),b.val(1)):2==t||5==t?(M.hide(),b.val(""),C.val(1),_.val(0)):1==t||4==t?(M.hide(),k.hide(),_.val(0)):0==t&&(_.prop("readonly",!0),M.hide(),k.hide(),_.val(0))}function le(e){var t=0;if(3==e||6==e){var i=b.val(),n=C.val(),a=_.val();t=365*(i=i&&""!=i?parseInt(i):0)+31*(n=n&&""!=n?parseInt(n):0)+(a=a&&""!=a?parseInt(a):0)}else if(2==e||5==e){n=C.val(),a=_.val();t=31*(n=n&&""!=n?parseInt(n):0)+(a=a&&""!=a?parseInt(a):0)}else{t=a=(a=a=_.val())&&""!=a?parseInt(a):0}return t}function oe(e){var i=L.children()[1],n=null;L.children().length>2&&(n=L.children()[2]),n?t(n).prop("disabled",!e).prop("readonly",!e):null!=i&&t(i).prop("disabled",!e).prop("readonly",!e)}function re(e){var i=R.children()[1],n=null;R.children().length>2&&(n=R.children()[2]),n?t(n).prop("disabled",!e).prop("readonly",!e):null!=i&&t(i).prop("disabled",!e).prop("readonly",!e)}function de(e){R.css("display",e?"block":"none")}function ce(e){U.css("display",e?"flex":"none")}function pe(e,t){e.prop("disabled",!t)}function ue(i,n){i&&($=null),K=null;var a=null,s=null;i?(a=L.children()[1],L.children().length>2&&(s=L.children()[2])):(a=R.children()[1],R.children().length>2&&(s=R.children()[2])),null!=a&&(t(a).remove(),null!=s&&t(s).remove(),a=null);var l=null;if(null!=(l=null!=n?n.getIsKey()?new e.Controls.VNumTextBox(n.getColumnName(),!1,!1,!0,n.getDisplayLength(),n.getFieldLength(),n.getColumnName()):e.VControlFactory.getControl(null,n,!0,!0,!1):new e.Controls.VTextBox("columnName",!1,!0,!1,20,20,"format","GetObscureType",!1))){l.setReadOnly(!1),n.getDisplayType()==e.DisplayType.AmtDimension&&(l.hideButton(!1),l.setReadOnlyTextbox(!1)),e.DisplayType.Text==n.getDisplayType()||e.DisplayType.TextLong==n.getDisplayType()?(l.getControl().attr("rows","1"),l.getControl().css("width","100%")):e.DisplayType.YesNo==n.getDisplayType()?l.getControl().css("clear","both"):e.DisplayType.IsDate(n.getDisplayType())&&l.getControl().css("line-height","1");var o=null;l.getBtnCount()>0&&!(l instanceof e.Controls.VComboBox)&&(o=l.getBtn(0)),i?(L.append(l.getControl()),$=l,o&&(L.append(o),l.getControl().css("width","calc(100% - 30px)"),o.css("max-width","30px"))):(R.append(l.getControl()),K=l,o&&(R.append(o),l.getControl().css("width","calc(100% - 30px)"),o.css("max-width","30px"))),n.getDisplayType()==e.DisplayType.AmtDimension&&l.getControl().css("width","100%")}}function ge(e){P.empty();var t="",i="",n=null;if(e)for(var a=0,s=e.length;a<s;a++)i='<tr class="vis-advancedSearchTableRow">',i+="<td>"+(n=e[a]).KEYNAME+'</td><td style="display:none">'+n.KEYVALUE+"</td><td>"+n.OPERATORNAME+"</td><td>"+n.VALUE1NAME+'</td><td style="display:none">'+n.VALUE1VALUE+"</td><td>"+n.VALUE2NAME+'</td><td style="display:none">'+n.VALUE2VALUE+"</td><td>"+n.FULLDAY+'</td><td style="display:none">'+n.AD_USERQUERYLINE_ID+'</td><td style="display:none">'+n.OPERATOR+'</td><td><i style="cursor:pointer" data-userQuery="'+n.AD_USERQUERYLINE_ID+'" data-index = "'+a+'" class="vis vis-delete"></i></td>',t+=i+="</tr>";P.html(t)}function he(t,n){var a=r,s=!1;null!=d&&d.length>0&&(-1==d.indexOf("@")?a+=" WHERE "+d:a+=" WHERE "+e.Env.parseContext(e.context,i,d,!1),s=!0),null!=t&&t.getIsActive()&&(a+=s?" AND ":" WHERE ",a+=e.Env.parseContext(e.context,i,t.getWhereClause(!0),!1));var l=e.MRole.getDefault().addAccessSQL("SELECT COUNT(*) FROM "+a.toString(),r,e.MRole.SQL_NOTQUALIFIED,e.MRole.SQL_RO);H=999999;try{var o=e.secureEngine.encrypt(l);H=e.dataContext.getJSONData(e.Application.contextUrl+"ASearch/GetNoOfRecrds",{RecQuery:o},null)}catch(t){J.Log(e.Level.SEVERE,l,t)}var c=e.MRole.getDefault();return G.okPressed=!1,0==H||null==H?(H=0,n&&e.ADialog.info("FindZeroRecords",!0,"")):null!=t&&c.getIsQueryMax(H)?e.ADialog.error("FindOverMax",!0,H+" > "+c.getMaxQueryRecords()):G.okPressed=!0,H}function ve(e){var t=" "+e+" / "+H+" ";S.text(t),H<s&&!0}function fe(e){if(null==e||0==e.length)return null;for(var t=0;t<c.length;t++){var i=c[t];if(e.equals(i.getColumnName()))return i}return null}function me(){var e=y.val();if(!e||"-1"==e)return a=-1,!1;var i,n=y.find("option:selected").text(),a="";if(null==n||0==n.trim().length)return!1;if(a=e.toString(),Z=!0,w.prop("checked"))if(O.is(":visible")||M.is(":visible")||O.is(":visible")){var s=">=",l=" >= ",o=3==(i=D[0].selectedIndex)||6==i?"Last "+Math.round(le(i)/365,1).toString()+" Years":2==i||5==i?"Last "+Math.round(le(i)/31,1).toString()+" Month":0!=le()?"Last "+le()+" Days":"This Day",r=function(e){return" adddays(sysdate, - "+le(e)+") "}(D[0].selectedIndex);we(n,a,l,s,o,r,null,null,De())}else{we(n,a,l=" = ",s="=",o=D.find("option:selected").text(),r=D.val(),null,null,De())}else{var d=I.val();I[0].selectedIndex>-1&&(d=D.find("option:selected").text()),we(n,a,d,I.val(),Ie(!0),ye(!0),Ie(!1),ye(!1),De())}return f.prop("readonly",!1),ie(),ee++,F&&"Y"==F.data("show")&&(F.data("show","N"),F.hide(),A.show(),T.hide(),t(".vis-adsearchgroup2").hide(),t(".vis-adsearchgroup1").show()),!0}function ye(t){var i=null;return null!=(i=t?$:K)?i.getDisplayType()==e.DisplayType.YesNo?"true"==i.getValue().toString().toLowerCase()?"Y":"N":i.displayType==e.DisplayType.AmtDimension?i.getText():i.getValue():""}function Ie(t){var i=null;return null!=(i=t?$:K)?i.displayType==e.DisplayType.AmtDimension?i.getText():i.getDisplay():""}function De(){if(x)return x.is(":checked")?"Y":"N"}function we(t,i,n,a,s,l,o,r,d){null==Q&&(Q=[]);var c={};c.KEYNAME=t,c.KEYVALUE=i,c.OPERATORNAME=a,c.VALUE1NAME=e.Utility.encodeText(s),c.FULLDAY=d,c.VALUE1VALUE=""==s?"":null==l?"NULL":e.Utility.encodeText(e.Utility.Util.getValueOfString(l)),c.VALUE2NAME=e.Utility.encodeText(o),c.VALUE2VALUE=null==r?"NULL":e.Utility.encodeText(e.Utility.Util.getValueOfString(r)),c.AD_USERQUERYLINE_ID=0,c.OPERATOR=n,Q.push(c),ge(Q)}function be(e){var t=null;null!=(t=e?K:$)&&t.setValue(null)}function Ce(){var t=new e.Query(r);if(Q)for(var n=0;n<Q.length;n++){var a=Q[n],s=a.KEYNAME.toString(),l=a.KEYVALUE.toString(),o=fe(l),d=o.getColumnSQL(),c=a.OPERATORNAME.toString(),p=a.VALUE1VALUE,u=null;null!=p&&p.toString().trim().startsWith("adddays")||p.toString().trim().startsWith("@")||(u=Se(o,p));var g=null;if(null==p||p.toString().length<1){if(e.Query.prototype.BETWEEN.equals(c))continue;u=e.Env.NULLString,g="NULL"}else g=a.VALUE1NAME.toString();var h=a.FULLDAY.toString();if(o.getIsVirtualColumn())if(d=o.vo.ColumnSQL,l=o.vo.ColumnSQL,e.Query.prototype.BETWEEN.equals(c)){if(null==(C=a.VALUE2VALUE.toString())||C.toString().trim().length<1)continue;var v=Se(o,C),f=a.VALUE2NAME.toString();if(null==v)continue;var m=_e(u,v,l,c,!0,!0);where=e.Env.parseContext(e.context,i,m,!1),t.addRestriction(m)}else{m=_e(u,v,l,c,!0,!0);where=e.Env.parseContext(e.context,i,m,!1),t.addRestriction(m)}else{var y="IsActive",I="Amount";if(o.getDisplayType()==e.DisplayType.DateTime&&e.Query.prototype.EQUAL.equals(c)&&u&&"Y"==h){var D=u.getFullYear(),w=u.getMonth(),b=u.getDate();v=new Date(D,w,b,24,0,0),u=new Date(D,w,b,0,0,0),a.VALUE2VALUE=v.toUTCString(),c=e.Query.prototype.BETWEEN}if(e.Query.prototype.BETWEEN.equals(c)){var C;if(null==(C=a.VALUE2VALUE.toString())||C.toString().trim().length<1)continue;if(o.getDisplayType()==e.DisplayType.AmtDimension){var _="SELECT C_DimAmt_ID FROM C_DimAmt WHERE "+y+"='Y' AND "+I+" "+c+p+" AND "+C;u=e.MRole.getDefault().addAccessSQL(_.toString(),"C_DimAmt",e.MRole.SQL_NOTQUALIFIED,e.MRole.SQL_RO),c=e.Query.prototype.IN}if(o.getDisplayType()==e.DisplayType.AmtDimension){m=_e(u,v,d,c,!1,!1);where=e.Env.parseContext(e.context,i,m,!1),t.addRestriction(m)}else{v=Se(o,C),f=a.VALUE2NAME.toString();if(null==v)continue;t.addRangeRestriction(d,u,v,s,g,f)}}else{if(o.getDisplayType()==e.DisplayType.AmtDimension){_="SELECT C_DimAmt_ID FROM C_DimAmt WHERE "+y+"='Y' AND "+I+" "+c+p;u=e.MRole.getDefault().addAccessSQL(_.toString(),"C_DimAmt",e.MRole.SQL_NOTQUALIFIED,e.MRole.SQL_RO),c=e.Query.prototype.IN}if(null==u&&null!=p&&(p.toString().trim().startsWith("adddays")||p.toString().trim().startsWith("@"))){m=r+"."+l+c+p;o.getDisplayType()==e.DisplayType.AmtDimension&&(m=l+e.Query.prototype.IN+"("+u+")"),where=e.Env.parseContext(e.context,i,m,!1),t.addRestriction(m)}else if(o.getDisplayType()==e.DisplayType.AmtDimension){m=_e(u,v,d,c,!1,!1);where=e.Env.parseContext(e.context,i,m,!1),t.addRestriction(m)}else t.addRestriction(d,c,u,s,g)}}}return t}function _e(t,i,n,a,s,l){var o="",d=/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2})/;return"string"==typeof t&&(o+=" UPPER( "),l||(o+=r+"."),o+=n,"string"==typeof t&&(o+=" ) "),null==t||"NULL".equals(t.toString().toUpper())||"NullValue".toUpper().equals(t.toString().toUpper())?a.equals(e.Query.prototype.EQUAL)?o+=" IS NULL ":o+=" IS NOT NULL ":(o+=a,(e.Query.prototype.IN.equals(a)||e.Query.prototype.NOT_IN.equals(a))&&(o+="("),t instanceof Date||t&&d.test(t.toString())?o+=e.DB.to_date(tcode,!1):"string"==typeof t?s?(o+=" UPPER( ",o+=e.DB.to_string(t.toString()),o+=" ) "):o+=t.toString():o+=t,e.Query.prototype.BETWEEN.equals(a)?(o+=" AND ",i instanceof Date||i&&d.test(i.toString())?o+=e.DB.to_date(i,!1):"string"==typeof i?(o+=" UPPER( ",o+=e.DB.to_string(i.toString()),o+=" ) "):o+=i):(e.Query.prototype.IN.equals(a)||e.Query.prototype.NOT_IN.equals(a))&&(o+=")")),o}function Se(t,i){if(null==i)return null;var n=t.getDisplayType(),a=i.toString();if(null==a||a.equals(e.Env.NULLString)||""==a||"NULL"==a.toUpper())return null;try{if(n==e.DisplayType.Integer||e.DisplayType.IsID(n)&&t.getColumnName().endsWith("_ID"))return parseInt(a);if(e.DisplayType.IsNumeric(n))return parseFloat(a);if(e.DisplayType.IsDate(n)){var s="";try{return new Date(a)}catch(e){s=""}try{return Date.Parse(s)}catch(e){return null}}}catch(i){var l=i.message;null!=l&&0!=l.length||(l=i.toString());var o="";return o+=t.getColumnName()+" = "+a+" - "+l,e.ADialog.error("ValidationError",!0,o.toString()),null}return a}function xe(e){z=e,j.css("visibility",z?"visible":"hidden"),p.prop("disabled",e),u.prop("disabled",e),v.prop("disabled",e)}te.addRestriction(d),X='<div class="vis-advancedSearch-contentWrap"> <div class="vis-advancedSearchContentArea vis-pull-left" style="'+""+'"> <div class="vis-advancedSearchContentArea-up"> <div class="vis-advanedSearch-InputsWrap"><div class="vis-as-topfieldswrap"><div style="display:none" class="vis-form-group vis-advancedSearchInput vis-adsearchgroup1"><input readonly id="txtQryName_'+i+'" type="text" name="QueryName" maxlength="60"><label id="lblQryName_'+i+'" for="QueryName">'+e.Msg.getMsg("AddNameToSaveSearch")+'</label></div> <div  class="vis-form-group vis-advancedSearchInput vis-adsearchgroup2"><label id="lblSavedQry_'+i+'" for="GetSavedQuery">'+e.Msg.getMsg("GetSavedSearch")+'</label><select id="drpSavedQry_'+i+'"></select></div> <div class="vis-advancedSearch-Icons vis-pull-left vis-adsearchgroup2">   <ul>   <li class="vis-pull-left"><button disabled id="btnDelete_'+i+'" class="vis-advancedSearchActionIcon vis-advancedSearch-delIcon"><i class="vis vis-delete" aria-hidden="true"></i></button></li></ul></div></div><div class="vis-advanedSearch-AddFilterWrap vis-pull-left"><a href="javascript:;" id="spnAddFilter_'+i+'" class="vis-advancedSearch-AddFilter">'+e.Msg.getMsg("AddFilter")+'</a></div>  <div class="vis-as-backbtn"><button id="btnArowBack_'+i+'" class="vis-ads-icon"><i class="fa fa-arrow-left" aria-hidden="true"></i></button></div> </div><div class="vis-advanedSearch-InputsWrap vis-advs-inputwraps vis-pull-left" data-show="N" style="display:none">  <div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-v">    <label id="lblColumn_'+i+'"  for="Column">'+e.Msg.getMsg("Column")+'</label>  <select id="drpColumn_'+i+'"></select></div><div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-op"><label id="lblOperator_'+i+'" for="Oprator">'+e.Msg.getMsg("Operator")+'</label><select id="drpOperator_'+i+'"></select></div> <div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-v" id="divValue1_'+i+'">   <label  id="lblQryValue_'+i+'" for="QueryValue">'+e.Msg.getMsg("QueryValue")+'</label> <input  id="txtQryValue_'+i+'" type="text" name="QueryValue"></div><div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-v" id="divValue2_'+i+'"><label for="QueryName"  id="lblToQryValue_'+i+'">'+e.Msg.getMsg("ToQueryValue")+'</label><input  id="txtToQryValue_'+i+'" type="text" name="QueryName"></div><div class="vis-form-group vis-advancedSearchInput vis-advancedSearchInput-v" style="display:none;" id="divFullDay_'+i+'"><input style="width: auto;float: left;" id="checkFullDay_'+i+'" type="checkbox" name="QueryName"><label for="QueryName"  id="lblToQryValue_'+i+'">'+e.Msg.getMsg("FullDay")+'</label></div><div class="vis-advancedSearch-calender-Icon vis-pull-left"><ul><li class="vis-pull-left"><button id="btnSave_'+i+'" disabled class="vis-ads-icon"><i class="vis vis-plus" aria-hidden="true"></i></button></li></ul></div></div><div id="divDynamic_'+i+'"><div class="vis-advanedSearch-InputsWrap vis-advancedSearchMrgin"><div class="vis-form-group vis-advancedSearchInput1"><input type="checkbox"  id="chkDynamic_'+i+'"  name="IsDynamic" class="vis-pull-left"><label for="IsDynamic" >'+e.Msg.getMsg("IsDynamic")+'</label></div><div class="vis-form-group vis-advancedSearchInput"><select id="drpDynamicOp_'+i+'" disabled><option>'+e.Msg.getMsg("Today")+"</option><option>"+e.Msg.getMsg("lastxDays")+"</option><option>"+e.Msg.getMsg("lastxMonth")+"</option><option>"+e.Msg.getMsg("lastxYears")+'</option></select></div><div class="vis-form-group vis-advancedSearchHorigontal vis-pull-left" id="divYear_'+i+'"><input id="txtYear_'+i+'" type="number" min="1" max="99" /><label for="Year">'+e.Msg.getMsg("Year")+'</label></div><div class="vis-form-group vis-advancedSearchHorigontal vis-pull-left" id="divMonth_'+i+'"><input id="txtMonth_'+i+'" type="number" min="0" max="12" /><label for="Month">'+e.Msg.getMsg("Month")+'</label></div><div class="vis-form-group vis-advancedSearchHorigontal vis-pull-left" id="divDay_'+i+'"><input id="txtDay_'+i+'" type="number" min="0" max="31" /> <label for="Day">'+e.Msg.getMsg("Day")+'</label></div></div></div></div><div class="vis-advancedSearchContentArea-down"><div class="vis-advancedSearchTableWrap vis-table-responsive vis-pull-left"><table id="tblQry_'+i+'" class="vis-advancedSearchTable"><thead><tr class="vis-advancedSearchTableHead"><th>'+e.Msg.translate(e.Env.getCtx(),"AD_Column_ID")+'</th><th style="display:none">'+e.Msg.translate(e.Env.getCtx(),"KEYVALUE")+"</th><th>"+e.Msg.translate(e.Env.getCtx(),"OperatorName")+"</th><th>"+e.Msg.translate(e.Env.getCtx(),"QueryValue")+'</th><th style="display:none">'+e.Msg.translate(e.Env.getCtx(),"VALUE1VALUE")+"</th><th>"+e.Msg.translate(e.Env.getCtx(),"QueryValue2")+"</th><th>"+e.Msg.getMsg("FullDay")+'</th><th style="display:none">'+e.Msg.translate(e.Env.getCtx(),"VALUE2VALUE")+'</th><th style="display:none">'+e.Msg.translate(e.Env.getCtx(),"AD_USERQUERYLINE_ID")+'</th><th style="display:none">'+e.Msg.translate(e.Env.getCtx(),"Operator")+"</th><th>"+e.Msg.translate(e.Env.getCtx(),"Action")+'</th></tr></thead><tbody class="vis-advancedSearchTableBody"></tbody></table></div></div><div class="vis-advancedSearchContentArea-button"><div class="vis-advcedfooterBtn">',X+='<button id="btnRefresh_'+i+'" class="ui-button ui-corner-all ui-widget">'+e.Msg.getMsg("Refresh")+'</button><div class="vis-pull-right"><button id="btnOk_'+i+'" class="ui-button ui-corner-all ui-widget" >'+e.Msg.getMsg("Apply")+'</button>  <button id="btnCancel_'+i+'" class="ui-button ui-corner-all ui-widget"  style="margin: 0 10px;">'+e.Msg.getMsg("Close")+'</button></div></div></div></div><div class="vis-advancedSearch-RecentRecords">  <div class="vis-RecentRecords-Heading">',X+="<h4>"+e.Msg.getMsg("VHistory")+'</h4></div><div class="vis-RecentRecords-listWrap"> <ul id="ulQry_'+i+'" ><li data-value="0" title="'+e.Msg.getMsg("All")+'" >'+e.Msg.getMsg("All")+'</li><li data-value="365" title="'+e.Msg.getMsg("YearAll")+'">'+e.Msg.getMsg("YearAll")+'</li><li data-value="365 | C" title="'+e.Msg.getMsg("YearCreated")+'">'+e.Msg.getMsg("YearCreated")+'</li><li data-value="31" title="'+e.Msg.getMsg("MonthAll")+'">'+e.Msg.getMsg("MonthAll")+'</li><li data-value="31 | C" title="'+e.Msg.getMsg("MonthCreated")+'">'+e.Msg.getMsg("MonthCreated")+'</li><li data-value="7" title="'+e.Msg.getMsg("WeekAll")+'">'+e.Msg.getMsg("WeekAll")+'</li><li data-value="7 | C" title="'+e.Msg.getMsg("WeekCreated")+'">'+e.Msg.getMsg("WeekCreated")+'</li><li data-value="1" title="'+e.Msg.getMsg("DayAll")+'">'+e.Msg.getMsg("DayAll")+'</li><li data-value="1 | C" title="'+e.Msg.getMsg("DayCreated")+'">'+e.Msg.getMsg("DayCreated")+'</li></ul></div><div class="vis-advancedSearchFooter vis-pull-right"> <p id="pstatus_'+i+'" >16 / 16</p></div></div></div><div class="vis-apanel-busy vis-advancedSearchbusy" id="divBusy_'+i+'" ><p style="text-align:center"> '+e.Msg.getMsg("Loading")+"</p></div>",W.append(X),V=W.find("#ulQry_"+i),m=W.find("#drpSavedQry_"+i),y=W.find("#drpColumn_"+i),I=W.find("#drpOperator_"+i),L=W.find("#divValue1_"+i),B=W.find("#lblQryValue_"+i),R=W.find("#divValue2_"+i),U=W.find("#divFullDay_"+i),f=W.find("#txtQryName_"+i),p=W.find("#btnOk_"+i),u=W.find("#btnCancel_"+i),h=W.find("#btnSave_"+i),g=W.find("#btnDelete_"+i),v=W.find("#btnRefresh_"+i),N=W.find("#divDynamic_"+i),w=W.find("#chkDynamic_"+i),D=W.find("#drpDynamicOp_"+i),b=W.find("#txtYear_"+i),C=W.find("#txtMonth_"+i),_=W.find("#txtDay_"+i),M=W.find("#divYear_"+i),k=W.find("#divMonth_"+i),O=W.find("#divDay_"+i),x=W.find("#checkFullDay_"+i),A=W.find("#spnAddFilter_"+i),T=W.find("#btnArowBack_"+i),F=t(W.find(".vis-advs-inputwraps")[0]),M.hide(),k.hide(),O.hide(),N.hide(),E=W.find("#tblQry_"+i),P=E.find("tbody"),S=W.find("#pstatus_"+i),j=W.find("#divBusy_"+i),function(){H=he(null,!1);var t=n.getData(e.context,l,o,"Code");ve(H),Y=V.html(),ae(t);for(var a='<option value="-1"> </option>',s=[],r=0;r<c.length;r++){var d=c[r];if(!d.getIsEncrypted()){var p=d.getColumnName();d.getDisplayType()==e.DisplayType.Button&&(0==d.getAD_Reference_Value_ID()?d.setDisplayType(e.DisplayType.String):p.endsWith("_ID")?d.setDisplayType(e.DisplayType.Table):(d.setDisplayType(e.DisplayType.List),d.lookup=new e.MLookupFactory.getMLookUp(e.context,i,d.getAD_Column_ID(),e.DisplayType.List)));var u=d.getHeader();(null!=u&&0!=u.length||null!=(u=e.Msg.getElement(e.context,p))&&0!=u.Length)&&(d.getIsKey()&&(u+=" (ID)"),s.push({value:p,text:u}))}}s.sort((function(e,t){var i=e.text.toUpperCase(),n=t.text.toUpperCase();return i>n?1:i<n?-1:0}));for(var g=0;g<s.length;g++)a+='<option value="'+s[g].value+'">'+s[g].text+"</option>";y.html(a),xe(!1)}(),u.on("click",(function(){z||(G.okBtnPressed=!1,q.close())})),w.on("change",(function(){var e=w.prop("checked");D.prop("disabled",!e),I.prop("disabled",e),oe(!e),re(!e),function(e){e?x.prop("disabled",!0):x.prop("disabled",!1)}(e),e?se(G.getIsUserColumn(y.val())):(M.hide(),k.hide(),O.hide())})),D.on("change",(function(){se()})),y.on("change",(function(){if(!z){w.prop("disabled",!0),w.prop("checked",!1),w.trigger("change"),N.hide();var t=y.val(),i=a.getField(t);if(be(!0),t&&"-1"!=t){var n=null;(t.endsWith("_ID")||t.endsWith("_Acct")||t.endsWith("_ID_1")||t.endsWith("_ID_2")||t.endsWith("_ID_3"))&&(n=G.getOperatorsQuery(e.Query.prototype.OPERATORS_ID)),n=t.startsWith("Is")||i.getDisplayType()==e.DisplayType.YesNo?G.getOperatorsQuery(e.Query.prototype.OPERATORS_YN):G.getOperatorsQuery(e.Query.prototype.OPERATORS),W.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 150px)"),null!=i&&e.DisplayType.IsDate(i.getDisplayType())?(D.html(G.getOperatorsQuery(e.Query.prototype.OPERATORS_DATE_DYNAMIC,!0)),N.show(),w.prop("disabled",!1),se(),W.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 195px)"),i.getDisplayType()!=e.DisplayType.DateTime&&i.getDisplayType()!=e.DisplayType.Date||(de(!0),ce(!0))):G.getIsUserColumn(t)&&(D.html(G.getOperatorsQuery(e.Query.prototype.OPERATORS_DYNAMIC_ID,!0)),N.show(),W.find(".vis-advancedSearchContentArea-down").css("height","calc(100% - 195px)"),w.prop("disabled",!1),se(!0)),i.getDisplayType()!=e.DisplayType.DateTime&&i.getDisplayType()!=e.DisplayType.Date&&(de(!1),ce(!1)),i.getDisplayType()==e.DisplayType.YesNo?B.hide():B.show(),I.html(n),I[0].SelectedIndex=0,ue(!0,fe(t)),pe(h,!0),I.prop("disabled",!1)}else ce(!1),de(!0);oe(!0),de(!1)}})),I.on("change",(function(){if(!z){var t=I.val();t||(t="");var i=y.val(),n=fe(i);t&&"0"!=t?e.Query.prototype.BETWEEN.equals(t)?(ue(!1,n),de(!0),re(!0)):(n=fe(i=y.val())).getDisplayType()==e.DisplayType.DateTime&&e.Query.prototype.EQUAL.equals(t)?(de(!1),ce(!0)):(de(!1),ce(!1),re(!1)):(pe(h,!1),re(!1),be(!0))}})),m.on("change",(function(){if(!z){var t=m.val();Z&&P.find(".vis-advancedSearchTableRow").length>0?e.ADialog.confirm("SaveSearch?",!0,"","Confirm",(function(e){e?m.val(G.saveQueryID):ne(t)})):ne(t)}})),E.on("click",(function(e){if(!z&&t(e.target).hasClass("vis-delete")){var i=t(e.target).data("index");Q.splice(i,1),n.deleteLines(t(e.target).data("userquery")),ge(Q),0==--ee&&(f.prop("readonly",!0),f.val(""))}})),V.on("click","LI",(function(i){if(!z){var n=t(this).data("value");if(null!=n){xe(!0);var a=t(this).index();setTimeout((function(){if(a<9){var t=n.toString().split("|"),i=t.length;G.created=1!=i,G.days=parseInt(t[0]),n=""}else G.days=0;(te=new e.Query(r)).addRestriction(n);var s=0;s=he(te,!0),te.setRecordCount(s),xe(!1),0!=s&&(G.okBtnPressed=!0,q.close())}),10)}else G.okBtnPressed=!1,q.close()}})),h.on("click",me),g.on("click",(function(){if(!z){var t=m.val();null==t||""==t.toString()||parseInt(t)<1||e.ADialog.confirm("DeleteConfirm",!0,"","Confirm",(function(i){i?(xe(!0),window.setTimeout((function(){if(e.dataContext.getJSONData(e.Application.contextUrl+"ASearch/GetQueryDefault",{UserQuery_ID:t},null)>0)return e.ADialog.warn("QueryDefaultForOther"),void xe(!1);a.userQueryID==t&&(G.needRefreshWindow=!0);var i=m.find("option:selected").text();if(n.deleteUserQuery(t)){var s=n.getData(e.context,l,o,"Code");V.empty(),V.html(Y),ae(s),m[0].selectedIndex=0,e.ADialog.info("Deleted",!0,i,""),f.val(""),f.prop("readony",!0),xe(!1),m.trigger("change")}else e.ADialog.info("DeleteError",!0,i,"");xe(!1)}),10)):xe(!1)}))}})),p.on("click",(function(){z||(G.okPressed=!0,G.okBtnPressed=!0,function(){if(xe(!0),me(),0==(te=Ce()).getRestrictionCount())return xe(!1),void q.close();var t=te.getWhereClause(!0),i=e.Utility.encodeText(f.val());null!=i&&0==i.trim().length?i=null:G.needRefreshWindow=!0;var a=m.val(),s="";a=null!=a&&"-1"!=a.toString()&&parseInt(a)>0?a:0,window.setTimeout((function(){if(0!=a||null!=i)if(n.insertOrUpdate(a,i,t,l,o,Q,G.getID))!1,s=a>0?"Updated":"Saved",G.saveQueryID=n.id;else{if(n.alreadyExist)return e.ADialog.error("SearchExist"),xe(!1),void!0;!0,s=a>0?"UpdatedError":"SaveError"}var r=!1;0!=he(te,!0)&&(r=!0),xe(!1),""!=s&&e.ADialog.info("",!0,e.Msg.getMsg(s)+" "+i,null),r&&q.close()}),10)}())})),v.on("click",(function(){z||(me(),ve(he(Ce(),!0)))})),A.on("click",(function(){F&&"N"==F.data("show")&&(F.data("show","Y"),t(this).hide(),F.show(),T.show(),t(".vis-adsearchgroup2").hide(),t(".vis-adsearchgroup1").show(),t(".vis-advancedSearchContentArea-down").css("height","calc(100% - 150px)"))})),T.on("click",(function(){F.data("show","N"),F.hide(),A.show(),T.hide(),ie(),t(".vis-adsearchgroup1").hide(),t(".vis-adsearchgroup2").show(),m[0].selectedIndex=0,P.empty(),Q=[],f.val("")})),f.on("input",(function(){f.length>0?p.text(e.Msg.getMsg("SaveAndApply")):p.text(e.Msg.getMsg("Apply"))})),this.getID=function(e){this.saveQueryID=e},this.getSavedID=function(e){return this.saveQueryID},this.show=function(){(q=new e.ChildDialog).setHeight(550),q.setWidth(860),q.setTitle(e.Msg.getMsg("Find")),q.setModal(!0),q.onClose=function(){G.onClose&&G.onClose(),G.dispose()},q.show(),q.setContent(W),q.hideButtons(),xe(!1),u.focus()},this.getSavedQueryName=function(){return f.val()?e.Utility.encodeText(f.val()):""},this.getQuery=function(){return e.MRole.getDefault().getIsQueryMax(H)?(te=e.Query.prototype.getNoRecordQuery(r,!1),H=0,J.warning("Query - over max")):J.info("Query="+te),te},this.disposeComponent=function(){u&&(u.off("click"),w.off("change"),D.off("change"),y.off("change"),I.off("change"),m.off("change"),E.off("click"),V.off("click"),h.off("click"),g.off("click"),p.off("click"),v.off("click")),p=u=g=h=v=null,f=m=y=I=D=w=b=C=_=null,V=N=M=k=O=null,W&&W.remove(),W=null,H=null,Q=null,J=null,this.created=this.days=0,this.okPressed=this.okBtnPressed=null,$=K=Y=null,te=null}}a.prototype.getOperatorsQuery=function(t,i){var n="",a="";for(var s in t)a=t[s],i&&(a=e.Msg.getMsg(a)),n+='<option value="'+s+'">'+a+"</option>";return n},a.prototype.getIsUserColumn=function(e){return!(!e.endsWith("atedBy")&&!e.equals("AD_User_ID"))||!!e.equals("SalesRep_ID")},a.prototype.getCurrentDays=function(){return this.days},a.prototype.getIsCreated=function(){return this.created},a.prototype.getIsOKPressed=function(){return this.okPressed&&this.okBtnPressed},a.prototype.needRefresh=function(){return this.needRefreshWindow},a.prototype.dispose=function(){this.disposeComponent()},e.Find=a}(VIS,jQuery)},3953:()=>{!function(e,t){function i(i,n,a,s,l,o){this.onClose=null;var r=this,d=t("<div>");this.log=e.Logging.VLogger.getVLogger("GenralAttributeForm");var c,p,u=e.Env.getWindowNo(),g=null,h=a,v=null,f=null,m=null;this.log.config("C_GenAttributeSetInstance_ID="+i),g=i,c=n,p=s,t.ajax({url:e.Application.contextUrl+"GenralAttribute/Load",dataType:"json",async:!1,data:{mAttributeSetInstanceId:g,vadms_AttributeSet_ID:c,windowNo:u},success:function(t){returnValue=t.result,e.Env.getCtx().setContext(u,"C_GenAttributeSet_ID",c),null==returnValue.Error?(d.html(returnValue.tableStucture),m=returnValue.ControlList.split(",")):e.ADialog.error(returnValue.Error,null,null,null)}}),v=d.find("#btnOk_"+u),f=d.find("#btnCancel_"+u),l?(v.attr("disabled",!1),v.css("opacity","1")):(v.attr("disabled",!0),v.css("opacity","0.6")),e.Application.isRTL&&f.css("margin-right","10px"),this.btnSelect=d.find("#btnSelect_"+u),this.txtDescription=d.find("#txtDescription_"+u),v.on("click",(function(){p?function(){for(var i=[],n=0;n<m.length;n++){var a=d.find("#"+m[n]);m[n].toString().contains("cmb")?i.push({Key:Number(a.find("option:selected").val()),Name:a.find("option:selected").text()}):i.push({Key:0,Name:a.val()})}t.ajax({url:e.Application.contextUrl+"GenralAttribute/SearchValues",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({windowNoParent:Number(h),mAttributeSetInstanceId:g,vadms_AttributeSet_ID:c,windowNo:u,lst:i}),success:function(e){returnValue=e.result,r.onClose&&(null==returnValue.M_AttributeSetInstanceName&&(returnValue.M_AttributeSetInstanceName=returnValue.Description),r.onClose(returnValue.M_AttributeSetInstance_ID,returnValue.M_AttributeSetInstanceName,returnValue.GenSetInstance))}})}():function(){for(var i=[],n=0;n<m.length;n++){var a=d.find("#"+m[n]);m[n].toString().contains("cmb")?i.push({Key:Number(a.find("option:selected").val()),Name:a.find("option:selected").text()}):i.push({Key:0,Name:e.Utility.decodeText(a.val())})}t.ajax({url:e.Application.contextUrl+"GenralAttribute/Save",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({windowNoParent:h,mAttributeSetInstanceId:g,vadms_AttributeSet_ID:c,windowNo:u,lst:i}),success:function(e){returnValue=e.result,r.onClose&&r.onClose(returnValue.M_AttributeSetInstance_ID,returnValue.M_AttributeSetInstanceName)}})}(),d.dialog("close")})),f.on("click",(function(){d.dialog("close")})),this.showDialog=function(){d.dialog({modal:!0,title:e.Msg.translate(e.Env.getCtx(),"C_GenAttributeSetInstance_ID"),width:400,close:function(){r.dispose(),r=null,d.dialog("destroy"),d=null}})},this.disposeComponent=function(){v&&v.off("click"),f&&f.off("click"),e.Env.clearWinContext(e.Env.getCtx(),u),e.Env.getCtx().setContext(e.Env.WINDOW_INFO,e.Env.TAB_INFO,"M_AttributeSetInstance_ID",g),v=null,f=null,mLocatorId=null,null,mProductId=null,null,adColumnId=null,h=null,productWindow=null,null,0,null,r=null,u=null,g=null,this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()},e.GenralAttributeForm=i}(VIS,jQuery)},2421:()=>{!function(e,t){e.Apps.help=function(i){var n,a,s="";!function(){n=t("<div></div>");var a="<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>";e.Application.isRTL?a+="<html dir='rtl' xmlns='http://www.w3.org/1999/xhtml'>":a+="<html xmlns='http://www.w3.org/1999/xhtml'>",a+="<head><script type='text/javascript' language='javascript'> document.onkeydown = function(){ if((window.event && window.event .keyCode == 116)||(window.event && window.event .keyCode == 78)) { window.event.keyCode = 505; }if(window.event && window.event .keyCode == 505){ return false; } }<\/script> <meta http-equiv='Content-Type' content='text/html; charset=utf-8' /><title>Help &amp; Support "+i.vo.Name+"</title><style type='text/css'>\x3c!--body {margin-left: 0px;margin-top: 0px;margin-right: 0px;margin-bottom: 0px;font-family:verdana;font-size:12px;color:#000000;}.hed1{font-family:verdana;font-weight:bold;font-size:12px;color:#000000;}.border{border:1px solid #c6daf3;}.border-1{border:1px solid #aac7e7;background-color:#e9e8e8;}.border-2{border:1px solid #aac7e7;}.border-bottom{border-bottom:1px solid #c6daf3;}.border-top-none{border-bottom:1px solid #c6daf3;border-right:1px solid #c6daf3;border-left:1px solid #c6daf3;}.red{font-size:12px;color:#FF0000;font-weight:bold;}.white{font-size:16px;color:#FFffff;font-weight:bold;}.black{font-size:16px;color:#000000;font-weight:bold;}.blue{color:#5490fa;font-weight:bold;}.orange{color:#f2b227;font-weight:bold;}.pad{padding:5px;}a{color:#5490fa;\t}a:hover{color:#000000;\ttext-decoration:none;}--\x3e</style></head><body oncontextmenu='return false;'>",a=(a+="<table width='100%' border='0' align='center' cellpadding='0' cellspacing='0' class='border'><tr><td><table width='100%' border='0' align='center' cellpadding='0' cellspacing='0' bgcolor='#c6daf3' class='border-bottom'><tr><td width='100%' class='hed1' height='29'>Vienna Solutions</td></tr></table></td></tr><tr><td>&nbsp;</td>")+"</tr><tr><td><table width='98%' border='0' align='center' cellpadding='0' cellspacing='0' class='border'><tr><td><table width='99%' border='0' align='center' cellpadding='0' cellspacing='0'><tr><td class='red'>&nbsp;</td></tr><tr><td class='red'>Window: "+i.vo.Name+"</td></tr><tr><td>&nbsp;</td></tr><tr><td>"+i.vo.Description+"</td></tr><tr><td>&nbsp;</td></tr><tr><td>"+i.vo.Help+"</td></tr><tr><td>&nbsp;</td></tr><tr><td>";for(var l="",o=0;o<i.tabs.length;o++)""==l?l="<a href='#"+i.tabs[o].vo.Name+o+"'>"+i.tabs[o].vo.Name+"</a>":l+=" -&gt; <a href='#"+i.tabs[o].vo.Name+o+"'>"+i.tabs[o].vo.Name+"</a> ";for(a+=l,a+="</td></tr><tr><td>&nbsp;</td></tr></table></td></tr></table></td></tr><tr><td>&nbsp;</td></tr>",a+="<tr><td><table width='98%' border='0' align='center' cellpadding='0' cellspacing='0' class='border'>",o=0;o<i.tabs.length;o++){a=a+"<tr><td><table width='99%' border='0' align='center' cellpadding='0' cellspacing='0'><tr><td class='black' style='padding-top:5px;' ><table width='100%' border='0' align='center' cellpadding='0' cellspacing='0'><tr><td width='340' height='5' bgcolor='#f9b31c'></td><td width='4'></td><td width='624' bgcolor='#f9b31c'></td></tr><tr><td height='35' bgcolor='#FFFFFF' class='border-top-none' style='padding-left:10px;'>Tab:"+i.tabs[o].vo.Name+"<a name='"+i.tabs[o].vo.Name+o+"'></a> </td><td ></td><td bgcolor='#FFFFFF' class='border-top-none' style='padding-left:10px;'>"+i.tabs[o].vo.Description,i.tabs[o].vo.Help;for(var r="",d=0;d<i.tabs[o].gTab._gridTable.m_fields.length;d++)""==r&&(i.tabs[o].gTab._gridTable.m_fields[d]._vo.IsDisplayedMR||i.tabs[o].gTab._gridTable.m_fields[d]._vo.IsDisplayedf)?r="<a href='#"+i.tabs[o].vo.Name+o+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header+d+"'>"+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header+"</a>":(i.tabs[o].gTab._gridTable.m_fields[d]._vo.IsDisplayedMR||i.tabs[o].gTab._gridTable.m_fields[d]._vo.IsDisplayedf)&&(r+=" | <a href='#"+i.tabs[o].vo.Name+o+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header+d+"'>"+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header+"</a>");a+=r,a+=" </tr></table></td></tr><tr><td>&nbsp;</td></tr>";for(d=0;d<i.tabs[o].gTab._gridTable.m_fields.length;d++)""!=i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header&&(i.tabs[o].gTab._gridTable.m_fields[d]._vo.IsDisplayedMR||i.tabs[o].gTab._gridTable.m_fields[d]._vo.IsDisplayedf)&&(a=a+"<tr><td><table width='100%' border='0' align='center' cellpadding='0' cellspacing='0' class='border-1'><tr><td style='padding:10px; text-align:justify'><span class='blue'>Field: "+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header+"</span><a name='"+i.tabs[o].vo.Name+o+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Header+d+"'></a><br /><br />"+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Description+"<br /><br />"+i.tabs[o].gTab._gridTable.m_fields[d]._vo.Help+" </td></tr></table></td></tr><tr><td>&nbsp;</td></tr>");a+="</table></td></tr>"}a+="</table></td></tr></table></body></html>",n.append(jQuery.parseHTML(a)),s=a}(),(a=window.open()).document.open(),a.document.write(s)}}(VIS,jQuery)},3952:()=>{!function(e,t){e.infoGeneral=function(i,n,a,s,l,o,r,d){this.onClose=null,this.selectedIDs=d;var c=t("<div class='vis-forms-container'>"),p=t("<div class='vis-info-subroot'>"),u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=[],A=null,T=null,V=this;this.keyCol="";var N,M,k,O,L,R,E,P,U,F=[],B=null,W=null,j=e.Msg.getMsg("ShowingResult"),G=e.Msg.getMsg("of"),q=0;c.css("width","100%"),c.css("height","100%"),c.css("position","relative"),u=t("<div class='vis-info-l-s-wrap vis-leftsidebarouterwrap'>"),g=t("<div>"),u.append(g),h=t("<div class='vis-info-datasec'>"),v=t("<div class='vis-info-btnsec'>"),p.append(u),p.append(h),p.append(v),(f=e.Msg.getMsg("Refresh")).indexOf("&")>-1&&(f=f.replace("&","")),(m=e.Msg.getMsg("Cancel")).indexOf("&")>-1&&(m=m.replace("&","")),(y=e.Msg.getMsg("Ok")).indexOf("&")>-1&&(y=y.replace("&","")),I=t("<div class='vis-info-btnswrap'>"),D=t("<button class='VIS_Pref_btn-2'>").append(m),w=t("<button disabled='true' style='cursor:default;opacity:.5' class='VIS_Pref_btn-2'>").append(y),I.append(D),I.append(w),v.append(I),b=t("<div class='vis-info-btnleft'>"),C=t("<button class='VIS_Pref_btn-2' style='margin-top: 10px;'>").append(t("<i class='vis vis-refresh'></i>")),N=t('<div class="vis-info-pagingwrp">'),M=t('<ul class="vis-statusbar-ul">'),U=t('<li class="flex-fill"><section class="vis-ad-w-p-s-result"><span></span></section></li>'),k=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="'+e.Msg.getMsg("FirstPage")+'" style="opacity: 0.6;"></i></div></li>'),O=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+e.Msg.getMsg("PageUp")+'" style="opacity: 0.6;"></i></div></li>'),P=t("<select>"),L=t("<li>").append(P),R=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+e.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"></i></div></li>'),E=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="'+e.Msg.getMsg("LastPage")+'" style="opacity: 0.6;"></i></div></li>'),W=U.find(".vis-ad-w-p-s-result").find("span"),M.append(U).append(k).append(O).append(L).append(R).append(E),k.on("click",(function(){"1"==t(this).css("opacity")&&J(!0,1)})),O.on("click",(function(){"1"==t(this).css("opacity")&&J(!0,parseInt(P.val())-1)})),R.on("click",(function(){"1"==t(this).css("opacity")&&J(!0,parseInt(P.val())+1)})),E.on("click",(function(){"1"==t(this).css("opacity")&&J(!0,parseInt(P.find("Option:last").val()))})),P.on("change",(function(){J(!0,P.val())})),N.append(M),I.append(D),I.append(w),b.append(C),v.append(b),v.append(N),v.append(I),(_=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",c.append(p),c.append(_),1==o&&null!=V.selectedIDs&&V.selectedIDs.length>0&&(F=V.selectedIDs.split(",").map(Number),a=null),e.Application.isMobile||c.on("keyup",(function(t){13===t.keyCode&&(_[0].style.visibility="visible",null!=r&&r.length>0&&(r=e.Env.parseContext(e.Env.getCtx(),n,r,!1,!1)),J(!0,P.val()))})),D.on("click",(function(){null!=V.onClose&&V.onClose(),ee()})),w.on("click",(function(){H()})),C.on("click",(function(){_[0].style.visibility="visible",null!=r&&null!=r&&r.length>0&&(r=e.Env.parseContext(e.Env.getCtx(),n,r,!1,!1)),J(!0,P.val())}));var H=function(){var e=w2ui[B].getSelection();for(item in e)-1==F.indexOf(w2ui[B].get(e[item])[keyCol])&&F.push(w2ui[B].get(e[item])[keyCol]);null!=V.onClose&&F.length>0&&V.onClose(),ee()};function z(){null!=V.onClose&&V.onClose(),ee()}this.show=function(){t.ajax({url:e.Application.contextUrl+"InfoGeneral/GetSearchColumns",dataType:"json",data:{tableName:s,ad_Language:e.context.getAD_Language(),isBaseLangage:e.Env.isBaseLanguage(e.context)},error:function(){e.ADialog.error("ERRORGettingSearchCols"),_[0].style.visibility="hidden"},success:function(t){if(null==(S=t.result))return e.ADialog.error("ERRORGettingSearchCols"),void(_[0].style.visibility="hidden");Q()}})};var Q=function(){if(q=S[0].AD_Table_ID,null==(A=e.dataContext.getJSONData(e.Application.contextUrl+"InfoGeneral/GetDispalyColumns",{AD_Table_ID:q,AD_Language:e.context.getAD_Language(),IsBaseLangage:e.Env.isBaseLanguage(e.context),TableName:s}).result))return alert(e.Msg.getMsg("ERRORGettingDisplayCols")),void(_[0].style.visibility="hidden");var i=null,l=null,o=t("<table>");o.css("width","100%");var d=null;for(var p in S){var u=t("<td>"),h=t('<div class="input-group vis-input-wrap">'),v=t('<div class="vis-control-wrap">');d=t("<tr>"),o.append(d),d.append(u),u.append(h),h.append(v);var f={};l=new e.Controls.VTextBox(S[p].ColumnName,!1,!1,!0,50,100,null,null,!1),f.Ctrl=l,f.AD_Reference_ID=10,f.ColumnName=S[p].ColumnName,f.IsTranslated=S[p].IsTranslated,S[p].IsIdentifier&&l.setValue(a);t("<td>");v.append(l.getControl().attr("data-placeholder","").attr("placeholder"," ")),i=new e.Controls.VLabel(S[p].Name,S[p].ColumnName),v.append(i.getControl()),x.push(f)}g.append(o);var m=e.Msg.getMsg("Refresh");m.indexOf("&")>-1&&(m=m.replace("&",""));var y=e.Msg.getMsg("Cancel");y.indexOf("&")>-1&&(y=y.replace("&",""));var I=e.Msg.getMsg("Ok");I.indexOf("&")>-1&&(I=I.replace("&","")),c.dialog({width:1020,height:500,resizable:!1,title:S[0].TableDisplayName,modal:!0,close:z,closeText:e.Msg.getMsg("close")}),null!=r&&null!=r&&r.length>0&&(r=e.Env.parseContext(e.Env.getCtx(),n,r,!1,!1)),J(!0,P.val())},J=function(i,n){if(o&&w2ui[B]){var a=w2ui[B].getSelection();for(l in a)-1==F.indexOf(w2ui[B].get(a[l])[keyCol])&&F.push(w2ui[B].get(a[l])[keyCol])}for(var l in X(),A)A[l].IsKey&&(keyCol=A[l].ColumnName.toUpperCase());if(1==i)for(var c=null,p=0;p<x.length;p++)null!=(c=x[p].Ctrl.getValue())&&0!=c.length&&0!=c&&c?(x[p].Value=c,!0):x[p].Value=null;var u=[];if(x&&Object.keys(x).length>0)for(var g=0;g<Object.keys(x).length;g++){var h={};h.ColumnName=x[g].ColumnName,h.IsTranslated=x[g].IsTranslated,h.Value=x[g].Value,u.push(h)}n||(n=1),t.ajax({url:e.Application.contextUrl+"InfoGeneral/GetData",dataType:"json",type:"POST",data:{TableName:s,AD_Table_ID:q,PageNo:n,KeyCol:keyCol,SelectedIDs:d,Requery:i,SrchCtrl:JSON.stringify(u),ValidationCode:e.secureEngine.encrypt(r)},error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),_[0].style.visibility="hidden"},success:function(i){var n=JSON.parse(i);if(null!=n){if(n.Error)return e.ADialog.error(n.Error),void(_[0].style.visibility="hidden");!function(e){if(P.empty(),e.TotalPage>0){for(var i=0;i<e.TotalPage;i++)P.append(t("<option value="+(i+1)+">"+(i+1)+"</option>"));P.val(e.CurrentPage),e.TotalPage>e.CurrentPage?(R.css("opacity","1"),E.css("opacity","1")):(R.css("opacity","0.6"),E.css("opacity","0.6")),e.CurrentPage>1?(k.css("opacity","1"),O.css("opacity","1")):(k.css("opacity","0.6"),O.css("opacity","0.6")),1==e.TotalPage&&(k.css("opacity","0.6"),O.css("opacity","0.6"),R.css("opacity","0.6"),E.css("opacity","0.6"))}else k.css("opacity","0.6"),O.css("opacity","0.6"),R.css("opacity","0.6"),E.css("opacity","0.6");var n=e.CurrentPage,a=e.PageSize,s=e.TotalRecords,l=(n-1)*a,o=l+a;o>s&&(o=s);0==s&&(l-=1);var r=j+" "+(l+1)+"-"+o+" "+G+" "+s;W.text(r)}(n.pSetting),$(n.data)}else _[0].style.visibility="hidden"}})},$=function(i){if(null==i)return alert(e.Msg.getMsg("NoDataFound")),void(_[0].style.visibility="hidden");var n=[],a=[],s=null;for(var l in i){var r={resizable:!0};A[l]&&(s=A[l].AD_Reference_ID,r.caption=A[l].Name,r.field=A[l].ColumnName.toUpperCase(),r.columnName=A[l].ColumnName.toUpperCase(),r.sortable=!0,r.hidden=!A[l].IsDisplayed,r.size="100px",e.DisplayType.IsNumeric(s)?s==e.DisplayType.Integer?r.render="int":s==e.DisplayType.Amount?r.render="number:2":r.render="number:1":e.DisplayType.IsDate(s)?r.render=function(e,t,i){var a=e[n[i].field];return a=a?Globalize.format(new Date(a),"d"):""}:s==e.DisplayType.Location||s==e.DisplayType.Locator||s==e.DisplayType.Account||s==e.DisplayType.PAttribute?r.render="int":s==e.DisplayType.Button?r.render=function(e){return"<div>button</div>"}:s==e.DisplayType.Image?r.render=function(e){return"<div>Image</div>"}:e.DisplayType.IsLOB(s)&&(r.render=function(e){return"<div>[Lob-blob]</div>"}),n[l]=r)}for(var d=0;d<i[0].RowCount;d++){var c={};for(var l in i)c[i[l].ColumnName.toUpperCase()]=i[l].Values[d];c.recid=d+1,a[d]=c}if(B=(B="gridGenInfodata"+Math.random()).replace(".",""),w2utils.encodeTags(a),T=t(h).w2grid({name:B,recordHeight:40,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:n,records:a,multiSelect:o,onUnselect:Y,onSelect:K}),o)for(itm in F)for(l in w2ui[B].records)w2ui[B].records[l][keyCol]==F[itm]&&(w2ui[B].select(parseInt(l)+1),Z(!1));else Z(!0);_[0].style.visibility="hidden"};function K(e){Z(!1)}function Y(e){if(o){if(e.index){var t=w2ui[e.target].records[e.index][keyCol];F.indexOf(t)>-1&&F.splice(F.indexOf(t),1)}else for(var i=0;i<w2ui[e.target].records.length;i++){t=w2ui[e.target].records[i][keyCol];F.indexOf(t)>-1&&F.splice(F.indexOf(t),1)}window.setTimeout((function(){0==F.length&&0==w2ui[e.target].getSelection().length&&Z(!0)}),50)}else Z(!0)}var X=function(){null!=T&&T.destroy(),T=null};function Z(e){e?w.prop("disabled","true").css({cursor:"default",opacity:".5"}):w.prop("disabled","").css({cursor:"pointer",opacity:"1"})}this.getSelectedValues=function(){return F};var ee=function(){c.off("keyup"),D.off("click"),w.off("click"),C.off("click"),k.off("click"),O.off("click"),R.off("click"),E.off("click"),P.off("change"),h=null,g=null,null!=T&&T.destroy(),T=null,null,p=null,null,null,null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,keyCol=null,F=null,null,k=O=R=E=P=null,null!=c&&(c.dialog("destroy"),c.remove()),c=null,this.btnOKClick=null,this.displaySearchCol=null,this.displayData=null,this.loadData=null,this.disposeComponent=null,this.disposeDataSec=null,this.getSelectedValues=null}}}(VIS,jQuery)},3213:()=>{!function(e,t){var i=t("<div/>");i.css("width","100%"),i.css("height","100%");var n=t("<ul class='vis-apanel-rb-ul'>");n.css("width","100%"),n.css("height","100%"),i.append(n),n.on("click","LI",(function(i){var n=t(i.target).data("id");new e.InfoWindow(n,null,0,null,null).show()})),t.ajax({url:e.Application.contextUrl+"InfoMenu/LoadMenu",dataType:"json",error:function(){alert("No DATA")},success:function(e){var i=e.result;for(var a in i){var s=t("<li data-id='"+i[a].AD_InfoWindow_ID+"' >");s.append(i[a].Name),n.append(s)}}}),e.InfoMenu={show:function(e){e.w2overlay(i.clone(!0),{css:{height:"300px"}})}}}(VIS,jQuery)},5851:()=>{!function(e,t){e.infoProduct=function(i,n,a,s,l,o,r,d,c,p){this.onClose=null,this.selectedIDs=p;var u,g,h,v,f,m,y,I,D,w,b=t("<div>"),C=t("<div class='vis-info-subroot'>"),_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=null,q=null,H=null,z=[],Q=null,J=null,$=this,K="",Y=0,X=[],Z=[],ee=null,te=null,ie=null,ne=null,ae=null,se=null,le=null,oe=null,re=null,de=null,ce=null,pe=null,ue=null,ge=[],he=[],ve=e.DisplayType.GetNumberFormat(e.DisplayType.Amount),fe=e.Env.isDecimalPoint(),me=null,ye=null,Ie=null,De=null,we=t("<table>"),be=null,Ce=null,_e=null,Se=null,xe=[],Ae=[],Te=!1,Ve=!1,Ne=/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase()),Me=!1,ke=0,Oe=null,Le=null,Re=null,Ee=null,Pe=e.Msg.getMsg("ShowingResult"),Ue=e.Msg.getMsg("of"),Fe=0,Be=0,We=0,je=0,Ge=500,qe=[],He=[],ze=[],Qe=[];function Je(){var i={};be.empty();var a=" M_AttributeSetInstance_ID IN (SELECT  asi.M_AttributeSetInstance_ID as M_AttributeSetInstance_ID   FROM M_AttributeSetInstance asi   WHERE asi.IsActive='Y' AND asi.M_ATTRIBUTESET_ID="+ce.ctrl.val()+")";ue=e.MLookupFactory.get(e.Env.getCtx(),n,8472,e.DisplayType.Search,"M_AttributeSetInstance_ID",0,!1,a),(pe=new e.Controls.VTextBoxButton("M_AttributeSetInstance_ID",!1,!1,!0,e.DisplayType.Search,ue)).getControl(),i.Ctrl=pe,i.AD_Reference_ID=e.DisplayType.Search,i.ColumnName="M_AttributeSetInstance_ID";var s=t("<td>"),l=t('<div class="input-group vis-input-wrap">'),o=t('<div class="vis-control-wrap">'),r=t('<div class="input-group-append">');me=t("<label class='VIS_Pref_Label_Font'>").append(re),s.append(l),l.append(o),l.append(r),o.append(pe.getControl().attr("data-placeholder","").attr("placeholder"," ").attr("data-hasbtn"," ")),r.append(pe.getBtn(0)),r.append(pe.getBtn(1)),o.append(me),z.push(i)}!function(){(ge=[]).push({field:"WareHouse",caption:e.Msg.getMsg("Warehouse"),size:"150px"},{field:"Variant",caption:e.Msg.getMsg("Variant"),size:"150px"},{field:"Quantity",caption:e.Msg.getMsg("Quantity"),size:"100px",editable:{type:"float"},render:"number:1"},{field:"Available",caption:e.Msg.getElement(e.Env.getCtx(),"QtyAvailable"),size:"100px"},{field:"OnHand",caption:e.Msg.getElement(e.Env.getCtx(),"QtyOnHand"),size:"100px"},{field:"Reserved",caption:e.Msg.getElement(e.Env.getCtx(),"QtyReserved"),size:"100px"},{field:"Ordered",caption:e.Msg.getElement(e.Env.getCtx(),"QtyOrdered"),size:"100px"},{field:"M_Warehouse_ID",caption:"WareHouse ID",size:"150px",hidden:!0},{field:"M_AttributeSetInstance_ID",caption:"M_AttributeSetInstance_ID",size:"150px",hidden:!0},{field:"M_Product_ID",caption:"M_Product_ID",size:"150px",hidden:!0},{field:"ParentRec_ID",caption:"Parent recid",size:"150px",hidden:!0}),b.css("width","100%"),b.css("height","100%"),b.css("position","relative"),we.css("width","100%"),_=t("<div class='vis-info-l-s-wrap vis-pad-0 vis-leftsidebarouterwrap'>"),S=t("<div class='vis-info-l-s-content'>"),_.append(S),x=t("<div class='vis-info-datasec'>"),A=t("<div class='vis-info-btnsec'>"),C.append(_),C.append(x),C.append(A),1==d&&null!=$.selectedIDs&&$.selectedIDs.length>0&&(X=$.selectedIDs.split(",").map(Number),ctrlValue=null),(te=e.Msg.getMsg("Value")).indexOf("&")>-1&&(te=te.replace("&","")),(ie=e.Msg.getMsg("Name")).indexOf("&")>-1&&(ie=ie.replace("&","")),(ne=e.Msg.getMsg("UPC")).indexOf("&")>-1&&(ne=ne.replace("&","")),(ae=e.Msg.getMsg("SKU")).indexOf("&")>-1&&(ae=ae.replace("&","")),(se=e.Msg.getMsg("Warehouse")).indexOf("&")>-1&&(se=se.replace("&","")),(le=e.Msg.getMsg("PriceListVersion")).indexOf("&")>-1&&(le=le.replace("&","")),(T=e.Msg.getMsg("Refresh")).indexOf("&")>-1&&(T=T.replace("&","")),(V=e.Msg.getMsg("AddCatalog")).indexOf("&")>-1&&(V=V.replace("&","")),(N=e.Msg.getMsg("ShowSaved")).indexOf("&")>-1&&(N=N.replace("&","")),(k=e.Msg.getMsg("ShowCart")).indexOf("&")>-1&&(k=k.replace("&","")),(M=e.Msg.getMsg("ShowScan")).indexOf("&")>-1&&(M=M.replace("&","")),(O=e.Msg.getMsg("Cancel")).indexOf("&")>-1&&(O=O.replace("&","")),(L=e.Msg.getMsg("Ok")).indexOf("&")>-1&&(L=L.replace("&","")),(oe=e.Msg.getElement(e.Env.getCtx(),"M_AttributeSet_ID")).indexOf("&")>-1&&(oe=oe.replace("&","")),(re=e.Msg.getElement(e.Env.getCtx(),"M_AttributeSetInstance_ID")).indexOf("&")>-1&&(re=re.replace("&","")),(de=e.Msg.getMsg("AttrCode")).indexOf("&")>-1&&(de=de.replace("&","")),be=t("<tr>"),we.append(be);var i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">');me=t("<label class='VIS_Pref_Label_Font'>").append(te),be.append(i),i.append(n),n.append(a);var s={};ye=new e.Controls.VTextBox("Value",!1,!1,!0,50,100,null,null,!1),s.Ctrl=ye,s.AD_Reference_ID=10,s.ColumnName="Value";var o=t("<td>");a.append(ye.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(ie),be.append(i),i.append(n),n.append(a),s={},ye=new e.Controls.VTextBox("Name",!1,!1,!0,50,100,null,null,!1),s.Ctrl=ye,s.AD_Reference_ID=10,s.ColumnName="Name",ye.setValue(l),o=t("<td>"),a.append(ye.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(ne),be.append(i),i.append(n),n.append(a),s={},ye=new e.Controls.VTextBox("UPC",!1,!1,!0,50,100,null,null,!1),s.Ctrl=ye,s.AD_Reference_ID=10,s.ColumnName="UPC",a.append(ye.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(ae),be.append(i),i.append(n),n.append(a),s={},ye=new e.Controls.VTextBox("SKU",!1,!1,!0,50,100,null,null,!1),s.Ctrl=ye,s.AD_Reference_ID=10,s.ColumnName="SKU",o=t("<td>"),a.append(ye.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(se),be.append(i),i.append(n),n.append(a),s={},Ie=new e.Controls.VComboBox("M_Warehouse_ID",!1,!1,!0,null,50),s.Ctrl=Ie,s.AD_Reference_ID=e.DisplayType.tableDir,s.ColumnName="M_Warehouse_ID",o=t("<td>"),be.append(o),a.append(Ie.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(le),be.append(i),i.append(n),n.append(a),s={},De=new e.Controls.VComboBox("M_PriceList_Version_ID",!1,!1,!0,null,50),s.Ctrl=De,s.AD_Reference_ID=e.DisplayType.tableDir,s.ColumnName="M_PriceList_Version_ID",o=t("<td>"),a.append(De.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(de),be.append(i),i.append(n),n.append(a),s={},ye=new e.Controls.VTextBox("AttributeCode",!1,!1,!0,50,100,null,null,!1),s.Ctrl=ye,s.AD_Reference_ID=10,s.ColumnName="AttributeCode",o=t("<td>"),a.append(ye.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),me=t("<label class='VIS_Pref_Label_Font'>").append(oe),be.append(i),i.append(n),n.append(a),s={},ce=new e.Controls.VComboBox("M_AttributeSet_ID",!1,!1,!0,null,50),s.Ctrl=ce,s.AD_Reference_ID=e.DisplayType.tableDir,s.ColumnName="M_AttributeSet_ID",o=t("<td>"),a.append(ce.getControl().attr("data-placeholder","").attr("placeholder"," ")),a.append(me),z.push(s),be=t("<tr>"),we.append(be),i=t("<td>"),n=t('<div class="input-group vis-input-wrap">'),a=t('<div class="vis-control-wrap">'),be.append(i),i.append(n),n.append(a),s={},Je(),S.append(we),R=t("<div class='vis-info-btnswrap'>"),E=t("<div class='vis-info-ls-btnswrap'>"),W=t("<button class='VIS_Pref_btn-2'>").append(O),j=t("<button disabled='true' style='cursor:default;opacity:.5' class='VIS_Pref_btn-2'>").append(L),B=t("<button class='VIS_Pref_btn-2'>").append(t("<i class='fa fa-cart-plus'></i>")),U=t("<button class='VIS_Pref_btn-2' disabled>").append(t("<i class='fa fa-list-ul'></i>")),P=t("<button class='VIS_Pref_btn-2'>").append(t("<i class='vis vis-scanner'>")),F=t("<button class='VIS_Pref_btn-2'>").append(t("<i class='fa fa-shopping-cart'></i>")),G=t("<div class='vis-info-btnleft'>"),q=t("<button class='VIS_Pref_btn-2' style='margin-top: 10px;'>").append(t("<i class='vis vis-refresh'></i>")),u=t('<div class="vis-info-pagingwrp">'),g=t('<ul class="vis-statusbar-ul">'),D=t('<li class="flex-fill"><section class="vis-ad-w-p-s-result"><span></span></section></li>'),h=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="'+e.Msg.getMsg("FirstPage")+'"  style="opacity: 0.6;"></i></div></li>'),v=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+e.Msg.getMsg("PageUp")+'"  style="opacity: 0.6;"></i></div></li>'),I=t("<select>"),f=t("<li>").append(I),m=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+e.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"></i></div></li>'),y=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="'+e.Msg.getMsg("LastPage")+'" style="opacity: 0.6;"></i></div></li>'),Ee=D.find(".vis-ad-w-p-s-result").find("span"),g.append(D).append(h).append(v).append(f).append(m).append(y),h.on("click",(function(){if("1"==t(this).css("opacity")&&(H[0].style.visibility="visible",d&&!Ve&&B.show(),vt(!0,1),he.length>0)){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}})),v.on("click",(function(){if("1"==t(this).css("opacity")&&(H[0].style.visibility="visible",d&&!Ve&&B.show(),vt(!0,parseInt(I.val())-1),he.length>0)){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}})),m.on("click",(function(){if("1"==t(this).css("opacity")&&(H[0].style.visibility="visible",d&&!Ve&&B.show(),vt(!0,parseInt(I.val())+1),he.length>0)){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}})),y.on("click",(function(){if("1"==t(this).css("opacity")&&(H[0].style.visibility="visible",d&&!Ve&&B.show(),vt(!0,parseInt(I.find("Option:last").val())),he.length>0)){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}})),I.on("change",(function(){if(H[0].style.visibility="visible",d&&!Ve&&B.show(),vt(!0,I.val()),he.length>0){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}})),u.append(g),R.append(W),R.append(j),R.append(U),R.append(B),E.append(P),E.append(F),_.append(E),G.append(q),A.append(G),A.append(u),A.append(R),(H=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",b.append(C),b.append(H)}(),function(i,a){Re=new e.MPAttributeLookup(e.context,n),Le=new e.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,e.DisplayType.PAttribute,Re,n,!1,!1,!1,!0),Ie.ctrl.append(t('<Option value="0"></option>')),De.ctrl.append(t('<Option value="0"></option>')),ce.ctrl.append(t('<Option value="0"></option>')),Ce=jQuery.parseJSON(Ce),_e=jQuery.parseJSON(_e),0==a&&(a=function(){var t=0;try{var i=e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/GetDefaultPriceList",null,null);null!=i&&(t=i)}catch(e){console.log(e),H[0].style.visibility="hidden"}return t}());Se=function(t,i,a){var s=null,l=0,o=t.getContext(i,"DateOrdered");null!=o&&o.Length>0?s=System.Convert.ToDateTime(e.Env.parseContext(e.Env.getCtx(),n,"DateOrdered",!1,!1)):null!=(o=t.getContext(i,"DateInvoiced"))&&o.Length>0&&(s=System.Convert.ToDateTime(e.Env.parseContext(e.Env.getCtx(),n,"DateInvoiced",!1,!1)));if(null==s){var r=new Date;s=e.Utility.Util.getValueOfDate(r)}try{var d=e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/GetPriceListVersion",{PriceList:a},null);if(d.length>0){for(var c in d){var p=e.Utility.Util.getValueOfInt(d[c].M_PriceList_Version_ID);s>e.Utility.Util.getValueOfString(d[c].ValidFrom)&&(l=p)}0==l&&(l=e.Utility.Util.getValueOfInt(d[0].M_PriceList_Version_ID))}}catch(e){console.log(e),H[0].style.visibility="hidden"}return l}(e.Env.getCtx(),n,a),function(){try{Ke(e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/GetWarehouse",null,null))}catch(e){console.log(e),H[0].style.visibility="hidden"}}()}(0,s);var $e=e.context.getWindowTabContext(n,0,"AD_Tab_ID");function Ke(t){var i,n;if(t.length>0){for(var l in t)i=e.Utility.Util.getValueOfInt(t[l].M_Warehouse_ID),n=e.Utility.Util.getValueOfString(t[l].Name),Ie.getControl().append(" <option value="+i+">"+n+"</option>"),i==a&&Ie.ctrl.val(a);0==a&&Ie.ctrl.val(e.Utility.Util.getValueOfInt(t[0].M_Warehouse_ID))}!function(t){try{!function(t){var i,n;if(t.length>0)for(var a in t)i=e.Utility.Util.getValueOfInt(t[a].M_PriceList_Version_ID),n=e.Utility.Util.getValueOfString(t[a].Name),De.getControl().append(" <option value="+i+">"+n+"</option>"),i==Se&&De.ctrl.val(Se);!function(){try{e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/GetAttributeSet",null,et)}catch(e){console.log(e),H[0].style.visibility="hidden"}}()}(e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/GetPriceList",{PriceList:t},null))}catch(e){console.log(e),H[0].style.visibility="hidden"}}(s)}function Ye(e){e?j.prop("disabled","true").css({cursor:"default",opacity:".5"}):j.prop("disabled","").css({cursor:"pointer",opacity:"1"})}function Xe(t,i){var n=!1;if(t.value_new=e.Utility.Util.getValueOfString(i),t.value_new.contains(".")){n=!0;for(var a=[],s=0;s<t.value_new.length;s++)"."===t.value_new[s]&&a.push(s);a.length>1&&(t.value_new=Ze(t.value_new,"."))}if(t.value_new.contains(","))if(n)t.value_new=Ze(t.value_new,",");else{for(a=[],s=0;s<t.value_new.length;s++)","===t.value_new[s]&&a.push(s);a.length>1?t.value_new=Ze(t.value_new,","):t.value_new=t.value_new.replace(",",".")}return""==t.value_new&&(t.value_new="0"),t.value_new}function Ze(e,t){var i=e.split(t);return(e=i.slice(0,-1).join("")+"."+i.slice(-1)).indexOf(".")==e.length-1&&(e=e.replace(".","")),e}function et(t){var i,n;if(t.length>0)for(var a in t)i=e.Utility.Util.getValueOfInt(t[a].M_AttributeSet_ID),n=e.Utility.Util.getValueOfString(t[a].Name),ce.getControl().append(" <option value="+i+">"+n+"</option>")}146==(Y=e.dataContext.getJSONRecord("InfoProduct/GetWindowID",$e.toString()))||0!=e.context.getContextAsInt(n,e.context.getWindowTabContext(n,1,"KeyColumnName"))&&(Ve=!0),d&&!Ve||(B.hide(),U.hide(),P.hide(),F.hide()),e.Application.isMobile||b.on("keyup",(function(t){if(13===t.keyCode&&(H[0].style.visibility="visible",null!=c&&c.length>0&&(Oe=e.Env.parseContext(e.Env.getCtx(),n,c,!1,!1)),vt(!0,I.val()),he.length>0)){for(var i=0;i<he.length;i++)w2ui["subgrid-"+he[i]].destroy();he=[]}})),P.on("click",(function(){tt()})),F.on("click",(function(){!function(){Me=!1,ke=0;var t=new e.InfoScanForm(n,!0);t.showDialog(),t.onClose=function(t,i,a){H[0].style.visibility="visible",window.setTimeout((function(){Me=i,ke=a;var s=e.Env.getCtx().getContext("#AD_Session_ID");if(t&&t.length>0)for(var l in t){var o="",r="",d=0,c=0,p=t[l].VAICNT_Quantity,u=t[l].M_Product_ID,g=t[l].Value;d=t[l].M_AttributeSetInstance_ID;var h=t[l].Description,v=t[l].VAICNT_InventoryCountLine_ID;o=t[l].Name,r=t[l].UOM,c=t[l].C_UOM_ID;var f=t[l].LineID;if(p>0){if(xe.length>0){var m=xe.map((function(e){return e._prdID==u&&e._Attribute==d&&e._uom==c&&e._refLineID==f})).indexOf(!0);m>-1?xe[m]._prodQty+=p:xe.push({_prodQty:p,_prdID:u,_prdName:o,_value:g,_uom:c,_uomName:r,_AD_Session_ID:s,_windowNo:n,_RefNo:"",_Attribute:d,_AttributeName:h,_Locator_ID:0,_IsLotSerial:"N",_countID:v,_refLineID:f})}else xe.push({_prodQty:p,_prdID:u,_prdName:o,_value:g,_uom:c,_uomName:r,_AD_Session_ID:s,_windowNo:n,_RefNo:"",_Attribute:d,_AttributeName:h,_Locator_ID:0,_IsLotSerial:"N",_countID:v,_refLineID:f});Z[d]=h}}nt()}),200)}}()})),B.on("click",(function(){it()})),U.on("click",(function(){H[0].style.visibility="visible",nt()})),W.on("click",(function(){null!=$.onClose&&$.onClose(),Dt()})),j.on("click",(function(){ot()})),q.on("click",(function(){if(Oe=null,d&&!Ve&&B.show(),0==xe.length&&U.prop("disabled",!0),X=[],H[0].style.visibility="visible",null!=c&&null!=c&&c.length>0&&(Oe=e.Env.parseContext(e.Env.getCtx(),n,c,!1,!1)),vt(!0,1),he.length>0){for(var t=0;t<he.length;t++)w2ui["subgrid-"+he[t]].destroy();he=[]}})),ce.ctrl.change((function(){pe=null,ue=null;for(var e=0;e<z.length;e++)"M_AttributeSetInstance_ID"==z[e].Ctrl.colName&&z.splice(e);Je()}));var tt=function(){Me=!1,ke=0;var t=new e.InfoScanForm(n,!1);t.showDialog(),t.onClose=function(t,i,a){H[0].style.visibility="visible",Me=i,ke=a;var s=e.Env.getCtx().getContext("#AD_Session_ID");if(t&&t.length>0)for(var l in t){var o,r,d,c=t[l].M_AttributeSetInstance_ID,p=t[l].Description,u=t[l].VAICNT_InventoryCountLine_ID,g=t[l].VAICNT_Quantity,h=t[l].M_Product_ID,v=t[l].Value;o=t[l].Name,r=t[l].UOM,d=t[l].C_UOM_ID;var f=t[l].VAICNT_ReferenceNo;""==f&&(f="null");var m=t[l].LineID;if(g>0){if(xe.length>0){var y=xe.map((function(e){return e._prdID==h&&e._Attribute==c&&e._uom==d&&e._refLineID==m})).indexOf(!0);y>-1?xe[y]._prodQty+=g:xe.push({_prodQty:g,_prdID:h,_prdName:o,_value:v,_uom:d,_uomName:r,_AD_Session_ID:s,_windowNo:n,_RefNo:f,_Attribute:c,_AttributeName:p,_Locator_ID:0,_IsLotSerial:"N",_countID:u,_refLineID:m})}else xe.push({_prodQty:g,_prdID:h,_prdName:o,_value:v,_uom:d,_uomName:r,_AD_Session_ID:s,_windowNo:n,_RefNo:f,_Attribute:c,_AttributeName:p,_Locator_ID:0,_IsLotSerial:"N",_countID:u,_refLineID:m});Z[c]=p}}nt()}},it=function(){if(H[0].style.visibility="visible",yt(),vt(!0,I.val()),he.length>0){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}xe.length>0?U.prop("disabled",!1):U.prop("disabled",!0),X=[]},nt=function(){var i=[],a=[],s=[],l=[],o=[],r=[],d=[],c=[],p=[];for(var u in Ae=[],B.hide(),xe)i.push(xe[u]._prdID),l.push(xe[u]._prdName),a.push(xe[u]._value),s.push(xe[u]._prodQty),p.push(xe[u]._RefNo),d.push(xe[u]._Attribute),c.push(xe[u]._AttributeName),o.push(xe[u]._uom),r.push(xe[u]._uomName);if(i.length>0){for(var g=0;g<i.length;g++)Ae.push({SrNo:g,Product:l[g],Value:a[g],QtyEntered:s[g],UOM_ID:o[g],UOM:r[g],M_Product_ID1:i[g],Attribute:d[g],AttributeName:c[g],RefNo:p[g]});!function(){null!=J&&(J.destroy(),J=null);for(var i=[],a=0;a<Ae.length;a++){var s={};s.Product=Ae[a].Product,s.Value=Ae[a].Value,s.QtyEntered=Ae[a].QtyEntered,s.UOM=Ae[a].UOM,s.Attribute=Ae[a].Attribute,s.ProdID=Ae[a].M_Product_ID1,s.recid=a+1,i[a]=s}ee=(ee="gridsavedprd"+Math.random()).replace(".",""),w2utils.encodeTags(i),J=t(x).w2grid({name:ee,recordHeight:40,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:[{field:"Value",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"Value")+"</span></div>",sortable:!1,size:"120px",min:100,hidden:!1},{field:"Product",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"Product")+"</span></div>",sortable:!1,size:"20%",min:150,hidden:!1},{field:"QtyEntered",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"QtyEntered")+"</span></div>",sortable:!1,size:"70px",min:60,hidden:!1,editable:{type:"float"},render:function(t,i,n){return e.Utility.Util.getValueOfDecimal(t.QtyEntered).toLocaleString()}},{field:"UOM",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"UOM")+"</span></div>",sortable:!1,size:"70px",min:60,hidden:!1},{field:"Attribute",caption:e.Msg.translate(e.Env.getCtx(),"Attribute"),sortable:!1,size:"20%",min:150,hidden:!1,editable:{type:"custom",ctrl:Le,showAll:!0},render:function(e,t,i){var n=Re,a=e.Attribute,s=Z[a];return!s&&a>0&&(s=n.getDisplay(a,!0),Z[a]=s),s}},{field:"Delete",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"DeleteActivity")+"</span></div>",sortable:!1,size:"60px",min:40,hidden:!1,render:function(){return'<div class="vis-info-grid-icowrap"><i class="vis vis-delete title="Delete record" style="opacity: 1;"></i></div>'}},{field:"Copy",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"Copy")+"</span></div>",sortable:!1,size:"60px",min:40,hidden:!1,render:function(){return'<div class="vis-info-grid-icowrap"><i class="vis vis-new title="Copy record" style="opacity: 1;"></i></div>'}},{field:"ProdID",caption:'<div style="text-align: center;" ><span>'+e.Msg.translate(e.Env.getCtx(),"ProdID")+"</span></div>",sortable:!1,size:"20%",min:150,hidden:!0}],records:i,onChange:function(e){2==e.column?(w2ui[ee].records[e.index].QtyEntered=e.value_new,xe[e.index]._prodQty=e.value_new,Ae[e.index].QtyEntered=e.value_new):4==e.column&&(w2ui[ee].records[e.index].Attribute=e.value_new,xe[e.index]._Attribute=e.value_new,Ae[e.index].Attribute=e.value_new)},onClick:function(t){5==t.column&&J.records.length>0?(H[0].style.visibility="visible",xe.splice(t.recid-1,1),Ae.splice(t.recid-1,1),lt()):6==t.column&&J.records.length>0?(H[0].style.visibility="visible",Ae.push({SrNo:Ae.length,Product:Ae[t.recid-1].Product,Value:Ae[t.recid-1].Value,QtyEntered:Ae[t.recid-1].QtyEntered,UOM_ID:Ae[t.recid-1].UOM_ID,UOM:Ae[t.recid-1].UOM,M_Product_ID1:Ae[t.recid-1].M_Product_ID1,Attribute:"",AttributeName:"",RefNo:Ae[t.recid-1].RefNo}),xe[xe.length]={_prodQty:Ae[Ae.length-1].QtyEntered,_prdID:Ae[Ae.length-1].M_Product_ID1,_prdName:Ae[Ae.length-1].Product,_value:Ae[Ae.length-1].Value,_uom:Ae[Ae.length-1].UOM_ID,_uomName:Ae[Ae.length-1].UOM,_AD_Session_ID:e.Env.getCtx().getContext("#AD_Session_ID"),_windowNo:n,_RefNo:"",_Attribute:0,_AttributeName:"",_Locator_ID:0,_IsLotSerial:"N",_countID:0},lt()):4==t.column&&J.records.length>0&&e.Env.getCtx().setContext(n,"M_Product_ID",e.Utility.Util.getValueOfInt(Ae[t.recid-1].M_Product_ID1))},onSelect:at,onUnselect:st}),H[0].style.visibility="hidden"}()}H[0].style.visibility="hidden"};function at(e){Ye(!1)}function st(e){d?window.setTimeout((function(){0==w2ui[e.target].getSelection().length&&Ye(!0)}),50):Ye(!0)}function lt(){J.clear();for(var e=[],t=0;t<Ae.length;t++){var i={};i.Product=Ae[t].Product,i.Value=Ae[t].Value,i.QtyEntered=Ae[t].QtyEntered,i.UOM=Ae[t].UOM,i.Attribute=Ae[t].Attribute,i.ProdID=Ae[t].M_Product_ID1,i.recid=t+1,e[t]=i}e.length>0&&(w2utils.encodeTags(e),J.add(e)),H[0].style.visibility="hidden"}var ot=function(){if(H[0].style.visibility="visible",d&&xe.length>0&&"none"==B.css("display")){X=[];var e=w2ui[ee].getSelection(),i=xe;if(e.length>0){i=[];for(var n=0;n<e.length;n++){var a=w2ui[ee].records[e[n]-1].ProdID,s=w2ui[ee].records[e[n]-1].Attribute;i.push(t.grep(xe,(function(e){return e._prdID==a&&e._Attribute==s}))[0])}xe=i}ct(xe)}else if(d&&w2ui[ee].getSelection().length>1&&"block"==B.css("display"))ct(Qe=rt());else{X=[];var l=w2ui[ee].getSelection();for(item in l)-1==X.indexOf(w2ui[ee].get(l[item])[K])&&X.push(w2ui[ee].get(l[item])[K]);H[0].style.visibility="hidden",null!=$.onClose&&$.onClose(),Dt()}},rt=function(){var t,i=w2ui[ee].getSelection();if(i.length>0){t=[];for(var a=0;a<i.length;a++)if(w2ui[ee].records[i[a]-1].QTYENTERED>0){var s=w2ui[ee].records[i[a]-1].M_PRODUCT_ID,l=w2ui[ee].records[i[a]-1].M_AttributeSetInstance_ID;if(t.length>0){var o=t.map((function(e){return e._prdID==s&&e._Attribute==l})).indexOf(!0);o>-1?t[o]._prodQty+=qty:t.push({_prodQty:w2ui[ee].records[i[a]-1].QTYENTERED,_prdID:w2ui[ee].records[i[a]-1].M_PRODUCT_ID,_prdName:w2ui[ee].records[i[a]-1].NAME,_value:w2ui[ee].records[i[a]-1].NAME,_uom:w2ui[ee].records[i[a]-1].C_UOM_ID,_uomName:w2ui[ee].records[i[a]-1].UOM,_AD_Session_ID:e.Env.getCtx().getContext("#AD_Session_ID"),_windowNo:n,_RefNo:"",_Attribute:w2ui[ee].records[i[a]-1].M_AttributeSetInstance_ID,_AttributeName:"",_Locator_ID:0,_IsLotSerial:"N",_countID:0})}else t.push({_prodQty:w2ui[ee].records[i[a]-1].QTYENTERED,_prdID:w2ui[ee].records[i[a]-1].M_PRODUCT_ID,_prdName:w2ui[ee].records[i[a]-1].NAME,_value:w2ui[ee].records[i[a]-1].NAME,_uom:w2ui[ee].records[i[a]-1].C_UOM_ID,_uomName:w2ui[ee].records[i[a]-1].UOM,_AD_Session_ID:e.Env.getCtx().getContext("#AD_Session_ID"),_windowNo:n,_RefNo:"",_Attribute:w2ui[ee].records[i[a]-1].M_AttributeSetInstance_ID,_AttributeName:"",_Locator_ID:0,_IsLotSerial:"N",_countID:0})}}return t};function dt(t,i,n){H[0].style.visibility="hidden",t&&(Te=!0),null!=$.onClose&&$.onClose(),Dt();var a=e.Msg.getMsg("RecSaved");t||(a=n>0?n+" "+e.Msg.getMsg("RecordsNotSaved"):e.Msg.getMsg("ErrorInSaving")),i&&""!=i&&(a+=", "+i),e.ADialog.info("",!0,a)}function ct(i){var a,s,l,o,r,d=0,c=0,p=0,u=0;s=e.Utility.Util.getValueOfInt(e.context.getWindowContext(n,"M_Locator_ID",!0)),d=e.context.getContextAsInt(n,e.context.getWindowTabContext(n,0,"KeyColumnName")),a=e.context.getWindowTabContext(n,0,"KeyColumnName"),c=e.context.getContextAsInt(n,e.context.getWindowTabContext(n,1,"KeyColumnName")),e.context.getWindowTabContext(n,1,"KeyColumnName"),r=e.Utility.Util.getValueOfInt(e.context.getWindowContext(n,"M_ProductContainer_ID",!0)),170==Y&&(p=e.Utility.Util.getValueOfInt(e.context.getWindowContext(n,"M_LocatorTo_ID",!0)),u=e.Utility.Util.getValueOfInt(e.context.getWindowContext(n,"Ref_M_ProductContainerTo_ID",!0))),146==Y&&(d=e.context.getContextAsInt(n,e.context.getWindowTabContext(n,1,"KeyColumnName")),c=0),l=e.Utility.Util.getValueOfInt(d),o=e.Utility.Util.getValueOfInt(c);var g=[],h=[],v=[],f=[],m=[],y=[];if(xe.length>0&&"none"==B.css("display")){for(var I in xe)if(g.push(xe[I]._prdID),h.push(xe[I]._prodQty),f.push(xe[I]._RefNo),m.push(xe[I]._Attribute),v.push(xe[I]._uom),y.push(xe[I]._countID),0!=o)break;Fe=xe.length}else{for(var I in Qe)if(g.push(Qe[I]._prdID),h.push(Qe[I]._prodQty),f.push(Qe[I]._RefNo),m.push(Qe[I]._Attribute),v.push(Qe[I]._uom),y.push(Qe[I]._countID),0!=o)break;Fe=Qe.length}1==(Be=Fe%Ge==0?Fe/Ge:Math.ceil(Fe/Ge))?"SAP001_StockTransfer_ID"==a?t.ajax({type:"POST",url:e.Application.contextUrl+"InfoProduct/SaveStockTfr",dataType:"json",data:{id:l,keyColumn:a,AD_Table_ID:e.context.getWindowTabContext(n,1,"AD_Table_ID"),prod:JSON.stringify(g),C_UOM_ID:JSON.stringify(v),listAst:JSON.stringify(m),qty:JSON.stringify(h),locatorTo:p,lineID:o,ContainerID:r},success:function(e){e.result},error:function(e,t,i){H[0].style.visibility="hidden",console.log(t),returnValue}}):t.ajax({type:"POST",url:e.Application.contextUrl+"InfoProduct/Save",dataType:"json",data:{id:l,keyColumn:a,prod:JSON.stringify(g),C_UOM_ID:JSON.stringify(v),listAst:JSON.stringify(m),qty:JSON.stringify(h),locatorTo:p,lineID:o,InvCountID:JSON.stringify(y),ReferenceNo:JSON.stringify(f),Locator_ID:s,WindowID:Y,ContainerID:r,ContainerToID:u},success:function(t){var i=JSON.parse(t);if(0!=i.count)return gt(i),void dt(!1,ut(),i.count);if(Me)try{e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/DeleteCart",{invCount_ID:ke},null)}catch(e){console.log(e),dt(!0,e.message)}dt(!0)},error:function(e,t,i){H[0].style.visibility="hidden",console.log(t)}}):pt(l,a,o,g,h,[],v,f,m,s,p,[],y,r,u)}function pt(i,a,s,l,o,r,d,c,p,u,g,h,v,f,m){var y=b.find(".filestatuscounter");""!=y.text()?Be==We?y.text(Fe+" Records Inserted..Please Wait..!!"):y.text(We*Ge-je+" Records Inserted..Please Wait..!!"):((w=t("<div class='filestatus'> <label class='filestatuscounter'>"+We*Ge+" Records Inserted..Please Wait..!!</lable></div>")).css({position:"absolute",width:"98%",height:"97%","text-align":"center","z-index":"999"}),w[0].style.visibility="visible",b.append(w)),"SAP001_StockTransfer_ID"==a?t.ajax({type:"POST",url:e.Application.contextUrl+"InfoProduct/SaveStockTfr",dataType:"json",data:{id:i,keyColumn:a,AD_Table_ID:e.context.getWindowTabContext(n,1,"AD_Table_ID"),prod:JSON.stringify(l.splice(0,Ge)),C_UOM_ID:JSON.stringify(d.splice(0,Ge)),listAst:JSON.stringify(p.splice(0,Ge)),qty:JSON.stringify(o.splice(0,Ge)),locatorTo:g,lineID:s,ContainerID:f},success:function(e){e.result},error:function(e,t,i){H[0].style.visibility="hidden",console.log(t),returnValue}}):t.ajax({type:"POST",url:e.Application.contextUrl+"InfoProduct/Save",dataType:"json",data:{id:i,keyColumn:a,prod:JSON.stringify(l.splice(0,Ge)),C_UOM_ID:JSON.stringify(d.splice(0,Ge)),listAst:JSON.stringify(p.splice(0,Ge)),qty:JSON.stringify(o.splice(0,Ge)),locatorTo:g,lineID:s,InvCountID:JSON.stringify(v.splice(0,Ge)),ReferenceNo:c,Locator_ID:u,WindowID:Y,ContainerID:f,ContainerToID:m},success:function(t){var n=JSON.parse(t);if(We++,Be==We){if(0==je){if(Me)try{e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/DeleteCart",{invCount_ID:ke},null)}catch(e){console.log(e),dt(!0,e.message)}return void dt(!0)}return gt(n),je+=n.count,void dt(!1,ut(),je)}0==n.count||(gt(n),je+=n.count),pt(i,a,s,l,o,r,d,c,p,u,g,h,v,f,m)},error:function(e,t,i){H[0].style.visibility="hidden",console.log(t)}})}function ut(){var e="";if(qe.length>0)for(var t=0;t<qe.length;t++)0!=t&&(e+=" ::: "),e+=qe[t]+" --\x3e "+He[t];return qe=[],He=[],e}function gt(e){if(e.errorKeys.length>0)if(qe.length>0)for(var t=0;t<e.errorKeys.length;t++){var i=qe.indexOf(e.errorKeys[t]);i>=0?He[i]=He[i]+", "+e.errorProds[t]:(qe.push(e.errorKeys[t]),He.push(e.errorProds[t]))}else qe=e.errorKeys,He=e.errorProds;else qe.push(e.error)}function ht(){null!=$.onClose&&$.onClose(),Dt()}this.show=function(){t.ajax({url:e.Application.contextUrl+"InfoProduct/GetInfoColumns",dataType:"json",error:function(){alert(e.Msg.getMsg("ERRORGettingSearchCols")),H[0].style.visibility="hidden"},success:function(t){if(null==(Q=jQuery.parseJSON(t)))return alert(e.Msg.getMsg("ERRORGettingSearchCols")),void(H[0].style.visibility="hidden");b.dialog({width:1020,height:500,title:e.Msg.translate(e.Env.getCtx(),"InfoProduct"),resizable:!1,modal:!0,closeText:e.Msg.getMsg("close"),close:ht}),null!=c&&c.length>0&&(Oe=e.Env.parseContext(e.Env.getCtx(),n,c,!1,!1)),vt(!0,I.val())}})};var vt=function(i,n){if(d&&w2ui[ee]){var a=w2ui[ee].getSelection();for(s in a)-1==X.indexOf(w2ui[ee].get(a[s])[K])&&(X.push(w2ui[ee].get(a[s])),Ye(!1))}else Ye(!0);i&&Ye(!0),mt();for(var s in Q)Q[s].AD_Reference_ID==e.DisplayType.ID&&"M_PRODUCT_ID"==Q[s].ColumnName.toUpperCase()&&(K=Q[s].ColumnName.toUpperCase());if(1==i)for(var l=null,r=0;r<z.length;r++)null!=(l=z[r].Ctrl.getValue())&&0!=l.length&&0!=l&&l?(z[r].Value=l,z[r].CtrlColumnName=z[r].Ctrl.colName,10==z[r].Ctrl.displayType&&(l=e.DB.to_string(l))):z[r].Value="";n||(n=1);var c=[];if(z&&Object.keys(z).length>0)for(var p=0;p<Object.keys(z).length;p++){var u={};u.CtrlColumnName=z[p].CtrlColumnName,u.ColumnName=z[p].ColumnName,u.Value=z[p].Value,c.push(u)}t.ajax({url:e.Application.contextUrl+"InfoProduct/GetData",dataType:"json",type:"POST",data:{tableName:o,pageNo:n,ForMobile:Ne,Requery:i,SrchCtrl:JSON.stringify(c),Validation:e.secureEngine.encrypt(Oe),Window_ID:Y},error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),H[0].style.visibility="hidden"},success:function(i){var n=JSON.parse(i);if(null!=n){if(n.Error)return e.ADialog.error(n.Error),void(H[0].style.visibility="hidden");!function(e){if(I=null,f.find("select").remove(),I=t("<select>"),f.append(I),I.on("change",(function(){H[0].style.visibility="visible",d&&!Ve&&B.show(),vt(!0,I.val())})),e.TotalPage>0){for(var i=0;i<e.TotalPage;i++)I.append(t("<option value="+(i+1)+">"+(i+1)+"</option>"));I.val(e.CurrentPage),e.TotalPage>e.CurrentPage?(m.css("opacity","1"),y.css("opacity","1")):(m.css("opacity","0.6"),y.css("opacity","0.6")),e.CurrentPage>1?(h.css("opacity","1"),v.css("opacity","1")):(h.css("opacity","0.6"),v.css("opacity","0.6")),1==e.TotalPage&&(h.css("opacity","0.6"),v.css("opacity","0.6"),m.css("opacity","0.6"),y.css("opacity","0.6"))}else h.css("opacity","0.6"),v.css("opacity","0.6"),m.css("opacity","0.6"),y.css("opacity","0.6");var n=e.CurrentPage,a=e.PageSize,s=e.TotalRecords,l=(n-1)*a,o=l+a;o>s&&(o=s);0==s&&(l-=1);var r=Pe+" "+(l+1)+"-"+o+" "+Ue+" "+s;Ee.text(r)}(n.pSetting),ft(n.data)}else H[0].style.visibility="hidden"}})},ft=function(i){if(null==i)return alert(e.Msg.getMsg("NoDataFound")),void(H[0].style.visibility="hidden");var n=[],a=[],s=null;for(var l in i){var o={resizable:!0};s=Q[l].AD_Reference_ID,o.caption=Q[l].Name,o.field=Q[l].ColumnName.toUpperCase(),o.columnName=Q[l].ColumnName.toUpperCase(),o.sortable=!0,o.hidden=!1,o.size="100px",e.DisplayType.IsNumeric(s)?(s==e.DisplayType.Integer?o.render="int":o.render=function(t,i,a){return e.Utility.Util.getValueOfDecimal(t[n[a].field]).toLocaleString(void 0,{minimumFractionDigits:2})},"QTYENTERED"==Q[l].ColumnName.toUpperCase()&&d&&!Ve&&(o.editable={type:"number"},o.render=function(e,t,i){var a=e[n[i].field];return a=Xe(event,a),parseFloat(a).toLocaleString(void 0,{minimumFractionDigits:2})})):e.DisplayType.IsDate(s)?o.render=function(e,t,i){var a=e[n[i].field];return a=a?new Date(a).toLocaleDateString():""}:s==e.DisplayType.Location||s==e.DisplayType.Locator||s==e.DisplayType.Account||s==e.DisplayType.PAttribute?o.render="int":s==e.DisplayType.Button?o.render=function(e){return"<div>button</div>"}:s==e.DisplayType.Image?o.render=function(e){return"<div>Image</div>"}:e.DisplayType.IsLOB(s)&&(o.render=function(e){return"<div>[Lob-blob]</div>"}),n[l]=o}n[n.length]={field:"M_AttributeSetInstance_ID",caption:"M_AttributeSetInstance_ID",size:"150px",hidden:!0};for(var r=0;r<i[0].RowCount;r++){var c={};for(var l in i)c[i[l].ColumnName.toUpperCase()]=i[l].Values[r];c.M_AttributeSetInstance_ID=0,c.recid=r+1,a[r]=c}!d&&(X.length>0||w2ui[ee]&&w2ui[ee].getSelection().length>0)&&Ye(!0),ee=(ee="gridPrdInfodata"+Math.random()).replace(".",""),w2utils.encodeTags(a),J=t(x).w2grid({name:ee,recordHeight:40,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:n,records:a,onExpand:function(i){H[0].style.visibility="visible",function(i){if(null!=i){for(var n=0,a=e.Utility.Util.getValueOfInt(w2ui[ee].records[i.recid-1].M_PRODUCT_ID),s=e.Utility.Util.getValueOfInt(w2ui[ee].records[i.recid-1].M_WAREHOUSE_ID),l="",o=0;o<z.length;o++)"M_AttributeSetInstance_ID"==z[o].Ctrl.colName&&(n=e.Utility.Util.getValueOfInt(z[o].Ctrl.value));for(o=0;o<z.length;o++)"AttributeCode"==z[o].Ctrl.colName&&(l=z[o].Ctrl.getValue());a>0&&s>0&&t.ajax({url:e.Application.contextUrl+"InfoProduct/GetVariants",dataType:"json",type:"POST",async:!1,data:{M_Product_ID:a,M_Warehouse_ID:s,ParentRec_ID:i.recid,M_AttributeSetInstance_ID:n,AttributeCode:l},error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),H[0].style.visibility="hidden"},success:function(e){var t,i=JSON.parse(e);null!=(t=i)&&(ze=t)}})}}(i),w2ui.hasOwnProperty("subgrid-"+i.recid)&&w2ui["subgrid-"+i.recid].destroy(),-1==he.indexOf(i.recid)&&he.push(i.recid),t("#"+i.box_id).css({margin:"0px",padding:"0px",width:"100%",height:"105px"}),setTimeout((function(){t("#"+i.box_id).w2grid({name:"subgrid-"+i.recid,show:{columnHeaders:!0,selectColumn:!0},fixedBody:!0,columns:ge,records:ze,onChange:function(e){var t=-1,i=w2ui[e.target].records[e.index].ParentRec_ID;if(X.length>0){for(var n in X)if(X[n].M_PRODUCT_ID==w2ui[ee].records[i-1].M_PRODUCT_ID&&X[n].M_AttributeSetInstance_ID==w2ui[e.target].records[e.index].M_AttributeSetInstance_ID){t=n;break}if(t>-1)X[t].QTYENTERED=e.value_new;else{var a=w2ui[ee].records[i-1];(s=JSON.parse(JSON.stringify(a))).M_AttributeSetInstance_ID=w2ui[e.target].records[e.index].M_AttributeSetInstance_ID,s.QTYENTERED=e.value_new,X.push(s)}}else{var s;a=w2ui[ee].records[i-1];(s=JSON.parse(JSON.stringify(a))).M_AttributeSetInstance_ID=w2ui[e.target].records[e.index].M_AttributeSetInstance_ID,s.QTYENTERED=e.value_new,X.push(s)}}}),w2ui["subgrid-"+i.recid].resize(),H[0].style.visibility="hidden"}),500)},onEditField:function(e){if(id=e.recid,5==e.column){w2ui[ee].records[e.index].QTYENTERED=Xe(e,w2ui[ee].records[e.index].QTYENTERED);var i=ve.GetFormatAmount(w2ui[ee].records[e.index].QTYENTERED,"init",fe);w2ui[ee].records[e.index].QTYENTERED=ve.GetConvertedString(i,fe),t("#grid_"+J.name+"_rec_"+id).keydown((function(e){return!!(fe||190!=e.keyCode&&110!=e.keyCode)&&((!fe||188!=e.keyCode)&&(!e.target.value.contains(".")||110!=e.which&&190!=e.which&&188!=e.which?!e.target.value.contains(",")||110!=e.which&&190!=e.which&&188!=e.which||e.target.value.indexOf(",")>-1&&(e.target.value=e.target.value.replace(",","")):e.target.value.indexOf(".")>-1&&(e.target.value=e.target.value.replace(".","")),!(8!=e.keyCode&&9!=e.keyCode&&(e.keyCode<37||e.keyCode>40)&&(e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&109!=e.keyCode&&189!=e.keyCode&&110!=e.keyCode&&144!=e.keyCode&&188!=e.keyCode&&190!=e.keyCode)&&void 0))}))}},onChange:function(e){var t=-1,i=ve.GetConvertedNumber(e.value_new,fe);if(w2ui[ee].records[e.index].QTYENTERED=i.toFixed(2),X.length>0){for(var n in X)if(X[n].M_PRODUCT_ID==w2ui[ee].records[e.index].M_PRODUCT_ID&&0==X[n].M_AttributeSetInstance_ID){t=n;break}t>-1?X[t].QTYENTERED=i.toFixed(2):X.push(w2ui[ee].records[e.index])}else X.push(w2ui[ee].records[e.index])},onSelect:at,onUnselect:st}),w2ui[ee].hideColumn("M_PRODUCT_ID"),w2ui[ee].hideColumn("C_UOM_ID"),w2ui[ee].hideColumn("UOM"),w2ui[ee].hideColumn("M_WAREHOUSE_ID"),w2ui[ee].hideColumn("M_PRICELIST_VERSION_ID"),d&&!Ve||w2ui[ee].hideColumn("QTYENTERED"),H[0].style.visibility="hidden"},mt=function(){null!=J&&J.destroy(),J=null};this.getSelectedValues=function(){return X},this.getRefreshStatus=function(){return Te};var yt=function(){d&&(X.length>0||w2ui[ee].getSelection().length>0)&&It()},It=function(){if(w2ui[ee].getSelection().length>0){var t=w2ui[ee].getSelection();for(var i in t){var a=w2ui[ee].get(t[i]).M_PRODUCT_ID,s="subgrid-"+w2ui[ee].get(t[i]).recid;if(null!=w2ui[s])if(w2ui[s].getSelection().length>0){var l=w2ui[s].getSelection();for(var o in l)if(X.length>0){if((c=X.map((function(e){return e.M_PRODUCT_ID==a&&e.M_AttributeSetInstance_ID==w2ui[s].records[l[o]-1].M_AttributeSetInstance_ID})).indexOf(!0))>-1)continue;var r=w2ui[ee].get(t[i]);(d=JSON.parse(JSON.stringify(r))).M_AttributeSetInstance_ID=w2ui[s].records[l[o]-1].M_AttributeSetInstance_ID,d.QTYENTERED=w2ui[s].records[l[o]-1].Quantity,X.push(d)}else{var d;r=w2ui[ee].get(t[i]);(d=JSON.parse(JSON.stringify(r))).M_AttributeSetInstance_ID=w2ui[s].records[l[o]-1].M_AttributeSetInstance_ID,d.QTYENTERED=w2ui[s].records[l[o]-1].Quantity,X.push(d)}}else if(X.length>0){if((c=X.map((function(e){return e.M_PRODUCT_ID==a&&0==e.M_AttributeSetInstance_ID})).indexOf(!0))>-1)continue;X.push(w2ui[ee].get(t[i]))}else X.push(w2ui[ee].get(t[i]));else if(X.length>0){if((c=X.map((function(e){return e.M_PRODUCT_ID==a&&0==e.M_AttributeSetInstance_ID})).indexOf(!0))>-1)continue;X.push(w2ui[ee].get(t[i]))}else X.push(w2ui[ee].get(t[i]))}}if(X.length>0)for(var i in X){var c,p=X[i].QTYENTERED;if(p>0)if(xe.length>0)(c=xe.map((function(e){return e._prdID==X[i].M_PRODUCT_ID&&e._Attribute==X[i].M_AttributeSetInstance_ID})).indexOf(!0))>-1?xe[c]._prodQty+=p:xe.push({_prodQty:p,_prdID:X[i].M_PRODUCT_ID,_prdName:X[i].NAME,_value:X[i].VALUE,_uom:X[i].C_UOM_ID,_uomName:X[i].UOM,_AD_Session_ID:e.Env.getCtx().getContext("#AD_Session_ID"),_windowNo:n,_RefNo:"",_Attribute:X[i].M_AttributeSetInstance_ID,_AttributeName:"",_Locator_ID:0,_IsLotSerial:"N",_countID:0});else xe.push({_prodQty:p,_prdID:X[i].M_PRODUCT_ID,_prdName:X[i].NAME,_value:X[i].VALUE,_uom:X[i].C_UOM_ID,_uomName:X[i].UOM,_AD_Session_ID:e.Env.getCtx().getContext("#AD_Session_ID"),_windowNo:n,_RefNo:"",_Attribute:X[i].M_AttributeSetInstance_ID,_AttributeName:"",_Locator_ID:0,_IsLotSerial:"N",_countID:0})}},Dt=function(){if(b.off("keyup"),W.off("click"),j.off("click"),q.off("click"),h.off("click"),v.off("click"),m.off("click"),y.off("click"),I.off("change"),h=v=m=y=I=null,x=null,S=null,null!=J&&J.destroy(),J=null,null,C=null,null,null,null,_=null,S=null,x=null,A=null,T=null,O=null,L=null,R=null,W=null,j=null,G=null,q=null,F=null,H=null,null,z=null,Q=null,J=null,$=null,K=null,X=null,null,xe=null,Ae=null,Te=!1,Ne=null,Me=null,null!=b&&(b.dialog("destroy"),b.remove()),b=null,this.btnOKClick=null,this.displaySearchCol=null,this.displayData=null,this.loadData=null,this.disposeComponent=null,this.disposeDataSec=null,this.getSelectedValues=null,this.refreshUI=null,he.length>0){for(var e=0;e<he.length;e++)w2ui["subgrid-"+he[e]].destroy();he=[]}}}}(VIS,jQuery)},6393:()=>{!function(e,t){function i(i,n){this.onClose=null,this.arrListColumns=[];var a,s,l,o,r,d,c,p,u,g=t("<div>"),h=t("<div class='vis-info-subroot'>"),v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=this,k=null,O=null,L=null,R=null,E=null,P=null,U=t("<table>"),F=null,B=[],W=[],j=(/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase()),e.context.getWindowTabContext(i,0,"AD_Tab_ID"));a=e.dataContext.getJSONRecord("InfoProduct/GetWindowID",j.toString()),function(){g.css("width","100%"),g.css("height","100%"),g.css("position","relative"),U.css("width","100%"),v=t("<div class='vis-info-l-s-wrap vis-pad-0 vis-leftsidebarouterwrap'>"),f=t("<div class='vis-info-l-s-content'>"),v.append(f),m=t("<div class='vis-info-datasec'>"),y=t("<div class='vis-info-btnsec vis-just-cont-end'>"),h.append(v),h.append(m),h.append(y),(k=e.Msg.translate(e.Env.getCtx(),"Name")).indexOf("&")>-1&&(k=k.replace("&","")),(O=e.Msg.translate(e.Env.getCtx(),"ReferenceNo")).indexOf("&")>-1&&(O=lblUPCtxt.replace("&","")),(L=e.Msg.translate(e.Env.getCtx(),"FromDate")).indexOf("&")>-1&&(L=L.replace("&","")),(R=e.Msg.translate(e.Env.getCtx(),"ToDate")).indexOf("&")>-1&&(R=R.replace("&","")),(D=e.Msg.getMsg("Cancel")).indexOf("&")>-1&&(D=D.replace("&","")),(I=e.Msg.getMsg("Search")).indexOf("&")>-1&&(I=I.replace("&","")),(w=e.Msg.getMsg("Ok")).indexOf("&")>-1&&(w=w.replace("&","")),b=t("<div class='vis-info-btnswrap'>"),C=t("<div class='vis-info-ls-btnswrap'>"),F=t("<tr>"),U.append(F);var n=t("<td>"),a=t('<div class="input-group vis-input-wrap">'),N=t('<div class="vis-control-wrap">');E=t("<label class='VIS_Pref_Label_Font'>").append(k),F.append(n),n.append(a),a.append(N);var M={};P=new e.Controls.VTextBox("Name",!1,!1,!0,50,100,null,null,!1),M.Ctrl=P,M.AD_Reference_ID=10,M.ColumnName="Name",t("<td>"),N.append(P.getControl().attr("data-placeholder","").attr("placeholder"," ")),N.append(E),B.push(M),F=t("<tr>"),U.append(F),n=t("<td>"),a=t('<div class="input-group vis-input-wrap">'),N=t('<div class="vis-control-wrap">'),E=t("<label class='VIS_Pref_Label_Font'>").append(O),F.append(n),n.append(a),a.append(N),M={},P=new e.Controls.VTextBox("Reference",!1,!1,!0,50,100,null,null,!1),M.Ctrl=P,M.AD_Reference_ID=10,M.ColumnName="Reference",t("<td>"),N.append(P.getControl().attr("data-placeholder","").attr("placeholder"," ")),N.append(E),B.push(M),F=t("<tr>"),U.append(F),n=t("<td>"),a=t('<div class="input-group vis-input-wrap">'),N=t('<div class="vis-control-wrap">'),E=t("<label class='VIS_Pref_Label_Font'>").append(L),F.append(n),n.append(a),a.append(N),M={},P=new e.Controls.VDate("TrxFromDate",!1,!1,!0,e.DisplayType.Date,e.Msg.translate("FromDate")),M.Ctrl=P,M.AD_Reference_ID=10,M.ColumnName="TrxFromDate",t("<td>"),N.append(P.getControl().attr("data-placeholder","").attr("placeholder"," ")),N.append(E),B.push(M),F=t("<tr>"),U.append(F),n=t("<td>"),a=t('<div class="input-group vis-input-wrap">'),N=t('<div class="vis-control-wrap">'),E=t("<label class='VIS_Pref_Label_Font'>").append(R),F.append(n),n.append(a),a.append(N),M={},P=new e.Controls.VDate("TrxToDate",!1,!1,!0,e.DisplayType.Date,e.Msg.translate("ToDate")),M.Ctrl=P,M.AD_Reference_ID=10,M.ColumnName="TrxToDate",t("<td>"),N.append(P.getControl().attr("data-placeholder","").attr("placeholder"," ")),N.append(E),B.push(M),f.append(U),_=t("<button class='VIS_Pref_btn-2'>").append(D),S=t("<button class='VIS_Pref_btn-2'>").append(w),x=t("<button class='VIS_Pref_btn-2'>").append(I),b.append(_),b.append(S),b.append(t('<div><input type="checkbox" id="chkDelCart_'+i+'" ><span>'+e.Msg.getMsg("DeleteCart")+"</span>")),C.append(x),v.append(C),y.append(b),s=t('<div class="vis-info-pagingwrp">'),l=t('<ul class="vis-statusbar-ul">'),o=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="First Page" style="opacity: 0.6;"></i></div></li>'),r=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="Page Up" style="opacity: 0.6;"></i></div></li>'),u=t("<select>"),d=t("<li>").append(u),c=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="Page Down" style="opacity: 0.6;"></i></div></li>'),p=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="Last Page" style="opacity: 0.6;"></i></div></li>'),l.append(o).append(r).append(d).append(c).append(p),o.on("click",(function(){"1"==t(this).css("opacity")&&(V[0].style.visibility="visible",G(!0,1))})),r.on("click",(function(){"1"==t(this).css("opacity")&&(V[0].style.visibility="visible",G(!0,parseInt(u.val())-1))})),c.on("click",(function(){"1"==t(this).css("opacity")&&(V[0].style.visibility="visible",G(!0,parseInt(u.val())+1))})),p.on("click",(function(){"1"==t(this).css("opacity")&&(V[0].style.visibility="visible",G(!0,parseInt(u.find("Option:last").val())))})),u.on("change",(function(){V[0].style.visibility="visible",G(!0,u.val())})),s.append(l),b.append(_),b.append(S),C.append(x),v.append(C),y.append(T),y.append(s),y.append(b),(V=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",A=y.find("#chkDelCart_"+i),g.append(h),g.append(V)}(),e.Application.isMobile||g.on("keyup",(function(e){13===e.keyCode&&(V[0].style.visibility="visible",W=[],N.selectNone(),G(!0,u.val()))})),_.on("click",(function(){M.dispose()})),S.on("click",(function(){H()})),x.on("click",(function(){V[0].style.visibility="visible",W=[],N.selectNone(),G(!0,1)}));var G=function(s,l){if(N){var g=N.getSelection();for(item in g)-1==W.indexOf(N.get(g[item]).count_ID)&&W.push(N.get(g[item]).count_ID)}var h=0,v=0,f=0,m=0,y=0;if(1==s){for(var I=null,D=0;D<B.length;D++)null!=(I=B[D].Ctrl.getValue())&&0!=I.length&&0!=I?(B[D].Value=I,B[D].CtrlColumnName=B[D].Ctrl.colName):B[D].Value="";184==a?y=e.Utility.Util.getValueOfInt(e.context.getWindowTabContext(i,0,"C_BPartner_ID")):319==a||170==a?(h=e.Utility.Util.getValueOfInt(e.context.getWindowContext(i,"M_Locator_ID",!0)),v=e.Utility.Util.getValueOfInt(e.context.getWindowContext(i,"M_LocatorTo_ID",!0)),f=e.Utility.Util.getValueOfInt(e.context.getWindowContext(i,"DTD001_MWarehouseSource_ID",!0)),m=e.Utility.Util.getValueOfInt(e.context.getWindowContext(i,"M_Warehouse_ID",!0))):168==a?f=e.Utility.Util.getValueOfInt(e.context.getWindowContext(i,"M_Warehouse_ID",!0)):169==a?y=e.context.getWindowTabContext(i,0,"C_BPartner_ID"):341==a&&(f=e.Utility.Util.getValueOfInt(e.context.getWindowContext(i,"M_Warehouse_ID",!0)))}l||(l=1);var w=[];if(B&&Object.keys(B).length>0)for(var b=0;b<Object.keys(B).length;b++){var C={};C.CtrlColumnName=B[b].CtrlColumnName,C.Value=B[b].Value,w.push(C)}t.ajax({url:e.Application.contextUrl+"InfoProduct/GetCart",dataType:"json",data:{pageNo:l,isCart:n,windowID:a,WarehouseID:f,WarehouseToID:m,LocatorID:h,LocatorToID:v,BPartnerID:y,srchCtrl:JSON.stringify(w),requery:s},error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),V[0].style.visibility="hidden"},success:function(i){var n=JSON.parse(i);if(null!=n){if(n.Error)return e.ADialog.error(n.Error),void(V[0].style.visibility="hidden");!function(e){if(u=null,d.find("select").remove(),u=t("<select>"),d.append(u),u.on("change",(function(){V[0].style.visibility="visible",G(!0,u.val())})),e.TotalPage>0){for(var i=0;i<e.TotalPage;i++)u.append(t("<option value="+(i+1)+">"+(i+1)+"</option>"));u.val(e.CurrentPage),e.TotalPage>e.CurrentPage?(c.css("opacity","1"),p.css("opacity","1")):(c.css("opacity","0.6"),p.css("opacity","0.6")),e.CurrentPage>1?(o.css("opacity","1"),r.css("opacity","1")):(o.css("opacity","0.6"),r.css("opacity","0.6")),1==e.TotalPage&&(o.css("opacity","0.6"),r.css("opacity","0.6"),c.css("opacity","0.6"),p.css("opacity","0.6"))}else o.css("opacity","0.6"),r.css("opacity","0.6"),c.css("opacity","0.6"),p.css("opacity","0.6")}(n.pSetting),q(n.data)}else V[0].style.visibility="hidden"}})},q=function(i){if(null!=i){null!=N&&(N.destroy(),N=null),N=null,M.arrListColumns=[],M.arrListColumns.push({field:"Name",caption:e.Msg.translate(e.Env.getCtx(),"Name"),sortable:!0,size:"16%",min:150,hidden:!1}),M.arrListColumns.push({field:"Reference",caption:e.Msg.translate(e.Env.getCtx(),"ReferenceNo"),sortable:!0,size:"16%",min:150,hidden:!1}),M.arrListColumns.push({field:"TrxDate",caption:e.Msg.translate(e.Env.getCtx(),"DateTrx"),sortable:!0,size:"16%",min:150,hidden:!1,render:"date"}),M.arrListColumns.push({field:"count_ID",caption:e.Msg.translate(e.Env.getCtx(),"ID"),sortable:!0,size:"16%",min:150,hidden:!0});var n="gridPrdInfodata"+Math.random();for(itm in n=n.replace(".",""),w2utils.encodeTags(i),(N=t(m).w2grid({name:n,recordHeight:30,show:{columnHeaders:!0,lineNumbers:!0,selectColumn:!0},columns:M.arrListColumns,records:i,onClick:function(e){N.records.length>0&&S.removeAttr("disabled")}})).selectNone(),W)for(item in N.records)N.records[item].count_ID==W[itm]&&N.select(parseInt(item)+1);N.on("unselect",(function(e){if(e.all)e.onComplete=function(){for(item in N.records){var e=N.records[item].count_ID;W.indexOf(e)>-1&&W.splice(W.indexOf(e),1)}};else{var t=N.records[e.index].count_ID;W.indexOf(t)>-1&&W.splice(W.indexOf(t),1)}})),V[0].style.visibility="hidden"}else V[0].style.visibility="hidden"},H=function(){var t="";if(null!=N){var i=N.getSelection();if(i.length>0)for(var n in i)-1==W.indexOf(N.get(i[n]).count_ID)&&W.push(N.get(i[n]).count_ID);if(W.length>0){for(var n in W)t+=W[n]+",";t=t.substr(0,t.length-1);var s=e.dataContext.getJSONData(e.Application.contextUrl+"InfoProduct/GetCartData",{invCount_ID:t,WindowID:a},null);M.onClose&&M.onClose(s,A.prop("checked"),t),g.dialog("close")}else alert("Please Select a Record")}};this.showDialog=function(){g.dialog({modal:!0,title:e.Msg.translate(e.Env.getCtx(),"Info Scan"),width:800,height:450,resizable:!1,close:function(){M.dispose()}}),G(!1,u.val())},this.disposeComponent=function(){g.off("keyup"),_.off("click"),S.off("click"),x.off("click"),m=null,f=null,o.off("click"),r.off("click"),c.off("click"),p.off("click"),u.off("change"),o=r=c=p=u=null,null!=N&&N.destroy(),N=null,null,h=null,v=null,y=null,I=null,D=null,w=null,b=null,_=null,S=null,A=null,T=null,V=null,B=null,M=null,!1,null!=g&&(g.dialog("destroy"),g.remove()),g=null,this.displayData=null,this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()},e.InfoScanForm=i}(VIS,jQuery)},7350:()=>{!function(e,t){function i(i,n,a,s,l,o){this.onClose=null,this.selectedIDs=o;var r,d,c,p,u,g,h,v,f,m=t("<div class='vis-forms-container'>"),y=t("<div class='vis-info-subroot'>"),I=null,D=null,w=null,b=[];this.keyCol="",this.windowNo=a;var C,_,S,x,A,T,V,N,M,k=this,O=[],L=null,R=null,E=e.Msg.getMsg("ShowingResult"),P=e.Msg.getMsg("of");function U(){null!=k.onClose&&k.onClose(),J()}!function(){m.css("width","100%"),m.css("height","100%"),m.css("position","relative"),r=t("<div class='vis-info-l-s-wrap vis-leftsidebarouterwrap'>"),d=t("<div>"),r.append(d),c=t("<div class='vis-info-datasec'>"),p=t("<div class='vis-info-btnsec'>"),y.append(r),y.append(c),y.append(p);var i=e.Msg.getMsg("Refresh");i.indexOf("&")>-1&&(i=i.replace("&",""));var a=e.Msg.getMsg("Cancel");a.indexOf("&")>-1&&(a=a.replace("&",""));var s=e.Msg.getMsg("Ok");s.indexOf("&")>-1&&(s=s.replace("&","")),g=t("<div class='vis-info-btnswrap'>"),h=t("<button class='VIS_Pref_btn-2'>").append(a),v=t("<button class='VIS_Pref_btn-2'>").append(s);var o=t("<div class='vis-info-btnleft'>");f=t("<button class='VIS_Pref_btn-2' style='margin-top: 10px;'>").append(t("<i class='vis vis-refresh'></i>")),C=t('<div class="vis-info-pagingwrp">'),_=t('<ul class="vis-statusbar-ul">'),M=t('<li class="flex-fill"><section class="vis-ad-w-p-s-result"><span></span></section></li>'),S=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" title="'+e.Msg.getMsg("FirstPage")+'" style="opacity: 0.6;"></i></div></li>'),x=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+e.Msg.getMsg("PageUp")+'" style="opacity: 0.6;"></i></div></li>'),N=t("<select>"),A=t("<li>").append(N),T=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+e.Msg.getMsg("PageDown")+'" style="opacity: 0.6;"></i></div></li>'),V=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" title="'+e.Msg.getMsg("LastPage")+'" style="opacity: 0.6;"></i></div></li>'),R=M.find(".vis-ad-w-p-s-result").find("span"),_.append(M).append(S).append(x).append(A).append(T).append(V),S.on("click",(function(){"1"==t(this).css("opacity")&&W(!0,1)})),x.on("click",(function(){"1"==t(this).css("opacity")&&W(!0,parseInt(N.val())-1)})),T.on("click",(function(){"1"==t(this).css("opacity")&&W(!0,parseInt(N.val())+1)})),V.on("click",(function(){"1"==t(this).css("opacity")&&W(!0,parseInt(N.find("Option:last").val()))})),N.on("change",(function(){W(!0,N.val())})),C.append(_),g.append(h),g.append(v),o.append(f),p.append(o),p.append(C),p.append(g),u=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),m.append(y),m.append(u),1==l&&null!=k.selectedIDs&&k.selectedIDs.length>0&&(O=k.selectedIDs.split(",").map(Number),n=null)}(),v.on("click",(function(){Q()})),f.on("click",(function(){u[0].style.visibility="visible",null!=s&&null!=s&&s.length>0&&(s=e.Env.parseContext(e.Env.getCtx(),a,s,!1,!1)),W(!0,N.val())})),h.on("click",(function(){null!=k.onClose&&k.onClose(),J()})),e.Application.isMobile||m.on("keyup",(function(t){13===t.keyCode&&(u[0].style.visibility="visible",null!=s&&null!=s&&s.length>0&&(s=e.Env.parseContext(e.Env.getCtx(),a,s,!1,!1)),W(!0,N.val()))})),this.show=function(){var n=k;t.ajax({url:e.Application.contextUrl+"InfoWindow/GetSearchColumn/?Ad_InfoWindow_ID="+i,dataType:"json",error:function(){alert(e.Msg.getMsg("ERRORGettingSchema")),u[0].style.visibility="hidden"},success:function(t){null!=t.result&&null!=t.result.Schema?(D=t.result,null!=(w=D.Schema)?F(n):alert(e.Msg.getMsg("ERRORGettingSchema"))):alert(e.Msg.getMsg("ERRORGettingSchema"))}})};var F=function(i){var l=null,o=t("<table>");o.css("width","100%");var r=null,c=!1,p=null,u=null,g=null;for(var h in w)if(w[h].IsQueryCriteria){c=!1;var v=t("<td class='vis-gc-vpanel-table-td1'>"),f=t('<div class="input-group vis-input-wrap">'),y=t('<div class="vis-control-wrap">'),I=t('<div class="input-group-append">');r=t("<tr>"),o.append(r),r.append(v),v.append(f),f.append(y);var C={};if(p=w[h].AD_Reference_ID,l=B(w[h].AD_Reference_ID,w[h].ColumnName,w[h].Name,w[h].AD_Reference_Value_ID,w[h].lookup),C.Ctrl=l,C.InfoColumnID=w[h].InfoColumnID,null!=w[h].SetValue){var _=!1;if(null!=w[h].Condition){for(var S=[],x=[],A=new e.StringTokenizer(w[h].Condition,"[]");A.hasMoreTokens();){var T=A.nextToken();T.trim()!=" & ".trim()?(_=e.Evaluator.evaluateLogic(i,T),S.push(_)):x.push(T)}S.length>1?x[0].trim().equals("&")?_=!(S.indexOf(!1)>-1):x[0].trim().equals("|")&&S.indexOf(!0)>-1&&(_=!0):1==S.length&&1==S[0]&&(_=!0)}else _=!0;_&&(p==e.DisplayType.YesNo?"Y"==w[h].SetValue.toUpperCase()?l.getControl().find("input").prop("checked",!0):"N"==w[h].SetValue.toUpperCase()&&l.getControl().find("input").prop("checked",!1):w[h].SetValue.contains("@")?(u=w[h].SetValue.substring(1,w[h].SetValue.lastIndexOf("@")),(g=e.context.getWindowContext(a,u,!1)).equals("")?l.setValue(null):l.setValue(g)):l.setValue(w[h].SetValue))}C.AD_Reference_ID=w[h].AD_Reference_ID,C.ColumnName=w[h].SelectClause,C.ColumnName.toUpperCase().indexOf(" AS ")>-1?C.SearchColumnName=C.ColumnName.substring(0,C.ColumnName.toUpperCase().indexOf(" AS ")):C.SearchColumnName=C.ColumnName,w[h].ISIDENTIFIER&&null!=n&&l.setValue(n);t("<td>");if(2==(O=l.getBtnCount()))y.append(l.getControl().attr("data-placeholder","").attr("placeholder"," ")),null!=(L=l.getBtn(0))&&(I.append(L.css("class","vis-controls-txtbtn-table-td2")),l.getControl().attr("data-hasbtn"," ")),null!=(L=l.getBtn(1))&&(I.append(L.css("class","vis-controls-txtbtn-table-td2")),l.getControl().attr("data-hasbtn"," ")),O=-1,l=null,f.append(I);else if(1==O){y.append(l.getControl().attr("data-placeholder","").attr("placeholder"," ")),null!=(L=l.getBtn(0))&&(I.append(L.css("class","vis-controls-txtbtn-table-td2")),l.getControl().attr("data-hasbtn"," ")),O=-1,l=null,f.append(I)}else c&&l.getControl(),w[h].AD_Reference_ID==e.DisplayType.YesNo&&l.getControl(),y.append(l.getControl().attr("data-placeholder","").attr("placeholder"," "));if(w[h].IsRange){C.IsRange=!0;var V=t('<div class="input-group vis-input-wrap">'),M=t('<div class="vis-control-wrap">'),k=t('<div class="input-group-append">');r=t("<tr>"),o.append(r),l=B(w[h].AD_Reference_ID,w[h].ColumnName,w[h].Name),C.CtrlTo=l;var O,L,R=t("<td>");if(r.append(R),R.append(V),V.append(M),2==(O=l.getBtnCount()))c&&l.getControl(),M.append(l.getControl().attr("data-placeholder","").attr("placeholder"," ")),null!=(L=l.getBtn(0))&&(k.append(L.css("class","vis-controls-txtbtn-table-td2")),l.getControl().attr("data-hasbtn"," ")),null!=(L=l.getBtn(1))&&(k.append(L.css("class","vis-controls-txtbtn-table-td2")),l.getControl().attr("data-hasbtn"," ")),O=-1,l=null,V.append(k);else c&&l.getControl(),w[h].AD_Reference_ID,e.DisplayType.YesNo,l.getControl(),M.append(l.getControl().attr("data-placeholder","").attr("placeholder"," "));M.append(new e.Controls.VLabel(e.Msg.getMsg("To"),w[h].ColumnName).getControl())}else C.IsRange=!1;if(1,b.push(C),w[h].AD_Reference_ID!=e.DisplayType.YesNo&&w[h].AD_Reference_ID!=e.DisplayType.Button&&w[h].AD_Reference_ID!=e.DisplayType.Label){var E=new e.Controls.VLabel(w[h].Name,w[h].ColumnName).getControl();y.append(E)}else c=!0}d.append(o);var P=e.Msg.getMsg("Refresh");P.indexOf("&")>-1&&(P=P.replace("&",""));var F=e.Msg.getMsg("Cancel");F.indexOf("&")>-1&&(F=F.replace("&",""));var j=e.Msg.getMsg("Ok");j.indexOf("&")>-1&&(j=j.replace("&","")),m.dialog({width:1020,height:487,resizable:!1,title:D.WindowName,modal:!0,closeText:e.Msg.getMsg("close"),close:U}),null!=s&&null!=s&&s.length>0&&(s=e.Env.parseContext(e.Env.getCtx(),a,s,!1,!1)),W(!0,N.val())},B=function(t,i,n,s,l){var o=null;if(t==e.DisplayType.Button)o=new e.Controls.VButton(i,!1,!1,!0,n,null,null,0);else if(t==e.DisplayType.String){var r=new e.Controls.VTextBox(i,!1,!1,!0,50,100,null,null,!1);o=r,r.click=function(){!0}}else if(t==e.DisplayType.YesNo){o=new e.Controls.VCheckBox(i,!1,!1,!0,n,null)}else if(e.DisplayType.IsDate(t)){t==e.DisplayType.DateTime&&(readOnly=!0);var d=new e.Controls.VDate(i,!1,!1,!0,t,n);d.setName(i),o=d}else if(e.DisplayType.IsLookup(t)||e.DisplayType.ID==t){l=e.MLookupFactory.get(e.Env.getCtx(),a,0,t,i,s,!1,null);if(t!=e.DisplayType.Search&&t!=e.DisplayType.MultiKey){o=new e.Controls.VComboBox(i,!1,!1,!0,l,50)}else{t=e.DisplayType.Search;var c=new e.Controls.VTextBoxButton(i,!1,!1,!0,t,l);c.getBtn(),o=c}}else if(t==e.DisplayType.Location){o=new e.Controls.VLocation(i,!1,!1,!0,t,null)}else if(t==e.DisplayType.Locator){o=new e.Controls.VLocator(i,!1,!1,!0,t,l)}else if(e.DisplayType.Text==t||e.DisplayType.TextLong==t){o=new e.Controls.VTextArea(i,!1,!1,!0,50,100,t)}else if(e.DisplayType.IsNumeric(t)){if(e.DisplayType.Amount==t)o=new e.Controls.VAmountTextBox(i,!1,!1,!0,50,100,t,n);else if(e.DisplayType.Integer==t){o=new e.Controls.VNumTextBox(i,!1,!1,!0,50,100,n)}else if(e.DisplayType.Number==t){o=new e.Controls.VAmountTextBox(i,!1,!1,!0,50,100,t,n)}}else if(t==e.DisplayType.PAttribute){(p=new e.Controls.VPAttribute(i,!1,!1,!0,t,l,a,!1,!1,!1,!0)).getBtn(0),o=p}else if(t==e.DisplayType.GAttribute){var p;(p=new e.Controls.VPAttribute(i,!1,!1,!0,t,l,a,!1,!1,!1,!1)).getBtn(0),o=p}else if(t==e.DisplayType.Account){var u=new e.Controls.VAccount(i,!1,!1,!0,t,l,a,n);u.getBtn(0),o=u}else if(t==e.DisplayType.Binary){o=new e.Controls.VBinary(i,!1,!1,!0,a)}else if(t==e.DisplayType.Image){o=new e.Controls.VImage(i,!1,!1,a)}else if(t==e.DisplayType.URL){o=new e.Controls.VURL(i,!1,!1,!0,50,100)}else if(t==e.DisplayType.FileName||t==e.DisplayType.FilePath){o=new e.Controls.VFile(i,!1,!1,!0,a,t)}return o},W=function(n,a){if(l&&w2ui[L]&&keyCol){var r=w2ui[L].getSelection();for(p in r)-1==O.indexOf(w2ui[L].get(r[p])[keyCol])&&O.push(w2ui[L].get(r[p])[keyCol])}z();var d=null,c=null;t.makeArray(w).length;for(var p in w)if(w[p].IsKey){d=w[p].SelectClause,c=String(d).indexOf(".")>-1?String(d).substring(String(d).lastIndexOf(".")+1,String(d).length):d,d=w[p].SelectClause,keyCol=c.toUpperCase();break}if(1==n){for(var g=" ",h=null,v=0;v<b.length;v++)if(null==(h=b[v].Ctrl.getValue())||0==h.length||0==h&&b[v].AD_Reference_ID!=e.DisplayType.YesNo||-1==h||!h)b[v].Value=null;else{if(b[v].Value=h,b[v].AD_Reference_ID==e.DisplayType.Date&&b[v].IsRange&&null==h&&(h=b[v].CtrlTo.getValue(),b[v].Value=h),b[v].AD_Reference_ID==e.DisplayType.String||b[v].AD_Reference_ID==e.DisplayType.Text||b[v].AD_Reference_ID==e.DisplayType.TextLong)b[v].Value=h;else if(b[v].AD_Reference_ID==e.DisplayType.Date){var f=null,m=null,y=new Date(b[v].Ctrl.getValue());b[v].IsRange&&(null==b[v].CtrlTo.getValue()?(y=new Date,b[v].ValueTo=new Date):b[v].ValueTo=new Date(b[v].CtrlTo.getValue()))}else if(b[v].AD_Reference_ID==e.DisplayType.DateTime){f=null,m=null,y=new Date(b[v].Ctrl.getValue());b[v].Value=y,b[v].IsRange?(y=new Date(b[v].CtrlTo.getValue()),m="TO_DATE( '"+(Number(y.getMonth())+1)+"-"+y.getDate()+"-"+y.getFullYear()+" "+y.getHours()+":"+y.getMinutes()+":"+y.getSeconds()+"', 'MM-DD-YYYY HH24:MI:SS')",b[v].ValueTo=m):g+=b[v].SearchColumnName+" ="+f}else if(b[v].AD_Reference_ID==e.DisplayType.YesNo)b[v].Value=b[v].Ctrl.getValue();else{f=null,m=null;f=b[v].Ctrl.getValue(),b[v].Value=f,b[v].IsRange&&b[v].Ctrl.getValue()&&(h=1==b[v].Ctrl.getValue()?"Y":"",b[v].ValueTo=h)}!0}if(null!=D.OTHERCLAUSE)if(null!=o&&o.length>0){var I="";D.OTHERCLAUSE.indexOf("ORDER BY")>-1&&(I=D.OTHERCLAUSE.substr(0,D.OTHERCLAUSE.indexOf("ORDER BY")),D.OTHERCLAUSE.substr(D.OTHERCLAUSE.indexOf("ORDER BY"))),I&&String(I).toUpperCase().indexOf("WHERE")>-1&&(D.FromClause.toUpperCase().indexOf("WHERE")>-1||g.length>1||null!=s&&s.length>1)&&(I=String(I).replace("WHERE","AND"))," "+I}else String(D.OTHERCLAUSE).toUpperCase().indexOf("WHERE")>-1&&(D.FromClause.toUpperCase().indexOf("WHERE")>-1||g.length>1||null!=s&&s.length>1)&&(D.OTHERCLAUSE=String(D.OTHERCLAUSE).replace("WHERE","AND"))," "+D.OTHERCLAUSE}a||(a=1);var C=[];if(b&&Object.keys(b).length>0)for(var _=0;_<Object.keys(b).length;_++){var A={};A.AD_Reference_ID=b[_].AD_Reference_ID,A.IsRange=b[_].IsRange,A.InfoColumnID=b[_].InfoColumnID,A.Value=b[_].Value,A.ValueTo=b[_].ValueTo,C.push(A)}t.ajax({url:e.Application.contextUrl+"InfoWindow/GetData",dataType:"json",type:"POST",data:{tableName:D.TableName,pageNo:a,SelectedIDs:o,Requery:n,InfoID:i,ValidationCode:e.secureEngine.encrypt(s),SrchCtrls:JSON.stringify(C)},error:function(){alert(e.Msg.getMsg("ErrorWhileGettingData")),u[0].style.visibility="hidden"},success:function(i){var n=JSON.parse(i);if(null!=n){if(n.Error)return e.ADialog.error(n.Error),void(u[0].style.visibility="hidden");!function(e){if(N.empty(),e.TotalPage>0){for(var i=0;i<e.TotalPage;i++)N.append(t("<option value="+(i+1)+">"+(i+1)+"</option>"));N.val(e.CurrentPage),e.TotalPage>e.CurrentPage?(T.css("opacity","1"),V.css("opacity","1")):(T.css("opacity","0.6"),V.css("opacity","0.6")),e.CurrentPage>1?(S.css("opacity","1"),x.css("opacity","1")):(S.css("opacity","0.6"),x.css("opacity","0.6")),1==e.TotalPage&&(S.css("opacity","0.6"),x.css("opacity","0.6"),T.css("opacity","0.6"),V.css("opacity","0.6"))}else S.css("opacity","0.6"),x.css("opacity","0.6"),T.css("opacity","0.6"),V.css("opacity","0.6");var n=e.CurrentPage,a=e.PageSize,s=e.TotalRecords,l=(n-1)*a,o=l+a;o>s&&(o=s);0==s&&(l-=1);var r=E+" "+(l+1)+"-"+o+" "+P+" "+s;R.text(r)}(n.pSetting),j(n.data)}else u[0].style.visibility="hidden"}})},j=function(i){if(null==i)return alert(e.Msg.getMsg("NoDataFound")),void(u[0].style.visibility="hidden");var n=[],a=[],s=null;for(var o in i){var r={resizable:!0};w[o]&&(s=w[o].AD_Reference_ID,r.caption=w[o].Name,r.field=i[o].ColumnName.toUpperCase(),r.columnName=i[o].ColumnName.toUpperCase(),r.origColName=i[o].ColumnName,r.sortable=!0,r.hidden=!w[o].IsDisplayed,r.size="100px",e.DisplayType.IsNumeric(s)?s==e.DisplayType.Integer?r.render="int":r.render=function(t,i,a){return e.Utility.Util.getValueOfDecimal(t[n[a].field]).toLocaleString()}:e.DisplayType.IsDate(s)?s==e.DisplayType.Date?r.render=function(e,t,i){var a;(a=e[n[i].field])?a=(a=new Date(a)).toLocaleDateString():a="";return a}:s==e.DisplayType.DateTime?r.render=function(e,t,i){var a;(a=e[n[i].field])?a=(a=new Date(a)).toDateString():a="";return a}:r.render=function(e,t,i){var a;(a=e[n[i].field])?a=(a=new Date(a)).toLocaleTimeString():a="";return a}:s==e.DisplayType.Location||s==e.DisplayType.Locator||s==e.DisplayType.Account||s==e.DisplayType.PAttribute?r.render="int":s==e.DisplayType.Button?r.render=function(e){return"<div>button</div>"}:s==e.DisplayType.Image?r.render=function(e){return"<div>Image</div>"}:e.DisplayType.IsLOB(s)&&(r.render=function(e){return"<div>[Lob-blob]</div>"}),n[o]=r)}for(var d=0;d<i[0].RowCount;d++){var p={};for(var o in i)p[i[o].ColumnName.toUpperCase()]=i[o].Values[d];p.recid=d+1,a[d]=p}if(L=(L="gridInfodata"+Math.random()).replace(".",""),w2utils.encodeTags(a),I=t(c).w2grid({name:L,recordHeight:40,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:n,records:a,multiSelect:l,onUnselect:H,onSelect:q}),l&&O&&O.length>0)for(itm in O)for(o in w2ui[L].records)w2ui[L].records[o][keyCol]==O[itm]&&(w2ui[L].select(parseInt(o)+1),G(!1));else G(!0);u[0].style.visibility="hidden"};function G(e){e?v.prop("disabled","true").css({cursor:"default",opacity:".5"}):v.prop("disabled","").css({cursor:"pointer",opacity:"1"})}function q(e){G(!1)}function H(e){if(l){if(e.index){var t=w2ui[e.target].records[e.index][keyCol];O.indexOf(t)>-1&&O.splice(O.indexOf(t),1)}else for(var i=0;i<w2ui[e.target].records.length;i++){t=w2ui[e.target].records[i][keyCol];O.indexOf(t)>-1&&O.splice(O.indexOf(t),1)}window.setTimeout((function(){0==O.length&&0==w2ui[e.target].getSelection().length&&G(!0)}),50)}else G(!0)}var z=function(){null!=I&&I.destroy(),I=null},Q=function(){var t=w2ui[L].getSelection();for(item in t){-1==O.indexOf(w2ui[L].get(t[item])[keyCol])&&O.push(w2ui[L].get(t[item])[keyCol]);var i=w2ui[L].columns;for(col in i)e.Env.getCtx().setContext(a,e.EnvConstants.TAB_INFO,i[col].columnName,w2ui[L].get(t[item])[i[col].columnName])}null!=k.onClose&&O.length>0&&k.onClose(),J()};this.getSelectedValues=function(){return O};var J=function(){v.off("click"),f.off("click"),h.off("click"),m.off("keyup"),S.off("click"),x.off("click"),T.off("click"),V.off("click"),N.off("change"),c=null,d=null,null!=I&&I.destroy(),I=null,y=null,null,r=d=c=p=null,u=g=h=v=f=null,S=x=T=V=N=null,I=null,D=null,w=null,null,b=null,keyCol=null,k=null,O=null,null!=m&&(m.dialog("destroy"),m.remove()),m=null,this.disposeComponent=null,this.displaySchema=null,this.getControl=null,this.displayData=null,this.loadData=null,this.disposeDataSec=null,this.btnOKClick=null,this.getSelectedValues=null,this.disposeComponent=null}}i.prototype.getValueAsString=function(t){return e.context.getWindowContext(this.windowNo,t,!0)},e.InfoWindow=i}(VIS,jQuery)},7950:()=>{!function(e,t){t.IniConstants={log:t.Logging.VLogger.getVLogger(" VIS.Ini"),ENV_PREFIX:"env.",VIENNA_HOME:"VIENNA_HOME",VIENNA_PROPERTY_FILE:"vienna.properties",VIENNA_ENV_FILE:"viennaEnv.properties",P_UID:"ApplicationUserID",DEFAULT_UID:"UserPwd",P_PWD:"ApplicationPassword",DEFAULT_PWD:"UserPwd",P_STORE_PWD:"StorePassword",DEFAULT_STORE_PWD:!0,P_TRACELEVEL:"TraceLevel",DEFAULT_TRACELEVEL:"WARNING",P_TRACEFILE:"TraceFile",DEFAULT_TRACEFILE:!1,P_INI:"FileNameINI",DEFAULT_INI:"",P_CONNECTION:"Connection",DEFAULT_CONNECTION:"",P_A_LOGIN:"AutoLogin",DEFAULT_A_LOGIN:!1,P_A_NEW:"AutoNew",DEFAULT_A_NEW:!0,P_VIENNASYS:"ViennaSys",DEFAULT_VIENNASYS:!1,P_CACHE_WINDOW:"CacheWindow",DEFAULT_CACHE_WINDOW:!1,P_TEMP_DIR:"TempDir",DEFAULT_TEMP_DIR:"",P_ROLE:"Role",DEFAULT_ROLE:"",P_CLIENT:"Client",DEFAULT_CLIENT:"",P_ORG:"Organization",DEFAULT_ORG:"",P_WAREHOUSE:"Warehouse",DEFAULT_WAREHOUSE:"",P_TODAY:"CDate264",DEFAULT_TODAY:Date.now,P_PRINTPREVIEW:"PrintPreview",DEFAULT_PRINTPREVIEW:!0,P_WARNING:"Warning",DEFAULT_WARNING:"Do_not_change_any_of_the_data_as_they_will_have_undocumented_side_effects.",P_PRINTER:"Printer",DEFAULT_PRINTER:"",P_DBUSED:"dbused",DEFAULT_DBUSED:"",P_DB_NAME:"dbname",DEFAULT_DB_NAME:"",P_DBUSER_ID:"dbuserid",DEFAULT_DBUSER_ID:"",P_DBPWD:"dbpwd",DEFAULT_DB_PWD:"",P_DB_PORT:"dbport",DEFAULT_DB_PORT:"",P_DB_HOST:"dbhost",DEFAULT_DB_HOST:"",CO_SHOWLEVEL:"ClientOrgLevel",DEFAULT_CO_SHOWLEVEL:"2",W_PAGESIZE:"WorkSpacePageSize",DEFAULT_W_PAGESIZE:"5",WIN_PAGESIZE:"WindowPageSize",DEFAULT_WIN_PAGESIZE:"50",P_Show_Mini_Grid:"ShowMiniGrid",DEFAULT_MiniGrid_Status:!1,P_Print_Native_Digits:"PrintNativeDigits",DEFAULT_Native_Digits_Status:!0,P_WELCOME_SCREEN:"HideWelcomeScreen",DEFAULT_SCREEN_STATUS:!1,P_APP_TYPE:"AppType",DEFAULT_APP_TYPE:"VServer",P_APP_HOST:"AppHost",DEFAULT_APP_HOST:"localhost",P_APP_PORT:"AppPort",DEFAULT_APP_PORT:"2090",_VIENNASYS:"VFramworkSys",_XML_DOC_PATH:"appconn.xml",_XML_ROOT:"//connectionvar"},t.Ini={setValueToLocalStorage:function(e,t){localStorage.setItem(e,t)},getLocalStorage:function(e){return localStorage.getItem(e)},clearLocalStorage:function(){localStorage.clear()},removeLocalStorageItem:function(e){localStorage.removeItem(e)},updateLocalContextFromIni:function(){for(var e=[t.IniConstants.P_A_NEW,t.IniConstants.P_TRACEFILE,t.IniConstants.P_TRACELEVEL,t.IniConstants.CO_SHOWLEVEL,t.IniConstants.W_PAGESIZE,t.IniConstants.WIN_PAGESIZE,t.IniConstants.P_Show_Mini_Grid,t.IniConstants.P_Print_Native_Digits,t.IniConstants.P_A_LOGIN,t.IniConstants.P_STORE_PWD,t.IniConstants.P_CACHE_WINDOW,t.IniConstants.P_PRINTPREVIEW,t.IniConstants.P_TRACEFILE],i={},n=0;n<e.length;n++)"AutoNew"==e[n]?t.context.setContext(e[n],null==t.Ini.getLocalStorage(e[n])?"N":t.Ini.getLocalStorage(e[n])):t.context.setContext("#"+e[n],t.Ini.getLocalStorage(e[n])),i[e[n]]=t.Ini.getLocalStorage(e[n]);i["#TimezoneOffset"]=(new Date).getTimezoneOffset().toString(),i["#ClientLanguage"]=window.navigator.language,t.dataContext.updateClientCtx(i)},getIsCacheWindow:function(){return"Y"==localStorage.getItem(t.IniConstants.P_CACHE_WINDOW)},getTraceLevel:function(){return null!=t.Ini.getLocalStorage(t.IniConstants.P_TRACELEVEL)?t.Logging.Level.prototype.getLevel(t.Ini.getLocalStorage(t.IniConstants.P_TRACELEVEL)):t.Logging.Level.INFO}}}(jQuery,VIS)},5710:()=>{!function(e){if(e.support.touch="ontouchend"in document,e.support.touch){var t,i=e.ui.mouse.prototype,n=i._mouseInit,a=i._mouseDestroy;i._touchStart=function(e){!t&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(t=!0,this._touchMoved=!1,s(e,"mouseover"),s(e,"mousemove"),s(e,"mousedown"))},i._touchMove=function(e){t&&(this._touchMoved=!0,s(e,"mousemove"))},i._touchEnd=function(e){t&&(s(e,"mouseup"),s(e,"mouseout"),this._touchMoved||s(e,"click"),t=!1)},i._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),n.call(t)},i._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),a.call(t)}}function s(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var i=e.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}}(jQuery)},935:()=>{!function(e,t){function i(i,n){this.onClose=null;var a=i,s=this,l=t("<div style='position:relative;'>"),o=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),r=e.Env.getWindowNo(),d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=!1,_=n;function S(e){o.css("display",e?"block":"none")}this.load=function(){l.load(e.Application.contextUrl+"Location/Locations/?windowno="+r+"&locationId="+a+"&AD_Language="+e.context.getContext("#AD_Language"),(function(e){l.append(o),S(!0),s.init(),S(!1)}))},this.init=function(){if(w=l.find("#btnOk_"+r),b=l.find("#btnCancel_"+r),d=l.find("#lstLocation_"+r),c=l.find("#txtCountry_"+r),p=l.find("#txtAddress1_"+r),u=l.find("#txtAddress2_"+r),g=l.find("#txtAddress3_"+r),h=l.find("#txtAddress4_"+r),e.Application.isRTL&&(w.removeClass("pull-left"),w.addClass("pull-right"),l.find("Sup").css("float","right"),t(l.find(".cat2 a")[0]).removeClass("pull-right"),t(l.find(".cat2 a")[0]).addClass("pull-left"),t(l.find(".cat3 a")[0]).removeClass("pull-right"),t(l.find(".cat3 a")[0]).addClass("pull-left")),p.val()&&p.val(p.val()),u.val()&&u.val(u.val()),g.val()){var i=l.find("#aCollection");(n=l.find(".cat"+t(i).attr("data-prod-cat")))?n.length>0&&n.toggle():l.find(".cat"+t(i).attr("data-prod-close")).hide(),g.val(g.val())}if(h.val()){var n;i=l.find(".cat3").find("a")[0];(n=l.find(".cat"+t(i).attr("data-prod-cat")))?n.length>0&&n.toggle():l.find(".cat"+t(i).attr("data-prod-close")).hide(),h.val(h.val())}(v=l.find("#txtCity_"+r)).val()&&v.val(v.val()),f=l.find("#txtState_"+r),(m=l.find("#txtZipCode_"+r)).val()&&m.val(m.val()),y=l.find("#countryhdn_"+r).val(),I=l.find("#Statehdn_"+r).val(),c.autocomplete({source:function(i,n){0!=i.term.trim().length&&t.ajax({url:e.Application.contextUrl+"Location/GetCountry",dataType:"json",data:{style:"full",name_startsWith:i.term},success:function(e){"ok"==e.result?n(null):n(t.map(e.result,(function(e){return{label:e.Name,value:e.Name,id:e.Key}})))}})},minLength:1,select:function(e,t){0==t.item.id&&c.val(""),y=t.item.id},open:function(){l.find(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){l.find(this).removeClass("ui-corner-top").addClass("ui-corner-all"),Number(y)>0?C=!0:c.val("")}}),f.autocomplete({source:function(i,n){0!=i.term.trim().length&&t.ajax({url:e.Application.contextUrl+"Location/GetStates",dataType:"json",data:{style:"full",name_startsWith:i.term,countryId:y},success:function(e){"ok"==e.result?n(null):n(t.map(e.result,(function(e){return{label:e.Name,value:e.Name,id:e.Key}})))}})},minLength:1,select:function(e,t){I=t.item.id},open:function(){l.find(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){l.find(this).removeClass("ui-corner-top").addClass("ui-corner-all")}}),d.autocomplete({source:function(i,n){0!=i.term.trim().length&&t.ajax({url:e.Application.contextUrl+"Location/GetAddresses",dataType:"json",data:{style:"full",name_startsWith:i.term},success:function(e){"ok"==e.result?n(null):n(t.map(e.result,(function(e){return{label:e.ADDRESS,value:e.ADDRESS,C_COUNTRY_ID:e.C_COUNTRY_ID,C_LOCATION_ID:e.C_LOCATION_ID,C_REGION_ID:e.C_REGION_ID,COUNTRYNAME:e.COUNTRYNAME,ADDRESS1:e.ADDRESS1,ADDRESS2:e.ADDRESS2,ADDRESS3:e.ADDRESS3,ADDRESS4:e.ADDRESS4,CITYNAME:e.CITYNAME,STATENAME:e.STATENAME,ZIPCODE:e.ZIPCODE}})))}})},minLength:1,select:function(e,t){c.val(t.item.COUNTRYNAME),p.val(t.item.ADDRESS1),u.val(t.item.ADDRESS2),g.val(t.item.ADDRESS3),h.val(t.item.ADDRESS4),v.val(t.item.CITYNAME),f.val(t.item.STATENAME),m.val(t.item.ZIPCODE),C=!0,I=t.item.C_REGION_ID,a=0,D=0,y=t.item.C_COUNTRY_ID},open:function(){l.find(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){l.find(this).removeClass("ui-corner-top").addClass("ui-corner-all")}}),w.on("click",(function(){if(S(!0),Number(y)<=0)return e.ADialog.warn("SelectCountry",!0,null),void S(!1);_&&C&&(a=0);!function(i,n){var o=null;t.ajax({url:e.Application.contextUrl+"Location/SaveLocation",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({pref:i})}).done((function(e){a=(o=e).locationid,o.locaddress,this.location=a,S(!1),s.onClose&&s.onClose(a,C),l.dialog("close"),C=null}))}({countryName:c.val(),addvalue1:p.val(),addvalue2:u.val(),addvalue3:g.val(),addvalue4:h.val(),cityValue:v.val(),stateValue:f.val(),zipValue:m.val(),clocationId:a,countryId:y,stateId:I,cityId:D})})),b.on("click",(function(){l.dialog("close")})),l.find(".VIS-Location-toggler").click((function(e){e.preventDefault();var t=l.find(".cat"+l.find(this).attr("data-prod-cat"));t&&t.length>0?t.toggle():l.find(".cat"+l.find(this).attr("data-prod-close")).hide()})),c.bind("change",(function(e){C=!0})),p.bind("change",(function(e){C=!0})),u.bind("change",(function(e){C=!0})),g.bind("change",(function(e){C=!0})),h.bind("change",(function(e){C=!0})),v.bind("change",(function(e){C=!0})),f.bind("change",(function(e){C=!0})),m.bind("change",(function(e){C=!0}))},this.showDialog=function(){l.append(o),l.dialog({modal:!0,resizable:!1,title:e.Msg.getMsg("Location"),closeText:e.Msg.getMsg("close"),width:620,position:{at:"center top",of:window},close:function(){s.dispose(),s=null,l.dialog("destroy"),l=null}})},this.disposeComponent=function(){s=null,w&&w.off("click"),b&&b.off("click"),a=0,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,null,null,this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()},e.LocationForm=i}(VIS,jQuery)},3652:()=>{!function(e,t){function i(i,n,a,s,l,o){this.onClose=null,this.change=!1;var r=t("<div style='position:relative;'>"),d=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),c=null,p=null,u=this,g=null,h=(a=a,s=s,l),v=(l=0,o),f=n,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null;function L(t){var i="",n=e.dataContext.getJSONData(e.Application.contextUrl+"Locator/GetWarehouseData",{Locator_ID:a},null);null!=t&&null!=n&&(C.val(n.Name),S.val(n.x),x.val(n.y),A.val(n.z),T.val(n.Value),l=n.M_Warehouse_ID,n.wValue,i=n.Separator,m.length>0&&(m[0].value=n.Name+"_"+n.Value+"("+n.x+n.Separator+n.y+n.Separator+n.z+")")),g=i;var s=n.Value;if(T.val(s),null!=t)for(var o in t)if(l==t[o].M_Warehouse_ID){_.prop("selectedIndex",o);break}}setBusy=function(e){d.css("display",e?"block":"none")},this.load=function(){r.load(e.Application.contextUrl+"Locator/Index/?windowno="+v+"&locatorId="+a,(function(i){setBusy(!0),function(){c=r.find("#btnOk_"+v),p=r.find("#btnCancel_"+v),r.find("#cmbLocator_"+v),m=r.find("#lstLocator_"+v),y=r.find("#locatorSearch_"+v),I=r.find("#chkCreateNew_"+v),C=r.find("#txtWarehouseInfo_"+v),_=r.find("#cmbWarehouse_"+v),S=r.find("#txtX_"+v),x=r.find("#txtY_"+v),A=r.find("#txtZ_"+v),T=r.find("#txtValue_"+v),D=r.find("#divchkCreateNew_"+v),w=r.find("#divWarehouseInfo_"+v),b=r.find("#divWarehouse_"+v),V=r.find("#lblX_"+v),N=r.find("#lblY_"+v),M=r.find("#lblZ_"+v),k=r.find("#lblValue_"+v),O=r.find("#lblWarehouse_"+v),e.Application.isRTL&&(p.css("margin-right","10px"),D.children(0).css("float","left"));f.refresh(),f.fillCombobox(s,!0,!0,!1);var i=e.dataContext.getJSONData(e.Application.contextUrl+"Locator/GetWarehouse",{Warehouse_ID:h},null);if(null!=i)for(var n in i)_.append(" <option value="+i[n].M_Warehouse_ID+">"+i[n].Name+"</option>");_.prop("selectedIndex",0),f.data.length>0&&0==a&&(a=f.data[0].Key);L(i),m.autocomplete({source:function(e,i){null!=e&&null!=e.term&&0==e.term.trim().length||f.data.length>0&&i(t.map(f.data,(function(e){return{label:e.Name,value:e.Name,locatorID:e.Key}})))},minLength:1,select:function(e,t){a=t.item.locatorID,L(i)},open:function(){t(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){t(this).removeClass("ui-corner-top").addClass("ui-corner-all")}}),f.getIsOnlyOutgoing()&&D.hide();function o(){var e=I.prop("checked");e?(w.hide(),b.show(),S.removeClass("vis-gc-vpanel-table-readOnly"),x.removeClass("vis-gc-vpanel-table-readOnly"),A.removeClass("vis-gc-vpanel-table-readOnly"),T.removeClass("vis-gc-vpanel-table-readOnly"),_.removeClass("vis-gc-vpanel-table-readOnly"),_.removeAttr("disabled")):(b.hide(),w.show(),S.addClass("vis-gc-vpanel-table-readOnly"),x.addClass("vis-gc-vpanel-table-readOnly"),A.addClass("vis-gc-vpanel-table-readOnly"),T.addClass("vis-gc-vpanel-table-readOnly"),_.addClass("vis-gc-vpanel-table-readOnly"),_.attr("disabled",!0)),S.attr("readonly",!e),x.attr("readonly",!e),A.attr("readonly",!e),T.attr("readonly",!e)}function d(){var e=_.find("option:selected").text()+" "+g+" "+S.val()+" "+g+" "+x.val()+" "+g+" "+A.val();T.val(e)}function R(){c.on("click",(function(){!function(){if(I.prop("checked")){var i="";0==T.val().trim().length&&(i+=k.val()+" - "),0==S.val().trim().length&&(i+=V.val()+" - "),0==x.val().trim().length&&(i+=N.val()+" - "),0==A.val().trim().length&&(i+=M.val()+" - ");var n=O.val(),s=T.val(),o=S.val(),r=x.val(),d=A.val(),c=_.find("option:selected").val();0!=c&&l!=c&&(l=c),0==l&&(i+=n+" - "),0!=i.length?e.ADialog.error("FillMandatory",!0,i.substring(0,i.length-3)):t.ajax({url:e.Application.contextUrl+"Locator/Save",dataType:"json",async:!1,data:{warehouseId:l,tValue:s,tX:o,tY:r,tZ:d},success:function(e){returnValue=e.locatorId,a=returnValue,f.refresh()}})}else u.change=!0}(),u.onClose&&u.onClose(a),r.dialog("close")})),p.on("click",(function(){r.dialog("close")})),I.change((function(){o()})),C.change((function(){})),S.change((function(){d()})),x.change((function(){d()})),A.change((function(){d()})),_.change((function(){d()})),y.on("click",(function(){""==m.val()?(m.autocomplete({source:t.map(f.data,(function(e){return{label:e.Name,value:e.Name,locatorID:e.Key}})),minLength:0}).bind("focus",(function(){0==m.val().length&&m.autocomplete("search","")})),m.trigger("focus")):m.autocomplete("search")}))}o(),R()}(),setBusy(!1)}))},this.showDialog=function(){r.append(d),r.dialog({modal:!0,resizable:!1,title:e.Msg.translate(e.Env.getCtx(),"Locator"),width:510,position:{at:"center top",of:window},close:function(){u.dispose(),u=null,r.dialog("destroy"),r=null}})},this.disposeComponent=function(){c&&c.off("click"),p&&p.off("click"),c=null,p=null,u=null,m=null,y=null,null,a=null,s=null,h=null,l=null,v=null,f=null,D=null,w=null,b=null,null,I=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null,this.disposeComponent=null,this.load=null,g=null}}i.prototype.dispose=function(){this.disposeComponent()},e.LocatorForm=i}(VIS,jQuery)},6135:()=>{!function(e,t){e.MarkModule=function(){this.onClose=null;var i=this,n=null,a=null,s=null,l=null,o=null,r=null,d=null,c=null,p=[],u=null,g=null,h=[],v=[],f=null,m=function(){n=t("<div>"),(a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",n.append(a),s=t("<div>"),l=t("<div class='vis-markmodulemainwrap'>"),s.append(l),d=t("<div>"),s.append(d);var i=e.Msg.getMsg("Cancel"),c=e.Msg.getMsg("Ok");r=t("<button class='VIS_Pref_btn-2' style='margin-top: 5px;margin-bottom: -10px;'>").append(i),o=t("<button class='VIS_Pref_btn-2' style='margin-top: 5px;margin-bottom: -10px;margin-right:5px'>").append(c),d.append(r),d.append(o),n.append(s),f=t("<table>")};m();var y=function(){r.on("click",(function(){b()})),o.on("click",(function(){D()}))};y();var I=function(){c=[];var i=null;if(null!=(s=e.dataContext.getJSONData(e.Application.contextUrl+"MarkModule/LoadModules",null,null)))for(var n in s)(i={}).AD_ModuleInfo_ID=s[n].AD_ModuleInfo_ID,i.Name=s[n].Name,i.Prefix=s[n].Prefix,c.push(i);if(1==p.length){var s,o={RecordID:p[0],TableID:g};if(null!=(s=e.dataContext.getJSONData(e.Application.contextUrl+"MarkModule/GetExportData",o,null)))for(var n in s)h.push(s[n])}var r=null,d=null,u=null,m=null;if(0==h.length)for(n=0;n<c.length;n++){r=t("<tr>"),d=t("<td>"),u=t('<label class="vis-gc-vpanel-table-label-checkbox" style="display: inline-block; opacity: 1;">'),m=t("<input type='checkbox'>"),"VA093_"==c[n].Prefix&&m.prop("disabled",!0),u.append(m),u.append(c[n].Name),d.append(u),r.append(d),f.append(r),(I={}).Ctrl=m,I.AD_ModuleInfo_ID=c[n].AD_ModuleInfo_ID,v.push(I)}else for(var y=0;y<c.length;y++){var I;r=t("<tr>"),d=t("<td>"),u=t('<label class="vis-gc-vpanel-table-label-checkbox" style="display: inline-block; opacity: 1;">'),m=h.indexOf(c[y].AD_ModuleInfo_ID)>-1?t("<input type='checkbox' checked>"):t("<input type='checkbox'>"),"VA093_"==c[y].Prefix&&m.prop("disabled",!0),u.append(m),u.append(c[y].Name),d.append(u),r.append(d),f.append(r),(I={}).Ctrl=m,I.AD_ModuleInfo_ID=c[y].AD_ModuleInfo_ID,v.push(I)}l.append(f),a[0].style.visibility="hidden"},D=function(){a[0].style.visibility="visible";for(var t=[],i=0;i<v.length;i++){v[i].Ctrl.prop("checked")&&t.push(v[i].AD_ModuleInfo_ID)}var n={moduleId:t,_recordID:p,_tableID:g,_strRecordID:u},s=e.dataContext.getJSONData(e.Application.contextUrl+"MarkModule/SaveExportData",n);"OK"!=s.result&&alert(s.result),a[0].style.visibility="hidden",b()};this.show=function(){n.dialog({title:e.Msg.getMsg("VIS_MarkModule"),width:400,height:500,resizable:!1,modal:!0,close:w}),I()},this.init=function(e,t,i){p=e.toString().split(","),u=e,g=t,i};var w=function(){b()},b=function(){i.onClose&&i.onClose(),s=null,l=null,r.off("click"),o.off("click"),o=null,r=null,d=null,I=null,D=null,m=null,y=null,w=null,a=null,c=null,p=null,u=null,g=null,null,h=null,v=null,f=null,null!=n&&(n.dialog("destroy"),n.remove()),n=null}}}(VIS,jQuery)},8106:()=>{!function(e,t){e.Newmailformat=function(i){var n,a,s,l,o=this;function r(){return null==a.val()||""==a.val()?(e.ADialog.info("FileNameMendatory"),!1):(o.onClose(),!0)}function d(){n.remove(),n=null,a.remove(),a=null,s.remove(),s=null,l=null}!function(){n=t('<div class="vis-forms-container" ></div>');var i=t('<div class="vis-emailsavewrap"></div>'),l=t('<div class="input-group vis-input-wrap"></div>'),o=t('<div class="vis-control-wrap"></div>'),r=t("<label>"+e.Msg.getMsg("Name")+"</label>");a=t('<input type="text" data-placeholder="" placeholder=" ">'),o.append(a).append(r),labelshow=t('<label class="vis-ec-col-lblchkbox"><input type="checkbox">'+e.Msg.getMsg("ForAllWindows")+"</label>"),s=t(labelshow.find("input")[0]);var d=t('<div style="display: flex"></div>');e.Application.isRTL;d.append(labelshow),i.append(l),l.append(o),i.append(d),n.append(i)}(),this.show=function(){l=new e.ChildDialog,i?l.setTitle(e.Msg.getMsg("EmailFormats")):l.setTitle(e.Msg.getMsg("LetterFormats")),l.setModal(!0),l.setContent(n),l.show(),l.onOkClick=r,l.onClose=d},this.getName=function(){return a.val()},this.saveForAll=function(){return s.prop("checked")}}}(VIS,jQuery)},5097:()=>{!function(e,t){e.Openmailformat=function(i,n){var a,s,l=null,o={},r=this,d=[];function c(){var e=w2ui.openformatgrid.getSelection();return o=w2ui.openformatgrid.get(e),r.onClose(),!0}function p(){l=null,null,s=null,null!=w2ui.openformatgrid&&w2ui.openformatgrid.destroy(),a.remove()}this.onClose=null,l=e.dataContext.getJSONData(e.Application.contextUrl+"Email/GetMailFormat",{Window_ID:i},null),this.show=function(){a=t('<div class="vis-forms-container" style="height:304px"></div>'),s=new e.ChildDialog,e.Application.isRTL?s.setHeight(435):s.setHeight(430),s.setWidth(850),n?s.setTitle(e.Msg.getMsg("EmailFormats")):s.setTitle(e.Msg.getMsg("LetterFormat")),s.setModal(!0),s.setContent(a),s.show(),s.onOkClick=c,s.onClose=p;var i=[],o=[];if(null!=l){for(var r in l)"NAME"==l[r].name?i.push({field:l[r].name,caption:e.Msg.getMsg("Name"),size:"20%",hidden:!1}):"SUBJECT"==l[r].name?i.push({field:l[r].name,caption:e.Msg.getMsg("Subject"),size:"20%",hidden:!1}):"MAILTEXT"==l[r].name?i.push({field:l[r].name,caption:e.Msg.getMsg("Mailtext"),size:"20%",hidden:!1}):"CREATED"==l[r].name?i.push({field:l[r].name,caption:e.Msg.getMsg("Created"),size:"20%",hidden:!1}):"ISDYNAMICCONTENT"==l[r].name?i.push({field:l[r].name,caption:e.Msg.getMsg("IsDynamicContent"),size:"20%",hidden:!1}):i.push({field:l[r].name,caption:e.Msg.getMsg(l[r].name),size:"100px",hidden:!0});for(var d=0;d<l[0].RowCount;d++){var u={};for(var g in u.recid=d,l)"MAILTEXT"==l[g].name?u[l[g].name]=l[g].value[d]:u[l[g].name]=e.Utility.encodeText(l[g].value[d]);o.push(u)}}a.w2grid({name:"openformatgrid",recordHeight:30,show:{selectColumn:!0},multiSelect:!1,columns:i,records:o})},this.getSelectedRow=function(){return o},this.getAttachments=function(){return d}}}(VIS,jQuery)},4831:()=>{VIS=window.VIS||{},function(e,t){function i(i,n){var a,s,l,o,r,d,c,p=n;this.windowNo=i,this.processId=null,this.name=null,this.entityType=null,this.pInstanceId=0,this.className=null,this.fields=null,this.paraList=null,this.asyncProcess=!0,this.gridFields=[],this.depOnFieldColumn=[],this.depOnField=[],this.vEditors=[],this.vEditors2=[],this.mFields=[],this.mFields2=[],this.isOkClicked=!1,this.onClosed;var u=t("<div class='vis-apanel-busy' style='width:95%;height:98%;position:absolute'>"),g=this;function h(e){u.css("display",e?"block":"none")}function v(t){if(null==t.error){var i=JSON.parse(t.result);if(!i.IsError)return i.ShowParameter?(g.pInstanceId=i.AD_PInstance_ID,void(g.fields=i.ProcessFields)):null!=i.ReportProcessInfo&&(e.ADialog.info(i.ReportProcessInfo.Summary,!0,"",""),e.Msg.getMsg("ImportedSuccessfully")==i.ReportProcessInfo.Summary)?(p.parentcall(!0),g&&(g.isOkProcess=!0),!0):(g&&(g.isOkProcess=!1),p.parentcall(!1),!1)}}this.onCloseMain=null,this.isOkProcess=!1,this.process=function(t,i,n){var a=new e.ProcessInfo(i,t,0,0);a.setAD_PInstance_ID(g.pInstanceId),a.setWindowNo(n);var s={processInfo:a.toJson()};this.asyncProcess?e.dataContext.process(s,(function(e){v(e)})):v(e.dataContext.process(s))},a=t("<div title='ParameterDialog'>"),s=t("<table class='vis-processpara-table'>"),a.append(s),(d=t('<input type="button" style="margin-right:5px" >').val(e.Msg.getMsg("OK"))).addClass("VIS_Pref_btn-2"),(c=t("<input type='button'>").val(e.Msg.getMsg("Close"))).addClass("VIS_Pref_btn-2"),c.css({"margin-bottom":"0px","margin-top":"7px"}),d.css({"margin-bottom":"0px","margin-top":"7px"}),this.addLine=function(){l=o=r=null,l=t("<td class=''>"),o=t("<td class=''>"),r=t("<td class='vis-processpara-table-td3'>"),s.append(t("<tr>").append(l).append(o).append(r))},this.addFields=function(t,i){if(t&&l.append(t.getControl()),i&&(i.getControl().width("200px"),i.getControl().height("30px"),r.append(i.getControl()),i.getBtnCount()>0)){var n=i.getBtn(0);r.append(n),i.getDisplayType()==e.DisplayType.MultiKey&&r.append(i.getBtn(1))}},this.addButtons=function(){this.addLine(),r.append(c).append(d)},this.showDialog=function(){a.append(u),a.dialog({modal:!0,width:"auto",close:function(){!function(t,i){if(t){g.paraList=i;var n=new e.ProcessInfo(g.name,g.processId,0,0);n.setAD_PInstance_ID(g.pInstanceId),e.dataContext.executeProcess({processInfo:n.toJson(),parameterList:i},(function(e){v(e)}))}}(g.isOkClicked,g.parameterList),g.onCloseMain&&g.onCloseMain(g.isOkClicked),g.dispose(),g=null,h(!1)}}),window.setTimeout((function(){c.focus()}),200),h(!1)},this.onClose=function(e){g.isOkClicked=e,a.dialog("close")},c.on(e.Events.onTouchStartOrClick,(function(){g.onClose(!1)})),d.on(e.Events.onTouchStartOrClick,(function(){h(!0);var e=g.saveParameters();e?(g.parameterList=e,g.onClose(!0,e)):h(!1)})),this.disposeComponent=function(){c.off(e.Events.onTouchStartOrClick),d.off(e.Events.onTouchStartOrClick),a.dialog("destroy"),a.remove(),g=null,this.gridFields.length=0,this.gridFields=null,this.depOnFieldColumn.length=0,this.depOnFieldColumn,this.depOnField.length=0,this.depOnField=null,this.vEditors.length=0,this.vEditors2.length=0,this.mFields.length=0,this.mFields2.length=0,this.parameterList=null,this.addLine=null,this.addFields=null,this.addButtons=null,this.showDialog=null,this.onClose=null,this.isOkClicked=null,a=s=l=o=r=d=c=null}}i.prototype.initDialog=function(i,n,a,s,l){this.processId=i,this.name=n,this.entityType=a,this.className=s,void 0!==l&&(this.asyncProcess=l),this.process(i,n,this.windowNo);for(var o=this.fields,r=null,d=0,c=o.length;d<c;d++){r=new e.GridField(o[d]),this.addLine(),this.mFields.push(r);for(var p=r.getDependentOn(!1),u=0;u<p.length;u++)this.depOnField.push(r),this.depOnFieldColumn.push(p[u]);var g=e.VControlFactory.getLabel(r),h=e.VControlFactory.getControl(null,r,!1);if(h){var v=r.getDefault(e.context,this.windowNo);h.setValue(v),h.addVetoableChangeListener(this)}if(r.setPropertyChangeListener(h),this.vEditors.push(h),this.addFields(g,h),r.getIsRange()){this.addLine();var f={};t.extend(!0,f,o[d]);var m=new e.GridField(f);this.mFields2.push(m);var y=e.VControlFactory.getControl(null,m,!1);if(y){v=m.getDefault(e.context,this.windowNo);y.setValue(v),y.addVetoableChangeListener(this)}this.vEditors2.push(y),this.addFields(null,y)}else this.mFields2.push(null),this.vEditors2.push(null)}return this.addButtons(),!0},i.prototype.vetoablechange=function(t){console.log(t);var i=null==t.newValue?"":t.newValue.toString(),n=t.propertyName;if(e.Env.getCtx().setWindowContext(this.windowNo,n,i),-1!==this.depOnFieldColumn.indexOf(n))for(var a=this.getDependantFields(n),s=0,l=a.length;s<l;s++){var o=a[s];null!=o&&(o.refreshLookup(),o.setValue(o.getDefault(e.Env.getCtx(),this.windowNo),!0))}},i.prototype.getDependantFields=function(e){var t=[];if(-1!=this.depOnFieldColumn.indexOf(e))for(var i=this.depOnFieldColumn.length,n=0;n<i;n++)this.depOnFieldColumn[n].equals(e)&&t.indexOf(this.depOnField[n])<0&&t.push(this.depOnField[n]);return t},i.prototype.saveParameters=function(){var t=new StringBuilder,i=this.mFields.length,n=0;for(n=0;n<i;n++){var a=this.mFields[n];if(a.getIsMandatory(!0)){var s=this.vEditors[n],l=s.getValue();if(null==l||0==l.toString().length?(a.setInserting(!0),a.setError(!0),t.length()>0&&t.append(", "),t.append(a.getHeader())):a.setError(!1),null!=this.vEditors2[n]){var o=s.getValue(),r=this.mFields2[n];null==o||0==o.toString().length?(a.setInserting(!0),r.setError(!0),t.length()>0&&t.append(", "),t.append(a.getHeader())):r.setError(!1)}}}if(0!=t.length())return e.ADialog.error("FillMandatory",!0,t.toString()),!1;var d=[],c={};for(n=0;n<i;n++){var p=this.vEditors[n],u=this.vEditors2[n],g=p.getValue(),h=null;if(null!=u&&(h=u.getValue()),null!=g||null!=h){c={};var v=this.mFields[n];c.Name=v.getColumnName(),c.DisplayType=v.getDisplayType(),c.Result=g,c.Result2=h,c.Info=p.getDisplay(),null!=u&&(c.Info_To=u.getDisplay()),d.push(c)}}return d},i.prototype.dispose=function(){this.disposeComponent()},e.ParameterDialog=i}(VIS,jQuery)},9589:()=>{!function(e,t){function i(i,n,a,s,l,o,r,d,c){var p=this;this.onClose=null;var u=t("<div>"),g=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),h=n,v=a,f=s,m=l,y=i,I=c;this.arrListColumns=[],this.dGrid=null;var D=-1,w=null,b="",C="",_="",S=" patr.M_Product_ID=@M_Product_ID AND patr.M_AttributeSetInstance_ID != 0";_=" AND s.QtyOnHand>0";var x="";this.log=e.Logging.VLogger.getVLogger("PAttributeInstance");var A=e.Env.getWindowNo(),T=t("<input id='chkShowAll_"+A+"' type='checkbox' ><span><label id='lblShowAll_"+A+"' class='VIS_Pref_Label_Font'>"+e.Msg.getMsg("VIS_ShowAll")+"</label></span>"),V=t("<input id='btnOk_"+A+"' class='VIS_Pref_btn-2' style='float: right; margin-right: 10px;' type='button' value='"+e.Msg.getMsg("OK")+"'>"),N=t("<input id='btnCancel_"+A+"' class='VIS_Pref_btn-2' style='float: right;margin-right: 0px;' type='button' value='"+e.Msg.getMsg("Cancel")+"'>"),M=t("<div id='topdiv_"+A+"' style='float: left; width: 100%; height: 7%; text-align: right;'>"),k=t("<div id='middeldiv_"+A+"' style='float: left; width: 100%; height: 79%;'>"),O=t("<div id='bottomdiv_"+A+"' style='float: left; width: 100%; height: 14%;'>"),L=!1;function R(){null==C&&(C="");var i=[],n=C,a=C.lastIndexOf(" ORDER BY ");T.prop("checked")||(n=C.substring(0,a)+_,x.length>0&&(n+=x),n+=C.substring(a)),p.log.finest(n);try{var s=e.secureEngine.encrypt(n);if(dr=e.dataContext.getJSONData(e.Application.contextUrl+"PAttributes/GetAttributeData",{Sq1Atribute:s,Product_ID:f},null),null!=dr&&dr.length>0){var l=1;for(var d in dr){var c={};c.M_AttributeSetInstance_ID=dr[d].M_AttributeSetInstance_ID,c.Description=dr[d].Description,c.Lot=dr[d].Lot,c.SerNo=dr[d].SerNo,c.GuaranteeDate=dr[d].GuaranteeDate,c.Value=dr[d].Value,c.QtyReserved=dr[d].QtyReserved,c.QtyOrdered=dr[d].QtyOrdered,c.QtyOnHand=dr[d].QtyOnHand,c.GoodForDays=dr[d].GoodForDays,c.ShelfLifeDays=dr[d].ShelfLifeDays,c.ShelfLifeRemainingPct=dr[d].ShelfLifeRemainingPct,c.M_Locator_ID=dr[d].M_Locator_ID,c.AttrCode=dr[d].AttrCode,c.recid=l,l++,i.push(c)}}E()}catch(e){console.log(e)}!function(i){null!=p.dGrid&&(p.dGrid.destroy(),p.dGrid=null);0==p.arrListColumns.length&&(p.arrListColumns.push({field:"Description",caption:e.Msg.translate(e.Env.getCtx(),"Description"),sortable:!0,size:"16%",min:150,hidden:!1}),p.arrListColumns.push({field:"Lot",caption:e.Msg.translate(e.Env.getCtx(),"Lot"),sortable:!0,size:"10%",min:100,hidden:!1}),p.arrListColumns.push({field:"SerNo",caption:e.Msg.getElement(e.Env.getCtx(),"SerNo"),sortable:!0,size:"10%",min:100,hidden:!1}),p.arrListColumns.push({field:"GuaranteeDate",caption:e.Msg.getElement(e.Env.getCtx(),"GuaranteeDate"),sortable:!0,size:"10%",min:100,hidden:!1,render:"date",options:{format:"yyyy-mm-dd"}}),p.arrListColumns.push({field:"Value",caption:e.Msg.getElement(e.Env.getCtx(),"M_Locator_ID"),sortable:!0,size:"10%",min:100,hidden:!1}),p.arrListColumns.push({field:"QtyReserved",caption:e.Msg.getElement(e.Env.getCtx(),"QtyReserved"),sortable:!0,size:"15%",min:100,hidden:!1}),p.arrListColumns.push({field:"QtyOrdered",caption:e.Msg.getElement(e.Env.getCtx(),"QtyOrdered"),sortable:!0,size:"15%",min:100,hidden:!1}),p.arrListColumns.push({field:"QtyOnHand",caption:e.Msg.getElement(e.Env.getCtx(),"QtyOnHand"),sortable:!0,size:"15%",min:100,hidden:!1}),p.arrListColumns.push({field:"GoodForDays",caption:e.Msg.getElement(e.Env.getCtx(),"GoodForDays"),sortable:!0,size:"15%",min:100,hidden:!1}),p.arrListColumns.push({field:"ShelfLifeDays",caption:e.Msg.getElement(e.Env.getCtx(),"ShelfLifeDays"),sortable:!0,size:"15%",min:100,hidden:!1}),p.arrListColumns.push({field:"ShelfLifeRemainingPct",caption:e.Msg.getElement(e.Env.getCtx(),"ShelfLifeRemainingPct"),sortable:!0,size:"20%",min:100,hidden:!1}),p.arrListColumns.push({field:"M_Locator_ID",caption:e.Msg.getElement(e.Env.getCtx(),"M_Locator_ID"),sortable:!0,size:"16%",min:150,hidden:!0}),p.arrListColumns.push({field:"M_AttributeSetInstance_ID",caption:e.Msg.translate(e.Env.getCtx(),"ID"),sortable:!0,size:"16%",min:150,hidden:!0}),p.arrListColumns.push({field:"AttrCode",caption:e.Msg.getElement(e.Env.getCtx(),"AttrCode"),sortable:!0,size:"16%",min:150,hidden:!0}));setTimeout(10),w2utils.encodeTags(i),p.dGrid=t(k).w2grid({name:"gridPinstance"+A,show:{toolbar:!0,footer:!0},recordHeight:30,columns:p.arrListColumns,records:i,multiSearch:!0,searches:[{field:"Description",caption:"Description",type:"text"},{field:"Lot",caption:"Lot",type:"text"},{field:"SerNo",caption:"SerNo",type:"text"},{field:"GuaranteeDate",caption:"GuaranteeDate",type:"date",options:{format:"yyyy-mm-dd"}}],onClick:function(e){p.dGrid.records.length>0&&V.removeAttr("disabled")}}),L||(o?p.dGrid.search("all",o):r&&p.dGrid.search("all",r));g.css("display","none")}(i)}function E(){var e=-1,t=-1!=e;if(null!=p.dGrid&&(e=Number(p.dGrid.getSelection().toString()),D=-1,w=null,v=0,(t=-1!=e)&&e>0)){var i=p.dGrid.get(e).M_AttributeSetInstance_ID;i>0&&(D=i,w=p.dGrid.get(e).Description,v=p.dGrid.get(e).M_Locator_ID,b=p.dGrid.get(e).AttrCode)}V.attr("disabled",!0),t&&V.removeAttr("disabled"),p.log.fine("M_AttributeSetInstance_ID="+D+" - "+w+"; M_Locator_ID="+v)}e.Application.isRTL&&(M.css("text-align","left"),V.css("margin-right","0px"),V.css("margin-left","10px"),V.css("float","left"),N.css("margin-right","0px"),N.css("float","left")),this.showDialog=function(){u.dialog({modal:!0,title:y,width:600,height:450,resizable:!1,close:function(){p.dispose(),p=null,u.dialog("destroy"),u=null}}),R()},this.disposeComponent=function(){V&&V.off("click"),N&&N.off("click"),V=null,N=null,A=null,this.onClose=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,this.arrListColumns=null,this.dGrid=null,null,S=null,_=null,x=null,this.log=null,T=null,M=null,k=null,O=null,D=null,w=null,C=null,this.disposeComponent=null},function(t){if(p.log.config("C_BPartner_ID="+t),0!=t){var i=0,n=0,a=null;try{if(null!=(a=e.dataContext.getJSONData(e.Application.contextUrl+"PAttributes/GetBPData",{Product_ID:f,BPartner_ID:t},null))){i=a.ShelfLifeMinPct;var s=a.PCT;s>0&&(n=s),n=a.ShelfLifeMinDays}}catch(e){console.log(e)}i>0&&(x=" AND COALESCE(TRUNC((daysBetween(TRUNC(asi.GuaranteeDate,'DD'),TRUNC(SysDate,'DD'))/p.GuaranteeDays)*100),0)>="+i,p.log.config("PAttributeInstance.dynInit - ShelfLifeMinPct="+i)),n>0&&(x+=" AND COALESCE(daysBetween(TRUNC(asi.GuaranteeDate,'DD'),TRUNC(SysDate,'DD')),0)>="+n,p.log.config("PAttributeInstance.dynInit - ShelfLifeMinDays="+n))}C=S,0!=h&&(C=C.concat(" AND NVL(l.M_Warehouse_ID,0) IN (0,"+h+")")),C+=" ORDER BY asi.GuaranteeDate, QtyOnHand DESC",M.append(T),O.append(N).append(V),u.append(g).append(M).append(k).append(O),I?T.prop("checked",!1):T.prop("checked",!0),function(){null!=V&&V.on(e.Events.onTouchStartOrClick,(function(){E(),p.onClose&&p.onClose(D,w,v,b),u.dialog("close")}));null!=N&&N.on(e.Events.onTouchStartOrClick,(function(){u.dialog("close")}));null!=T&&T.change((function(){L=!0,R()}))}()}(m)}i.prototype.dispose=function(){this.disposeComponent()},e.PAttributeInstance=i}(VIS,jQuery)},5307:()=>{!function(e,t){function i(i,n,a,s,l,o,r){this.onClose=null;var d=this,c=t("<div style='position:relative'>"),p=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),u=e.Env.getWindowNo(),g=null,h=null,v=null,f=null,m=null,y=null,I="",D=!1,w=null,b=0,C="",_=!1,S=!1,x=!1,A=!1;if(this.log=e.Logging.VLogger.getVLogger("PAttributesForm"),this.log.config("M_AttributeSetInstance_ID="+i+", M_Product_ID="+n+", C_BPartner_ID="+s+", ProductW="+D+", Column="+o),g=i,f=n,m=s,D=l,o,h=a,-1!=(y=r)){var T=e.context.getWindowTabContext(y,0,"AD_Tab_ID");b=e.dataContext.getJSONRecord("InfoProduct/GetWindowID",T.toString()),C=e.context.getContext(y,"WindowName"),_=e.context.isSOTrx(y),S=e.context.getWindowTabContext(y,0,"IsInternalUse")}if(0!=f){this.hasAttribute=!0,t.ajax({url:e.Application.contextUrl+"PAttributes/Load",dataType:"json",async:!1,data:{mAttributeSetInstanceId:g,mProductId:f,productWindow:D,windowNo:u,AD_Column_ID:o,window_ID:b,IsSOTrx:_,IsInternalUse:S},success:function(t){if(returnValue=t.result,null!=returnValue.Error)return e.ADialog.error(returnValue.Error,null,null,null),void(d.hasAttribute=!1);c.html(returnValue.tableStucture),c.append(p),returnValue.ControlList&&(w=returnValue.ControlList.split(",")),returnValue.MAttributeSetID,x=returnValue.IsCanCreate,A=returnValue.IsCanEdit}});var V=c.find("#btnOk_"+u),N=c.find("#btnCancel_"+u),M=c.find("#btnSelect_"+u),k=c.find("#btnLot_"+u),O=c.find("#btnSerNo_"+u),L=c.find("#cmbLot_"+u),R=c.find("#cmdNew_"+u),E=c.find("#chkNewEdit_"+u),P=c.find("#lblEdit_"+u),U=c.find("#chkEdit_"+u),F=c.find("#txtDescription_"+u),B=c.find("#txtLotString_"+u),W=c.find("#txtSerNo_"+u),j=c.find("#dtpicGuaranteeDate_"+u),G=c.find("#txtAttrCode_"+u);if(M.children(0).attr("src",e.Application.contextUrl+"Areas/VIS/Images/base/Locator10.png"),e.Application.isRTL&&(V.css("margin-right","0px"),V.css("margin-left","10px"),V.css("float","left"),N.css("margin-right","0px"),N.css("float","left")),!D)if(x?E.prop("checked",0==g):R.hide(),g>0||!x){if(B&&(B.attr("readOnly",!0),B.addClass("vis-gc-vpanel-table-readOnly")),L&&(L.attr("disabled",!0),L.addClass("vis-gc-vpanel-table-readOnly")),k&&k.attr("disabled",!0),W&&(W.attr("readOnly",!0),W.addClass("vis-gc-vpanel-table-readOnly")),O&&O.attr("disabled",!0),j&&(j.prop("disable",!0),j.addClass("vis-gc-vpanel-table-readOnly"),j.attr("disabled",!0)),w)for(var q=0;q<w.length;q++){var H=c.find("#"+w[q]);H.attr("readOnly",!0),H.addClass("vis-gc-vpanel-table-readOnly"),H.attr("disabled",!0)}A||(P.hide(),U.hide()),!x&!A&&k.hide()}else P.hide(),U.hide();null!=L&&L.change((function(){var e=L.find("option:selected").val(),t=L.find("option:selected").text();null!=e&&-1!=e?(B.val(t),B.attr("readOnly",!0),B.addClass("vis-gc-vpanel-table-readOnly"),e):(B.attr("readOnly",!1),B.removeClass("vis-gc-vpanel-table-readOnly"))})),null!=E&&E.change((function(){J()})),null!=U&&U.change((function(){$()})),null!=G&&G.on("keydown",(function(e){13!=e.keyCode&&9!=e.keyCode||(Y(!0),I=G.val(),K())})),null!=V&&V.on("click",(function(){Y(!0),z()})),null!=N&&N.on("click",(function(){c.dialog("close")})),null!=M&&(Y(!0),M.on("click",(function(){!function(){d.log.config("");var t=0;-1!=y&&(window.DTD001&&170==b?t=e.Env.getCtx().getContextAsInt(y,"DTD001_MWarehouseSource_ID"):143!=b&&"Blanket Sales Order"!=C&&169!=b&&168!=b&&341!=b||(t=e.Env.getCtx().getContextAsInt(y,"M_Warehouse_ID")));var i="";try{i=e.dataContext.getJSONData(e.Application.contextUrl+"PAttributes/GetTitle",{Warehouse_ID:t,Product_ID:f},null)}catch(e){console.log(e)}var n=new e.PAttributeInstance(i,t,h,f,m,W.val(),B.val(),j.val(),_);n.showDialog(),n.onClose=function(e,t,i,n){-1!=e&&(g=e,v=t,h=i,I=n,!0,Y(!0),K(),E.prop("checked")&&(E.prop("checked",!1),J()),U.prop("checked")&&(U.prop("checked",!1),$()),A&&(P.show(),U.show()))},n=null}()})),Y(!1)),null!=k&&k.on("click",(function(){t.ajax({url:e.Application.contextUrl+"PAttributes/CreateLot",dataType:"json",async:!1,data:{mAttributeSetInstanceId:g,mProductId:f},success:function(e){returnValue=e.result,function(e){L.append(new Option(e.Name,e.Key,!0,!0)),L.change()}(returnValue)}})})),null!=O&&O.on("click",(function(){t.ajax({url:e.Application.contextUrl+"PAttributes/GetSerNo",dataType:"json",async:!1,data:{mAttributeSetInstanceId:g,mProductId:f},success:function(e){returnValue=e.result,W.val(returnValue)}})})),this.showDialog=function(){if(c.dialog({modal:!0,title:e.Msg.translate(e.Env.getCtx(),"M_AttributeSetInstance_ID"),width:490,close:function(){d.dispose(),d=null,c.dialog("destroy"),c=null}}),w&&0==i)for(var t=0;t<w.length;t++)w[t].toString().contains("cmb")&&c.find("#"+w[t]).prop("selectedIndex",-1);Y(!1)},this.disposeComponent=function(){V&&V.off("click"),N&&N.off("click"),e.Env.clearWinContext(e.Env.getCtx(),u),e.Env.getCtx().setContext(e.Env.WINDOW_INFO,e.Env.TAB_INFO,"M_AttributeSetInstance_ID",g),e.Env.getCtx().setContext(e.Env.WINDOW_INFO,e.Env.TAB_INFO,"M_Locator_ID",h),h=null,v=null,f=null,m=null,null,y=null,D=null,null,0,null,V=null,N=null,M=null,k=null,O=null,L=null,E=null,F=null,B=null,W=null,j=null,d=null,u=null,g=null,this.disposeComponent=null}}function z(){var t=!0;if(U.prop("checked"))F.val().length>0;else if(E.prop("checked")){var i=B.val();if(t=!1,e.dataContext.getJSONData(e.Application.contextUrl+"PAttributes/CheckUniqueLot",null,null)>0)if(function(t){var i=!1;try{e.dataContext.getJSONData(e.Application.contextUrl+"PAttributes/CheckAttribute",{Window_No:y,Product_ID:f,LotNumber:t},null)>0&&(i=!0)}catch(e){console.log(e)}return i}(i))return t=!0,e.ADialog.Info("LotNoExists",null,null,null),!1;t||Q()}else t=!1,e.Env.getCtx().setContext(y,"AttrCode",I),d.onClose&&d.onClose(g,v,h),Y(!1),c.dialog("close");t&&Q()}function Q(){var i=[];if(w)for(var a=0;a<w.length;a++){var s=c.find("#"+w[a]);if(w[a].toString().contains("cmb"))s.find("option:selected").length>0?i.push({Key:Number(s.find("option:selected").val()),Name:s.find("option:selected").text()}):i.push({Key:0,Name:s.val()});else{if(s.attr("class").contains("vis-gc-vpanel-table-mandatory")&&0==s.val().trim().length)return e.ADialog.warn("FillMandatoryFields",!0,null),Y(!1),!1;"number"==s.attr("type")&&(s.val().contains(".")||s.val(s.val().concat(".0"))),i.push({Key:0,Name:s.val()})}}t.ajax({url:e.Application.contextUrl+"PAttributes/Save",type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({windowNoParent:y,strLotString:B.val(),strSerNo:W.val(),dtGuaranteeDate:new Date(j.val()),strAttrCode:G.val(),productWindow:D,mAttributeSetInstanceId:g,mProductId:n,windowNo:u,description:F.val(),isEdited:U.prop("checked"),lst:i}),success:function(t){returnValue=t.result,returnValue&&(null!=returnValue.Error?(e.ADialog.info("",null,returnValue.Error,null),Y(!1)):(e.Env.getCtx().setContext(y,"AttrCode",returnValue.attrCode),d.onClose&&d.onClose(returnValue.M_AttributeSetInstance_ID,returnValue.M_AttributeSetInstanceName,h),Y(!1),c.dialog("close")))},error:function(e,t,i){console.log(t),Y(!1)}})}function J(){var e=E.prop("checked");if(U.attr("disabled",e),B&&(B.attr("readOnly",!e),e?B.removeClass("vis-gc-vpanel-table-readOnly"):B.addClass("vis-gc-vpanel-table-readOnly")),L&&(e?(L.removeClass("vis-gc-vpanel-table-readOnly"),L.removeAttr("disabled")):(L.attr("disabled",!0),L.addClass("vis-gc-vpanel-table-readOnly"))),k&&(e?k.removeAttr("disabled"):k.attr("disabled",!0)),W&&(W.attr("readOnly",!e),e?W.removeClass("vis-gc-vpanel-table-readOnly"):W.addClass("vis-gc-vpanel-table-readOnly")),O&&(e?O.removeAttr("disabled"):O.attr("disabled",!0)),j&&(j.prop("disable",e),e?(j.removeClass("vis-gc-vpanel-table-readOnly"),j.removeAttr("disabled")):(j.addClass("vis-gc-vpanel-table-readOnly"),j.attr("disabled",!0))),w)for(var t=0;t<w.length;t++){var i=c.find("#"+w[t]);i.attr("readOnly",!e),e?(i.removeClass("vis-gc-vpanel-table-readOnly"),i.removeAttr("disabled")):(i.addClass("vis-gc-vpanel-table-readOnly"),i.attr("disabled",!0))}}function $(){var e=U.prop("checked");if(E.attr("disabled",e),B&&(B.attr("readOnly",!e),e?B.removeClass("vis-gc-vpanel-table-readOnly"):B.addClass("vis-gc-vpanel-table-readOnly")),L&&(e?(L.removeClass("vis-gc-vpanel-table-readOnly"),L.removeAttr("disabled")):(L.attr("disabled",!0),L.addClass("vis-gc-vpanel-table-readOnly"))),k&&(e?k.removeAttr("disabled"):k.attr("disabled",!0)),W&&(W.attr("readOnly",!e),e?W.removeClass("vis-gc-vpanel-table-readOnly"):W.addClass("vis-gc-vpanel-table-readOnly")),O&&(e?O.removeAttr("disabled"):O.attr("disabled",!0)),j&&(j.prop("disable",e),e?(j.removeClass("vis-gc-vpanel-table-readOnly"),j.removeAttr("disabled")):(j.addClass("vis-gc-vpanel-table-readOnly"),j.attr("disabled",!0))),w)for(var t=0;t<w.length;t++){var i=c.find("#"+w[t]);i.attr("readOnly",!e),e?(i.removeClass("vis-gc-vpanel-table-readOnly"),i.removeAttr("disabled")):(i.addClass("vis-gc-vpanel-table-readOnly"),i.attr("disabled",!0))}}function K(){if(w)for(var i=0;i<w.length;i++)w[i].toString().contains("cmb")?c.find("#"+w[i]).prop("selectedIndex",-1):c.find("#"+w[i]).val("");t.ajax({url:e.Application.contextUrl+"PAttributes/GetAttribute",dataType:"json",data:{mAttributeSetInstanceId:g,mProductId:f,productWindow:D,windowNo:u,AD_Column_ID:o,attrcode:I},success:function(t){returnValue=t,null!=returnValue&&function(t){if(B.val(""),W.val(""),j.val(Globalize.format(new Date,"yyyy-MM-dd")),null!=(t=jQuery.parseJSON(t)).result)for(var i in t.result)if(w){var n=c.find("[attribute_id="+i+"]");n.attr("id").contains("cmb")?n.val(e.Utility.Util.getValueOfInt(t.result[i])):n.val(t.result[i])}null!=B&&""!=t.lot?B.val(t.lot):null!=W&&""!=t.serial&&W.val(t.serial),null!=j&&""!=t.gdate&&j.val(Globalize.format(new Date(t.gdate),"yyyy-MM-dd"))}(returnValue),Y(!1)},error:function(e,t,i){console.log(t),Y(!1)}})}function Y(e){p.css("display",e?"block":"none")}}i.prototype.dispose=function(){this.disposeComponent()},e.PAttributesForm=i}(VIS,jQuery)},3698:()=>{!function(e,t){e.RecordShared=function(i,n,a,s,l,o,r,d){this.onClose=null;var c=null,p=this,u=[],g=[],h=[];d&&d.getFields()&&(h=d.getFields()),"999999"==o&&(o=0);var v=[],f="";if(h.length>0){var m=t.grep(h,(function(e){return 1==e.getIsIdentifier()}));if(m.length>0)for(var y=0;y<m.length;y++)f+=d.getValue(m[y].getColumnName()),y+1!=m.length&&(f+="_");else f=d.getValue("Value")&&d.getValue("Value").length>0?d.getValue("Value"):d.getValue("Name")&&d.getValue("Name").length>0?d.getValue("Name"):i}else f=i;var I=t('<div class="vis-actionWindowWrapper"><div class="vis-apanel-busy vis-recordSharedbusy" style="display:none"></div><div class="vis-actionFeilds" ><div class="vis-actionFeild"><div class="input-group vis-input-wrap vis-cusmg"><div class="vis-control-wrap"><input type="text"  id="txtSummaryOrg_'+l+'" maxlength="40" class=""  placeholder="'+e.Msg.getMsg("SummaryOrg")+'" data-placeholder="'+e.Msg.getMsg("SummaryOrg")+'"><label>'+e.Msg.getMsg("SummaryOrg")+'</label></div><div class="input-group-append"><button id="btnShowSummaryOrg_'+l+'" tabindex="-1" class="input-group-text"><i tabindex="-1" class="fa fa-search"></i></button></div></div></div><div class="vis-actionFeild"><div class="input-group vis-input-wrap vis-cusmg"><div class="vis-control-wrap"><select id="ddlLegalEntities_'+l+'" class="" placeholder=" " data-placeholder="" data-hasbtn=" "><option value="A">'+e.Msg.getMsg("All")+'</option><option value="Y">'+e.Msg.getMsg("Yes")+'</option><option value="N">'+e.Msg.getMsg("No")+"</option></select><label> "+e.Msg.getMsg("LegalEntities")+'</label></div></div></div><div class="vis-actionFeild"><div class="input-group vis-input-wrap vis-cusmg"><div class="vis-control-wrap"><input type="text" id="txtSearchKey_'+l+'" maxlength="40" class="" placeholder="'+e.Msg.getMsg("SearchKeyValue")+"/"+e.Msg.getMsg("Name")+'" data-placeholder="'+e.Msg.getMsg("SearchKeyValue")+'"><label>'+e.Msg.getMsg("SearchKeyValue")+"/"+e.Msg.getMsg("Name")+'</label></div></div></div></div><div class="vis-tableSection"><div class="vis-actionWishlistTable"><div class="vis-tableHeaderWishlist p-1 pl-2"><span class="vis-tableHeadingTtl">'+e.Msg.getMsg("Org")+'</span></div><div class="vis-gridtable"><table class="vis-gridSingletable"><thead class="vis-gridTableHeader"><tr><th width="40px"><input type="checkbox" name="" id="chkAll_'+l+'" class="inputCheckbox "></th><th>'+e.Msg.getMsg("SearchKeyValue")+"</th><th>"+e.Msg.getMsg("Org")+'</th><th width="120px" class="text-center">'+e.Msg.getMsg("LegalEntities")+'</th><th width="120px" class="text-center">'+e.Msg.getMsg("ReadOnly")+'</th><th width="120px" class="text-center" style="display:none">'+e.Msg.getMsg("ChildShare")+'</th></tr></thead><tbody class="vis-gridTableBody tbList"></tbody></table><div class="vis-wishlistActionBtn d-flex align-items-center justify-content-between mt-2"><div><span id="lblMsg_'+l+'"></span></div><div><button class="vis-actionBtn mr-1" id="btnCancel_'+l+'">'+e.Msg.getMsg("Cancel")+'</button><button class="vis-actionBtn mr-2"  style="cursor:default;" id="btnOk_'+l+'">'+e.Msg.getMsg("OK")+"</button></div></div></div></div></div></div>"),D=I.find("#txtSummaryOrg_"+l),w=I.find("#btnShowSummaryOrg_"+l),b=I.find("#ddlLegalEntities_"+l),C=I.find("#txtSearchKey_"+l),_=I.find("#btnOk_"+l),S=I.find("#btnCancel_"+l),x=I.find("#lblMsg_"+l),A=I.find("#chkAll_"+l),T=I.find(".vis-recordSharedbusy");function V(){M(!0),r=0,parentRecord_ID=0,parentOrg=0,d&&d.getTabLevel()>0&&(r=d.getParentTab().getAD_Table_ID(),parentRecord_ID=d.getParentTab().getRecord_ID(),parentOrg=d.getParentTab().getValue("AD_Org_ID"));var t={AD_Table_ID:n,Record_ID:i,parentTableID:r,parentRecord_ID,parentOrg},a=e.dataContext.getJSONData(e.Application.contextUrl+"RecordShared/GetSharedRecord",t,null);(function(e){if(I.find(".tbList").html(""),!e)return;for(var t="",i=0;i<e.length;i++)1!=e[i].isSummary&&(e[i].AD_OrgShared_ID?t+='<tr class="vis-rowSuccess">':t+="<tr>",t+='</td><td width="40px">',e[i].AD_OrgShared_ID?(t+='<input type="checkbox" checked class="chkOrgID" parentid="'+e[i].parentID+'" data-shareid="'+e[i].AD_OrgShared_ID+'" value="'+e[i].ID+'">',g.push(e[i].AD_OrgShared_ID),e[i].CanEdit&&k(!0),e[i].CanEdit):t+='<input type="checkbox" class="chkOrgID" parentid="'+e[i].parentID+'" value="'+e[i].ID+'">',t+='</td><td title="'+e[i].value+'">'+e[i].value+'</td><td title="'+e[i].name+'">'+e[i].name+'</td><td width="120px" class="text-center">'+e[i].isLegalEntity+'</td><td width="120px" class="text-center">',e[i].isReadonly?t+='<input type="checkbox" name="" id="" class="chkIsReadOnly" checked/>':t+='<input type="checkbox" name="" id="" class="chkIsReadOnly" />',t+="</td>",e[i].ChildShare,t+='<td width="120px" class="text-center" style="display:none"><input type="checkbox" name="" id="" checked class="chkIsChildShare" /> </td>');I.find(".tbList").append(t),I.find(".tbList .chkOrgID").on("click",(function(e){var t=I.find(".tbList .chkOrgID:checked");(t&&t.length>0||g&&0==g.length)&&k(!0),I.find(".tbList tr .chkOrgID").length==I.find(".tbList tr .chkOrgID:checked").length?A.attr("checked","checked").prop("checked","checked"):A.removeAttr("checked")}))})(u=a),M(!1)}function N(){if(A.removeAttr("checked"),""==D.val()){var e=t.grep(u,(function(e,t){return"A"==b.find("option:selected").val()?-1!=e.value.toLowerCase().indexOf(C.val().toLowerCase())||-1!=e.name.toLowerCase().indexOf(C.val().toLowerCase()):"A"!=b.find("option:selected").val()&&""!=C.val()?(-1!=e.value.toLowerCase().indexOf(C.val().toLowerCase())||-1!=e.name.toLowerCase().indexOf(C.val().toLowerCase()))&&e.isLegalEntity==b.find("option:selected").val():e.isLegalEntity==b.find("option:selected").val()}));I.find(".tbList tr").hide();for(var i=0;i<e.length;i++)I.find('.tbList .chkOrgID[value="'+e[i].ID+'"]').closest("tr").show()}else{e=[];for(var n=0;n<u.length;n++)for(var a=0;a<v.length;a++)u[n].ID!==v[a].ID||v[a].ParentID!=D.attr("data-id")&&-1==v[a].ParentName.toLowerCase().indexOf(D.val().toLowerCase())||e.push(u[n]);var s=t.grep(e,(function(e,t){return"A"==b.find("option:selected").val()?-1!=e.value.toLowerCase().indexOf(C.val().toLowerCase())||-1!=e.name.toLowerCase().indexOf(C.val().toLowerCase()):"A"!=b.find("option:selected").val()&&""!=C.val()?(-1!=e.value.toLowerCase().indexOf(C.val().toLowerCase())||-1!=e.name.toLowerCase().indexOf(C.val().toLowerCase()))&&e.isLegalEntity==b.find("option:selected").val():e.isLegalEntity==b.find("option:selected").val()}));I.find(".tbList tr").hide();for(i=0;i<s.length;i++)I.find('.tbList .chkOrgID[value="'+s[i].ID+'"]').closest("tr").show()}if(""!=C.val()||""!=D.val()||"A"!=b.find("option:selected").val()){var l=I.find(".tbList tr:visible .chkOrgID").length,o=I.find(".tbList tr:visible .chkOrgID:checked").length;l>0&&l==o?A.attr("checked","checked").prop("checked","checked"):A.removeAttr("checked")}else{l=I.find(".tbList tr:visible .chkOrgID").length,o=I.find(".tbList tr .chkOrgID:checked").length;l>0&&l==o?A.attr("checked","checked").prop("checked","checked"):A.removeAttr("checked")}}function M(e){e&&null!=T&&T.css({display:"block"}),e||null==T||T.css({display:"none"})}function k(e){e?_.css("opacity","1").prop("disabled",""):_.css("opacity","0.5").prop("disabled","true")}t.ajax({type:"post",url:e.Application.contextUrl+"RecordShared/GetOrgStructure",data:{},success:function(e){v=JSON.parse(e),M(!1)},error:function(e){M(!1)}}),w.click((function(){p.showOrgStructure()})),D.keyup((function(){D.removeAttr("data-id"),N()})),C.keyup((function(){N()})),b.change((function(){N()})),A.change((function(e){var i=!1;this.checked?(i=!0,k(!0)):k(!0),I.find(".tbList .chkOrgID").each((function(){t(this).is(":visible")&&(this.checked=i)}))})),_.click((function(){x.text(""),M(!0);var d={AD_Table_ID:n,record_ID:i,Tab_ID:a,Window_ID:s,WindowNo:l,list:[],Parent_ID:o,ParentTable_ID:r};I.find(".tbList .chkOrgID:checked").each((function(){d.list.push({AD_OrgShared_ID:Number(this.value),isReadonly:t(this).closest("tr").find(".chkIsReadOnly").is(":checked"),shareID:t(this).data("shareid"),ChildShare:t(this).closest("tr").find(".chkIsChildShare").is(":checked"),parentID:t(this).attr("parentid")})})),t.ajax({type:"post",url:e.Application.contextUrl+"RecordShared/SaveRecord",data:d,success:function(t){"OK"==JSON.parse(t)?(x.text(e.Msg.getMsg("Saved")),V(),I.find(".tbList").scrollTop(0),C.val(""),D.val(""),b.val("A"),c.close()):x.text(e.Msg.getMsg("RecordsNotSaved")),M(!1)},error:function(t){x.text(e.Msg.getMsg("RecordsNotSaved")),M(!1)}})})),S.click((function(){c.close()})),V(),this.dispose=function(){I.remove(),I=null,c=null,p=null,D=null,b=null,C=null,_=null,S=null,x=null},this.show=function(){(c=new e.ChildDialog).setContent(I),c.setWidth("75%"),c.setTitle(e.Msg.getMsg("RecordShared")+" ("+f+")"),c.setModal(!0),c.onClose=function(){p.onClose&&(p.onClose(),p.dispose())},c.show(),c.hidebuttons()},this.showOrgStructure=function(){D.val(""),D.removeAttr("data-id");var i=new e.ChildDialog,n=t('<div id="left" >    <ul id="menu-group-1" class="nav menu">        <li class="item-1 deeper parent">            <a class="" href="#">                <span data-toggle="collapse" data-parent="#menu-group-1" href="#sub-item-1" class="sign"><i class="fa fa-folder-o" onclick="$(this).toggleClass(\'fa-folder-o fa-folder-open-o\')"></i></span>                <span class="vis-orglbl">'+e.Msg.getMsg("SummaryOrg")+"</span>            </a>        </li>    </ul></div>");var a=1;var s=function e(t,i){for(var n=[],a=0;a<t.length;a++)if(t[a].ParentID===i&&"Y"==t[a].Issummary){var s={ID:t[a].ID,Name:t[a].Name,Children:e(t,t[a].ID)};n.push(s)}return n}(v,0);!function e(i,n){var s=t("<ul class='small collapse' style='list-style-type: none;' id='sub-item-"+a+"'></ul>");a++;for(var l=0;l<i.length;l++){var o=i[l],r=t("<li class='deeper parent'></li>"),d='<span data-toggle="collapse" data-parent="#menu-group-1" style="margin-left:-14px" href="#sub-item-'+a+'" class="mr-1 sign"><i class="fa fa-plus" onclick="$(this).toggleClass(\'fa-plus fa-minus\')"></i></span>',c=t("<span  class='vis-orglbl' data-id="+o.ID+"></span>").text(o.Name),p=t('<a class="" href="#"></a>');o.Children.length>0&&p.append(d),p.append(c),r.append(p),o.Children.length>0&&e(o.Children,r),s.append(r)}n.append(s)}(s,n.find(".item-1")),i.setContent(n),n.on("click",".vis-orglbl",(function(){if(t(this).attr("data-id")){var e=Number(t(this).attr("data-id"));D.val(t(this).text()).attr("data-id",e),N(),i.close()}})),i.setHeight(500),i.setWidth(450),i.setTitle(e.Msg.getMsg("SummaryOrg")),i.setModal(!0),i.show(),i.hidebuttons()}}}(VIS,jQuery)},9849:()=>{!function(e,t){e.RecordAccessDialog=function(){var n=null,a=null,s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=-1,q=!1;this.Load=function(i,j){n=i,a=j,d=t("<div class='vis-rad-recordData'>"),E=t("<button  class='vis-rad-navBtn' disabled='disabled'>").append(t("<i class='fa fa-caret-down'></i>")),P=t("<button  class='vis-rad-navBtn' disabled='disabled'>").append(t("<i class='fa fa-caret-up'></i>")),V=t("<div class='vis-rad-actionIcons' >"),N=t("<button  class='vis-rad-actionBtn'>").append(t("<i class='vis vis-plus'></i>")),O=t("<div class='vis-rad-btnWrap' >"),R=t("<a href = 'javascript:void(0)'  class='vis-rad-buttons VIS_Pref_btn-2'>").append(e.Msg.getMsg("Cancel")),k=t("<span class='vis-rad-paging'>").append(W),y=t("<input type='checkbox' checked >"),I=t("<label>").append(e.Msg.translate(e.Env.getCtx(),"IsActive")),w=t("<input type='checkbox' checked >"),b=t("<label>").append(e.Msg.translate(e.Env.getCtx(),"IsExclude")),_=t("<input type='checkbox'>"),S=t("<label>").append(e.Msg.translate(e.Env.getCtx(),"IsReadOnly")),A=t("<input type='checkbox'>"),T=t("<label>").append(e.Msg.translate(e.Env.getCtx(),"IsDependentEntities")),F=t("<input type='checkbox'>"),B=t("<label>").append(e.Msg.translate(e.Env.getCtx(),"IncludeNull")),s=t("<div class='vis-forms-container'>"),l=t("<div class='vis-forms-container vis-rad-contantWrap'>"),o=t("<div class='vis-rad-contantTop'>"),p=t("<div class='vis-rad-roleCombo'>"),u=t("<div class='input-group vis-input-wrap'>"),g=t("<div class='vis-control-wrap'>"),h=t("<label>").append(e.Msg.translate(e.Env.getCtx(),"AD_Role_ID")),v=t("<select class='vis-custom-select'>"),p.append(u),u.append(g),g.append(v),g.append(h),f=t("<div class='vis-rad-recordOp'>"),(m=t("<div class='vis-rad-check'>")).append(y),m.append(I),f.append(m),(D=t("<div class='vis-rad-check'>")).append(w),D.append(b),f.append(D),(C=t("<div class='vis-rad-check'>")).append(_),C.append(S),f.append(C),(x=t("<div class='vis-rad-check'>")).append(A),x.append(T),f.append(x),(U=t("<div class='vis-rad-check'>")).append(F),U.append(B),f.append(U),d.append(p),d.append(f),o.append(d),(c=t("<div class='vis-rad-navIcons'>")).append(E),c.append(P),o.append(c),r=t("<div class='vis-rad-contantBottom'>"),M=t("<button  class='vis-rad-actionBtn'>").append(t("<i class='vis vis-delete'></i>")),V.append(N),V.append(M),r.append(V),W=t("<lable>"),r.append(k),L=t("<a href = 'javascript:void(0)'  class='vis-rad-buttons VIS_Pref_btn-2'>").append(e.Msg.getMsg("Ok")),O.append(R),O.append(L),r.append(O),l.append(o),l.append(r),s.append(l),J(),H(),z(),s.dialog({width:600,height:232,resizable:!1,title:"Record",modal:!0})};var H=function(){var t=e.dataContext.getJSONData(e.Application.contextUrl+"RecordAccess/GetRoles",null,null),n='<option Value="-1"></option>';if(null!=t)for(i in t)n+='<option value="'+t[i].AD_Role_ID+'">'+t[i].Name+"</option>";v.append(n),n=null,t=null},z=function(){null==j&&(j=[]);var t=e.dataContext.getJSONData(e.Application.contextUrl+"RecordAccess/GetRecordAccess",{Table_ID:n,Record_ID:a},null),i=null;if(null!=t)for(var s in t)(i={}).AD_ROLE_ID=t[s].AD_ROLE_ID,i.ISACTIVE=t[s].ISACTIVE,i.ISDEPENDENTENTITIES=t[s].ISDEPENDENTENTITIES,i.ISEXCLUDE=t[s].ISEXCLUDE,i.ISREADONLY=t[s].ISREADONLY,i.ISINCLUDENULL=t[s].ISINCLUDENULL,j.push(i);i=null,t=null,j.length>0?(G=0,K()):q=!0},Q=function(){var i=v.val();if(-1!=i){var s=!1;q||(s=!0),t.ajax({url:e.Application.contextUrl+"RecordAccess/SaveAccess/",dataType:"json",data:{AD_Role_ID:i,AD_Table_ID:n,Record_ID:a,isActive:y.prop("checked"),isExclude:w.prop("checked"),isReadOnly:_.prop("checked"),isDependentEntities:A.prop("checked"),isIncludeNull:F.prop("checked"),isUpdate:s},success:function(e){1==e.result&&X()}})}},J=function(){E.on("click",(function(){G+=1,K()})),P.on("click",(function(){q?q=!1:G-=1,K()})),N.on("click",(function(){$()})),M.on("click",(function(){Y()})),L.on("click",(function(){Q()})),R.on("click",(function(){X()}))},$=function(){q=!0,G=j.length-1,K(),v.val(-1),y.attr("checked",!0),w.attr("checked",!0),_.attr("checked",!1),F.attr("checked",!1),A.attr("checked",!1),W.empty(),W.append("+"+(j.length+1)+"/"+(j.length+1)),j.length>0&&(P.attr("disabled",!1),P.css("opacity","1"))},K=function(){v.val(j[G].AD_ROLE_ID),y.attr("checked","Y"==j[G].ISACTIVE),w.attr("checked","Y"==j[G].ISEXCLUDE),_.attr("checked","Y"==j[G].ISREADONLY),F.attr("checked","Y"==j[G].ISINCLUDENULL),A.attr("checked","Y"==j[G].ISDEPENDENTENTITIES),W.empty(),W.append(G+1+"/"+j.length),j.length>G+1?(E.attr("disabled",!1),E.css("opacity","1")):(E.attr("disabled",!0),E.css("opacity",".5")),0==G?(P.attr("disabled",!0),P.css("opacity",".5")):(P.attr("disabled",!1),P.css("opacity","1"))},Y=function(){var i=v.val();-1==i||q||t.ajax({url:e.Application.contextUrl+"RecordAccess/DeleteRecord/",dataType:"json",data:{AD_Role_ID:i,AD_Table_ID:n,Record_ID:a,isActive:y.prop("checked"),isExclude:w.prop("checked"),isReadOnly:_.prop("checked"),isIncludeNull:F.prop("checked"),isDependentEntities:A.prop("checked")},success:function(e){1==e.result&&X()}})},X=function(){E.off("click"),P.off("click"),N.off("click"),M.off("click"),L.off("click"),R.off("click"),H=null,z=null,Q=null,J=null,$=null,K=null,Y=null,n=null,a=null,o=null,r=null,null,null,E=null,P=null,N=null,M=null,L=null,R=null,h=null,v=null,y=null,w=null,_=null,F=null,A=null,W=null,j=null,H=null,z=null,Q=null,s.dialog("destroy"),s.remove(),s=null}}}(VIS,jQuery)},9221:()=>{!function(e,t){function i(i,n,a,s){this.frame=null,this.windowNo=e.Env.getWindowNo();e.Env.getCtx();var l,o,r,d,c,p,u=null,g=!1,h="C_BPARTNER_ID",v=null,f=null,m=[],y=this,I=0,D=0,w=null,b=t('<div class="vis-sms-rootDiv vis-forms-container"></div>'),C=t('<div class="vis-awindow-header vis-menuTitle">'),_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=(w=null,!1),k=null,O=null;function L(e){if(e&&(V.empty(),v=n.getSelectedRows(),f=i.getRecords()[i.getCurrentRow()]),n.singleRow)R();else if(v.length>0){for(var t=0;t<v.length;t++)if(null!=v[t].mobile){var a=v[t][i.getKeyColumnName().toLower()];V.append('<li class="vis-sms-list-li-bcc"  data-mobile="'+v[t].mobile+'"><input id="'+y.windowNo+"_"+v[t].mobile+'_CheckBoxList1" type="checkbox" value="'+v[t].mobile+'" checked/><label class="vis-sms-chcklist-label"  for="'+y.windowNo+"_"+v[t].mobile+'_CheckBoxList1">'+v[t].mobile+"("+a+")</label></li>")}}else R();e||x.append(V),V.children().length>1&&1==O.prop("checked")&&(N.val(""),N.prop("disabled",!0))}function R(){if(null!=f.mobile){var e=f[i.getKeyColumnName().toLower()];V.append('<li class="vis-sms-list-li-bcc" data-mobile="'+f.mobile+'"><input id="'+y.windowNo+"_"+f.mobile+'_CheckBoxList1" type="checkbox" value="'+f.mobile+'" checked /><label class="vis-sms-chcklist-label"  for="'+y.windowNo+"_"+f.mobile+'_CheckBoxList1">'+f.mobile+"("+e+")</label></li>")}}function E(i,n){for(var a=0;a<i.length;a++){var s=e.dataContext.getJSONData(e.Application.contextUrl+"Sms/GetUser",{BPartner_ID:i[a]},null);if(null!=s)for(var l in s)if(null!=s[l].ISSMS&&s[l].ISSMS.toString().equals("Y")){if(null==s[l].MOBILE||""==s[l].MOBILE)continue;if(t(V.children("li").data(s[l].MOBILE+n[a])).length>0)continue;V.append('<li  class="vis-sms-list-li-bcc"><input id="'+y.windowNo+"_"+s[l].MOBILE+'_CheckBoxList1" type="checkbox"  value="'+s[l].MOBILE+n[a]+'" checked/><label class="vis-sms-chcklist-label" for="'+y.windowNo+"_"+s[l].MOBILE+'_CheckBoxList1">'+s[l].MOBILE+"("+n[a]+")</label></li>")}}}function P(e){1==O.prop("checked")?40==_.width()?(_.css("width","200px"),_.find("ul").show(),S.width(S.width()-160),b.find(".vis-sms-leftWrap").width(b.find(".vis-sms-leftWrap").width()-160)):U():40!=_.width()&&U()}function U(){_.css({width:"40px"}),_.find("ul").hide(),S.width(S.width()+160),b.find(".vis-sms-leftWrap").width(b.find(".vis-sms-leftWrap").width()+160)}function F(e){this.checked?(40!=_.width()&&_.find("ul").show(),0==n.singleRow&&v.length>1&&(N.val(""),N.prop("disabled",!0))):(40!=_.width()&&U(),N.prop("disabled",!1))}function B(e){var i=T[0],n="@@"+t(this).text()+"@@",a=i.scrollTop,s=0,l=i.selectionStart||"0"==i.selectionStart?"ff":!!document.selection&&"ie";"ie"==l?(T.focus(),(o=document.selection.createRange()).moveStart("character",-T.val().length),s=o.text.length):"ff"==l&&(s=i.selectionStart);var o,r=T.val().substring(0,s),d=T.val().substring(s,T.val().length);(T.val(r+n+d),s+=n.length,"ie"==l)?(T.focus(),(o=document.selection.createRange()).moveStart("character",-T.val().length),o.moveStart("character",s),o.moveEnd("character",0),o.select()):"ff"==l&&(i.selectionStart=s,i.selectionEnd=s,T.focus());i.scrollTop=a,i=null,G()}function W(i){var a=T.val(),s="";s=0==n.singleRow&&v.length>0?H(a,0):z(a);var l=t("<div></div>");l.append(e.Utility.encodeText(s));var o=new e.ChildDialog;o.setHeight(420),o.setWidth(850),o.setTitle(e.Msg.getMsg("Preview")),o.setModal(!0),o.setContent(l),o.show(),o.hidebuttons()}function j(e){L(!0)}function G(e){l.text(T.val().length),parseInt(l.text())>parseInt(r.text())?(o.text(">"),q("#ED0000")):parseInt(l.text())==parseInt(r.text())?(o.text("="),q("#000000")):(o.text("<"),q("#000000"))}function q(e){o.css("color",e),l.css("color",e),r.css("color",e)}function H(t,a){for(var s=t,l=t;l.indexOf("@@")>-1;){var o=(l=l.substring(l.indexOf("@@")+2)).substring(0,l.indexOf("@@")),r=null,d=Object.keys(n.getColumnNames()).filter((function(e){return n.getColumnNames()[e]===o}))[0];e.DisplayType.IsLookup(i.getField(d).getDisplayType())||e.DisplayType.Location==i.getField(d).getDisplayType()?null!=v[a][d.toLower()]&&null!=v[a][d.toLower()]&&(r=i.getField(d.toLower()).lookup.getDisplay(v[a][d.toLower()])):e.DisplayType.IsDate(i.getField(d).getDisplayType())?(r=i.getField(d).value,r=new Date(r)):r=v[a][d.toLower()],l=l.substring(l.indexOf("@@")+2),s=s.replace("@@"+o+"@@",r)}return s}function z(t){for(var a=t;a.indexOf("@@")>-1;){var s=(a=a.substring(a.indexOf("@@")+2)).substring(0,a.indexOf("@@")),l=null,o=Object.keys(n.getColumnNames()).filter((function(e){return n.getColumnNames()[e]===s}))[0];e.DisplayType.IsLookup(i.getField(o).getDisplayType())||e.DisplayType.Location==i.getField(o).getDisplayType()?null!=f[o.toLower()]&&null!=f[o.toLower()]&&(l=i.getField(o.toLower()).lookup.getDisplay(f[o.toLower()])):e.DisplayType.IsDate(i.getField(o).getDisplayType())?(l=i.getField(o).value,l=new Date(l)):l=1==n.singleRow?i.getField(o).value:f[o.toLower()],a=a.substring(a.indexOf("@@")+2),t=t.replace("@@"+s+"@@",l)}return t}function Q(t){var i=T.val(),n=!0;null!=i&&""!=i&&0!=i.trim().length||(n=!1,e.ADialog.confirm("SendWithoutBody",!0,"","Confirm",(function(e){e&&J(t,i)}))),n&&J(t,i)}function J(i,a){m=[];var s="",l=[];if(0==O.prop("checked")){var o={MobileNumbers:[]};if(N.val().contains(";"))for(var r=N.val().split(";"),d=0;d<r.length;d++)null!=r[d]&&""!=r[d]&&(K(r[d])?o.MobileNumbers.push(r[d]):s+=r[d]+",");else null!=N.val()&&""!=N.val()&&(K(N.val())?o.MobileNumbers.push(N.val()):s+=N.val()+",");if(null!=V&&null!=V)if(selectedValues=[],b.find("[id*=CheckBoxList1]:checked").each((function(){selectedValues.push(t(this).val())})),selectedValues.length>0)for(var c=0;c<selectedValues.length;c++)selectedValues[c]?o.MobileNumbers.push(selectedValues[c]):s+=selectedValues[c]+",";else if(0==N.val().trim().length)return void window.setTimeout((function(){e.ADialog.info("NoNumberFound")}),2);if(""!=s)return void window.setTimeout((function(){e.ADialog.info("InvalidMobileNumbers"," ",e.Msg.getMsg("MobileNo")+s)}),2);if(o.Body={},o.MobileNumbers.length>0)for(var u=0;u<o.MobileNumbers.length;u++)m.push({num:o.MobileNumbers[u],info:'"'+o.MobileNumbers[u]+'","'+T.val()+'","'+new Date+'","@@response@@"'});l.push(o)}else if(selectedValues=[],t("[id*=CheckBoxList1]:checked").each((function(){selectedValues.push(t(this).val())})),1==n.singleRow&&v.length>0)l.push($(f,0));else for(var g=0;g<v.length;g++)l.push($(v[g],g));var h=JSON.stringify(l);p[0].style.visibility="visible";var y={sms:h,format:T.val()};t.ajax({url:e.Application.contextUrl+"Sms/SendSms",data:y,datatype:"json",type:"post",cache:!1,success:function(i){var n=JSON.parse(i);if(p[0].style.visibility="hidden","SmsConfigurationNotFound"!=n.ResultMessage){for(var a=t('<div style="max-height: 300px;overflow:auto"></div>'),s=t("<table></table>"),l=0;l<n.Response.length;l++){var o=t("<tr></tr>"),r=t("<td></td>");r.append(n.Response[l].mobileNumber+" - "+n.Response[l].response),o.append(r),s.append(o)}a.append(s);var d=t('<a style="float:right" href="javascript:void(0)" ><i title="'+e.Msg.getMsg("SaveSmsLog")+'" class="vis vis-save"></i></a>');a.append(d);var c=new e.ChildDialog;c.setTitle(e.Msg.getMsg("Information")),c.setContent(a),c.show(),c.hidebuttons(),d.on("click",(function(){for(var e="",i=0;i<n.Response.length;i++){e+=t.grep(m,(function(e,t){return e.num==n.Response[i].mobileNumber}))[0].info.replace("@@response@@",n.Response[i].response)+"\n"}var a=(new Date).toISOString().slice(0,19).replace(/-/g,""),s="data:text/csv;base64,"+window.btoa(e);t(this).attr("href",s).attr("download","file-"+a+".csv")}))}else window.setTimeout((function(){e.ADialog.info("SmsConfigurationNotFound")}),2)},error:function(t){console.log(t),e.ADialog.error("MessageSendingFailed"),p[0].style.visibility="hidden"}})}function $(t,a){var s={MobileNumbers:[]};if(N.val().contains(";")){var l=N.val().split(";");for(a=0;a<l.length;a++)null!=l[a]&&""!=l[a]&&s.MobileNumbers.push(l[a])}else null!=N.val()&&""!=N.val()&&s.MobileNumbers.push(N.val());null!=V&&null!=V&&Object.keys(t).indexOf("mobile")>-1&&selectedValues.indexOf(t.mobile)>-1&&s.MobileNumbers.push(t.mobile);var o="";if(0==n.singleRow?(s.Body=function(t,a){for(var s={},l=t;l.indexOf("@@")>-1;){var o=(l=l.substring(l.indexOf("@@")+2)).substring(0,l.indexOf("@@")),r=null,d=Object.keys(n.getColumnNames()).filter((function(e){return n.getColumnNames()[e]===o}))[0];e.DisplayType.IsLookup(i.getField(d).getDisplayType())||e.DisplayType.Location==i.getField(d).getDisplayType()?null!=v[a][d.toLower()]&&null!=v[a][d.toLower()]&&(r=i.getField(d.toLower()).lookup.getDisplay(v[a][d.toLower()])):e.DisplayType.IsDate(i.getField(d).getDisplayType())?(r=i.getField(d).value,r=new Date(r)):r=v[a][d.toLower()],l=l.substring(l.indexOf("@@")+2),s["@@"+o+"@@"]=r}return s}(T.val(),a),o=H(T.val(),a)):(s.Body=function(t){for(var a=t,s={};a.indexOf("@@")>-1;){var l=(a=a.substring(a.indexOf("@@")+2)).substring(0,a.indexOf("@@")),o=null,r=Object.keys(n.getColumnNames()).filter((function(e){return n.getColumnNames()[e]===l}))[0];e.DisplayType.IsLookup(i.getField(r).getDisplayType())||e.DisplayType.Location==i.getField(r).getDisplayType()?null!=f[r.toLower()]&&null!=f[r.toLower()]&&(o=i.getField(r.toLower()).lookup.getDisplay(f[r.toLower()])):e.DisplayType.IsDate(i.getField(r).getDisplayType())?(o=i.getField(r).value,o=new Date(o)):o=f[r.toLower()],a=a.substring(a.indexOf("@@")+2),s["@@"+l+"@@"]=o}return s}(T.val()),o=z(T.val())),s.MobileNumbers.length>0)for(var r=0;r<s.MobileNumbers.length;r++)m.push({num:s.MobileNumbers[r],info:'"'+s.MobileNumbers[r]+'","'+o+'","'+new Date+'","@@response@@"'});return s}function K(e){var t=!0;if(e.indexOf("(")>-1&&(e=e.substring(0,e.toString().indexOf("("))),e.length<10||e.length>17)t=!1;else{var i,n;for(n=e.length,i=0;i<n;i++)isNaN(e[i])&&(/\s+$/.test(e[i])||"("!=e[i]&&")"!=e[i]&&(t=!1));e.indexOf("(")>-1&&!e.indexOf(")")>-1&&(t=!1)}return t}!function(){(g=s)||(i.gridTable.AD_Table_ID,v=n.getSelectedRows(),f=i.getRecords()[i.getCurrentRow()]);V=t('<ul class="vis-sms-ul" ></ul>'),(p=t("<div>")).css("position","absolute"),p.css("bottom","0"),p.css("background","url('"+e.Application.contextUrl+"Areas/VIS/Images/LoadingCircle.gif') no-repeat"),p.css("background-position","center center"),p.css("width","100%"),p.css("height","100%"),p.css("text-align","center"),p.css("opacity",".1"),p[0].style.visibility="hidden"}(),this.initializeComponent=function(){var a=t('<a href="javascript:void(0)"  class="vis-icon-menuclose"><i class="vis vis-cross"></i></a>'),s="";s=t(g?"<p>"+e.Msg.getMsg("Sms")+" ("+e.Msg.getMsg("Contacts")+") </p>":"<p>"+e.Msg.getMsg("Sms")+" ("+n.aPanel.$parentWindow.getName()+") </p>"),b.append(C.append(a).append(s)),b.append(p),a.click((function(e){y.dispose(),y=null,e.stopPropagation()})),function(){var i='         <div class="contentArea" style="width: 100%; float: left;">';i+=' <div class="vis-sms-leftDiv"></div>',i+='   <div class="vis-sms-ContentWrap"><div class="vis-sms-ContentArea"><div class="vis-sms-leftWrap"><div class="vacom-form-horizontal">',i+='   <div class="vis-sms-inputWrap"><div class="vis-sms-form-data-sub">',i+='         <input type="text"  id="'+y.windowNo+'_emailMoblie"  placeholder="'+e.Msg.getMsg("EnterMobileNumber")+'">',i+="</div>",i+="  </div>",i+='  </div><div class="vis-sms-textarea-div" style="width: 100%; float: left;">',i+=' <textarea  ondrop="return false;" id="'+y.windowNo+'_vis-sms-textarea" style="width: 100%; height:100%;resize:none" placeholder="'+e.Msg.getMsg("WriteMsgHere")+'"></textarea></div>',i+=' <div class="vis-sms-leftFooter">',i+='<div ><p class="vis-sms-counter" id='+y.windowNo+'_acCount></p> <p  class="vis-sms-counter"   id='+y.windowNo+'_oper></p> <p  class="vis-sms-counter"   id='+y.windowNo+"_maxCount >160</p> </div>",i+=' <input id="'+y.windowNo+'_dyndis" type="checkbox"><label  id="'+y.windowNo+'_dyndislbl"  for="'+y.windowNo+'_dyndis" >'+e.Msg.getMsg("DynamicSms")+"</label></div></div>",i+='  <div class="vis-sms-divider"></div>',i+=' <div class="vis-sms-rytWrap"><div class="vis-sms-rytContent">',i+=' <div class="vis-sms-rytBcc"><div class="vis-email-rytBcc-header"><h4>'+e.Msg.getMsg("Mobile")+"</h4>",i+=' <i id="'+y.windowNo+'_SmsRefresh" title="'+e.Msg.getMsg("Refresh")+'" class="vis vis-refresh"></i>',i+='   </div><div class="vis-sms-BccList">',i+=" </div></div></div></div>  </div></div>",b.append(t(i));var n=0;O=b.find("#"+y.windowNo+"_dyndis"),b.find(".contentArea").css("height",b.height()-42),b.find(".vis-sms-leftDiv").height(b.height()-42),_=b.find(".vis-sms-leftDiv"),x=b.find(".vis-sms-BccList"),N=b.find("#"+y.windowNo+"_emailMoblie"),k=b.find("#"+y.windowNo+"_SmsRefresh"),N.css("margin-top","10px"),T=b.find("#"+y.windowNo+"_vis-sms-textarea"),$leftfootArea=b.find(".vis-sms-leftFooter"),l=b.find("#"+y.windowNo+"_acCount"),o=b.find("#"+y.windowNo+"_oper"),r=b.find("#"+y.windowNo+"_maxCount"),b.find(".vis-sms-textarea-div").css("margin-top","10px"),b.find(".vis-sms-rytBcc").height(b.find(".vis-sms-rytContent").height()-10),g?(b.find(".vis-sms-leftDiv").hide(),b.find(".vis-sms-rytWrap").hide(),b.find(".vis-sms-textarea-div").height(b.height()-150),b.find(".vis-sms-leftWrap").css("width","100%"),b.find("#"+y.windowNo+"_dyndislbl").hide(),n=b.width()-40,O.prop("checked",!1),O.hide()):(b.find(".vis-sms-textarea-div").height(b.height()-150),n=b.width()-240,b.find(".vis-sms-leftWrap").width(n-345));(S=b.find(".vis-sms-ContentWrap")).css("width",n),M=!0,b.find(".vis-sms-BccList").height(b.find(".vis-sms-rytContent").height()-70)}(),d=t('<i class="vis-email-sendbtn vis vis-paper-plane vis-Sms-sendButton" title="'+e.Msg.getMsg("SendSms").replace("&","")+'" ></i>'),C.append(d),g||(c=t('<i class="vis-email-btns vis vis-viewdocument vis-sms-preview-btn" title="'+e.Msg.getMsg("Preview").replace("&","")+'"></i>'),C.append(c)),g||(!function(){A=t('<i class="fa fa-bars"></i>');var n=t('<div class="vis-apanel-lb-toggle" style="overflow-x:hidden;overflow-y:hidden"></div>');n.append(A),_.append(n),(w=t('<ul class="vis-apanel-lb-ul"></ul>')).css({height:"calc(100% - 54px)",overflow:"auto","white-space":"nowrap",width:"100%"});for(var a=0;a<i.gridTable.getFields().length;a++){var s=i.gridTable.getFields(0)[a].getColumnName().toUpper()==i.getKeyColumnName().toUpper();if(i.gridTable.getFields(0)[a].getIsDisplayed()||s){s||w.append(t("<li>"+i.gridTable.getFields(0)[a].getHeader()+"</li>"));var l=[],o=[];if(i.gridTable.getFields(0)[a].getColumnName().toUpper().equals(h))for(var r=0;r<v.length;r++)e.DisplayType.IsLookup(i.getField(h).getDisplayType()),null!=v[r][h.toLower()]&&(l.push(v[r][h.toLower()]),o.push(v[r][i.getKeyColumnName().toLower()]));E(l,o)}}_.append(w)}(),L(!1)),d.on("click",Q),T.on("keyup",G),g||(A.on("click",P),O.on("click",F),w.children("li").on("click",B),c.on("click",W),A.trigger("click"),k.on("click",j))},this.disposeComponent=function(){d.off("click"),g||(A.off("click"),w.children("li").off("click"),w.remove(),A.remove()),O.off("click"),null!=c&&(c.off("click"),c.remove()),T.off("keyup"),b.find(".vis-sms-CcBcc").off("click"),null,u=null,g=!1,h="",v=null,f=null,0,w=null,b.remove(),b=null,_.remove(),_=null,S.remove(),S=null,x.remove(),x=null,A=null,V.remove(),V=null,N.remove(),N=null,null!=w&&w.remove(),w=null,d.remove(),d=null,c=null,y=null},this.show=function(){(u=new e.ChildDialog).setHeight(800),u.setWidth(1600),u.setTitle(e.Msg.getMsg("Sms")),u.setModal(!0),u.show(),b=t('<div class="vis-sms-rootDiv"></div>'),u.setContent(b),initializeComponent()},this.getRoot=function(){return b},this.sizeChanged=function(e,t){I=e,D=t,1==M&&function(){b.height(I),b.width(D);var e=0;b.find(".contentArea").css("height",b.height()-42),b.find(".vis-sms-leftDiv").height(b.height()-42),b.find(".vis-sms-textarea-div").css("margin-top","10px"),b.find(".vis-sms-rytBcc").height(b.find(".vis-sms-rytContent").height()-10),g?(b.find(".vis-sms-leftDiv").hide(),b.find(".vis-sms-rytWrap").hide(),b.find(".vis-sms-textarea-div").height(b.height()-150),b.find(".vis-sms-leftWrap").css("width","100%"),e=b.width()-40,O.prop("checked",!1),O.hide()):(b.find(".vis-sms-textarea-div").height(b.height()-150),e=D-(b.find(".vis-sms-leftDiv").width()+30),b.find(".vis-sms-leftWrap").width(e-345)),(S=b.find(".vis-sms-ContentWrap")).css("width",e)}()}}i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,t.hideHeader(!0),this.initializeComponent(),this.frame.getContentGrid().append(this.getRoot())},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Sms=i}(VIS,jQuery)},5887:()=>{!function(e,t){function i(){this.frame,this.windowNo;var i,n,a,s,l,o,r,d,c=t('<div class="vis-forms-container" style="padding:3px 0 7px;background-color:white;height:100%"/>'),u=!0,g=50,h=1,v=[],f=[],m=!0,y=0,I=null,D=null,w=null,b=null,C=!0,_=!0,S=null,x=null,A="",T=null,V=1,N=50,M=0,k=null,O=!1,L=null,R="All",E=!1,P=!0,U=(e.Application.contextUrl,t("<div  class='VIS-TM-left-tree'>")),F=(t("<div  class='VIS-TM-middle'>"),t("<div class='VIS-TM-right-slide'>")),B=!1,W=t('<div class="VIS-TM-data-head" style="padding-top: 8px;">'),j=t('<div class="VIS-TM-data">'),G=t('<input disabled type="checkbox" checked="true" />'),q=t("<span>"+e.Msg.getMsg("OnlySummaryLevel")+"<span/>"),H=t("<h4>"+e.Msg.getMsg("SelectTree")+"</h4>"),z=/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase());W.append(H).append(j.append(G).append(q));var Q=t('<div class="VIS-TM-treeCombo">'),J=t("<select></select>"),$=t('<span style="display:none" class="VIS-Tm-btnicon vis vis-refresh"  title='+e.Msg.getMsg("RefreshSelectTree")+"></span>"),K=t('<span class="VIS-Tm-btnicon vis vis-refresh" style="float:left" title="'+e.Msg.getMsg("tmRefresh")+'"></span>'),Y=t('<span class="VIS-Tm-btnicon fa fa-minus-square-o"  style="display:none;" title="'+e.Msg.getMsg("TreeCollapse")+'" ></span>'),X=t('<span class="VIS-Tm-btnicon fa fa-plus-square-o" title="'+e.Msg.getMsg("TreeExpand")+'" ></span>'),Z=t("<i class='vis vis-find VIS-Tm-btnicon' title='"+e.Msg.getMsg("CreateNewTree")+"'></i>"),ee=t('<div class="vis-tm-treeCmbDisable "></div>');Q.append(ee).append(J).append(Z).append(K).append(Y).append(X);var te=t('<div class="VIS-TM-tree-wrap">'),ie=t('<div class="VIS-TM-root-node" style="overflow:visible">'),ne=t('<div class="vis-tm-topTreeDiv">');te.resizable({handles:"n,s,se"});var ae=t('<div style="z-index:9;width:28px;display:none;text-align:center;float: right; height: 95%; position: absolute; right: 5px;"></div>'),se=t('<span class="VIS-Tm-deletetreenode" style="margin:auto;display:none;position: relative;top: 50%;"></span>');ae.append(se),ne.append($).append(ae).append(ie),te.append(ne);var le=t("<div class='VIS-TM-tree-search'>"),oe=t("<input disabled placeholder='"+e.Msg.getMsg("Search")+"' type='search'>"),re=t('<span class="VIS-Tm-btnicon vis vis-search"></span>'),de=t('<div class="vis-tm-b-s-ryt">'),ce=t('<input type="checkbox" disabled>'),pe=t('<label style="font-weight: normal;margin-bottom:0px">'+e.Msg.getMsg("NodeItem")+"</label>");de.append(ce).append(pe);var ue=t('<span class="vis-tmlinkdel-icon"></span>');le.append(oe).append(ue).append(de).append(re);var ge=t("<div class='VIS-TM-data-headMID'>"),he=t("<span style='display:inherit;' class='VIS-Tm-unlinkforbottmo vis vis-link ' title='"+e.Msg.getMsg("UnlinkNode")+"' ></span>"),ve=t('<h4 style="float:left">'+e.Msg.getMsg("SelectTree")+"</h4>"),fe=t("<div class='VIS-TM-dataWrap' style='padding-top:0px' >"),me=t('<span class="VIS-TM-recordeNotFound">'+e.Msg.getMsg("TMRecordNotFound")+"</span>"),ye=t('<ul class="vis-tm-sortable" style="list-style: none;padding:0">'),Ie=t('<input type="checkbox" disabled />'),De=t('<span class="vis vis-search" style="display:none;cursor:pointer;float:left;margin: 14px 0 0 6px;font-size: 10px;" ></span>');fe.append(ye).append(me);var we=t('<span style="display:inherit;" class="vis-tm-childnodeinidailog" title="'+e.Msg.getMsg("SetOrder")+'">Set Order</span>');we.addClass("vis-tm-delete");var be=t('<div style="display:none;position:absolute;height: 40.2px;width: 100%; z-index: 5;"></div>');ge.append(be).append(Ie).append(ve).append(De).append(we).append(he);var Ce=t("<div class='VIS-TM-data-head'>"),_e=t("<h4>"+e.Msg.getMsg("AllItems")+"</h4>"),Se=t("<div class='VIS-TM-dataWrap'>"),xe=t("<div class='VIS-TM-treeList'>"),Ae=t("<ul style='list-style: none' class='scrolldrag' >"),Te=t("<input disabled placeholder='"+e.Msg.getMsg("Search")+"' type='search'>"),Ve=t('<span class="VIS-Tm-btnicon vis vis-search" style="top:0px;float:none"></span>'),Ne=t("<div class='VIS-TM-path'>"),Me=t("<i style='font-weight:600'>"),ke=t('<select disabled style="float: right; min-width: 100px"></select>'),Oe=t('<span style="margin: 0 7px;">'+e.Msg.getMsg("Show")+"<span/>"),Le=t('<input type="checkbox"  style="float:left;margin-right:5px" disabled  />'),Re=t("<span>"+e.Msg.getMsg("TraceItem")+"<span/>"),Ee=t('<input type="checkbox" disabled />'),Pe=t('<span class="vis-unlinkallNodes vis-tm-opacity" title="'+e.Msg.getMsg("UnlinkItem")+'"  ><b></b><b></b><b></b></span>');Ce.append(Ee).append(_e).append(t('<div class="vis-tm-r-list-w">').append(Oe).append(ke).append(Pe));var Ue=t('<div class="vis-tm-nodeItemDeleteliketopdiv"><span class="VIS-Tm-deletetreenode vis-tm-nodeItemDeletespans" ></span></div>'),Fe=t('<div style="float:left;width:100%;">'),Be=t('<div style="z-index:999;height:100%;display:none;position:absolute; left:0; right:0; top:0; bottom:0;"></div>');Fe.append(Be).append(ge).append(fe).append(Ue);var We=t('<div class="VIS-TM-leftMianDataDiv">');We.append(te).append(Fe);var je=t('<div style="display:none;height: 100%; width: 100%; position: absolute;z-index: 9999;"></div>');U.append(je).append(t('<div style="height:100%;" >').append(W).append(Q).append(We).append(le));var Ge=t('<div class="VIS-TM-Righttree-search" >'),qe=t('<span class="vis-tmlinkdel-icon"></span>');Ge.append(Te).append(qe).append(Ve);var He=t('<span class="VIS-TM-recordeNotFound" style="margin-top:50%" >'+e.Msg.getMsg("TMRecordNotFound")+"</span>"),ze=t('<div style="z-index:999;height:100%;display:none;position:absolute; left:0; right:0; top:0; bottom:0;"></div>');function Qe(){t.ajax({url:e.Application.contextUrl+"TreeMaintenance/TreeDataForCombo",success:function(i){var a=JSON.parse(i);if(a){J.append(t("<Option value=''> </option>"));for(var s=0;s<a.length;s++)J.append(t("<Option value="+a[s].ID+" data-type='"+a[s].TreeType+"' data-isallnodes='"+a[s].IsAllNodes+"'  >"+e.Utility.encodeText(a[s].Name)+"</option>"))}null!=n&&J.val(n.attr("value")),I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="visible"}})}function Je(){ee.css("display","none"),s=0,Ae.empty(),ye.empty(),Me.empty(),A="",Te.val(""),n=null,he.addClass("vis-tm-delete"),oe.val(""),window.setTimeout((function(){Ae.empty(),i.data("kendoTreeView").destroy(),i.empty()}),200),_e.text(e.Msg.getMsg("SelectTree")),ve.text(e.Msg.getMsg("SelectTree")),me.css("display","none"),we.addClass("vis-tm-delete"),ce.prop("disabled",!0),Le.prop("disabled",!0),ce.css("cursor","not-allowed"),Le.css("cursor","not-allowed"),oe.prop("disabled",!0),Te.prop("disabled",!0),ke.prop("disabled",!0),Ee.prop("disabled",!0),Ee.css("cursor","not-allowed"),qe.css("display","none"),ue.css("display","none"),Le.prop("checked",!1),Ee.prop("checked",!1),ce.prop("checked",!1),Ie.prop("checked",!1)}function $e(){var i=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTableID",{treeId:s},null),n=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTableName",{table_id:i},null);gt();var a=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetRecordCount",{tablename:n,tableTreeName:ut,treeId:s},null);if(Ke=a>0,"false"==Tt&&sqlQry==Vt.length){var l=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetNodeIds",{tableTreeName:ut,treeId:s},null);if(null!=l)for(var o=null,r=0;r<l.length;r++){if(o=l[r],t.inArray(o,Vt)<0){Ke=!0;break}Ke=!1}}}Se.append(ze).append(Ge).append(xe.append(Ae).append(He)).append(Ne.append(Me)),F.append(t('<div  style="height:100%">').append(Ce).append(Se)),c.append(U).append(F);var Ke=!1;function Ye(i,n,a,s){b[0].style.visibility="visible",G.is(":checked")||(Hi(),s=!!G.is(":checked")),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/BindTree",type:"Post",data:{treeType:i,AD_Tree_ID:n,isAllNodes:a,isSummary:s},success:function(e){var t=JSON.parse(e);t&&(Ze(t),window.setTimeout((function(){window.setTimeout((function(){(""==J.val()||null==J.val())&&Je(),$e()}),400)}),500),t,t.settree),b[0].style.visibility="hidden"},error:function(e){console.log(e),b[0].style.visibility="hidden"}})}var Xe=!0;function Ze(n){b[0].style.visibility="visible",ee.css("display","inherit"),i&&null!=i.data("kendoTreeView")&&(i.data("kendoTreeView").destroy(),i.empty()),i=ie.kendoTreeView({autoScroll:!0,dragAndDrop:!0,drag:nt,drop:st,dataSource:n.settree,select:function(e){D[0].style.visibility="visible",G.is(":checked")&&je.css("display","inherit"),ye.empty(),Ie.prop("checked",!1),ie.find(".k-state-selected").removeClass("k-state-selected"),t(e.node).find(".k-state-hover").addClass("k-state-selected").removeClass("k-state-hover");var i=t(t(t(e.node).find(".treechild")[0]).find("p")).text();ve.text(i),y=t(t(e.node).find(".treechild")[0]).attr("data-nodeid"),C=!0,Bi=-1,he.addClass("vis-tm-delete"),me.css("display","none"),Xe=!1,ie.find(".vis-tm-selectedkendoNode").removeClass("vis-tm-selectedkendoNode"),ie.find(".k-state-selected").find("p").addClass("vis-tm-selectedkendoNode"),window.setTimeout((function(){ie.find(".vis-tm-selectedkendoNode").removeClass("vis-tm-selectedkendoNode"),ie.find(".k-state-selected").find("p").addClass("vis-tm-selectedkendoNode"),V=1,N=50,T=ce.is(":checked")?oe.val():"",_t=ce.is(":checked")?"true":"false",window.setTimeout((function(){y=ie.find(".k-state-selected").find(".treechild").attr("data-nodeid"),G.is(":checked")&&(ie.find(".k-state-hover").removeClass("k-state-hover"),dt(y,s,V,N,T,_t,e))}),300)}),300)},template:"<div class='treechild'  data-getparentnode='#= item.getparentnode #'       data-IsSummary='#= item.IsSummary #' data-TableName='#= item.TableName #' data-NodeID='#= item.NodeID #'   data-TreeParentID='#= item.TreeParentID #' data-ParentID='#= item.ParentID #'  ><div class='imgdivTree'><i class='fa fa-folder-o' data-imgsrc='#= item.ImageSource #'></i></div><div class='textdivTree'><p>"+e.Utility.encodeText("#= item.text #")+"</p></div></div>"}),It(),i.find(".k-plus").on("click",(function(){t(this).hasClass("k-minus")&&(X.css("display","inherit"),Y.css("display","none")),t(this).hasClass("k-plus")&&(Y.css("display","inherit"),X.css("display","none"))})),i.find(".k-in").on("dblclick",(function(e){t(ie.find(".k-state-selected").parent().find("span")[0]).hasClass("k-minus")&&(X.css("display","inherit"),Y.css("display","none")),t(ie.find(".k-state-selected").parent().find("span")[0]).hasClass("k-plus")&&(Y.css("display","inherit"),X.css("display","none"))})),window.setTimeout((function(){ee.css("display","none")}),200),1==Qt&&(i.data("kendoTreeView").expand(".k-item"),ie.find("div").find("div[data-nodeid='"+Jt+"']").parent().addClass("k-state-selected"),ie.find("span").hasClass("k-state-selected")&&ie.find("div").find("div[data-nodeid='"+Jt+"']").parent().addClass("k-state-selected")[0].scrollIntoView()),""!=oe.val()&&Ei(Oi),Pi(),window.setTimeout((function(){""!=oe.val()&&Ei(Ri)}),200),function(){At=[];var t=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTableID",{treeId:s},null),i=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTableName",{table_id:t},null);Tt="true","AD_Menu"==i&&(Tt=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/IsRecordExists",{treeId:s},null));e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetWindowMenuIds",{},null);var n=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetFormMenuIds",{},null);if(null!=n&&n.length>0)for(var a=0;a<n.length;a++)At.push(n[a]);Vt=At,At=At.toString();var l=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetNameByIds",{ids:At},null),o="";if(null!=l&&l.length>0)for(var r=0;r<l.length;r++)o+=l[r],o+=",";Nt=o+" "+e.Msg.getMsg("MenuBinded"),D[0].style.visibility="hidden"}()}var et=null,tt=null,it=t('<div class="vis-tm-unlinkimgss">');function nt(e){Oi=e,Fe.addClass("vis-tm-bottomdivdisable"),Be.css("display","inherit"),ze.css("display","inherit"),r=t(e.sourceNode).find(".treechild").attr("data-nodeid"),S=t(e.sourceNode).find(".treechild").parent().parent().parent(),tt=t(e.sourceNode),et=this.dragging._draggable.hint.find(".k-denied"),t(ie.find("ul")[0]).css("width","95%"),ae.addClass("VIS-TM-ondragdrop"),0!=r&&(se.css("display","inherit"),ae.css("display","inherit")),0==t(e.sourceNode).find(".treechild").attr("data-nodeid")&&e.setStatusClass("k-denied"),"false"==t(e.dropTarget).parent().parent().attr("data-issummary")&&e.setStatusClass("k-denied"),"false"==t(e.dropTarget).parent().parent().parent().parent().parent().find(".treechild").attr("data-issummary")&&e.setStatusClass("k-denied"),t(e.dropTarget).hasClass("k-top")&&"false"==t(e.dropTarget).find(".treechild").attr("data-issummary")&&e.setStatusClass("k-denied"),t(e.dropTarget).hasClass("k-item")&&e.setStatusClass("k-denied"),1==this.dragging._draggable.hint.find(".k-add").length&&"false"==t(e.dropTarget).parent().attr("data-issummary")&&e.setStatusClass("k-denied"),1==t(e.dropTarget).parent().find(".textdivTree").length&&1==this.dragging._draggable.hint.find(".k-add").length&&e.setStatusClass("k-denied"),"true"!=t(e.dropTarget).attr("aria-expanded")&&"false"!=t(e.dropTarget).attr("aria-expanded")||e.setStatusClass("k-denied"),t(e.dropTarget).hasClass("selectchangecolor")?(et.css("display","none"),et.parent().prepend(it),et.parent().find(".vis-tm-unlinkimgss").css("display","inherit")):(et.css("display","inherit"),et.parent().find(".vis-tm-unlinkimgss").css("display","none")),t(e.dropTarget).hasClass("glyphicon glyphicon-trash")&&(et.css("display","none"),et.parent().prepend(it)),this.dragging._draggable.hint.find("span").hasClass("k-insert-bottom")&&e.setStatusClass("k-denied"),t(e.dropTarget).hasClass("k-state-hover")&&"false"==t(e.dropTarget).find(".treechild").attr("data-issummary")&&e.setStatusClass("k-denied"),t(e.dropTarget).hasClass("VIS-TM-root-node")&&e.setStatusClass("k-denied")}var at=0;function st(n){if(at=0,at=ie.find(".k-state-selected").find(".treechild").attr("data-nodeid"),Oi=n,fe.css("overflow","auto"),Se.css("overflow","auto"),xe.css("overflow","auto"),Fe.removeClass("vis-tm-bottomdivdisable"),Be.css("display","none"),ze.css("display","none"),n.sourceNode.previousSibling==n.destinationNode&&"after"==n.dropPosition)return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(n.sourceNode.nextSibling==n.destinationNode&&"before"==n.dropPosition)return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if("after"==n.dropPosition){if(0==t(n.dropTarget).parent().attr("data-nodeid"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(0==t(n.dropTarget).find(".treechild").attr("data-nodeid"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(t(n.dropTarget).hasClass("k-minus"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none")}if("before"==n.dropPosition){if(0==t(n.dropTarget).find(".treechild").attr("data-nodeid"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(t(n.dropTarget).hasClass("k-minus"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(t(n.dropTarget).parent().hasClass("imgdivTree"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(t(n.dropTarget).hasClass("VIS-TM-tree-wrap"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(t(n.dropTarget).parent().hasClass("k-bot")&&"group"!=t(t(t(n.dropTarget).parent()).parent()).parent().attr("role"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(t(n.dropTarget).parent().hasClass("textdivTree")&&0==t(n.dropTarget).parent().parent().attr("data-nodeid"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none")}if("over"==n.dropPosition){if("false"==t(n.dropTarget).parent().attr("data-issummary"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none");if(0==t(n.dropTarget).find(".treechild").attr("data-nodeid"))return n.preventDefault(),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),void se.css("display","none")}if(ae.hasClass("selectchangecolor")&&t(t(this.dragging._draggable.hint)).animate({left:"250px",opacity:"0.5",height:"2px",width:"2px"},1e3),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),se.css("display","none"),!et.hasClass("k-denied")||ae.hasClass("selectchangecolor")){treeType=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTreeType",{treeId:s},null),x="PR"==treeType?"AD_TreeNodePR":"BP"==treeType?"AD_TreeNodeBP":"MM"==treeType?"AD_TreeNodeMM":"AD_TreeNode";var a=i.find(".k-state-hover").find(".treechild").attr("data-nodeid");if("true"==i.find(".k-state-hover").find(".treechild").attr("data-issummary")){!function(i,n,a){I[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"TreeMaintenance/SaveTreeDragDrop",type:"Post",data:{treeID:i,NodeID:n,ParentID:a},success:function(t){JSON.parse(t);e.Msg.getMsg("VIS_DataSave"),I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}})}(s,r,a);var l=t(n.destinationNode);return I[0].style.visibility="visible",void window.setTimeout((function(){I[0].style.visibility="visible",ot(l),""!=oe.val()&&Ei(n),Pi(),lt(),I[0].style.visibility="hidden"}),100)}t(n.destinationNode).parent().parent().find(".treechild").attr("data-issummary");if(n.sourceNode===n.destinationNode)return n.setValid(!1),void(I[0].style.visibility="hidden");if(lt(),at>0&&window.setTimeout((function(){ie.find(".k-state-selected").removeClass("k-state-selected"),t(ie.find("div").find("div[data-nodeid='"+at+"']").parent()).addClass("k-state-selected"),Pi()}),200),"tree"==t(n.destinationNode).parent().parent().parent().attr("role")){l=t(n.destinationNode);I[0].style.visibility="visible";var o=n.dropPosition,d=n.sourceNode,c=t(t(n.sourceNode.parentElement).parent().find(".k-in")[0]).find(".treechild").attr("data-nodeid");window.setTimeout((function(){if(I[0].style.visibility="visible",l.parent().children().length>0){var i=0;i=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetSeqNo",{treeId:s,tblName:x,nodeId:l.find(".treechild").attr("data-nodeid")},null),"after"==o&&(i+=1),e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/UpdateSeqNo",{treeId:s,tblName:x,seqNo:i,bySeqNo:!0,isParent:!1},null);var n=t(d).find(".treechild").attr("data-nodeid");c>0?e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/UpdateSeqNo",{treeId:s,tblName:x,seqNo:i,nodeId:n,bySeqNo:!1,isParent:!0},null):e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/UpdateSeqNo",{treeId:s,tblName:x,seqNo:i,nodeId:n,bySeqNo:!1,isParent:!1},null)}I[0].style.visibility="hidden"}),600)}else{var p=t(n.destinationNode);if(0==p.length)return M=t(n.sourceNode).find(".treechild").attr("data-nodeid"),k=t(n.sourceNode).find(".treechild").parent().parent().parent(),ae.hasClass("selectchangecolor")?void function(i){Oi=i,gt();var n=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetNodeIdsOfParent",{tbname:ut,parent_id:r,treeId:s},null);if(null!=n&&0==n.length){if(O=!0,ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),se.css("display","none"),"false"==Tt){if(t.inArray(parseInt(M),Vt)>=0)return void e.ADialog.info("NeverDelete",!0,Nt);hi(s,M,k,O)}else hi(s,M,k,O);return}I[0].style.visibility="hidden",gi(),e.ADialog.confirm("ChildAlsoWillbeRemove",!0,"","Confirm",(function(e){e?(hi(s,M,k,O=!0),ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),se.css("display","none")):(ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),se.css("display","none"))}))}():(ae.removeClass("VIS-TM-ondragdrop"),ae.css("display","none"),se.css("display","none"),void(I[0].style.visibility="hidden"));var u=n.destinationNode.parentElement,g=n.sourceNode.parentElement,h=n.destinationNode,v=n.sourceNode;I[0].style.visibility="visible",window.setTimeout((function(){I[0].style.visibility="visible";t(t(v).find(".treechild").parent().parent().parent().parent().parent()).find("li").find(".k-state-hover").find("div").attr("data-nodeid");var i,n=p.parent().children();if(u==g){if(0!=(i=t(g.parentElement).find(".treechild").attr("data-nodeid")))for(var a=0;a<n.length;a++){var l=t(n[a]).find(".treechild").attr("data-nodeid");e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/UpdateSeqNoParentId",{treeId:s,tblName:x,seqNo:a,nodeId:l,pid:i},null)}}else if(0!=(i=t(h.parentElement).parent().find(".treechild").attr("data-nodeid")))for(a=0;a<n.length;a++){l=t(n[a]).find(".treechild").attr("data-nodeid");e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/UpdateSeqNoParentId",{treeId:s,tblName:x,seqNo:a,nodeId:l,pid:i},null)}I[0].style.visibility="hidden"}),600)}window.setTimeout((function(){""!=oe.val()&&Ei(n)}),300)}}function lt(){ie.find(".k-state-selected").length>1&&(ie.find(".k-state-selected").removeClass("k-state-selected"),ye.empty())}function ot(e){var i,n=e.parent();if("tree"==n.attr("role"))(i=e.parent().children().children("ul").children()[e.parent().children().children("ul").children().length-1])&&n&&(i.remove(),t(t(n.children()[0]).children("ul")).prepend(i));else if(e.children("ul")&&(i=e.children("ul").children()),i&&(i=t(i[i.length-1])),i&&i.siblings().length>0){var a=t(i.siblings()[0]).parent();ie.data("kendoTreeView").detach(i[0]),a.prepend(i[0])}}var rt=!1;function dt(i,n,a,s,l,o,r){D[0].style.visibility="visible",null==l&&(l=""),It(),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/GetDataTreeNodeSelect",type:"Post",async:!1,data:{nodeID:i,treeID:n,pageNo:a,pageLength:s,searchChildNode:l,getTreeNodeChkValue:o},success:function(i){if(0!=P){var n=JSON.parse(i),a=null;if(n.length>0){D[0].style.visibility="visible",1==C&&ye.empty(),rt=!0;for(var s=0;s<n.length;s++){if(0==C&&ye.find("li li").length>0){var l=ye.find('[data-id="'+n[s].parentID+'"]');if(l&&l.length>0)continue}if(0!=n[s].parentID){var o=t('<input class="VIS-tm-checkbox" type="checkbox" />');"Y"!=n[s].issummary&&(a="<i class='vis vis-m-window summNonsumImage' data='Images/mWindow.png'></i>",ye.append(t('<li class="VIS-tm-topMLi">').append(o).append(a).append(t("<li class='VIS-tm-MLi'    data-id='"+n[s].parentID+"' data-issummary='"+n[s].issummary+"' id='"+n[s].parentID+"'   >"+e.Utility.encodeText(n[s].name)+"</li>"))))}}me.css("display","none"),vt(),bt(),It()}else ye.find("li").length>0?(rt=!0,me.css("display","none")):(rt=!1,me.css("display","inherit"));Ei(r),window.setTimeout((function(){ye.find("input:checked").length>0?he.removeClass("vis-tm-delete"):he.addClass("vis-tm-delete")}),200),di(),Ie.is(":checked")&&(ye.find("input").prop("checked",!0),ye.find("input").parent().addClass("vis-tm-menuselectedcolor")),ye.find("li").length>0?(rt=!0,me.css("display","none")):(rt=!1,me.css("display","inherit")),oe.prop("disabled",!1),re.prop("disabled",!1),oe.focus(),St=!0,!0,je.css("display","none"),I[0].style.visibility="hidden",$e(),D[0].style.visibility="hidden"}},error:function(e){je.css("display","none"),rt=!1,console.log(e),ye.empty(),oe.prop("disabled",!1),re.prop("disabled",!1),oe.focus(),!0,I[0].style.visibility="hidden",D[0].style.visibility="hidden"}}),window.setTimeout((function(){ye.find("li").length>0?(rt=!0,me.css("display","none"),we.removeClass("vis-tm-delete"),D[0].style.visibility="hidden"):(rt=!1,we.addClass("vis-tm-delete"))}),500),fe.height(We.height()-(te.height()+20+ge.height()))}var ct=null;function pt(){I[0].style.visibility="hidden",gi();var i=new e.ChildDialog;i.setEnableResize(!1),i.setTitle(e.Msg.getMsg("UnlinkRecord")),i.setModal(!0),i.setContent(ui),i.show(),i.onClose=function(){},i.onOkClick=function(e){for(var i=[],n=0;n<ye.find("input:checked").length;n++){var a=t(ye.find("input:checked")[n]).parent().find("li").attr("data-id");i.push(a)}0==ye.find("input:checked").length&&i.push(ct),bottomchildselectedID=i,i=i.toString(),ri(s,i),Ue.removeClass("VIS-TM-ondragdrop"),Ue.css("display","none")},i.onCancelClick=function(){Ue.removeClass("VIS-TM-ondragdrop"),Ue.css("display","none")}}var ut=null;function gt(){t.ajax({url:e.Application.contextUrl+"TreeMaintenance/TreeTableName",async:!1,data:{treeID:s},success:function(e){var t=JSON.parse(e);ut=t},error:function(e){console.log(e),I[0].style.visibility="hidden"}})}var ht=[];function vt(){t(ye.find("li")).draggable({cursorAt:{left:-10,top:-10},helper:function(){var e=t(ye.find("li")).find("input:checked").parent();0===e.length&&(e=t(this));var i=t("<div/>").attr("id","draggingContainer");if(0==t(ye.find("li")).find("input:checked").length){if(t(this).hasClass("VIS-tm-topMLi"))return;e=t(this).parent(),i=t('<div style="background-color:lightblue;"/>').attr("id","draggingContainer")}return i.append(e.clone()),(o=i).css("width","250px"),o.css({"z-index":2}),o.css({"max-height":"250px",overflow:"auto"}),o.css({overflow:"hidden"}),i},start:function(e,i){t(this).attr("id"),m=!0,v=[],ht=[];for(var n=0;n<t(t(o.find("li li"))).length;n++){var a=t(t(o.find("li li"))[n]).attr("id");ht.push(parseInt(a)),v.push(a)}It(),!1,mt=!0,wt=!1,Dt(),ze.css("display","inherit"),he.css("display","none"),Ue.height(Fe.height()),Ue.css("margin-top","5px"),Ue.css("background-color","#FFC0CB"),Ue.css("display","inherit"),Ue.mouseover((function(e){Ue.addClass("selectchangecolor"),Ue.css("background-color","#ff0000")})),Ue.mouseleave((function(){Ue.removeClass("selectchangecolor"),Ue.css("background-color","#FFC0CB")}));var s=We.width()-35;Fe.width(s),we.css("display","none"),fe.css("overflow","hidden")},drag:function(e,t){},stop:function(){if(mt=!1,Ue.hasClass("selectchangecolor")){I[0].style.visibility="visible",gt();var i=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetNodeIdsOfParent",{tbname:x,parent_id:ct,treeId:s},null);if(null!=i&&0==i.length){if(v.length>0)if("false"==Tt){for(var n=[],a=0;a<ht.length;a++)t.inArray(ht[a],Vt)>=0||n.push(ht[a]);n.length>0?ri(s,n.toString()):(e.ADialog.info("NeverDelete",!0,Nt),I[0].style.visibility="hidden")}else ri(s,v.toString());else e.ADialog.info("NeverDelete",!0,Nt),I[0].style.visibility="hidden";Ue.removeClass("VIS-TM-ondragdrop"),Ue.css("display","none"),he.css("display","inherit")}else pt()}Ue.removeClass("VIS-TM-ondragdrop"),Ue.css("display","none"),he.css("display","inherit"),Fe.css("width","100%"),fe.css("overflow","auto"),ze.css("display","none"),we.css("display","inherit")}})}function ft(i,n,a,s){0==Ae.find("li").length&&Me.empty(),0!=Qi&&Ae.empty(),w[0].style.visibility="visible",null==(a=e.Utility.encodeText(a))&&(a=""),je.css("display","inherit"),ze.css("display","inherit"),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/LoadMenuData",type:"Post",data:{pageLength:g,pageNo:h,treeID:i,searchtext:a,demandsMenu:s},success:function(i){var n,a,s,l,r=JSON.parse(i);t("<span></span>");if(r){for(var d=0;d<r.length;d++){if(Ae.find("li li").length>0){var c=Ae.find('[data-id="'+r[d].ID+'"]');if(c&&c.length>0)continue}0!=r[d].ID&&("Y"==r[d].issummary?(1==r[d].disabled?(s=t('<input class="vis-tm-chkbox" disabled type="checkbox" />'),n="<i class='"+r[d].classopacity+" fa fa-folder-o summNonsumImage' data-imgsrc='Images/summary.png'></i>"):(s=t('<input  class="vis-tm-chkbox" type="checkbox" />'),n="<i class='vis vis-m-window summNonsumImage' data-imgsrc='Images/folder.png'></i>"),Ae.append(t('<li class="vis-tm-upperLi">').append(t("<div class='vis-tm-upperdivchkandimg'>").append(s).append(n)).append(t("<div class='vis-tm-upperdivli'>").append(t("<li class='"+r[d].classopacity+" vis-tm-textli ' checkSummary='checkSummary'  style='cursor:default;' id='"+r[d].ID+"' data-id='"+r[d].ID+"'  style='cursor:pointer'  >"+e.Utility.encodeText(r[d].Name)+" ("+e.Utility.encodeText(r[d].description)+")</li>").append(t("<span title='"+e.Msg.getMsg("UnlinkNode")+"' class='"+r[d].unlinkClass+"'></span>")))))):(1==r[d].disabled?(s=t('<input  class="vis-tm-chkbox"  disabled type="checkbox" />'),a="<i class='"+r[d].classopacity+" vis vis-m-window summNonsumImage' data-imgsrc='Images/nonSummary.png'></i>"):(s=t('<input  class="vis-tm-chkbox" type="checkbox" />'),a="<i class='vis vis-m-window summNonsumImage' data-imgsrc='Images/mWindow.png'></i>"),Ae.append(t('<li class="vis-tm-upperLi">').append(t("<div class='vis-tm-upperdivchkandimg'>").append(s).append(a)).append(t("<div class='vis-tm-upperdivli'>").append(t("<li class='"+r[d].classopacity+" vis-tm-textli ' style='cursor:default;' id='"+r[d].ID+"' data-id='"+r[d].ID+"'   style='cursor:pointer'  >"+e.Utility.encodeText(r[d].Name)+" ("+e.Utility.encodeText(r[d].description)+")</li>").append(t("<span title='"+e.Msg.getMsg("UnlinkNode")+"' class='"+r[d].unlinkClass+"'></span>")))))))}Ae.find("li").length>0?He.css("display","none"):He.css("display","inherit")}else Ae.find("li").length>0?He.css("display","none"):He.css("display","inherit");Oi=l,t(Ae.find("li")).draggable({cursorAt:{left:-10,top:-10},helper:function(){o=[];var e=t(Ae.find("input:checked")).parent().parent();0===e.length&&(e=t(this));var i=t("<div/>");return 0==t(Ae.find("input:checked")).parent().parent().length?t(this).hasClass("vis-tm-textli")?"disabled"==t(this).parent().parent().find("input").attr("disabled")?window.setTimeout((function(){}),200):(e=t(this).parent().parent(),i=t('<div style="background-color:lightblue;"/>').attr("id","draggingContainer")):t(this).hasClass("vis-tm-upperLi")&&(t(this).find("input").attr("disabled"),i=t('<div style="background-color:lightblue;"/>').attr("id","draggingContainer")):t(this).hasClass("vis-tm-textli")?(t(this).parent().parent().find("input").attr("disabled"),i=t('<div style="background-color:lightblue;"/>').attr("id","draggingContainer")):t(this).hasClass("vis-tm-upperLi")&&(t(this).find("input").attr("disabled"),i=t("<div/>").attr("id","draggingContainer")),"disabled"!=t(this).parent().parent().find("input").attr("disabled")&&null!=t(this).parent().parent().find("input").attr("disabled")&&i.append(e.clone()),(t(Ae.find("input:checked")).length>0||null==e.find("input").attr("disabled"))&&!e.hasClass("vis-tm-opacity")&&i.append(e.clone()),(o=i).css({width:"350px"}),o.css({"z-index":2}),o.find(".vis-tm-upperLi").length>5&&(o.css({"max-height":"250px",overflow:"auto"}),o.css({overflow:"hidden"})),yt=i,i},start:function(e,i){if(ze.css("display","inherit"),yt.find("li").length>0&&be.css("display","inherit"),!0,yt.find(".vis-tm-textli").hasClass("vis-tm-textli")&&(mt=!0),t(this).attr("id"),m=!1,_=!0,v=[],f=[],wt=!0,0==o.find(".vis-tm-upperLi").length){var n=o.find("li").attr("id");v.push(n)}else for(var a=o.find(".vis-tm-upperLi"),s=0;s<a.length;s++){n=t(a.find("li")[s]).attr("id"),v.push(n);var r=t(a[s]).find("i").data("imgsrc"),d=r.substr(r.lastIndexOf("/")+1);"mWindow.png"==d||"folder.png"==d?f.push("new"):f.push("update")}It(),bt(l),Dt()},drag:function(e,t){},stop:function(){v=[],mt=!1,ze.css("display","none"),be.css("display","none")}}),Wt(),ke.prop("disabled",!1),je.css("display","none"),ze.css("display","none"),ee.css("display","none"),w[0].style.visibility="hidden",/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase())&&t(Ae.find("li")).draggable("destroy")},error:function(e){console.log(e),je.css("display","none"),ze.css("display","none"),ke.prop("disabled",!1),ee.css("display","none"),I[0].style.visibility="hidden",w[0].style.visibility="hidden"}})}var mt=!1,yt=null;function It(e){We.droppable({drop:function(e,n){var a,s,l,o=!0;if(0==B&&(o=!1),t(n.draggable).hasClass("ui-dialog")&&(I[0].style.visibility="hidden",o=!1),ie.find("span").hasClass("k-state-hover")||ie.find("span").hasClass("k-state-selected")||(I[0].style.visibility="hidden",o=!1),_=!1,ie.find("span").hasClass("k-state-hover")?d=t(ie.find("li").find("span")).parent().find(".k-state-hover").parent().parent():ie.find("span").hasClass("k-state-selected")&&(d=t(ie.find("li").find("span")).parent().find(".k-state-selected").parent().parent()),ie.find("span").hasClass("k-state-hover")){var r=i.find(".k-state-hover").find(".treechild");L=r,a=r.attr("data-issummary"),s=r.attr("data-nodeid"),l=r.attr("data-parentid")}else if(ie.find("span").hasClass("k-state-selected")){var c=ie.find(".k-state-selected").find(".treechild");c.parent().css("border","none"),L=c,s=c.attr("data-nodeid"),a=c.attr("data-issummary"),l=c.attr("data-parentid")}"true"==a?(0==wt&&L.parent().hasClass("k-state-selected")&&(o=!1),o,1==o?(o,Ct(s,l,v,m,f)):0==o&&(_=!0,I[0].style.visibility="hidden")):"false"!=a||G.is(":checked")||(SummaryIDs=t(d.parent().parent().find(".treechild")[0]).attr("data-nodeid"),L=t(d.parent().parent().find(".treechild")[0]),Ct(SummaryIDs,l,v,m,f))}})}function Dt(e){ie.data("kendoTreeView").wrapper.find(".k-in").on({mouseenter:function(){1==mt&&(B=!0,t(this).hasClass("k-state-selected")&&t(this).css("border","2px solid #bac0cc"))},mouseleave:function(){1==mt&&t(this).hasClass("k-state-selected")&&t(this).css("border","none"),B=!1}})}var wt=!0;function bt(i){ye.parent().droppable({drop:function(i,n){var a=!0;if(0==_&&(a=!1),t(n.draggable).hasClass("ui-dialog")&&(I[0].style.visibility="hidden",a=!1),1==a&&!m)if(1==ie.find(".k-state-selected").length){var s=ie.find(".k-state-selected").find(".treechild");L=s;var l=s.attr("data-nodeid"),o=s.attr("data-issummary"),r=s.attr("data-parentid");"true"==o&&yt.find(".vis-tm-textli").hasClass("vis-tm-textli")&&(I[0].style.visibility="visible",Ct(l,r,v,m,f))}else yt.find(".vis-tm-textli").hasClass("vis-tm-textli")&&e.ADialog.info("SelectAnySummaryTreeNode");0==ie.find(".k-state-selected").length&&yt.find(".vis-tm-textli").hasClass("vis-tm-textli")&&e.ADialog.info("SelectAnySummaryTreeNode")},tolerance:"pointer"})}function Ct(i,n,a,l,r){var d=a.toString();""!=d&&(I[0].style.visibility="visible",Me.empty(),r=r.toString(),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/SaveDataOnDrop",type:"Post",data:{summaryid:i,nodid:n,treeID:s,dragMenuNodeID:d,checkMorRdragable:l,IsExistItem:r},success:function(n){var a=!0,s=JSON.parse(n);if(l)for(var r=0;r<o.find("li").find(".VIS-tm-MLi").length;r++)if(!ie.find("div").find("div[data-nodeid='"+i+"']").parent().hasClass("k-state-selected")||0!=wt){var d=t(o.find("li").find(".VIS-tm-MLi")[r]).attr("id");t(ye.find("li").find("li[data-id='"+d+"']").parent()).remove()}if(s==e.Msg.getMsg("VIS_DataSave")){var c=Ae.find(".vis-tm-menuselectedcolor");o.find("li .vis-tm-textli").attr("id");if(ie.find("div").find("div[data-nodeid='"+i+"']").parent().hasClass("k-state-selected"))for(var p=o.find("li li").length-1;p>=0;p--){d=o.find("li li").attr("id");if(0!=wt){ye.find("input:checked").length,ye.find("input").length;Ie.prop("checked",!1);var u=t(o.find("li li")[p]).attr("id"),g=t(o.find("li li")[p]).text();g=g.substring(0,g.lastIndexOf("("));var h=null;if("nonSummary.png"==(_=(_=t(o.find("li li")[p]).parent().parent().find("i").data("imgsrc")).substring(_.lastIndexOf("/")+1)))h="<i class='summNonsumImage vis vis-m-window'  data-imgsrc='Images/mWindow.png'></i>";else if("summary.png"==_)h="<i class='fa fa-folder-o summNonsumImage' data-imgsrc='Images/folder.png'></i>";else if("folder.png"==_){h="<i class='fa fa-folder-o summNonsumImage' data-imgsrc='Images/folder.png'></i>";continue}if("mWindow.png"==_&&(h="<i class='summNonsumImage vis vis-m-window' data-imgsrc='Images/mWindow.png'></i>"),""==oe.val()||!ce.is(":checked")||g.contains(oe.val())){var v=t('<input class="VIS-tm-checkbox" type="checkbox" />');ye.prepend(t('<li class="VIS-tm-topMLi">').append(v).append(h).append(t("<li class='VIS-tm-MLi' data-id='"+u+"'  id='"+u+"' style='cursor:default'  >"+e.Utility.encodeText(g)+"</li>")))}}}for(var f=0;f<o.find("li .vis-tm-textli").length;f++){var m=t(t(Ae.find("li"))).find("li[data-id='"+t(o.find(".vis-tm-textli")[f]).attr("data-id")+"']").parent().parent();m.find("input").prop("disabled","true"),m.find("input").prop("checked",!1),m.find("i").addClass("vis-tm-opacity"),m.find(".vis-tm-textli").addClass("vis-tm-opacity"),m.find("input").css("cursor","not-allowed"),m.find("span").hasClass("VIS-Tm-glyphiconglyphicon-link")||m.find("span").addClass("VIS-Tm-glyphiconglyphicon-link"),"Unlinked"==ke.val()&&m.remove();var y=t(t(Ae.find("li"))).find("li[data-id='"+t(o.find(".vis-tm-textli")[f]).attr("data-id")+"']").parent().parent().find("img").attr("src"),w=t(t(Ae.find("li"))).find("li[data-id='"+t(o.find(".vis-tm-textli")[f]).attr("data-id")+"']").parent().parent().find("img");null!=(_=y)&&("mWindow.png"==(_=_.substring(_.lastIndexOf("/")+1))?C=e.Application.contextUrl+"Areas/VIS/Images/nonSummary.png":"folder.png"==_&&(C=e.Application.contextUrl+"Areas/VIS/Images/summary.png"),w.attr("src",C)),a=!1}for(var b=0;b<Ae.find(".vis-tm-menuselectedcolor").length;b++)a=!1;if(0!=a&&1==o.find(".vis-tm-textli").length){var C,_;t(t(Ae.find("li"))).find("li[data-id='"+o.find(".vis-tm-textli").attr("data-id")+"']"),y=t(t(Ae.find("li"))).find("li[data-id='"+o.find(".vis-tm-textli").attr("data-id")+"']").parent().parent().find("img").attr("src"),w=t(t(Ae.find("li"))).find("li[data-id='"+o.find(".vis-tm-textli").attr("data-id")+"']").parent().parent().find("img");null!=(_=y)&&("mWindow.png"==(_=_.substring(_.lastIndexOf("/")+1))?C=e.Application.contextUrl+"Areas/VIS/Images/nonSummary.png":"folder.png"==_&&(C=e.Application.contextUrl+"Areas/VIS/Images/summary.png"),w.attr("src",C))}for(var S=[],x=0;x<o.find(".vis-tm-textli").length;x++){var A=null,T=null;if("checkSummary"==t(o.find(".vis-tm-textli")[x]).attr("checkSummary")?(A="true",T="Areas/VIS/Images/folder.png"):(A="false",T="Areas/VIS/Images/mWindow.png"),!G.is(":checked")||"false"!=A){G.is(":checked")&&"true"==A&&(Y.css("display","inherit"),X.css("display","none")),G.is(":checked")||(Y.css("display","inherit"),X.css("display","none"));var V=t(o.find(".vis-tm-textli")[x]).text();V=V.substring(0,V.lastIndexOf("("));var N=ie.data("kendoTreeView").append({text:e.Utility.encodeText(V),IsSummary:A,getparentnode:L.attr("data-nodeid"),TableName:L.attr("data-tablename"),NodeID:t(o.find(".vis-tm-textli")[x]).attr("id"),TreeParentID:L.attr("data-nodeid"),ParentID:L.attr("data-nodeid"),ImageSource:T},L);S.push(N)}}var M=L.parent().parent().parent();if(S&&S.length>0)for(var k=S.length-1;k>=0;k--)ot(M);c.removeClass("vis-tm-menuselectedcolor"),ye.find("li").length>0&&(me.css("display","none"),D[0].style.visibility="hidden")}vt(),di(),window.setTimeout((function(){""!=oe.val()&&Ei(Ri)}),200),Et(),Ke=!0,I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}}))}var _t=!1,St=!1;function xt(){var i,n,a;J.on("change",zi),G.on("click",$i),xe.on("scroll",Ji),Ae.on("click",ji),ye.on("click",Ui),oe.on("keyup",Ei),oe.on("keypress",Ci),re.on("click",Ni),oe.on("input",(function(e){""==this.value&&(ie.find("span").removeClass("VIS-TM-highlight"),V=1,N=50,T=oe.val(),_t=ce.is(":checked")?"true":"false",dt(ie.find(".k-state-selected").find(".treechild").attr("data-nodeid"),s,V,N,T,_t,e))})),Te.on("input",(function(e){""==this.value&&""!=J.val()&&(Ae.empty(),window.setTimeout((function(){Ae.empty(),A="",R=ke.val(),h=1,ft(s,0,A,R)}),200))})),K.on("click",wi),$.on("click",bi),Ve.on("click",Ii),Te.on("keyup",Di),te.on("resize",pi),te.find(".ui-resizable-e").css("right","0px"),te.find(".ui-resizable-s").css("bottom","0px"),i=""+e.Msg.getMsg("All"),n=""+e.Msg.getMsg("Linked"),a=""+e.Msg.getMsg("UnLinked"),ke.append(t("<Option value='All'>"+i+"</option>")),ke.append(t("<Option value='Linked'>"+n+"</option>")),ke.append(t("<Option value='Unlinked'>"+a+"</option>")),he.on("click",oi),ke.on("change",ci),ae.mouseover((function(e){ae.addClass("selectchangecolor"),ae.css("background-color","#ff0000")})),ae.mouseleave((function(){ae.removeClass("selectchangecolor"),ae.css("background-color","#FFC0CB")})),fe.on("scroll",si),window.setTimeout((function(){}),200),ce.is(":checked")&&(Ai=-1),ce.on("click",(function(e){_t=ce.is(":checked")?"true":"false",Ei(e)})),Ie.on("click",ai),Y.on("click",ni),X.on("click",ii),we.on("click",$t),Ee.on("click",Wt),ue.on("click",Bt),qe.on("click",Ft),Z.on("click",Ut),be.mouseover((function(e){be.css({cursor:"not-allowed"})})),be.mouseleave((function(){be.css({cursor:"default"})})),Pe.on("click",Rt),Le.on("click",kt)}var At=[],Tt="true",Vt=null,Nt=null;function Mt(t){gt();var i=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetSeqNo",{treeId:s,tblName:ut,nodeId:"-1"},null);i+=1,e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/UpdateSeqNo",{treeId:s,tblName:ut,seqNo:i,nodeId:t,bySeqNo:!1,isParant:!0},null)}function kt(e){}function Ot(i){if(""!=J.val()){if(t(this).find("span").hasClass("vis-tm-delete"))return;e.ADialog.confirm("RemoveUnlinkedItem",!0,"","Confirm",(function(i){if(i){I[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"TreeMaintenance/RemoveLinkedItemFromTree",type:"Post",data:{treeID:s,menuId:At},success:function(t){var i=JSON.parse(t);"count"==i?(Ae.empty(),A=Te.val(),R=ke.val(),h=1,ft(s,0,A,R),window.setTimeout((function(){bi(),window.setTimeout((function(){Ke=!1,I[0].style.visibility="hidden"}),200)}),200)):"menubind"==i&&(I[0].style.visibility="hidden",e.ADialog.info("NeverDelete",!0,Nt))},error:function(e){console.log(e),I[0].style.visibility="hidden"}}),Y.css("display","none"),X.css("display","inherit");var n=J.find("option:selected").text();ve.text(n),Ke=!1}}))}}var Lt=null;function Rt(){if(""!=J.val()){t('<ul class="vis-apanel-tm-ul"></ul>');var i=t("<div>"),n=t('<div style="padding:0 10px;min-width:150px">'),a=t('<span class="VIS-Tm-glyphiconglyphicon-link VIS-Tm-unlinkforbottmo vis vis-link"></span>');Lt=t('<p style="line-height:19px;cursor:pointer;">'+e.Msg.getMsg("RemoveLinkedItem")+"</p>").append(a),i.append(n),n.append(t('<div style="margin-top: 10px;" ></div>').append(Le).append(Re)),n.append(t('<div style="float: left;margin-bottom: 6px;margin-top: 5px;width:100%" ></div>').append(Lt)),t(this).w2overlay(i),1==Ke?a.removeClass("vis-tm-delete"):a.addClass("vis-tm-delete"),Lt.on("click",Ot)}}function Et(e){ie.find("span").hasClass("k-state-selected")&&(fe.find("ul").height()<fe.height()&&(V=1,N=50,T=ce.is(":checked")?oe.val():"",_t=ce.is(":checked")?"true":"false",C=!1,dt(ie.find(".k-state-selected").find(".treechild").attr("data-nodeid"),s,V,N,T,_t,e)))}function Pt(){Ee.prop("checked",!1)}function Ut(){var t=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetWindowtId",{},null),i=new e.Query;i.addRestriction("AD_Tree_ID",e.Query.prototype.EQUAL,s),e.viewManager.startWindow(t,i)}function Ft(){qe.css("display","none"),Te.val(""),""!=J.val()&&(Ae.empty(),window.setTimeout((function(){Ae.empty(),A="",R=ke.val(),h=1,ft(s,0,A,R)}),200))}function Bt(e){oe.val(""),oe.focus(),ue.css("display","none"),ie.find("span").removeClass("VIS-TM-highlight"),V=1,N=50,T=oe.val(),_t=ce.is(":checked")?"true":"false",C=!0;var t=ie.find(".k-state-selected").find(".treechild").attr("data-nodeid");""!=J.val()&&dt(t,s,V,N,T,_t,e)}function Wt(e){if(Oi=e,Ee.is(":checked")){w[0].style.visibility="visible",E=!1;for(var i=0;i<Ae.find("input").length;i++)"disabled"==t(Ae.find("input")[i]).attr("disabled")&&t(Ae.find("input")[i]).parent().parent().removeClass("vis-tm-menuselectedcolor"),"disabled"!=t(Ae.find("input")[i]).attr("disabled")&&(t(Ae.find("input")[i]).prop("checked",!0),t(Ae.find("input")[i]).parent().parent().addClass("vis-tm-menuselectedcolor"));w[0].style.visibility="hidden"}else 0==E&&(w[0].style.visibility="visible",Ae.find("input").prop("checked",!1),Ae.find(".vis-tm-menuselectedcolor").removeClass("vis-tm-menuselectedcolor"),w[0].style.visibility="hidden")}function jt(e){t(e.target).hasClass("VIS-tm-MLi")&&(t(this).find("li").removeClass("vis-tm-menuselectedcolor"),t(this).find("li").find("input").prop("checked",!1),t(e.target).parent().addClass("vis-tm-menuselectedcolor"),t(e.target).parent().find("input").prop("checked",!0),Ie.prop("checked",!1)),t(e.target).hasClass(" summNonsumImage ")&&(t(this).find("li").removeClass("vis-tm-menuselectedcolor"),t(this).find("li").find("input").prop("checked",!1),t(e.target).parent().addClass("vis-tm-menuselectedcolor"),t(e.target).parent().find("input").prop("checked",!0),Ie.prop("checked",!1)),t(e.target).hasClass("VIS-tm-checkbox")&&(t(e.target).parent().find("input").prop("checked")?t(e.target).parent().addClass("vis-tm-menuselectedcolor"):(t(e.target).parent().removeClass("vis-tm-menuselectedcolor"),t(e.target).parent().find("li").removeClass("vis-tm-menuselectedcolor"),Ie.prop("checked",!1)))}var Gt=!0;function qt(e){T="";var i=t(e.currentTarget);i[0].scrollHeight-i.scrollTop()==i.outerHeight()&&(Gt=!1,Ht+=1,I[0].style.visibility="visible",Zt(y,s,Ht,zt,T,_t,e))}var Ht=1,zt=50,Qt=!1,Jt=0;function $t(i,n){if(I[0].style.visibility="visible",""!=J.val()&&(oe.prop("disabled",!1),re.prop("disabled",!1)),P=!1,0==rt)return P=!0,we.addClass("vis-tm-delete"),void(I[0].style.visibility="hidden");if(0==ie.find(".k-state-selected").length)return I[0].style.visibility="hidden",void(P=!0);if(""==J.val())return I[0].style.visibility="hidden",void(P=!0);Yt.append(Xt.append(Kt)),Gt=!0,Ht=1,zt=50,T="",_t="false";var a=ie.find(".k-state-selected").find(".treechild").attr("data-nodeid");I[0].style.visibility="visible",window.setTimeout((function(){Zt(a,s,Ht,zt,T,_t,i)}),200),Kt.on("click",jt),Xt.on("scroll",qt);var l=new e.ChildDialog;l.setHeight(550),l.setWidth(450),l.setEnableResize(!1),l.setTitle(e.Msg.getMsg("SetOrder")),l.setModal(!0),l.setContent(Yt),Kt.empty(),l.show(),l.onClose=function(){Qt=!0},l.onOkClick=function(i){if(0==ti){ti=!0,Qt=!0,D[0].style.visibility="visible";var n=ie.find(".k-state-selected").find(".treechild").attr("data-nodeid");Jt=n;for(var a,l=ie.find(".k-state-selected").find(".treechild").attr("data-nodeid"),o=[],r=0;r<Kt.find("li li").length;r++){var d=t(Kt.find("li li")[r]).attr("data-id");o.push(d)}a=o.toString(),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/UpdateItemSeqNo",type:"Post",data:{treeID:s,itemsid:a,ParentID:l},success:function(e){JSON.parse(e);bi(),ye.empty(),V=1,N=50,T=ce.is(":checked")?oe.val():"",_t=ce.is(":checked")?"true":"false",C=!0,dt(l,s,V,N,T,_t,i),Y.css("display","inherit"),X.css("display","none")},error:function(e){console.log(e),D[0].style.visibility="hidden"}})}T=ce.is(":checked")?oe.val():"",_t=ce.is(":checked")?"true":"false",P=!0},l.onCancelClick=function(){I[0].style.visibility="hidden",T=ce.is(":checked")?oe.val():"",_t=ce.is(":checked")?"true":"false",ti=!0,P=!0,Qt=!1}}var Kt=t("<ul style='padding:0;list-style: none'>"),Yt=t("<div>"),Xt=t('<div style="padding: 10px;height:425px;overflow:auto">');function Zt(i,n,a,s,l,o,r){null==l&&(l=""),1==Gt&&Kt.empty(),It(),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/FillSequenceDailog",type:"Post",data:{nodeID:i,treeID:n,pageNo:a,pageLength:s,searchChildNode:l,getTreeNodeChkValue:o},success:function(i){I[0].style.visibility="visible";var n,a=JSON.parse(i),s=null,l=null;if(a.length>0)for(var o=0;o<a.length;o++){if(0==C&&Kt.find("li li").length>0){var r=Kt.find('[data-id="'+a[o].parentID+'"]');if(r&&r.length>0)continue}if(0!=a[o].parentID){var d=t('<input class="VIS-tm-checkbox" type="checkbox" />');if("Y"==a[o].issummary)s="<i class='fa fa-folder-o summNonsumImage' data-imgsrc='Images/folder.png'></i>",Kt.append(t('<li class="VIS-tm-topMLi">').append(d).append(s).append(t("<li class='VIS-tm-MLi' data-NodePID='"+a[o].NodeParentID+"' data-id='"+a[o].parentID+"' data-issummary='"+a[o].issummary+"' id='"+a[o].parentID+"'   >"+e.Utility.encodeText(a[o].name)+"</li>")));else{l="<i class='vis vis-m-window summNonsumImage' data-imgsrc='Images/mWindow.png'></i>";var c=t('<li class="VIS-tm-topMLi" >');c.append(d),c.append(l),c.append(t("<li class='VIS-tm-MLi'  data-NodePID='"+a[o].NodeParentID+"'  data-id='"+a[o].parentID+"' data-issummary='"+a[o].issummary+"' id='"+a[o].parentID+"'   >"+e.Utility.encodeText(a[o].name)+"</li>")),Kt.append(c)}}}n=null,Kt.sortable({cursorAt:{left:-10,top:-10},helper:function(e,i){n=t("<li />"),i.hasClass("vis-tm-menuselectedcolor")||i.addClass("vis-tm-menuselectedcolor").siblings().removeClass("vis-tm-menuselectedcolor");var a=i.parent().children(".vis-tm-menuselectedcolor").clone();return ei=i.data("multidrag",a).siblings(".vis-tm-menuselectedcolor"),i.data("multidrag",a).siblings(".vis-tm-menuselectedcolor").hide(),n.append(a),n.append(a)},start:function(e,i){ti=!1,Kt.find("input").prop("checked",!1),ct=i.item.find("li").attr("id"),t(this).parent().parent().parent().css("overflow","hidden")},change:function(e,t){},update:function(e,t){},stop:function(e,t){t.item.after(t.item.data("multidrag")).remove(),window.setTimeout((function(){ei.remove()}),100),Kt.find("input").prop("checked",!1),Kt.find(".vis-tm-menuselectedcolor").find("input").prop("checked",!0)}}),Kt.sortable("refresh"),window.setTimeout((function(){I[0].style.visibility="hidden"}),500)},error:function(e){console.log(e),Kt.empty(),I[0].style.visibility="hidden"}})}var ei=null,ti=!0;function ii(){""!=J.val()&&ie.find("li").length>1&&(b[0].style.visibility="visible",window.setTimeout((function(){X.css("display","none"),Y.css("display","inherit"),Y.css("float","right"),i.data("kendoTreeView").expand(".k-item"),b[0].style.visibility="hidden"}),150))}function ni(){""!=J.val()&&(b[0].style.visibility="visible",window.setTimeout((function(){X.css("display","inherit"),Y.css("display","none"),X.css("float","right"),i.data("kendoTreeView").collapse(".k-item"),b[0].style.visibility="hidden"}),150))}function ai(){Ie.is(":checked")?(ye.find("input").prop("checked",!0),ye.find("li").addClass("vis-tm-menuselectedcolor"),he.removeClass("vis-tm-delete"),0==ye.find("input:checked").length&&he.addClass("vis-tm-delete")):(ye.find("input").prop("checked",!1),ye.find("li").removeClass("vis-tm-menuselectedcolor"),he.addClass("vis-tm-delete"))}function si(e){T=oe.val();var i=t(e.currentTarget);i[0].scrollHeight,i.scrollTop(),i.outerHeight(),i[0].scrollHeight-i.scrollTop()-10==i.outerHeight()-10&&ye.find("li").length>0&&(V+=1,C=!1,D[0].style.visibility="visible",dt(y,s,V,N,T,_t,e),D[0].style.visibility="hidden",ye.find("li").length>0&&(me.css("display","none"),D[0].style.visibility="hidden"))}var li=[];function oi(){li=[],ye.find("input:checked").length>0&&e.ADialog.confirm("DoYouWantToUnlink",!0,"","Confirm",(function(i){i?(I[0].style.visibility="visible",window.setTimeout((function(){for(var i=[],n=0;n<ye.find("input:checked").length;n++){var a=t(ye.find("input:checked")[n]).parent().find("li").attr("data-id");"false"==Tt&&t.inArray(parseInt(a),Vt)>=0||(li.push(a),i.push(parseInt(a)))}bottomchildselectedID=li,(li=li.toString()).length>0?ri(s,li):(e.ADialog.info("NeverDelete",!0,Nt),I[0].style.visibility="hidden")}),200)):I[0].style.visibility="hidden"})),I[0].style.visibility="hidden"}function ri(i,n){I[0].style.visibility="visible";e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTableID",{treeId:i},null);treeType=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTreeType",{treeId:i},null);var a="";a="PR"==treeType?"AD_TreeNodePR":"BP"==treeType?"AD_TreeNodeBP":"MM"==treeType?"AD_TreeNodeMM":"AD_TreeNode",yi=[];ye.find("input:checked").length>0&&mi(a,n=n.toString(),i),0==ye.find("input:checked").length&&mi(a,n,i),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/DeleteNodeFromBottom",type:"Post",data:{nodeid:n,treeID:i,menuArray:At},success:function(i){if(""==JSON.parse(i)){Ie.prop("checked",!1);for(var a=!0,s=0;s<ye.find("input:checked").length;s++){if(a=!1,"false"==Tt){var l=t(ye.find("input:checked").parent().find("li")[s]).attr("data-id");if(t.inArray(parseInt(l),Vt)>=0)continue}var o=n.toString();o=o.split(","),(u=Ae.find("li").find("li[data-id='"+o[s]+"']").parent().parent()).find("input").prop("disabled",!1),u.find("i").removeClass("vis-tm-opacity"),u.find(".vis-tm-textli").removeClass("vis-tm-opacity"),u.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),u.find("input").css("cursor","pointer"),u.hasClass("vis-tm-menuselectedcolor")&&(Me.empty(),u.find("input").prop("checked",!0)),"Linked"==ke.val()&&u.remove();var r=t(ye.find("input:checked").parent().find(".VIS-tm-MLi")[s]).attr("data-id"),d=t(t(Ae.find("li"))).find("li[data-id='"+r+"']").parent().parent().find("img").attr("src"),c=t(t(Ae.find("li"))).find("li[data-id='"+r+"']").parent().parent().find("img");if(null!=(v=d))if("nonSummary.png"==(v=v.substring(v.lastIndexOf("/")+1)))h=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png",c.attr("src",h);else if("summary.png"==v){h=e.Application.contextUrl+"Areas/VIS/Images/folder.png",c.attr("src",h),Gi(r),ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+bottomchildselectedID[s]+"']").parent().parent().parent());for(s=0;s<yi.length;s++){var p=yi[s];ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+p+"']").parent().parent().parent()),t(ye.find("input:checked")[s]).parent().remove(),(g=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent()).find("input").prop("disabled",!1),g.removeClass("vis-tm-menuselectedcolor"),g.find("i").removeClass("vis-tm-opacity"),g.find(".vis-tm-textli").removeClass("vis-tm-opacity"),g.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),g.find("input").css("cursor","pointer");d=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent().find("img").attr("src"),c=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent().find("img");null!=(v=d)&&("nonSummary.png"==(v=v.substring(v.lastIndexOf("/")+1))?h=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==v?h=e.Application.contextUrl+"Areas/VIS/Images/folder.png":"mWindow.png"==v?h=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"folder.png"==v&&(h=e.Application.contextUrl+"Areas/VIS/Images/folder.png")),c.attr("src",h)}}}if(1==a&&0==ye.find("input:checked").length){var u;(u=Ae.find("li").find("li[data-id='"+yi+"']").parent().parent()).find("input").prop("disabled",!1),u.find("i").removeClass("vis-tm-opacity"),u.find(".vis-tm-textli").removeClass("vis-tm-opacity"),u.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),u.find("input").css("cursor","pointer"),u.hasClass("vis-tm-menuselectedcolor")&&(Me.empty(),u.find("input").prop("checked",!0)),"Linked"==ke.val()&&u.remove();d=t(t(Ae.find("li"))).find("li[data-id='"+yi+"']").parent().parent().find("img").attr("src"),c=t(t(Ae.find("li"))).find("li[data-id='"+yi+"']").parent().parent().find("img");if(null!=(v=d))if("nonSummary.png"==(v=v.substring(v.lastIndexOf("/")+1)))h=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png",c.attr("src",h);else if("summary.png"==v){h=e.Application.contextUrl+"Areas/VIS/Images/folder.png",c.attr("src",h),Gi(yi),ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+yi+"']").parent().parent().parent());for(s=0;s<yi.length;s++){var g;p=yi[s];ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+p+"']").parent().parent().parent()),t(ye.find("input:checked")[s]).parent().remove(),(g=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent()).find("input").prop("disabled",!1),g.removeClass("vis-tm-menuselectedcolor"),g.find("i").removeClass("vis-tm-opacity"),g.find(".vis-tm-textli").removeClass("vis-tm-opacity"),g.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),g.find("input").css("cursor","pointer");var h,v;d=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent().find("img").attr("src"),c=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent().find("img");null!=(v=d)&&("nonSummary.png"==(v=v.substring(v.lastIndexOf("/")+1))?h=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==v?h=e.Application.contextUrl+"Areas/VIS/Images/folder.png":"mWindow.png"==v?h=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"folder.png"==v&&(h=e.Application.contextUrl+"Areas/VIS/Images/folder.png")),c.attr("src",h)}}ye.find("li").find("li[data-id='"+yi+"']").parent().remove(),ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+yi+"']").parent().parent().parent())}he.addClass("vis-tm-delete");for(var f=[],m=0;m<ye.find("input:checked").length;m++){l=t(ye.find("input:checked").parent().find("li")[m]).attr("data-id");"false"==Tt&&t.inArray(parseInt(l),Vt)>=0||f.push(l)}for(var y=0;y<f.length;y++)ye.find("li").find("li[data-id='"+f[y]+"']").parent().remove();ye.find("input:checked").length>0&&e.ADialog.info("NeverDelete"),Et()}di(),Pt(),$e(),I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}}),di()}function di(){0==ye.find("input").length?(Ie.prop("disabled",!0),Ie.css("cursor","not-allowed"),Ie.prop("checked",!1),he.addClass("vis-tm-delete"),we.addClass("vis-tm-delete"),rt=!1):(we.removeClass("vis-tm-delete"),rt=!0,Ie.prop("disabled",!1),Ie.css("cursor","pointer"))}function ci(){""!=J.val()&&(Me.empty(),Ae.empty(),R=ke.val(),window.setTimeout((function(){ke.prop("disabled",!0),ee.css("display","inherit"),Qi=!1,R=ke.val(),A=Te.val(),h=1,ft(s,0,A,R)}),200))}function pi(e,t){var i=t.size.height;te.css("height",i),te.css("overflow-x","none"),te.css("width","100%"),window.setTimeout((function(){fe.height(We.height()-(te.height()+ge.height()+45))}),200),Fe.css("overflow","hidden"),Fe.height(We.height()-te.height()),Ue.height(Fe.height()-10),ne.height(i-10),te.addClass("VIS-TM-resizediv"),ne.addClass("VIS-TM-resizediv")}var ui=null;function gi(){ui=t("<div>"),t('<input style="margin-right: 10px;" type="checkbox"/>');t("<span>"+e.Msg.getMsg("WantToUnlinked")+"<span/>");var i=t('<span style="font-size: 16px;">'+e.Msg.getMsg("UnlinkedWithChild")+"<span/>");ui.append(t('<div style="padding: 10px;">').append(i))}function hi(i,n,a,s){if(0!=n){!1,I[0].style.visibility="visible";e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTableID",{treeId:i},null);treeType=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTreeType",{treeId:i},null);var l="";l="PR"==treeType?"AD_TreeNodePR":"BP"==treeType?"AD_TreeNodeBP":"MM"==treeType?"AD_TreeNodeMM":"AD_TreeNode",li=n.toString(),mi(l,li,i);var o=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetParentId",{treeId:i,nodeId:delNodeId,tblName:l},null);t.ajax({url:e.Application.contextUrl+"TreeMaintenance/DeleteNodeFromTree",type:"Post",data:{nodeid:n,treeID:i,unlinkchild:s,menuArray:At},success:function(i){var a=JSON.parse(i);if(""==a){0==ye.find("input:checked").length&&Ie.prop("checked",!1),a,ye.find("li").find("li[data-id='"+n+"']").parent().remove(),(u=Ae.find("li").find("li[data-id='"+n+"']").parent().parent()).find("input").prop("disabled",!1),u.find("i").removeClass("vis-tm-opacity"),u.find(".vis-tm-textli").removeClass("vis-tm-opacity"),u.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),u.find("input").css("cursor","pointer"),u.hasClass("vis-tm-menuselectedcolor")&&(Me.empty(),u.find("input").prop("checked",!0));var r=t(t(Ae.find("li"))).find("li[data-id='"+n+"']").parent().parent().find("img").attr("src"),d=t(t(Ae.find("li"))).find("li[data-id='"+n+"']").parent().parent().find("img");if(null!=(h=r)&&("nonSummary.png"==(h=h.substring(h.lastIndexOf("/")+1))?g=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==h&&(g=e.Application.contextUrl+"Areas/VIS/Images/folder.png"),d.attr("src",g)),l,1==s){"false"==Tt&&vi(),ie.data("kendoTreeView").remove(tt);for(var c=0;c<yi.length;c++){var p=yi[c];if(ye.find("li").find("li[data-id='"+p+"']").parent().remove(),!("false"==Tt&&t.inArray(parseInt(p),Vt)>=0)){var u;(u=Ae.find("li").find("li[data-id='"+p+"']").parent().parent()).find("input").prop("disabled",!1),u.find("i").removeClass("vis-tm-opacity"),u.find(".vis-tm-textli").removeClass("vis-tm-opacity"),u.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),u.find("input").css("cursor","pointer"),u.hasClass("vis-tm-menuselectedcolor")&&(u.find("input").prop("checked",!0),Me.empty()),"Linked"==ke.val()&&u.remove();var g,h;r=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent().find("img").attr("src"),d=t(t(Ae.find("li"))).find("li[data-id='"+p+"']").parent().parent().find("img");null!=(h=r)&&("nonSummary.png"==(h=h.substring(h.lastIndexOf("/")+1))?g=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==h&&(g=e.Application.contextUrl+"Areas/VIS/Images/folder.png"),d.attr("src",g))}}}if(0==s){var v=o;L=ie.find("div").find("div[data-nodeid='"+v+"']")}Et()}S.find("span").hasClass("k-state-selected")&&ve.text(e.Msg.getMsg("SelectTree")),di(),Pt(),$e(),I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}})}else e.ADialog.info("VIS_SelectTreeNode")}function vi(){for(var i=[],n=0;n<fi.length;n++){var a=fi[n];i.push(parseInt(a))}for(var s=0;s<i.length;s++)if(t.inArray(i[s],Vt)>=0){Mt(i[s]);var l=ie.find("div").find("div[data-nodeid='"+i[s]+"']").parent().parent().parent();if(ie.find("div").find("div[data-nodeid='"+i[s]+"']").parent().parent().parent().remove(),!G.is(":checked"))ie.data("kendoTreeView").append({text:e.Utility.encodeText(l.text()),IsSummary:l.find(".treechild").attr("data-issummary"),getparentnode:0,TableName:l.find(".treechild").attr("data-tablename"),NodeID:l.find(".treechild").attr("data-nodeid"),TreeParentID:l.find(".treechild").attr("data-nodeid"),ParentID:0,ImageSource:"Areas/VIS/Images/mWindow.png"},t(t(ie.find(".treechild")[0])))}""!=oe.val()&&window.setTimeout((function(){Ei(Ri)}),200)}var fi="";function mi(i,n,a){I[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"TreeMaintenance/SelectAllChildNodes",type:"Post",async:!1,data:{TableName:i,treeID:a,nodeID:n},success:function(e){I[0].style.visibility="visible";var t=JSON.parse(e);yi=[],null!=t&&(yi=t.split(","),fi=yi)},error:function(e){console.log(e),I[0].style.visibility="hidden"}})}var yi=[];function Ii(){""!=J.val()&&(Ae.empty(),A=Te.val(),R=ke.val(),h=1,ft(s,0,A,R))}function Di(e){13!=e.which&&8!=e.which&&46!=e.which&&qe.css("display","inherit"),8!=e.which&&46!=e.which||""==Te.val()&&qe.css("display","none"),13==e.which&&""!=J.val()&&(Ae.empty(),A=Te.val(),R=ke.val(),h=1,ft(s,0,A,R))}function wi(t){""!=J.val()&&ee.css("display","inherit"),Oi=t,J.empty(),Qe(),Qt=!1,bi(),we.addClass("vis-tm-delete"),Y.css("display","none"),X.css("display","inherit"),X.css("float","right"),ve.text(e.Msg.getMsg("SelectTree")),di()}function bi(){ye.empty(),!1,""!=J.val()&&(G.is(":checked")?(u=!0,null!=n&&Ye(a,s,l,u)):(u=!1,null!=n&&Ye(a,s,l,u))),Fe.css("overflow","hidden")}function Ci(e){if(St=!0,13==e.which){if(""!=oe.val()&&G.is(":checked")&&(oe.prop("disabled",!0),re.prop("disabled",!0)),"true"==_t&&1==ie.find(".k-state-selected").length){V=1,N=50,_t=ce.is(":checked")?"true":"false";var n=ie.find(".k-state-selected").find("div").attr("data-nodeid");T=oe.val(),ye.empty(),dt(n,s,V,N,T,_t,e)}""!=oe.val()&&""!=J.val()&&(he.removeClass("vis-tm-delete"),I[0].style.visibility="visible",i.find("span.k-in").find(".treechild").find("p").each((function(n){if(t(this).text().toUpperCase()==oe.val().toUpperCase()){e.preventDefault();var a=t(this).parent().parent().parent().parent().parent().attr("class");return i.data("kendoTreeView").expand("."+a),i.find("span").removeClass("k-state-selected"),t(this).parent().parent().parent().addClass("k-state-selected"),this.parentNode.parentNode.parentNode.scrollIntoView(),void(I[0].style.visibility="hidden")}})),Ti(e),he.addClass("vis-tm-delete"),I[0].style.visibility="hidden")}else Ai=-1}var _i,Si,xi,Ai=-1;function Ti(e){if(G.is(":checked")&&(oe.prop("disabled",!0),re.prop("disabled",!0)),_i=Mi,Si=oe.val(),(xi=Vi(_i,Si,Ai))>-1){var i=ki[xi];currentNode=i,Ai=xi,function(e,i){if(-1!=e)return currentNode=e,function(e,i,n){ce.is(":checked")?(ye.find(".vis-tm-menuselectedcolor").removeClass("vis-tm-menuselectedcolor"),fe.find("li").find("li[id='"+e+"']").parent().find("input").prop("checked",!0),fe.find("li").find("li[id='"+e+"']").parent().addClass("vis-tm-menuselectedcolor"),fe.find("li").find("li[id='"+e+"']").parent().hasClass("vis-tm-menuselectedcolor")&&(fe.find("li").find("li[id='"+e+"']").parent()[0].scrollIntoView(),fe.height(Fe.height()-(ge.height()+50)))):1==St&&(ie.find(".k-state-selected").removeClass("k-state-selected"),t(ie.find("div").find("div[data-nodeid='"+e+"']").parent()).addClass("k-state-selected"),t(ie.find("div").find("div[data-nodeid='"+e+"']").parent()).hasClass("k-state-selected")&&(t(ie.find("div").find("div[data-nodeid='"+e+"']").parent()).addClass("k-state-selected")[0].scrollIntoView(),Pi()),window.setTimeout((function(){V=1,N=50,T=ce.is(":checked")?oe.val():"",_t=ce.is(":checked")?"true":"false";var t=ie.find("div").find("div[data-nodeid='"+e+"']").parent().text();ve.text(t),ye.empty(),dt(e,s,V,N,T,_t,n)}),400))}(e,0,i);currentNode=0}(i,e)}else!1,""!=oe.val()&&(oe.prop("disabled",!1),re.prop("disabled",!1))}function Vi(e,t,i){for(var n=i+1;n<e.length;n++)if(-1!=n&&e[n].trim().toLowerCase().contains(t.trim().toLowerCase()))return n;return i>-1?Vi(e,t,i=-1):-1}function Ni(e){if(""!=oe.val()&&(oe.prop("disabled",!0),re.prop("disabled",!0)),"true"==_t&&1==ie.find(".k-state-selected").length){V=1,N=50,_t=ce.is(":checked")?"true":"false";var n=ie.find(".k-state-selected").find("div").attr("data-nodeid");T=oe.val(),ye.empty(),dt(n,s,V,N,T,_t,e)}""!=oe.val()&&(I[0].style.visibility="visible",i.find("span.k-in").find(".treechild").find("p").each((function(n){if(t(this).text().toUpperCase()==oe.val().toUpperCase()){e.preventDefault();var a=t(this).parent().parent().parent().parent().parent().attr("class");i.data("kendoTreeView").expand("."+a),i.find("span").removeClass("k-state-selected"),t(this).parent().parent().parent().addClass("k-state-selected"),this.parentNode.parentNode.parentNode.scrollIntoView()}})),Ti(e),I[0].style.visibility="hidden")}var Mi=[],ki=[],Oi=null,Li=!0,Ri=null;function Ei(n){if(""!=J.val()&&(ue.css("display","inherit"),1==Li&&(Li=!1,Ri=n)),""==J.val())return!1;if(""==t(oe).val()||!Xe)return""==t(oe).val()&&(ye.find("span").removeClass("VIS-TM-highlight"),ie.find("span").removeClass("VIS-TM-highlight"),ue.css("display","none"),St=!0,Li=!0),void(Xe=!0);if(null!=n&&13!=n.which){var a=(s=oe.val().toUpperCase()).length;if(ce.is(":checked"))Ai=-1,ki=[],Mi=[],ie.find("span").removeClass("VIS-TM-highlight"),ye.find("li li").each((function(i,n){var l=t(n),o=e.Utility.decodeText(t(this).text());ki.push(l.attr("id")),Mi.push(o);var r=0;if(""==s)0==o.toUpperCase().indexOf(s,r)&&(t(this).find("span").removeClass("VIS-TM-highlight"),ye.find(".vis-tm-menuselectedcolor").removeClass("vis-tm-menuselectedcolor"),he.addClass("vis-tm-delete"),ye.find("input").prop("checked",!1));else{for(;(p=o.toUpperCase().indexOf(s,r))>=0;)o.substring(r,p)+'<span class="VIS-TM-highlight">'+o.substr(p,a)+"</span>",r=p+a;-1==o.toUpperCase().indexOf(s,r)&&t(this).find("span").removeClass("VIS-TM-highlight"),r>0&&o.substring(r)}}));else{if(ki=[],Mi=[],ye.find("li").find("span").removeClass("VIS-TM-highlight"),i.data("kendoTreeView").expand(".k-item"),X.css("display","none"),Y.css("display","inherit"),""==t(oe).val()&&i.find("span").removeClass("VIS-TM-highlight"),t("span.k-in > span.highlight").each((function(){t(this).parent().text(t(this).parent().text())})),""==t.trim(oe.val()))return;var s;a=(s=oe.val().toUpperCase()).length;i.find("span.k-in").each((function(i,n){var l=t(n),o=e.Utility.decodeText(t(this).text());ki.push(l.find(".treechild").attr("data-nodeid")),Mi.push(o);for(var r="",d=0;(p=o.toUpperCase().indexOf(s,d))>=0;)r+=o.substring(d,p)+'<span class="VIS-TM-highlight">'+o.substr(p,a)+"</span>",d=p+a;-1==o.toUpperCase().indexOf(s,d)&&t(this).find("span").removeClass("VIS-TM-highlight"),d>0&&(r+=o.substring(d),t(this).find("p").html(r))}))}}}function Pi(){ie.find(".k-state-hover").removeClass("k-state-hover"),ie.find(".vis-tm-selectedkendoNode").removeClass("vis-tm-selectedkendoNode"),ie.find(".k-state-selected").find("p").addClass("vis-tm-selectedkendoNode")}function Ui(e){t(e.target).hasClass("summNonsumImage")&&(t(e.target).parent().parent().find("li").removeClass("vis-tm-menuselectedcolor"),t(e.target).parent().parent().find("input").prop("checked",!1),t(e.target).parent().addClass("vis-tm-menuselectedcolor"),t(e.target).parent().find("input").prop("checked",!0),he.removeClass("vis-tm-delete"),ye.find("input").length==ye.find("input:checked").length&&Ie.prop("checked",!0));t(e.target).hasClass("VIS-tm-MLi")&&(t(this).find("li").removeClass("vis-tm-menuselectedcolor"),t(this).find("li").find("input").prop("checked",!1),t(e.target).parent().addClass("vis-tm-menuselectedcolor"),t(e.target).parent().find("input").prop("checked",!0),he.removeClass("vis-tm-delete"),Ie.prop("checked",!1),ye.find("input").length==ye.find("input:checked").length&&Ie.prop("checked",!0));t(e.target).hasClass("VIS-tm-checkbox")&&(t(e.target).parent().find("input").prop("checked")?(t(e.target).parent().addClass("vis-tm-menuselectedcolor"),he.removeClass("vis-tm-delete"),ye.find("input").length==ye.find("input:checked").length&&Ie.prop("checked",!0)):(t(e.target).parent().removeClass("vis-tm-menuselectedcolor"),t(e.target).parent().find("li").removeClass("vis-tm-menuselectedcolor"),Ie.prop("checked",!1),ye.find("input:checked").length>0?he.removeClass("vis-tm-delete"):he.addClass("vis-tm-delete")))}var Fi=null,Bi=-1;function Wi(e){Oi=e;var t=Ae.find("input:checked").length,i=Ae.find("[disabled]").length;t==Ae.find("input").length-i?"disabled"!=e&&Ee.prop("checked",!0):Ee.prop("checked",!1)}function ji(n){Oi=n;if(I[0].style.visibility="visible",Ae.find("input:checked").length>1&&Me.empty(),t(n.target).hasClass("VIS-Tm-glyphiconglyphicon-link")){li=[];var a=t(n.target).parent(),l=t(n.target).parent().attr("id");return li.push(l),li=li.toString(),window.setTimeout((function(){Oi=n}),200),void("false"==Tt?t.inArray(parseInt(l),Vt)<0?qi(s,li,a):(e.ADialog.info("NeverDelete",!0,Nt),I[0].style.visibility="hidden"):qi(s,li,a))}if(t(n.target).hasClass("vis-tm-textli")&&(t(this).find("input").prop("checked",!1),t(this).find("li").removeClass("vis-tm-menuselectedcolor"),t(n.target).parent().parent().addClass("vis-tm-menuselectedcolor"),t(t(n.target).parent().parent()).find("input").prop("checked",!0),Fi=t(t(n.target).parent().parent()).find("img").attr("src"),n.target.id=t(n.target).attr("id"),"disabled"==t(n.target).parent().parent().find("input").attr("disabled")&&t(t(n.target).parent().parent()).find("input").prop("checked",!1),Ee.prop("checked",!1),Wi(t(n.target).parent().parent().find("input").attr("disabled")),z&&t(n.target).parent().parent()),t(n.target).hasClass("vis-tm-upperLi")&&(t(n.target).parent().find("li").removeClass("vis-tm-menuselectedcolor"),t(n.target).addClass("vis-tm-menuselectedcolor"),t(n.target).parent().find("input").prop("checked",!1),t(n.target).find("input").prop("checked",!0),Fi=t(n.target).find("img").attr("src"),n.target.id=t(n.target).find(".vis-tm-textli").attr("id"),"disabled"==t(n.target).find("input").attr("disabled")&&t(n.target).find("input").prop("checked",!1),Ee.prop("checked",!1),Wi(t(n.target).find("input").attr("disabled")),z&&t(n.target)),t(n.target).hasClass("vis-tm-upperdivchkandimg")&&(t(n.target).parent().parent().find("li").removeClass("vis-tm-menuselectedcolor"),t(n.target).parent().addClass("vis-tm-menuselectedcolor"),t(n.target).parent().parent().find("input").prop("checked",!1),t(n.target).find("input").prop("checked",!0),Fi=t(n.target).find("img").attr("src"),n.target.id=t(n.target).parent().find(".vis-tm-textli").attr("id"),"disabled"==t(n.target).find("input").attr("disabled")&&t(n.target).find("input").prop("checked",!1),Ee.prop("checked",!1),Wi(t(n.target).find("input").attr("disabled")),z&&t(n.target).parent().parent()),t(n.target).hasClass("vis-tm-chkbox")){if(I[0].style.visibility="visible","disabled"!=t(n.target).attr("disabled"))if(t(n.target).prop("checked")){t(n.target).parent().parent().addClass("vis-tm-menuselectedcolor"),n.target.id=n.target.id=t(n.target).parent().parent().find(".vis-tm-textli").attr("id"),Fi=t(n.target).parent().parent().find("img").attr("src");for(var o=0;o<Ae.find(".vis-tm-menuselectedcolor").length;o++)"disabled"==t(Ae.find(".vis-tm-menuselectedcolor").find("input")[o]).attr("disabled")&&t(Ae.find(".vis-tm-menuselectedcolor").find("input")[o]).parent().parent().removeClass("vis-tm-menuselectedcolor");var r=Ae.find("input:checked").length,d=Ae.find("[disabled]").length;r==Ae.find("input").length-d?Ee.prop("checked",!0):Ee.prop("checked",!1)}else t(n.target).parent().parent().removeClass("vis-tm-menuselectedcolor"),Fi=t(n.target).parent().parent().find("img").attr("src"),n.target.id=0,Ee.prop("checked",!1);I[0].style.visibility="hidden",z&&t(n.target).parent().parent()}t(n.target).hasClass("summNonsumImage")&&(t(n.target).parent().parent().parent().find("li").removeClass("vis-tm-menuselectedcolor"),t(n.target).parent().parent().addClass("vis-tm-menuselectedcolor"),t(n.target).parent().parent().parent().find("input").prop("checked",!1),t(n.target).parent().find("input").prop("checked",!0),Fi=t(n.target).parent().find("img").attr("src"),n.target.id=t(n.target).parent().parent().find(".vis-tm-textli").attr("id"),"disabled"==t(n.target).parent().find("input").attr("disabled")&&t(n.target).parent().find("input").prop("checked",!1),Ee.prop("checked",!1),Wi(t(n.target).parent().find("input").attr("disabled")),z&&t(n.target).parent()),""!=n.target.id&&"undefined"!=n.target.id||(n.target.id=t(n.target).find(".vis-tm-menuselectedcolor").find("li").attr("id")),1==Ae.find(".vis-tm-menuselectedcolor").length&&Ae.find(".vis-tm-menuselectedcolor").find("li").hasClass("vis-tm-opacity")&&""!=n.target.id?t.ajax({url:e.Application.contextUrl+"TreeMaintenance/GetNodePath",type:"Post",data:{node_ID:n.target.id,treeID:s},success:function(a){Ee.prop("checked",!1);var l=JSON.parse(a);if(l=l.replaceAll("\\\\"," \\ "),Me.empty(),Me.append(e.Utility.encodeText(l)),Le.is(":checked")){Ie.prop("checked",!1);t(n.target).parent().parent().find("li").attr("id");var o=t(n.target).parent().parent().find("img").attr("src");if("summary.png"==(o=o.substring(o.lastIndexOf("/")+1))){var r=t(n.target).text();r=r.substring(0,r.lastIndexOf("(")),ve.text(r),Bi=-1}if(Fi.lastIndexOf("/"),"mWindow.png"!=(Fi=Fi.substring(Fi.lastIndexOf("/")+1))&&"folder.png"!=Fi)if(G.is(":checked")){if(Le.is(":checked")){if(I[0].style.visibility="visible","nonSummary.png"!=Fi)i.data("kendoTreeView").expand(".k-item");else{gt();var d=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetParentId",{treeId:s,nodeId:n.target.id,tblName:ut},null);if(null!=d&&d>0){var c=d;null==c&&(c=0),Bi!=c&&(i.data("kendoTreeView").expand(".k-item"),window.setTimeout((function(){t(ie.find(".k-state-selected")).removeClass("k-state-selected"),t(ie.find("div").find("div[data-nodeid='"+c+"']").parent()).addClass("k-state-selected")[0].scrollIntoView();var e=t(ie.find(".k-state-selected")).text();ve.text(e),Bi=c,Pi()}),200),ye.empty(),V=1,N=50,T=oe.val(),_t=ce.is(":checked")?"true":"false",dt(c,s,V,N,T,_t,n),Bi=c)}}I[0].style.visibility="hidden"}}else i.data("kendoTreeView").expand(".k-item");if(0!=t(ie.find("div").find("div[data-nodeid='"+n.target.id+"']").parent()).addClass("k-state-selected").length)t(ie.find(".k-state-selected")).removeClass("k-state-selected"),t(ie.find(".k-state-focused")).removeClass("k-state-focused"),window.setTimeout((function(){t(ie.find("div").find("div[data-nodeid='"+n.target.id+"']").parent()).addClass("k-state-selected")[0].scrollIntoView(),Pi()}),200),ye.empty(),V=1,N=50,T=oe.val(),_t=ce.is(":checked")?"true":"false",dt(n.target.id,s,V,N,T,_t,n);else if(1==Ae.find(".vis-tm-menuselectedcolor").length){var p=Ae.find(".vis-tm-menuselectedcolor").find("img").attr("src");"nonSummary.png"!=(p=p.substring(p.lastIndexOf("/")+1))&&"summary.png"!=p&&Me.empty()}}I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}}):Me.empty(),I[0].style.visibility="hidden"}function Gi(e){var i=ie.find("div").find("div[data-nodeid='"+e+"']").parent().parent().parent();i.children("ul").length>0&&(t(t(i.children("ul")[0]).find("ul")[0]).length>0&&(t(t(t(i.children("ul")[0]).find("ul")[0]).find("ul")[0]).length>0&&(t(t(t(t(i.children("ul")[0]).find("ul")[0]).find("ul")[0]).find("ul")[0]).length>0&&t(t(t(t(t(i.children("ul")[0]).find("ul")[0]).find("ul")[0]).find("ul")[0]).find("ul")[0]).length>0)))}function qi(i,n,a){I[0].style.visibility="visible",treeType=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetTreeType",{treeId:i},null);var s="";s="PR"==treeType?"AD_TreeNodePR":"BP"==treeType?"AD_TreeNodeBP":"MM"==treeType?"AD_TreeNodeMM":"AD_TreeNode";var l=e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetNodeIdsOfParent",{tbname:s,parent_id:n,treeId:i},null);null!=l&&l.length>0?e.ADialog.confirm("ChildAlsoWillbeRemove",!0,"","Confirm",(function(a){a?(n=n.toString(),mi(s,n,i),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/DeleteNodeFromBottom",type:"Post",data:{nodeid:n,treeID:i,menuArray:At},success:function(i){if(""==JSON.parse(i)){0==ye.find("input:checked").length&&Ie.prop("checked",!1),Me.empty();var a=Ae.find("li").find("li[data-id='"+n+"']").parent().parent();a.find("input").prop("disabled",!1),a.find("i").removeClass("vis-tm-opacity"),a.find(".vis-tm-textli").removeClass("vis-tm-opacity"),a.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),a.find("input").css("cursor","pointer"),a.hasClass("vis-tm-menuselectedcolor")&&(Me.empty(),a.find("input").prop("checked",!0)),"false"==Tt&&vi(),ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+n+"']").parent().parent().parent()),ye.find("li").find("li[data-id='"+n+"']").parent().remove();for(var s=0;s<yi.length;s++){var l=yi[s];if(ye.find("li").find("li[data-id='"+l+"']").parent().remove(),!("false"==Tt&&t.inArray(parseInt(l),Vt)>=0)){var o=Ae.find("li").find("li[data-id='"+l+"']").parent().parent();o.find("input").prop("disabled",!1),o.find("i").removeClass("vis-tm-opacity"),o.find(".vis-tm-textli").removeClass("vis-tm-opacity"),o.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),o.find("input").css("cursor","pointer"),o.hasClass("vis-tm-menuselectedcolor")&&(Me.empty(),o.find("input").prop("checked",!0)),"Linked"==ke.val()&&o.remove();var r=Ae.find("li").find("li[data-id='"+l+"']").parent().parent().find("img").attr("src"),d=Ae.find("li").find("li[data-id='"+l+"']").parent().parent().find("img");null!=(p=r)&&("nonSummary.png"==(p=p.substring(p.lastIndexOf("/")+1))?c=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==p&&(c=e.Application.contextUrl+"Areas/VIS/Images/folder.png"),d.attr("src",c))}}var c,p;r=Ae.find("li").find("li[data-id='"+n+"']").parent().parent().find("img").attr("src"),d=Ae.find("li").find("li[data-id='"+n+"']").parent().parent().find("img");null!=(p=r)&&("nonSummary.png"==(p=p.substring(p.lastIndexOf("/")+1))?c=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==p||"folder.png"==p?c=e.Application.contextUrl+"Areas/VIS/Images/folder.png":"mWindow.png"==p&&(c=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png"),d.attr("src",c)),0!=ye.find("li").length||ie.find("span").hasClass("k-state-selected")||ve.text(e.Msg.getMsg("SelectTree")),Et()}di(),Pt(),$e(),I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}})):I[0].style.visibility="hidden"})):(n=n.toString(),mi(s,n,i),t.ajax({url:e.Application.contextUrl+"TreeMaintenance/DeleteNodeFromBottom",type:"Post",data:{nodeid:n,treeID:i,menuArray:At},success:function(i){if(""==JSON.parse(i)){Me.empty();var a=Ae.find("li").find("li[data-id='"+n+"']").parent().parent();a.find("input").prop("disabled",!1),a.find("i").removeClass("vis-tm-opacity"),a.find(".vis-tm-textli").removeClass("vis-tm-opacity"),a.find("span").removeClass("VIS-Tm-glyphiconglyphicon-link"),a.find("input").css("cursor","pointer"),ie.data("kendoTreeView").remove(ie.find("div").find("div[data-nodeid='"+n+"']").parent().parent().parent()),ye.find("li").find("li[data-id='"+n+"']").parent().remove();for(var s=0;s<yi.length;s++){var l=yi[s];if(!("false"==Tt&&t.inArray(parseInt(l),Vt)>=0)){var o=Ae.find("li").find("li[data-id='"+l+"']").parent().parent();o.find("input").prop("disabled",!1),o.find("i").removeClass("vis-tm-opacity"),o.find(".vis-tm-textli").removeClass("vis-tm-opacity"),o.removeClass("vis-tm-menuselectedcolor"),"Linked"==ke.val()&&o.remove();var r=Ae.find("li").find("li[data-id='"+l+"']").parent().parent().find("img").attr("src"),d=Ae.find("li").find("li[data-id='"+l+"']").parent().parent().find("img");null!=(p=r)&&("nonSummary.png"==(p=p.substring(p.lastIndexOf("/")+1))?c=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==p&&(c=e.Application.contextUrl+"Areas/VIS/Images/folder.png"),d.attr("src",c))}}var c,p;r=Ae.find("li").find("li[data-id='"+n+"']").parent().parent().find("img").attr("src"),d=Ae.find("li").find("li[data-id='"+n+"']").parent().parent().find("img");null!=(p=r)&&("nonSummary.png"==(p=p.substring(p.lastIndexOf("/")+1))?c=e.Application.contextUrl+"Areas/VIS/Images/mWindow.png":"summary.png"==p&&(c=e.Application.contextUrl+"Areas/VIS/Images/folder.png"),d.attr("src",c)),Et()}0!=ye.find("li").length||ie.find("span").hasClass("k-state-selected")||ve.text(e.Msg.getMsg("SelectTree")),di(),Pt(),$e(),I[0].style.visibility="hidden"},error:function(e){console.log(e),I[0].style.visibility="hidden"}}))}function Hi(){gt();e.dataContext.getJSONData(e.Application.contextUrl+"TreeMaintenance/GetRestrictionCount",{treeId:s,tableTreeName:ut},null)>5e3?(G.prop("checked",!0),G.prop("disabled",!0),D[0].style.visibility="hidden",u=!0,!0,de.css("display","inherit"),Fe.css("display","inherit"),te.css("height","70%"),ne.css("height","100%"),te.resizable({handles:"n,s,se"}),te.find(".ui-resizable-e").css("right","0px"),te.find(".ui-resizable-s").css("bottom","0px"),ne.addClass("VIS-TM-resizediv"),Fe.height(We.height()-te.height()-20),ue.css("right","145px")):(G.prop("disabled",!1),!1)}function zi(){if(!1,!0,Qt=!1,!1,""!=J.val()){b[0].style.visibility="visible",Pe.removeClass("vis-tm-opacity"),G.prop("disabled",!1),ee.css("display","inherit"),ke.prop("disabled",!0),Le.prop("disabled",!1),Le.css("cursor","pointer"),ce.prop("disabled",!1),ce.css("cursor","pointer"),oe.prop("disabled",!1),Te.prop("disabled",!1),Ee.prop("disabled",!1),Ee.css("cursor","pointer"),we.addClass("vis-tm-delete"),Y.css("display","none"),X.css("display","inherit"),he.addClass("vis-tm-delete"),C=!0,Qi=!0,Ae.empty(),ye.empty(),A="",Te.val(""),oe.val(""),me.css("display","inherit"),g=50,h=1,ke.val(t(ke.find("option")[0]).attr("value"));var o=J.find("option:selected").text();_e.text(e.Msg.getMsg("AllItems")),ve.text(o),n=J.find("option:selected"),a=n.attr("data-type"),s=n.val(),l=n.attr("data-isallnodes"),window.setTimeout((function(){Ye(a,s,l,u)}),100),window.setTimeout((function(){Ae.empty(),h=1,ft(s,0,A,R="All"),It(),bt()}),200),ne.height(te.height()-10),G.is(":checked")?(u=!0,Fe.css("display","inherit"),te.css("height","70%"),ne.css("height","100%"),te.resizable({}),te.find(".ui-resizable-e").css("right","0px"),te.find(".ui-resizable-s").css("bottom","0px"),ne.addClass("VIS-TM-resizediv"),Fe.height(We.height()-te.height()-20),fe.height(We.height()-(te.height()+ge.height()+40)),de.css("display","inherit")):(de.css("display","none"),u=!1,Fe.css("display","none"),te.css("height","100%"),ne.css("height","100%"),te.resizable("destroy"),ne.removeClass("VIS-TM-resizediv"),Fe.height(We.height()-te.height()))}else Pe.addClass("vis-tm-opacity"),G.prop("disabled",!0),G.prop("checked",!0),ee.css("display","none"),s=0,Ae.empty(),ye.empty(),i.data("kendoTreeView").destroy(),i.empty(),Me.empty(),A="",Te.val(""),n=null,he.addClass("vis-tm-delete"),oe.val(""),window.setTimeout((function(){Ae.empty()}),200),_e.text(e.Msg.getMsg("SelectTree")),ve.text(e.Msg.getMsg("SelectTree")),me.css("display","none"),we.addClass("vis-tm-delete"),ce.prop("disabled",!0),Le.prop("disabled",!0),ce.css("cursor","not-allowed"),Le.css("cursor","not-allowed"),oe.prop("disabled",!0),Te.prop("disabled",!0),ke.prop("disabled",!0),Ee.prop("disabled",!0),Ee.css("cursor","not-allowed"),qe.css("display","none"),ue.css("display","none");Le.prop("checked",!1),Ee.prop("checked",!1),ce.prop("checked",!1),Ae.empty(),Ie.prop("checked",!1),di()}var Qi=!0;function Ji(e){var i=t(e.currentTarget);i[0].scrollHeight-i.scrollTop()==i.outerHeight()&&Ae.find("li").length>0&&(R=ke.val(),Qi=!1,E=!0,h+=1,ft(s,0,A,R))}function $i(e){""!=J.val()&&(ye.empty(),G.is(":checked")?(D[0].style.visibility="hidden",u=!0,de.css("display","inherit"),Fe.css("display","inherit"),te.css("height","70%"),ne.css("height","100%"),te.resizable({handles:"n,s,se"}),te.find(".ui-resizable-e").css("right","0px"),te.find(".ui-resizable-s").css("bottom","0px"),ne.addClass("VIS-TM-resizediv"),null!=n&&Ye(a,s,l,u),Fe.height(We.height()-te.height()-20),ue.css("right","145px")):(de.css("display","none"),u=!1,Fe.css("display","none"),te.css("height","100%"),ne.css("height","100%"),te.resizable("destroy"),ne.removeClass("VIS-TM-resizediv"),null!=n&&Ye(a,s,l,u),""!=oe.val()&&ce.prop("checked",!1),ue.css("right","35px")),Y.css("display","none"),X.css("display","inherit"),di(),window.setTimeout((function(){""!=oe.val()&&window.setTimeout((function(){Ei(e)}),200)}),200),Ai=-1,Qt=!1)}this.Initialize=function(){var e;(I=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",c.append(I),(w=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",Se.append(w),(b=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="visible",te.append(b),e=null,e=t('<div style="position: relative; width: 100%; height: 100%; z-index: -1;">'),D=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),e[0].style.visibility="visible",e.append(D),Fe.append(e),Qe(),xt(),window.setTimeout((function(){I[0].style.visibility="hidden"}),200),I[0].style.visibility="visible",w[0].style.visibility="hidden",b[0].style.visibility="hidden",D[0].style.visibility="hidden"},this.disposeComponent=function(){i=null,u=null,n=null,a=null,s=null,l=null,null,null,null,g=null,h=null,o=null,v=null,m=null,r=null,y=null,I=null,d=null,null,U=null,null,F=null,W=null,j=null,G=null,q=null,H=null,Q=null,J=null,$=null,K=null,te=null,ie=null,le=null,oe=null,re=null,ge=null,ve=null,fe=null,me=null,ye=null,Ce=null,_e=null,Se=null,xe=null,Ae=null,Ne=null,Me=null},this.getRoot=function(){return null==window.kendo||null==window.kendo?t('<div><p style="text-align: center;line-height: 600px;">'+e.Msg.getMsg("PleaseInstallKendoUIModule")+"</p></div>"):(window.setTimeout((function(){he.addClass("vis-tm-delete"),te.find(".ui-resizable-n").css("display","none")}),200),I[0].style.visibility="visible",c)},this.formSizeChanged=function(e,t){Fe.height(We.height()-te.height()-20),fe.height(Fe.height()),Fe.css("overflow","hidden")},this.sizeChanged=function(e,t){this.formSizeChanged(e,t)}}i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.Initialize(),this.frame.getContentGrid().append(this.getRoot())},i.prototype.sizeChanged=function(e,t){this.formSizeChanged(e,t)},i.prototype.refresh=function(e,t){this.formSizeChanged()},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VTreeMaintenance=i}(VIS,jQuery)},2512:()=>{!function(e,t){function i(i){this.frame,this.windowNo;var n=null,a=null,s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=this,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=null,q=null,H=null,z=null,Q=null,J=null,$=null,K=null,Y=null,X=null,Z=null,ee=null,te=null,ie=!1,ne=null,ae=null,se=null,le=null,oe=null,re=null,de=!1,ce=null,pe=null,ue=null,ge=null,he=!1,ve=null,fe=null,me=null,ye=null,Ie=null,De=(ge=null,null),we=null,be=null,Ce=null,_e=null,Se=null,xe=null,Ae=null,Te=null,Ve=null,Ne=t("<div class='vis-forms-container'>"),Me=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),ke=e.Env.getWindowNo();this.log=e.Logging.VLogger.getVLogger("UserPreference"),this.load=function(){Me[0].style.visibility="visible",Ne.load(e.Application.contextUrl+"UserPreference/Index/?windowno="+ke+"&adUserId="+e.context.getAD_User_ID(),(function(e){M.init(Ne);Ne.find("#content_"+ke);Me[0].style.visibility="hidden"}))},this.init=function(M){n=M.find("#chkAutoCommit_"+ke),a=M.find("#chkStorePassword_"+ke),s=M.find("#chkAutoLogin_"+ke),l=M.find("#chkShowTranslationTab_"+ke),o=M.find("#chkShowAccountingTab_"+ke),r=M.find("#chkAutoNewRecord_"+ke),d=M.find("#chkShowAdvancedTab_"+ke),c=M.find("#chkCacheWindows_"+ke),p=M.find("#cmbTraceLevel_"+ke),u=M.find("#chkTraceFile_"+ke),g=M.find("#dt_Date_"+ke),M.find("#chkDictionaryMaintain_"+ke),h=M.find("#cmbClientOrg_"+ke),v=M.find("#chkShowMiniGrid_"+ke),f=M.find("#cmbPageSize_"+ke),m=M.find("#chkNativeDigit_"+ke),y=M.find("#cmbWindowPageSize_"+ke),I=M.find("#lblVariableName_"+ke),D=M.find("#lblVariableValue_"+ke),A=M.find("#btnOk_"+ke),T=M.find("#btnCancel_"+ke),V=M.find("#btnRole_"+ke),N=M.find("#contextlst_"+ke),x=M.find("#prefErrortbl_"+ke),A.hide(),T.hide(),M.find("#btnChangePws_"+ke),k=M.find("#txtCurrentPws_"+ke),O=M.find("#txtNewPws_"+ke),L=M.find("#txtConformPws_"+ke),R=M.find("#chkIsEmail_"+ke),E=M.find("#chkIsNotice_"+ke),P=M.find("#chkIsSMS_"+ke),U=M.find("#chkIsFax_"+ke),F=M.find("#txtUserName_"+ke),B=M.find("#txtPws_"+ke),W=M.find("#btnEmailConfig_"+ke),j=M.find("#btnSubstitute_"+ke),G=M.find("#btnSaveChanges_"+ke),q=M.find("#btnSaveChangePassword_"+ke),J=M.find("#lblPrefSave_"+ke),Q=M.find("#btnSave_"+ke),K=M.find("#vbtnGmailAuth_"+ke),Y=M.find("#vbtnSyncGmailTask_"+ke),X=M.find("#txtAuthCode_"+ke),Z=M.find("#chkIsSyncBackground_"+ke),(ee=M.find("#lblTaskSettingMessage_"+ke)).hide(),ne=M.find("#vbtnGmailCalAuth_"+ke),ae=M.find("#vbtnSyncGmailCalendar_"+ke),se=M.find("#txtCalAuthCode_"+ke),le=M.find("#chkCalIsSyncBackground_"+ke),(oe=M.find("#lblCalendarSettingMessage_"+ke)).hide(),ce=M.find("#vbtnGmailContactAuth_"+ke),pe=M.find("#vbtnSyncGmailContact_"+ke),ue=M.find("#txtContactAuthCode_"+ke),(ge=M.find("#lblContactSettingMessage_"+ke)).hide(),t.ajax({type:"POST",async:!1,url:e.Application.contextUrl+"UserPreference/GetSavedDetail",dataType:"json",data:{isTask:!0},success:function(t){de=!1,ie=!1,he=!1;var i=JSON.parse(t);"false"==i.IsSyncInBackground?(Z.prop("checked",!1),te=!1):(Z.prop("checked",!0),te=!0),"false"==i.IsCalSyncInBackground?(le.prop("checked",!1),re=!1):(le.prop("checked",!0),re=!0),X.val(i.TaskAuthCode),X.val().length>0&&(Y.html(e.Msg.getMsg("RemoveLink")),ie=!0),se.val(i.CalendarAuthCode),se.val().length>0&&(ae.html(e.Msg.getMsg("RemoveLink")),de=!0),ue.val(i.ContactAuthCode),ue.val().length>0&&(pe.html(e.Msg.getMsg("RemoveLink")),he=!0)}}),ve=M.find("#txtGmailUserName_"+ke),fe=M.find("#txtGmailPassword_"+ke),me=M.find("#cmbSettingRole_"+ke),ye=M.find("#chkbxUpdateExisting_"+ke),De=M.find("#vbtnSyncGmailContact_"+ke),(ge=M.find("#lblContactSettingMessage_"+ke)).hide(),function(){(function(){if(!window.WSP)return;var i=e.Application.contextUrl+"WSP/ContactSettings/GetRole";t.ajax({type:"GET",async:!0,url:i,dataType:"json",success:function(t){var i=JSON.parse(t);at+="<option value='-1'  selected='selected'>"+e.Msg.getMsg("SelectRole")+"</option>";for(var n=0;n<i.length;n++)at+="<option value='"+i[n].RoleID+"'>"+i[n].RoleName+"</option>"}})})(),null!=me&&me.append(at);!function(){if(!window.WSP)return;var i=e.Application.contextUrl+"WSP/ContactSettings/GetSavedDetail";t.ajax({type:"GET",async:!0,url:i,dataType:"json",success:function(e){var t=JSON.parse(e);ve.val(t.Username),fe.val(t.Password),""!=t.Role&&me.val(t.Role),"false"==t.IsUpdate.toString().toLowerCase()?(ye.prop("checked",!1),Ie=!1):(ye.prop("checked",!0),Ie=!0)}})}()}(),(we=M.find("#cmbRole_"+ke)).on("change",(function(){Re()})),(be=M.find("#cmbClient_"+ke)).on("change",(function(){Ee()})),(Ce=M.find("#cmbOrg_"+ke)).on("change",(function(){Pe()})),_e=M.find("#cmbWareHouse_"+ke),$btnTheme=M.find("#btnTheme_"+ke),Se={},Oe(),function(){var t=e.Application.contextUrl+"JsonData/GetThemes";e.dataContext.getJSONData(t,null,tt)}();var Le=M.find("#lblUserSetMenu_"+ke),Ue=M.find("#lblPreferenceMenu_"+ke),Fe=M.find("#lblContextMenu_"+ke),Be=M.find("#lblErrorMenu_"+ke);if(Le.text(e.Msg.getMsg("UserSetting")),Ue.text(e.Msg.getMsg("Preference")),Fe.text(e.Msg.getMsg("Context")),Be.text(e.Msg.getMsg("PreferenceError")),M.find("#lblchangePwsHeader_"+ke).text(e.Msg.getMsg("ChangePassword")),M.find("#lblAutoMatic_"+ke).text(e.Msg.getMsg("AutoCommit")),M.find("#imgAutoMatic_"+ke).text(e.Msg.getMsg("AutoCommit",!0)),M.find("#lblTranslation_"+ke).text(e.Msg.getMsg("ShowTranslationTab")),M.find("#imgTranslation_"+ke).text(e.Msg.getMsg("ShowTranslationTab")),M.find("#lblShowAccounting_"+ke).text(e.Msg.getMsg("ShowAcctTab")),M.find("#imgShowAccounting_"+ke).text(e.Msg.getMsg("ShowAcctTab")),M.find("#lblAutoNewRecord_"+ke).text(e.Msg.getMsg("AutoNew")),M.find("#imgAutoNewRecord_"+ke).text(e.Msg.getMsg("AutoNew")),M.find("#lblShowAdvanced_"+ke).text(e.Msg.getMsg("ShowAdvancedTab")),M.find("#imgShowAdvanced_"+ke).text(e.Msg.getMsg("ShowAdvancedTab")),M.find("#lblCacheWindows_"+ke).text(e.Msg.getMsg("CacheWindow")),M.find("#imgCacheWindows_"+ke).text(e.Msg.getMsg("CacheWindow")),M.find("#vlblClientOrg_"+ke).text(e.Msg.getMsg("Show")),M.find("#imgClientOrg_"+ke).text(e.Msg.getMsg("ClientOrg")),M.find("#lblWindowPageSize_"+ke).text(e.Msg.getMsg("WindowPageSize")),M.find("#imgWindowPageSize_"+ke).text(e.Msg.getMsg("WindowPageSize")),M.find("#lblAutoLogin_"+ke).text(e.Msg.getMsg("AutoLogin")),M.find("#imgAutoLogin_"+ke).text(e.Msg.getMsg("AutoLogin")),M.find("#lblStorePassword_"+ke).text(e.Msg.getMsg("StorePassword")),M.find("#imgStorePassword_"+ke).text(e.Msg.getMsg("StorePassword")),M.find("#lblTraceLevel_"+ke).text(e.Msg.getMsg("TraceLevel")),M.find("#imgTraceLevel_"+ke).text(e.Msg.getMsg("TraceLevel")),M.find("#lblTraceFile_"+ke).text(e.Msg.getMsg("TraceFile")),M.find("#imgTraceFile_"+ke).text(e.Msg.getMsg("TraceFile")),M.find("#lblNativeDigit_"+ke).text(e.Msg.getMsg("PrintNativeDigits")),M.find("#imgNativeDigit_"+ke).text(e.Msg.getMsg("PrintNativeDigits")),M.find("#vlblDateText_"+ke).text(e.Msg.getMsg("Date")),M.find("#imgDateText_"+ke).text(e.Msg.getMsg("Date")),M.find("#vlblthemeText_"+ke).text(e.Msg.getMsg("SelectTheme")),M.find("#imgThemetext"+ke).text(e.Msg.getMsg("SelectTheme")),xe=M.find("#vis_pref_theme"+ke),Ae=xe.find("ul"),M.find("#vlblPageSize_"+ke).text(e.Msg.getMsg("Pagesize")),M.find("#imgPageSize_"+ke).text(e.Msg.getMsg("Pagesize")),M.find("#vlblPageSize_"+ke).text(e.Msg.getMsg("Pagesize")),M.find("#lblContext_"+ke).text(e.Msg.getMsg("Context")),H=M.find("#lblRecordSave_"+ke),z=M.find("#lblChangePasswordMessage_"+ke),H.hide(),J.hide(),z.hide(),M.find("#pchangePws_"+ke).text(e.Msg.getMsg("PPasswordInfo")),M.find("#pNotification_"+ke).text(e.Msg.getMsg("PNotificationInfo")),M.find("#pEmailConfig_"+ke).text(e.Msg.getMsg("PEmailConfigInfo")),M.find("#pSubstitute_"+ke).text(e.Msg.getMsg("PSubstituteInfo")),M.find("#pContext_"+ke).text(e.Msg.getMsg("PContextInfo")),M.find("#pError_"+ke).text(e.Msg.getMsg("PErrorInfo")),null!=p){for(var We=[e.Logging.Level.OFF.getIntValue(),e.Logging.Level.SEVERE.getIntValue(),e.Logging.Level.WARNING.getIntValue(),e.Logging.Level.INFO.getIntValue(),e.Logging.Level.CONFIG.getIntValue(),e.Logging.Level.FINE.getIntValue(),e.Logging.Level.FINER.getIntValue(),e.Logging.Level.FINEST.getIntValue(),e.Logging.Level.ALL.getIntValue()],je=[e.Logging.Level.OFF.getName(),e.Logging.Level.SEVERE.getName(),e.Logging.Level.WARNING.getName(),e.Logging.Level.INFO.getName(),e.Logging.Level.CONFIG.getName(),e.Logging.Level.FINE.getName(),e.Logging.Level.FINER.getName(),e.Logging.Level.FINEST.getName(),e.Logging.Level.ALL.getName()],Ge=0,qe=0;qe<We.length;qe++)p.append(" <option value="+We[qe]+">"+je[qe]+"</option>"),e.Ini.getLocalStorage(e.IniConstants.P_TRACELEVEL)==We[qe]&&(Ge=qe);p.prop("selectedIndex",Ge)}if(null!=h){var He=[e.Msg.getMsg("Client+Org"),e.Msg.getMsg("Client"),e.Msg.getMsg("Org"),e.Msg.getMsg("None")];for(Ge=0,qe=0;qe<He.length;qe++)h.append("<option>"+He[qe]+"</option>"),e.Ini.getLocalStorage(e.IniConstants.CO_SHOWLEVEL)==qe&&(Ge=qe);h.prop("selectedIndex",Ge)}if(null!=f){var ze=[5,6,7,8,9,10];for(Ge=0,qe=0;qe<ze.length;qe++)f.append("<option>"+ze[qe]+"</option>"),e.Ini.getLocalStorage(e.IniConstants.W_PAGESIZE)==ze[qe]&&(Ge=qe);f.prop("selectedIndex",Ge)}if(null!=y){for(ze=[50,100,500],Ge=0,qe=0;qe<ze.length;qe++)y.append("<option>"+ze[qe]+"</option>"),e.Ini.getLocalStorage(e.IniConstants.WIN_PAGESIZE)==ze[qe]&&(Ge=qe);y.prop("selectedIndex",Ge)}if(null!=N){for(var Qe=e.context.getEntireCtx(),Je=[],$e=(qe=0,Object.keys(Qe).length),Ke=0;Ke<$e;Ke+=1)Je[qe++]=' <li class="VIS_Pref_li-err" ><span >',Je[qe++]=Object.keys(Qe)[Ke]+" == "+Qe[Object.keys(Qe)[Ke]],Je[qe++]="</span></li>";N.append(Je.join("")),Qe=null,Je=null}if(w=M.find("#vchkErrorOnly_"+ke),b=M.find("#vbtnReset_"+ke),C=M.find("#vbtnSaveToFile_"+ke),e.context&&0==!e.context.getAD_Role_ID()&&M.find(".VIS_Pref_err_btnLeft").hide(),_=M.find("#vbtnLogDate_"+ke),S=M.find("#vbtnDownLog_"+ke),et(_),S.on("click",(function(i){var n=_.val();n=n?new Date(n).toISOString():(new Date).toISOString(),Ze(!0),t.ajax({type:"POST",url:e.Application.contextUrl+"UserPreference/DownloadServerLog",dataType:"json",data:{logDate:n},success:function(t){if(t){var i="TempDownload/"+t;window.open(e.Application.contextUrl+i),et(_)}else e.ADialog.info("VIS_NoLogFound",null,null);Ze(!1)},error:function(e){Ze(!1)}})})),w.prop("checked",!0),null!=x){var Ye=e.Logging.VLogErrorBuffer.get(!0).getLogData(w.prop("checked"));$=Ye,lt(Ye)}xe.on("click","div.vis-theme-rec",(function(i){var n=t(i.currentTarget);Ve=n.data("color"),Te=Number(n.data("id")),e.themeMgr&&e.themeMgr.applyTheme(Ve)})),$btnTheme.on("click",(function(){(new e.ThemeCnfgtor).show()})),C.on("click",(function(){if((Ye=$).length>0){for(var e="",i=0;i<Ye.length;i++)e+=Ye[i]+"\n";var n=(new Date).toISOString().slice(0,19).replace(/-/g,""),a="data:text/csv;base64,"+window.btoa(e);t(this).attr("href",a).attr("download","file-"+n+".csv")}})),o.prop("checked","Y"==e.Env.getCtx().ctx["#ShowAcct"]),l.prop("checked","Y"==e.Env.getCtx().ctx["#ShowTrl"]),d.prop("checked","Y"==e.Env.getCtx().ctx["#ShowAdvanced"]),n.prop("checked",e.Env.getCtx().isAutoCommit()),r.prop("checked",e.Env.getCtx().isAutoNew()),s.prop("checked","N"!=e.Ini.getLocalStorage(e.IniConstants.P_A_LOGIN)),a.prop("checked","N"!=e.Ini.getLocalStorage(e.IniConstants.P_STORE_PWD)),v.prop("checked","N"!=e.Ini.getLocalStorage(e.IniConstants.P_Show_Mini_Grid)),m.prop("checked","Y"==e.Ini.getLocalStorage(e.IniConstants.P_Print_Native_Digits)),c.prop("checked","Y"==e.Ini.getLocalStorage(e.IniConstants.P_CACHE_WINDOW)),u.prop("checked","Y"==e.Ini.getLocalStorage(e.IniConstants.P_TRACEFILE));var Xe=new Date(Number(e.Env.getCtx().ctx["#Date"]));function Ze(e){Me[0].style.visibility=e?"visible":"hidden"}function et(e){var t=new Date,i=("0"+t.getDate()).slice(-2),n=("0"+(t.getMonth()+1)).slice(-2),a=t.getFullYear()+"-"+n+"-"+i;e.val(a)}function tt(e){var t=[];if(e){for(var i=0,n=e.length;i<n;i++){var a=e[i];t.push("<li>"),t.push('<div class="vis-theme-rec" data-color="'),t.push(a.PColor),t.push("|"),t.push(a.OnPColor),t.push("|"),t.push(a.SColor),t.push("|"),t.push(a.OnSColor),t.push('" data-id="'+a.Id+'" >'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.PColor+',1)"></span>'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.OnPColor+',1)"></span>'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.SColor+',1)"></span>'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.OnSColor+',1)"></span>'),t.push("</div>"),t.push("</li>")}Ae.append(t.join(""))}}function it(i,n){t.ajax({type:"POST",async:!1,url:e.Application.contextUrl+"UserPreference/GetGmailAuthorizationCode",dataType:"json",data:{isTask:i,isContact:n},success:function(e){var t=JSON.parse(e);null!=t&&t.length>0&&window.open(t)}})}function nt(i,n,a,s,l){t.ajax({type:"POST",async:!1,url:e.Application.contextUrl+"UserPreference/SaveGmailAccountSettings",dataType:"json",data:{authCodes:a,isTask:i,isSyncInBackground:n,isRemoveLink:s,isContact:l},success:function(t){var n=JSON.parse(t);i?"false"==n.toString()?(ee.css("color","red"),ee.text(e.Msg.getMsg("RecordNotSaved")),ee.show()):"true"==n.toString()?(ee.css("color","green"),ee.text(e.Msg.getMsg("RecordSaved")),s?(X.val(""),Y.html(e.Msg.getMsg("Save")),Z.prop("checked",!1),ie=!1,X.removeAttr("disabled"),ee.text(e.Msg.getMsg("LinkRemoved"))):(Y.html(e.Msg.getMsg("RemoveLink")),X.attr("disabled",!0),ie=!0),ee.show()):window.open(n):l?"false"==n.toString()?(ge.css("color","red"),ge.text(e.Msg.getMsg("RecordNotSaved")),ge.show()):"true"==n.toString()?(ge.css("color","green"),ge.text(e.Msg.getMsg("RecordSaved")),s?(ue.val(""),pe.html(e.Msg.getMsg("Save")),he=!1,ue.removeAttr("disabled"),ge.text(e.Msg.getMsg("LinkRemoved"))):(pe.html(e.Msg.getMsg("RemoveLink")),ue.attr("disabled",!0),he=!0),ge.show()):window.open(n):"false"==n.toString()?(oe.css("color","red"),oe.text(e.Msg.getMsg("RecordNotSaved")),oe.show()):"true"==n.toString()?(oe.css("color","green"),oe.text(e.Msg.getMsg("RecordSaved")),s?(se.val(""),ae.html(e.Msg.getMsg("Save")),le.prop("checked",!1),de=!1,se.removeAttr("disabled"),oe.text(e.Msg.getMsg("LinkRemoved"))):(ae.html(e.Msg.getMsg("RemoveLink")),se.attr("disabled",!0),de=!0),oe.show()):window.open(n)}})}null!=Xe&&g.val(Globalize.format(Xe,"yyyy-MM-dd")),N.on("click","li",(function(){var e=t(this).text().split("==")[0],i=t(this).text().split("==")[1];I.text(e.toString()),D.text(i.toString())})),t(".VIS_Pref_meni li").on("click",(function(){t(".VIS_Pref_menu li").removeClass("active"),t(this).addClass("active")})),b.on("click",(function(){var t=e.Logging.VLogErrorBuffer.get(!0).resetBuffer(w.prop("checked"));$=t,null!=t?lt(t):x.find("tr:gt(0)").remove()})),t(".VIS_Pref_btn-pass-click").on("click",(function(){t(".VIS_Pref_new-password").css("display","block"),t(".VIS_Pref_Save").css("display","block")})),t(".VIS_Pref_close-btn").click((function(){t(".VIS_Pref_new-password").css("display","none"),t(".VIS_Pref_Save").css("display","none")})),t(".VIS_Pref_link-1").click((function(){t(".VIS_Pref_content-right").css("display","block"),t(".VIS_Pref_content-right-2").css("display","none"),t(".VIS_Pref_content-right-3").css("display","none"),t(".VIS_Pref_content-right-4").css("display","none"),t(".VIS_Pref_content-right-5").css("display","none")})),t(".VIS_Pref_link-2").click((function(){t(".VIS_Pref_content-right").css("display","none"),t(".VIS_Pref_content-right-2").css("display","block"),t(".VIS_Pref_content-right-3").css("display","none"),t(".VIS_Pref_content-right-4").css("display","none"),t(".VIS_Pref_content-right-5").css("display","none")})),t(".VIS_Pref_link-3").click((function(){t(".VIS_Pref_content-right").css("display","none"),t(".VIS_Pref_content-right-2").css("display","none"),t(".VIS_Pref_content-right-3").css("display","block"),t(".VIS_Pref_content-right-4").css("display","none"),t(".VIS_Pref_content-right-5").css("display","none")})),t(".VIS_Pref_link-4").click((function(){t(".VIS_Pref_content-right").css("display","none"),t(".VIS_Pref_content-right-2").css("display","none"),t(".VIS_Pref_content-right-3").css("display","none"),t(".VIS_Pref_content-right-4").css("display","flex"),t(".VIS_Pref_content-right-5").css("display","none")})),t(".VIS_Pref_link-5").click((function(){window.WSP?(t(".VIS_Pref_content-right").css("display","none"),t(".VIS_Pref_content-right-2").css("display","none"),t(".VIS_Pref_content-right-3").css("display","none"),t(".VIS_Pref_content-right-4").css("display","none"),t(".VIS_Pref_content-right-5").css("display","block")):alert("please download WSP !!!")})),i&&t(".VIS_Pref_link-5").trigger("click"),Q.on("click",(function(){st()})),A.on("click",(function(){st()})),T.on("click",(function(){Ne.dialog("close")})),w.on("click",(function(){var t;x.find("tr").slice(1,-1).remove(),t=e.Logging.VLogErrorBuffer.get(!0).getLogData(w.prop("checked")),$=t,null!=t&&lt(t)})),V.on("click",(function(){e.MRole.toStringX(e.Env.getCtx())})),q.on("click",(function(){var i=k.val(),n=O.val(),a=L.val();F.val(),B.val();return i.length<=0||n.length<=0||a.length<=0?(z.css("color","red"),z.text(e.Msg.getMsg("FillMandatory")),void z.show()):n!=a?(z.css("color","red"),z.text(e.Msg.getMsg("samePassword")),void z.show()):void t.ajax({type:"POST",async:!1,url:e.Application.contextUrl+"UserPreference/SaveChangePassword",dataType:"json",data:{AD_User_ID:e.context.getAD_User_ID(),currentPws:i,newPws:n},success:function(t){returnValue=t.result,z.show(),"OK"==returnValue?(z.css("color","green"),z.text(e.Msg.getMsg("Passwordchanged"))):(z.css("color","red"),z.text(returnValue))}})})),G.on("click",(function(){var i=k.val(),n=O.val(),a=L.val(),s=F.val(),l=B.val();if(i.length<=0&&n.length<=0&&a.length<=0||i.length>0&&n.length>0&&a.length>0)if(-1!=O.text().localeCompare(L.text())){var o=we.val(),r=be.val(),d=Ce.val(),c=_e.val();null!=o&&null!=r&&null!=d?(null==c&&(c=0),t.ajax({type:"POST",async:!1,url:e.Application.contextUrl+"UserPreference/SaveUserSettings",dataType:"json",data:{AD_User_ID:e.context.getAD_User_ID(),currentPws:i,newPws:n,conformPws:a,chkEmail:R.prop("checked"),chkNotice:E.prop("checked"),chkSMS:P.prop("checked"),chkFax:U.prop("checked"),emailUserName:s,emailPws:l,AD_Role_ID:o,AD_Client_ID:r,AD_Org_ID:d,M_Warehouse_ID:c},success:function(e){returnValue=e.result,H.show(),H.css("color","green"),H.text(returnValue.Msg),returnValue.IsSaved||H.css("color","red")}})):H.text(e.Msg.getMsg("VIS_FillLogin"))}else H.text(e.Msg.getMsg("samePassword"));else H.text(e.Msg.getMsg("mandatoryFields"))})),W.on("click",(function(){var t=0;try{if((t=e.dataContext.getJSONData(e.Application.contextUrl+"UserPreference/GetWindowID",{WindowName:"Mail Configuration"},null))>0){var i=new e.Query;i.addRestriction("AD_User_ID",e.Query.prototype.EQUAL,e.context.getAD_User_ID()),e.viewManager.startWindow(t,i)}}catch(t){this.log.log(e.Logging.Level.SEVERE,sql,t)}Ne.dialog("close")})),j.on("click",(function(){var t=0;try{if((t=e.dataContext.getJSONData(e.Application.contextUrl+"UserPreference/GetWindowID",{WindowName:"User Substitute"},null))>0){var i=new e.Query;i.addRestriction("AD_User_ID",e.Query.prototype.EQUAL,e.context.getAD_User_ID()),e.viewManager.startWindow(t,i)}}catch(t){this.log.log(e.Logging.Level.SEVERE,sql,t)}Ne.dialog("close")})),K.on("click",(function(){it(!0,!1)})),Y.on("click",(function(){ee.css("color","gray"),ee.text(e.Msg.getMsg("PleaseWait")),ee.show(),window.setTimeout((function(){nt(!0,te,X.val(),ie,!1)}),500)})),Z.on("click",(function(e){te=e.originalEvent.target.checked})),ce.on("click",(function(){it(!1,!0)})),pe.on("click",(function(){ge.css("color","gray"),ge.text(e.Msg.getMsg("PleaseWait")),ge.show(),window.setTimeout((function(){nt(!1,!1,ue.val(),he,!0)}),500)})),ne.on("click",(function(){it(!1,!1)})),ae.on("click",(function(){oe.css("color","gray"),oe.text(e.Msg.getMsg("PleaseWait")),oe.show(),window.setTimeout((function(){nt(!1,re,se.val(),de,!1)}),500)})),le.on("click",(function(e){re=e.originalEvent.target.checked})),ye.on("click",(function(e){Ie=e.originalEvent.target.checked})),De.on("click",(function(){ve.val()&&""!=ve.val()&&0!=ve.val().length&&fe.val()&&""!=fe.val()&&0!=fe.val().length&&(ge.css("color","gray"),ge.text(e.Msg.getMsg("PleaseWait")),ge.show(),window.setTimeout((function(){!function(i,n,a,s){var l=e.Application.contextUrl+"WSP/ContactSettings/SaveGmailContactSettings";t.ajax({type:"POST",async:!1,url:l,dataType:"json",data:{username:i,password:n,role_ID:a,isUpdateExisting:s},success:function(t){"false"==JSON.parse(t).toString()?(ge.css("color","red"),ge.text(e.Msg.getMsg("RecordNotSaved")),ge.show()):(ge.css("color","green"),ge.text(e.Msg.getMsg("RecordSaved")),ge.show())}})}(ve.val(),fe.val(),me.val(),Ie)}),500))}));var at=null;function st(){e.Env.getCtx().setContext("AutoCommit",n.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_A_NEW,r.prop("checked")?"Y":"N"),e.Env.getCtx().setContext("AutoNew",r.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_TRACEFILE,u.prop("checked")?"Y":"N");var i=p.find("option:selected").val(),g=e.Logging.Level.prototype.getLevel(i);e.Logging.VLogMgt.setLevel(g),e.Ini.setValueToLocalStorage(e.IniConstants.P_TRACELEVEL,p.find("option:selected").val());var I=h[0].selectedIndex;e.Ini.setValueToLocalStorage(e.IniConstants.CO_SHOWLEVEL,I<0?0:I),e.Env.getCtx().setContext("#ClientOrgLevel",I<0?0:I),e.Ini.setValueToLocalStorage(e.IniConstants.W_PAGESIZE,f.find("option:selected").val()),e.Env.getCtx().setContext("#ShowWorkSpacePageSize",f.find("option:selected").val());var D=y.find("option:selected").val();e.Ini.setValueToLocalStorage(e.IniConstants.WIN_PAGESIZE,D),e.Env.setWINDOW_PAGE_SIZE(D),e.Ini.setValueToLocalStorage(e.IniConstants.P_Show_Mini_Grid,v.prop("checked")?"Y":"N"),e.Env.getCtx().setContext("#ShowMiniGrid",v.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_Print_Native_Digits,m.prop("checked")?"Y":"N"),e.Env.getCtx().setContext("#PrintNativeDigits",m.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_A_LOGIN,s.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_STORE_PWD,a.prop("checked")?"Y":"N"),e.Env.getCtx().setContext("#ShowAcct",o.prop("checked")?"Y":"N"),e.Env.getCtx().setContext("#ShowTrl",l.prop("checked")?"Y":"N"),e.Env.getCtx().setContext("#ShowAdvanced",d.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_CACHE_WINDOW,c.prop("checked")?"Y":"N"),e.Ini.setValueToLocalStorage(e.IniConstants.P_TRACEFILE,u.prop("checked")?"Y":"N");!function(i,n){null!=Te&&(e.dataContext.postJSONData(e.Application.contextUrl+"Theme/SaveForUser",{id:Te,uid:e.context.getAD_User_ID()},(function(e){})),e.Application.theme=Ve);t.ajax({url:e.Application.contextUrl+"UserPreference/SavePrefrence",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({pref:i})}).done((function(e){e,Ne.dialog("close")}))}({IsAutoCommit:n.prop("checked")?"Y":"N",IsShowAcct:o.prop("checked")?"Y":"N",IsShowTrl:l.prop("checked")?"Y":"N",IsShowAdvanced:d.prop("checked")?"Y":"N"})}function lt(e){for(var i=e.length,n="",a=0;a<i;a+=1){n+="<tr class='VIS_Pref-tbl-Row'>";for(var s=0;s<e[a].length;s+=1){var l=e[a][s];0==s||e[a].length,n+=a%2?"<td class='VIS_Pref_table-row2'>"+l+"</td>":"<td class='VIS_Pref_table-row1'>"+l+"</td>"}n+=" </tr>"}x.find("tbody > tr").eq(0).after(t.parseHTML(n)),Qe=null,n=null}};var Oe=function(){t.ajax({url:e.Application.contextUrl+"UserPreference/GetDefaultLogin",dataType:"json",data:{AD_User_ID:e.context.getAD_User_ID()},success:function(e){var t=JSON.parse(e);Se.AD_Role_ID=t.AD_Role_ID,Se.AD_Client_ID=t.AD_Client_ID,Se.AD_Org_ID=t.AD_Org_ID,Se.M_Warehouse_ID=t.M_Warehouse_ID,Le()}})},Le=function(){t.ajax({url:e.Application.contextUrl+"UserPreference/GetUserRoles",dataType:"json",data:{sql:""},success:function(e){var t=JSON.parse(e),i="";for(var n in t)i+="<option value="+t[n].RecKey+">"+t[n].Name+"</option>";we.append(i),we.val(Se.AD_Role_ID),i=null,t=null,Re()}})},Re=function(){var i=we.val();if(be.empty(),Ce.empty(),_e.empty(),null!=i){var n=i;i=null,t.ajax({url:e.Application.contextUrl+"UserPreference/GetLoginData",dataType:"json",data:{sql:n},success:function(e){var t=JSON.parse(e),i="";for(var a in t)i+="<option value="+t[a].RecKey+">"+t[a].Name+"</option>";be.append(i),be.val(Se.AD_Client_ID),i=null,t=null,n=null,Ee()}})}},Ee=function(){var i=we.val(),n=be.val();if(Ce.empty(),_e.empty(),null!=i&&null!=n){t.ajax({url:e.Application.contextUrl+"UserPreference/GetOrgData",dataType:"json",data:{roleId:i,clientId:n},success:function(e){var t=JSON.parse(e),a="";for(var s in t)a+="<option value="+t[s].RecKey+">"+t[s].Name+"</option>";Ce.append(a),Ce.val(Se.AD_Org_ID),a=null,t=null,null,i=null,n=null,Pe()}})}},Pe=function(){var i=Ce.val();_e.empty(),null!=i&&t.ajax({url:e.Application.contextUrl+"UserPreference/GetWarehouseData",dataType:"json",data:{orgId:i},success:function(e){var t=JSON.parse(e),n="";for(var a in t)n+="<option value="+t[a].RecKey+">"+t[a].Name+"</option>";_e.append(n),_e.val(Se.M_Warehouse_ID),n=null,t=null,sql=null,i=null}})};this.showDialog=function(){var i=t(window).width()-150,n=t(window).height()-40;Me.height(n),Me.width(i),Ne.append(Me),Ne.dialog({modal:!1,title:e.Msg.getMsg("Preference"),width:i,height:n,position:{at:"center top",of:window},close:function(){e.Application.theme&&""!=e.Application.theme&&e.themeMgr.applyTheme(e.Application.theme),M.dispose(),Ne.dialog("destroy"),t("#ui-datepicker-div").remove(),Ne=null,M=null}})},this.show=function(){this.load(),this.showDialog()},this.disposeComponent=function(){M=null,xe&&xe.off("click"),A&&A.off("click"),T&&T.off("click"),b&&b.off("click"),C&&C.off("click"),S&&S.off("click"),s=null,l=null,o=null,r=null,d=null,u=null,p=null,$=null,null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,l=null,w=null,b=null,C=null,x=null,V=null,A=null,T=null,null,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=null,lblUserSetMenu=null,lblPreferenceMenu=null,lblContextMenu=null,lblErrorMenu=null,lblchangePwsHeader=null,lblAutoMatic=null,imgAutoMatic=null,lblTranslation=null,imgTranslation=null,lblShowAccounting=null,imgShowAccounting=null,lblAutoNewRecord=null,imgAutoNewRecord=null,lblShowAdvanced=null,imgShowAdvanced=null,lblCacheWindows=null,imgCacheWindows=null,vlblClientOrg=null,imgClientOrg=null,lblWindowPageSize=null,imgWindowPageSize=null,lblAutoLogin=null,imgAutoLogin=null,lblStorePassword=null,imgStorePassword=null,lblTraceLevel=null,imgTraceLevel=null,lblTraceFile=null,imgTraceFile=null,lblNativeDigit=null,imgNativeDigit=null,vlblDateText=null,imgDateText=null,vlblPageSize=null,imgPageSize=null,vlblPageSize=null,lblContext=null,g.datepicker("destroy"),g=null,we.off("change"),be.off("change"),Ce.off("change"),we=null,be=null,Ce=null,_e=null,Le=null,Ee=null,Re=null,Pe=null,this.disposeComponent=null}}e.Framework=e.Framework||{},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Framework.UserPreference=i}(VIS,jQuery)},7984:()=>{!function(e,t){function i(i,n,a){if(null==i)return null;var s=this,l=t("<div class='vis-forms-container' style='position:relative;'>"),o=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>');if(this.Okbtn=null,this.cancelbtn=null,this.deletebtn=null,this.txtAttribute=null,this.lblAttribute=null,this.txtSearchKey=null,this.lblValue=null,this.lblAttribute=null,this.lblValueText=null,this.lblLevelText=null,this.chkTenant=null,this.chkOrg=null,this.chkUser=null,this.chkWindow=null,this.lblMsg=null,this.userchk=null,this.tenantchk=null,this.windowchk=null,this.orgchk=null,this.aValue=null,this.aDisplayValue=null,null!=n&&(this.aValue=n,typeof n==Boolean&&(this.aValue=n?"Y":"N"),this.aDisplayValue=null==a?this.aValue:a),this.AD_Window_ID=i.getAD_Window_ID(),this.aAttribute=i.getColumnName(),this.aDisplayAttribute=i.getHeader(),this.aDisplayType=i.getDisplayType(),this.AD_Reference_ID=0,this.windowNum=i.getWindowNo(),"Value".equals(this.aAttribute)||"DocumentNo".equals(this.aAttribute))return null;function r(e){o.css("display",e?"block":"none")}this.AD_Client_ID=e.context.getAD_Client_ID(),this.AD_Org_ID=e.context.getWindowContext(this.windowNum,"AD_Org_ID",!0),this.AD_User_ID=e.context.getAD_User_ID(),this.role=e.MRole.getDefault(),this.load=function(){!function(e){var t='<div class="vis-valpreferencedatawrp" id="fisrt_'+e.windowNum+'"><div class="input-group vis-input-wrap" style="flex: 1;"><div class="vis-control-wrap"><input class="VIS_Pref_pass vis-gc-vpanel-table-readOnly" data-placeholder="" placeholder=" " style="margin-bottom: 0;" type="text" readonly="true" id="vtxtAttribute_'+e.windowNum+'" /><label class=" VIS_Pref_Label_Font" id="vlblAttributeText_'+e.windowNum+'">test</label></div></div><label class="VIS_Pref_Label_Font" id="vlblAttribute_'+e.windowNum+'">test</label></div><div class="vis-valpreferencedatawrp" id="second_'+e.windowNum+'"><div class="input-group vis-input-wrap" style="flex: 1;"><div class="vis-control-wrap"><input class="VIS_Pref_pass vis-gc-vpanel-table-readOnly" data-placeholder="" placeholder=" " style="margin-bottom: 0;" type="text" readonly="true" id="vtxtSearchKey_'+e.windowNum+'" /><label class="VIS_Pref_Label_Font" id="vlblValueText_'+e.windowNum+'">test</label></div></div><label class="VIS_Pref_Label_Font" id="vlblValue_'+e.windowNum+'">test</label></div></div></div><div style="width: 100%; float: left">    <div> <div class="VIS_Pref_col-50"><input  type="checkbox" id="vchkTenant_'+e.windowNum+'" ><label class="VIS_Pref_Label_Font">test</label></div>   <div class="VIS_Pref_col-50"> <input  type="checkbox" id="vchkOrg_'+e.windowNum+'" /><label class="VIS_Pref_Label_Font">test</label></div> <div class="VIS_Pref_col-50"><input  type="checkbox" id="vchkUser_'+e.windowNum+'" /><label class="VIS_Pref_Label_Font">test</label></div>  <div class="VIS_Pref_col-50"> <input  type="checkbox" id="vchkWindow_'+e.windowNum+'" /><label class="VIS_Pref_Label_Font">test</label></div> </div><div id="divMsg_'+e.windowNum+'" style="width: 100%; float: left; margin-bottom: 5px; margin-top: 5px; text-align: left"><label class="VIS_Pref_Label_Font" id="vlblMsg_'+e.windowNum+'">test</label></div><div style="height: 10%; width: 100%; float: left"> <button type="button" id="btnDelete_'+e.windowNum+'"  class="VIS_Pref_btn-2"  style="float: left" value="Ok" role="button" aria-disabled="false"><i class="vis vis-delete"></i></button> <input id= "btnCancel_'+e.windowNum+'" class="VIS_Pref_btn-2" style="float:right" type="button" value="Cancel" /><input id="btnOK_'+e.windowNum+'"  class="VIS_Pref_btn-2" style="float:right; margin-right:10px" type="button" value="Ok" /></div>';l.append(t)}(s),l.append(o),r(!0),s.init(l),r(!1)},this.init=function(i){this.lblAttributeText=l.find("#vlblAttributeText_"+this.windowNum),this.lblValueText=l.find("#vlblValueText_"+this.windowNum),this.lblLevelText=l.find("#vlblLevelText_"+this.windowNum),this.deletebtn=l.find("#btnDelete_"+this.windowNum),this.txtAttribute=l.find("#vtxtAttribute_"+this.windowNum),this.txtSearchKey=l.find("#vtxtSearchKey_"+this.windowNum),this.chkTenant=l.find("#vchkTenant_"+this.windowNum),this.chkOrg=l.find("#vchkOrg_"+this.windowNum),this.chkUser=l.find("#vchkUser_"+this.windowNum),this.chkWindow=l.find("#vchkWindow_"+this.windowNum),this.lblMsg=l.find("#vlblMsg_"+this.windowNum),this.lblAttribute=l.find("#vlblAttribute_"+this.windowNum),this.lblValue=l.find("#vlblValue_"+this.windowNum),this.Okbtn=l.find("#btnOK_"+this.windowNum),this.cancelbtn=l.find("#btnCancel_"+this.windowNum),e.Application.isRTL&&(this.Okbtn.css("margin-right","-128px"),this.cancelbtn.css("margin-right","55px"),this.lblAttributeText.css("text-align","right"),this.lblValueText.css("text-align","right"),this.lblLevelText.css("text-align","right"),this.chkOrg.css("margin-right","0px"),this.chkTenant.css("margin-right","37px"),l.find("#divMsg_"+this.windowNum).css("text-align","right")),this.txtAttribute.val(null==this.aDisplayAttribute?"":this.aDisplayAttribute),this.lblAttribute.text(null==this.aAttribute?"":this.aAttribute),this.txtSearchKey.val(null==this.aDisplayValue?"":e.Utility.decodeText(this.aDisplayValue)),this.lblValue.text(this.aValue),this.lblAttributeText.text(e.Msg.getMsg("Attribute")),this.lblValueText.text(e.Msg.getMsg("SearchKey")),this.lblLevelText.text(e.Msg.getMsg("ValuePreferenceSetFor")),this.chkTenant.next("label").text(e.Msg.getMsg("Tenant")),this.chkOrg.next("label").text(e.Msg.getMsg("Org")),this.chkUser.next("label").text(e.Msg.getMsg("UserContact")),this.chkWindow.next("label").text(e.Msg.getMsg("Window")),this.chkTenant.prop("disabled",!0),this.chkTenant.prop("checked",!0),this.chkUser.prop("checked",!0),this.chkWindow.prop("checked",!0),e.MRole.PREFERENCETYPE_Client.equals(e.MRole.getPreferenceType())||(this.chkOrg.prop("disabled",!0),this.chkOrg.prop("checked",!0)),e.MRole.PREFERENCETYPE_Client.equals(e.MRole.getPreferenceType())||e.MRole.PREFERENCETYPE_Organization.equals(e.MRole.getPreferenceType())||(this.chkUser.prop("disabled",!0),this.chkUser.prop("checked",!0)),this.setExplanation(),this.Okbtn.on("click",(function(){r(!0),s.save(),r(!1),l.dialog("close")})),this.cancelbtn.on("click",(function(){l.dialog("close")})),this.deletebtn.on("click",(function(){s.delete(),l.dialog("close")})),t("[id^=vch]").click((function(){s.setExplanation()}))},this.showDialog=function(){l.append(o),r(!0),setTimeout(this.load(),5),l.dialog({modal:!0,title:e.Msg.getMsg("ValuePreference"),width:530,position:{at:"center top",of:window},close:function(){s.dispose(),l.dialog("destroy"),l=null}})},this.disposeComponent=function(){this.Okbtn&&this.Okbtn.off("click"),this.cancelbtn&&this.cancelbtn.off("click"),this.deletebtn&&this.deletebtn.off("click"),t("[id^=vch]")&&t("[id^=vch]").off("click"),this.Okbtn=null,this.cancelbtn=null,this.deletebtn=null,o=null,s=null,this.disposeComponent=null}}i.prototype.setExplanation=function(){var t="For ";this.chkTenant.prop("checked")&&this.chkOrg.prop("checked")?t+="this Client and Organization":this.chkTenant.prop("checked")&&!this.chkOrg.prop("checked")?t+="all Organizations of this Client":!this.chkTenant.prop("checked")&&this.chkOrg.prop("checked")?(this.chkOrg.prop("checked",!1),t+="entire System"):t+="entire System",this.chkUser.prop("checked")?t+=", this User":t+=", all Users",this.chkWindow.prop("checked")?t+=" and this Window":t+=" and all Windows",e.Env.isBaseLanguage()&&this.lblMsg.text(t.toString()),this.orgchk=this.chkOrg.prop("checked"),this.userchk=this.chkUser.prop("checked"),this.windowchk=this.chkWindow.prop("checked"),this.tenantchk=this.chkTenant.prop("checked")},i.prototype.getADPreferenceID=function(){var t="",i=this.tenantchk?this.AD_Client_ID:0;t+="AD_Client_ID="+i,t+=" AND AD_Org_ID="+(i=this.orgchk?this.AD_Org_ID:0),this.userchk?t+=" AND AD_User_ID="+this.AD_User_ID:t+=" AND AD_User_ID IS NULL",this.windowchk?t+=" AND AD_Window_ID="+this.AD_Window_ID:t+=" AND AD_Window_ID IS NULL",t+=" AND Attribute='"+this.aAttribute+"'";var n=0;t=e.secureEngine.encrypt(t);var a=e.dataContext.getJSONData(e.Application.contextUrl+"ValuePreference/GetPrefrenceID",{sql:t},null);return a>0&&(n=e.Utility.Util.getValueOfInt(a)),n},i.prototype.delete=function(){var i=!1,n=this.getADPreferenceID(),a=this;return n>0?t.ajax({url:e.Application.contextUrl+"ValuePreference/Delete",dataType:"json",data:{preferenceId:n},success:function(t){(i=t.result)&&(e.Env.getCtx().setContext(a.getContextKey(),null),e.ADialog.info("ValuePreferenceDeleted",!0,"",null))}}):e.ADialog.warn("ValuePreferenceNotFound",!0,"",null),i},i.prototype.save=function(){if(null==this.aValue)if(e.DisplayType.IsLookup(this.displayType))this.aValue="-1";else{if(!e.DisplayType.IsDate(this.displayType))return e.ADialog.warn("ValuePreferenceNotInserted",!0,"",null),!1;this.aValue=" "}else if(-1!=this.aValue.toString().indexOf("@"))return!1;var i=!1;this.orgchk=this.chkOrg.prop("checked"),this.userchk=this.chkUser.prop("checked"),this.windowchk=this.chkWindow.prop("checked"),this.tenantchk=this.chkTenant.prop("checked");var n=this,a=this.getADPreferenceID();return t.ajax({url:e.Application.contextUrl+"ValuePreference/Save",dataType:"json",data:{preferenceId:a,clientId:this.tenantchk?this.AD_Client_ID:0,orgId:this.orgchk?this.AD_Org_ID:0,chkWindow:this.windowchk,AD_Window_ID:this.AD_Window_ID,chkUser:this.userchk,attribute:this.aAttribute,userId:this.AD_User_ID,value:this.aValue},success:function(t){(i=t.result)?(e.Env.getCtx().setContext(n.getContextKey(),n.aValue),e.ADialog.info("ValuePreferenceInserted",!0,"",null)):e.ADialog.warn("ValuePreferenceNotInserted",!0,"",null)}}),i},i.prototype.getContextKey=function(){return this.windowchk?"P"+this.AD_Window_ID+"|"+this.aAttribute:"P|"+this.aAttribute},i.prototype.dispose=function(){this.disposeComponent()},e.ValuePreference=i}(VIS,jQuery)},5344:()=>{!function(e,t){e.VDocAction=function(i,n,a){var s=e.Env.getCtx(),l=n.getAD_Table_ID(),o=[],r=[],d=[],c=null;this.log=e.Logging.VLogger.getVLogger("VDocAction");var p=t('<select class="vis-select-docAction"></select>'),u=t('<p style="font-size:12px;margin-bottom:-5px"></p>'),g=t('<div style="margin-bottom:-5px"></div>'),h=this;this.batch=!1,this.isOKPressed=!1;var v=t('<table style="width:360px;margin-bottom:9px">'),f=null;this.onClose=null;var m=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),y=t("<label>"+e.Msg.getMsg("Loading")+"</label>");function I(e){e?(m.show(),y.show(),g.find("button").prop("disabled",!0)):(m.hide(),y.hide(),g.find("button").prop("disabled",!1))}function D(){var e=-1;if(null==p.val())return e;for(var t=p.val(),i=0;i<r.length&&-1==e;i++)if(t.equals(r[i])){e=i;break}return e}e.Application.isRTL,function(){var i=t("<tr>"),n=t("<tr>"),a=t("<tr>"),s=t("<td>"),l=(t("<td>"),t("<div class='input-group vis-input-wrap'></div>")),o=t("<div class='vis-control-wrap'></div>");s.append(l),l.append(o),o.append(p),o.append("<label >"+e.Msg.getMsg("DocAction")+"</label>"),i.append(s);var r=t("<td>");r.append(u),n.append(r),$td31=t("<td>"),$td32=t('<td style="text-align:right">'),a.append($td31).append($td32),v.append(i).append(n).append(a),g.append(v),I(!0),g.append(m).append(y),f=new e.ChildDialog}(),p.on("change",(function(){var e=D();-1!=e&&d.length>0&&u.text(d[e])})),f.onOkClick=function(){(function(){I(!0);var i=D();if(-1==i)return I(!1),!1;var s=n.getAD_Window_ID(),l=n.getAD_Tab_ID(),r=o[i];if(n.getHasPanel()){for(var d=n.getTabPanels(),c=!1,p=0;p<d.length;p++)"VIS.SurveyPanel"==d[p].getClassName()&&(c=!0,p=d.length);if(c){var u=!1;return t.ajax({type:"POST",url:e.Application.contextUrl+"VIS/SurveyPanel/CheckDocActionCheckListResponse",dataType:"json",async:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify({AD_Window_ID:s,AD_Tab_ID:l,Record_ID:a,DocAction:r,AD_Table_ID:n.getAD_Table_ID()}),success:function(t){"false"==t?(e.ADialog.error("CheckListRequired"),u=!1):(n.setValue("DocAction",r),u=!0)},error:function(e){}}),u}return n.setValue("DocAction",r),!0}return n.setValue("DocAction",r),!0})()&&(h.isOKPressed=!0,h.onClose&&h.onClose())},f.onCancelClick=function(){h.onClose&&h.onClose()},function(){var t="VIS",i=[],n=[],a=[];try{var s=e.dataContext.getJSONData(e.Application.contextUrl+"DocAction/GetReference",{RefQry:t},null);if(null!=s)for(var l in s){var c=s[l].Value,p=s[l].Name,u=s[l].Description;null!=u&&"undefined"!=u||(u=""),i.push(c),n.push(p),a.push(u)}}catch(e){console.log(e)}var g=i.length;for(o=[],r=[],d=[],l=0;l<g;l++)o.push(i[l]),r.push(n[l]),d.push(a[l])}(),function(a){c=n.getValue("DocStatus");var d=n.getValue("DocAction"),v=n.getValue("Processing");v=!("N"==v||!v);var m=s.getWindowContext(i,"OrderType"),y=s.isSOTrx(i);t.ajax({url:e.Application.contextUrl+"DocAction/GetDocActions",type:"POST",dataType:"Json",data:{AD_Table_ID:l,Record_ID:a,docStatus:c,processing:v,orderType:m,isSOTrx:y,docAction:d,tableName:n.getTableName(),values:JSON.stringify(o),names:JSON.stringify(r),C_DocType_ID:n.getValue("C_DocType_ID"),C_DocTypeTarget_ID:n.getValue("C_DocTypeTarget_ID")},success:function(t){var i=JSON.parse(t);!function(t){I(!1),c=t.DocStatus,null==t.Error||""==t.Error||"undefined"==t.Error?null==t.DocStatus&&u.text("*** ERROR ***"):e.ADialog.error(t.Error)}(i),function(t){for(var i=0;i<t.Index;i++)for(var n=!1,a=0;a<o.length&&!n;a++)t.Options[i]&&t.Options[i].equals(o[a])&&(p.append("<option >"+r[a]+"</option>"),n=!0);null!=t.DefaultV&&""!=t.DefaultV&&"undefined"!=t.DefaultV&&p.val(t.DefaultV).change(),g.prop("disable",!1),0==h.getNumberOfOptions()&&(e.ADialog.info("InfoDocActionNoOptions",""),h.log.info("DocAction - No Options"),f.close())}(i)}})}(a),this.getNumberOfOptions=function(){return p.children("option").length},this.isStartProcess=function(){return this.isOKPressed},this.isBatch=function(){return this.batch},this.show=function(){f.setContent(g),f.setTitle(e.Msg.getMsg("DocAction")),f.setModal(!0),f.show()},f.onClose=function(){h.dispose()},this.dispose=function(){f.close(),f=null,l=null,o=null,r=null,d=null,c=null,0,null,null,p=null,u=null,g=null,h=null,v&&v.empty(),v=null}},e.DocumentEngine=function(){this.ACTION_COMPLETE="CO",this.ACTION_WAITCOMPLETE="WC",this.ACTION_APPROVE="AP",this.ACTION_REJECT="RJ",this.ACTION_POST="PO",this.ACTION_VOID="VO",this.ACTION_CLOSE="CL",this.ACTION_REVERSE_CORRECT="RC",this.ACTION_REVERSE_ACCRUAL="RA",this.ACTION_REACTIVATE="RE",this.ACTION_NONE="--",this.ACTION_PREPARE="PR",this.ACTION_UNLOCK="XL",this.ACTION_INVALIDATE="IN",this.ACTION_REOPEN="OP",this.STATUS_DRAFTED="DR",this.STATUS_COMPLETED="CO",this.STATUS_APPROVED="AP",this.STATUS_INVALID="IN",this.STATUS_NOTAPPROVED="NA",this.STATUS_VOIDED="VO",this.STATUS_REVERSED="RE",this.STATUS_CLOSED="CL",this.STATUS_UNKNOWN="??",this.STATUS_INPROGRESS="IP",this.STATUS_WAITINGPAYMENT="WP",this.STATUS_WAITINGCONFIRMATION="WC"}}(VIS,jQuery)},7511:()=>{!function(e,t){function i(i,n){var a=this,s=t("<div>"),l=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),o=e.Env.getWindowNo(),r=null,d=null,c=null;this.onClose=null;var p=null,u=null,g=null,h=null,v=!1,f=null,m=null;null!=i&&"null"!=i||(i=0);var y=function(t){r=s.find("#btnOk_"+o),d=s.find("#btnCancel_"+o),c=s.find("#btnImgDelete_"+o),i>0?c.css("display","inline-block"):c.css("display","none"),p=t.find("#fileUpload_"+o),u=t.find("#holderDiv_"+o),g=t.find("#imgUsrImage_"+o),u.css("width",f-48),m>180&&u.css("height",m-180),n>0?g.hide():g[0].width>300&&u.css("overflow","auto"),t.find("#lblfileUpload_"+o),h=t.find("#chkDataBaseSave_"+o),p.on("change",(function(){var t=p[0].files[0],i=new FileReader;return/(\.jpg|\.png|\.ico|\.webp|\.svg|\.jpeg|\.jfif)$/i.exec(t.name)?(g.show(),i.onload=function(e){g.removeAttr("src").attr("src",e.target.result)},i.readAsDataURL(t),v=!0,i=null,t=null,!1):(e.ADialog.warn("SelectImageOnly"),p.val(""),g.hide(),!1)})),h.on("change",(function(){return v=!0,!1})),r.on("click",(function(){if(v){var t=new XMLHttpRequest,n=new FormData;n.append("file",p[0].files[0]),n.append("isDatabaseSave",h.prop("checked")),n.append("ad_image_id",0),t.open("POST",e.Application.contextUrl+"VImageForm/SaveImage",!0),t.send(n),t.addEventListener("load",(function(e){var i=e.target.response,l=(i=JSON.parse(i)).result;a.onClose&&a.onClose(l,v),t=null,n=null,s.dialog("close")}),!1)}else a.onClose&&a.onClose(i,v),s.dialog("close")})),d.on("click",(function(){s.dialog("close")})),c.on("click",(function(){v=!0;var t=new XMLHttpRequest,n=new FormData;n.append("ad_image_id",i),t.open("POST",e.Application.contextUrl+"VImageForm/DeleteImage",!0),t.send(n),t.addEventListener("load",(function(e){var i=e.target.response,l=(i=JSON.parse(i)).result;a.onClose&&a.onClose(l,v),t=null,n=null,s.dialog("close")}),!1)}))};this.showDialog=function(){s.load(e.Application.contextUrl+"VImageForm/Index/?windowno="+o+"&ad_image_id="+i,(function(e){l[0].style.visibility="visible",y(s),l[0].style.visibility="hidden"})),f=t(window).width()-150,m=t(window).height()-40,l.height(m),l.width(f),s.append(l),s.dialog({modal:!0,title:e.Msg.getMsg("ImageDialog"),width:f,height:m,position:{at:"center top",of:window},close:function(){a.dispose(),a=null,s.dialog("destroy"),s=null}})},this.disposeComponent=function(){a=null,r&&r.off("click"),d&&d.off("click"),c&&c.off("click"),l=null,o=null,r=null,d=null,c=null,null,p=null,u=null,g=null,null,h=null,v=!1,f=null,m=null,this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()},e.VImageForm=i}(VIS,jQuery)},9468:()=>{!function(e,t){e.VisImportFiles=function(i){var n,a,s,l,o,r,d,c,p,u,g,h,v;this.onClose=null;var f=this,m=!1,y=0,I=Date.now().toString()+"_FileCtrl",D=1048576,w=0,b=[];function C(){m||(I=""),f.onClose(I),A()}!function(i){n=t("<div style='overflow: hidden;'>"),a=t('<div class="vis-apanel-busy" style="width: 96%; height: 97%; text-align: center; position: absolute; visibility: hidden;"></div>'),s=t('<div style="display: inline-block; float: left;width:99%;height:auto;margin-top: 2px;">'),l=t('<div style="padding-left: 7px;height:88.9%;display: inline-block; float: left;width:100%;height:87.8%;">'),g=t("<button class='vis-initial-btn vis-initial-btn-blue' style='border: none;'>"+e.Msg.getMsg("SelectFile")+"</button>"),h=t("<div class='VIS-form-data' style='width: 100%;height:200px;border: 1px solid #ccc;margin-top: 11px;padding: 10px;overflow:auto;'>"),o=t('<div style="display: inline-block; float: left;width:100%;height:auto;margin-top: 2px;">'),v=t("<div style='float: left;'>"),r=t('<div style="float:right;">');var f=e.Msg.getMsg("Cancel");f.indexOf("&")>-1&&(f=f.replace("&",""));var m=e.Msg.getMsg("Ok");m.indexOf("&")>-1&&(m=m.replace("&","")),d=t("<button class='VIS_Pref_btn-2' style='margin-top: 5px;margin-bottom: -10px;'>").append(f),c=t("<button class='VIS_Pref_btn-2' disabled='true' style='margin-top: 5px;margin-bottom: -10px;margin-right:5px'>").append(m),u=t(i?"<input type='file' multiple='true'>":"<input type='file'>"),l.append(g),l.append(h),s.append(l),o.append(v),r.append(d),r.append(c),o.append(r),s.append(o),n.append(s),n.append(a),p=[]}(i),d.on("click",(function(){m=!1,A()})),c.on("click",(function(){S()})),g.on("click",(function(){u.val(""),u.trigger("click")})),u.on("change",(function(){_(this)})),this.show=function(){n.dialog({width:500,height:377,resizable:!1,modal:!0,title:e.Msg.getMsg("Upload"),close:C})};var _=function(i){for(var n=[],a=0;a<i.files.length;a++){if(file=i.files[a],null==file)return;if(file.name.indexOf("&")>-1||file.name.indexOf("?")>-1||file.name.indexOf("#")>-1||file.name.indexOf("/")>-1||file.name.indexOf("\\")>-1)n.push(file.name);else{for(var s in p)if(file.name==p[s].name)return void window.setTimeout((function(){e.ADialog.info("fileAlreadyAttached")}),20);var l={};if(l.Name=file.name,l.Size=file.size,!(l.Size>17e6)){p.push(file);var o=t("<div class='VIS-file-wrap'>"),r=t("<p>"+l.Name+"</p>"),d=p.length-1,u=t("<span class='vis vis-mark VIS-close-ico mychoice_"+d+"'  data-index='"+d+"'>");u.on("click",(function(){var e=t(this).parent();if(e){var i=e.children()[0];if(i){var n=p.map((function(e){return e.name==t(i).text()})).indexOf(!0);p.splice(n,1),e.remove()}}0==p.length?c.attr("disabled","true"):c.removeAttr("disabled")})),o.append(r),o.append(u),h.append(o),0==p.length?c.attr("disabled","true"):c.removeAttr("disabled")}}}if(n.length>0){var g="";for(var v in n)g+=n[v].toString()+"\n";1==n.length?g+="File has":g+="Files have",g+=" "+e.Msg.getMsg("VIS_InvalidName")+" "+e.Msg.getMsg("VIS_ChangeFileName"),e.ADialog.info(g)}},S=function(){a[0].style.visibility="visible";var e=null,t=0;for(var i in p)t=parseInt(p[i].size/D),file.size%D>0&&t++,t,(e={}).Name=p[i].name,e.Size=p[i].size,b.push(e);x()},x=function(){if(null==p||0==p.length)return e.ADialog.info("NothingToUpload"),a[0].style.visibility="hidden",!1;if(y>=p.length)return a[0].style.visibility="hidden",m=!0,n.dialog("close"),!0;var t=new XMLHttpRequest,i=new FormData;i.append("file",p[y].slice(w*D,w*D+Number(D))),t.open("POST",e.Application.contextUrl+"Attachment/SaveFileinTemp/?filename="+p[y].name+"&folderKey="+I,!1),t.send(i),w++;var s=parseInt(p[y].size/D);p[y].size%D>0&&s++,w==s&&(y++,w=0),window.setTimeout((function(){x()}),2)},A=function(){d.off("click"),c.off("click"),a=s=l=o=r=d=c=null,p=u=g=h=v=null,y=I=D=w=b=null,_=S=x=loadTables=loadLanguage=loadEDL=loadExportScope=null,null!=n&&(n.dialog("destroy"),n.remove()),n=null}}}(VIS,jQuery)},7358:()=>{!function(e,t){e.VPayment=function(i,n,a){var s=this,l=e.Env.getCtx(),o=!1,r=e.context.isSOTrx(i),d=null,c="",p=0,u=null,g=0,h=0,v=0,f=0;this.log=e.Logging.VLogger.getVLogger("vPayment");var m,y,I,D,w,b,C,_,S,x,A,T,V,N,M,k,O,L,R,E,P,U,F,B,W,j,G,q,H,z,Q,J,$,K,Y,X,Z,ee,te,ie,ne,ae,se,le,oe,re,de,ce,pe,ue,ge=0,he=0,ve=0,fe={},me="B",ye="D",Ie="K",De="P",we="S",be="T",Ce="A",_e="D",Se="K",xe=!1,Ae=null;this.onClose=null;var Te=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i><label>'+e.Msg.getMsg("Loading")+"</label></div></div>");function Ve(e){var t=q.val();if(null!=t){var i=t.toLower();ye!=i.toLower()&&ye!=i.toUpper()||(i=be.toLower()),i+="Panel",t.equals("K")?(I.show(),b.hide(),y.hide(),D.hide(),w.hide()):t.equals("B")?(I.hide(),b.hide(),y.show(),D.hide(),w.hide()):t.equals("D")?(I.hide(),b.hide(),y.hide(),D.show(),w.hide()):t.equals("P")?(I.hide(),b.show(),y.hide(),D.hide(),w.hide()):t.equals("S")?(I.hide(),b.hide(),y.hide(),D.hide(),w.show()):t.equals("T")&&(I.hide(),b.hide(),y.hide(),D.hide(),w.hide())}}function Ne(e){}function Me(e){}function ke(e){}function Oe(e){e?(Te.show(),m.find("button").prop("disabled",!0)):(Te.hide(),m.find("button").prop("disabled",!1))}this.init=function(){!function(){var i=t('<div class="input-group vis-input-wrap"></div>'),n=t('<div class="vis-control-wrap"></div>'),a=null;a=t('<label class="vis-payment-spanPayment"> '+e.Msg.translate(l,"PaymentMethod")+" </label>"),i.append(n),(q=t('<select class="vis-payment-cmbPayment"></select>')).appendTo(n),a.appendTo(n),i.appendTo(m),oe=t('<table class="vis-payment-table"></table>');var s=t("<tr></tr>");oe.append(s),N=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"CreditCardType")+"</label>"),M=t('<label class="vis-payment-span">'+e.Msg.translate(l,"CreditCardNumber")+"</label>"),k=t('<label class="vis-payment-span">'+e.Msg.translate(l,"Expires")+"</label>"),L=t('<label class="vis-payment-span">'+e.Msg.translate(l,"VoiceAuthCode")+"</label>"),X=t('<label class="vis-payment-span">'+e.Msg.translate(l,"Online")+"</label>"),C=t('<label class="vis-payment-span"></label>'),I=t('<table class="vis-payment-table"></table>');var o=t("<tr></tr>");I.append(o),ce=t('<table class="vis-payment-table"></table>'),o.append(ce),s.append(I),H=t('<select  class="vis-payment-cmb"></select>');var r=t("<tr></tr>"),d=t('<td class="vis-payment-td2"></td>'),c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(H),Ge.append(N),r.append(d),d.append(c),c.append(Ge),ce.append(r),ee=t('<input class="vis-payment-inputs" type="text" placeholder=" " data-placeholder="" >');var p=t("<tr></tr>"),u=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(ee),Ge.append(M),p.append(u),u.append(c),c.append(Ge),ce.append(p),te=t('<input class="vis-payment-inputs"  type="text" placeholder=" " data-placeholder="" >');var g=t("<tr></tr>"),h=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(te),Ge.append(k),g.append(h),h.append(c),c.append(Ge),ce.append(g),ie=t('<input class="vis-payment-inputs"  type="text" placeholder=" " data-placeholder="" >');var v=t("<tr></tr>"),f=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(ie),Ge.append(L),v.append(f),f.append(c),c.append(Ge),ce.append(v),X=t('<button class="vis-payment-inputs-buttons"  type="button">'+e.Msg.translate(l,"Online")+"</button>");var ge=t("<tr></tr>"),he=t("<td></td>");he.append(X),ge.append(he),ce.append(ge),O=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"C_BP_BankAccount_ID")+"</label>"),_=t('<p class="vis-payment-span"> </p>'),D=t('<table class="vis-payment-table"></table>');var ve=t("<tr></tr>");pe=t('<table class="vis-payment-table"></table>'),D.append(ve),ve.append(pe),s.append(D),z=t('<select class="vis-payment-cmb"></select>');var fe=t("<tr></tr>"),me=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(z),Ge.append(O),fe.append(me),me.append(c),c.append(Ge),pe.append(fe),j=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"C_BankAccount_ID")+"</label>"),T=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"Amount")+"</label>"),V=t('<label class="vis-payment-span vis-payment-AmountField"> </label>'),E=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"RoutingNo")+"</label>"),R=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"AccountNo")+"</label>"),W=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"CheckNo")+"</label>"),P=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"C_Currency_ID")+"</label>"),S=t('<p class="vis-payment-span"> </p>'),Z=t('<button class="vis-payment-inputs-buttons"  type="button">'+e.Msg.translate(l,"Online")+"</button>"),w=t('<table class="vis-payment-table"></table>');var ye=t("<tr></tr>");ue=t('<table class="vis-payment-table"></table>'),ye.append(ue),w.append(ye),s.append(w),K=t('<select class="vis-payment-cmb"></select>');var Ie=t("<tr></tr>"),De=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(K),Ge.append(j),Ie.append(De),De.append(c),c.append(Ge),ue.append(Ie),V=t('<input type="text" readonly class="vis-payment-span vis-payment-AmountField">');var we=t("<tr></tr>"),be=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(V),Ge.append(T),we.append(be),be.append(c),c.append(Ge),ue.append(we),ae=t('<input class="vis-payment-inputs" type="text" placeholder=" " data-placeholder="" >');var Ce=t("<tr></tr>"),_e=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(ae),Ge.append(E),Ce.append(_e),_e.append(c),c.append(Ge),ue.append(Ce),ne=t('<input class="vis-payment-inputs" type="text" placeholder=" " data-placeholder="" >');var Se=t("<tr></tr>"),xe=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(ne),Ge.append(R),Se.append(xe),xe.append(c),c.append(Ge),ue.append(Se),se=t('<input class="vis-payment-inputs"  type="text" placeholder=" " data-placeholder="" >');var Ae=t("<tr></tr>"),Te=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(se),Ge.append(W),Ae.append(Te),Te.append(c),c.append(Ge),ue.append(Ae),Q=t('<select class="vis-payment-cmb"></select>');var Ve=t("<tr></tr>"),Ne=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(Q),Ge.append(P),Ve.append(Ne),Ne.append(c),c.append(Ge),ue.append(Ve),Z=t('<button class="vis-payment-inputs-buttons"  type="button">'+e.Msg.translate(l,"Online")+"</button>");var Me=t("<tr></tr>"),ke=t('<td colspan="2"></td>');ke.append(Z),Me.append(ke),ue.append(Me),F=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"C_PaymentTerm_ID")+"</label>"),b=t('<table  class="vis-payment-table"></table>');var Oe=t("<tr></tr>");de=t('<table  class="vis-payment-table"></table>'),Oe.append(de),b.append(Oe),s.append(b),$=t('<select class="vis-payment-cmb"></select>');var Le=t("<tr></tr>"),Re=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append($),Ge.append(F),Le.append(Re),Re.append(c),c.append(Ge),de.append(Le),G=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"C_CashBook_ID")+"</label>"),U=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"C_Currency_ID")+"</label>"),x=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"Amount")+"</label>"),A=t('<label class="vis-payment-span vis-payment-AmountField"> </label>'),B=t('<label class="vis-payment-span"> '+e.Msg.translate(l,"DateAcct")+"</label>"),y=t('<table class="vis-payment-table"></table>');var Ee=t("<tr></tr>");re=t('<table class="vis-payment-table"></table>'),Ee.append(re),y.append(Ee),s.append(y),J=t('<select class="vis-payment-cmb"></select>');var Pe=t("<tr></tr>"),Ue=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(J),Ge.append(U),Pe.append(Ue),Ue.append(c),c.append(Ge),re.append(Pe),Y=t('<select class="vis-payment-cmb"></select>');var Fe=t("<tr></tr>"),Be=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(Y),Ge.append(G),Fe.append(Be),Be.append(c),c.append(Ge),re.append(Fe),le=t('<input class="vis-payment-inputs vis-payment-date" type="date" placeholder=" " data-placeholder="" >');var We=t("<tr></tr>"),je=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(le),Ge.append(B),We.append(je),je.append(c),c.append(Ge),re.append(We),A=t('<input type="text" readonly class="vis-payment-span vis-payment-AmountField"> ');var Ge,qe=t("<tr></tr>"),He=t('<td class="vis-payment-td2"></td>');c=t('<div class="input-group vis-input-wrap">');(Ge=t('<div class="vis-control-wrap">')).append(A),Ge.append(x),qe.append(He),He.append(c),c.append(Ge),re.append(qe),m.append(oe)}(),function(a){if(null!=a&&!a)return void Ae.close();q.on("change",Ve),Q.on("change",Ne),J.on("change",Me),X.on("click",ke),Ae.onOkClick=function(){Oe(!0),function(){var a=!0;if(!function(){var t=!0;try{var i=q.val();if(null==i||null==i)return!1;var n=i;if(xe)return!0;var a=0;if(n.equals(me))Y.val(),le.val();else if(n.equals(Ie))H.val(),null!=ee.val()&&""!=ee.val()&&null!=ee.val()||(e.ADialog.error("",!0,e.Msg.getMsg("CreditCardNumberError")),t=!1);else if(n.equals(be)||n.equals(ye)){null==z.val()&&(e.ADialog.error("",!0,e.Msg.getMsg("PaymentBPBankNotFound")),t=!1)}else if(n.equals(De))$.val(),null!=s&&s;else{if(!n.equals(we))return!1;var s=K.val();null!=s&&(a=s),null!=ae.val()&&""!=ae.val()&&null!=ae.val()||(e.ADialog.error("",!0,e.Msg.getMsg("PaymentBankRoutingNotValid")),t=!1),null!=ne.val()&&""!=ne.val()&&null!=ne.val()||(e.ADialog.error("",!0,e.Msg.getMsg("PaymentBankAccountNotValid")),t=!1),null!=se.val()&&""!=se.val()&&null!=se.val()||(e.ADialog.error("",!0,e.Msg.getMsg("PaymentBankCheckNotValid")),t=!1)}if(-1!="KTSD".indexOf(n)&&0==a){n.equals(be)?Ce:n.equals(ye)?_e:n.equals(we)&&Se,0==a&&"S".equals(n)&&(e.ADialog.error("",!0,e.Msg.getMsg("PaymentNoProcessor")),t=!1)}}catch(e){log.Severe(e.ToString())}return t}())return a=!1;var s=q.val();if(null==s)return;if(xe&&s)return s.equals(c)||n.setValue("PaymentRule",s),a=!0;fe.cmbPayment=q.val(),s.equals(me)?(fe.cmbBCurrency=J.val(),fe.cmbBCashBook=Y.val(),fe.bDateField=le.val()):s.equals(Ie)?(fe.cmbKType=H.val(),fe.txtKNumber=ee.val(),fe.txtKExp=te.val(),fe.txtKApproval=ie.val()):s.equals(be)?fe.cmbTAccount=z.val():s.equals(De)?fe.cmbPTerm=$.val():s.equals(we)&&(fe.cmbSBankAccount=K.val(),fe.txtSRouting=ae.val(),fe.txtSNumber=ne.val(),fe.txtSCheck=se.val(),fe.cmbSCurrency=Q.val());return fe.C_Order_ID=l.getContextAsInt(i,"C_Order_ID"),fe.C_Invoice_ID=l.getContextAsInt(i,"C_Invoice_ID"),t.ajax({url:e.Application.contextUrl+"PaymentRule/SaveChanges",type:"POST",async:!1,dataType:"Json",data:fe,success:function(e){var t=JSON.parse(e);return null!=t.ErrorMsg&&""!=t.ErrorMsg&&null!=t.ErrorMsg&&alert(t.ErrorMsg),null!=t.SucessMsg&&""!=t.SucessMsg&&null!=t.SucessMsg&&alert(t.SucessMsg),null==t.newPaymentRule||null==t.newPaymentRule||t.newPaymentRule.equals(c)||n.setValue("PaymentRule",t.newPaymentRule),null==t.newDateAcct||null==t.newDateAcct||t.newDateAcct.equals(u)||n.setValue("DateAcct",t.newDateAcct),t.newC_PaymentTerm_ID!=g&&t.newC_PaymentTerm_ID>0&&n.setValue("C_PaymentTerm_ID",t.newC_PaymentTerm_ID),t._C_Payment_ID!=h&&(0==t._C_Payment_ID?n.setValue("C_Payment_ID",null):n.setValue("C_Payment_ID",t._C_Payment_ID)),t._C_CashLine_ID!=v&&(0==t._C_CashLine_ID?n.setValue("C_CashLine_ID",null):n.setValue("C_CashLine_ID",t._C_CashLine_ID)),a=!0},error:function(){return a=!1}}),a}()&&(s.isOKPressed=!0,s.onClose&&s.onClose())},Ae.onCancelClick=function(){s.onClose&&s.onClose()},Ae.onClose=function(){s.dispose()}}(o=function(i){var s=!1;if(d=n.getValue("DocStatus"),null==n.getValue("C_BPartner_ID"))return e.ADialog.error("0",!0,e.Msg.getMsg("SaveErrorRowNotFound")),s=!1;null==(d=n.getValue("DocStatus"))&&(d="");if(d.equals("RE")||d.equals("VO")||d.equals("CL"))return s=!1;xe=!d.equals("CO")&&!d.equals("WP");xe||r||null==n.getValue("M_Warehouse_ID")||(xe=!0);xe?oe.hide():oe.show();if(_Amount=n.getValue("GrandTotal"),!xe&&0==_Amount)return e.ADialog.error("",!0,e.Msg.getMsg("PaymentZero")),s=!1;ge=parseInt(n.getValue("AD_Client_ID")),he=parseInt(n.getValue("AD_Org_ID")),ve=parseInt(n.getValue("C_BPartner_ID")),c=n.getValue("PaymentRule"),p=parseInt(n.getValue("C_Currency_ID")),u=n.getValue("DateAcct"),(null!=n.getValue("C_PaymentTerm_ID")||n.getValue("C_PaymentTerm_ID")!={})&&(g=parseInt(n.getValue("C_PaymentTerm_ID")));null!=n.getValue("C_Payment_ID")&&n.getValue("C_Payment_ID")!={}&&(h=parseInt(n.getValue("C_Payment_ID")));null!=n.getValue("C_CashLine_ID")&&n.getValue("C_CashLine_ID")!={}&&(v=parseInt(n.getValue("C_CashLine_ID")));return fe={_DocStatus:d,_isSOTrx:r,_AD_Client_ID:ge,_AD_Org_ID:he,_C_BPartner_ID:ve,_PaymentRule:c,_C_Currency_ID:p,_DateAcct:u,_C_PaymentTerm_ID:g,_C_Payment_ID:h,_C_CashLine_ID:v,values:JSON.stringify(i),_Amount},t.ajax({url:e.Application.contextUrl+"PaymentRule/LoadPaymentMethodDetails",type:"POST",async:!1,dataType:"Json",data:fe,success:function(e){Oe(!1);var i=JSON.parse(e);i.CCType,xe?oe.hide():oe.show(),A.val(_Amount),V.val(_Amount),ee.val(i.strKNumber),te.val(i.strKExp),ie.val(i.strKApproval),C.val(i.strKStatus),i.canChange&&(H.attr("disable",!1),ee.attr("disable",!1),te.attr("disable",!1),ie.attr("disable",!1),X.attr("disable",!1)),ae.val(i.StrSRouting),ne.val(i.StrSNumber),se.val(i.StrSCheck),S.text(i.StrSStatus),_.text(i.StrTStatus),null!=u&&(le.Value=u);for(var n in null!=i._Currencies&&null!=i._Currencies&&i._Currencies[p]?(t.each(i._Currencies,(function(e,i){Q.append(t("<option></option>").attr("value",i.Key).text(i.Name))})),t.each(i._Currencies,(function(e,i){J.append(t("<option></option>").attr("value",i.Key).text(i.Name))}))):(U.hide(),J.hide(),P.hide(),Q.hide()),null==c&&(c=""),a.values){var l=n;ye.equals(l)&&!r||(be.equals(l)&&r||(q.append(t('<option value="'+l+'">'+a.values[n]+"</option>")),l.equals(c)&&q.val(l)))}return null!=i.loadPaymentTerms&&null!=i.loadPaymentTerms&&(t.each(i.loadPaymentTerms,(function(e,i){$.append(t("<option></option>").attr("value",i.Key).text(i.Name))})),null!=g&&null!=g&&$.val(g)),null!=i.loadAccounts&&null!=i.loadAccounts&&(t.each(i.loadAccounts,(function(e,i){z.append(t("<option></option>").attr("value",i.Key).text(i.Name))})),null!=i.kp&&z.val(i.kp)),null!=i.ccs&&null!=i.ccs&&(t.each(i.ccs,(function(e,i){H.append(t("<option></option>").attr("value",i.Key).text(i.Name))})),null!=i.CCType&&H.val(i.CCType)),null!=i.loadBankAccounts&&null!=i.loadBankAccounts&&(t.each(i.loadBankAccounts,(function(e,i){K.append(t("<option></option>").attr("value",i.Key).text(i.Name))})),null!=i.kp&&K.val(i.kp)),null!=i.Checkbook_ID&&K.val(i.Checkbook_ID),null!=i.loadCashBooks&&null!=i.loadCashBooks&&t.each(i.loadCashBooks,(function(e,i){Y.append(t("<option></option>").attr("value",i.Key).text(i.Name))})),null!=i.Checkbook_ID&&(Y.val(i.Checkbook_ID),0==f&&(f=i.Checkbook_ID)),"B"==c?(I.hide(),b.hide(),y.show(),D.hide(),w.hide()):"K"==c?(I.show(),b.hide(),y.hide(),D.hide(),w.hide()):"D"==c?(I.hide(),b.hide(),y.hide(),D.show(),w.hide()):"P"==c?(I.hide(),b.show(),y.hide(),D.hide(),w.hide()):"S"==c&&(I.hide(),b.hide(),y.hide(),D.hide(),w.show()),s=!0}}),s}(a.values))},this.isInitOK=function(){return o},this.show=function(){Ae=new e.ChildDialog,(m=t('<div class="vis-formouterwrpdiv"></div>')).append(Te),Oe(!0),Ae.setContent(m),Ae.setWidth(360),Ae.setTitle(e.Msg.getMsg("Payment")),Ae.setModal(!0),Ae.show()},this.onClose=null,this.dispose=function(){null!=m&&(m=null),Ae=null,y=null,I=null,D=null,w=null,b=null,this.onClose=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,null,N=null,M=null,k=null,O=null,L=null,R=null,E=null,P=null,U=null,F=null,B=null,W=null,j=null,G=null,q=null,H=null,z=null,Q=null,J=null,$=null,K=null,Y=null,X=null,Z=null,ee=null,te=null,ie=null,ne=null,ae=null,se=null,le=null,re=null,de=null,null,ce=null,pe=null,ue=null}}}(VIS,jQuery)},2869:()=>{!function(e,t){function i(){var i=e.Application.contextFullUrl;if(i||(i=e.Application.contextUrl),i&&i.toString().toLowerCase().indexOf("softwareonthecloud.com")>-1)e.ADialog.info("VIS_GotoControlPanel",!0,"","");else{var n=t("<div class='vis-forms-container' style='height:100%'>"),a=t("<div class='vis-its-main-wrap vis-pull-left'>"),s=t("<div style='height:100%'>");n.append(s),s.append(a);var l=t("<div class='vis-its-ryt-panel vis-pull-right' >"),o=t("<div class='vis-its-ryt-panel-inner vis-pull-left' >"),r=t('<a href="javascript:void(o)"  style="display:none;" class="vis-initial-btn vis-initial-btn-blue">').append(t("<i class='vis vis-save'></i>"));s.append(l),l.append(o).append(r),o.append(t("<h3>").append(e.Msg.getMsg("Result")));var d=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),c=(e.Env.getWindowNo(),null),p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null;this.load=function(){var i=t("<div class='vis-graywrap'>");a.append(i);var s=t("<div class='initial-client-form'>");i.append(s),s.append(t("<h3 class='VIS_Pref_change-pass'>").append(t("<label class='VIS_Pref_Label_Font'>").append(e.Msg.getMsg("TenantHeaderComment"))));var l=t("<div class='input-group vis-input-wrap vis-intial-form-data'>"),o=t("<div class='vis-control-wrap'></div>");c=t('<input type="text" name="tenant" placeholder="'+e.Msg.getMsg("Tenant")+'">'),l.append(o),o.append(c),o.append(t("<label>").append(e.Msg.translate(e.context,"AD_Client_ID"))),s.append(l);var r=t("<div class='input-group vis-input-wrap vis-intial-form-data'>"),x=t("<div class='vis-control-wrap'></div>");p=t('<input type="text" name="tenant" placeholder="'+e.Msg.getMsg("Org")+'">'),r.append(x),x.append(p),x.append(t("<label>").append(e.Msg.translate(e.context,"AD_Org_ID"))),s.append(r);var A=t("<div class='input-group vis-input-wrap vis-intial-form-data'>"),R=t("<div class='vis-control-wrap'></div>");u=t('<input type="text" name="tenant" placeholder="'+e.Msg.getMsg("TenantAdmin")+'">'),A.append(R),R.append(u),R.append(t("<label>").append(e.Msg.parseTranslation(e.context,"@AD_User_ID@ @AD_Client_ID@"))),s.append(A);var E=t("<div class='input-group vis-input-wrap vis-intial-form-data'>"),P=t("<div class='vis-control-wrap'></div>");g=t('<input type="text" name="tenant" placeholder="'+e.Msg.getMsg("TenantUser")+'">'),E.append(P),P.append(g),P.append(t("<label>").append(e.Msg.parseTranslation(e.context,"@AD_User_ID@ @AD_Org_ID@"))),s.append(E);var U=t("<div class='input-group vis-input-wrap vis-intial-form-dataCombo'>"),F=t("<div class='vis-control-wrap'></div>");h=t('<select placeholder="Currency">'),U.append(F),F.append(h),F.append(t("<label>").append(e.Msg.translate(e.context,"C_Currency_ID"))),s.append(U);var B=t("<div class='input-group vis-input-wrap vis-intial-form-dataCombo'>"),W=t("<div class='vis-control-wrap'></div>");v=t('<select placeholder="Country">'),B.append(W),W.append(v),W.append(t("<label>").append(e.Msg.translate(e.context,"C_Country_ID"))),s.append(B);var j=t("<div class='input-group vis-input-wrap vis-intial-form-dataCombo'>"),G=t("<div class='vis-control-wrap'></div>");f=t('<input type="text" placeholder="'+e.Msg.getMsg("City")+'" style="width:100%;">'),j.append(G),G.append(f),G.append(t("<label>").append(e.Msg.translate(e.context,"City"))),s.append(j);var q=t("<div class='input-group vis-input-wrap vis-intial-form-dataCombo' >"),H=t("<div class='vis-control-wrap'></div>");m=t('<select placeholder="Region">'),H.append(m),H.append(t("<label>").append(e.Msg.translate(e.context,"C_Region_ID"))),q.append(H),s.append(q),s.append(t('<div style="width:100%;float:left;">').append(t("<label  class='vis-cs-op-lbl' class='vis-pull-left'>").append(e.Msg.getMsg("Optional"))));var z=t('<div class="vis-fieldset-wrap">'),Q=t("<div class='vis-intial-form-data vis-fieldset-inn'>");z.append(Q),s.append(z);var J=t('<div class="vis-initial-form-checkbox" >');y=t('<input type="checkbox">'),J.append(y),J.append(t("<label>").append(e.Msg.translate(e.context,"C_Project_ID"))),Q.append(J);var $=t('<div class="vis-initial-form-checkbox">');I=t('<input type="checkbox">'),$.append(I),$.append(t("<label>").append(e.Msg.translate(e.context,"C_SalesRegion_ID"))),Q.append($);var K=t('<div class="vis-initial-form-checkbox">');D=t('<input type="checkbox" checked disabled>'),K.append(D),K.append(t("<label>").append(e.Msg.translate(e.context,"M_Product_ID"))),Q.append(K);var Y=t('<div class="vis-initial-form-checkbox">');w=t('<input type="checkbox">'),Y.append(w),Y.append(t("<label>").append(e.Msg.translate(e.context,"C_Campaign_ID"))),Q.append(Y);var X=t('<div class="vis-initial-form-checkbox">');b=t('<input type="checkbox" checked disabled>'),X.append(b),X.append(t("<label>").append(e.Msg.translate(e.context,"C_BPartner_ID"))),Q.append(X);var Z=t("<div class='vis-initial-btn-left vis-pull-right'>");i.append(Z);var ee=t('<div style="display: inline;">');Z.append(ee),(T=t('<input type="checkbox" style="margin-right: 5px;margin-left: 10px;margin-top: 5px;display:none">')).prop("checked",!0),T.on("click",(function(){T.prop("checked")?C.css("display","none"):C.css("display","initial")})),ee.append(T),V=t("<label style='margin-right: 10px;font-size: 14px;color: #666;font-weight: normal;display:none'>").append(e.Msg.getMsg("UseDefault")),ee.append(V),(C=t("<a class='vis-initial-btn vis-initial-btn-blue' style='margin-right:10px;display:none;'>").append(e.Msg.getMsg("LoadAccountingValues"))).on("click",(function(){S.trigger("click")})),Z.append(C),(S=t("<input type='file' style='display:none;' accept='.csv*'>")).change((function(){O(this)})),Z.append(S),(_=t("<a href='javascript:;' class='vis-initial-btn' style='margin-right: 15px;'>").append(e.Msg.getMsg("Done"))).on("click",(function(){L()})),Z.append(_),n.append(d),v.change((function(){v.val()>0&&t.ajax({url:e.Application.contextUrl+"VSetup/GetRegion",dataType:"json",data:{countryID:v.val()},error:function(){e.ADialog.error(e.Msg.getMsg("ERRORGettingInitialData")),d[0].style.visibility="hidden"},success:function(t){var i=t.result;if(null==i)return e.ADialog.error(e.Msg.getMsg("ERRORGettingInitialData")),void(d[0].style.visibility="hidden");m.empty(),k(i),d[0].style.visibility="hidden"}})})),d[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"VSetup/GetInitialData",dataType:"json",error:function(){e.ADialog.error(e.Msg.getMsg("ERRORGettingInitialData")),d[0].style.visibility="hidden"},success:function(t){var i=t.result;if(null==i)return e.ADialog.error(e.Msg.getMsg("ERRORGettingInitialData")),void(d[0].style.visibility="hidden");N(i.currency),M(i.country),k(i.region),d[0].style.visibility="hidden"}})};var N=function(e){if(null!=e)for(var i in e)h.append(t('<option value="'+e[i].ID+'">').append(e[i].Name+" ("+e[i].ISO_Code+")"))},M=function(e){if(null!=e)for(var i in e)v.append(t('<option value="'+e[i].ID+'">').append(e[i].Name))},k=function(e){if(null!=e)for(var i in e)m.append(t('<option value="'+e[i].ID+'">').append(e[i].Name))},O=function(t){A=t.files[0].name,d[0].style.visibility="visible",window.setTimeout((function(){x=Date.now().toString();var i=new XMLHttpRequest,n=new FormData;n.append("file",t.files[0]),i.open("POST",e.Application.contextUrl+"Attachment/SaveFileinTemp/?filename="+A+"&folderKey="+x,!1),i.send(n),d[0].style.visibility="hidden"}),2)},L=function(){o.empty(),r.hide();var i=c.val();if(null!=i&&0!=i.length&&0!=i.trim().length){var n=p.val();if(null!=n&&0!=n.length&&0!=n.trim().length){var a=u.val();if(null!=a&&0!=a.length&&0!=a.trim().length){var s=g.val();if(null!=s&&0!=s.length&&0!=s.trim().length){var l=f.val();if(null!=l&&0!=l.length&&0!=l.trim().length){var C=h.val(),_=h.find("option:selected").text();if(null!=_&&0!=_.length&&0!=_.trim().length){var S=v.val(),V=v.find("option:selected").text();if(null!=V&&0!=V.length&&0!=V.trim().length){var N=m.val(),M=m.find("option:selected").text();if(null!=M&&0!=M.length&&0!=M.trim().length){if(T.prop("checked"))A=null;else if(null==A||0==A.length||0==A.trim().length)return void e.ADialog.error("SelectFile");if(a!=s){var k=D.prop("checked"),O=b.prop("checked"),L=y.prop("checked"),E=w.prop("checked"),P=I.prop("checked");d[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"VSetup/InitailizeClientSetup",type:"POST",dataType:"json",data:{clientName:i,orgName:n,userClient:a,userOrg:s,city:l,currencyID:C,currencyName:_,countryID:S,countryName:V,regionID:N,regionName:M,cfProduct:k,cfBPartner:O,cfProject:L,cfMCampaign:E,cfSRegion:P,fileName:A,folderKey:x},error:function(){e.ADialog.error("ErrorCreatingTenant"),d[0].style.visibility="hidden"},success:function(e){var t=e.result;d[0].style.visibility="hidden",R(t)}})}else e.ADialog.error("UsernameMustBeDifferent")}else e.ADialog.error("FillRegion")}else e.ADialog.error("FillCountry")}else e.ADialog.error("FillCurrency")}else e.ADialog.error("FillCity")}else e.ADialog.error("FillUserOrg")}else e.ADialog.error("FillUserClient")}else e.ADialog.error("FillOrgName")}else e.ADialog.error("FillTenantName")},R=function(i){null!=i.Log&&i.Log.trim().length>0&&(o.append(t('<div style="margin-bottom:10px">').append(" Error - "+i.Log)),o.append(t('<div style="margin-bottom:10px">').append(e.Msg.getMsg("VIS_TenantErrorMsg")))),o.append(t('<div style="margin-bottom:10px">').append(" Tenant Name - "+i.TenantName)),o.append(t('<div style="margin-bottom:10px">').append(" Organization Name - "+i.OrgName)),o.append(t('<div style="margin-bottom:10px">').append(" Admin Role - "+i.AdminRole)),o.append(t('<div style="margin-bottom:10px">').append(" User Role - "+i.UserRole)),o.append(t('<div style="margin-bottom:10px">').append(" Admin Username - "+i.AdminUser)),o.append(t('<div style="margin-bottom:10px">').append(" Admin User Password - "+i.AdminUserPwd)),o.append(t('<div style="margin-bottom:10px">').append(" Org Username - "+i.OrgUser)),o.append(t('<div style="margin-bottom:10px">').append(" Org User Password - "+i.OrgUserPwd)),r.on("click",(function(){var e="";e+=" Tenant Name - "+i.TenantName+"\t\n",e+=" Organization Name - "+i.OrgName+"\t\n",e+=" Admin Role - "+i.AdminRole+"\t\n",e+=" User Role - "+i.UserRole+"\t\n",e+=" Admin Username - "+i.AdminUser+"\t\n",e+=" Admin User Password - "+i.AdminUserPwd+"\t\n",e+=" Org Username - "+i.OrgUser+"\t\n",e+=" Org User Password - "+i.OrgUserPwd+"\t\n";var n=(new Date).toISOString().slice(0,19).replace(/-/g,""),a="data:text/csv;base64,"+window.btoa(e);t(this).attr("href",a).attr("download","file-"+n+".txt")})),r.show()};this.disposeComponent=function(){c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,null,_=null,d=null,n=null},this.getRoot=function(){return n}}}e.Apps=e.Apps||{},e.Apps.AForms=e.Apps.AForms||{},i.prototype.sizeChanged=function(e,t){},i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,this.load(),this.frame.getContentGrid().append(this.getRoot())},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.Apps.AForms.VSetup=i}(VIS,jQuery)},3022:()=>{!function(e,t){e.wfActivity=function(i,n,a,s,l){var o=null,r=[],d=[],c=this,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=1,w=10,b=0,C=0,_="0_0",S=0,x=!0,A=!1,T=!1,V=[],N=t("#divTabMenuDataLoder"),M=t("#hAlrtTxtTypeCount"),k=t("#divfActivity"),O=t("#workflowActivity"),L=null,R=null,E=null,P=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),U=function(e){P.css("display",e?"block":"none")};function F(i){t.ajax({url:e.Application.contextUrl+"WFActivity/GetWorkflowWindows",dataType:"json",type:"POST",error:function(){},success:function(t){if(t)if(t=JSON.parse(t),y.empty(),y.append('<option value="0_0">'+e.Msg.getMsg("SelectWindow")+"</option>"),t&&t.length>0){for(var n=!1,a=0;a<t.length;a++)y.append('<option value="'+t[a].AD_Window_ID+"_"+t[a].AD_Node_ID+'">'+t[a].WindowName+"</option>"),t[a].AD_Window_ID+"_"+t[a].AD_Node_ID==_&&(n=!0);_&&n?y.val(_):(_="0_0",y.val("0_0"))}else _="0_0",y.val("0_0");i&&j()}})}function B(e){var i=m.find(".wfActivity-selectchk");0==I.prop("checked")&&(T=!0),1==I.prop("checked")&&(A=!0);for(var n=0;n<i.length;n++)1==I.prop("checked")?0==t(i[n]).prop("checked")&&t(i[n]).trigger("click"):1==t(i[n]).prop("checked")&&t(i[n]).trigger("click");T=!1,0==I.prop("checked")&&t(m.find(".vis-activityContainer")[0]).trigger("click")}function W(e){O.hide(),n.empty(),"0_0"==y.val()?(u.hide(),1==I.prop("checked")&&I.trigger("click"),f.is(":visible")?m.css("top","98px"):m.css("top","47px")):(u.hide(),f.is(":visible")?m.css("top","118px"):m.css("top","67px")),_=y.val(),j()}function j(){D=1,w=10,O.hide(),n.empty(),m.empty(),(V=[]).length=0,c.AppendRecord(D,w,!0)}U(!1),this.Load=function(n){I&&0==I.prop("checked")&&O.hide(),i.children().last().remove(),N.show(),D=1,w=10,b=0,0,function(i){if(!i){p=t('<div class="wfactivity-homepage-parentdiv"></div>');var n=t(' <div class="frm-data-col-wrap frm-data-col-2" style="padding-right: 10px;"> <div class="frm-data-search-wrap"><input class="frm-data-col-searchinput" id="homeSearchWorkflow" type="text" placeholder="'+e.Msg.getMsg("Search")+'"><button id="btnWorkflowSearch" class="vis-wfSearch-btn"><i class="fa fa-search" aria-hidden="true"></i></button></div></div>');g=n.find("#homeSearchWorkflow"),h=n.find("#btnWorkflowSearch");var a=t(' <div class="frm-data-col-wrap frm-data-col-2" style="padding-left: 7px"> <div class="frm-data-search-wrap"><select class="vis-custom-select"></select></div></div>');y=a.find("select");var s=t('<div style="display:none;padding-left: 7px" class="frm-data-col-wrap frm-data-col-2"> <label>'+e.Msg.getMsg("FromDate")+'</label><input type="date" placeholder="date"></div>');v=s.find("input");var o=t('<div  style="display:none;padding-right:10px" class="frm-data-col-wrap frm-data-col-2"><label>'+e.Msg.getMsg("ToDate")+'</label><input type="date" placeholder="date"></div>');f=o.find("input"),p.append(a).append(n).append(s).append(o),u=t('<div class="frm-select-all-check"  style="display:none"></div>'),I=t('<input type="checkbox">'),u.append("<label>"+e.Msg.getMsg("SelectAll")+"</label>"),u.append(I),l.addClass("vis-eye-plus"),l.removeClass("vis-eye-minus"),l.attr("title",e.Msg.getMsg("ShowSearch"))}F(),m=t('<div class="wfactivity-homepage-activites" style="padding-right:0px"></div>')}(n),V=[],n?(i.find(".wfactivity-homepage-activites").remove(),i.append(m)):i.append(p).append(u).append(m),function(i){y.off("change"),y.on("change",W),m.on("scroll",q),i||(h.on("click",(function(){x&&(x=!1,j())})),g.on("keydown",(function(e){13==e.keyCode&&x&&(x=!1,j())})),v.on("focusout",(function(){""!=v.val()&&""!=f.val()&&v.val()>f.val()&&f.val("")})),f.on("focusout",(function(){""!=v.val()&&""!=f.val()&&v.val()>f.val()&&(f.val(""),e.ADialog.info("ToDateMustGreater"))})),l.on("click",(function(){f.is(":visible")?(t(v.parent()).css("display","none"),t(f.parent()).css("display","none"),v.val(""),f.val(""),l.attr("title",e.Msg.getMsg("ShowSearch")),l.addClass("vis-eye-plus"),l.removeClass("vis-eye-minus"),I.is(":visible")?m.css("top","65px"):m.css("top","47px")):(t(v.parent()).css("display","block"),t(f.parent()).css("display","block"),l.attr("title",e.Msg.getMsg("HideSearch")),l.removeClass("vis-eye-plus"),l.addClass("vis-eye-minus"),I.is(":visible")?m.css("top","118px"):m.css("top","98px"))})),I.on("click",B))}(n),(C=y.val())&&"0_0"!=C?(S=C.split("_")[1],C=C.split("_")[0],f.is(":visible")?i.find(".wfactivity-homepage-activites").css("top","118px"):i.find(".wfactivity-homepage-activites").css("top","68px")):(S=0,C=0,f.is(":visible")?i.find(".wfactivity-homepage-activites").css("top","98px"):i.find(".wfactivity-homepage-activites").css("top","47px")),t.ajax({url:e.Application.contextUrl+"WFActivity/GetActivities",data:{pageNo:1,pageSize:10,refresh:!0,searchText:g.val(),AD_Window_ID:C,dateFrom:v.val(),dateTo:f.val(),AD_Node_ID:S},dataType:"json",type:"POST",error:function(){N.hide(),e.HomeMgr.BindMenuClick()},success:function(t){var a=JSON.parse(t.result);g.val(""),window.setTimeout((function(){if(e.HomeMgr.BindMenuClick(),3==e.HomeMgr.getActiveTab().activeTabType)return null==a||null==a.LstInfo?(N.hide(),k.empty(),k.append(0),k.show(),M.empty(),M.append(0),str="<p  id='pnorecFound' style=' margin-top:200px;text-align: center'>"+e.Msg.getMsg("NoRecordFound")+"</p>",i.find("#pnorecFound").remove(),m.empty(),void i.append(str)):(o=a.LstInfo,m.empty(),1==n&&(d=[],r=[]),k.empty(),k.append(a.count),k.show(),M.empty(),M.append(a.count),H(0),void e.HomeMgr.adjustDivSize())}),100)}})};var G=!0;function q(e){t(this).scrollTop()+t(this).innerHeight()>=.75*this.scrollHeight&&G&&(G=!1,b=parseInt(k.html()),D*w<=b?(D+=1,c.AppendRecord(D,w)):G=!0)}this.AppendRecord=function(n,a,s){s||(s=!1),N.show(),C=y.val(),S=C.split("_")[1],C=C.split("_")[0],t.ajax({url:e.Application.contextUrl+"WFActivity/GetActivities",data:{pageNo:n,pageSize:a,refresh:s,searchText:g.val(),AD_Window_ID:C,dateFrom:v.val(),dateTo:f.val(),AD_Node_ID:S},dataType:"json",type:"POST",error:function(){N.hide(),e.HomeMgr.BindMenuClick(),x=!0,G=!0},success:function(t){var a=JSON.parse(t.result);if(g.val(""),e.HomeMgr.BindMenuClick(),3==e.HomeMgr.getActiveTab().activeTabType){if(o=a?a.LstInfo:null,1==s)if(d=[],r=[],k.empty(),m.empty(),a)i.find("#pnorecFound").remove(),k.append(a.count);else{M.empty(),M.append(0);var l="<p id='pnorecFound' style=' margin-top:200px;text-align: center'>"+e.Msg.getMsg("NoRecordFound")+"</p>";i.find("#pnorecFound").remove(),i.append(l),k.append(0)}H(n-1),e.HomeMgr.adjustDivSize()}else x=!0;G=!0}})};var H=function(i){var n=null;if(null==o||0==o.length)return N.hide(),u.hide(),I.prop("checked",!1),void(x=!0);for(var a in"0_0"!=y.val()?(f.is(":visible")?m.css("top","118px"):m.css("top","67px"),u.show()):(f.is(":visible")?m.css("top","98px"):m.css("top","47px"),u.hide(),I.prop("checked",!1)),o){r.push(o[a]);var s={};(n=t("<div class='vis-activityContainer' data-id='"+(Number(10*i)+Number(a))+"'>")).on("click",(function(e){if(t(".vis-activityContainer").removeClass("vis-activeFeed"),t(this).addClass("vis-activeFeed"),"wfZoom"==t(e.target).data("viswfazoom")){t(this).addClass("vis-activeFeed");var i=t(e.target).data("index");return X(i),void(x=!0)}i=t(this).data("id");var n=!0;V.length<=1&&1==I.prop("checked")&&(n=!1);var a=t(this).find(".wfActivity-selectchk").data("ids");1==V.length&&a!=V[0]||(K(d[i].wfActivityID,i,this,n),x=!0)}));var l=t("<div class='vis-feedTitleBar'>"),c=t('<input class="wfActivity-selectchk" type="checkbox" style="float:left;margin-right:5px" data-ids="'+o[a].AD_Window_ID+"_"+o[a].AD_Node_ID+"_"+o[a].AD_WF_Activity_ID+'" ></input>'),p=t("<h3>");p.css("font-weight","normal"),p.append(e.Utility.encodeText(o[a].NodeName)),y&&"0_0"!=y.val()&&l.append(c),l.append(p);var g=t("<div class='vis-feedTitleBar-buttons'>"),h=t("<ul>"),v=t("<li>"),D=t("<a href='javascript:void(0)'  data-index='"+(Number(10*i)+Number(a))+"' data-viswfazoom='wfZoom' >").append('<i class="vis vis-find" data-index="'+(Number(10*i)+Number(a))+'" data-viswfazoom="wfZoom"></i>');v.append(D),h.append(v),g.append(h),l.append(g),n.append(l);var w=t("<div class='vis-feedDetails'>"),b=t("<pre>");null==o[a].DocumentNameValue||""==o[a].DocumentNameValue?b.append(e.Utility.encodeText(o[a].Summary)):b.append(e.Utility.encodeText(o[a].DocumentNameValue+" - "+o[a].Summary));var C=t("<br>");b.append(C),b.append(e.Utility.encodeText(e.Msg.getMsg("Priority")+" "+o[a].Priority)),w.append(b),c.on("click",(function(e){var i=t(e.target);z(i,e)}));var _=t("<div class='vis-feedDateTime'>");_.append(t("<br>")).append(Globalize.format(new Date(o[a].Created),"F",Globalize.cultureSelector)),w.append(_),n.append(w),m.append(n),s.ctrl=n,s.index=a,s.recordID=o[a].Record_ID,s.wfActivityID=o[a].AD_WF_Activity_ID,d.push(s),1==I.prop("checked")&&(c.trigger("click"),r.length)}x=!0,N.hide()},z=function(e,i){var n=e.data("ids");if(0==e.prop("checked")&&(I.prop("checked",!1),A=!1),1==e.prop("checked"))if(0==V.length)V.push(e.data("ids")),A=!1,Q();else{var a=V[0].split("_"),s=n.split("_");if(a[0]+"-"+a[1]!=s[0]+"-"+s[1])return Q(),i.preventDefault(),!1;V.push(n),1!=I.prop("checked")||A||i.stopPropagation(),A=!1,Q()}else{if(1==(V=jQuery.grep(V,(function(e){return e!=n}))).length&&!T)for(var l=m.find(".wfActivity-selectchk"),o=0;o<l.length;o++)if(1==t(l[o]).prop("checked"))return t(l[o]).parent().trigger("click"),void i.stopPropagation();if(V.length>=0||1==I.prop("checked"))return i.stopPropagation(),!1}e.prop("checked")};function Q(){var e=m.find('input[class="wfActivity-selectchk"]:checked').length;m.find(".wfActivity-selectchk").length==e&&I.prop("checked",!0)}var J=function(){var e=t(window).width(),i=t(".row.scrollerHorizontal > div").length;i-=1,t(".scrollerHorizontal").width(e);var n=parseInt(e/i-20);if(e>=1366)if("none"==O.css("display"))t("#fllupsScreen").css("left",n+20),t("#favLinks").css("left",2*n+40),t("#welcomeScreen,#fllupsScreen,#favLinks").width(n);else if("block"==O.css("display")){var a=e+n+20;t(".scrollerHorizontal").width(a),t("#workflowActivity").css("left",n+20),t("#fllupsScreen").css("left",2*n+40),t("#favLinks").css("left",3*n+60),t("#welcomeScreen,#fllupsScreen,#favLinks,#workflowActivity").width(n)}},$=[],K=function(i,a,s,l){N.show(),t.ajax({url:e.Application.contextUrl+"WFActivity/GetActivityInfo",dataType:"json",type:"POST",async:l,data:{activityID:i,nodeID:r[a].AD_Node_ID,wfProcessID:r[a].AD_WF_Process_ID},error:function(){N.hide()},success:function(l){if(V.length<=1||1==I.prop("checked")){O.show(),e.HomeMgr.adjustDivSize();var o;o={to:n,className:"wsp-ui-effects-transfer"},window.setTimeout((function(){Y(i,a,l.result),t(s).effect("transfer",o,500,(function(){}))}),400)}else V.length<=2&&Y(i,a,l.result),N.hide()}})},Y=function(i,a,s){var l,o={};$=[],o.Index=a,n.empty();var d=t("<div class='vis-workflowActivityDetails-Heading'>");n.append(d);var c=t("<h3>");if(c.append(e.Msg.getMsg("Detail")),d.append(c),V.length<=1)if(L=t("<a href='javascript:void(0)' class='vis-btn-zoom mr-1' style='padding-left: 10px;padding-right: 10px;padding-top: 2px;padding-bottom: 2px;' data-id='"+a+"'>"+e.Msg.getMsg("CheckList")+"</a>"),s.IsSurveyResponseRequired&&d.append(L),"VADMS_SignStatus"==s.ColName){l=r[a].DocumentNameValue.split("_");var p={DocumentNo:parseInt(l[l.length-1])},u="";t.post(e.Application.contextUrl+"VADMS/Document/GetFolderID",p,(function(t){!t||""==t.result||t.result.contains("ERR-")||t.result.contains("F")?e.ADialog.error(e.Msg.getMsg("VA055_FolderNotFound")):u=parseInt(t.result)}),"json").fail((function(t,i){e.ADialog.error(i)}));var g="";t.post(e.Application.contextUrl+"VADMS/Document/GetFormID",{FromName:"VADMS_DMSWeb"},(function(t){t&&""!=t.result?g=t.result:e.ADialog.error(e.Msg.getMsg("VA055_FormNotFound"))}),"json").fail((function(t,i){e.ADialog.error(i)}));var h=t("<a href='javascript:void(0)' class='vis-btn-zoom' style='margin-left:10px;' data-id='"+l[l.length-1]+"'>");h.append(t("<span class='vis-btn-ico vis-btn-zoom-bg vis-btn-zoom-border'>")),h.append(e.Msg.getMsg("Zoom")),d.append(h),h.on(e.Events.onTouchStartOrClick,(function(i){var n={DocNo:t(this).data("id"),DocFolderID:u};g>0&&e.viewManager.startForm(g,n)}))}else{var v=t("<a href='javascript:void(0)' class='vis-btn-zoom' data-id='"+a+"'>");v.append(t("<span class='vis-btn-ico vis vis-find vis-btn-zoom-border'>")),v.append(e.Msg.getMsg("Zoom")),d.append(v),v.on(e.Events.onTouchStartOrClick,(function(e){var i=t(this).data("id");X(i)}))}d.append(t("<div class='clearfix'>"));var f=t("#workflowActivityData").height()-50+"px";R=t("<div class='divWorkflowActivity' style='height:"+f+"'>"),E=t("<div class='divWorkflowChecklist' style='display:none'></div>"),n.append(R),n.append(E),R.append(P);var y=t("<ul class='vis-IIColumnContent'>");R.append(y);var I=t("<li>");I.css("width","100%");var D=t("<p>");if(D.append(e.Msg.getMsg("Node")),D.append(t("<br>")),D.append(e.Utility.encodeText(r[a].NodeName)),I.append(D),y.append(I),s.AttachmentCount>0&&I.append("<pre style='margin-top: 10px; margin-bottom: 0px; font-size: 14px; font-family: NoirPro-Regular; color: inherit;'>"+e.Msg.getMsg("Attachment")+" : "+e.Msg.getMsg("Yes")+"</pre>"),V.length<=1){var w=t("<pre class='mb-2'>");w.css("margin-top","10px"),w.css("margin-bottom","0px"),w.css("font-size","14px"),w.css("font-family","NoirPro-Regular"),w.css("color","inherit"),w.append(e.Msg.getMsg("Summary")),w.append(t("<br>")),w.append(e.Utility.encodeText(r[a].Summary)),I.append(w)}R.append(t("<div class='clearfix'>"));var b=t("<p class='mb-0'>");b.append(e.Msg.getMsg("Description")),R.append(b);var C=t("<p>");C.append(e.Utility.encodeText(r[a].Description)),R.append(C),R.append(t("<div class='clearfix'>"));var _=t("<p class='mb-0'>");_.append(e.Msg.getMsg("Help")),R.append(_);var S=t("<p>");S.append(e.Utility.encodeText(r[a].Help)),R.append(S),R.append(t("<h3>").append(e.Msg.getMsg("Action"))),R.append(t("<div class='clearfix'>"));var x=t("<ul class='vis-IIColumnContent vis-home-wf-ul'>"),A=t("<li>");x.append(A);var T=t('<div class="vis-home-wf-answerWrap">');A.append(T);var M=t('<div class="input-group vis-home-wf-answerInput vis-input-wrap">');if(T.append(M),"C"==s.NodeAction){var k=ee(s,i);if(o.AnswerCtrl=k,null!=k){if(k.getBtnCount()>0)(H=t("<div class='vis-wforwardwrap vis-control-wrap'>")).append(k.getControl()),(z=t("<div class='input-group-append'>")).append(k.getBtn(0)),H.append(t("<label style='margin-bottom: 0'>").append(e.Msg.getMsg("Answer"))),M.append(H).append(z);else M.append(k.getControl());o.AnswerCtrl=k}o.Action="C"}else if("W"==s.NodeAction){var O=t('<button style="margin-bottom:10px;margin-top: 0px;width: 100%;" class="VIS_Pref_pass-btn" data-id="'+a+'" data-window="'+s.AD_Window_ID+'" data-col="'+s.KeyCol+'">').append(s.NodeName);o.AnswerCtrl=O,M.append(O),O.on("click",(function(){te(t(this).data("id"),t(this).data("window"),t(this).data("col"))})),o.Action="W"}else if("X"==s.NodeAction){O=t('<button style="margin-bottom:10px;margin-top: 0px;width: 100%;" class="VIS_Pref_pass-btn" data-id="'+a+'" data-form="'+s.AD_Form_ID+'" data-col="'+s.KeyCol+'">').append(s.NodeName);o.AnswerCtrl=O,M.append(O),O.on("click",(function(){e.viewManager.startForm(t(this).data("form"))})),o.Action="X"}var B=t("<a href='javascript:void(0)'  style='display:none' id='vis-home-wf-ansOK' class='vis-btn vis-btn-done vis-icon-doneButton vis-workflowActivityIcons' data-clicked='N' data-id='"+a+"'>");B.append(t("<span class='vis-btn-ico vis-btn-done-bg vis-btn-done-border'>")),B.append(e.Msg.getMsg("Done")),T.append(t('<div class="vis-home-wf-answerBtn">').append(B));var W=t("<li>");x.append(W);var j=t('<div class="vis-home-wf-forwardWrap">');W.append(j);var G=t('<div class="input-group mb-0 vis-home-wf-forwardInput vis-input-wrap">');j.append(G);var q=t('<div class="d-flex">');j.append(q);var H,z,Q=e.MLookupFactory.get(e.context,0,0,e.DisplayType.Search,"AD_User_ID",0,!1,null),K=new e.Controls.VTextBoxButton("AD_User_ID",!1,!1,!0,e.DisplayType.Search,Q);(o.FwdCtrl=K,K.getBtn(),2==K.getBtnCount())&&((H=t("<div class='vis-wforwardwrap vis-control-wrap'>")).append(K.getControl()),(z=t("<div class='input-group-append'>")).append(K.getBtn(0)),z.append(K.getBtn(1)),H.append(t("<label style='margin-bottom: 0'>").append(e.Msg.getMsg("Forward"))),G.append(H).append(z));var Y=t('<div class="input-group vis-home-wf-forwardInput vis-input-wrap">');q.append(Y);var ie=t("<a href='javascript:void(0)' style='display:none' id='vis-home-wf-forOK' class='vis-btn vis-btn-done vis-icon-doneButton vis-workflowActivityIcons' data-clicked='N' data-id='"+a+"'>");ie.append(t("<span class='vis-btn-ico vis-btn-done-bg vis-btn-done-border'>")),ie.append(e.Msg.getMsg("Done")),q.append(t('<div class="vis-home-wf-forwardBtn">').append(ie)),R.append(x),R.append(t("<div class='clearfix'>")),R.append(t("<p style='margin-bottom: 0'>").append(e.Msg.getMsg("Message"))),R.append(t("<div class='clearfix'>"));var ne=t("<div class='vis-control-wrap'>"),ae=t("<textarea style='width:100%;resize:none;' placeholder='"+e.Msg.getMsg("TypeMessage")+"....'>");function se(i){if("Y"!=i.data("clicked"))if(i.data("clicked","Y"),window.VA055&&window.VADMS&&"VADMS_SignStatus"==s.ColName){var n={documentNo:l[l.length-1],defaultReasonKey:t('[name="VADMS_SignStatus"]').children("option:selected").val(),defaultReason:t('[name="VADMS_SignStatus"]').children("option:selected").text()};if(null==n.defaultReasonKey||""==n.defaultReasonKey||null==n.defaultReason||""==n.defaultReason)return i.data("clicked","N"),void e.ADialog.info("VA055_ChooseStatus");U(!0),t.post(e.Application.contextUrl+"VADMS/Document/SignatureUsingWorkflow",n,(function(n){U(!1),n&&"null"!=n&&"success"==n.result?(t("#divfeedbsy")[0].style.visibility="hidden",m.empty(),J(),$=[],V=[],N.show(),window.setTimeout((function(){F(!0)}),5e3)):(i.data("clicked","N"),e.ADialog.error(n.result))}),"json").fail((function(t,n){U(!1),i.data("clicked","N"),e.ADialog.error(n)}))}else{var a=t(i).data("id");Z(a,i)}}if(o.MsgCtrl=ae,ne.append(ae),ne.append(t("<div class='clearfix'>")),Y.append(ne),ie.on(e.Events.onTouchStartOrClick,(function(){se(ie)})),B.on(e.Events.onTouchStartOrClick,(function(){se(B)})),o.FwdCtrl.fireValueChanged=function(){o.FwdCtrl.getValue()>0?(o.AnswerCtrl.getControl().prop("disabled",!0),o.AnswerCtrl.getBtn(0).prop("disabled",!0),ie.css("display",""),B.css("display","none")):(o.AnswerCtrl.getControl().prop("disabled",""),o.AnswerCtrl.getBtn(0).prop("disabled",""),ie.css("display","none"),B.css("display","none"))},o.AnswerCtrl.fireValueChanged=function(){""==o.AnswerCtrl.getValue()||null==o.AnswerCtrl.getValue()?(o.FwdCtrl.getControl().prop("disabled",""),o.FwdCtrl.getBtn(0).prop("disabled",""),o.FwdCtrl.getBtn(1).prop("disabled",""),ie.css("display","none"),B.css("display","none")):(o.FwdCtrl.getControl().prop("disabled",!0),o.FwdCtrl.getBtn(0).prop("disabled",!0),o.FwdCtrl.getBtn(1).prop("disabled",!0),ie.css("display","none"),B.css("display",""))},$.push(o),V.length<=1){R.append(t("<h3>").append(e.Msg.getMsg("History"))),R.append(t("<div class='clearfix'>"));var le=t("<div class='vis-history-wrap'>");if(R.append(le),null!=s.Node){var oe=t("<div style='margin-top:15px;margin-bottom:15px'>");for(node in s.Node)if(null!=s.Node[node].History){for(hNode in s.Node[node].History)if("CC"==s.Node[node].History[hNode].State&&node<s.Node.length-1){oe.append(t("<div class='vis-vertical-img'>").append(t("<img src='"+e.Application.contextUrl+"Areas/VIS/Images/home/4.jpg'>")));var re,de=t("<div class='vis-approved_wrap'>");re=s.Node[node].Name;var ce=t("<div class='vis-left-part'>");if(s.Node[node].History[hNode].TextMsg.length>0){var pe=t("<a href='javascript:void(0)' class='VIS_Pref_tooltip' style='margin-right:5px'>").append(t("<img class='VIS_Pref_img-i'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/i.png"));(he=t("<span>")).append(t("<img class='VIS_Pref_callout'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/ccc.png").append("ToolTip Text")),he.append(t("<label class='VIS_Pref_Label_Font'>").append(e.Utility.encodeText(s.Node[node].History[hNode].TextMsg))),pe.append(he),ce.append(pe)}ce.append(re),de.append(ce),(ue=t("<div class='vis-right-part'>")).append(e.Msg.getMsg("CompletedBy")).append(t("<span class='vis-app_by'>").append(s.Node[node].History[hNode].ApprovedBy)),de.append(ue),oe.append(de)}else if(node<s.Node.length-1||1==s.Node.length){(de=t("<div class='vis-pending_wrap' style='margin-top:-2px'>")).append(t("<div class='vis-left-part'>").append(s.Node[node].Name)),de.append(t("<div class='vis-right-part'>").append(e.Msg.getMsg("Pending"))),oe.append(de)}else{oe.append(t("<div class='vis-vertical-img'>").append(t("<img src='"+e.Application.contextUrl+"Areas/VIS/Images/home/4.jpg'>")));var ue,ge=t("<div class='vis-start_wrap' style='margin-bottom:-8px'>");ce=t("<div class='vis-left-part'>");if(s.Node[node].History[hNode].TextMsg.length>0){var he;pe=t("<a href='javascript:void(0)' class='VIS_Pref_tooltip' style='margin-right:5px'>").append(t("<img class='VIS_Pref_img-i'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/i.png"));(he=t("<span >")).append(t("<img class='VIS_Pref_callout'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/ccc.png").append("ToolTip Text")),he.append(t("<label class='VIS_Pref_Label_Font'>").append(e.Utility.encodeText(s.Node[node].History[hNode].TextMsg))),pe.append(he),ce.append(pe)}ce.append(s.Node[node].Name),ge.append(ce),(ue=t("<div class='vis-right-part'>")).append(e.Msg.getMsg("CompletedBy")).append(t("<span class='vis-app_by'>").append(s.Node[node].History[hNode].ApprovedBy)),ge.append(ue),oe.append(ge)}le.append(oe)}}}N.hide(),L.off().click((function(){if(E.html(""),"Back"!=t(this).text()){t(this).text(e.Msg.getMsg("Back")),n.find(".vis-workflowActivityDetails-Heading h3").text(e.Msg.getMsg("CheckList"));var i=new e.SurveyPanel;i.init();var s=i.getRoot();E.html(""),i.panelDetails(r[a].AD_Window_ID,0,r[a].AD_Table_ID,r[a].Record_ID,s,r[a].AD_WF_Activity_ID),E.append(s)}else n.find(".vis-workflowActivityDetails-Heading h3").text(e.Msg.getMsg("Detail")),t(this).text(e.Msg.getMsg("CheckList"));R.toggle(700),E.is(":hidden")?E.show():E.hide()}))},X=function(t){e.AEnv.wfzoom(r[t].AD_Table_ID,r[t].Record_ID,r[t].AD_WF_Activity_ID)},Z=function(i,n){t("#divfeedbsy")[0].style.visibility="visible",window.setTimeout((function(){for(var a in $)try{if(i===$[a].Index){var s=$[a].FwdCtrl.getValue(),l=e.Utility.encodeText($[a].MsgCtrl.val()),o=null;if("C"==$[a].Action)o=$[a].AnswerCtrl.getValue();var d="";if(V&&V.length>0)for(var c=0;c<V.length;c++)d.length>0&&(d+=","),d+=V[c].split("_")[2];else d=r[i].AD_WF_Activity_ID;C=r[i].AD_Window_ID,U(!0),e.dataContext.getJSONData(e.Application.contextUrl+"WFActivity/ApproveIt",{activityID:d,nodeID:r[i].AD_Node_ID,txtMsg:l,fwd:s,answer:o,AD_Window_ID:C},(function(i){U(!1),""==i.result?(t("#divfeedbsy")[0].style.visibility="hidden",n.data("clicked","N"),m.empty(),J(),$=[],V=[],N.show(),F(!0)):(e.ADialog.error(i.result),n.data("clicked","N"),t("#divfeedbsy")[0].style.visibility="hidden")}));break}}catch(i){U(!1),e.ADialog.error("FillMandatory",!0,""),n.data("clicked","N"),t("#divfeedbsy")[0].style.visibility="hidden"}n.data("clicked","N")}),2)},ee=function(i,n){var a=null;if(0==i.ColID)return a;if(i.ColReference==e.DisplayType.YesNo){var s=e.MLookupFactory.get(e.context,0,0,e.DisplayType.List,i.ColName,319,!1,null);return a=new e.Controls.VComboBox(i.ColName,!1,!1,!0,s,50)}if(i.ColReference==e.DisplayType.List){s=e.MLookupFactory.get(e.context,0,0,e.DisplayType.List,i.ColName,i.ColReferenceValue,!1,null);return a=new e.Controls.VComboBox(i.ColName,!1,!1,!0,s,50)}if("C_GENATTRIBUTESETINSTANCE_ID"==i.ColName.toUpperCase()){var l=null,o=new e.MGAttributeLookup(e.context,0);return t.ajax({url:e.Application.contextUrl+"WFActivity/GetRelativeData",async:!1,data:{activityID:n},dataType:"json",success:function(t){t.result&&(l=new e.Controls.VPAttribute("C_GenAttributeSetInstance",!0,!1,!0,e.DisplayType.PAttribute,o,0,!0,!1,!1,!1)).SetC_GenAttributeSet_ID(t.result.GenAttributeSetID)}}),l}if(i.ColReference==e.DisplayType.TableDir){s=e.MLookupFactory.get(e.context,0,0,e.DisplayType.TableDir,i.ColName,i.ColReferenceValue,!1,null);return a=new e.Controls.VComboBox(i.ColName,!1,!1,!0,s,50)}if(i.ColReference==e.DisplayType.Search){s=e.MLookupFactory.get(e.context,0,0,e.DisplayType.Search,i.ColName,i.ColReferenceValue,!1,null);return a=new e.Controls.VTextBoxButton(i.ColName,!1,!1,!0,e.DisplayType.Search,s)}return a=new e.Controls.VTextBox(i.ColName,!1,!1,!0,50,100,null,null,!1)},te=function(t,i,n){var a=new e.Query;a.addRestriction(n,e.Query.prototype.EQUAL,r[t].Record_ID),e.viewManager.startWindow(i,a)};this.clear=function(){for(var e in d)d[e]=null}}}(VIS,jQuery)},8716:()=>{!function(e,t){var i=t("body");t("#vis_buzzer");e.ADialog={info:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=n&&n.length>0&&(s+="\n"+n),e.ADialogUI.info(s,a),s=null},ask:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=n&&n.length>0&&(s+="\n"+n);var l=!1;return confirm(s)&&(l=!0),l},error:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=n&&n.length>0&&(s+="\n"+n),e.ADialogUI.error(s,a),s=null},warn:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=n&&n.length>0&&(s+="\n"+n),e.ADialogUI.warn(s,a),s=null},confirm:function(t,i,n,a,s){var l="";null==t||t.equals("")||(l+=e.Msg.getMsg(t)),null!=n&&n.length>0&&(l+="\n"+n);return e.ADialogUI.ask(l,a,s),!1},confirmCustomUI:function(t,i,n,a,s,l){var o="";null==t||t.equals("")||(o+=e.Msg.getMsg(t)),null!=n&&n.length>0&&(o+="\n"+n);return e.ADialogUI.askCustomUI(o,a,s,l),!1}},e.ADialogCallback={info:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=i&&i.length>0&&(s+="\n"+i),e.ADialogUI.info(s,n,a),s=null},error:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=i&&i.length>0&&(s+="\n"+i),e.ADialogUI.error(s,n,a),s=null},warn:function(t,i,n,a){var s="";null==t||t.equals("")||(s+=e.Msg.getMsg(t)),null!=i&&i.length>0&&(s+="\n"+i),e.ADialogUI.warn(s,n,a),s=null}},e.ADialogUI=function(){var n=t('<div id="overlayMsgDialog" class="web_dialog_overlay"></div>'),a=t('<div class="vis-PopupWrap-alertmain" tabIndex=1>'),s=t('<div id="VAPOS_ErrorInfo" class="vis-PopupWrap-alert"><input class="vis-Dialog-buttons-text" type="number"  tabindex="-30" style="z-index:-44;position:absolute"  autofocus="autofocus"  >        <div class="vis-popup-headerContainer">                                                  <div class="vis-PopupHeader-alert">           <h4 id="VAPOS_CLInformation">Information</h4>           <span id="btnCloseInfo" class="fa fa-times"></span>                            </div>  </div>                                                                                          <div class="vis-PopupContent-alert">                                                                    <div class="form-group vis-PopupInput-alert" style="width: 100%">                                <img class="vis-alert-img" style="float:left"  />                                                                      <label style="width: 90%;padding-left: 10px;word-break: break-word" id="VAPOS_lblErrorInfo"></label>                                   <div class="vis-confirm-customUI" style="display:none"> </div>                        </div>                                                                                                <div class="vis-Dialog-buttons" style="display:none">                                           <input class="vis-Dialog-buttons-OK " type="button" value="'+e.Msg.getMsg("OK")+'" > <input  class="vis-Dialog-buttons-Cancel"  type="button" value="'+e.Msg.getMsg("Cancel")+'" >                                               </div>                                                                                                                                                  </div>                                                                                      </div>');a.append(s),i.append(n).append(a);var l=s.find(".vis-PopupHeader-alert"),o=s.find(".vis-popup-headerContainer"),r=s.find("#btnCloseInfo"),d=s.find("#VAPOS_CLInformation"),c=s.find(".vis-alert-img"),p=s.find(".vis-PopupContent-alert"),u=s.find("#VAPOS_lblErrorInfo"),g=s.find(".vis-confirm-customUI"),h=(s.find("#VAPOS_busyInd"),null),v=null,f=null;function m(e){e?window.setTimeout((function(){v.focus(),a.on("keydown",(function(e){if(9==e.keyCode)h.is(":focus")?v.focus():v.is(":focus")?h.focus():v.focus(),e.preventDefault(),e.stopPropagation();else if(27==e.keyCode)return e.preventDefault(),e.stopPropagation(),y(e),!1}))}),100):(a.focus(),a.on("keydown",(function(e){return e.preventDefault(),e.stopPropagation(),y(e),!1})))}function y(e){e.stopPropagation(),f&&f(),f=null,I()}function I(){n.hide(),a.css({position:"inherit",display:"none"}),s.find(".vis-Dialog-buttons").css("display","none"),h&&h.off("click"),v&&v.off("click"),a.off("keydown")}return r.on("click",(function(e){y(e)})),{info:function(t,i,r){f=r,a.css({position:"absolute",display:"flex"}),s.show(),l.removeClass(),l.addClass("vis-PopupHeader-alert vis-PopupHeader-alert-info"),p.removeClass(),p.addClass("vis-PopupContent-alert vis-PopupContent-alert-info"),o.removeClass(),o.addClass("vis-popup-headerContainer vis-popup-headerContainer-info"),c.attr("src",e.Application.contextUrl+"Areas/VIS/Images/base/info-icon.png"),_prodFound=!0,u.text(t),i?d.text(e.Msg.getMsg(i)):d.text(e.Msg.getMsg("Info")),n.show(),s.fadeIn(300),m(!1)},ask:function(t,i,r){f=r,a.css({position:"absolute",display:"flex"}),s.show(),l.removeClass(),l.addClass("vis-PopupHeader-alert vis-PopupHeader-alert-info"),p.removeClass(),p.addClass("vis-PopupContent-alert vis-PopupContent-alert-info vis-PopupContent-alert-Confirm"),o.removeClass(),o.addClass("vis-popup-headerContainer vis-popup-headerContainer-info"),c.attr("src",e.Application.contextUrl+"Areas/VIS/Images/base/confirm-icon.png");var g=s.find(".vis-Dialog-buttons");g.css("display","inherit"),h=g.find(".vis-Dialog-buttons-OK"),v=g.find(".vis-Dialog-buttons-Cancel"),_prodFound=!0,u.text(t),i?d.text(e.Msg.getMsg(i)):d.text(e.Msg.getMsg("Confirm")),n.show(),s.fadeIn(300),h.one("click",(function(){I(),g.css("display","none"),f(!0)})),v.one("click",(function(){I(),g.css("display","none"),f(!1)})),m(!0)},error:function(t,i,r){f=r,_prodFound=!0,a.css({position:"absolute",display:"flex"}),s.show(),l.removeClass(),l.addClass("vis-PopupHeader-alert vis-PopupHeader-alert-error"),p.removeClass(),p.addClass("vis-PopupContent-alert vis-PopupContent-alert-error"),o.removeClass(),o.addClass("vis-popup-headerContainer vis-popup-headerContainer-error"),c.attr("src",e.Application.contextUrl+"Areas/VIS/Images/base/error-icon.png"),u.text(t),i?d.text(e.Msg.getMsg(i)):d.text(e.Msg.getMsg("Error")),n.show(),s.fadeIn(300),m(!1)},warn:function(t,i,r){f=r,_prodFound=!0,a.css({position:"absolute",display:"flex"}),s.show(),l.removeClass(),l.addClass("vis-PopupHeader-alert vis-PopupHeader-alert-warn"),p.removeClass(),p.addClass("vis-PopupContent-alert vis-PopupContent-alert-warn"),o.removeClass(),o.addClass("vis-popup-headerContainer vis-popup-headerContainer-warn"),c.attr("src",e.Application.contextUrl+"Areas/VIS/Images/base/warning-icon.png"),u.text(t),i?d.text(e.Msg.getMsg(i)):d.text(e.Msg.getMsg("Warning")),n.show(),m(!1)},askCustomUI:function(t,i,r,y){f=y,a.css({position:"absolute",display:"flex"}),s.show(),l.removeClass(),l.addClass("vis-PopupHeader-alert vis-PopupHeader-alert-info"),p.removeClass(),p.addClass("vis-PopupContent-alert vis-PopupContent-alert-info vis-PopupContent-alert-Confirm"),o.removeClass(),o.addClass("vis-popup-headerContainer vis-popup-headerContainer-info"),c.attr("src",e.Application.contextUrl+"Areas/VIS/Images/base/confirm-icon.png");var D=s.find(".vis-Dialog-buttons");D.css("display","inherit"),h=D.find(".vis-Dialog-buttons-OK"),v=D.find(".vis-Dialog-buttons-Cancel"),_prodFound=!0,u.text(t),g.empty(),g.css("display","block"),g.append(r),i?d.text(e.Msg.getMsg(i)):d.text(e.Msg.getMsg("Confirm")),n.show(),s.fadeIn(300),h.one("click",(function(){I(),D.css("display","none"),g.css("display","none"),g.empty(),f(!0)})),v.one("click",(function(){I(),D.css("display","none"),g.css("display","none"),g.empty(),f(!1)})),m(!0)}}}()}(VIS,jQuery)},5814:()=>{!function(e,t){var i=t('<div class="vis-reportrootdiv">'),n=t("<ul class='vis-apanel-rb-ul'  style='width:100%;height:100%'>");i.append(n);var a=e.Application.contextUrl,s=a+"JsonData/JDataSetWithCode",l=a+"JsonData/ExecuteNonQuer",o=function(e,i,n){var a=!!n,s=null,o={sql:e,param:i};return t.ajax({url:l+"yWithCode",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(o)}).done((function(e){s=e,n&&n(e)})),s};function r(e,i,n){var a=null;return t.ajax({url:s,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){a=e,n&&n(e)})),a}e.ReportViewer=function(i,n,a,s,l,r){var d=t("<div class='vis-reportrootdiv'>"),c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=e.Env.getScreenHeight()-50,N=t(window).width(),M=this;(C=new e.CFrame).setName(e.Msg.getMsg("Report")),C.setTitle(e.Msg.getMsg("Report"));var k=null,O=t("<div>"),L=t("<ul class='vis-apanel-rb-ul'>");O.append(L);var R,E,P,U,F,B,W,j,G=!1,q=[],H=null,z=0,Q=0,J=!0,$=null,K=n.getAD_Window_ID();this.getGenerateReportPara=function(t,n,a,s,l,o,r,d,c,p,u){return $||(($=new e.ProcessInfo("",0,x,0)).setAD_User_ID(e.context.getAD_User_ID()),$.setAD_Client_ID(e.context.getAD_Client_ID())),$.setTable_ID(x),$.setAD_PInstance_ID(r),$.setPageNo(d),$.setFileType(c),$.set_AD_PrintFormat_ID(p),$.setAD_Window_ID(u),u>0?$.setActionOrigin(e.ProcessCtl.prototype.ORIGIN_WINDOW):$.setActionOrigin(e.ProcessCtl.prototype.ORIGIN_FORM),$.setOriginName(e.context.getWindowContext(i,"WindowName")),{processInfo:$.toJson(),queryInfo:JSON.stringify(t),code:n,isCreateNew:a,treeID:l,node_ID:s,IsSummary:o}},this.setNodeID=function(e){z=e},this.setTreeID=function(e){Q=e},this.setAD_Table_ID=function(e){x=e},this.showSummary=function(e){J=e},this.setAD_Window_ID=function(e){},this.setReportBytes=function(e){H=e};var Y=0;this.setIteration=function(e){Y=e},this.archiveDocument=function(i,n,a){de(!0),t.ajax({url:e.Application.contextUrl+"JsonData/ArchiveDoc/",dataType:"json",type:"post",data:{AD_Process_ID:0,Name:i[0],AD_Table_ID:n,Record_ID:0,C_BPartner_ID:0,isReport:!0,binaryData:a},success:function(t){e.ADialog.info("Archived",!0,"",""),de(!1)}})};var X="";function Z(e){var i=100*t("#reportcreate").find(".progress-bar").width()/t("#reportcreate").width();isNaN(i)&&(i=0),i<=e&&t("#reportcreate").removeClass("hide").find(".progress-bar").attr("aria-valuenow",e).css({width:e+"%"}).text(e.toFixed(0)+"%")}function ee(){t("#reportcreateresult").removeClass().text("")}function te(e){ee(),t("#reportcreateresult").addClass("alert alert-success").text(e),t("#forreportdownload").removeClass("hide")}var ie=0;this.getRoot=function(){return d},this.dispose=function(){},this.show=function(t,i,n,s,l,o,r){n,x=s,A=l,S=i,T=o,G=e.MRole.getDefault().getIsCanExport(x),1!=a&&(G?(D.css("display","inline-flex"),I.css("display","inline-flex"),"Y"==e.context.ctx["#BULK_REPORT_DOWNLOAD"]?(b.css("display","inline-flex"),w.css("display","inline-flex")):(b.css("display","none"),w.css("display","none"))):(D.css("display","none"),I.css("display","none"),b.css("display","none"),w.css("display","none"))),re(t),r&&ce(r)};var ne=function(){if(a){d.children()[1];null}P.off("click"),U.off("click"),B.off("click"),W.off("click"),j.off("change"),d.empty(),d.remove(),g&&g.empty(),c.empty(),c.remove(),C&&(C.dispose(),C=null),P=U=B=W=j=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null};this.close=function(){ne()};var ae=function(){p.on("click",(function(){ne()})),y.on("click",(function(){!function(){var e=window.open();e.document.write("<html ><head>"),e.document.write("</head><body >");var i=t(_);t(i.children()).css({overflow:"hidden"}),e.document.write(i.html()),e.document.write("</body></html>"),e.print(),e.close()}()})),m.on("click",(function(){var t=new e.Query;t.addRestriction("AD_PrintFormat_ID",e.Query.prototype.EQUAL,S),e.viewManager.startWindow(240,t)})),v.on("click",(function(){ue.empty(),ue.css("width","0px"),se(j.val())})),I.on("click",(function(){le(j.val(),0)})),D.on("click",(function(){oe(j.val(),0,null)})),w.on("click",(function(){ie=0,X="";var t=new e.BulkDownload(i,"PDF");t.show();for(var n=1;n<=Y;n++)le(n,Y,t)})),b.on("click",(function(){ie=0,X="";var t=new e.BulkDownload(i,"CSV");t.show();for(var n=1;n<=Y;n++)oe(n,Y,t)})),k.on("click",(function(){L.empty();for(var i=0;i<q.length;i++)if(q[i].ID){var n="Y"==q[i].IsDefault?"vis-favitmchecked":"vis-favitmunchecked",a=t('<li data-isdefbtn="no" data-id="'+q[i].ID+'"><a data-isdefbtn="no" data-id="'+q[i].ID+'">'+q[i].Name+'</a><a data-isdefbtn="yes" data-id="'+q[i].ID+'" style="min-height: 16px;display: inline-block;margin-left: 5px;min-width: 16px;margin-top: 0px" class="vis-menufavitm '+n+'" > </a></li>');L.append(a)}L.append(t('<li data-isdefbtn="no" data-id="-1"><a data-id="-1">'+e.Msg.getMsg("NewReport")+"</a>")),t(this).w2overlay(O.clone(!0),{css:{height:"300px"}})})),L.on("click","LI",(function(i){var a=t(i.target),s=a.data("id");if(s)if("yes"!=a.data("isdefbtn")){S=s,ue.empty(),ue.css("width","0px"),de(!0);var l=!1;-1==s&&(s=x,l=!0);var r=M.getGenerateReportPara(A,T,l,z,Q,J,0,j.val(),"",s,K);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:r,type:"POST",success:function(t){null==t&&alert(e.Msg.getMsg("ERRORGettingRepData"));var i=jQuery.parseJSON(t),n=i.repInfo;if(n.ErrorText)return e.ADialog.error(n.ErrorText),void de(!1);re(n.HTML),H=n.Report,ce(i.pSetting),S=n.AD_PrintFormat_ID,de(!1)}})}else{var d="VIS_102";(c=[])[0]=new e.DB.SqlParam("@Ad_Table_ID",x),c[1]=new e.DB.SqlParam("@AD_Tab_ID",n.getAD_Tab_ID()),o(d,c);var c;d="VIS_103";(c=[])[0]=new e.DB.SqlParam("@id",s),o(d,c);for(var p=0;p<q.length;p++)q[p].ID==s?q[p].IsDefault="Y":q[p].IsDefault="N"}})),f.on("click",(function(){var t=new e.Find(i,n,0);t.onClose=function(){if(t.getIsOKPressed()){var e=t.getQuery();t.getCurrentDays(),t.getIsCreated();t.dispose(),t=null,A[1]=e.getWhereClause(!0),se(1)}},t.show()})),h.on("click",(function(){M.archiveDocument(A,x,H)}))},se=function(i){de(!0);var n=M.getGenerateReportPara(A,T,!1,z,Q,J,0,i,"",S,K);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:n,type:"POST",success:function(t){null==t&&alert(e.Msg.getMsg("ERRORGettingRepData"));var i=jQuery.parseJSON(t),n=i.repInfo;if(n.ErrorText)return e.ADialog.error(n.ErrorText),void de(!1);re(n.HTML),H=n.Report,ce(i.pSetting),de(!1)}})},le=function(i,n,a){de(!0);var s=M.getGenerateReportPara(A,T,!1,z,Q,J,0,i,e.ProcessCtl.prototype.REPORT_TYPE_PDF,S,K);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:s,type:"POST",success:function(s){null==s&&alert(e.Msg.getMsg("ERRORGettingRepData"));var l=jQuery.parseJSON(s).repInfo;if(l.ErrorText)return e.ADialog.error(l.ErrorText),void de(!1);l.HTML&&l.HTML.length>0?re(l.HTML):0==n?window.open(e.Application.contextUrl+l.ReportFilePath):(a.setBulkBusy(!1),t("#forreportdownload").addClass("hide"),X+='<input type="checkbox" data-num="'+i+'"  data-url="'+e.Application.contextUrl+l.ReportFilePath+'" checked />',Z((ie+=1)/n*100),ie==n&&setTimeout((function(){Z(100),te(e.Msg.getMsg("Generated")),t("<form>",{id:"download_form",html:X,action:"#",Class:"hide"}).appendTo(document.body).submit()}),1e3)),de(!1)}})},oe=function(i,n,a){de(!0);var s=M.getGenerateReportPara(A,T,!1,z,Q,J,0,i,e.ProcessCtl.prototype.REPORT_TYPE_CSV,S,K);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:s,type:"POST",success:function(s){null==s&&alert(e.Msg.getMsg("ERRORGettingRepData"));var l=jQuery.parseJSON(s).repInfo;if(l.ErrorText)return e.ADialog.error(l.ErrorText),void de(!1);l.HTML&&l.HTML.length>0?re(l.HTML):0==n?window.open(e.Application.contextUrl+l.ReportFilePath):(a.setBulkBusy(!1),t("#forreportdownload").addClass("hide"),X+='<input type="checkbox" data-num="'+i+'" data-url="'+e.Application.contextUrl+l.ReportFilePath+'" checked />',Z((ie+=1)/n*100),ie==n&&setTimeout((function(){Z(100),te(e.Msg.getMsg("Generated")),t("<form>",{id:"download_form",html:X,action:"#",Class:"hide"}).appendTo(document.body).submit()}),1e3)),de(!1)}})},re=function(i){if(1!=a){L.empty();var s=null,l=[],o=-1;try{for(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetShowReportDetails",data:{AD_Table_ID:x,AD_Tab_ID:n.getAD_Tab_ID()},success:function(t){s=(new e.DB.DataReader).toJson(t)}}),q=[];s.read();){o=parseInt(o)+1;var r=s.getString(1);l.indexOf(r)>-1&&(r=r+"_"+(parseInt(o)+1));var d={};d.ID=e.Utility.Util.getValueOfInt(s.get(0)),d.Name=r,d.IsDefault=s.getString(3),l.push(s.getString(1)),q.push(d)}s.close()}catch(e){console.log(e)}s=null,ue.html(i),ue.css("min-width",N+"px"),_=i;for(var c=document.getElementsByClassName("vis-reptabledetect"),p=0,u=0,g=0,h=c.length;g<h;g++)(u=t(c[g]).width())>p&&(p=u);ue.css("width",p+50)}de(!1)},de=function(e){ge.css("display",e?"block":"none")};function ce(e){if(j.empty(),e.TotalPage>0){for(var i=0;i<e.TotalPage;i++)j.append(t("<option value="+(i+1)+">"+(i+1)+"</option>"));j.val(e.CurrentPage),M.setIteration(e.TotalPage),e.TotalPage>e.CurrentPage?(B.css("opacity","1"),W.css("opacity","1")):(B.css("opacity","0.6"),W.css("opacity","0.6")),e.CurrentPage>1?(P.css("opacity","1"),U.css("opacity","1")):(P.css("opacity","0.6"),U.css("opacity","0.6")),1==e.TotalPage&&(P.css("opacity","0.6"),U.css("opacity","0.6"),B.css("opacity","0.6"),W.css("opacity","0.6"))}else P.css("opacity","0.6"),U.css("opacity","0.6"),B.css("opacity","0.6"),W.css("opacity","0.6")}c=t("<div class='vis-report-header' style='padding: 0;'>").append(t('<h3 class="vis-report-tittle">').append(e.Msg.getMsg("Report"))),p=t('<a href="javascript:void(0)" class="vis-icon-menuclose vis vis-cross">'),u=t('<div class="vis-report-top-icons">'),g=t('<ul class="vis-reporticonsul">'),u.append(g),k=t("<li><a  title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("ReportFormat"))+"'  class='vis vis-format'></a></li>"),g.append(k),D=t("<li><a  title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("SaveCSV"))+"' class='vis vis-save-csv'></a></li>"),g.append(D),b=t("<li style='display:none'><a  title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("SaveAllRecordCsv"))+"' class='vis vis-csv-all'></a></li>"),g.append(b),I=t("<li><a title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("SavePdf"))+"' class='vis vis-save-pdf'></a></li>"),g.append(I),w=t("<li style='display:none'><a title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("SaveAllPagePdf"))+"' class='vis vis-pdf-all'></a></li>"),g.append(w),h=t("<li><a title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("Archive"))+"' class='vis vis-archive'></a></li>"),g.append(h),v=t("<li><a title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("Requery"))+"' class='vis vis-refresh'></a></li>"),g.append(v),f=t("<li><a title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("Search"))+"' class='vis vis-find'></a></li>"),g.append(f),m=t("<li><a title='"+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("PrintCustomize"))+"' class='vis vis-customize'></a></li>"),g.append(m),y=t('<li><a title="'+e.Utility.Util.cleanMnemonic(e.Msg.getMsg("Print"))+'" class="vis vis-print"></a></li>'),g.append(y),R=t("<div class='vis-report-top-icons'>"),E=t('<ul class="vis-statusbar-ul vis-toppaging">'),P=t('<li style="opacity: 1;"><div><i class="vis vis-shiftleft" aria-hidden="true" title="'+e.Msg.getMsg("FirstPage")+'"></i ></div ></li > '),U=t('<li style="opacity: 1;"><div><i class="vis vis-arrow-left" aria-hidden="true" title="'+e.Msg.getMsg("PageUp")+'"></i></div></li>'),j=t("<select>"),F=t("<li>").append(j),B=t('<li style="opacity: 1;"><div><i class="vis vis-arrow-right" aria-hidden="true" title="'+e.Msg.getMsg("PageDown")+'"></i></div></li>'),W=t('<li style="opacity: 1;"><div><i class="vis vis-shiftright" aria-hidden="true" title="'+e.Msg.getMsg("LastPage")+'"></i></div></li>'),E.append(P).append(U).append(F).append(B).append(W),P.on("click",(function(){"1"==t(this).css("opacity")&&se(1)})),U.on("click",(function(){"1"==t(this).css("opacity")&&se(parseInt(j.val())-1)})),B.on("click",(function(){"1"==t(this).css("opacity")&&se(parseInt(j.val())+1)})),W.on("click",(function(){"1"==t(this).css("opacity")&&se(parseInt(j.find("Option:last").val()))})),j.on("change",(function(){se(j.val())})),R.append(E),c.append(R),c.append(u),c.append(p),d.append(c),ae();var pe=t("<div Style='width:"+N+"px; max-height: "+(V-50)+"px;' class='vis-report-a-r-container'>"),ue=t("<div Style='width:"+N+"px;'>");pe.append(ue);var ge=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>');de(!0),pe.append(ge),a||d.append(pe),C.hideHeader(!0),C.setContent(M),C.show()},e.AReport=function(i,n,a,s,l,o,r,d){var c=null,p=o,u=r,g=l.getAD_Window_ID(),h=(i=i,new e.ReportViewer(s,l));r>0&&h.setNodeID(r),o>0&&h.setTreeID(o),d||h.showSummary(d),i&&h.setAD_Table_ID(i);var v=function(i,s,l){var o=[];o.push(n.getTableName()),n.reportWhere&&""!=n.reportWhere?o.push(n.reportWhere):o.push(n.getWhereClause(!0)),a&&o.push(a.toString());var r=null;r=null!=i?i.Key:s;var c=h.getGenerateReportPara(o,n.getCode(0),s>0&&a>0,u,p,d,0,1,"",r,g);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:c,type:"POST",success:function(t){null==t&&alert(e.Msg.getMsg("ERRORGettingRepData"));var a=jQuery.parseJSON(t),s=a.repInfo;if(s.IsError)return e.ADialog.error(s.ErrorText),void h.close();s.HTML&&s.HTML.length>0&&(h.show(s.HTML,s.AD_PrintFormat_ID,i,l,o,n.getCode(0),a.pSetting),h.setReportBytes(s.Report),h.setIteration(a.pSetting.TotalPage),"1"!=e.context.ctx.$AutoArchive&&"2"!=e.context.ctx.$AutoArchive||h.archiveDocument(o,l,s.Report))}})};!function(i){c=e.context.getAD_Client_ID(),l=null;var n=null,s=[];try{var l=null;for(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetPrintFormats",data:{AD_Table_ID:i,AD_Tab_ID:a},success:function(t){l=(new e.DB.DataReader).toJson(t)}});l.read();)e.Utility.Util.getValueOfInt(l.get(2).toString())==c&&((n={}).Key=e.Utility.Util.getValueOfInt(l.get(0)),n.Name=l.getString(1),s.push(n));l.close(),0==s.length?null==n?v(null,i,i):v(n,0,i):v(s[0],0,i)}catch(e){l.close()}}(i)},e.APrint=function(a,s,l,o,d,c,p){var u=null==c?0:c.getAD_Window_ID();function g(i,n,r){var c=e.ProcessCtl.prototype.ORIGIN_FORM;u>0&&(c=e.ProcessCtl.prototype.ORIGIN_WINDOW),d&&0!=d.length?t.ajax({url:e.Application.contextUrl+"JsonData/GenerateMultiPrint/",dataType:"json",data:{AD_Process_ID:a,Name:"Print",AD_Table_ID:s,RecIDs:d,WindowNo:o,filetype:r,actionOrigin:c,originName:e.context.getWindowContext(o,"WindowName")},success:function(t){null==t&&alert(e.Msg.getMsg("ERRORGettingRepData"));var i=jQuery.parseJSON(t);n&&n(),i.IsError?e.ADialog.error(i.ErrorText):i.ReportFilePath&&window.open(e.Application.contextUrl+i.ReportFilePath)}}):t.ajax({url:e.Application.contextUrl+"JsonData/GeneratePrint/",dataType:"json",data:{AD_Process_ID:a,Name:"Print",AD_Table_ID:s,Record_ID:l,WindowNo:o,filetype:r,actionOrigin:c,originName:e.context.getWindowContext(o,"WindowName")},success:function(t){null==t&&alert(e.Msg.getMsg("ERRORGettingRepData"));var i=jQuery.parseJSON(t);if(n&&n(),i.IsError)e.ADialog.error("","",i.Message,null);else if(i.ReportFilePath)window.open(e.Application.contextUrl+i.ReportFilePath);else if(i.IsTelerikReport){if(window.KJS)new KJS.TelerikContainer(i.AD_PInstance_ID,s).show(),this.unlock()}else if(e.context.getIsUseCrystalReportViewer()){new e.ReportViewerContainer(i).show()}}})}n.off("click"),n.on("click","LI",(function(e){g(!1,null,t(e.target).data("val"))})),this.start=function(s){var l=[];function o(){var e=t(t(t(document).find(".w2ui-overlay").find("li"))[0]),i=e.eq(0);t("#w2ui-overlay-main").attr("tabindex",1),t("#w2ui-overlay-main").focus(),t("#w2ui-overlay-main").keydown((function(n){if(40===n.which)i?(i.hasClass("vis-selected-li-print")&&i.removeClass("vis-selected-li-print"),next=i.next(),i=next.length>0?next.addClass("vis-selected-li-print"):e.eq(0).addClass("vis-selected-li-print")):i=e.eq(0).addClass("vis-selected-li-print");else if(38===n.which)i?(i.hasClass("vis-selected-li-print")&&i.removeClass("vis-selected-li-print"),next=i.prev(),i=next.length>0?next.addClass("vis-selected-li-print"):e.last().addClass("vis-selected-li-print")):i=e.last().addClass("vis-selected-li-print");else if(13===n.which){if(i)g(!1,null,i.data("val")),t("#w2ui-overlay-main").off("keydown"),t("#w2ui-overlay-main").remove()}else t("#w2ui-overlay-main").off("keydown"),t("#w2ui-overlay-main").remove();return n.stopPropagation(),!1}))}l[0]=new e.DB.SqlParam("@AD_Process_ID",a),"Y"==function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return r(s,a,(function(t){i=(new e.DB.DataSet).toJson(t);var i=(new e.DB.DataSet).toJson(t);l=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null,i.dispose(),i=null,a&&n(l)})),l}("VIS_149",l)&&e.context.getIsUseCrystalReportViewer()?g(!1,null,e.ProcessCtl.prototype.REPORT_TYPE_PDF):n.find("LI").length>0?(document.activeElement===document.body?s.w2overlay(i.clone(!0),{css:{height:"300px"}}):t(document.activeElement).w2overlay(i.clone(!0),{css:{height:"300px"},align:"right"}),window.setTimeout((function(){o()}),100)):(!function(s){t.ajax({url:e.Application.contextUrl+"JsonData/GetReportFileTypes/",dataType:"json",data:{AD_Process_ID:a},success:function(e){if(null!=e){var a=jQuery.parseJSON(e);if(0!=a.length){for(var l=0;l<a.length;l++){var o="";o=t(0==l?"<li tabindex="+l+" data-val="+a[l].Key+" class='vis-selected-li-print'>"+a[l].Name+"</li>":"<li tabindex="+l+" data-val="+a[l].Key+">"+a[l].Name+"</li>"),n.append(o),o=null}document.activeElement===document.body?s.w2overlay(i.clone(!0),{css:{height:"300px"}}):t(document.activeElement).w2overlay(i.clone(!0),{align:"right",css:{height:"300px"}})}}}})}(s),window.setTimeout((function(){o()}),100))},this.startPdf=function(t){g(0,t,e.ProcessCtl.prototype.REPORT_TYPE_PDF)},this.startCsv=function(t){g(0,t,e.ProcessCtl.prototype.REPORT_TYPE_CSV)}},e.ReportViewerContainer=function(i){var n=t('<div class="vis-reportrootdiv"> '),a=t('<div class="vis-busyindicatorouterwrap bsyCrsyVwr"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>');this.getRoot=function(){return n},this.addReport=function(){n.append(a),s(!0);var l=t("<iframe style = 'width:100%;height:99.4%;' pluginspage='http://www.adobe.com/products/acrobat/readstep2.html'>");i.pi&&i.pi.getAD_PInstance_ID()?l.attr("src",e.Application.contextUrl+"Areas/VIS/WebPages/CrystalReprotViewer.aspx?title=rpt&aid="+i.pi.getAD_PInstance_ID()+"&pid="+i.pi.getAD_Process_ID()+"&tid="+i.pi.getTable_ID()+"&rid="+i.pi.getRecord_ID()):l.attr("src",e.Application.contextUrl+"Areas/VIS/WebPages/CrystalReprotViewer.aspx?title=rpt&aid="+i.AD_PInstance_ID+"&pid="+i.AD_Process_ID+"&tid="+i.AD_Table_ID+"&rid="+i.RecordID),n.append(l)},this.dispose=function(){n.remove(),n=null};var s=function(e){a.css("display",e?"block":"none")};this.show=function(){var t=new e.CFrame;t.setName(e.Msg.getMsg("Report")),t.setTitle(e.Msg.getMsg("Report")),t.setContent(this),this.addReport(),t.show()}}}(VIS,jQuery)},7931:()=>{!function(e,t){var i=e.Application.contextUrl+"JsonData/JDataSetWithCode",n=function(n,a,s){var l=!!s,o={sql:n,page:1,pageSize:0};a&&(o.param=a);var r=null;return function(e,n,a){var s=null;t.ajax({url:i,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:n,data:JSON.stringify(e)}).done((function(e){s=e,a&&a(e)}))}(o,l,(function(t){r=(new e.DB.DataReader).toJson(t),s&&s(r)})),r};e.ARequest=function(i,a,s,l,o,r){var d="",c=null,p=null;this.getRequests=function(i){for(var l=n("VIS_72",null);l.read();)if(0==parseInt(l.getString(0)))return void e.ADialog.error("VIS_NotSupported");d="(AD_Table_ID="+a+" AND Record_ID="+s+")",114==a?d+=" OR AD_User_ID="+s+" OR SalesRep_ID="+s:291==a?d+=" OR C_BPartner_ID="+s:259==a?d+=" OR C_Order_ID="+s:318==a?d+=" OR C_Invoice_ID="+s:335==a?d+=" OR C_Payment_ID="+s:208==a?d+=" OR M_Product_ID="+s:203==a?d+=" OR C_Project_ID="+s:539==a&&(d+=" OR A_Asset_ID="+s);l=null;t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetProcessedRequest",data:{AD_Table_ID:a,Record_ID:s},success:function(t){l=(new e.DB.DataReader).toJson(t)}});for(var o=0,c=0;l.read();)"Y"==l.getString(0)?o=l.getString(1):c+=l.getString(1);var p=t("<div>"),v=t("<ul class=vis-apanel-rb-ul>");p.append(v);var f=t("<li data-id='RequestCreate'>");f.append(e.Msg.getMsg("RequestNew")),f.on("click",(function(e){u(e)})),v.append(f),c>0&&((f=t("<li data-id='RequestActive'>")).append(e.Msg.getMsg("RequestActive")),f.on("click",(function(e){g(e)})),v.append(f)),o>0&&((f=t("<li data-id='RequestActive'>")).append(e.Msg.getMsg("RequestAll")),f.on("click",(function(e){h(e)})),v.append(f)),r.w2overlay(p.clone(!0),{css:{height:"200px"}})};var u=function(i){i.stopImmediatePropagation(),(c=e.viewManager.startWindow(232,null)).onLoad=function(){var e=c.cPanel.curGC;e.onRowInserting=function(){c.cPanel.cmd_new(!1)},e.onRowInserted=function(){(p=c.cPanel.curTab).setValue("AD_Table_ID",a),p.setValue("Record_ID",s),null!=l&&l>0&&p.setValue("C_BPartner_ID",l),291==a?p.setValue("C_BPartner_ID",s):114==a?p.setValue("AD_User_ID",s):203==a?p.setValue("C_Project_ID",s):539==a?p.setValue("A_Asset_ID",s):259==a?p.setValue("C_Order_ID",s):318==a?p.setValue("C_Invoice_ID",s):208==a?p.setValue("M_Product_ID",s):335==a?p.setValue("C_Payment_ID",s):319==a&&p.setValue("M_InOut_ID",s)}};var n=t("#w2ui-overlay");n.hide(),n=null},g=function(i){i.stopImmediatePropagation();var n=new e.Query;n.addRestriction("("+d+") AND Processed='N'"),e.viewManager.startWindow(232,n);var a=t("#w2ui-overlay");a.hide(),a=null},h=function(i){i.stopImmediatePropagation();var n=new e.Query;n.addRestriction(d),e.viewManager.startWindow(232,n);var a=t("#w2ui-overlay");a.hide(),a=null}}}(VIS,jQuery)},2502:()=>{!function(e,t){e.Application.contextUrl;e.AZoomAcross=function(i,n,a,s,l,o,r,d){this.init=function(){p()};var c=[],p=function(){var i=null;if(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetZoomTargets",data:{tableName:n},success:function(e){i=JSON.parse(e)}}),null!=i&&i.length>0)for(var l=0;l<i.length;l++){var p=i[l];if(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetZoomTarget",data:{targetTableName:p,curWindow_ID:s,targetWhereClause:a.getWhereClause()},success:function(e){zoomList=JSON.parse(e)}}),null!=zoomList)for(var u in zoomList){var g=zoomList[u],h=!0;for(var v in c)if(c[v].Key==zoomList[u].Key){h=!1;break}h&&c.push(g)}}if(i=null,0==c.length)e.ADialog.info("NoZoomTarget");else{var f=t("<div>"),m=t("<ul class=vis-apanel-rb-ul>");for(var u in f.append(m),c){var y=t("<li data-id='"+c[u].Key+"'>");y.append(c[u].Name),y.on("click",(function(i){i.stopImmediatePropagation();var n=t(this).data("id"),a=new e.Query;a.addRestriction(r,e.Query.prototype.EQUAL,d),e.viewManager.startWindow(n,a);var s=t("#w2ui-overlay-main");s.hide(),s=null})),m.append(y)}o.w2overlay(f.clone(!0),{css:{height:"200px"}})}}}}(VIS,jQuery)},8281:()=>{VIS.Model=VIS.Model||{},function(e,t){var i=!1;function n(t){t||(t="CalloutEngine"),this.log=e.Logging.VLogger.getVLogger(t)}n.prototype.isCalloutActive=function(){return i},n.prototype.setCalloutActive=function(e){i=e},n.prototype.start=function(t,i,n,a,s,l,o){if(null==i||0==i.length)throw new Error("No Method Name");var r="",d=i+" - "+s.getColumnName()+"="+l+" (old="+o+") {active="+this.isCalloutActive()+"}";this.isCalloutActive()||this.log.info(d.toString());var c=this[i];if(null==c&&!(c=this[i=i.charAt(0).toUpperCase()+i.substr(1)]))throw new Error("Method not found: "+i);var p=c.length;if(5!=p&&6!=p)throw new Error("Method "+i+" has invalid no of arguments: "+p);try{r=6==p?this[i](t,n,a,s,l,o):this[i](t,n,a,s,l)}catch(t){this.setCalloutActive(!1),this.log.log(e.Logging.Level.SEVERE,"start: "+i,t),r=t.toString()}return r},n.prototype.DateAcct=function(e,t,i,n,a,s){return this.isCalloutActive()?"":a?(i.setValue("DateAcct",a),"C_BankStatementLine"==i.getTableName()&&i.setValue("ValutaDate",a),this.setCalloutActive(!1),i=a=null,""):""},n.prototype.Rate=function(t,i,n,a,s,l){if(this.isCalloutActive()||null==s)return"";this.setCalloutActive(!0);var o=s,r=e.Env.ZERO;return 0!=e.Utility.Util.getValueOfDouble(o)&&(r=(1/o).toFixed(12)),"MultiplyRate"==a.getColumnName().toString()?n.setValue("DivideRate",r):n.setValue("MultiplyRate",r),this.log.info(a.getColumnName()+"="+o+" => "+r),this.setCalloutActive(!1),n=a=s=null,""},e.Model.CalloutEngine=n,e.CalloutEngine=n}(VIS,jQuery)},3158:()=>{!function(e,t){e.ChildDialog=function(){var i=t("<div></div>"),n="Dialog",a="auto",s="auto",l=!0,o=!0,r={at:"center center",of:window};this.onOkClick=null,this.onCancelClick=null,this.onClose=null,this.setTitle=function(e){n=e},this.setModal=function(e){l=e},this.changeTitle=function(e){i.dialog("widget").find(".ui-dialog-title").text(e)},this.setHeight=function(e){a=e},this.setWidth=function(e){s=e},this.setPosition=function(e){r=e},this.setEnableResize=function(e){o=e};var d=this;function c(){d.onClose&&d.onClose(),d.dispose(),d=null}this.setContent=function(e){i.empty(),i.append(e)},this.getRoot=function(){return i},this.hidebuttons=function(){i.dialog("widget").find(".ui-dialog-buttonpane .ui-button").hide(),i.dialog("widget").find(".ui-widget-content").css("border","0px"),i.dialog("widget").find(".ui-dialog-buttonpane").css("padding","0px"),i.dialog("widget").find(".ui-dialog-buttonpane").css("margin-top","0px"),i.dialog("widget").find(".ui-dialog .ui-dialog-buttonpane").hide()},this.hideButtons=function(){i.dialog("widget").find(".ui-dialog-buttonpane .ui-button").hide(),i.dialog("widget").find(".ui-widget-content").css("border","0px"),i.dialog("widget").find(".ui-dialog-buttonpane").css("padding","0px"),i.dialog("widget").find(".ui-dialog-buttonpane").css("margin-top","0px"),i.dialog("widget").find(".ui-dialog .ui-dialog-buttonpane").hide()},this.close=function(){i.dialog("close"),this.dispose()},this.show=function(){var p="",u="margin-right:12px";return e.Application.isRTL&&(p="margin-right:7px;",u=""),i.dialog({height:a,width:s,title:n,modal:l,resizable:o,closeOnEscape:!0,closeText:e.Msg.getMsg("close"),position:r,buttons:[{text:e.Msg.getMsg("Ok"),click:function(e){var n=e.target;t(n).attr("disabled",!0);var a=!0;d.onOkClick&&(a=d.onOkClick(e)),1==a||null==a?null!=i&&i.dialog("close"):t(n).attr("disabled",!1)},style:u},{text:e.Msg.getMsg("Cancel"),click:function(){d.onCancelClick&&d.onCancelClick(),i&&i.dialog("close")},style:p}],close:c}),t(document).on("keydown",(function(e){if(event.altKey&&37==event.keyCode)return e.preventDefault(),!1;e.stopPropagation()})),t(".ui-dialog .ui-dialog-buttonpane").css("border-width","0 0 0"),i},this.dispose=function(){null!=i&&(i.dialog("destroy"),i.remove()),i=null,this.Show=null,this.setContent=null,this.setTitle=null}}}(VIS,jQuery)},6451:()=>{!function(e,t){var i=/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2})/,n=(t.Logging.Level,t.Application.contextUrl+"JsonData/JDataSetWithCode"),a=function(i,a,s,l){var o=!!s,r={sql:i,page:1,pageSize:0};a&&(r.param=a);var d=null;return function(t,i,a,s){var l=null;e.ajax({url:n,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(t)}).done((function(e){l=e,a&&a(e)}))}(r,o,(function(e){d=(new t.DB.DataReader).toJson(e),s&&s(d)})),d};function s(e){this.log=t.Logging.VLogger.getVLogger("AccessSqlParser"),this.sqlOriginal,this.sql=[],this.tableInfo=[],this.setSql(e)}function l(e,t){this.tableName=e,this.synonym=t}function o(e,i,n,a,s,l){this.m_cacheK=[],this.m_cacheV=[],this.m_tableName=e,this.m_resetAll=a||!1,this.m_tableName2=l,this.setExpireMinutes(n),t.CacheMgt.register(this)}t.Evaluator={parseDepends:function(e,t){if(null!=t&&0!=t.length)for(var i=t;-1!=i.indexOf("@");){var n=i.indexOf("@");if(-1!=(n=(i=i.substring(n+1)).indexOf("@"))){var a=i.substring(0,n);i=i.substring(n+1),e.indexOf(a)<0&&(e[e.length]=a)}}},evaluateLogic:function(e,i){var n=new t.StringTokenizer(i.trim(),"&|",!0),a=n.countTokens();if(a/2-(a+1)/2==0)return!1;for(var s=this.evaluateLogicDouble(e,n.nextToken());n.hasMoreTokens();){var l=n.nextToken().trim(),o=this.evaluateLogicDouble(e,n.nextToken());if(l.equals("&"))s=s&&o;else{if(!l.equals("|"))return!1;s=s||o}}return s},evaluateLogicDouble:function(e,i){var n=new t.StringTokenizer(i.trim(),"!=^><",!0);if(3!==n.countTokens())return!1;var a=n.nextToken().trim(),s=a.trim();-1!=a.indexOf("@")&&(a=a.replaceAll("@"," ").trim(),null==(s=e.getValueAsString(a))&&(s="")),s=s.replaceAll("'"," ").replaceAll('"'," ").trim();var l=n.nextToken(),o=n.nextToken(),r=o.trim();return-1!=o.indexOf("@")&&"@"==o[0]&&"@"==o[o.length-1]&&(o=o.replaceAll("@"," ").trim(),null==(r=e.getValueAsString(o))&&(r="")),r=r.replaceAll("'"," ").replaceAll('"'," ").trim(),-1!=a.indexOf("_ID")&&0==s.length&&(s="0"),-1!=o.indexOf("_ID")&&0==r.length&&(r="0"),"0"!=s||""!=r&&"null"!=r||(r="0"),0==s.length&&"null"==r&&(r=""),this.evaluateLogicTuple(s,l,r)},evaluateLogicTuple:function(e,t,i){if(null==e||null==t||null==i)return!1;var n=0,a=0;try{e.startsWith("'")||isNaN(e)||(n=Number(e)),i.startsWith("'")||isNaN(i)||(a=Number(i))}catch(e){n=0,a=0}return t.equals("=")?0!=n&&0!=a?0==n.compareTo(a):0==e.compareTo(i):t.equals("<")?0!=n&&0!=a?n.compareTo(a)<0:e.compareTo(i)<0:t.equals(">")?0!=n&&0!=a?n.compareTo(a)>0:e.compareTo(i)>0:0!=n&&0!=a?0!=n.compareTo(a):0!=e.compareTo(i)},getVariables:function(e){for(var i=[],n=new StringBuilder,a=new t.StringTokenizer(e,"@");a.hasMoreTokens();)if(n.append(a.nextToken()),a.hasMoreTokens()){n.append("?");var s=a.nextToken();-1!=s.indexOf("|")&&(s=s.substring(0,s.indexOf("|"))),-1===i.indexOf(s)&&i.push(s)}return i},replaceVariables:function(e,t,i){var n=e,a=[];this.parseDepends(a,e);for(var s=0;s<a.length;s++){var l=a[s];if(-1!=l.indexOf("\n"))break;var o=null;if(null!=i&&(o=i.get(l)),null==o&&(o=t.getContext(l)),null!=o&&o.length>0){var r=null;try{r=new Number(o)}catch(e){}if(null!=r)n=n.replaceAll("@"+l+"@",r.toString());else{var d=null;try{d=new Double(o)}catch(e){}n=null!=d?n.replaceAll("@"+l+"@",d.toString()):n.replaceAll("@"+l+"@",o.replaceAll("'","''"))}}else n=n.replaceAll("@"+l+"@","NULL")}return n},evaluateLogicByRowData:function(e,i){var n=new t.StringTokenizer(i.trim(),"&|",!0),a=n.countTokens();if(a/2-(a+1)/2==0)return!1;for(var s=this.evaluateLogicByRowDouble(e,n.nextToken());n.hasMoreTokens();){var l=n.nextToken().trim(),o=this.evaluateLogicByRowDouble(e,n.nextToken());if(l.equals("&"))s=s&&o;else{if(!l.equals("|"))return!1;s=s||o}}return s},evaluateLogicByRowDouble:function(e,i){var n=new t.StringTokenizer(i.trim(),"!=^><",!0);if(3!==n.countTokens())return!1;var a=n.nextToken().trim(),s=a.trim();-1!=a.indexOf("@")&&(a=a.replaceAll("@"," ").trim(),s=null==(s=e.getValue(a))?"":(s=!0===s?"Y":!1===s?"N":s).toString()),s=s.replaceAll("'"," ").replaceAll('"'," ").trim();var l=n.nextToken(),o=n.nextToken(),r=o.trim();return-1!=o.indexOf("@")&&"@"==o[0]&&"@"==o[o.length-1]&&(o=o.replaceAll("@"," ").trim(),r=null==(r=e.getValue(o))?"":(r=!0===r?"Y":!1===r?"N":r).toString()),r=r.replaceAll("'"," ").replaceAll('"'," ").trim(),-1!=a.indexOf("_ID")&&0==s.length&&(s="0"),-1!=o.indexOf("_ID")&&0==r.length&&(r="0"),"0"!=s||""!=r&&"null"!=r||(r="0"),0==s.length&&"null"==r&&(r=""),this.evaluateLogicTuple(s,l,r)}},t.Query=function(e,t){this.tableName=e||"",this.list=[],this.recordCount=999999,this.newRecord=!1,this.isORcondition=!1,t&&1==t&&(this.isORcondition=!0)},t.Query.prototype.addRestriction=function(){var e=null;if(5==arguments.length)e=new t.QueryRestriction(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),this.isORcondition&&(e.andCondition=!1),arguments[3].toString().startsWith("-")||this.list.push(e);else if(3==arguments.length)e=new t.QueryRestriction(arguments[0],arguments[1],arguments[2],null,null),this.isORcondition&&(e.andCondition=!1),this.list.push(e);else{if(1!=arguments.length)throw new Error("invalid arguments Addrestriction");var i=arguments[0];if("string"==typeof i){if(null==i||0==i.trim().length)return;e=new t.QueryRestriction(i),this.isORcondition&&(e.andCondition=!1),this.list.push(e),this.newRecord=i.equals(t.Query.NEWRECORD)}else e=i,this.isORcondition&&(e.andCondition=!1),this.list.push(e)}e=null},t.Query.prototype.setTableName=function(e){this.tableName=e},t.Query.prototype.setRecordCount=function(e){this.recordCount=e},t.Query.prototype.setColumnName=function(e,t){e<0||e>=this.list.length||(this.list[e].columnName=t)},t.Query.prototype.getCode=function(e){if(e<0||e>=this.list.length)return null;this.list[e].code},t.Query.prototype.getInfo=function(){var e="",t=null;null!=this.tableName&&(e+=this.tableName+": ");for(var i=0;i<this.list.length;i++)t=this.list[i],0!=i&&(e+=t.andCondition?" AND ":" OR "),e+=t.getInfoName()+t.getInfoOperator()+t.getInfoDisplayAll();return e},t.Query.prototype.getIsActive=function(){return 0!=this.list.length},t.Query.prototype.getIsNewRecordQuery=function(){return this.newRecord},t.Query.prototype.getRecordCount=function(){return this.recordCount},t.Query.prototype.getWhereClause=function(){var e=1==arguments.length&&arguments[0],t="",i=null;if("boolean"==typeof e||isNaN(e)){var n=e;!n||null!=this.tableName&&0!=this.tableName.length||(n=!1);for(var a=0;a<this.list.length;a++)i=this.list[a],0!=a&&(t+=i.andCondition?" AND ":" OR "),t+=n?i.getSQL(this.tableName):i.getSQL(null);return t.length>0?" ( "+t+" ) ":t}return e>=0&&e<this.list.Count&&(t+=(i=this.list[e]).GetSQL(null)),t},t.Query.prototype.getRestrictionCount=function(){return this.list.length},t.Query.prototype.clear=function(){this.list=[]},t.Query.prototype.getRestrictions=function(){return this.list},t.Query.prototype.copyRestrictions=function(e){this.list=this.list.concat(e)},t.Query.prototype.addRangeRestriction=function(){var e=null;e=3==arguments.length?new t.QueryRestriction(arguments[0],arguments[1],arguments[2],null,null,null):new t.QueryRestriction(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),this.list.push(e)},t.Query.prototype.getColumnName=function(e){return e<0||e>=this.list.length?null:this.list[e].columnName},t.Query.prototype.getTableName=function(){return this.tableName},t.Query.prototype.getOperator=function(e){return e<0||e>=this.list.length?null:this.list[e].operator},t.Query.prototype.getCodeTo=function(e){return e<0||e>=this.list.Count?null:this.list[e].code_to},t.Query.prototype.getInfoDisplay=function(e){return e<0||e>=this.list.length?null:this.list[e].infoDisplay},t.Query.prototype.getInfoDisplay_to=function(e){return e<0||e>=this.list.length?null:this.list[e].infoDisplay_to},t.Query.prototype.getInfoName=function(e){return e<0||e>=this.list.length?null:this.list[e].infoName},t.Query.prototype.getInfoOperator=function(e){return e<0||e>=this.list.length?null:this.list[e].getInfoOperator()},t.Query.prototype.getInfoDisplayAll=function(e){return e<0||e>=_list.Count?null:this.list[e].getInfoDisplayAll()},t.Query.prototype.deepCopy=function(){for(var e=new t.Query(this.tableName),i=0;i<this.list.length;i++)e.addRestriction(this.list[i]);return e},t.Query.prototype.getNoRecordQuery=function(e,i){var n=new t.Query(e);return i?n.AddRestriction(t.Query.NEWRECORD):n.AddRestriction("1=2"),n.setRecordCount(0),n},t.Query.prototype.NEWRECORD="2=3",t.Query.prototype.EQUAL="=",t.Query.prototype.EQUAL_INDEX=0,t.Query.prototype.NOT_EQUAL="!=",t.Query.prototype.LIKE=" LIKE ",t.Query.prototype.NOT_LIKE=" NOT LIKE ",t.Query.prototype.GREATER=">",t.Query.prototype.GREATER_EQUAL=">=",t.Query.prototype.LESS="<",t.Query.prototype.LESS_EQUAL="<=",t.Query.prototype.BETWEEN=" BETWEEN ",t.Query.prototype.BETWEEN_INDEX=8,t.Query.prototype.IN=" IN ",t.Query.prototype.NOT_IN=" NOT IN ",t.Query.prototype.OPERATORS={"=":" = ","!=":" != "," LIKE ":" ~ "," NOT LIKE ":" !~ ",">":" > ",">=":" >= ","<":" < ","<=":" <= "," BETWEEN ":" >-< "},t.Query.prototype.CVOPERATORS={"=":" = ","!=":" != ",">":" > ","<":" < "},t.Query.prototype.OPERATORS_ID={"=":" = ","!=":" != "},t.Query.prototype.CVOPERATORS_ID={"=":" = ","!":" != "},t.Query.prototype.OPERATORS_YN={"=":" = "},t.Query.prototype.OPERATORS_DATE_DYNAMIC={0:"Today",1:"lastxDays",2:"lastxMonth",3:"lastxYears"},t.Query.prototype.OPERATORS_DYNAMIC_ID={"@#AD_User_ID@":"LoginUser"},t.Query.prototype.getEqualQuery=function(e,i){var n=new t.Query;return n.addRestriction(e,t.Query.prototype.EQUAL,i),n.setRecordCount(1),n},t.QueryRestriction=function(){switch(this.directWhereClause=null,this.columnName,this.infoName,this.operator,this.code,this.infoDisplay,this.code_to,this.infoDisplay_to,this.andCondition=!0,arguments.length){case 5:this.fnArgu5(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]);break;case 6:this.fnArgu6(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);break;case 9:this.fnArgu9(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);break;case 1:this.fnArgu1(arguments[0]);break;case 0:break;default:throw new Error("Invalid arguments")}},t.QueryRestriction.prototype.fnArgu5=function(e,t,i,n,a){var s,l,o,r=e.trim();s=null!=n?n:r,Operator=t,null!=(l=null!=i&&"Boolean"==typeof i?1==new Boolean(i)?"Y":"N":i)&&"string"==typeof l&&(l.startsWith("'")&&(l=l.substring(1)),l.endsWith("'")&&(l=l.substring(0,l.length-2))),null!=a?o=a.toString().trim():null!=i&&(o=i),this.columnName=r,this.infoName=s,this.operator=Operator,this.code=l,this.infoDisplay=o},t.QueryRestriction.prototype.fnArgu6=function(e,i,n,a,s,l){this.fnArgu5(e,t.Query.prototype.BETWEEN,i,a,s);var o,r=n;"string"==typeof r&&(r.startsWith("'")&&(r=r.substring(1)),r.endsWith("'")&&(r=r.substring(0,r.length-2))),null!=l?o=l.trim():null!=r&&(o=r.toString()),this.code_to=r,this.infoDisplay_to=o},t.QueryRestriction.prototype.fnArgu9=function(e,t,i,n,a,s,l,o,r){this.columnName=e,this.infoName=n,this.code=t,this.code_to=i,this.infoName=n,this.infoDisplay=a,this.infoDisplay_to=s,this.operator=l,this.directWhereClause=o,this.andCondition=r},t.QueryRestriction.prototype.fnArgu1=function(e){this.directWhereClause=e},t.QueryRestriction.prototype.getInfoName=function(){return this.infoName},t.QueryRestriction.prototype.getInfoOperator=function(){return this.operator in t.Query.OPERATORS?t.Query.OPERATORS[this.operator]:this.operator},t.QueryRestriction.prototype.getInfoDisplayAll=function(){if(null==this.infoDisplay_to)return this.infoDisplay;var e=this.infoDisplay;return e+=" - "+InfoDisplay_to},t.QueryRestriction.prototype.getSQL=function(e){if(null!=this.directWhereClause)return this.directWhereClause;var n="";if("string"==typeof this.code&&isNaN(this.code)&&this.code.toString().toUpper()!="NULLValue".toUpper()&&(n+=" UPPER( "),null!=e&&e.length>0){var a=this.columnName.lastIndexOf("(")+1,s=this.columnName.indexOf(")");n+=-1!=a&&-1!=s?this.columnName.substring(0,a)+e+"."+this.columnName.substring(a,a+(s-a))+this.columnName.substring(s):e+"."+this.columnName}else n+=this.columnName;return"string"==typeof this.code&&isNaN(this.code)&&this.code.toString().toUpper()!="NULLValue".toUpper()&&(n+=" ) "),null==this.code||"NULL".equals(this.code.toString().toUpper())||"NULLValue".toUpper().equals(this.code.toString().toUpper())?this.operator.equals(t.Query.prototype.EQUAL)?n+=" IS NULL ":n+=" IS NOT NULL ":(n+=this.operator+" ",(t.Query.prototype.IN.equals(this.operator)||t.Query.prototype.NOT_IN.equals(this.operator))&&(n+="("),this.code instanceof Date||this.code&&i.test(this.code.toString())?n+=t.DB.to_date(this.code,!1):"string"==typeof this.code?isNaN(this.code)?(n+=" UPPER( ",n+=t.DB.to_string(this.code.toString()),n+=" ) "):n+=t.DB.to_string(this.code.toString()):n+=this.code,t.Query.prototype.BETWEEN.equals(this.operator)?(n+=" AND ",this.code_to instanceof Date||this.code_to&&i.test(this.code_to.toString())?n+=t.DB.to_date(this.code_to,!1):"string"==typeof this.code_to?n+=t.DB.to_string(this.code_to.toString()):n+=this.code_to):(t.Query.prototype.IN.equals(this.operator)||t.Query.prototype.NOT_IN.equals(this.operator))&&(n+=")")),n},s.prototype.FROM=" FROM ",s.prototype.FROM_LENGTH=s.prototype.FROM.length,s.prototype.WHERE=" WHERE ",s.prototype.ON=" ON ",s.prototype.setSql=function(e){if(null==e)throw new IllegalArgumentException("No SQL");this.sqlOriginal=e;var t=this.sqlOriginal.indexOf("\nFROM ");-1!=t&&(this.sqlOriginal=this.sqlOriginal.replace("\nFROM ",this.FROM)),-1!=(t=this.sqlOriginal.indexOf("\nWHERE "))&&(this.sqlOriginal=this.sqlOriginal.replace("\nWHERE ",this.WHERE)),this.parse()},s.prototype.getSql=function(){return this.sqlOriginal},s.prototype.setSql=function(e){if(null==e)throw new IllegalArgumentException("No SQL");this.sqlOriginal=e;var t=this.sqlOriginal.indexOf("\nFROM ");-1!=t&&(this.sqlOriginal=this.sqlOriginal.replaceAll("\nFROM ",this.FROM)),-1!=(t=this.sqlOriginal.indexOf("\nWHERE "))&&(this.sqlOriginal=this.sqlOriginal.replaceAll("\nWHERE ",this.WHERE)),this.parse()},s.prototype.getSql=function(){return this.sqlOriginal},s.prototype.parse=function(){if(null==this.sqlOriginal||0==this.sqlOriginal.length)throw new IllegalArgumentException("No SQL");this.getSelectStatements();for(var e=0;e<this.sql.length;e++){var t=this.getTableInfo(this.sql[e].trim());this.tableInfo.push(t)}return this.tableInfo.length>0},s.prototype.getSelectStatements=function(){var e=[this.sqlOriginal],i=null;try{i=this.getSubSQL(e)}catch(e){throw this.log.log(t.Logging.Level.SEVERE,this.sqlOriginal,e),new IllegalArgumentException(this.sqlOriginal)}for(;e.length!=i.length;){e=i;try{i=this.getSubSQL(e)}catch(e){throw this.log.log(t.Logging.Level.SEVERE,this.sqlOriginal,e),new IllegalArgumentException(i.length+": "+m_sqlOriginal)}}this.sql=i},s.prototype.getSubSQL=function(e){for(var t=[],i="",n=0;n<e.length;n++){for(var a=(i=e[n]).indexOf("(SELECT ",7);-1!=a;){for(var s=a+1,l=0;s++<i.length;){var o=i.charAt(s);if(")"==o){if(0==l)break;l--}else"("==o&&l++}var r=i.substring(a,s+1);t.push(r),a=(i=i.substring(0,a+1)+"##"+i.substring(s)).indexOf("(SELECT ",7)}t.push(i)}return t},s.prototype.getTableInfo=function(e){if(isNaN(e)){var i=[];e.startsWith("(")&&e.endsWith(")")&&(e=e.substring(1,e.length-1));var n=e.indexOf(this.FROM);for(n!=e.lastIndexOf(this.FROM)&&this.log.log(t.Logging.Level.FINE,"More than one FROM clause - "+e);-1!=n;){var a=e.substring(n+this.FROM_LENGTH);for(-1!=(u=a.indexOf(this.WHERE))&&(a=a.substring(0,u)),u=(a=(a=(a=(a=(a=(a=a.replaceAll(" AS "," ")).replaceAll(" as "," ")).replaceAll(" INNER JOIN ",", ")).replaceAll(" LEFT OUTER JOIN ",", ")).replaceAll(" RIGHT OUTER JOIN ",", ")).replaceAll(" FULL JOIN ",", ")).indexOf(this.ON);-1!=u;){var s=a.indexOf(")"),o=a.indexOf(this.ON,u+4);if(-1!=o&&(s=a.lastIndexOf(")",o)),-1==s){this.log.log(t.Logging.Level.SEVERE,"Could not remove ON "+a);break}u=(a=a.substring(0,u)+a.substring(s+1)).indexOf(this.ON)}for(var r=new t.StringTokenizer(a,",");r.hasMoreTokens();){var d=r.nextToken().trim(),c=new t.StringTokenizer(d," "),p=null;p=c.countTokens()>1?new l(c.nextToken(),c.nextToken()):new l(d),i.push(p)}n=(e=e.substring(0,n)).lastIndexOf(this.FROM)}return i}var u;return(u=e)<0||u>this.tableInfo.length?null:this.tableInfo[u]},s.prototype.getSqlStatement=function(e){return e<0||e>this.sql.length?null:this.sql[e]},s.prototype.getNoSqlStatments=function(){return null==this.sql?0:this.sql.length},s.prototype.getMainSqlIndex=function(){if(null==this.sql)return-1;if(1==this.sql.length)return 0;for(var e=this.sql.length-1;e>=0;e--)if("("!=this.sql[e].charAt(0))return e;return-1},s.prototype.getMainSql=function(){if(null==this.sql)return this.sqlOriginal;if(1==this.sql.length)return this.sql[0];for(var e=this.sql.length-1;e>=0;e--)if("("!=this.sql[e].charAt(0))return this.sql[e];return""},s.prototype.size=function(){return this.tableInfo.length},l.prototype.getSynonym=function(){return null==this.synonym?"":this.synonym},l.prototype.getTableName=function(){return this.tableName},t.TableInfo=l,t.AccessSqlParser=s,t.ZoomTarget={log:t.Logging.VLogger.getVLogger("VIS.ZoomTarget"),getZoomAD_Window_ID:function(e,i,n,s){var l=0,o=0;e.equals("M_Product");var r="VIS_78",d=[];d[0]=new t.DB.SqlParam("@targetTableName",e);var c=null;try{(c=a(r,d)).read()&&(l=c.getInt(0),o=c.getInt(1))}catch(e){this.log.log(t.Logging.Level.SEVERE,r,e)}finally{null!=c&&c.dispose(),c=null}if(0==o)return l;if(0!=o&&0!=l&&null!=n&&0!=n.length){var p=null,u=e.indexOf("Line");-1!=u&&(p=e.substring(0,u)),null!=p&&(s=t.dataContext.getJSONData(t.Application.contextUrl+"Form/GetZoomIsSOTrx",{parentTable:p,targetTableName:e,targetWhereClause:t.secureEngine.encrypt(n)}))}var g=0;if(null!=n&&0!=n.length){var h;null!=(h=this.getZoomTargets(e,i,n))&&h.length>0&&(g=h[0].Key)}return 0!=g?g:s?l:o},parseColumns:function(e,t){if(null!=t&&0!=t.length){var i=t;if(!(i.contains(" EXISTS ")||i.contains(" IN ")||i.contains("(")||i.contains(")")))for(;-1!=i.indexOf("=");){var n=i.indexOf("="),a=i.substring(0,n),s=(a=a.trim()).lastIndexOf(" ",a.length),l=a.substring(s+1);-1!=l.indexOf(".")&&(s=l.indexOf(".")+1,l=l.substring(s,l.length)),e.indexOf(l)<0&&e.push(l),i=i.substring(n+1)}}},evaluateWhereClause:function(e,i){if(null==i||0==i.length)return!0;var n=i,a=!0;if(n.contains(" EXISTS ")||n.contains(" IN ")||n.contains("(")||n.contains(")"))return!1;for(;-1!=n.indexOf("=");){var s=n.indexOf("="),l=n.lastIndexOf(" ",s),o=n.substring(l+1,s),r="",d="";-1!=o.indexOf(".")&&(l=o.indexOf(".")+1,o=o.substring(l,o.length));for(var c=0;c<e.length;c++)if(o.equals(e[c].Name)){r=e[c].Value;break}if(l=0,d=-1==(s=(n=n.substring(s+1)).indexOf(" "))?n.substring(l):n.substring(l,s),!t.Evaluator.evaluateLogicTuple(r,"=",d)){a=!1;break}}return a},getZoomTargets:function(i,n,s,l){if(4==arguments.length){if(1!=l.length)return null;var o=l[0];d=(d=s.replace("?",o.toString())).replace("WHERE "," "),this.log.fine("WhereClause : "+d),s=d}var r=[],d="",c="VIS_80",p=null;try{for(p=a(c);p.read();){var u=p.getInt(0),g=p.getString(1);g.equals("Work Center")?u:g.equals("Work Center Costs")?(u,g):g.equals("Production Resource")&&u}}catch(e){this.log.log(t.Logging.Level.SEVERE,c,e)}finally{null!=p&&p.dispose(),p=null}return""!=s&&s&&(s=t.secureEngine.encrypt(s)),e.ajax({async:!1,url:t.Application.contextUrl+"Form/GetZoomWindow",data:{targetTableName:i,curWindow_ID:n,targetWhereClause:s},success:function(e){r=JSON.parse(e)}}),r}},o.prototype.setExpireMinutes=function(e){if(e>0){this.m_expire=e;var i=6e4*e;this.m_timeExp=t.Env.currentTimeMillis()+i}else this.m_expire=0,this.m_timeExp=0},o.prototype.expire=function(){0!=this.m_expire&&this.m_timeExp<t.Env.currentTimeMillis()&&this.reset()},o.prototype.reset=function(){if(2==arguments.length)return this.reset2(arguments[0],arguments[1]);if(1==arguments.length)return this.reset2(arguments[0]);var e=this.m_cacheK.length;if(this.clear(),0!=this.m_expire){var i=6e4*this.m_expire;this.m_timeExp=t.Env.currentTimeMillis()+i}return e},o.prototype.reset2=function(e,t){return null==this.tableName?-1:e===this.m_tableName||e===this.m_tableName2||this.m_tableName2.startsWith(e)?0==t||this.m_resetAll?reset():this.remove(t):-1},o.prototype.remove=function(e){var t=this.m_cacheK.indexOf(e);return t>-1?(this.m_cacheK.splice(t,1),this.m_cacheV.splice(t,1),1):0},o.prototype.get=function(e){this.expire();var t=this.m_cacheK.indexOf(e);return t>-1?this.m_cacheV[t]:null},o.prototype.contains=function(e){return this.m_cacheK.indexOf(e)>-1},o.prototype.add=function(t,i){if(this.expire(),"function"==typeof i||e.isFunction(i));var n=this.m_cacheK.indexOf(t);n<0?(this.m_cacheK.push(t),this.m_cacheV.push(i)):this.m_cacheV[n]=i},o.prototype.clear=function(){this.m_cacheK.length=0,this.m_cacheV.length=0},o.prototype.size=function(){return this.expire(),this.m_cacheV.length},o.prototype.getTableName=function(){return this.m_tableName},t.CacheMgt=function(){var e=[],i=[],n=t.Logging.VLogger.getVLogger("CacheMgt");function a(){if(2==arguments.length)return s(arguments[0],arguments[1]);if(1==arguments.length)return s(arguments[0]);for(var t=0,i=0,a=0;a<e.length;a++){var l=e.get(a);null!=l&&l.lenght>0&&(n.info(l.toString()),i+=l.reset(),t++)}return t>0&&n.info("#"+t+" ("+i+")"),i}function s(t,s){if(null==t||0==t.length())return a();if(s||(s=0),i.indexOf(t)<0)return 0;t.equals("AD_Role");for(var l=0,o=0,r=0;r<e.length;r++){var d=e[r];if(null!=d){var c=d.reset(t,s);c>=0&&l++,c>0&&(o+=c)}}return l>0&&n.fine(t+": #"+l+" ("+o+")"),o}return{register:function(t){if(null==t)return!1;var n=t.getTableName();return i.push(n),e.push(t),!0},reset:a,unregister:function(t){if(null==t)return!1;for(var i=!1,n=e.lenght-1;n>=0;n--){t===e[n]&&(e.splice(1,1),i=!0)}return i}}}(),t.CCache=o}(jQuery,VIS),function(e){var t=function(e,t,i,n){this.tokenizers=t.splice?t:t.split(""),n&&(this.doBuild=n),this.src=e,this.ended=!1,this.tokens=[],this.returnDelim=i,this.curIndex=0,this.parse()};t.prototype={parse:function(){do{this.next()}while(!this.ended);return this.tokens},build:function(e,t){if(e){if(!this.returnDelim&&this.tokenizers.indexOf(e)>-1)return;this.tokens.push(this.doBuild?this.doBuild(e,t,this.tkn):e)}},next:function(){var e,t=this;t.findMin(),e=t.src.slice(0,t.min),t.build(e,!1),t.src=t.src.slice(t.min).replace(t.tkn,(function(e){return t.build(e,!0),""})),t.src||(t.ended=!0)},findMin:function(){var e,t,i=this,n=0;for(i.min=-1,i.tkn="";void 0!==(e=i.tokenizers[n++]);)-1!=(t=i.src[e.test?"search":"indexOf"](e))&&(-1==i.min||t<i.min)&&(i.tkn=e,i.min=t);-1==i.min&&(i.min=i.src.length)},countTokens:function(){return this.tokens.length},nextToken:function(){return this.hasMoreTokens()?this.tokens[this.curIndex++]:null},hasMoreTokens:function(){return this.curIndex<this.tokens.length},reset:function(){this.curIndex=-1}},e.StringTokenizer=t}(VIS)},4144:()=>{VIS.context.m_map={},VIS.context.getContext=function(e){if(null==e)throw new ArgumentException("Require Context");if(arguments.length>2)return"number"==typeof arguments[1]?this.getWindowTabContext(arguments[0],arguments[1],arguments[2]):this.getWindowContext(arguments[0],arguments[1],arguments[2]);if(2==arguments.length)return this.getWindowContext(arguments[0],arguments[1]);var t=VIS.context.ctx[e];return t||("#AD_User_ID"==e||"#AD_User_Name"==e?VIS.context.getContext("#"+e):"")},VIS.context.getWindowContext=function(e,t,i,n){if(null==t)throw new ArgumentException("Require Context");if("number"==typeof arguments[1]&&arguments.length>2)return VIS.context.getTabRecordContext(arguments[0],arguments[1],arguments[2],n);var a="";"number"==typeof t&&(a="-"+t,t=i,i=n);a="";"number"==typeof t&&(a="-"+t,t=i,i=n);var s=e+a+"|"+t,l="";return this.m_map[e]&&(l=this.m_map[e][s]),l&&""!=l?l:t.startsWith("#")||t.startsWith("$")?VIS.context.getContext(t):i?"":VIS.context.getContext("#"+t)},VIS.context.getWindowTabContext=function(e,t,i){if(null==i)throw new ArgumentException("Require Context");var n="";return this.m_map[e]&&(n=this.m_map[e][e+"|"+t+"|"+i]),VIS.EnvConstants.TAB_INFO==t?null!=n?n:"":n&&""!=n?n:VIS.context.getWindowContext(e,i,!1)},VIS.context.getTabRecordContext=function(e,t,i,n){if(null==i)throw new ArgumentException("Require Context");var a="";return this.m_map[e]&&(a=this.m_map[e][e+"-"+t+"|"+i]),a&&""!=a?a:VIS.context.getWindowContext(e,i,n)},VIS.context.setTabRecordContext=function(e,t,i,n){null!=i&&(this.m_map[e]||(this.m_map[e]={}),this.m_map[e][e+"-"+t+"|"+i]=null==n||""===n?null:n)},VIS.context.setContext=function(e,t){return 4==arguments.length?this.setWindowTabContext(arguments[0],arguments[1],arguments[2],arguments[3]):3==arguments.length?this.setWindowContext(arguments[0],arguments[1],arguments[2]):VIS.context.ctx[e]=t,e},VIS.context.setWindowContext=function(e,t,i,n){if(null!=t){this.m_map[e]||(this.m_map[e]={});var a="";"number"==typeof t&&(a="-"+t,t=i,i=n),this.m_map[e][e+a+"|"+t]=null==i||""===i?null:i}},VIS.context.setWindowTabContext=function(e,t,i,n){null!=i&&(this.m_map[e]||(this.m_map[e]={}),null==n||String(n).equals("")?this.m_map[e][e+"|"+t+"|"+i]=null:this.m_map[e][e+"|"+t+"|"+i]=n)},VIS.context.clearTabContext=function(e,t){var i=this.m_map[e];for(var n in i)n.startsWith(e+"-"+t+"|")&&delete i[n]},VIS.context.getAD_User_ID=function(){return VIS.context.getContextAsInt("##AD_User_ID")},VIS.context.getAD_User_Name=function(){return this.getContext("#AD_User_Name")},VIS.context.getAD_Role_ID=function(){return this.getContextAsInt("#AD_Role_ID")},VIS.context.getAD_Role_Name=function(){return this.getContext("#AD_Role_Name")},VIS.context.getAD_Client_ID=function(){return VIS.context.getContextAsInt("#AD_Client_ID")},VIS.context.getAD_Client_Name=function(){return this.getContext("#AD_Client_Name")},VIS.context.getAD_Org_ID=function(){return VIS.context.getContextAsInt("#AD_Org_ID")},VIS.context.getAD_Language=function(){return VIS.context.getContext("#AD_Language")},VIS.context.setAutoCommit=function(e,t){VIS.context.setWindowContext(e,"AutoCommit",t?"Y":"N")},VIS.context.setAutoNew=function(e,t){VIS.context.setWindowContext(e,"AutoNew",t?"Y":"N")},VIS.context.isAutoNew=function(){var e=VIS.context.getContext("AutoNew");return null!=e&&"Y"===e},VIS.context.getStdPrecision=function(){return VIS.context.getContext("#StdPrecision")},VIS.context.setStdPrecision=function(){return VIS.context.getContext("#StdPrecision")},VIS.context.getIsAutoNew=function(e){var t=this.getWindowContext(e,"AutoNew",!1);return null!=t&&""!=t?!!t.equals("Y"):this.isAutoNew()},VIS.context.isAutoCommit=function(){var e=VIS.context.getContext("AutoCommit");return null!=e&&"Y"===e},VIS.context.setContextOfWindow=function(e,t){if(e&&t){for(prop in e)VIS.context.setWindowContext(t,prop,e[prop]);e=null}},VIS.context.getContextAsInt=function(e,t,i){var n="";if(0==(n=arguments.length>1&&"number"==typeof arguments[1]?this.getWindowTabContext(arguments[0],arguments[1],arguments[2]):arguments.length>1&&"number"==typeof arguments[0]?this.getWindowContext(e,t,i):this.getContext(arguments[0])).length)return 0;try{return parseInt(n)}catch(e){}return 0},VIS.context.getWindowContextAsInt=function(e,t,i){var n=this.getWindowContext(e,t,i);if(0==n.length)return 0;try{return parseInt(n)}catch(e){}return 0},VIS.context.getContextAsTime=function(e,t){var i=this.getContext(e,t,!1);return null==i||0==i.length?Date.now().getTime():new Date(i).getTime()},VIS.context.getShowClientOrg=function(){return this.getContextAsInt("#ClientOrgLevel")},VIS.context.removeWindow=function(e){this.m_map[e]=null,delete this.m_map[e],key=null},VIS.context.getWindowCtx=function(e){var t={};return $.extend(t,this.ctx),e&&$.extend(t,this.m_map[e]),t},VIS.context.getEntireCtx=function(){var e={};for(var t in $.extend(e,this.ctx),this.m_map)this.m_map.hasOwnProperty(t)&&$.extend(e,this.m_map[t]);return e},VIS.context.isSOTrx=function(e){var t=!1;return!(null==(t=e?this.getWindowContext(e,"IsSOTrx",!0):this.getContext("IsSOTrx"))||!t.equals("Y"))},VIS.context.setIsSOTrx=function(e,t){2==arguments.length?this.setContext(arguments[0],"IsSOTrx",arguments[1]?"Y":"N"):this.setContext("IsSOTrx",arguments[0]?"Y":"N")},VIS.context.getIsUseCrystalReportViewer=function(){return"Y"==VIS.context.getContext("#USE_CRYSTAL_REPORT_VIEWER")},VIS.context.getLocationBulkReload=function(){return"Y"==VIS.context.getContext("#LOCATION_NAME_BULK_REQUEST")}},103:()=>{!function(e,t){var i=e.Logging.Level,n=e.Application.contextUrl,a=n+"JsonData/JDataSetWithCode",s=n+"Form/JDataSet",l=function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return r(s,a,(function(t){l=(new e.DB.DataReader).toJson(t),n&&n(l)})),l},o=function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return d(s,a,(function(t){l=(new e.DB.DataReader).toJson(t),n&&n(l)})),l};function r(e,i,n){var s=null;return t.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){s=e,n&&n(e)})),s}function d(i,n,a){var l=null;return i.sql=e.secureEngine.encrypt(i.sql),t.ajax({url:s,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:n,data:JSON.stringify(i)}).done((function(e){l=e,a&&a(e)})),l}function c(t){this.vo=t._vo,this.tabs=[];for(var i=0;i<t._tabs.length;i++){var n=new e.GridTab(t._tabs[i],this.vo);n.setGridWindow(this),this.tabs.push(n)}t=null}function p(t,i){this.gTab=t,this.vo=t._vo,this.gridTable=new e.GridTable(t._gridTable),this.gridTable.onlyCurrentDays=this.vo.onlyCurrentDays,this.gridTable.MaintainVerOnApproval=this.vo.MaintainVerOnApproval,this.gridTable.IsMaintainVersions=this.vo.IsMaintainVersions,this.gridTable.IsHideVerNewRecord=this.vo.IsHideVerNewRecord,this.parents=[],this.orderBys=[],this.depOnFieldColumn=[],this.depOnField=[],this.tabPanels=[],this.linkColumnName=t._linkColumnName,this.extendedWhere=t._extendedWhere,this.keyColumnName="",this.defaultFocusField,this.isThroughRoleCenter=!1,this.query=new e.Query,this.oldQuery="0=9",this.linkValue="999999",this.currentRow=-1,this.hasPanel=!1,this.isHeaderPanel=!1,this.headerPanel=null,this.isHPanelNotShowInMultiRow=!1,this.mDataStatusEvent,this.mDataListenerList=[],this.loadFields(),this.loadTabPanels(),this.loadHeaderPanelItems(),this.gridTable.addDataStatusListener(this),this.gridTable.setAD_Tab_ID(this.vo.AD_Tab_ID),this.log=e.Logging.VLogger.getVLogger("VIS.GridTab"),this.loadData(i),i=null,this.gridWindow=null,this.outerWhereCondition=null}function u(t){this.gTable=t,this.readOnly=this.gTable._readOnly,this.AD_Table_ID=t._AD_Table_ID,this.deleteable=this.gTable._deleteable,this.gridFields=[],this.keyColumnName="",this.isOpen=!1,this.inserting=!1,this.SQL_Select="",this.SQL_Count="",this.SQL="",this.bufferList=[],this.defaultModel={},this.pazeSize=e.Env.getWINDOW_PAGE_SIZE(),this.newRow=-1,this.compareDB=!0,this.treeNode_ID=0,this.treeTable_ID=0,this.treeID=0,this.selectedTreeNode=0,this.ShowSummaryNodes=!1,this.isSummaryyNode=!1,this.isZoomAction=!1,this.currentPage,this.dopaging,t=null,this.mSortList,this.AD_Tab_ID=0,this.log=e.Logging.VLogger.getVLogger("VIS.GridTable"),this.card_ID=0,this.lastFocus=null}function g(t){this.gfield=t,this.vo=t._vo,this.vo.orginalDispaly=t._vo.displayType,this.oldValue,this.value,this.inserting,this.error,this.valueNoFire=!0,this.gridTab=null;var i=null;(this.vo.IsDisplayedf||this.vo.IsDisplayedMR||this.vo.ColumnName.toLower().equals("createdby")||t._vo.ColumnName.toLower().equals("updatedby")||this.vo.IsHeaderPanelitem)&&(null!=t._vo.lookupInfo&&e.DisplayType.IsLookup(t._vo.displayType)?e.DisplayType.IsLookup(t._vo.displayType)&&(i=new e.MLookup(t._vo.lookupInfo,t._lookup,t._vo.AD_Window_ID,t._vo.AD_Field_ID,t._vo.AD_Tab_ID),this.vo.tabNo>0?(i.initialize(!0),e.MLookupCache.addWindowLookup(this.vo.windowNo,i)):i.initialize()):t._vo.displayType==e.DisplayType.Location?i=new e.MLocationLookup(e.context,t._vo.windowNo):t._vo.displayType==e.DisplayType.Locator?i=new e.MLocatorLookup(e.context,t._vo.windowNo):t._vo.displayType==e.DisplayType.Account?(i=new e.MAccountLookup(e.context,t._vo.windowNo)).setTabNo(this.vo.tabNo):t._vo.displayType==e.DisplayType.PAttribute?i=new e.MPAttributeLookup(e.context,t._vo.windowNo):t._vo.displayType==e.DisplayType.GAttribute?i=new e.MGAttributeLookup(e.context,t._vo.windowNo):t._vo.displayType==e.DisplayType.AmtDimension?i=new e.MAmtDivLookup(e.context,t._vo.windowNo):t._vo.displayType==e.DisplayType.ProductContainer&&(i=new e.MProductContainerLookup(e.context,t._vo.windowNo))),this.lookup=i,this.propertyChangeListner,this.log=e.Logging.VLogger.getVLogger("VIS.GridField"),t=null}function h(e){this.tPanel=e,this.vo=e._vo}function v(t,i,n,a,s){this.mTotalPage=1,this.mCurrentPage=1,this.mPageSize=e.Env.getWINDOW_PAGE_SIZE(),this.totalRecords=1,this.m_totalRows=i,this.m_changed=n,this.m_autoSave=a,this.m_inserting=s,this.m_AD_Message,this.m_info=null,this.m_isError=!1,this.m_isWarning=!1,this.m_confirmed=!1,this.m_allLoaded=!0,this.m_loadedRows=-1,this.m_currentRow=-1,this.m_changedColumn=-1,this.m_columnName=null,this.Created,this.CreatedBy,this.Updated,this.UpdatedBy,this.Info,this.AD_Table_ID,this.Record_ID,this.source=t}c.prototype.getTabs=function(){return this.tabs},c.prototype.getTab=function(e){return e<0||e+1>this.tabs.length?null:this.tabs[e]},c.prototype.getIsAppointment=function(){return this.vo.IsAppointment},c.prototype.getIsTask=function(){return this.vo.IsTask},c.prototype.getIsEmail=function(){return this.vo.IsEmail},c.prototype.getIsLetter=function(){return this.vo.IsLetter},c.prototype.getIsSms=function(){return this.vo.IsSms},c.prototype.getIsChat=function(){return this.vo.IsChat},c.prototype.getIsAttachment=function(){return this.vo.IsAttachment},c.prototype.getIsHistory=function(){return this.vo.IsHistory},c.prototype.getIsRecordShared=function(){return this.vo.IsRecordShared},c.prototype.getWindowType=function(){return this.vo.WindowType},c.prototype.getIsCheckRequest=function(){return this.vo.IsCheckRequest},c.prototype.getIsCopyReocrd=function(){return this.vo.IsCopyReocrd},c.prototype.getIsSubscribedRecord=function(){return this.vo.IsSubscribedRecord},c.prototype.getIsZoomAcross=function(){return this.vo.IsZoomAcross},c.prototype.getIsCreatedDocument=function(){return this.vo.IsCreatedDocument},c.prototype.getIsUploadedDocument=function(){return this.vo.IsUploadedDocument},c.prototype.getIsViewDocument=function(){return this.vo.IsViewDocument},c.prototype.getIsAttachDocumentFrom=function(){return this.vo.IsAttachDocumentFrom},c.prototype.getIsGenerateAttachmentCode=function(){return this.vo.IsGenerateAttachmentCode},c.prototype.getIsFaxEmail=function(){return this.vo.IsFaxEmail},c.prototype.getIsMarkToExport=function(){return this.vo.IsMarkToExport},c.prototype.getIsArchive=function(){return this.vo.IsArchive},c.prototype.getIsImportMap=function(){return this.vo.IsImportMap},c.prototype.getIsAttachmail=function(){return this.vo.IsAttachmail},c.prototype.getIsRoleCenterView=function(){return this.vo.IsRoleCenterView},c.prototype.getIsSOTrx=function(){return this.vo.IsSOTrx},c.prototype.getIsTransaction=function(){return this.vo.IsTransaction},c.prototype.getName=function(){return this.vo.Name},c.prototype.getWindowWidth=function(){return this.vo.WinWidth},c.prototype.getHasPanel=function(){return this.vo.hasPanel},c.prototype.getFontName=function(){return this.vo.FontName},c.prototype.getAD_Image_ID=function(){return this.vo.AD_Image_ID},c.prototype.getImageUrl=function(){return this.vo.ImageUrl},c.prototype.getIsCompositeView=function(){return this.vo.IsCompositeView},c.prototype.getIsHideTabLinks=function(){return this.vo.IsHideTabLinks},c.prototype.getIsHideToolbar=function(){return this.vo.IsHideToolbar},c.prototype.getIsHideActionbar=function(){return this.vo.IsHideActionbar},c.prototype.dispose=function(){originalLength=this.tabs.length;for(var e=originalLength;e>0;e--)gtab=this.tabs.pop(),gtab.dispose(),gtab=null;this.tabs.length=0,this.vo=null,this.tabs=null},p.prototype.setGridWindow=function(e){this.gridWindow=e},p.prototype.getParentTab=function(){var e=this.getParentTabNo();return e<0||e==this.vo.tabNo?null:this.gridWindow.getTab(e)},p.prototype.getParentTabNo=function(){var t=this.vo.tabNo,i=this.vo.TabLevel,n=i-1;if(n<0)return t;for(;n<i&&t>0;)t--,i=e.context.getContextAsInt(this.vo.windowNo,t,"TabLevel");return t},p.prototype.getAD_Tab_ID=function(){return this.vo.AD_Tab_ID},p.prototype.getAD_Window_ID=function(){return this.vo.AD_Window_ID},p.prototype.getAD_Table_ID=function(){return this.vo.AD_Table_ID},p.prototype.getTableName=function(){return this.vo.TableName},p.prototype.getName=function(){return this.vo.Name},p.prototype.getDescription=function(){return this.vo.Description},p.prototype.getIsSortTab=function(){return this.vo.IsSortTab},p.prototype.getDependentOn=function(){var t=[];return e.Evaluator.parseDepends(t,this.vo.DisplayLogic),t},p.prototype.getTabLevel=function(){return this.vo.TabLevel},p.prototype.getWindowNo=function(){return this.vo.windowNo},p.prototype.getTabNo=function(){return this.vo.tabNo},p.prototype.getIsSingleRow=function(){return this.vo.IsSingleRow},p.prototype.getTabLayout=function(){return this.vo.TabLayout},p.prototype.getNewRecordView=function(){return this.vo.NewRecordView},p.prototype.getIsDisplayed=function(t){var i=this.vo.DisplayLogic;if(null==i||i.equals(""))return!0;if(t){if(-1!=i.indexOf("@#"))if(0!=e.Env.parseContext(e.context,0,i,!1,!0).trim().Length)return e.Evaluator.evaluateLogic(this,i);return!0}return e.Evaluator.evaluateLogic(this,i)},p.prototype.getValueAsString=function(t){return e.context.getContext(this.vo.windowNo,"tb_Index",!0)==this.vo.tabNo?value=e.context.getWindowContext(this.vo.windowNo,this.vo.tabNo,t,!0):value=e.context.getWindowContext(this.vo.windowNo,t,!0),value?value.toString():""},p.prototype.getIsCurrent=function(){if(!this.gridTable.getIsOpen())return!1;if(!this.oldQuery.equals(this.query.getWhereClause()))return!1;if(!this.getIsDetail())return!0;var t=e.context.getWindowContext(this.vo.windowNo,this.getLinkColumnName());return this.linkValue.equals(t)},p.prototype.getIsDetail=function(){return this.parents.length>0||0!=this.vo.AD_Column_ID},p.prototype.getField=function(e){return this.gridTable.getField(e)},p.prototype.getFieldById=function(e){return this.gridTable.getFieldById(e)},p.prototype.getFields=function(e){return this.gridTable.getFields()},p.prototype.getLinkColumnName=function(){return this.linkColumnName?this.linkColumnName:""},p.prototype.getOnlyCurrentDays=function(){return this.getIsZoomAction()?0:this.vo.onlyCurrentDays},p.prototype.getShowSummaryLevel=function(){return this.vo.ShowSummaryLevel},p.prototype.getIsTPBottomAligned=function(){return"H"==this.vo.TabPanelAlignment},p.prototype.getIsTreeTab=function(){return this.vo.HasTree},p.prototype.getRowCount=function(){return this.gridTable.getRowCount()},p.prototype.getRecords=function(){return this.gridTable.getDataTable()},p.prototype.getCurrentRow=function(){return this.currentRow},p.prototype.getOrderByClause=function(e){if(this.vo.orderByClause.length>0)return this.vo.OrderByClause;this.vo.orderByClause="";for(var t=0;t<3;t++){var i=this.orderBys[t];i&&null!=i&&""!=i&&i.length>0&&(this.vo.orderByClause.length>0&&(this.vo.OrderByClause+=","),this.vo.orderByClause+=i)}return this.vo.orderByClause.Length>0||(this.vo.orderByClause="Created",e>0&&(this.vo.orderByClause+=" DESC")),this.vo.orderByClause},p.prototype.getTableModel=function(){return this.gridTable},p.prototype.getIsOpen=function(){return null!=this.gridTable&&this.gridTable.getIsOpen()},p.prototype.getIsQueryActive=function(){return null!=this.query&&this.query.getIsActive()},p.prototype.getDependantFields=function(e){var t=[];if(-1!=this.depOnFieldColumn.indexOf(e))for(var i=this.depOnFieldColumn.length,n=0;n<i;n++)this.depOnFieldColumn[n].equals(e)&&t.indexOf(this.depOnField[n])<0&&t.push(this.depOnField[n]);return t},p.prototype.getIsReadOnly=function(){return!!(this.vo.IsReadOnly||this.actionParams&&this.actionParams.IsReadOnly)||(null==this.vo.ReadOnlyLogic||this.vo.ReadOnlyLogic.equals("")?this.vo.IsReadOnly:e.Evaluator.evaluateLogic(this,this.vo.ReadOnlyLogic))},p.prototype.getIsQueryNewRecord=function(){return null!=this.query&&this.query.getIsNewRecordQuery()},p.prototype.getIsAutoNewRecord=function(){return!0===this.vo.IsAutoNewRecord},p.prototype.getHideFGFrom=function(){return this.vo.HideFieldGroupFrom},p.prototype.getIsInsertRecord=function(){if(this.getIsReadOnly())return!1;var e=!1;return this.vo.RecordLimit>0&&(e=this.gridTable.getTotalRowCount()>=this.vo.RecordLimit),this.vo.IsInsertRecord&&!e},p.prototype.getIsHideTabName=function(){return this.vo.HideTabName},p.prototype.getIsResetLayout=function(){return this.vo.ResetLayout},p.prototype.getIsHideGridToggle=function(){return this.vo.IsHideGridToggle},p.prototype.getIsHideSingleToggle=function(){return this.vo.IsHideSingleToggle},p.prototype.getIsHideCardToggle=function(){return this.vo.IsHideCardToggle},p.prototype.getIsHideRecordNav=function(){return this.vo.IsHideRecordNav},p.prototype.getIncluded_Tab_ID=function(){return this.vo.Included_Tab_ID},p.prototype.getIsAlwaysUpdateField=function(){for(var e=0;e<this.gridTable.getColumnCount();e++){if(this.gridTable.getField(e).getIsAlwaysUpdateable())return!0}return!1},p.prototype.getValue=function(e){if(null==e)return null;var t=this.gridTable.getField(e);return this.getValueOfField(t)},p.prototype.getValueOfField=function(e){return null==e?null:e.getValue()},p.prototype.getAD_Process_ID=function(){return this.vo.AD_Process_ID},p.prototype.getRecord_ID=function(){return this.gridTable.getKeyID(this.currentRow)},p.prototype.getDummyRecordID=function(){return this.gridTable.getDummyRecordID(this.currentRow)},p.prototype.getKeyID=function(e){return this.gridTable.getKeyID(e)},p.prototype.getFooterInfo=function(i,n,a,s,l){return new Promise((function(s,o){if(i.startsWith("C_Order")||i.startsWith("C_Invoice")){var r=i.startsWith("C_Order"),d=null,c=null;try{d=new e.MessageFormat(e.Msg.getMsg("OrderSummary")),c=new e.MessageFormat(e.Msg.getMsg("OrderSummaryMC"))}catch(e){return void o("")}if(null==d||null==c)return void s("");var p=0;(p=r?n.getContextAsInt(a,"C_Order_ID"):n.getContextAsInt(a,"C_Invoice_ID"))<1&&l>0&&(p=l),t.ajax({type:"Get",async:!0,url:e.Application.contextUrl+"Form/GetTrxInfo",data:{Record_ID:p,isOrder:r},success:function(t){try{var i=[],a=!1,l=(new e.DB.DataReader).toJson(t),r=e.DisplayType.GetNumberFormat(e.DisplayType.Amount);if(l.read()){var p=l.getInt(0);i[0]=p,i[1]=r.getLocaleAmount(l.getDecimal(2)),i[2]=r.getLocaleAmount(l.getDecimal(3));var u=l.getString(1);i[3]=u,i[4]=r.getLocaleAmount(l.getDecimal(4)),i[5]=n.getContext("$CurrencyISO"),a=!0}}catch(e){o("")}a?i[2]===i[4]?s(d.format(i)):s(c.format(i)):s(" ")},error:function(e){o("")}})}}))},p.prototype.getTrxInfo=function(i,n,a,s){if(i.startsWith("C_Order")||i.startsWith("C_Invoice")){var l=i.startsWith("C_Order"),o=null,r=null;try{o=new e.MessageFormat(e.Msg.getMsg("OrderSummary")),r=new e.MessageFormat(e.Msg.getMsg("OrderSummaryMC"))}catch(e){}if(null==o||null==r)return" ";var d=[],c=!1,p=null;try{var u=0;u=l?n.getContextAsInt(a,"C_Order_ID"):n.getContextAsInt(a,"C_Invoice_ID");p=null;if(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetTrxInfo",data:{Record_ID:u,isOrder:l},success:function(t){p=(new e.DB.DataReader).toJson(t)}}),p.read()){var g=p.getInt(0);d[0]=g;var h=p.getDecimal(2).toLocaleString();d[1]=h;var v=p.getDecimal(3).toLocaleString();d[2]=v;var f=p.getString(1);d[3]=f;var m=p.getDecimal(4).toLocaleString();d[4]=m,d[5]=n.getContext("$CurrencyISO"),c=!0}}catch(e){}finally{null!=p&&p.dispose()}return c?d[2]===d[4]?o.format(d):r.format(d):" "}},p.prototype.getIsProcessed=function(){var t=this.gridTable.findColumn("Processed");if(-1!=t){var i=this.gridTable.getValueAt(this.currentRow,t);if("string"==typeof i)return"Y".equals(i);if("boolean"==typeof i)return i}return"Y".equals(e.context.getWindowContext(this.vo.windowNo,this.vo.tabNo,"Processed"))},p.prototype.getKeyColumnName=function(){return this.keyColumnName},p.prototype.getAD_ColumnSortOrder_ID=function(){return this.vo.AD_ColumnSortOrder_ID},p.prototype.getIsMapView=function(){return!!(this.vo.locationCols&&this.vo.locationCols.length>0)},p.prototype.getMapColumns=function(){return this.vo.locationCols},p.prototype.getAD_ColumnSortYesNo_ID=function(){return this.vo.AD_ColumnSortYesNo_ID},p.prototype.getWhereClause=function(){return this.vo.WhereClause},p.prototype.getSearchQuery=function(t){for(var i=null,n=this.getFields(),a=null,s=0;s<n.length;s++)(a=n[s]).getIsVirtualColumn()||"export_id"!=a.getColumnName().toLowerCase()&&e.DisplayType.IsText(a.getDisplayType())&&(i||(i=new e.Query(this.getTableName(),!0)),i.addRestriction(a.getColumnName(),e.Query.prototype.LIKE,t,a.getColumnName(),t));return n=null,a=null,i},p.prototype.getParentColumnNames=function(){return this.parents},p.prototype.clearSelectedRow=function(){for(var e=this.gridTable.getFields().length,t=0;t<e;t++){var i=this.gridTable.getField(t);i.getIsKey()?i.setValue(null,!1):i.setNullValue()}},p.prototype.setCurrentRow=function(e,t){var i=-1,n=this.verifyRow(e);this.currentRow=n;var a=this.gridTable.getRow(this.currentRow);a&&(i=a.recid);for(var s=this.gridTable.getFields().length,l=0;l<s;l++){var o=this.gridTable.getField(l);if(a){var r=a[o.getColumnName().toLowerCase()];o.setValue(r,this.gridTable.getIsInserting())}else o.getIsKey()?o.setValue(null,!1):o.setNullValue()}if(!t)return i;null!=this.mDataStatusEvent&&this.mDataStatusEvent.getTotalRows()!=this.gridTable.rowCount&&(this.mDataStatusEvent=null),null==this.mDataStatusEvent&&(this.mDataStatusEvent=new v(null,this.getRowCount(),this.gridTable.getIsInserting(),!1,this.gridTable.getIsInserting()),this.mDataStatusEvent.AD_Table_ID=this.getAD_Table_ID(),this.mDataStatusEvent.setPageInfo(this.gridTable.currentPage,this.gridTable.rowCount,this.gridTable.pazeSize)),this.mDataStatusEvent.setCurrentRow(this.currentRow);var d=this.mDataStatusEvent.getAD_Message();return null!=d&&0!=d.length||this.mDataStatusEvent.setInfo("NavigateOrUpdate",null,!1,!1),this.fireDataStatusChanged(this.mDataStatusEvent),i},p.prototype.fireDataStatusEventOnly=function(){null==this.mDataStatusEvent&&(this.mDataStatusEvent=new v(null,this.getRowCount(),this.gridTable.getIsInserting(),!1,this.gridTable.getIsInserting()),this.mDataStatusEvent.AD_Table_ID=this.getAD_Table_ID(),this.mDataStatusEvent.setPageInfo(this.gridTable.currentPage,this.gridTable.rowCount,this.gridTable.pazeSize)),this.mDataStatusEvent.setCurrentRow(this.currentRow);var e=this.mDataStatusEvent.getAD_Message();null!=e&&0!=e.length||this.mDataStatusEvent.setInfo("NavigateOrUpdate",null,!1,!1),this.fireDataStatusChanged(this.mDataStatusEvent)},p.prototype.getLastFocus=function(){return this.gridTable.getLastFocus()},p.prototype.setLastFocus=function(e){this.gridTable.setLastFocus(e)},p.prototype.setQuery=function(t,i){null==t?this.query=new e.Query:(this.query=t,this.vo.onlyCurrentDays=0,i&&(this.vo.oldQuery=""))},p.prototype.setValue=function(t,i){if(!(t instanceof e.GridField)){if(null==t)return"NoColumn";t=this.gridTable.getField(t)}if(null==t)return"NoField";var n=t.getDisplayType();null==i||""==i.toString()?i=null:0!==i||!e.DisplayType.IsID(n)&&n!=e.DisplayType.List||this.getIsStdColumn(t.getColumnName().toUpper())||(i=null);var a=this.gridTable.findColumn(t.getColumnName());return this.gridTable.setValueAt(i,this.currentRow,a,!1),this.processFieldChange(t)},p.prototype.getIsStdColumn=function(e){return"AD_USER_ID"==e||"AD_ROLE_ID"==e||"AD_CLIENT_ID"==e||"AD_ORG_ID"==e},p.prototype.addDataStatusListener=function(e){this.mDataListenerList.push(e)},p.prototype.removeDataStatusListener=function(e){for(var t=this.mDataListenerList.length-1;t>=0;t--)this.mDataListenerList[t]===e&&(this.mDataListenerList[t]=null,this.mDataListenerList.splice(t,1))},p.prototype.needSave=function(e,t){return e?this.gridTable.needSave(-2,t):t?this.gridTable.needSave():this.gridTable.needSave(t)},p.prototype.loadFields=function(){for(var e=0;e<this.gTab._gridTable.m_fields.length;e++){var t=new g(this.gTab._gridTable.m_fields[e]);t.setGridTab(this),this.gridTable.gridFields.push(t),t.getIsDefaultFocus()&&(this.defaultFocusField=t);var i=t.getColumnName();t.getIsKey()&&(this.keyColumnName=i,this.gridTable.setKeyColumnName(i)),t.getIsParentColumn()&&this.parents.push(i);var n=t.getSortNo();0==n||(1==Math.abs(n)?(this.orderBys[0]=i,n<0&&(this.orderBys[0]+=" DESC")):2==Math.abs(n)?(this.orderBys[1]=i,n<0&&(this.orderBys[1]+=" DESC")):3==Math.abs(n)&&(this.orderBys[2]=i,n<0&&(this.orderBys[2]+=" DESC")));for(var a=t.getDependentOn(),s=0;s<a.length;s++)this.depOnFieldColumn.push(a[s]),this.depOnField.push(t);(i.equals("IsActive")||i.equals("Processed")||i.equals("Processing"))&&(this.depOnFieldColumn.push(i),this.depOnField.push(null)),t=null}},p.prototype.loadTabPanels=function(){if(this.gTab._panels&&this.gTab._panels.length>0){this.hasPanel=!0;for(var e=0;e<this.gTab._panels.length;e++){var t=new h(this.gTab._panels[e]);this.tabPanels.push(t)}}else this.hasPanel=!1},p.prototype.loadHeaderPanelItems=function(){this.vo.HeaderItems&&(this.isHeaderPanel=!0,headerPanel=this.vo.HeaderItems,this.isHPanelNotShowInMultiRow=this.vo.HPanelNotShowInMultiRow)},p.prototype.getIsHeaderPanel=function(){return this.isHeaderPanel},p.prototype.getHeaderPanelItems=function(){return headerPanel},p.prototype.getHeaderHeight=function(){return this.vo.HeaderHeight&&this.vo.HeaderHeight>0?this.vo.HeaderHeight+"px":"200px"},p.prototype.getHeaderWidth=function(){return this.vo.HeaderWidth&&this.vo.HeaderWidth>0?this.vo.HeaderWidth+"px":"250px"},p.prototype.getHeaderBackColor=function(){return this.vo.HeaderBackColor},p.prototype.getHeaderPadding=function(){return this.vo.HeaderPadding},p.prototype.getHeaderHorizontal=function(){return!!this.vo.HeaderAlignment.equals("H")},p.prototype.getHasPanel=function(){return this.hasPanel},p.prototype.getTabPanels=function(){return this.tabPanels},p.prototype.validateQuery=function(t){if(null==t||0==t.getRestrictionCount())return null;if(1!=t.getRestrictionCount())return t.getWhereClause();var n=t.getColumnName(0);if(null==n)return t.getWhereClause();if(-1!=n.indexOf("("))return t.getWhereClause();var a=null;if(n.equals("R_RequestRelated_ID")?a="R_Request_ID":n.startsWith("C_DocType")?a="C_DocType_ID":n.equals("CreatedBy")||n.equals("UpdatedBy")?a="AD_User_ID":n.equals("Orig_Order_ID")?a="C_Order_ID":n.equals("Orig_InOut_ID")&&(a="M_InOut_ID"),null!=a){if(null!=this.getField(a))return t.setColumnName(0,a),t.getWhereClause();a=null}if(null!=this.getField(n))return t.getWhereClause();var s="VIS_104";(p=[])[0]=new e.DB.SqlParam("@colName",n);var o=null;try{(o=l(s,p)).read()&&(a=o.getString(0))}catch(e){return this.log.log(i.SEVERE,"(ref) - Column="+n,e),t.getWhereClause()}finally{null!=o&&o.dispose()}if(null!=a){if(t.setColumnName(0,a),null!=this.getField(a))return this.log.fine("Column "+n+" replaced with "+a),t.getWhereClause();n=a}var d=null,c=this.getKeyColumnName();s="VIS_105",(p=[])[0]=new e.DB.SqlParam("@colName",n),p[1]=new e.DB.SqlParam("@tabKeyColumn",c);try{(o=l(s,p)).read()&&(d=o.getString(0))}catch(e){return this.log.log(i.SEVERE,"Column="+n+", Key="+c,e),null}finally{null!=o&&o.dispose()}if(c.equals("AD_Reference_ID")){var p;s="VIS_106",(p=[])[0]=new e.DB.SqlParam("@colName",n);var u=function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return r(s,a,(function(t){i=(new e.DB.DataSet).toJson(t);var i=(new e.DB.DataSet).toJson(t);l=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null,i.dispose(),i=null,a&&n(l)})),l}(s,p);return"AD_Reference_ID="+u}if(null==d)return this.log.info("Not successfull - Column="+n+", Key="+c+", Query="+t),t.getWhereClause();t.setTableName("xx");var g="EXISTS (SELECT * FROM "+d+" xx WHERE "+t.getWhereClause(!0)+" AND xx."+c+"="+this.getTableName()+"."+c+")";return this.log.fine(g),g},p.prototype.setTreeNodeID=function(e){this.treeNode_ID=e,this.gridTable.treeNode_ID=e},p.prototype.setTreeID=function(e){this.treeID=e,this.gridTable.treeID=e},p.prototype.setTreeTable=function(e){this.treeTable_ID=e,this.gridTable.treeTable_ID=e},p.prototype.setShowSummaryNodes=function(e){this.ShowSummaryNodes=e,this.gridTable.ShowSummaryNodes=e},p.prototype.setIsZoomAction=function(e){this.isZoomAction=e,this.gridTable.isZoomAction=e},p.prototype.getIsZoomAction=function(){return this.isZoomAction},p.prototype.prepareQuery=function(t,i,n,a){var s=!0,l=!1;e.context.clearTabContext(this.vo.windowNo,this.vo.tabNo);var o=this.oldQuery.equals(this.query.getWhereClause())&&this.vo.onlyCurrentDays==t;this.getIsTreeTab()&&(this.getShowSummaryLevel()||this.gridTable.setDoPaging(!1),this.getShowSummaryLevel()&&(this.gridTable.setDoPaging(!0),o=!1)),this.oldQuery=this.query.getWhereClause(),this.vo.onlyCurrentDays=t;var d="";if(a||(d+=this.vo.WhereClause),!this.ShowSummaryNodes&&this.getShowSummaryLevel()&&(d.length>0?d+=" AND IsSummary='N'":d+=" IsSummary='N'"),this.getOnlyCurrentDays()>0){d.length>0&&(d+=" AND ");var c=-1!=this.findColumn("Processed");c&&(d+="(Processed='N' OR "),d+=n?"Created>=":"Updated>=",d+="addDays(SysDate, -"+this.vo.onlyCurrentDays+")",c&&(d+=")")}if(!this.isThroughRoleCenter&&this.getIsDetail()){var p=this.getLinkColumnName();if(p.equals(""))d.length>0&&(d+=" AND "),d+=" 2=3",s=!1;else{var u="";if(this.vo.tabNo>0)u=e.context.getTabRecordContext(this.vo.windowNo,this.getParentTabNo(),p,!0);else u=e.context.getTabRecordContext(this.vo.windowNo,this.getParentTabNo(),p);o&&(l=!(o=this.linkValue.equals(u))),this.linkValue=u,0==u.length?(d.length>0&&(d+=" AND "),d+=" 2=4",s=!1):(d.length>0&&(d+=" AND "),"NULL".equals(u.toUpper())?d+=p+" IS NULL ":(d+=p+"=",p.endsWith("_ID")?d+=u:d+="'"+u+"'"))}}if(this.query.getIsActive()){var g=this.validateQuery(this.query);null==g||l||(d.length>0&&(d+=" AND "),d+=g)}if(this.extendedWhere=d.toString(),this.mDataStatusEvent=null,this.gridTable.getIsOpen())o?this.gridTable.dataRefreshAll():this.gridTable.dataRequery(d.toString());else{if(!this.isZoomAction){var h=[];h[0]=new e.DB.SqlParam("@AD_User_ID",e.Env.getCtx().getAD_User_ID()),h[1]=new e.DB.SqlParam("@AD_Client_ID",e.Env.getCtx().getAD_Client_ID()),h[2]=new e.DB.SqlParam("@AD_Tab_ID",this.gridTable.AD_Tab_ID),h[3]=new e.DB.SqlParam("@AD_Table_ID",this.gridTable.AD_Table_ID);var v="",f=function(t,i,n){var a=!!n,s={sql:t,page:1,pageSize:0};i&&(s.param=i);var l=null;return r(s,a,(function(t){l=(new e.DB.DataSet).toJson(t),n&&n(l)})),l}("VIS_107",h);if(f&&f.tables[0].rows&&f.tables[0].rows.length>0){for(var m=0;m<f.tables[0].rows.length;m++)e.Env.getCtx().getAD_User_ID()==f.tables[0].rows[m].cells.ad_user_id&&this.gridTable.AD_Tab_ID==f.tables[0].rows[m].cells.ad_tab_id&&(v=f.tables[0].rows[m].cells.code);v&&(d=d.length>0?d+" AND "+v:v)}}this.gridTable.setSelectWhereClause(d.toString()),this.gridTable.open(i)}return s},p.prototype.dataRefresh=function(){var e=this.currentRow,t=this.gridTable.dataRefresh(e);return this.setCurrentRow(e,!0),t},p.prototype.dataRefreshAll=function(){this.mDataStatusEvent=null,this.getTableModel().dataRefreshAll()},p.prototype.dataIgnore=function(){this.gridTable.dataIgnore(!0)&&(this.setCurrentRow(this.currentRow,!1),this.currentRow<0&&(this.currentRow=0),this.IsSharedAccess(),this.gridTable.fireDataStatusIEvent("Ignored",""))},p.prototype.getLinkWhereClause=function(){var t="";if(this.getIsDetail()){var i=this.getLinkColumnName();if(i.equals(""))t.length>0&&(t+=" AND "),t+=" 2=3";else{var n=e.context.getTabRecordContext(this.vo.windowNo,this.getParentTabNo(),i,!0);i=this.getTableName()+"."+i,0==n.length?(t.length>0&&(t+=" AND "),t+=" 2=4"):(t.length>0&&(t+=" AND "),"NULL".equals(n.toUpper())?t+=i+" IS NULL ":(t+=i+"=",i.endsWith("_ID")?t+=n:t+="'"+n+"'"))}}return t},p.prototype.SetSelectedNode=function(e){this.gridTable.selectedTreeNode=e},p.prototype.SetIsSummaryNode=function(e){this.gridTable.isSummaryyNode=e},p.prototype.dataSave=function(t){try{var i=this.gridTable.dataSave(t)==e.GridTable.prototype.SAVE_OK;return t&&this.setCurrentRow(this.currentRow,!1),i}catch(t){this.log.log(e.Logging.Level.SEVERE,"#"+this.vo.tabNo+" - row="+this.currentRow,t)}return!1},p.prototype.dataNew=function(t){if(!this.getIsInsertRecord())return this.log.warning("Insert Not allowed in TabNo="+this.vo.tabNo),null;if(this.vo.tabNo>0){var i="Y".equals(e.context.getWindowContext(this.vo.windowNo,"Processed"));if(i)return this.log.warning("Not allowed in TabNo="+this.vo.tabNo+" -> Processed="+i),null;this.log.finest("Processed="+i)}var n=this.gridTable.dataNew(this.currentRow,t);if(!n)return n;this.setCurrentRow(this.currentRow+1,!0);var a=this.getFieldCount();this.gridTable.setDisableNotification(!0);for(var s=0;s<a;s++)this.processCallout(this.getField(s));for(s=0;s<a;s++)this.getField(s).setError(!1);return this.IsSharedAccess(),this.gridTable.setDisableNotification(!1),this.gridTable.fireDataStatusIEvent(t?"UpdateCopied":"Insertdata",""),n},p.prototype.dataDelete=function(e){var t=this.gridTable.dataDelete(e,this.currentRow);return this.setCurrentRow(this.currentRow,!0),this.IsSharedAccess(),t},p.prototype.findColumn=function(e){return this.gridTable.findColumn(e)},p.prototype.navigate=function(e,t,i){var n=-1,a=null;if(!i){if(e===this.currentRow)return n;if((a=this.verifyRow(e))===this.currentRow)return n}return a=null!=a?a:this.currentRow,this.gridTable.dataSave(a,!1)&&(n=this.setCurrentRow(a,t)),this.IsSharedAccess(),n},p.prototype.IsSharedAccess=function(){if(this.gridTable.getIsInserting())return this.IsSharedReadOnly=!1,void(this.isCurrentRecordShare=!1);var i=this.getAD_Table_ID(),n=this.getRecord_ID();if(n<0&&this.getRecords().length&&this.currentRow>-1&&this.getTableName()&&this.getRecords()[this.currentRow]&&(n=this.getRecords()[this.currentRow][this.getTableName().toLower()+"_id"]),!(n&&n<0)){var a=this;t.ajax({async:!1,url:e.Application.contextUrl+"RecordShared/GetSharedRecordAccess",data:{AD_Table_ID:i,Record_ID:n},success:function(e){"true"==(e=(e=JSON.parse(e)).split("_"))[0].toLowerCase()?a.IsSharedReadOnly=!0:a.IsSharedReadOnly=!1,a.isCurrentRecordShare="N"!=e[1]},error:function(e){console.log(e)}})}},p.prototype.verifyRow=function(e){var t=e;if(!this.gridTable.getIsOpen())return-1;var i=this.getRowCount();return 0==i?-1:(t>=i?t=i-1:t<0&&(t=0),t)},p.prototype.navigateRelative=function(e){return this.navigate(this.currentRow+e)},p.prototype.hasDependants=function(e){return-1!==this.depOnFieldColumn.indexOf(e)},p.prototype.dataStatusChanged=function(e){var t=e.getCurrentRow();e.getAD_Message();if(e.setCurrentRow(this.currentRow),this.mDataStatusEvent=e,t==this.currentRow)this.gridTable.getField(e.getChangedColumn());else this.fireDataStatusChanged(this.mDataStatusEvent)},p.prototype.fireDataStatusChanged=function(e){var t=this.mDataListenerList;if(0!=t.length){if(e.getCurrentRow()>=0){e.Created=this.getValue("Created"),e.CreatedBy=this.getValue("CreatedBy"),e.Updated=this.getValue("Updated"),e.UpdatedBy=this.getValue("UpdatedBy"),e.Record_ID=this.getKeyID(e.getCurrentRow());var i=new StringBuilder(this.getTableName());if(null!=this.keyColumnName&&this.keyColumnName.length>0)i.append(" - ").append(this.keyColumnName).append("=").append(e.Record_ID);else for(var n=0;n<this.parents.length;n++){var a=this.parents[n];i.append(" - ").append(a).append("=").append(this.getValue(a))}e.Info=i.toString()}e.setInserting(this.gridTable.getIsInserting());for(var s=0;s<t.length;s++)t[s].dataStatusChanged(e)}},p.prototype.processFieldChange=function(e){return this.processDependencies(e),this.processCallout(e)},p.prototype.processDependencies=function(t){var i=t.getColumnName();if(this.hasDependants(i))for(var n=this.getDependantFields(i),a=0;a<n.length;a++){var s=n[a];if(null!=s&&s.getLookup()instanceof e.MLookup)if(-1!=s.getLookup().getValidation().indexOf("@"+i+"@")){if("C_BPartner_ID"==i&&"C_BPartner_Location_ID"==s.getColumnName())continue;if(null==s.getValue())continue;if(this.log.fine(i+" changed - "+s.getColumnName()+" set to null"),null==s.getValue())return;this.setValue(s,null)}null!=s&&(s.getLookup(),e.MLocatorLookup)}},p.prototype.processCallout=function(t){var n=t.getCallout();if(0==n.length)return"";if(this.getIsProcessed())return"";for(var a=t.getValue(),s=t.getOldValue(),l=new e.StringTokenizer(n,";,",!1);l.hasMoreTokens();){var o=l.nextToken().trim(),r=null,d=null,c=o,p=o.lastIndexOf(".");try{if(-1!=p){c=o.substring(0,p).replace("ViennaAdvantage","VIS").replace("VAdvantage","VIS");var u=e.Utility.getFunctionByName(c,window);u||c.startsWith("VIS")||(c="VIS"+c.substring(c.indexOf(".")),u=e.Utility.getFunctionByName(c,window)),r=new u,d=o.substring(p+1)}}catch(e){return this.log.log(i.SEVERE,c,e),"Callout Invalid: "+c+" ("+e.toString()+")"}if(null==r||null==d||0==d.length)return"Callout Invalid: "+d;var g="";try{g=r.start(e.context,d,this.vo.windowNo,this,t,a,s)}catch(t){return this.log.log(e.Logging.Level.SEVERE,"start",t),g="Callout Invalid: "+t.toString()}if(g&&!g.toString().equals(""))return g instanceof Error&&(g=g.toString()+"-> "+o),this.log.warning(g),g}return""},p.prototype.getFieldCount=function(){return this.gridTable.getColumnCount()},p.prototype.getCM_ChatID=function(){if(null!=this.chats&&0!=this.chats.length||this.loadChats(),null==this.chats)return 0;var t=this.getRecord_ID();return this.hasKey(this.chats,t)?e.Utility.Util.getValueOfInt(this.getKeyValue(this.chats,t)):0},p.prototype.getCM_SubScribedID=function(){if(null!=this._subscribe&&0!=this._subscribe.length||this.loadSubscribe(),null==this._subscribe)return 0;var t=this.getRecord_ID();return this.hasKey(this._subscribe,t)?e.Utility.Util.getValueOfInt(this.getKeyValue(this._subscribe,t)):0},p.prototype.hasKey=function(e,t){for(var i=0;i<e.length;i++)if(e[i].ID===t)return!0;return!1},p.prototype.getKeyValue=function(e,t){for(var i=0;i<e.length;i++)if(e[i].ID===t)return e[i].value;return 0},p.prototype.getCommitWarning=function(){return this.vo.CommitWarning},p.prototype.getField=function(e){return this.gridTable.getField(e)},p.prototype.dispose=function(){if(this.gTab=null,this.vo=null,this.gridTable.removeDataStatusListener(this),this.gridTable.dispose(),this.gridTable=null,null!=this.mDataListenerList)for(var e=this.mDataListenerList.length-1;e>=0;e--)this.mDataListenerList[e]=null,this.mDataListenerList.splice(e,1)},p.prototype.getIsLocked=function(){if(!e.MRole.getIsPersonalLock())return!1;if(this.isDataLoading)return!1;if(null==this._Lock&&this.loadLocks(),null==this._Lock||0==this._Lock.length)return!1;var t=this.getRecord_ID();return this._Lock.indexOf(t)>-1},p.prototype.loadLocks=function(){var t=e.context.getAD_User_ID();if(this.canHaveAttachment()){var n="VIS_108",a=[];a[0]=new e.DB.SqlParam("@AD_User_ID",t),a[1]=new e.DB.SqlParam("@AD_Table_ID",this.vo.AD_Table_ID);var s=null;try{for(null==this._Lock?this._Lock=[]:this._Lock.length=0,s=l(n,a);s.read();){var o=e.Utility.Util.getValueOfInt(s.get("Record_ID"));this._Lock.push(o)}s.close(),s=null}catch(e){this.log.log(i.SEVERE,n,e)}this.log.fine("#"+this._Lock.length)}},p.prototype.loadSubscribe=function(){if(this.canHaveAttachment()){var t=[];t[0]=new e.DB.SqlParam("@AD_User_ID",e.context.getAD_User_ID()),t[1]=new e.DB.SqlParam("@AD_Table_ID",this.getAD_Table_ID());var i=null;try{var n,a;for(this._subscribe=[],null==this._subscribe?this._subscribe={}:this._subscribe.length=0,i=l("VIS_109",t);i.read();)n=e.Utility.Util.getValueOfInt(i.getString(1)),a=e.Utility.Util.getValueOfInt(i.getString(0)),this._subscribe.push({ID:n,value:a});i=null}catch(e){}}},p.prototype.loadDocuments=function(){if(this.canHaveAttachment()){var t=[];t[0]=new e.DB.SqlParam("@ad_table_id",this.getAD_Table_ID());var i=null;try{var n,a;for(this.viewDocument=[],null==this.viewDocument?this.viewDocument={}:this.viewDocument.length=0,i=l("VIS_110",t);i.read();)n=e.Utility.Util.getValueOfInt(i.getString(1)),a=e.Utility.Util.getValueOfInt(i.getString(0)),this.viewDocument.push({ID:n,value:a});i=null}catch(e){}}},p.prototype.loadChats=function(){if(this.canHaveAttachment()){var t=[];t[0]=new e.DB.SqlParam("@AD_Table_ID",this.getAD_Table_ID());var i=null;try{var n,a;for(this.chats=[],null==this.chats?this.chats={}:this.chats.length=0,i=l("VIS_111",t);i.read();)n=e.Utility.Util.getValueOfInt(i.getString(1)),a=e.Utility.Util.getValueOfInt(i.getString(0)),this.chats.push({ID:n,value:a});i=null}catch(e){}}},p.prototype.canHaveAttachment=function(){return!!this.keyColumnName.endsWith("_ID")},p.prototype.hasChat=function(){if(this.isDataLoading)return!1;if(null==this.chats&&this.loadChats(),null==this.chats)return!1;var e=this.getRecord_ID();return this.hasKey(this.chats,e)},p.prototype.hasDocument=function(){if(this.isDataLoading)return!1;if(null==this.viewDocument&&this.loadDocuments(),null==this.viewDocument)return!1;var e=this.getRecord_ID();return this.hasKey(this.viewDocument,e)},p.prototype.hasShared=function(e){if(this.isDataLoading)return!1;if(null!=this.sharedRecords&&1!=e||this.loadShared(),null==this.sharedRecords)return!1;var t=this.getRecord_ID();return-1==t&&(t=this.getDummyRecordID()),this.hasKey(this.sharedRecords,t)},p.prototype.HasSubscribed=function(){if(this.isDataLoading)return!1;if(null==this._subscribe&&this.loadSubscribe(),null==this._subscribe)return!1;var e=this.getRecord_ID();return this.hasKey(this._subscribe,e)},p.prototype.loadShared=function(){if(1==e.MRole.getIsShowSharedRecord()){var t=[];t[0]=new e.DB.SqlParam("@AD_Table_ID",this.getAD_Table_ID());var i=null;try{var n;for(this.sharedRecords=[],i=l("VIS_157",t);i.read();)n=e.Utility.Util.getValueOfInt(i.getString(0)),this.sharedRecords.push({ID:n});i=null}catch(e){}}},p.prototype.loadAttachments=function(){if(this.canHaveAttachment()){var t=[];t[0]=new e.DB.SqlParam("@AD_Table_ID",this.getAD_Table_ID());var i=null;try{var n,a;for(this._attachments=[],i=l("VIS_112",t);i.read();)n=e.Utility.Util.getValueOfInt(i.getString(1)),a=e.Utility.Util.getValueOfInt(i.getString(0)),this._attachments.push({ID:n,value:a});i=null}catch(e){}}},p.prototype.loadMarking=function(){var t=[];t[0]=new e.DB.SqlParam("@AD_Table_ID",this.getAD_Table_ID());var i=null;try{var n,a;for(this._marking=[],i=l("VIS_113",t);i.read();)n=e.Utility.Util.getValueOfInt(i.getString(1)),a=e.Utility.Util.getValueOfInt(i.getString(0)),this._marking.push({ID:n,value:a});i=null}catch(e){}},p.prototype.hasAttachment=function(){if(this.isDataLoading)return!1;if(null==this._attachments&&this.loadAttachments(),null==this._attachments)return!1;var e=this.getRecord_ID();return this.hasKey(this._attachments,e)},p.prototype.hasMarked=function(){if(this.isDataLoading)return!1;if(null==this._marking&&this.loadMarking(),null==this._marking)return!1;var e=this.getRecord_ID();return this.hasKey(this._marking,e)},p.prototype.loadData=function(e){this.isDataLoading=!1,this.isExportLoading=!1,this._attachments=this.gTab._attachments,this.chats=this.gTab._chats,this._lock=this.gTab._pAccess,this._subscribe=this.gTab._subscribe,this.viewDocument=this.gTab._documents,this.sharedRecords=this.gTab._sharedRec},p.prototype.locks=function(t,i,n){var a=t.getAD_User_ID();e.dataContext.updateInsertLocks(a,this.vo.AD_Table_ID,i,n),this.loadLocks()},p.prototype.setRecordStatus=function(e){},u.prototype.ctx=e.context,u.prototype.SAVE_OK="O",u.prototype.SAVE_ERROR="E",u.prototype.SAVE_ACCESS="A",u.prototype.SAVE_MANDATORY="M",u.prototype.SAVE_ABORT="U",u.prototype.SAVE_REGEX_ERROR="R",u.prototype.getReadOnly=function(){return!1},u.prototype.setAD_Tab_ID=function(e){this.AD_Tab_ID=e},u.prototype.getField=function(e){if(isNaN(e)){if(null==e||0==e.length)return null;for(var t=this.gridFields.length,i=0;i<t;i++){var n=this.gridFields[i];if(e.equals(n.getColumnName(),!0))return n}return null}return e<0||e>=this.gridFields.length?null:this.gridFields[e]},u.prototype.getFieldById=function(e){if(e<1)return null;for(var t=this.gridFields.length,i=0;i<t;i++){var n=this.gridFields[i];if(e===n.getAD_Field_ID())return n}return null},u.prototype.getIsInserting=function(){return this.inserting},u.prototype.getColumnCount=function(){return this.gridFields.length},u.prototype.getFields=function(){return this.gridFields},u.prototype.getWhereClause=function(t){for(var n=this.gridFields.length,a=null,s=null,l=0;l<n;l++){var o=this.gridFields[l];if(o.getIsKey()){if(null==(d=t[r=o.getColumnName().toLowerCase()]))return this.log.log(e.Logging.Level.WARNING,"PK data is null - "+r),null;a=r.toUpperCase().endsWith("_ID")?new StringBuilder(r).append("=").append(d):new StringBuilder(r).append("=").append(e.DB.to_string(d.toString()))}else if(o.getIsParentColumn()){var r,d;if(null==(d=t[r=o.getColumnName().toLowerCase()])){this.log.log(i.INFO,"FK data is null - "+r);continue}null==s?s=new StringBuilder:s.append(" AND "),r.toUpperCase().endsWith("_ID")?s.append(r).append("=").append(d):s.append(r).append("=").append(e.DB.to_string(d.toString()))}}return null!=a?a.toString():null!=s?s.toString():(this.log.log(i.WARNING,"No key Found"),null)},u.prototype.getIsOpen=function(){return this.isOpen},u.prototype.getTableID=function(){return this.gTable._AD_Table_ID},u.prototype.getDataTable=function(){return this.bufferList},u.prototype.getSortModel=function(e){return this.mSortList},u.prototype.getRow=function(e){return this.mSortList[e]},u.prototype.getRowCount=function(){return this.mSortList?this.mSortList.length:this.bufferList?this.bufferList.length:0},u.prototype.getTotalRowCount=function(){return this.rowCount},u.prototype.getValueAt=function(e,t){var i=this.getRow(e);return i&&t in i?i[t]:null},u.prototype.checkMaxMin=function(){new StringBuilder;for(var i=this.gridFields.length,n="",a="",s=0;s<i;s++){var l=this.gridFields[s];if(e.DisplayType.IsNumeric(l.getDisplayType()))if(n=l.getMaxValue(),a=l.getMinValue(),t.isNumeric(n)&&t.isNumeric(a)){if(Number(l.getValue())>Number(l.getMaxValue())||Number(l.getValue())<Number(l.getMinValue()))return e.ADialog.error("ValidationError",!0,": "+e.Msg.getMsg("VIS_ValueOf")+" "+l.getHeader()+" "+e.Msg.getMsg("VIS_MustBetween")+" "+l.getMinValue()+" "+e.Msg.getMsg("VIS_And")+" "+l.getMaxValue()),!1}else if(t.isNumeric(n)){if(Number(l.getValue())>Number(n))return e.ADialog.error("ValidationError",!0,": "+e.Msg.getMsg("VIS_ValueOf")+" "+l.getHeader()+" "+e.Msg.getMsg("VIS_Lessthan")+" "+n),!1}else if(t.isNumeric(a)&&Number(l.getValue())<Number(a))return e.ADialog.error("ValidationError",!0,": "+e.Msg.getMsg("VIS_ValueOf")+" "+l.getHeader()+" "+e.Msg.getMsg("VIS_Greaterthan")+" "+a),!1}return!0},u.prototype.getMandatory=function(e){for(var t=new StringBuilder,i=this.gridFields.length,n=!1,a=0;a<i;a++){var s=this.gridFields[a];if(s.getIsMandatory(!0)){var l=s.getColumnName().toLowerCase();null!=e[l]&&0!=e[l].toString().length||(s.setInserting(!0),s.setError(!0),t.length()>0&&t.append(", "),t.append(s.getHeader()),n||(this.lastFocus=s.propertyChangeListner.getControl(),n=!0))}}return 0==t.length()?"":t.toString()},u.prototype.getLastFocus=function(){return this.lastFocus},u.prototype.setLastFocus=function(e){this.lastFocus=e},u.prototype.getErrorColumns=function(){for(var e=new StringBuilder,t=this.gridFields.length,i=0;i<t;i++){var n=this.gridFields[i];n.getIsError()&&(e.length()>0&&e.append(", "),e.append(n.getHeader()))}return 0==e.length()?"":e.toString()},u.prototype.getClientOrg=function(e){var t=-1;if(-1!=this.gTable._indexClientColumn){var i=this.getValueAt(e,"ad_client_id");null!=i&&(t=i)}var n=0;if(-1!=this.gTable._indexOrgColumn){var a=this.getValueAt(e,"ad_org_id");null!=a&&(n=a)}return[t,n]},u.prototype.getKeyID=function(e){if(-1!=this.gTable._indexKeyColumn)try{var t=this.getValueAt(e,this.keyColumnName.toLowerCase());return null==t||isNaN(t)?-1:t}catch(e){return-1}return-1},u.prototype.getDummyRecordID=function(e){try{var t=this.getValueAt(e,this._tableName+"_ID");return null==t||isNaN(t)?-1:t}catch(e){return-1}return-1},u.prototype.setKeyColumnName=function(e){this.keyColumnName=e},u.prototype.setTableName=function(e){this.isOpen||null!=e&&0!=e.length&&(this.gTable._tableName=e)},u.prototype.setReadOnly=function(e){this.readOnly=e},u.prototype.setDeleteable=function(e){this.gTable._deleteable=e},u.prototype.setOrderClause=function(e){this.gTable._orderClause=e,null==this.gTable._orderClause&&(this.gTable._orderClause="")},u.prototype.setSelectWhereClause=function(e){return!this.isOpen&&(this.gTable._whereClause=e,null==this.gTable._whereClause&&(this.gTable._whereClause=""),!0)},u.prototype.setDoPaging=function(e){this.dopaging=e},u.prototype.setCurrentPage=function(e){this.currentPage=e},u.prototype.setCurrentPageRelative=function(e){var t=this.currentPage;isNaN(e)?t=Math.ceil(this.rowCount/this.pazeSize):0!==e?t+=e:t=1,this.currentPage=t},u.prototype.setSortModel=function(e){this.mSortList=null,this.mSortList=e},u.prototype.setCardID=function(e){this.card_ID=e},u.prototype.resetCard=function(){this.cardTempalte=null,this.setCardID(0)},u.prototype.setValueAt=function(e,i,n,a){if(!(!this.isOpen||i<0||n<0||0==this.rowCount)){var s=this.getField(n),l=this.getValueAt(i,s.getColumnName().toLowerCase());if(a||(null!=l||null!=e)&&l!==e){var o=this.getRow(i);if(this.rowChanged=i,null==this.rowData&&(this.rowData={},t.extend(this.rowData,o)),s.setValue(e,this.inserting),o[s.getColumnName().toLowerCase()]=e,!this.disableNotification){var r=this.createDSE();r.setChangedColumn(n,s.getColumnName()),this.fireDataStatusChanged(r)}}}},u.prototype.setDisableNotification=function(e){this.disableNotification=e},u.prototype.needSave=function(e,t){var i=e,n=t;return 0==arguments.length?(i=this.rowChanged,n=!1):1==arguments.length?(i=arguments[0],n=!1):(i=arguments[0],n=arguments[1]),!(void 0===this.changed||!(this.changed||-1!=this.rowChanged&&void 0!==this.rowChanged))&&((!this.changed||void 0!==this.rowChanged&&-1!=this.rowChanged||!n)&&i!=this.rowChanged)},u.prototype.findColumn=function(e){for(var t=this.gridFields,i=0;i<t.length;i++){var n=t[i];if(e.equals(n.getColumnName(),!0))return i}return-1},u.prototype.createSelectSql=function(){var t=this.gTable;if(this.columns=[],0==this.gridFields.length||null==t._tableName||t._tableName.equals(""))return"";for(var i=new StringBuilder("SELECT "),n=0;n<this.gridFields.length;n++){n>0&&i.append(", ");var a=this.gridFields[n];this.columns.push(a.getColumnName())}i.append(" FROM ").append(t._tableName),this.SQL_Select=i.toString(),this.SQL_Count="SELECT COUNT(*) FROM "+t._tableName;var s=new StringBuilder(""),l=t._whereClause;if(l.length>0){if(s.append(" WHERE "),-1==l.indexOf("@"))s.append(l);else{var o=e.Env.parseContext(this.ctx,t._windowNo,l,!1);(!o||0==o.length)&&l.length>0?s.append("11=12"):s.append(o)}l.toUpperCase().indexOf("=NULL")>0&&this.log.Severe("Invalid NULL - "+_tableName+"="+l)}return this.whereClause=s,this.SQL=this.SQL_Select+s.toString(),this.SQL_Count+=s.toString(),t._withAccessControl&&(this.SQL=e.MRole.addAccessSQL(this.SQL,t._tableName,e.MRole.SQL_FULLYQUALIFIED,e.MRole.SQL_RO),this.SQL_Count="SELECT COUNT(*) FROM "+t._tableName+this.SQL.substring(this.SQL_Select.length)),this.SQL_Direct="",t._orderClause.equals("")||(this.SQL+=" ORDER BY "+t._orderClause,this.SQL_Direct+=" ORDER BY "+t._orderClause),this.SQL},u.prototype.open=function(i){if(this.maxRows=i,this.isOpen)return this.dataRefreshAll(),!0;if(this.createSelectSql(),null==this.SQL||this.SQL.equals("")||!this.columns||0==this.columns.length)return!1;this.rowCount=0;this.rowCount=0,this.bufferList.length=0;var a=this;this.pazeSize=Number(e.Env.getWINDOW_PAGE_SIZE());var s=this.createGridFieldArr(this.gridFields,!0),l={page:this.dopaging?this.currentPage:0,pageSize:this.dopaging?this.pazeSize:0,treeID:this.treeID,treeNode_ID:this.treeNode_ID,card_ID:this.card_ID,ad_Tab_ID:this.AD_Tab_ID,tableName:this.gTable._tableName},o=this.createObsecureFields(this.gridFields);return t.ajax({url:n+"Window/GetWindowRecords",type:"post",data:{ctx:e.context.getWindowCtx(a.gTable._windowNo),Columns:this.columns,TableName:this.gTable._tableName,WhereClause:e.secureEngine.encrypt(this.whereClause),ObscureFields:o,sqlIn:l,AD_Window_ID:a.gridFields[0].getAD_Window_ID(),WindowNo:a.gTable._windowNo,AD_Tab_ID:a.AD_Tab_ID,SummaryOnly:a.ShowSummaryNodes,Encryptedfields:s,AD_Table_ID:a.AD_Table_ID,MaxRows:a.maxRows,DoPaging:a.dopaging},success:function(e){var t=JSON.parse(e);t.RecordCount>0?(a.rowCount=t.RecordCount,a.isOpen=!0,(!a.dopaging||a.pazeSize>a.rowCount)&&(a.pazeSize=a.rowCount),a.changed=!1,a.rowChanged=-1,a.fillData(t)):(null!=a.bufferList&&(a.bufferList.length=0),null!=a.mSortList&&(a.mSortList=null),a.currentPage=1,a.isOpen=!0,a.changed=!1,a.rowChanged=-1,window.setTimeout((function(e){a.fireQueryCompleted(!0)}),300,a))},error:function(){}}),!0},u.prototype.fillData=function(t){var n=null,a=this;if(this.treeNode_ID>0){try{if(null!=(n=(new e.DB.DataSet).toJson(t.Tables))){if(0!=n.getTables().length)for(var s=n.getTable(0).getRows(),l=n.getTable(0).getColumnsName(),o=0;o<s.length;o++){for(var r=s[o].getJSCells(),d=0;d<l.length;d++)r[l[d]]=a.readDataOfColumn(l[d],r[l[d]]);a.bufferList[o]=r}n.dispose(),n=null}}catch(e){this.log.Log(i.SEVERE,a.SQL,e)}a.fireQueryCompleted(!0),a=null}else{try{var c=null,p=null;if(t&&(n=(new e.DB.DataSet).toJson(t.Tables),c=t.LookupDirect,p=t.CardViewTpl),null!=n){if(0!=n.getTables().length){for(s=n.getTable(0).getRows(),l=n.getTable(0).getColumnsName(),o=0;o<s.length;o++){for(r=s[o].getJSCells(),d=0;d<l.length;d++)r[l[d]]=a.readDataOfColumn(l[d],r[l[d]]);a.bufferList[o]=r}console.log(n.getTable(0).lookupDirect)}n.dispose(),n=null}c&&e.MLookupCache.addRecordLookup(a.gTable._windowNo,a.gTable._tabNo,c),a.cardTempalte=p,dataIn.card_ID>0&&p&&p.DisableWindowPageSize&&(a.pazeSize=a.rowCount,a.currentPage=1)}catch(e){}a.fireQueryCompleted(!0),a=null}},u.prototype.getCardTemplate=function(){return this.cardTempalte},u.prototype.readDataOfColumn=function(t,i){if(null==i)return i;try{var n=this.getField(t);if(null==n)return i;var a=n.getColumnName(),s=n.getDisplayType();if(e.DisplayType.IsID(s)&&(a.endsWith("_ID")||a.endsWith("_Acct"))||a.endsWith("atedBy")||a.endsWith("_ID_1")||a.endsWith("_ID_2")||a.endsWith("_ID_3")||s==e.DisplayType.Integer)i=e.Utility.Util.getValueOfInt(i);else if(e.DisplayType.IsNumeric(s))i=e.Utility.Util.getValueOfDecimal(i);else if(e.DisplayType.IsDate(s))dte=null;else if(s==e.DisplayType.RowID)i=null;else if(s==e.DisplayType.YesNo){var l=i.toString();n.getIsEncryptedColumn()&&(l=this.decrypt(l)),i=l.equals("Y")}else if(e.DisplayType.IsLOB(s)){var o=i;null==o&&(i=null),i=typeof o==typeof string?o.toString():o}else i=i.toString();n.getIsEncryptedColumn()&&s!=e.DisplayType.YesNo&&(i=this.decrypt(i)),n.getObscureType()&&s!=e.DisplayType.YesNo&&(i=this.decrypt(i))}catch(e){console.log(e)}return i},u.prototype.encrypt=function(t){return null==t||t.length<1?t:e.secureEngine.encrypt(t)},u.prototype.decrypt=function(t){return null==t||t.length<1?t:e.secureEngine.isEncrypted(t)?e.secureEngine.decrypt(t):t},u.prototype.dataSave=function(e,t){return 2==arguments.length?!(this.changed||void 0!==this.rowChanged&&-1!=this.rowChanged)||(e==this.rowChanged||this.dataSaveL(t)==u.prototype.SAVE_OK):this.dataSaveL(t)},u.prototype.dataSaveL=function(i){if(!this.isOpen)return this.log.warning("Error - Open="+this.isOpen),this.SAVE_ERROR;if(-1==this.rowChanged&&(this.log.config("NoNeed - Changed="+this.changed+", Row="+this.rowChanged),!i))return this.SAVE_OK;if(null==this.rowData)return this.log.fine("No Changes"),this.SAVE_ERROR;if(this.readOnly)return log.warning("IsReadOnly - ignored"),this.dataIgnore(),this.SAVE_ACCESS;if(-1==this.rowChanged){if(-1==this.newRow)return this.fireDataStatusEEvent("SaveErrorNoChange","",!1),this.SAVE_ERROR;this.rowChanged=this.newRow}var n=this.getClientOrg(this.rowChanged),a=n[0],s=n[1];if(!e.MRole.canUpdate(a,s,this.AD_Table_ID,0,!0))return this.fireDataStatusEEvent("AccessTableNoUpdate","",!0),this.dataIgnore(),this.SAVE_ACCESS;for(var l=this.getRow(this.rowChanged),o=0;o<this.gridFields.length;o++){var r=this.gridFields[o];if(e.DisplayType.IsString(r.getDisplayType())&&null!=r.value&&r.value.toString().trim().length>0&&!new RegExp(r.getVFormat()).test(r.value))return this.fireDataStatusEEvent("RegexFailed",(""==r.getHeader()?r.getColumnName():r.getHeader())+"\n",!0),r.propertyChangeListner.ctrl.focus(),this.SAVE_ERROR}var d=this.getMandatory(l);if(0!=d.length)return this.fireDataStatusEEvent("FillMandatory",d+"\n",!0),this.SAVE_MANDATORY;if(this.checkMaxMin()){var c=this.getErrorColumns();if(0!=c.length)return this.fireDataStatusEEvent("Error",c+"\n",!0),this.SAVE_ERROR;var p=0;this.inserting||(p=this.getKeyID(this.rowChanged));var u,g=this.gridFields;g.length;u=this.createGridFieldArr(g);var h=this.createGridFieldArr(g,!0),v=this.createObsecureFields(g),f={},m={};if(t.extend(!0,f,l),t.extend(!0,m,this.rowData),h&&h.length>0){var y=h.length;for(o=0;o<y;o++)f[h[o]]&&(f[h[o]]=this.encrypt(f[h[o]])),m[h[o]]&&(m[h[o]]=this.encrypt(m[h[o]]))}if(v&&v.length>0)for(y=v.length,o=0;o<y;o++)(f[v[o]]||0==f[v[o]])&&(f[v[o]]=this.encrypt(f[v[o]])),(m[v[o]]||0==m[v[o]])&&(m[v[o]]=this.encrypt(m[v[o]]));var I={Record_ID:p,AD_Table_ID:this.AD_Table_ID,TableName:this.gTable._tableName,Inserting:this.inserting,CompareDB:this.compareDB,RowData:f,OldRowData:m,ManualCmd:i,WhereClause:this.getWhereClause(l),Fields:u,AD_Client_ID:a,AD_Org_ID:s,Columns:this.columns,AD_WIndow_ID:g[0].getAD_Window_ID(),MaintainVersions:!1,UnqFields:this.gFieldUnique,Ctx:e.context.getWindowCtx(this.gTable._windowNo),WindowNo:this.gTable._windowNo,AD_Tab_ID:this.AD_Tab_ID};if(this.selectedTreeNode>0&&(I.SelectedTreeNodeID=this.selectedTreeNode,this.isSummaryyNode&&(I.TreeID=this.treeID,I.ParentNodeID=this.selectedTreeNode)),this.treeNode_ID>0&&(I.ParentNodeID=this.treeNode_ID,I.TreeID=this.treeID,I.TreeTableID=this.treeTable_ID),0!=this.onlyCurrentDays||!this.IsMaintainVersions&&!this.maintainVersionFieldChanged(f,m))return(w=this.dataSaveDB(I,l)).Status;var D=this;if(null==m.updatedby){if(this.IsHideVerNewRecord)I.MaintainVersions=!0,I.ImmediateSave=!0,I.ValidFrom=(new Date).toISOString();else if(!this.MaintainVerOnApproval||this.MaintainVerOnApproval&&"Y"==e.context.getWindowContext(this.gTable._windowNo,e.Env.approveCol))return I.MaintainVersions=!0,I.ImmediateSave=!0,I.ValidFrom=(new Date).toISOString(),void D.showVersions(D,p,I,l,!0);var w;return"E"==(w=D.dataSaveDB(I,l)).Status?w.FireEEvent||w.FireIEvent||e.ADialog.info(w.ErrorMsg):w.VersionResult&&(w.RowData=I.RowData,""!=w.VersionResult.KeyColName&&(l[w.VersionResult.KeyColName.toLower()]=w.VersionResult.Record_ID,l.isactive=w.VersionResult.IsActive),D.fireTableModelChanged(e.VTable.prototype.ROW_REFRESH,l,D.rowChanged),D.fireRowChanged(!0,D.getKeyID(D.rowChanged)),D.rowData=null,D.changed=!1,D.compareDB=!0,D.rowChanged=-1,D.newRow=-1,D.inserting=!1,null!=w.ErrorMsg&&D.log.log(e.Logging.Level.SEVERE,w.ErrorMsg),w.FireEEvent?D.fireDataStatusEEvent(w.EventParam.Msg,w.EventParam.Info,w.EventParam.IsError,w.IsWarning):w.FireIEvent&&D.fireDataStatusIEvent(w.EventParam.Msg,w.EventParam.Info,w.EventParam.IsError),"W"==w.Status&&e.ADialog.info("SentForApproval")),w.Status}if(this.MaintainVerOnApproval&&"Y"!=e.context.getWindowContext(this.gTable._windowNo,e.Env.approveCol))return(w=this.dataSaveDB(I,l)).Status;e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/CheckVersions",{RowData:I}).result?e.ADialog.confirm("FoundVersions",!0,"","Confirm",(function(e){e&&D.showVersions(D,p,I,l,!1)})):D.showVersions(D,p,I,l,!1)}},u.prototype.showVersions=function(t,i,n,a,s){new e.MasterDataVersion(t.gTable._tableName,t.gridFields,i,n.WhereClause,t.IsMaintainVersions,s,(function(i,s,l){n.MaintainVersions=!0,n.ImmediateSave=i,n.ValidFrom=s,n.VerRecID=l;var o=t.rowChanged,r=t.dataSaveDB(n,a);return"E"==r.Status?r.FireEEvent||r.FireIEvent||e.ADialog.info(r.ErrorMsg):r.VersionResult&&(t.rowChanged=o,r.RowData=n.RowData,""!=r.VersionResult.KeyColName&&(a[r.VersionResult.KeyColName.toLower()]=r.VersionResult.Record_ID,a.isactive=r.VersionResult.IsActive),t.fireTableModelChanged(e.VTable.prototype.ROW_REFRESH,a,t.rowChanged),t.fireRowChanged(!0,t.getKeyID(t.rowChanged)),t.rowData=null,t.changed=!1,t.compareDB=!0,t.rowChanged=-1,t.newRow=-1,t.inserting=!1,null!=r.ErrorMsg&&t.log.log(e.Logging.Level.SEVERE,r.ErrorMsg),r.FireEEvent?t.fireDataStatusEEvent(r.EventParam.Msg,r.EventParam.Info,r.EventParam.IsError,r.IsWarning):r.FireIEvent&&(r.EventParam.Info="VER",t.fireDataStatusIEvent(r.EventParam.Msg,r.EventParam.Info,r.EventParam.IsError)),"W"==r.Status?e.ADialog.info("SentForApproval"):"F"==r.Status?e.ADialog.info("SavedForFuture"):"B"==r.Status&&e.ADialog.info("SavedForBackDate")),r.Status})).show()},u.prototype.dataSaveDB=function(i,n){var a=e.dataContext.insertOrUpdateWRecord(i);return(a=JSON.parse(a)).IsError||(a.RowData&&t.extend(!0,n,this.readDataOfObject(a.RowData)),this.fireTableModelChanged(e.VTable.prototype.ROW_REFRESH,n,this.rowChanged),this.fireRowChanged(!0,this.getKeyID(this.rowChanged)),this.rowData=null,this.changed=!1,this.compareDB=!0,this.rowChanged=-1,this.newRow=-1,this.inserting=!1),null!=a.ErrorMsg&&this.log.log(e.Logging.Level.SEVERE,a.ErrorMsg),a.FireEEvent?this.fireDataStatusEEvent(a.EventParam.Msg,a.EventParam.Info,a.EventParam.IsError,a.IsWarning):a.FireIEvent&&this.fireDataStatusIEvent(a.EventParam.Msg,a.EventParam.Info,a.EventParam.IsError),a},u.prototype.createGridFieldArr=function(e,t){var i=e.length;if(t){if(this.gFieldLessData)return this.gFieldLessData;this.gFieldLessData=[];for(var n=0;n<i;n++){var a=(s=e[n]).getColumnName().toLowerCase();s.getIsEncryptedColumn()&&this.gFieldLessData.push(a)}return this.gFieldLessData}if(this.gFieldData)return this.gFieldData;this.gFieldData=[],this.gFieldUnique=[];for(n=0;n<i;n++){var s=e[n];this.gFieldData.push({IsVirtualColumn:s.getIsVirtualColumn(),DisplayType:s.getDisplayType(),ColumnName:s.getColumnName(),IsKey:s.getIsKey(),ColumnSQL:s.getColumnSQL(!0),IsEncryptedColumn:s.getIsEncryptedColumn(),IsParentColumn:s.getIsParentColumn(),Name:s.getHeader(),IsUnique:s.getIsUnique(),IsObscure:!!s.getObscureType()}),s.getIsUnique()&&!s.getIsVirtualColumn()&&s.getIsDisplayed()&&this.gFieldUnique.push(s.getColumnName())}return this.gFieldData},u.prototype.createObsecureFields=function(e){var t=e.length;if(this.gFieldObscureList)return this.gFieldObscureList;this.gFieldObscureList=[];for(var i=0;i<t;i++){var n=e[i];n.getObscureType()&&this.gFieldObscureList.push(n.getColumnName().toLowerCase())}return this.gFieldObscureList},u.prototype.dataRefreshAll=function(){this.inserting=!1,this.dataIgnore(),this.close(!1),this.open(this.maxRows),this.dseEvent="Refreshed"},u.prototype.dataRequery=function(e){return this.close(!1),this.setSelectWhereClause(e),this.rowData=null,this.changed=!1,this.rowChanged=-1,this.inserting=!1,this.open(this.maxRows),this.dseEvent="Refreshed",!0},u.prototype.dataRefresh=function(a){if(a<0||0==this.getRowCount()||this.inserting)return null;var s=this.getRow(a);this.dataIgnore();var l=this.getWhereClause(s);null!=l&&0!=l.length||(l="1=2");var o=null,r=null;try{t.ajax({url:n+"Window/GetWindowRecord",async:!1,type:"post",data:{ctxp:e.context.getWindowCtx(this.gTable._windowNo),Columns:this.columns,TableName:this.gTable._tableName,AD_Window_ID:this.gridFields[0].getAD_Window_ID(),AD_Tab_ID:this.AD_Tab_ID,WindowNo:this.gTable._windowNo,WhereClause:e.secureEngine.encrypt(l),Encryptedfields:this.createGridFieldArr(this.gridFields,!0),ObscureFields:this.createObsecureFields(this.gridFields)},success:function(t){r=(new e.DB.DataReader).toJson(t)},error:function(){}}),r.read()&&(o=this.readData(r)),o.recid=s.recid}catch(t){return console.log(t),sql=e.secureEngine.decrypt(sql),this.log.log(i.SEVERE,sql,t),this.fireDataStatusEEvent("RefreshError",sql,!0),null}finally{null!=r&&r.dispose()}return this.rowData=null,this.changed=!1,this.rowChanged=-1,this.inserting=!1,this.fireTableModelChanged(e.VTable.prototype.ROW_REFRESH,o),this.fireDataStatusIEvent("Refreshed",""),o},u.prototype.getRowFromDB=function(a,s){if(a<0||0==this.getRowCount()||this.inserting)return null;var l=this.getRow(a),o=this.getWhereClause(l);null!=o&&0!=o.length||(o="1=2");var r=null,d=null,c=!!s,p=null;s&&(p=this);try{t.ajax({url:n+"Window/GetWindowRecord",async:c,type:"post",data:{ctxp:e.context.getWindowCtx(this.gTable._windowNo),Columns:this.columns,TableName:this.gTable._tableName,AD_Window_ID:this.gridFields[0].getAD_Window_ID(),AD_Tab_ID:this.AD_Tab_ID,WindowNo:this.gTable._windowNo,WhereClause:e.secureEngine.encrypt(o),Encryptedfields:this.createGridFieldArr(this.gridFields,!0),ObscureFields:this.createObsecureFields(this.gridFields)},success:function(t){d=(new e.DB.DataReader).toJson(t),s&&(d.read()&&(r=p.readData(d)),r.recid=l.recid,s(r))},error:function(){}}),s||(d.read()&&(r=this.readData(d)),r.recid=l.recid)}catch(t){return console.log(t),sql=e.secureEngine.decrypt(sql),this.log.log(i.SEVERE,sql,t),null}finally{null!=d&&d.dispose()}return r},u.prototype.dataNew=function(t,i){if(this.log.info("Current="+t+", Copy="+i),this.readOnly)return this.fireDataStatusEEvent("AccessCannotInsert","",!0),!1;this.inserting=!0;var n=this.gridFields.length;this.rowData={};var a={},s=this.gTable._windowNo+e.EnvConstants.WINDOW_TEMP;if(i)for(var l=this.getRow(t),o=0;o<n;o++){var r=(u=this.gridFields[o]).getColumnName(),d=r.toLowerCase();if(u.getIsVirtualColumn());else if(u.getIsKey()||r.equals("AD_Client_ID")||r.equals("IsActive")||r.startsWith("Created")||r.startsWith("Updated")||r.equals("EntityType")||r.equals("DocumentNo")||r.equals("Processed")||r.equals("IsSelfService")||r.equals("DocAction")||r.equals("DocStatus")||r.startsWith("Ref_")||r.equals("Posted")||r.equals("GrandTotal")||r.equals("TotalLines")||r.equals("C_CashLine_ID")||r.equals("C_Payment_ID")||r.equals("IsPaid")||r.equals("IsAllocated")||r.equalsIgnoreCase("C_Location_ID")||r.equals("IsApproved")||r.equals("IsDelivered")||r.equals("IsInvoiced")||r.equals("TotalDr")||r.equals("TotalCr")||r.equalsIgnoreCase("I_IsImported")){var c=u.getDefault(this.ctx,s);a[d]=c,null!=c&&this.ctx.setWindowContext(s,u.getColumnName(),c.toString())}else if(u.getIsCopy()){var p=l[r.toLowerCase()];a[d]=p,null!=p&&this.ctx.setWindowContext(s,u.getColumnName(),p.toString())}else{c=u.getDefault(this.ctx,s);a[d]=c,null!=c&&this.ctx.setWindowContext(s,u.getColumnName(),c.toString())}}else for(o=0;o<n;o++){var u;c=(u=this.gridFields[o]).getDefault(this.ctx,s);a[u.getColumnName().toLowerCase()]=c,null!=c&&this.ctx.setWindowContext(s,u.getColumnName(),c.toString())}return this.ctx.removeWindow(s),this.changed=!0,this.compareDB=!0,this.newRow=t+1,this.getRowCount()<this.newRow&&(this.newRow=this.getRowCount()),this.rowChanged=this.newRow,this.rowCount++,a.recid=this.rowCount,this.pazeSize++,this.fireTableModelChanged(e.VTable.prototype.ROW_ADD,a,this.newRow,null),this.log.fine("Current="+this.currentRow+", New="+this.newRow+" - complete"),!0},u.prototype.dataDelete=function(t,n){if(!t||t.length<0)return!1;if(this.readOnly)return this.fireDataStatusEEvent("AccessCannotDelete","",!0),!1;if(!this.deleteable)return this.fireDataStatusEEvent("AccessNotDeleteable","",!0),!1;for(var a=-1!=this.gTable._indexKeyColumn,s=this.gTable._indexProcessedColumn>0&&!this.gTable._tableName.startsWith("I_"),l=[],o=[],r=[],d=[],c=this.AD_Table_ID,p=null,u=0;u<t.length;u++){if(p=this.mSortList[t[u]],s){var g=this.getValueAt(t[u],"processed");if(null!=g&&g){l.push(p.recid);continue}}o.push(p.recid),a?r.push(p[this.keyColumnName.toLowerCase()]):d.push(this.getWhereClause(p))}var h=null;if(o.length>0){var v={RecIds:o,HasKeyColumn:a,TableName:this.gTable._tableName,AD_Table_ID:c};a?v.SingleKeyWhere=r:v.MultiKeyWhere=d,h=e.dataContext.deleteWRecords(v),h=JSON.parse(h)}else if(l.length>0)return this.fireDataStatusEEvent("CannotDeleteTrx","",!0),!1;if(h){if(h.UnDeletedRecIds&&h.UnDeletedRecIds.length>0?selIndexOrId=h.UnDeletedRecIds:l.length>0?selIndexOrId=l:selIndexOrId=n,h.DeletedRecIds&&h.DeletedRecIds.length>0&&(this.rowCount-=h.DeletedRecIds.length,this.fireTableModelChanged(e.VTable.prototype.ROW_DELETE,h.DeletedRecIds,selIndexOrId),h.RecIds&&h.RecIds.length>0&&this.fireRowChanged(!1,h.RecIds)),h.ErrorMsg&&this.log.log(i.SEVERE,h.ErrorMsg),h.InfoMsg&&this.log.log(i.Info,h.InfoMsg),h.IsError)return h.FireEEvent&&this.fireDataStatusEEvent(h.EventParam.Msg,h.EventParam.Info,h.EventParam.IsError),!1;this.changed=!1,this.rowChanged=-1,this.fireDataStatusIEvent("Deleted","")}return!0},u.prototype.dataDeleteAsync=function(t,n){var a=this;return new Promise((function(s,l){if(!t||t.length<0)s(!1);else{if(a.readOnly)return a.fireDataStatusEEvent("AccessCannotDelete","",!0),void s(!1);if(!a.deleteable)return a.fireDataStatusEEvent("AccessNotDeleteable","",!0),void s(!1);for(var o=-1!=a.gTable._indexKeyColumn,r=a.gTable._indexProcessedColumn>0&&!a.gTable._tableName.startsWith("I_"),d=[],c=[],p=[],u=[],g=a.AD_Table_ID,h=null,v=0;v<t.length;v++){if(h=a.mSortList[t[v]],r){var f=a.getValueAt(t[v],"processed");if(null!=f&&f){d.push(h.recid);continue}}c.push(h.recid),o?p.push(h[a.keyColumnName.toLowerCase()]):u.push(a.getWhereClause(h))}if(c.length>0){var m={RecIds:c,HasKeyColumn:o,TableName:a.gTable._tableName,AD_Table_ID:g};o?m.SingleKeyWhere=p:m.MultiKeyWhere=u,e.dataContext.deleteWRecords(m).then((function(t){if(t=JSON.parse(t)){return t.UnDeletedRecIds&&t.UnDeletedRecIds.length>0?selIndexOrId=t.UnDeletedRecIds:d.length>0?selIndexOrId=d:selIndexOrId=n,t.DeletedRecIds&&t.DeletedRecIds.length>0&&(a.rowCount-=t.DeletedRecIds.length,a.fireTableModelChanged(e.VTable.prototype.ROW_DELETE,t.DeletedRecIds,selIndexOrId),t.RecIds&&t.RecIds.length>0&&a.fireRowChanged(!1,t.RecIds)),t.ErrorMsg&&a.log.log(i.SEVERE,t.ErrorMsg),t.InfoMsg&&a.log.log(i.Info,t.InfoMsg),t.IsError?(t.FireEEvent&&a.fireDataStatusEEvent(t.EventParam.Msg,t.EventParam.Info,t.EventParam.IsError),void s(!1)):(a.changed=!1,a.rowChanged=-1,a.fireDataStatusIEvent("Deleted",""),void s(!0))}}))}else if(d.length>0)return a.fireDataStatusEEvent("CannotDeleteTrx","",!0),void s(!1)}}))},u.prototype.readData=function(e){var t={},i=this.gridFields.length,n=null;try{for(var a=0;a<i;a++)t[n=this.gridFields[a].getColumnName().toLowerCase()]=this.readDataOfColumn(n,e.getCell(n)),n=null;return t}catch(e){throw e}},u.prototype.readDataOfObject=function(t){var i={},n=this.gridFields.length,a=null,s=[];try{for(var l=0;l<n;l++)i[a=this.gridFields[l].getColumnName().toLowerCase()]=this.readDataOfColumn(a,t[a]),this.gridFields[l].getDisplayType()==e.DisplayType.Image&&s.push("imgurlcolumn"+a),a=null;if(s&&s.length>0)for(k=0;k<s.length;k++)i[s[k]]=this.readDataOfColumn(s[k],t[s[k]]);return i}catch(e){throw e}},u.prototype.close=function(e){this.isOpen&&(this.inserting,null!=this.bufferList&&(this.bufferList.length=0,this.bufferList=null,this.bufferList=[],this.mSortList=null),null!=this.mSortList&&(this.mSortList=null),e&&this.dispose(),this.isOpen=!1)},u.prototype.dataIgnore=function(i){if(this.inserting||this.changed||!(this.rowChanged<0)){if(this.inserting)this.rowCount--,this.pazeSize--,this.changed=!1,this.rowChanged=-1,this.inserting=!1,this.fireTableModelChanged(e.VTable.prototype.ROW_UNDO,this.mSortList[this.newRow].recid,this.newRow);else if(null!=this.rowData){var n=this.getRow(this.rowChanged);t.extend(n,this.rowData)}return this.changed=!1,this.rowChanged=-1,this.rowData=null,this.inserting=!1,this.newRow=-1,i||this.fireDataStatusIEvent("Ignored",""),!0}},u.prototype.createDSE=function(){var e=this.changed;-1!=this.rowChanged&&(e=!0);var t=new v(null,this.getRowCount(),e,!1,this.inserting);return t.setPageInfo(this.currentPage,this.rowCount,this.pazeSize),t.AD_Table_ID=this.gTable._AD_Table_ID,t.Record_ID=null,t},u.prototype.fireDataStatusChanged=function(e){this.mDataListener&&this.mDataListener.dataStatusChanged(e),e=null},u.prototype.fireTableModelChanged=function(e,t,i,n){this.mCardModelListener&&this.mCardModelListener.tableModelChanged(e,t,i,n),this.mTableModelListener&&this.mTableModelListener.tableModelChanged(e,t,i,n)},u.prototype.fireRowChanged=function(e,t){this.mRowChangedListener&&this.mRowChangedListener.rowChanged(e,t)},u.prototype.fireDataStatusIEvent=function(e,t){var i=this.createDSE();i.setInfo(e,t,!1,!1),this.fireDataStatusChanged(i)},u.prototype.fireQueryCompleted=function(e){this.mQueryCompletedListener&&this.mQueryCompletedListener.queryCompleted(e),e=null},u.prototype.fireDataStatusEEvent=function(e,t,i,n){if(1===arguments.length)this.fireDataStatusEEvent(myarguments[0].value,myarguments[0].name,!0,!1);else{var a=this.createDSE();n?i=!n:n=!i,a.setInfo(e,t,i,n),this.fireDataStatusChanged(a)}},u.prototype.addDataStatusListener=function(e){this.mDataListener=e},u.prototype.removeDataStatusListener=function(e){this.mDataListener=null},u.prototype.addQueryCompleteListner=function(e){this.mQueryCompletedListener=e},u.prototype.removeQueryCompleteListner=function(e){this.mQueryCompletedListener=null},u.prototype.addTableModelListener=function(e){this.mTableModelListener=e},u.prototype.removeTableModelListener=function(e){this.mTableModelListener=null},u.prototype.addCardModelListener=function(e){this.mCardModelListener=e},u.prototype.removeCardModelListener=function(e){this.mCardModelListener=null},u.prototype.addRowChangedListener=function(e){this.mRowChangedListener=e},u.prototype.removeRowChangedListener=function(e){this.mRowChangedListener=null},u.prototype.updateTableModel=function(t){var i=t.getColumnName(),n=t.getDisplayType();n==e.DisplayType.Integer||e.DisplayType.IsID(n)&&(i.endsWith("_ID")||i.endsWith("_Acct")||i.endsWith("_ID_1")||i.endsWith("_ID_2")||i.endsWith("_ID_3"))||i.endsWith("atedBy")||e.DisplayType.IsNumeric(n)?this.defaultModel[i.toLowerCase()]=new Number:e.DisplayType.IsDate(n)?this.defaultModel[i.toLowerCase()]=new Date:n==e.DisplayType.RowID?(dc=new DataColumn(i,typeof Object),this.defaultModel[i.toLowerCase()]=new Object):n==e.DisplayType.YesNo?this.defaultModel[i.toLowerCase()]=new Boolean:(e.DisplayType.IsLOB(n),this.defaultModel[i.toLowerCase()]=new String)},u.prototype.dispose=function(){originalLength=this.gridFields.length;for(var e=originalLength;e>0;e--)this.gridFields.pop().dispose(),null;this.gridFields.length=0,this.gTable=null,this.gridFields=null,this.gFieldLessData=null,this.gFieldData=null,this.gFieldUnique=null},u.prototype.maintainVersionFieldChanged=function(e,t){if(this.gridFields&&this.gridFields.length>0)for(var i=0;i<this.gridFields.length;i++)if(this.gridFields[i].vo.IsMaintainVersions){var n=this.gridFields[i].vo.ColumnName.toLowerCase();if(e[n]!=t[n])return!0}return!1},g.prototype.PROPERTY="FieldValue",g.prototype.INSERTING="FieldValueInserting",g.prototype.setGridTab=function(e){this.gridTab=e},g.prototype.getIsInserting=function(){return this.inserting},g.prototype.getIsDisplayed=function(t){if(0==arguments.length)return this.vo.IsDisplayedf;if(!this.vo.IsDisplayedf)return!1;if(null==this.vo.DisplayLogic||this.vo.DisplayLogic.equals(""))return!0;if(t){for(var i=!1,n=[],a=[],s=new e.StringTokenizer(this.vo.DisplayLogic,"[]");s.hasMoreTokens();){var l=s.nextToken();l.trim()!=" & ".trim()?(i=e.Evaluator.evaluateLogic(this,l),n.push(i)):a.push(l)}return n.length>1&&(a[0].trim().equals("&")?i=!(n.indexOf(!1)>-1):a[0].trim().equals("|")&&n.indexOf(!0)>-1&&(i=!0)),i}return!0},g.prototype.getIsDisplayedMR=function(t){if(0==arguments.length)return this.vo.IsDisplayedMR;if(!this.vo.IsDisplayedMR)return!1;if(null==this.vo.DisplayLogic||this.vo.DisplayLogic.equals(""))return!0;if(t){for(var i=!1,n=[],a=[],s=new e.StringTokenizer(this.vo.DisplayLogic,"[]");s.hasMoreTokens();){var l=s.nextToken();l.trim()!=" & ".trim()?(i=e.Evaluator.evaluateLogic(this,l),n.push(i)):a.push(l)}return n.length>1&&(a[0].trim().equals("&")?i=!(n.indexOf(!1)>-1):a[0].trim().equals("|")&&n.indexOf(!0)>-1&&(i=!0)),i}return!0},g.prototype.getColumnName=function(){return this.vo.ColumnName},g.prototype.getIsLongField=function(){return this.vo.DisplayLength>=30},g.prototype.getFieldColSpan=function(){return this.vo.DisplayLength<=9?1:this.vo.DisplayLength<=19?2:this.vo.DisplayLength<=29?3:4},g.prototype.getIsMandatory=function(t){if(t&&null!=this.vo.mandatoryLogic&&this.vo.mandatoryLogic.length>0&&e.Evaluator.evaluateLogic(this,this.vo.mandatoryLogic))return!0;if(!this.vo.IsMandatoryUI||this.getIsVirtualColumn())return!1;var i=this.vo;return!(i.IsKey&&i.ColumnName.endsWith("_ID")||i.ColumnName.startsWith("Created")||i.ColumnName.startsWith("Updated")||i.ColumnName.equals("M_AttributeSetInstance_ID"))&&this.getIsDisplayed(t)},g.prototype.getDisplayType=function(){return this.vo.displayType},g.prototype.getOrginalDisplayType=function(){return this.vo.orginalDispaly},g.prototype.getIsVirtualColumn=function(){return!!(this.vo.ColumnSQL&&this.vo.ColumnSQL.length>0)},g.prototype.getIsReadOnly=function(){return!!this.getIsVirtualColumn()||this.vo.IsReadOnly},g.prototype.setReadOnly=function(e){this.vo.IsReadOnly=e},g.prototype.getIsEditable=function(t,i){var n=this.vo;if(this.getIsVirtualColumn())return!1;if(n.ColumnName.equals("Posted")||n.ColumnName.equals("Record_ID")&&(n.displayType==e.DisplayType.Button||this.getOrginalDisplayType()==e.DisplayType.Button))return!0;var a=i&&!(null==this.vo.DisplayLogic||this.vo.DisplayLogic.equals(""));if(n.IsAlwaysUpdateable&&!n.tabReadOnly&&!a)return!0;if(n.tabReadOnly||n.IsReadOnly)return!1;if(!n.IsUpdateable&&!this.inserting)return!1;if(n.ColumnName.equals(e.context.getWindowTabContext(n.windowNo,n.tabNo,"LinkColumnName")))return!1;var s=e.context;if(t){var l=parseInt(s.getTabRecordContext(n.windowNo,n.tabNo,"AD_Client_ID"));n.ColumnName.equals("AD_Org_ID")&&(null!=s.getWindowContext(n.windowNo,"AD_Org_ID")&&0!=s.getWindowContext(n.windowNo,"AD_Org_ID").length||s.setWindowContext(n.windowNo,"AD_Org_ID",s.getContext("#AD_Org_ID")));var o=parseInt(s.getTabRecordContext(n.windowNo,n.tabNo,"AD_Org_ID")),r=s.getWindowTabContext(n.windowNo,n.tabNo,"KeyColumnName"),d=n.AD_Window_ID;"EntityType".equals(r)&&(r="AD_EntityType_ID"),r.toUpperCase().endsWith("_ID")||(r+="_ID");var c=s.getWindowTabContext(n.windowNo,n.tabNo,r);""==c&&this.gridTab&&(c=s.getWindowTabContext(n.windowNo,n.tabNo,this.gridTab.getTableName()+"_ID")),""==c&&(c=0);var p=n.AD_Table_ID;if(!e.MRole.canUpdate(l,o,p,c,!1)||!e.MRole.getWindowAccess(d))return!1;if(!e.MRole.getIsColumnAccess(p,this.vo.AD_Column_ID,!1))return!1;if(this.gridTab&&this.gridTab.IsSharedReadOnly)return!1}if(t&&n.ReadOnlyLogic.length>0&&!!e.Evaluator.evaluateLogic(this,n.ReadOnlyLogic))return!1;return!!(n.ColumnName.equals("Processing")||n.ColumnName.equals("DocAction")||n.ColumnName.equals("GenerateTo"))||!(t&&(s.getWindowContext(n.windowNo,n.tabNo,"Processed").equals("Y")||s.getWindowContext(n.windowNo,n.tabNo,"Processing").equals("Y"))&&!a)&&(!!n.ColumnName.equals("IsActive")||!(t&&!s.getWindowContext(n.windowNo,n.tabNo,"IsActive").equals("Y"))&&(i?this.getIsDisplayedMR(t):this.getIsDisplayed(t)))},g.prototype.evaluateLogicsOnly=function(){var t=this.vo,i=!1;return t.ReadOnlyLogic.length>0&&(i=e.Evaluator.evaluateLogic(this,t.ReadOnlyLogic)),!i&&t.DisplayLogic.length>0&&(i=e.Evaluator.evaluateLogic(this,t.DisplayLogic)),i},g.prototype.getWindowNo=function(){return this.vo.windowNo},g.prototype.getIsHeading=function(){return this.vo.IsHeading},g.prototype.getIsSameLine=function(){return this.vo.IsSameLine},g.prototype.getHeader=function(){return this.vo.Header},g.prototype.getDescription=function(){return this.vo.Description},g.prototype.getHelp=function(){return this.vo.Help},g.prototype.getAD_Process_ID=function(){return this.vo.AD_Process_ID},g.prototype.getAD_Form_ID=function(){return this.vo.AD_Form_ID},g.prototype.getAD_Column_ID=function(){return this.vo.AD_Column_ID},g.prototype.getAD_Field_ID=function(){return this.vo.AD_Field_ID},g.prototype.getFieldGroup=function(){return this.vo.FieldGroup},g.prototype.getIsFieldOnly=function(){return this.vo.IsFieldOnly},g.prototype.getShowLabel=function(){return!0},g.prototype.getIsKey=function(){return this.vo.IsKey},g.prototype.getIsParentColumn=function(){return this.vo.IsParent},g.prototype.getSortNo=function(){return this.vo.SortNo},g.prototype.getMRSeqNo=function(){return this.vo.mrSeqNo},g.prototype.getIsSelectionColumn=function(){return this.vo.IsSelectionColumn},g.prototype.getSelectionSeqNo=function(){return this.vo.SelectionSeqNo},g.prototype.getIsIncludedColumn=function(){return this.vo.IsIncludedColumn},g.prototype.getDependentOn=function(){var t=[],i=this.getColumnName();return i.equals("M_AttributeSetInstance_ID")?t.push("M_Product_ID"):(i.equals("M_Locator_ID")||i.equals("M_LocatorTo_ID"))&&(t.push("M_Product_ID"),t.push("M_Warehouse_ID")),e.Evaluator.parseDepends(t,this.vo.DisplayLogic),e.Evaluator.parseDepends(t,this.vo.ReadOnlyLogic),null!=this.lookup&&e.Evaluator.parseDepends(t,this.lookup.getValidation()),t},g.prototype.getAD_Window_ID=function(){return this.vo.AD_Window_ID},g.prototype.getAD_InfoWindow_ID=function(){return this.vo.AD_InfoWindow_ID},g.prototype.getValueAsString=function(t){var i=e.context.getWindowContext(this.vo.windowNo,this.vo.tabNo,t,!0);return i?i.toString():""},g.prototype.getColumnSQL=function(t){return 0==arguments.length?this.vo.ColumnName:null!=this.vo.ColumnSQL&&this.vo.ColumnSQL.length>0&&t?(this.vo.displayType,e.DisplayType.YesNo,this.vo.ColumnSQL+" AS "+this.vo.ColumnName):(this.vo.displayType,e.DisplayType.YesNo,this.vo.ColumnSQL)},g.prototype.getIsLink=function(){return this.vo.isLink},g.prototype.getIsRightPaneLink=function(){return this.vo.isRightPaneLink},g.prototype.getColumnWidth=function(){return this.vo.ColumnWidth},g.prototype.getIsAlwaysUpdateable=function(){return!(this.getIsVirtualColumn()||!this.vo.IsUpdateable)&&this.vo.IsAlwaysUpdateable},g.prototype.getIsEncryptedField=function(){return this.vo.IsEncryptedField},g.prototype.getIsEncrypted=function(){if(this.vo.IsEncryptedField)return!0;var e=this.getObscureType();return null!=e&&e.length>0||this.vo.ColumnName.equals("Password")},g.prototype.getObscureType=function(){return this.vo.ObscureType},g.prototype.getDisplayLength=function(){return this.vo.DisplayLength},g.prototype.getFieldLength=function(){return this.vo.FieldLength},g.prototype.getMinValue=function(){return this.vo.ValueMin},g.prototype.getMaxValue=function(){return this.vo.ValueMax},g.prototype.getVFormat=function(){return this.vo.VFormat},g.prototype.getVFormatError=function(){return this.vo.VFormatError},g.prototype.getLookup=function(){return this.lookup},g.prototype.getIsError=function(){return this.error},g.prototype.getIsCopy=function(){return this.vo.IsCopy},g.prototype.getCallout=function(){return this.vo.Callout},g.prototype.getValue=function(){return this.value},g.prototype.getIsIdentifier=function(){return this.vo.IsIdentifier},g.prototype.getOldValue=function(){return this.oldValue},g.prototype.getIsRange=function(){return this.vo.isRange},g.prototype.getIsRange=function(){return this.vo.isRange},g.prototype.getIsParentValue=function(){var t=e.context;if(null!=this.parentValue)return this.parentValue;if(e.DisplayType.IsID(this.vo.displayType)&&0!=this.vo.tabNo){var i=t.getWindowTabContext(this.vo.windowNo,this.vo.tabNo,"LinkColumnName");0==i.length?this.parentValue=!1:this.parentValue=this.vo.ColumnName.equals(i),this.parentValue&&this.log.config(this.parentValue+" - Link("+i+", W="+this.vo.windowNo+",T="+this.vo.tabNo+") = "+this.vo.ColumnName)}else this.parentValue=!1;return this.parentValue},g.prototype.getDefault=function(t,n){var a=this.vo;if(a.IsKey||a.displayType==e.DisplayType.RowID||e.DisplayType.IsLOB(a.displayType))return null;if(this.getIsParentValue()&&e.Utility.Util.isEmpty(a.DefaultValue)){var s=t.getWindowContext(a.windowNo,a.ColumnName);return this.gridTab&&(s=t.getWindowContext(a.windowNo,this.gridTab.getParentTabNo(),a.ColumnName)),this.log.fine("[Parent] "+a.ColumnName+"="+s),this.createDefault(a.ColumnName,s)}if(a.ColumnName.equals("IsActive"))return this.log.fine("[IsActive] "+a.ColumnName+"=Y"),!0;if(e.Consts.ACCESSLEVEL_SystemOnly.equals(t.getWindowTabContext(a.windowNo,a.tabNo,"AccessLevel"))&&(a.ColumnName.equals("AD_Client_ID")||a.ColumnName.equals("AD_Org_ID")))return this.log.fine("[SystemAccess] "+a.ColumnName+"=0"),0;if(e.Consts.ACCESSLEVEL_SystemPlusClient.equals(t.getWindowTabContext(a.windowNo,a.tabNo,"AccessLevel"))&&a.ColumnName.equals("AD_Org_ID"))return this.log.fine("[ClientAccess] "+a.ColumnName+"=0"),0;var l="";if(""!==(l=e.Env.getPreference(t,a.AD_Window_ID,a.ColumnName,!1)))return this.log.fine("[UserPreference] "+a.ColumnName+"="+l),this.createDefault("",l);if(a.DefaultValue.startsWith("@SQL=")){var r=a.DefaultValue.substring(5),d=e.Env.parseContext(t,a.windowNo,r,!1,!0),c=d.toUpperCase();if(-1!=c.indexOf("DELETE ")&&-1!=c.indexOf("UPDATE ")&&-1!=c.indexOf("DROP ")&&(d=""),d.equals(""))this.log.log(i.WARNING,"("+a.ColumnName+") - Default SQL variable parse failed: "+r);else{var p=null;try{(p=o(d)).read()?l=p.getString(0):this.log.log(i.WARNING,"("+a.ColumnName+") - no Result: "+d),p.close()}catch(e){d.endsWith("=")?this.log.log(i.SEVERE,"("+a.ColumnName+") "+r,e):this.log.log(i.WARNING,"("+a.ColumnName+") "+d,e)}finally{null!=p&&p.dispose()}}if(null!=l&&l.length>0)return this.log.fine("[SQL] "+a.ColumnName+"="+l),this.createDefault("",l)}if(!a.DefaultValue.equals("")&&!a.DefaultValue.startsWith("@SQL=")){l="";for(var u=new e.StringTokenizer(a.DefaultValue,",;",!1);u.hasMoreTokens();){var g=u.nextToken().trim();if(g.equals("@SysDate@")||g.equals("@Now@")){var h=new Date;return h.setMilliseconds(0),h.setSeconds(0),h.toISOString()}if(-1!=g.indexOf("@")?(l=t.getWindowContext(a.windowNo,g.replaceAll("@"," ").trim()),"AD_Org_ID"!=a.ColumnName||e.MRole.getIsOrgAccess(Number(l),!1)||(l=g)):l=g.startsWith("'")&&g.endsWith("'")?g.length-2>0?g.substring(1,g.length-1):g.replaceAll("'",""):g,l.length>0)return this.log.fine("[DefaultValue] "+a.ColumnName+"="+l),this.createDefault(g,l)}}if(null!=this.lookup&&!e.Utility.Util.isEmpty(this.lookup.getValidation())){for(var v=this.lookup.getValidation(),f=e.Evaluator.getVariables(v),m=!1,y=0;y<f.length;y++){var I=f[y];if(!I.startsWith("#")&&I.toUpperCase().endsWith("_ID")&&!I.equals(a.ColumnName)){var D=t.getWindowContext(n,I);if(m=e.Utility.Util.isEmpty(D))break}}if(m)return this.lookup.clear(),null}return""!==(l=e.Env.getPreference(t,a.AD_Window_ID,a.ColumnName,!0))?(this.log.fine("[SystemPreference] "+a.ColumnName+"="+l),this.createDefault("",l)):a.displayType!=e.DisplayType.Button||a.ColumnName.toUpperCase().endsWith("_ID")?this.vo.displayType==e.DisplayType.YesNo?(this.log.fine("[YesNo=N] "+a.ColumnName),!1):a.ColumnName.toUpperCase().endsWith("_ID")?(this.log.fine("[ID=null] "+a.ColumnName),null):e.DisplayType.IsNumeric(a.displayType)?(this.log.fine("[Number=0] "+a.ColumnName),this.createDefault("","0")):(this.log.fine("[NONE] "+a.ColumnName),null):(this.log.fine("[Button=N] "+a.ColumnName),"N")},g.prototype.getDefault2=function(t,n){var a=this.vo;if(a.IsKey||a.displayType==e.DisplayType.RowID||e.DisplayType.IsLOB(a.displayType))return null;if(this.getIsParentValue()&&e.Utility.Util.isEmpty(a.DefaultValue2)){var s=t.getWindowContext(a.windowNo,a.ColumnName);return this.log.fine("[Parent] "+a.ColumnName+"="+s),this.createDefault(a.ColumnName,s)}if(a.ColumnName.equals("IsActive"))return this.log.fine("[IsActive] "+a.ColumnName+"=Y"),!0;if(e.Consts.ACCESSLEVEL_SystemOnly.equals(t.getWindowTabContext(a.windowNo,a.tabNo,"AccessLevel"))&&(a.ColumnName.equals("AD_Client_ID")||a.ColumnName.equals("AD_Org_ID")))return this.log.fine("[SystemAccess] "+a.ColumnName+"=0"),0;if(e.Consts.ACCESSLEVEL_SystemPlusClient.equals(t.getWindowTabContext(a.windowNo,a.tabNo,"AccessLevel"))&&a.ColumnName.equals("AD_Org_ID"))return this.log.fine("[ClientAccess] "+a.ColumnName+"=0"),0;var l="";if(""!==(l=e.Env.getPreference(t,a.AD_Window_ID,a.ColumnName,!1)))return this.log.fine("[UserPreference] "+a.ColumnName+"="+l),this.createDefault("",l);if(a.DefaultValue2.startsWith("@SQL=")){var r=a.DefaultValue2.substring(5),d=e.Env.parseContext(t,a.windowNo,r,!1,!0),c=d.toUpperCase();if(-1!=c.indexOf("DELETE ")&&-1!=c.indexOf("UPDATE ")&&-1!=c.indexOf("DROP ")&&(d=""),d.equals(""))this.log.log(i.WARNING,"("+a.ColumnName+") - Default SQL variable parse failed: "+r);else{var p=null;try{(p=o(d)).read()?l=p.getString(0):this.log.log(i.WARNING,"("+a.ColumnName+") - no Result: "+d),p.close()}catch(e){d.endsWith("=")?this.log.log(i.SEVERE,"("+a.ColumnName+") "+r,e):this.log.log(i.WARNING,"("+a.ColumnName+") "+d,e)}finally{null!=p&&p.dispose()}}if(null!=l&&l.length>0)return this.log.fine("[SQL] "+a.ColumnName+"="+l),this.createDefault("",l)}if(!a.DefaultValue2.equals("")&&!a.DefaultValue2.startsWith("@SQL=")){l="";for(var u=new e.StringTokenizer(a.DefaultValue2,",;",!1);u.hasMoreTokens();){var g=u.nextToken().trim();if(g.equals("@SysDate@")||g.equals("@Now@"))return(new Date).toISOString();if((l=-1!=g.indexOf("@")?t.getWindowContext(a.windowNo,g.replaceAll("@"," ").trim()):g.startsWith("'")&&g.endsWith("'")?g.length-2>0?g.substring(1,g.length-1):g.replaceAll("'",""):g).length>0)return this.log.fine("[DefaultValue2] "+a.ColumnName+"="+l),this.createDefault(g,l)}}if(null!=this.lookup&&!e.Utility.Util.isEmpty(this.lookup.getValidation())){for(var h=this.lookup.getValidation(),v=e.Evaluator.getVariables(h),f=!1,m=0;m<v.length;m++){var y=v[m];if(!y.startsWith("#")&&y.toUpperCase().endsWith("_ID")&&!y.equals(a.ColumnName)){var I=t.getWindowContext(n,y);if(f=e.Utility.Util.isEmpty(I))break}}if(f)return this.lookup.clear(),null}return""!==(l=e.Env.getPreference(t,a.AD_Window_ID,a.ColumnName,!0))?(this.log.fine("[SystemPreference] "+a.ColumnName+"="+l),this.createDefault("",l)):a.displayType!=e.DisplayType.Button||a.ColumnName.toUpperCase().endsWith("_ID")?this.vo.displayType==e.DisplayType.YesNo?(this.log.fine("[YesNo=N] "+a.ColumnName),!1):a.ColumnName.toUpperCase().endsWith("_ID")?(this.log.fine("[ID=null] "+a.ColumnName),null):e.DisplayType.IsNumeric(a.displayType)?(this.log.fine("[Number=0] "+a.ColumnName),this.createDefault("","0")):(this.log.fine("[NONE] "+a.ColumnName),null):(this.log.fine("[Button=N] "+a.ColumnName),"N")},g.prototype.getIsEncryptedColumn=function(){return this.vo.IsEncryptedColumn},g.prototype.getZoomWindow_ID=function(){return this.vo.ZoomWindow_ID},g.prototype.getIsDefaultFocus=function(){return this.vo.IsDefaultFocus},g.prototype.getStyleLogic=function(){return this.vo.StyleLogic||(this.vo.StyleLogic=""),this.vo.StyleLogic},g.prototype.createDefault=function(t,n){if(null==n||0==n.length)return null;try{if(!this.vo.IsReadOnly&&""!=this.vo.ValidationCode&&null!=this.lookup&&this.lookup.displayType==e.DisplayType.List&&this.lookup.getIsValidated()&&!Object.keys(this.lookup.lookup).includes(" "+n))return"";if(this.vo.ColumnName.endsWith("atedBy")||this.vo.ColumnName.toUpperCase().endsWith("_ID")){try{var a=parseInt(n);return a<0?null:a}catch(e){this.log.warning("Cannot parse: "+n+" - "+e.message)}return 0}if(this.vo.displayType==e.DisplayType.Integer)return parseInt(n);if(e.DisplayType.IsNumeric(this.vo.displayType))return parseFloat(n);if(e.DisplayType.IsDate(this.vo.displayType)){try{var s=null;return isNaN(Number(n))?s=new Date(n):(s=new Date,console.log(this.vo.ColumnName+"==>[1n] "+s),s.setMinutes(-s.getTimezoneOffset()+s.getMinutes()),console.log(this.vo.ColumnName+"==>[3n] "+s.toISOString())),s.setMilliseconds(0),s.setSeconds(0),s.toISOString()}catch(e){}var l=n+"2014-01-01T01:00:05Z".substring(n.length);try{new Date(l).toISOString()}catch(e){this.log.warning("Cannot convert to Timestamp: "+l)}return(s=new Date).setMilliseconds(0),s.setSeconds(0),s.toISOString()}if(this.vo.displayType==e.DisplayType.YesNo)return"Y".equals(n);if(t.equals("@#Date@"))try{n=new Date(parseInt(n)).toLocaleDateString()}catch(e){}return n}catch(e){this.log.log(i.SEVERE,this.vo.ColumnName+" - "+e.message)}return null},g.prototype.setValue=function(t,i){this.inserting||(this.oldValue=this.value),this.value=t,this.inserting=i,this.error=!1,this.updateContext();var n=this.oldValue;i&&(n=this.INSERTING),(n!==t||this.forcefirepropchange)&&this.propertyChangeListner&&this.propertyChangeListner.setValue(t,i),this.forcefirepropchange=this.inserting||this.vo.displayType==e.DisplayType.YesNo},g.prototype.setCardViewSeqNo=function(e){this.cardViewSeq=e},g.prototype.getCardViewSeqNo=function(){return this.cardViewSeq},g.prototype.setCardFieldStyle=function(e){this.cardFieldStyle=e},g.prototype.getCardFieldStyle=function(){return this.cardFieldStyle},g.prototype.setCardIconHide=function(e){this.cardHideIcon=e},g.prototype.isCardIconHide=function(){return this.cardHideIcon},g.prototype.setCardTextHide=function(e){this.cardTextHide=e},g.prototype.isCardTextHide=function(){return this.cardTextHide},g.prototype.updateContext=function(){var t=this.vo,i=e.DisplayType,n=e.context,a=this.value;if(t.displayType==i.Text||t.displayType==i.Memo||t.displayType==i.TextLong||t.displayType==i.Binary||t.displayType==i.RowID||this.getIsEncrypted());else if("undefined"==a||null==a)this.getIsParentTabField()?this.gridTab&&n.setTabRecordContext(t.windowNo,t.tabNo,t.ColumnName,null):n.setWindowContext(t.windowNo,t.ColumnName,null);else if(typeof a==typeof Boolean||t.displayType==i.YesNo){var s="true"==a.toString().toLowerCase()||"Y"==a.toString()?"Y":"N";this.getIsParentTabField()?this.gridTab&&n.setTabRecordContext(t.windowNo,t.tabNo,t.ColumnName,s):n.setWindowContext(t.windowNo,t.ColumnName,s)}else typeof a==typeof date||i.IsDate(t.displayType)?this.getIsParentTabField()?this.gridTab&&n.setTabRecordContext(t.windowNo,t.tabNo,t.ColumnName,a):n.setWindowContext(t.windowNo,t.ColumnName,a):this.getIsParentTabField()?this.gridTab&&n.setTabRecordContext(t.windowNo,t.tabNo,t.ColumnName,a.toString()):n.setWindowContext(t.windowNo,t.ColumnName,null==a?null:a.toString())},g.prototype.getIsParentTabField=function(e){if(!this.gridTab)return!1;e||(e=this.vo.ColumnName);var t=this.gridTab.getParentTab();return null!=t&&null!=t.getField(e)},g.prototype.setNullValue=function(){this.valueNoFire&&(this.oldValue=this.value),this.value=null,this.inserting=!1,this.error=!1,this.oldValue!==this.value&&this.propertyChangeListner&&this.propertyChangeListner.setValue(this.value)},g.prototype.setPropertyChangeListener=function(e){this.propertyChangeListner=e},g.prototype.setError=function(e){this.error=e},g.prototype.setInserting=function(e){this.inserting=e},g.prototype.getAD_Reference_Value_ID=function(){return this.vo.AD_Reference_Value_ID},g.prototype.setDisplayType=function(e){this.vo.displayType=e},g.prototype.setDisplayLength=function(e){this.vo.DisplayLength=e},g.prototype.setDisplayed=function(e){this.vo.IsDisplayedf=e},g.prototype.setValueNoFire=function(e){this.valueNoFire=e},g.prototype.getLoadRecursiveData=function(){return this.vo.LoadRecursiveData},g.prototype.getShowChildOfSelected=function(){return this.vo.ShowChildOfSelected},g.prototype.getIsBackgroundProcess=function(){return this.vo.IsBackgroundProcess},g.prototype.getAskUserBGProcess=function(){return this.vo.AskUserBGProcess},g.prototype.getIsHeaderPanelitem=function(){return this.vo.IsHeaderPanelitem},g.prototype.getHeaderOverrideReference=function(){return this.vo.HeaderOverrideReference},g.prototype.getHeaderStyle=function(){return this.vo.HeaderStyle},g.prototype.getHeaderHeadingOnly=function(){return this.vo.HeaderHeadingOnly},g.prototype.getHeaderSeqno=function(){return this.vo.HeaderSeqno},g.prototype.getHeaderIconOnly=function(){return this.vo.HeaderIconOnly},g.prototype.getHtmlStyle=function(){return this.vo.HtmlStyle},g.prototype.getGridImageStyle=function(){return this.vo.GridImageStyle},g.prototype.getShowIcon=function(){return this.vo.ShowIcon},g.prototype.getAD_Image_ID=function(){return this.vo.AD_Image_ID},g.prototype.getFontClass=function(){return this.vo.FontClass},g.prototype.getPlaceHolder=function(){return this.vo.PlaceHolder},g.prototype.getImageName=function(){return this.vo.ImageName},g.prototype.getCellSpace=function(){return this.vo.CellSpace},g.prototype.getFieldBreadth=function(){return this.vo.FieldBreadth},g.prototype.getIsLineBreak=function(){return this.vo.LineBreak},g.prototype.getIsFieldgroupDefault=function(){return this.vo.FieldGroupDefault},g.prototype.getShowFilterOption=function(){return this.vo.ShowFilterOption},g.prototype.getIsUnique=function(){return this.vo.IsUnique},g.prototype.getIsSwitch=function(){return this.vo.IsSwitch},g.prototype.getIsAction=function(){return this.vo.IsAction},g.prototype.getTabSeqNo=function(){return this.vo.TabSeqNo},g.prototype.getAction=function(){return this.vo.ADAction},g.prototype.getActionName=function(){return this.vo.ADActionName},g.prototype.getActionParams=function(){return this.vo.ADActionParams},g.prototype.refreshLookup=function(){return!this.lookup||0==this.lookup.getValidation().length||(this.lookup.refresh(),this.lookup.getIsValidated())},g.prototype.dispose=function(){null!=this.lookup&&(this.lookup.dispose(),this.lookup=null),this.gfield=null,this.vo=null,this.propertyChangeListner=null},h.prototype.getName=function(){return this.vo.Name},h.prototype.getAD_Tab_ID=function(){return this.vo.AD_Tab_ID},h.prototype.getIconPath=function(){return this.vo.IconPath},h.prototype.getIsDefault=function(){return this.vo.IsDefault},h.prototype.getClassName=function(){return this.vo.Classname},h.prototype.getAD_TabPanel_ID=function(){return this.vo.AD_TabPanel_ID},h.prototype.getSeqNo=function(){return this.vo.SeqNo},h.prototype.getExtraInfo=function(){return this.vo.ExtraInfo},v.prototype.getRecord_ID=function(){return this.Record_ID},v.prototype.setLoading=function(e){this.m_allLoaded=!1,this.m_loadedRows=e},v.prototype.getIsLoading=function(){return!this.m_allLoaded},v.prototype.getLoadedRows=function(){return this.m_loadedRows},v.prototype.setCurrentRow=function(e){this.m_currentRow=e},v.prototype.setCurrentPage=function(e){this.mCurrentPage=e},v.prototype.getCurrentRow=function(){return this.m_currentRow},v.prototype.getTotalRows=function(){return this.m_totalRows},v.prototype.getTotalRecords=function(){return this.totalRecords},v.prototype.getCurrentPage=function(){return this.mCurrentPage},v.prototype.getTotalPage=function(){return this.mTotalPage},v.prototype.getPageSize=function(){return this.mPageSize},v.prototype.setInfo=function(e,t,i,n){this.m_AD_Message=e,this.m_info=t,this.m_isError=i,this.m_isWarning=n},v.prototype.setPageInfo=function(e,t,i){this.mCurrentPage=e,this.mPageSize=i,t<1||t<i?(this.mcurrentPage=1,this.mTotalPage=1):this.mTotalPage=0==i?1:Math.ceil(t/i),this.totalRecords=t},v.prototype.setInserting=function(e){this.m_inserting=e},v.prototype.getIsInserting=function(){return this.m_inserting},v.prototype.getAD_Message=function(){return this.m_AD_Message},v.prototype.getInfo=function(){return this.m_info},v.prototype.getIsError=function(){return this.m_isError},v.prototype.getIsWarning=function(){return this.m_isWarning},v.prototype.getMessage=function(){var e=new StringBuilder;return this.m_inserting&&e.append("+"),e.append(this.m_changed?this.m_autoSave?"*":"?":" "),0==this.m_totalRows?e.append(this.m_currentRow):e.append(this.m_currentRow+1),e.append("/"),this.m_allLoaded?e.append(this.m_totalRows):e.append(this.m_loadedRows).append("->").append(this.m_totalRows),e.toString()},v.prototype.getIsChanged=function(){return this.m_changed},v.prototype.getIsFirstRow=function(){return 0==this.m_totalRows||0==this.m_currentRow},v.prototype.getIsLastRow=function(){return 0==this.m_totalRows||this.m_currentRow==this.m_totalRows-1},v.prototype.getIsFirstPage=function(){return this.mTotalPage<2||this.mCurrentPage<2},v.prototype.getIsLastPage=function(){return this.mTotalPage<2||this.mCurrentPage>=this.mTotalPage},v.prototype.setChangedColumn=function(e,t){this.m_changedColumn=e,this.m_columnName=t},v.prototype.getChangedColumn=function(){return this.m_changedColumn},v.prototype.getColumnName=function(){return this.m_columnName},v.prototype.setConfirmed=function(e){this.m_confirmed=e},v.prototype.getIsConfirmed=function(){return this.m_confirmed},e.GridWindow=c,e.GridTab=p,e.GridTable=u,e.GridField=g}(VIS,jQuery)},6581:()=>{VIS.Controls={},function(e,t){var i,n=t.Application.contextUrl,a=n+"JsonData/JDataSetWithCode",s=function(e,i,n){var a=!!n,s={sql:e,page:1,pageSize:0};i&&(s.param=i);var l=null;return o(s,a,(function(e){l=(new t.DB.DataReader).toJson(e),n&&n(l)})),l},l=function(e,i,n){var a=!!n,s={sql:e,page:1,pageSize:0};i&&(s.param=i);var l=null;return o(s,a,(function(e){i=(new t.DB.DataSet).toJson(e);var i=(new t.DB.DataSet).toJson(e);l=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null,i.dispose(),i=null,a&&n(l)})),l};function o(t,i,n){var s=null;return e.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(t)}).done((function(e){s=e,n&&n(e)})),s}function r(e,i,n,a,s){if(!(this instanceof r))return new t.controls.IControl(e,i,n,a,s);this.ctrl=e,this.displayType=i,this.isReadOnly=n,this.colName=a,this.isMandatory=s,this.oldValue="oldValue",this.visible,this.tag,this.setVisible(!0),this.editingGrid=null}function d(i,n,a,s,l,o,d,c,p){var u=t.DisplayType.String;this.obscureType=c;var g=e("<input>",{type:p?"password":"text",name:i,maxlength:o}),h=e('<button class="input-group-text" style="display:none"><i class="fa fa-credit-card" /></button>');r.call(this,g,u,a,i,n),a||!s||c?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtn=function(e){if(0==e&&c)return this.setReadOnly(!0),h},this.showObscureButton=function(e){e&&c?h.css("display",""):(h.css("display","none"),h.off("click"))},this.getBtnCount=function(){return c?1:0};var v=this;g.on("change",(function(e){e.stopPropagation();var t=g.val();if(this.value=t,t!==v.oldValue){var i={newValue:t,propertyName:v.getName()};v.fireValueChanged(i),i=null}c&&v.setReadOnly(!0)})),g.on("blur",(function(e){var i=g.val();v.obscureType&&""!=i&&v.oldValue==i&&(v.ctrl.val(t.Env.getObscureValue(v.obscureType,i)),v.setReadOnly(!0))})),h.on("click",(function(){v.mField.getIsEditable(!0)&&(v.setReadOnly(!1,!0,!0),g.val(v.mField.getValue()),g.focus())})),this.disposeComponent=function(){g.off("change"),g=null,v=null}}function c(i,n,a,s){i=null!=i?i.replace("[&]",""):"";var l=' for="'+n+'"';s&&(l="");var o=e("<label "+l+"></label>");r.call(this,o,t.DisplayType.Label,!0,s?n:"lbl"+n),a?o.append("<span>"+i+"</span>").append("<sup>*</sup>"):o.text(i),this.disposeComponent=function(){o=null,self=null}}function p(i,n,a,s){i=null!=i?i.replace("[&]",""):"";var l=' for="'+n+'"';s&&(l="");var o=e("<span "+l+"></span>");r.call(this,o,t.DisplayType.Label,!0,s?n:"lbl"+n),a?o.text(i).append("<sup>*</sup>"):o.text(i),this.disposeComponent=function(){o=null,self=null,this.format&&this.format.dispose(),this.format=null}}function u(i,n,a,s,o,d,c,p,u,g,h,v,f){this.actionListner,this.AD_Process_ID=p,this.AD_Form_ID=h,this.description=d,this.help=c,this.text=o,this.isLink=u,this.isRightLink=g,this.actionLink=null,this.isCsv=!1,this.isPdf=!1,this.askUserBGProcess=f,this.isBackgroundProcess=v,this.values=null,this.isIconSet=!0;var m=e("<i style='color:inherit' title='"+o+"'>"),y=e("<span style='color:inherit'>").text(o),I=(t.Application.contextUrl,null);u?g?(I=e("<li>")).append(y).append(m):(I=e('<button type="button" class="vis-ev-col-wrap-button vis-ev-col-linkbutton"></button>')).append(m).append(y):(I=e('<button class="vis-ev-col-wrap-button">',{type:"button",name:i}),m.css("margin-right","8px"),I.append(m).append(y)),this.setIcon=function(e,t){t?m.src=e:m.addClass(e)},i.equals("PaymentRule")?(this.readReference(195),this.setIcon("vis vis-payment")):i.equals("DocAction")?(this.readReference(135),this.setIcon("vis vis-cog")):i.equals("CreateFrom")?this.setIcon("vis vis-copy"):i.equals("Record_ID")?(this.setIcon("vis vis-find"),I.text(t.Msg.getMsg("ZoomDocument"))):i.equals("Posted")?(this.readReference(234),this.setIcon("fa fa-line-chart")):u&&(this.isIconSet=!1,this.setIcon("vis vis-action")),r.call(this,I,t.DisplayType.Button,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1);var D,w=this,b=null;(D=e("<ul class='vis-apanel-rb-ul'>")).append(e("<li data-action='C'>").text(t.Msg.getMsg("OpenCSV"))),D.append(e("<li data-action='P'>").text(t.Msg.getMsg("OpenPDF"))),b=D,I.on(t.Events.onClick,(function(e){e.stopPropagation();var i=null;if(!w.isReadOnly){var n="VIS_81",a=[];a[0]=new t.DB.SqlParam("@AD_Process_ID",p),i=l(n,a),n="VIS_149",(a=[])[0]=new t.DB.SqlParam("@AD_Process_ID",p),"Y"==l(n,a)&&t.context.getIsUseCrystalReportViewer()?w.invokeActionPerformed({source:w}):"Y"==i?m.w2overlay(b.clone(!0)):w.invokeActionPerformed({source:w})}})),b&&b.on("click","LI",(function(t){var i=e(t.target);"P"==i.data("action")?(w.isPdf=!0,w.isCsv=!1):"C"==i.data("action")&&(w.isCsv=!0,w.isPdf=!1),w.invokeActionPerformed({source:w})})),this.setText=function(e){if(null!=e){var t=e.indexOf("&");if(-1!=t)" "!=e.toUpperCase().charAt(t+1)&&(e=e.substring(0,t)+e.substring(t+1));y.text(e)}else y.text("")},this.setLayout=function(e){this.mField&&(e?this.mField.getHeaderHeadingOnly()?m.remove():this.mField.getHeaderIconOnly()&&y.remove():this.mField.getIsFieldOnly()&&this.mField.getShowIcon()?y.remove():this.mField.getIsFieldOnly()&&m.remove())},this.disposeComponent=function(){I.off(t.Events.onClick),I=null,w=null,this.AD_Process_ID=null,this.description=null,this.help=null,this.setText=null}}function g(i,n,a,s,l,o,d){var c=e("<input>",{type:"checkbox",name:i,value:l}),p=e('<label class="vis-ec-col-lblchkbox" />').html(l);d&&(c.addClass("vis-ctrl-switch"),p.prepend('<i for="switch" class="vis-ctrl-switchSlider">Toggle</i>')),p.prepend(c),r.call(this,p,t.DisplayType.YesNo,a,i,n),this.cBox=c;var u=this;this.setReadOnly=function(e){this.isReadOnly=e,c.prop("disabled",e),p.css("opacity",e?.7:1)},a||!s?this.setReadOnly(!0):this.setReadOnly(!1),c.on("change",(function(e){e.stopPropagation();var t=c.prop("checked");if(t!==u.oldValue){u.oldValue=t;var i={newValue:t,propertyName:u.getName()};u.fireValueChanged(i),i=null}})),this.disposeComponent=function(){c.off("change"),c=null,u=null,this.cBox=null}}function h(i,n,a,l,o,d,c,p){c||(c=t.DisplayType.Table);var u=e("<select>",{name:i});r.call(this,u,c,a,i,n),this.lookup=o,this.lastDisplay="",this.settingFocus=!1,this.inserting=!1,this.settingValue=!1,this.loading=!1,null!=o&&o.getIsValidated()&&(this.loading=!0),u[0].selectedIndex=-1,a||!l?this.setReadOnly(!0):this.setReadOnly(!1);var g=null,h=0,v=null,f={},m=!1;null!=o&&((o.getDisplayType()==t.DisplayType.List&&0==t.context.getAD_Role_ID()||o.getDisplayType()!=t.DisplayType.List)&&(!0,o instanceof t.MLookup&&0==o.getZoomWindow()&&p<1&&(m=!0),f[t.Actions.zoom]=m),f[t.Actions.addnewrec]=!0,(this.lookup&&("ad_user.ad_user_id"==this.lookup.info.keyColumn.toLowerCase()||"ad_user_id"==this.lookup.info.keyColumn.toLowerCase())||"AD_User_ID"===i||"SalesRep_ID"===i)&&(f[t.Actions.contact]=!0),g=e('<button  class="input-group-text"><i tabindex="-1" class="fa fa-ellipsis-v" /></button>'),f[t.Actions.refresh]=!0,t.MRole.getIsShowPreference()&&(f[t.Actions.preference]=!0),v=t.AEnv.getContextPopup(f),h+=1,f=null),this.getBtnCount=function(){return h},this.getBtn=function(e){return g},this.setVisible=function(e){this.visible=e,e?(g&&g.show(),u.show()):(u.hide(),g&&g.hide())};var y=this;function I(e){if(y.lookup&&!m){var i=y.lookup.getZoomQuery();if(e||(e=y.getValue()),""==e&&(e=null),null==e||isNaN(e)||(e=parseInt(e)),null==i||null!=e){i=new t.Query;var n=null;if(null!=y.lookup&&y.lookup instanceof t.MLookup){var a=y.lookup.getAD_Reference_Value_ID();if(0!=a){var l="VIS_83",o=[];o[0]=new t.DB.SqlParam("@AD_Reference_ID",a);try{var r=s(l,o);r.read()&&(n=r.getString(0)),r.dispose()}catch(e){this.log.log(t.Logging.Level.SEVERE,l,e)}}}null!=n&&0!=n.length?i.addRestriction(n,t.Query.prototype.EQUAL,e):i.addRestriction(y.getColumnName(),t.Query.prototype.EQUAL,e),i.setRecordCount(1)}var d=0;d=null!=y.mField&&y.mField.getZoomWindow_ID()>0?y.mField.getZoomWindow_ID():y.lookup.getZoomWindow(i),null!=e&&-1!=e||(i=null),t.viewManager.startWindow(d,i)}}u.on("focus",(function(e){if(null!=y.lookup){var t=u.val();if(!y.lookup.getIsValidated()||y.lookup.getHasInactive()){if(!y.getIsReadonly()){y.settingFocus=!0;t=u.val();y.lookup.fillCombobox(y.getIsMandatory(),!0,!0,!0),y.refreshOptions(y.lookup.data,t),t&&u[0].selectedIndex<0&&(y.oldValue="old",u.trigger("change")),y.settingFocus=!1}}else if(y.loading){if(y.lookup.fillCombobox(n,!1,!1,!1),y.lookup.loading)return;y.refreshOptions(y.lookup.data,t),null!=t&&u[0].selectedIndex<0&&(y.oldValue="old",u.trigger("change")),y.loading=!1}}})),u.on("change",(function(e){var t=u.val();if(t!==y.oldValue){-1!=t&&""!=t||(t=null);var i={newValue:t,propertyName:y.getName()};y.fireValueChanged(i),i=null}e.stopPropagation()})),g&&g.on(t.Events.onClick,(function(e){g.w2overlay(v.clone(!0)),e.stopPropagation()})),v&&v.on("click","LI",(function(i){var n=e(i.target).data("action");if(n==t.Actions.preference){var a=new t.ValuePreference(y.mField,y.getValue(),y.getDisplay());null!=a&&a.showDialog(),a=null}else if(n==t.Actions.refresh){if(null==o)return;y.settingFocus=!0;var s=u.val();y.lookup.refresh(),y.lookup.getIsValidated()?y.lookup.fillCombobox(y.getIsMandatory(),!1,!1,!1):y.lookup.fillCombobox(y.getIsMandatory(),!0,!1,!1),y.refreshOptions(y.lookup.data,s),y.settingFocus=!1}else if(n==t.Actions.contact){var l=y.getValue();if(l&&l.toString().length>0)new t.ContactInfo(l,y.mField.getWindowNo()).show()}else n==t.Actions.zoom?m||I():n==t.Actions.addnewrec&&(m||I(-10))})),this.disposeComponent=function(){u.off("focus"),u.off("change"),g&&(g.off(t.Events.onClick),g.remove()),g=null,v&&v.remove(),v=null,this.lookup=null,this.lastDisplay=null,this.settingFocus=null,this.inserting=null,this.settingValue=null,u=null,y=null}}function v(i,n,a,s,l,o){var d="date",c="9999-12-31";l==t.DisplayType.Time&&(d="time",c=""),l==t.DisplayType.DateTime&&(d="datetime-local",c+="T24:00:00");var p=e("<input>",{type:d,name:i});""!=c&&p.attr("max",c),r.call(this,p,l,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1);var u=this;p.on("focusout",(function(e){if(!this.editingGrid){var t=u.getValue();u.oldValue=t;var i={newValue:t,propertyName:u.getName()};u.fireValueChanged(i),i=null}})),this.disposeComponent=function(){p.off("change"),u=null,p=null}}function f(i,n,a,o,d,c,p){d||(d=t.DisplayType.Search),this.lookup=c,this.isMultiKeyTextBox=d===t.DisplayType.MultiKey,this.value=null,this.custInfoWin=null;this.infoMultipleIds=null;this.log=t.Logging.VLogger.getVLogger("VTextBoxButton");var u="";d==t.DisplayType.Location||d==t.DisplayType.MultiKey?this.isMultiKeyTextBox?u+="fa fa-caret-down":u+="vis vis-card":d==t.DisplayType.Locator?u+="vis vis-locator":d==t.DisplayType.Search&&(i.equals("C_BPartner_ID")||i.equals("C_BPartner_To_ID")&&c.getColumnName().equals("C_BPartner.C_BPartner_ID")?u+="fa fa-handshake-o":i.equals("M_Product_ID")||i.equals("M_Product_To_ID")&&c.getColumnName().equals("M_Product.M_Product_ID")?u+="vis vis-product":u+="fa fa-caret-down");var g=0,h=e("<input>",{type:"text",name:i});h.attr("autocomplete","off");var v=e('<button   class="input-group-text"><i  tabindex="-1" class="'+u+'"></i></button>');g+=1;var f=null,m=null,y={},I=!1,D=null,w=null;if(null!=c&&!this.isMultiKeyTextBox){c instanceof t.MLookup&&0==c.getZoomWindow()&&p<1&&(I=!0),y[t.Actions.zoom]=I,y[t.Actions.addnewrec]=!0,f=e('<button   class="input-group-text"><i tabindex="-1" Class="fa fa-ellipsis-v" /></button>');"C_BPartner_ID"===i&&(y[t.Actions.addnewrec]=!1,y[t.Actions.add]=!0,y[t.Actions.update]=!0),"M_Product_ID"===i&&(y[t.Actions.addnewrec]=!1,y[t.Actions.add]=!1,y[t.Actions.update]=!0,y[t.Actions.addproduct]=!0),(this.lookup&&("ad_user.ad_user_id"==this.lookup.info.keyColumn.toLowerCase()||"ad_user_id"==this.lookup.info.keyColumn.toLowerCase())||"AD_User_ID"===i||"SalesRep_ID"===i)&&(y[t.Actions.contact]=!0),t.MRole.getIsShowPreference()&&(y[t.Actions.preference]=!0),y[t.Actions.refresh]=!0,y[t.Actions.remove]=!0,m=t.AEnv.getContextPopup(y),g+=1,y=null}this.isMultiKeyTextBox&&(f=e('<button   class="input-group-text"><i class="fa fa-arrow-left" aria-hidden="true"></i></button>'),g+=1);var b=this;function C(i){if(b.lookup&&!I){var n=b.lookup.getZoomQuery();if(i||(i=b.getValue()),""==i&&(i=null),null==n||e.isEmptyObject(n)||null!=i){n=new t.Query;var a=null;if(null!=b.lookup&&b.lookup instanceof t.MLookup){var l=b.lookup.getAD_Reference_Value_ID();if(0!=l){var o="VIS_90",r=[];r[0]=new t.DB.SqlParam("@AD_Reference_ID",l);try{var d=s(o,r);d.read()&&(a=d.getString(0)),d.dispose()}catch(e){this.log.log(t.Logging.Level.SEVERE,o,e)}}}null!=a&&0!=a.length?n.addRestriction(a,t.Query.prototype.EQUAL,i):n.addRestriction(b.getColumnName(),t.Query.prototype.EQUAL,i),n.setRecordCount(1)}var c=0;c=null!=b.mField&&b.mField.getZoomWindow_ID()>0?b.mField.getZoomWindow_ID():p&&p>0?p:b.lookup.getZoomWindow(n),t.viewManager.startWindow(c,n)}}r.call(this,h,d,a,i,n),this.setReadOnly=function(e){this.isReadOnly=e,h.prop("disabled",!!e),e?v.css("opacity",.7):v.css("opacity",1),this.isMultiKeyTextBox&&(e?f.css("opacity",.7):f.css("opacity",1))},d==t.DisplayType.Search&&(D=e("<div class='vis-autocompleteList-item vis-auto-addItem' style='background-color: rgba(var(--v-c-secondary), 1)'>"+t.Msg.getMsg("AddNew")+"</div>"),w=e("<div><center>"+t.Msg.getMsg("NoDataFoundSugg")+"</center></div>").append(e("<center></center>").append(D)),h.vaautocomplete({source:function(n,a){var s;s=t.Env.parseContext2(t.context,b.lookup.windowNo,b.lookup.tabNo,b.lookup.info.validationCode,!1,!0);var l={ctx:t.context.getWindowCtx(b.lookup.windowNo),windowNo:b.lookup.windowNo,column_ID:b.lookup.info.column_ID,AD_Reference_ID:d,columnName:i,AD_Reference_Value_ID:b.lookup.info.AD_Reference_Value_ID,isParent:b.lookup.info.isParent,validationCode:t.secureEngine.encrypt(b.lookup.info.validationCode)};e.ajax({type:"Post",url:t.Application.contextUrl+"Form/GetAccessSqlAutoComplete",data:{columnName:i,text:n,WindowNo:b.lookup.getWindowNo(),AD_Window_ID:b.lookup.AD_Window_ID,AD_Tab_ID:b.lookup.AD_Tab_ID,AD_Field_ID:b.lookup.AD_Field_ID,Validation:JSON.stringify(s),LookupData:JSON.stringify(l)},success:function(e){var s=[];if(null!=JSON.parse(e)){result=JSON.parse(e).Table;for(var l=0;l<result.length;l++){var o={};o[Object.keys(result[l])[0].toLowerCase()]=result[l][Object.keys(result[l])[0]],o[Object.keys(result[l])[1].toLowerCase()]=result[l][Object.keys(result[l])[1]],o[Object.keys(result[l])[2].toLowerCase()]=result[l][Object.keys(result[l])[2]],"M_PRODUCT_ID"==i.toUpperCase()&&-1==o.finalvalue.indexOf(n)&&(o.finalvalue=o.finalvalue+"_"+n),s.push({id:o.id,value:t.Utility.Util.getIdentifierDisplayVal(o.finalvalue)})}a(s)}0==s.length&&((s=[]).push({id:"vis-AddNew",value:t.Msg.getMsg("AddNew"),msg:t.Msg.getMsg("NoDataFound")}),a(s))}})},minLength:2,html:w,onSelect:function(e,n){"vis-AddNew"==n.id?(C(),setTimeout((function(){b.setValue(-1,!0,!0)}),500)):(b.setValue(n.id,!0,!0),"M_PRODUCT_ID"==i.toUpperCase()&&t.context.setContext(b.lookup.windowNo,"AttrCode",n.id),b.editingGrid&&setTimeout((function(){b.editingGrid.editField(b.gridPos.recid,b.gridPos.col,n.id)}),500))}}),D.on("click",(function(e){C()}))),h.on("keydown",(function(e){13!=e.keyCode&&(9!=e.keyCode||""==h.val().trim())||e.shiftKey||0!=h.val().length?46!=e.keyCode&&8!=e.keyCode||null==b.getValue()||b.setValue(null,!0,!0):b.actionText()&&(e.stopPropagation(),e.preventDefault())})),this.actionText=function(){var e=h.val().trim();if(t.context.setContext(b.lookup.windowNo,"AttrCode",e),null!=e&&e.indexOf("(01)")>=0){var i=e;i.indexOf("(10)")>=0&&(i=i.substring(0,i.indexOf("(10)"))),i.indexOf("(17)")>=0&&(i=i.substring(0,i.indexOf("(17)"))),e=i=i.replace("(01)","")}return!(null!=e&&0!=e.length&&!e.equals("%"))&&(b.openSearchForm(),!0)},this.getDirectAccessSQL=function(e){var n=b.getDirectAccessSQL1(t.context,i,c,e);return n[1],n[2],n[0]},this.getDirectAccessSQL1=function(e,t,i,n){return[]},this.getWhereClause=function(e,i,n){var a="";try{if(null==n)return"";null!=n.getZoomQuery()&&(a=n.getZoomQuery().getWhereClause());var s=n.getValidation();if(null==s&&(s=""),0==a.length?a=s:s.length>0&&(a+=" AND "+s),-1!=a.indexOf("@")){var l=t.Env.parseContext(e,n.getWindowNo(),n.getTabNo(),a,!1,!0);if(0!=l.length)return l}}catch(e){}return a},a||!o?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtnCount=function(){return g},this.getBtn=function(e){return 0==e?v:1==e&&f?f:void 0},this.setVisible=function(e){this.visible=e,e?(h.css("visibility","visible"),f&&f.show(),v.show()):(h.css("visibility","hidden"),f&&f.hide(),v.hide())},this.openSearchForm=function(){if(!b.isReadOnly){var n=h.val().trim();"object"==typeof n&&(n="");var a="";if(b.isMultiKeyTextBox&&(a=b.getValue()),!b.isReadOnly&&null!=b.lookup){var o=0,r=b.getWhereClause(t.Env.getCtx(),i,b.lookup);null!=b.custInfoWin?e.ajax({url:t.Application.contextUrl+"InfoWindow/GetInfoWindowID",dataType:"json",async:!1,data:{InfoSearchKey:b.custInfoWin},success:function(e){o=e.result}}):null!=b.getField()&0==o&&(o=b.getField().getAD_InfoWindow_ID());var d=null;if(0!=o)d=new t.InfoWindow(o,n,b.lookup.windowNo,r,b.isMultiKeyTextBox,a);else{var c,p=p,u=i,g=null,v=null,f=0,m=0,y=b.lookup.getAD_Reference_Value_ID();if(y>0){g="VIS_87";try{for((D=[])[0]=new t.DB.SqlParam("@AD_Reference_ID",y),v=s(g,D);v.read();)u=v.getString(0),v.getString(1),p=v.getString(2);v.close(),v=null}catch(e){null!=v&&(v.close(),v=null)}}else p=String(i).substr(0,i.length-3),u=i;if(g="VIS_88",(D=[])[0]=new t.DB.SqlParam("@AD_Tab_ID",t.context.getContextAsInt(b.lookup.windowNo,"0|AD_Tab_ID",!0)),c=l(g,D),u.equals("M_Product_ID")&&c){f=window.DTD001&&170==c?t.context.getContextAsInt(b.lookup.windowNo,"DTD001_MWarehouseSource_ID"):t.context.getContextAsInt(b.lookup.windowNo,"M_Warehouse_ID"),m=t.context.getContextAsInt(b.lookup.windowNo,"M_PriceList_ID");var I=!1;b.lookup.windowNo>0&&(I="C_OrderLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"C_InvoiceLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_InOutLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_PackageLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_MovementLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_InventoryLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_ProductPrice_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"C_ProjectLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_RequisitionLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")||"M_PriceList_ID"==t.context.getWindowTabContext(b.lookup.windowNo,0,"KeyColumnName")||"SAP001_StockTransferLine_ID"==t.context.getWindowTabContext(b.lookup.windowNo,1,"KeyColumnName")),d=new t.infoProduct(!0,b.lookup.windowNo,f,m,n,p,u,I,r,a)}else{var D;for(g="VIS_89",(D=[])[0]=new t.DB.SqlParam("@tableName",p),v=s(g,D);v.read();){o=v.getString(0);break}v.close(),v=null,d=o>0?new t.InfoWindow(o,n,b.lookup.windowNo,r,b.isMultiKeyTextBox,a):new t.infoGeneral(!0,b.lookup.windowNo,n,p,u,b.isMultiKeyTextBox,r,a)}}d.onClose=function(){var e=d.getSelectedValues();if(e&&0==e.length){if(h.closest("td").hasClass("vis-gc-vpanel-table-td3"))window.setTimeout((function(){h.closest("tr").nextAll().children("input,select,textarea,button").focus()}),200);else if(h.closest("td").hasClass("vis-gc-vpanel-table-td1")){var t=h.closest("td").siblings(".vis-gc-vpanel-table-td3");t&&t.length>0&&((t=t.find("input,select,textarea,button"))&&t.length>0?window.setTimeout((function(){t.focus()}),200):window.setTimeout((function(){h.closest("tr").nextAll().children("input,select,textarea,button").focus()}),200))}else window.setTimeout((function(){h.closest("td").siblings(".vis-gc-vpanel-table-td3").find("input,select,textarea,button").focus()}),200);return h.closest("td").nextAll().children("input,select,textarea,button").focus(),void(d.getRefreshStatus&&d.getRefreshStatus()&&b.fireRefreshUI())}if(b.isMultiKeyTextBox){var i,n="",a=0;for(a=0,i=e.length;a<i;a++)0!=n.length?n+=","+e[a]:n+=e[a];b.isMultiKeyTextBox?b.setValue(n,!0,!0):b.setValue(n,!1,!0)}else{var s=null;d.getRefreshStatus&&d.getRefreshStatus()?b.fireRefreshUI():(null!=e&&1==e.length?s=e[0]:(InfoMultipleIds=null,e.length>1&&(s=e[0])),null!=s&&(b.isMultiKeyTextBox?b.setValue(s,!0,!0):(b.setValue(s,!1,!0),b.editingGrid&&setTimeout((function(){b.editingGrid.editField(b.gridPos.recid,b.gridPos.col,s)}),500))))}d=null},d.show()}}},v.on(t.Events.onClick,b.openSearchForm),f&&f.on(t.Events.onClick,(function(e){if(b.isMultiKeyTextBox){if(b.isReadOnly)return;var t=b.getValue();t&&t.toString().length>0&&b.setValue(null,!1,!0)}else f.w2overlay(m.clone(!0));e.stopPropagation()})),m&&m.on("click","LI",(function(i){var n=e(i.target).data("action");if(n==t.Actions.zoom){if(I)return;C()}else if(n==t.Actions.addnewrec){if(I)return;C(-10)}else if(n==t.Actions.preference){var a=new t.ValuePreference(b.mField,b.getValue(),b.getDisplay());null!=a&&a.showDialog(),a=null}else if(n==t.Actions.refresh){if(!b.lookup||b.isReadOnly)return;b.lookup.refresh()}else if(n==t.Actions.add){var s=b.getValue();t.AddUpdateBPartner(b.mField.getWindowNo(),0,t.Msg.getMsg("Customer"),null,0,0)}else if(n==t.Actions.addproduct){s=b.getValue();t.AddUpdateMProduct(b.mField.getWindowNo(),0,t.Msg.getMsg("Product"),null,0,0)}else if(n==t.Actions.update){(s=b.getValue())&&s.toString().length>0&&t.AddUpdateBPartner(b.mField.getWindowNo(),s,t.Msg.getMsg("Customer"),null,0,0)}else if(n==t.Actions.contact){if((s=b.getValue())&&s.toString().length>0)new t.ContactInfo(s,b.mField.getWindowNo()).show()}else if(n==t.Actions.remove){if(b.isReadOnly)return;b.setValue(null,!1,!0)}})),this.disposeComponent=function(){v.off(t.Events.onClick),f&&f.off(t.Events.onClick),m&&m.off(t.Events.onTouchStartOrClick),m=null,b=null,h=null,v=null,f=null,this.getBtn=null,this.setVisible=null,D&&D.off("click"),D=null,w=null}}function m(i,n,a,s,l,o,d){var c=6,p=79;if(d!=t.DisplayType.Memo)d==t.DisplayType.TextLong?(c=6,o=1e5):(c=o<300?2:o<2e3?4:6,p=o<300?79:129);else try{c=o<300?2:o<2e3?4:o/500,p=o<300?79:129}catch(e){c=o<300?2:o<2e3?4:6,p=o<300?79:129}var u=e("<textarea>",{name:i,maxlength:o,rows:c,style:"min-height:"+p+"px"});r.call(this,u,d,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1);var g=this;u.on("change",(function(e){e.stopPropagation();var t=u.val();if(t!==g.oldValue){var i={newValue:t,propertyName:g.getName()};g.fireValueChanged(i),i=null}})),this.disposeComponent=function(){u.off("change"),u=null,g=null}}function y(i,n,a,s,l,o,d,c){var p=d,u=o,g=e("<input>",{type:"number",step:"any",name:i,maxlength:16,"data-type":"int"});g.attr("autocomplete","off"),r.call(this,g,p,a,i,n),this.format=t.DisplayType.GetNumberFormat(p),a||!s?this.setReadOnly(!0):this.setReadOnly(!1);var h=this;this.dotFormatter=t.Env.isDecimalPoint(),g.on("keydown",(function(e){if(189==e.keyCode||109==e.keyCode||173==e.keyCode){if(189==e.keyCode&&0==this.value.length)return!0;var t=h.format.GetConvertedNumber(this.value,h.dotFormatter);return this.value=-1*Number(t),setTimeout((function(){g.trigger("change")}),100),!1}if(e.keyCode>=37&&e.keyCode<=40||8==e.keyCode||9==e.keyCode||16==e.keyCode||17==e.keyCode||35==e.keyCode||36==e.keyCode||46==e.keyCode)return!0;if(e.keyCode>=48&&e.keyCode<=57&&0==e.shiftKey||e.keyCode>=96&&e.keyCode<=105&&0==e.shiftKey)return!(this.value.length>=u);if(189==e.keyCode||109==e.keyCode||173==e.keyCode)return this.value=-1*this.value,!1;if(h.dotFormatter){if(188==e.keyCode)return!1}else if(190==e.keyCode||110==e.keyCode)return!1;if(190==e.keyCode||110==e.keyCode||188==e.keyCode)return this.value.indexOf(".")>-1?this.value=this.value.replace(".",""):this.value.indexOf(",")>-1&&(this.value=this.value.replace(",","")),!(this.value.length>=u);if(e.ctrlKey&&65==e.keyCode){if(this.value.length>0)return e.stopPropagation(),g.select(),!0}else if(e.ctrlKey&&67==e.keyCode){if(this.value.length>0)return e.stopPropagation(),!0}else{if(e.ctrlKey&&86==e.keyCode)return setTimeout((function(){e.stopPropagation();var t=e.target.value;e.target.value=t?h.format.GetConvertedString(t,h.dotFormatter):""}),10),!0;if(e.ctrlKey&&88==e.keyCode)return e.stopPropagation(),!0}return!1})),g.on("focus",(function(e){e.stopPropagation();var i=e.target.value;g.attr("type","text"),e.target.value=i?h.format.GetConvertedString(i,h.dotFormatter):"",t.DisplayType.Amount==p&&g.select()})),g.on("change",(function(e){e.stopPropagation();var t=h.getValue();if(this.value=t,t!==h.oldValue){var i={newValue:t,propertyName:h.getName()};h.fireValueChanged(i),i=null}})),g.on("blur",(function(e){e.stopPropagation(),g.attr("type","text");var t=g.val();h.dotFormatter||(t=t.replace(".",","));var i=h.format.GetConvertedString(t,h.dotFormatter),n=h.format.GetFormatAmount(i,"formatOnly",h.dotFormatter);g.val(n)})),this.disposeComponent=function(){g.off("keydown"),g.off("change"),g=null,h=null,this.format.dispose(),this.format=null,u=null}}function I(i,n,a,s,l,o,d){var c=t.DisplayType.Integer,p=o,u=e("<input>",{type:"text",name:i,maxlength:p,"data-type":"int"});r.call(this,u,c,a,i,n),this.format=t.DisplayType.GetNumberFormat(c),a||!s?this.setReadOnly(!0):this.setReadOnly(!1);var g=this;u.on("keydown",(function(e){if(189==e.keyCode||109==e.keyCode||173==e.keyCode)return 189==e.keyCode&&0==this.value.length||(this.value=Number(-1*this.value),setTimeout((function(){u.trigger("change")}),100),!1);if(e.keyCode>=37&&e.keyCode<=40||8==e.keyCode||9==e.keyCode||16==e.keyCode||17==e.keyCode||35==e.keyCode||36==e.keyCode||46==e.keyCode)return!0;if(this.value<0){if(this.value.length>t.DisplayType.INTEGER_DIGITS&&8!=e.keyCode&&9!=e.keyCode&&46!=e.keyCode)return!1}else if(this.value.length>=t.DisplayType.INTEGER_DIGITS&&8!=e.keyCode&&9!=e.keyCode&&46!=e.keyCode)return!1;return(e.keyCode>=48&&e.keyCode<=57&&0==e.shiftKey||e.keyCode>=96&&e.keyCode<=105&&0==e.shiftKey)&&!(this.value.length>=p)})),u.on("change",(function(e){e.stopPropagation();var t=g.getValue();t=Globalize.parseInt(t.toString());var i=Number(g.format.GetFormatedValue(t));if(t!=i&&(g.mField.setValue(null),t=i),t!==g.oldValue){var n={newValue:t,propertyName:g.getName()};g.fireValueChanged(n),n=null}})),this.disposeComponent=function(){u.off("keydown"),u.off("change"),u=null,g=null,this.format.dispose(),this.format=null,p=null}}function D(i,n,a,s,l,o,d){l||(l=t.DisplayType.Location),this.lookup=o,this.lastDisplay="",this.settingFocus=!1,this.inserting=!1,this.settingValue=!1,this.value=null;var c=e("<input readonly>",{type:"text",name:i}),p=e('<button class="input-group-text"><i class="vis vis-location" aria-hidden="true"></i></button>'),u=e('<button class="input-group-text"><i class="vis vis-pencil" aria-hidden="true"></i></button>'),g=d?1:2,h=this;r.call(this,c,l,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtn=function(e){return 2!=g?u:0==e?p:1==e?u:void 0},this.getBtnCount=function(){return g},this.setVisible=function(e){this.visible=e,e?(c.show(),p.show(),u.show()):(c.hide(),p.hide(),u.hide())},this.setReadOnly=function(e){this.isReadOnly=e,c.prop("disabled",!!e),e?u.css("opacity",.7):u.css("opacity",1),this.setBackground(!1)},p.on(t.Events.onClick,(function(e){h.getField().gridTab&&h.getField().gridTab.mDataListenerList&&h.getField().gridTab.mDataListenerList[0].switchMapRow(h.value),e.stopPropagation()})),u.on(t.Events.onClick,(function(e){if(e.stopPropagation(),!h.isReadOnly){var i=null;h.mField&&h.mField.vo&&(i=h.mField.vo.IsMaintainVersions);var n=new t.LocationForm(h.value,i);n.load(),n.showDialog(),n.onClose=function(e,t){if(t){h.oldValue=0,h.lookup.refreshLocation(e),h.setValue(e);var i={newValue:e,propertyName:h.getColumnName()};h.fireValueChanged(i),i=null}},n=null}})),this.disposeComponent=function(){p.off(t.Events.onClick),u.off(t.Events.onClick),h=null,c=null,p=null,u=null,this.setVisible=null}}function w(i,n,a,l,o,d){this.mandatory=n,this.onlyWarehouseId=0,this.onlyProductId=0,this.onlyOutgoing=null,this.windowNum=d.getWindowNo(),this.columnName=i,this.lookup=d;this.value=null,o||(o=t.DisplayType.Locator);var c=e("<input readonly>",{type:"text",name:i}),p=e('<button class="input-group-text"><i class="vis vis-locator" aria-hidden="true"></i></button>'),u=e('<button class="input-group-text"><i class="vis vis-find" aria-hidden="true"></i></button>'),g=this;r.call(this,c,o,a,i,n),this.getBtnCount=function(){return 2},this.getBtn=function(e){return 0==e?p:1==e?u:void 0},this.setVisible=function(e){this.visible=e,e?(c.show(),p.show(),u.show()):(p.hide(),u.hide(),c.hide())},this.setReadOnly=function(e){this.isReadOnly=e,c.prop("disabled",!!e),e?p.css("opacity",.7):p.css("opacity",1),this.setBackground(!1)},p.on(t.Events.onClick,(function(e){if(e.stopPropagation(),!g.isReadOnly){var t=g.getOnlyWarehouseID(),i=g.getOnlyProductID();g.showLocatorForm(t,i)}})),u.on(t.Events.onClick,(function(e){if(e.stopPropagation(),g.lookup){var i=g.lookup.getZoomQuery(),n=g.getValue();if(""==n&&(n=null),null==i||null!=n){i=new t.Query;var a=null;if(null!=g.lookup&&g.lookup instanceof t.MLookup){var l=g.lookup.getAD_Reference_Value_ID();if(0!=l){var o="VIS_91",r=[];r[0]=new t.DB.SqlParam("@AD_Reference_ID",l);try{var d=s(o,r);d.read()&&(a=d.getString(0)),d.dispose()}catch(e){this.log.log(t.Logging.Level.SEVERE,o,e)}}}null!=a&&0!=a.length?i.addRestriction(a,t.Query.prototype.EQUAL,n):i.addRestriction(g.getColumnName(),t.Query.prototype.EQUAL,n),i.setRecordCount(1)}var c=0;c=g.mField.getZoomWindow_ID()>0?g.mField.getZoomWindow_ID():g.lookup.getZoomWindow(i),t.viewManager.startWindow(c,i)}})),this.disposeComponent=function(){p.off(t.Events.onClick),u.off(t.Events.onClick),g=null,c=null,p=null,this.getBtn=null,this.setVisible=null}}function b(i,n,a,s,l,o,d,c,p,u,g,h){this.NO_INSTANCE=0,this.AD_Column_ID=0;this.C_GenAttributeSet_ID=0,this.C_GenAttributeSetInstance_ID=0,this.M_Locator_ID=0,this.value=null,this.windowNo=d,this.tabNo=h,this.lookup=o,this.C_BPartner_ID=t.Env.getCtx().getContextAsInt(this.windowNo,"C_BPartner_ID"),this.log=t.Logging.VLogger.getVLogger("VPAttribute");l||(l=t.DisplayType.PAttribute),this.isFromActivityForm=c,this.isSearch=p,this.isFromDMS=u,this.isPAttribute=g,this.canSaveRecord=!0;var v=e("<input>",{type:"text",name:i}),f=e('<button class="input-group-text"><i class="vis vis-pattribute"></i></button>'),m=this;function y(e,t){if(m.log.finest("Changed M_AttributeSetInstance_ID="+e),m.oldValue!=e){0==e&&m.setValue(null),m.setValue(e);var i={newValue:e,propertyName:m.colName};m.fireValueChanged(i),i=null}}this.setInstanceIDs=null,r.call(this,v,l,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtnCount=function(){return 1},this.getBtn=function(e){if(0==e)return f},this.setVisible=function(e){this.visible=e,e?(v.show(),f.show()):(f.hide(),v.hide())},this.setReadOnly=function(e){this.isReadOnly=e,v.prop("disabled",!!e),e?f.css("opacity",.7):f.css("opacity",1),this.setBackground(!1)},f.on(t.Events.onClick,(function(i){if(i.stopPropagation(),!m.isReadOnly){var n=m.getValue();if(!m.isPAttribute){var a=0;return 0==(a=t.Env.getCtx().getContextAsInt(m.windowNo,"C_GenAttributeSet_ID"))&&0==(a=m.C_GenAttributeSet_ID)?void t.ADialog.info("NoAttributeSet",null,null,null):void function(e,i){var n=t.Env.getCtx().getContextAsInt(m.windowNo,"C_GenAttributeSetInstance_ID");m.isFromActivityForm&&(n=m.C_GenAttributeSetInstance_ID);var a=new t.GenralAttributeForm(n,e,m.windowNo,m.isSearch,m.getCanSaveRecord(),m.isFromDMS);a.showDialog(),a.onClose=function(e,i,n){t.Env.getCtx().setContext(d,"C_GenAttributeSetInstance_ID",e),y(e),null!=n&&(m.setInstanceIDs=n),m.getControl().val(i),m.editingGrid&&setTimeout((function(){m.editingGrid.editField(m.gridPos.recid,m.gridPos.col,e)}),500)}}(a)}!function(i){var n=null==i?0:i,a=t.Env.getCtx().getTabRecordContext(d,h,"M_Product_ID"),s=t.context.getTabRecordContext(d,h,"M_ProductBOM_ID"),l=t.Env.getCtx().getContextAsInt(d,"M_Locator_ID");m.log.config("M_Product_ID="+a+"/"+s+",M_AttributeSetInstance_ID="+n+", AD_Column_ID="+m.AD_Column_ID);var o=8418==m.AD_Column_ID,r=!0;if(0!=s&&(a=s),0!=a&&e.ajax({url:t.Application.contextUrl+"PAttributes/ExcludeEntry",dataType:"json",async:!1,data:{productId:a,adColumn:m.AD_Column_ID,windowNo:d},success:function(e){r=e.result}}),o||0!=a&&!r){var c=new t.PAttributesForm(n,a,l,m.C_BPartner_ID,o,m.AD_Column_ID,d);c.hasAttribute&&c.showDialog(),c.onClose=function(e,t,i){this.M_Locator_ID=i,y(e),m.editingGrid&&setTimeout((function(){m.editingGrid.editField(m.gridPos.recid,m.gridPos.col,e)}),500)}}else y(n=0),t.ADialog.info("VIS_PAttributeNotFound",null,null,null)}(n)}})),this.SetC_GenAttributeSet_ID=function(e){this.C_GenAttributeSet_ID=e},this.disposeComponent=function(){f.off(t.Events.onClick),m=null,v=null,f=null,this.getBtn=null,this.setVisible=null,this.value=null,this.lookup=null}}function C(i,n,a,s,l,o,d,c){this.value=null,this.windowNo=d,this.lookup=o,this.title=c;var p=i;l||(l=t.DisplayType.PAttribute);var u=e("<input readonly>",{type:"text",name:i}),g=e('<button class="input-group-text"><i class="vis vis-account" ></i></button>'),h=this;r.call(this,u,l,a,i,n),this.getBtnCount=function(){return 1},this.getBtn=function(e){if(0==e)return g},this.setVisible=function(e){this.visible=e,e?(u.show(),g.show()):(u.hide(),g.hide())},this.setReadOnly=function(e){this.isReadOnly=e,u.prop("disabled",!!e),e?g.css("opacity",.7):g.css("opacity",1),this.setBackground(!1)},g.on(t.Events.onClick,(function(e){if(e.stopPropagation(),!h.isReadOnly){var i=t.Env.getCtx().getContextAsInt(h.windowNo,"C_AcctSchema_ID"),n=0;null!=h&&null!=h.getField()&&null!=h.getField().vo&&null!=h.getField().vo.AD_Table_ID&&(n=h.getField().vo.AD_Table_ID);var a=new t.AccountForm(h.title,h.lookup,i,n);a.load(),a.showDialog(),a.onClose=function(e){if(h.oldValue!=e){h.setValue(e);var t={newValue:e,propertyName:p};h.fireValueChanged(t),t=null}},a=null}})),this.disposeComponent=function(){g.off(t.Events.onClick),h=null,u=null,g=null,this.getBtn=null,this.setVisible=null,this.value=null,this.lookup=null,this.value=null,this.windowNo=null,this.title=null}}function _(i,n,a,s){this.values=null,this.log=t.Logging.VLogger.getVLogger("VImage");var l=i,o=e("<img >"),d=e("<i>"),c=e("<span>").text("-"),p=e('<span class="vis vis-edit vis-img-ctrl-icon">'),u=null,g="Thumb500x375";u=e("<button >",{type:"button",name:l,class:"vis-ev-col-img-ctrl"}),c.css("color","blue"),u.append(p).append(o).append(d).append(c),r.call(this,u,t.DisplayType.Button,a,l,n),a?this.setReadOnly(!0):this.setReadOnly(!1);var h=this;u.on(t.Events.onClick,(function(e){if(e.stopPropagation(),!h.isReadOnly){var i=new t.VImageForm(h.getValue(),c.text().trim().length);i.showDialog(),i.onClose=function(e,t){if(t)if(h.oldValue=-1,h.oldValue!=e){e="null"==e?null:e,h.setValue(e);var i={newValue:e,propertyName:l};h.fireValueChanged(i,!0),i=null}else h.refreshImage(e)},i=null}})),this.setText=function(e){if(null==e)return c.text(""),void(o.image.src="");var t=e.indexOf("&");-1!=t&&(" "!=e.toUpperCase().charAt(t+1)&&(e=e.substring(0,t)+e.substring(t+1)));c.text(e)},this.setDimension=function(e,t){g="Thumb"+t+"x"+e},this.setIcon=function(e,i){i?(o.attr("src",t.Application.contextUrl+"Images/"+g+"/"+i+"? timestamp ="+(new Date).getTime()),o.show(),d.hide(),c.text(""),this.ctrl.addClass("vis-input-wrap-button-image-add")):null!=e?(o.attr("src","data:image/jpg;base64,"+e+"? timestamp ="+(new Date).getTime()),o.show(),d.hide(),c.text(""),this.ctrl.addClass("vis-input-wrap-button-image-add")):(o.attr("src","data:image/jpg;base64,"+e),o.hide(),c.text("-"),this.ctrl.removeClass("vis-input-wrap-button-image-add"))},this.hideText=function(){c.hide()},this.hideEditIcon=function(){p.hide()},this.hideEditIcon=function(){p.hide()},this.hideEditIcon=function(){p.hide()},this.disposeComponent=function(){u.off(t.Events.onClick),u=null,this.log=null,null,o=null,c=null,this.setText=null,this.setIcon=null,h=null}}function S(i,n,a,s,l){this.values=null;var o=e("<span>").text(""),d=i,c=null,p=null,u="SaveTolocalFile",g="LoadIntoDatabase";this.data=null;var h=e("<input type='file' class='file' name='file'/>");(c=e("<button>",{type:"button",name:d})).append(o),r.call(this,c,t.DisplayType.Button,a,d,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1);var v,f=this;(v=e("<ul class='vis-apanel-rb-ul'>")).append(e("<a id='link' style='border-bottom: 1px solid #CCDADE;color: #535353;font-size: 12px;display: block;margin-bottom: 8px;'  href='javascript:void(0)'>"+t.Msg.getMsg("SaveTolocalFile")+"</a>")),v.append(e("<li data-action='"+g+"'>").text(t.Msg.getMsg("Open/LoadIntoDatabase"))),(p=v)&&(p.on("click","LI",(function(t){var i=e(t.target).data("action");i==u||i==g&&h.trigger("click")})),p.on("click","a",(function(t){if(null!=f.getValue()){var i=(new Date).toISOString().slice(0,19).replace(/-/g,""),n="data:;base64,"+f.getValue();e(this).attr("href",n).attr("download","file-"+i+".log")}}))),h.change((function(){var e=h[0].files[0],t=new FileReader;t.readAsDataURL(e);t.onloadend=function(){var e=t.result.split(",")[1];if(f.oldValue!=e){f.setValue(e);var i={newValue:e,propertyName:d};f.fireValueChanged(i,!0),i=null}}})),c.on(t.Events.onClick,(function(e){f.isReadOnly||c.w2overlay(p.clone(!0)),e.stopPropagation()})),this.setText=function(e){if(null!=e){var t=e.indexOf("&");if(-1!=t)" "!=e.toUpperCase().charAt(t+1)&&(e=e.substring(0,t)+e.substring(t+1));o.text(e)}else o.text("")},this.disposeComponent=function(){c.off(t.Events.onClick),c=null,this.setText=null,this.values=null,o=null,null,d=null,p=null,u=null,g=null,this.data=null,h=null,f=null}}function x(i,n,a,s,l,o){this.value=null;var d="vis vis-url",c=0,p=e("<input>",{type:"text",name:i,maxlength:o}),u=e('<button class="input-group-text"><i class="'+d+'" ></i></button>');c+=1;var g=this;r.call(this,p,t.DisplayType.URL,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtnCount=function(){return c},this.getBtn=function(e){if(0==e)return u},this.setVisible=function(e){this.visible=e,e?(p.show(),u.show()):(p.hide(),u.hide())},u.on(t.Events.onClick,(function(e){if(e.stopPropagation(),null!=g.value&&!g.isReadOnly){var i=g.value.trim();if(i.length>0)return i.contains("http://")||i.contains("https://")||(i="http://"+i),void window.open(i);t.ADialog.warn("URLnotValid",!0,null)}})),p.on("change",(function(e){e.stopPropagation();var t=p.val();if(t!==g.oldValue){var i={newValue:t,propertyName:g.getName()};g.fireValueChanged(i),i=null}})),this.disposeComponent=function(){u.off(t.Events.onClick),p.off("change"),g=null,p=null,u=null,this.getBtn=null,this.setVisible=null,this.value=null,d=null,c=null,this.getBtnCount=null,this.getBtn=null}}function A(i,n,a,s,l,o){var d=!1;o==o.FileName&&(d=!0),DialogType={OpenFile:0,SaveFile:1,Custom:2},SelectionType={FilesOnly:0,DirectoryOnly:1};var c=SelectionType.DirectoryOnly,p=DialogType.Custom;this.log=t.Logging.VLogger.getVLogger("VFile");o=t.DisplayType.FileName;var u="fa fa-folder-open-o";d&&(c=SelectionType.FilesOnly,u="fa fa-file-text-o");var g=i.toUpperCase();-1!=g.indexOf("open")||-1!=g.indexOf("load")?p=DialogType.OpenFile:-1!=g.indexOf("save")&&(p=DialogType.SaveFile);var h=i;this.value=null;var v=e("<input>",{type:"text",name:h}),f=e('<button class="input-group-text"><i class="'+u+'" /></button>');var m=e("<input autocomplete='off' type='file' class='file' name='file'/>");v.append(f),r.call(this,v,o,a,h,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtnCount=function(){return 1},this.getBtn=function(e){if(0==e)return f},this.setVisible=function(e){this.visible=e,e?(v.show(),f.show()):(v.hide(),f.hide())};var y=this;f.on(t.Events.onClick,(function(i){var n;if(!y.isReadOnly)if(i.stopPropagation(),c==SelectionType.DirectoryOnly)(n=new t.VisImportFiles(!0)).onClose=function(e){y.setValue(e)},n.show();else if(p==DialogType.SaveFile){if(null!=y.getValue()){var a=(new Date).toISOString().slice(0,19).replace(/-/g,""),s="data:;base64,"+y.getValue();e(this).attr("href",s).attr("download","file-"+a+".log")}}else(n=new t.VisImportFiles(!1)).onClose=function(e){y.setValue(name)},n.show()})),m.on("change",(function(t){t.stopPropagation();var i=e(m).val().split("\\").pop();if(y.oldValue!=i){y.setValue(i);var n={newValue:i,propertyName:h};y.fireValueChanged(n),n=null}})),v.on("change",(function(e){e.stopPropagation();var t=v.val();if(this.value=t,t!==y.oldValue){var i={newValue:t,propertyName:y.getName()};y.fireValueChanged(i),i=null,y.setValue(t)}})),this.disposeComponent=function(){v.off(t.Events.onClick),v.off("change"),m.off("change"),v=null,null,h=null,m=null,y=null}}function T(i,n,a,s,l,o,d){l||(l=t.DisplayType.AmtDimension),this.lookup=o,this.lastDisplay="",this.settingFocus=!1,this.inserting=!1,this.settingValue=!1,this.value=null,this.defaultValue="";var c=e("<input readonly>",{type:"text",name:i}),p=e('<button class="input-group-text"><i class="vis vis-amtdimension" /></button>'),u=this;r.call(this,c,l,a,i,n),this.format=t.DisplayType.GetNumberFormat(t.DisplayType.Amount),this.dotFormatter=t.Env.isDecimalPoint(),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtn=function(e){if(0==e)return p},this.getBtnCount=function(){return 1},this.hideButton=function(e){e?p.show():p.hide()},this.setVisible=function(e){this.visible=e,e?(c.show(),p.show()):(c.hide(),p.hide())},this.setReadOnly=function(e){this.isReadOnly=e,c.css("background-color","#f8f8f8"),this.setBackground(e)},this.setReadOnlyTextbox=function(e){e?(c.attr("readonly","readonly"),c.attr("disabled","disabled")):(c.removeAttr("readonly"),c.removeAttr("disabled"))},this.getText=function(){return c.val()},this.setDefaultValue=function(e){this.defaultValue=e},p.on(t.Events.onClick,(function(e){e.stopPropagation(),u.actionText()})),this.actionText=function(){u.value||(u.value=0);var e,i=t.Env.getCtx().getContextAsInt(d,"AD_Org_ID",!1);this.defaultValue&&(u.defaultValue=u.defaultValue.replace(/@/g,"").trim().replace(".value",""),e=t.Env.getCtx().getWindowContext(d,u.defaultValue,!1)),u.oldValue=u.value;var n=new t.AmountDivision(u.value,i,e,u.isReadOnly);n.onClosing=function(e){if(e>0){u.oldValue=0,u.lookup.refreshAmountDivision(e),u.setValue(e);var t={newValue:e,propertyName:u.getColumnName()};u.fireValueChanged(t),t=null}},n.show(),n=null},this.disposeComponent=function(){p.off(t.Events.onClick),u=null,c=null,p=null,this.setVisible=null}}function V(i,a,s,l,o,d,c){o||(o=t.DisplayType.ProductContainer);var p={};this.lookup=d,this.lastDisplay="",this.settingFocus=!1,this.inserting=!1,this.settingValue=!1,this.value=null,this.defaultValue="";p[t.Actions.zoom]=!1,t.MRole.getIsShowPreference()&&(p[t.Actions.preference]=!0),p[t.Actions.remove]=!0;var u=t.AEnv.getContextPopup(p),g=e("<input>",{type:"text",name:i});g.attr("autocomplete","off");var h=e('<button class="input-group-text"><i class="vis vis-pcontainer" /></button>'),v=e('<button   class="input-group-text"><i tabindex="-1" Class="fa fa-ellipsis-v" /></button>');var f=this;r.call(this,g,o,s,i,a),s||!l?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtn=function(e){return 0==e?h:1==e&&v?v:void 0},this.getBtnCount=function(){return 2},this.hideButton=function(e){e?(h.show(),this.getBtnCount()>1&&v&&v.show()):(h.hide(),this.getBtnCount()>1&&v&&v.hide())},this.setVisible=function(e){this.visible=e,e?(g.show(),h.show(),this.getBtnCount()>1&&v&&v.show()):(g.hide(),h.hide(),this.getBtnCount()>1&&v&&v.hide())},this.setReadOnly=function(e){this.isReadOnly=e,g.prop("disabled",!!e),e?h.css("opacity",.7):h.css("opacity",1),this.setBackground(!1)},v&&v.on(t.Events.onClick,(function(e){v.w2overlay(u.clone(!0)),e.stopPropagation()})),u&&u.on("click","LI",(function(i){var n=e(i.target).data("action");if(n==t.Actions.preference){var a=new t.ValuePreference(f.mField,f.getValue(),f.getDisplay());null!=a&&a.showDialog(),a=null}else if(n==t.Actions.zoom)!function(){if(!f.lookup)return;var e=f.lookup.getZoomQuery(),i=f.getValue();""==i&&(i=null);null==i||isNaN(i)||(i=parseInt(i));(e=new t.Query).addRestriction("M_ProductContainer_ID",t.Query.prototype.EQUAL,i),e.setRecordCount(1);var n=0;n=f.mField.getZoomWindow_ID()>0?f.mField.getZoomWindow_ID():f.lookup.getZoomWindow(e);t.viewManager.startWindow(n,e)}();else if(n==t.Actions.remove){if(f.isReadOnly)return;f.setValue(null,!1,!0)}})),this.getText=function(){return g.val()},this.setDefaultValue=function(e){this.defaultValue=e},h.on(t.Events.onClick,(function(e){e.stopPropagation(),f.isReadOnly||f.actionText(!0)})),this.actionText=function(i){f.value||(f.value=0);var a=g.val().trim(),s=t.Env.parseContext(t.Env.getCtx(),c,f.lookup.getTabNo(),f.lookup.info.validationCode,!1,!0);!a||i?f.openForm(0,0,a,s):e.ajax({url:n+"productContainer/GetProductContainer",data:{text:a,validation:s},success:function(e){"null"==(e=JSON.parse(e))||null==e||""==e||0==e?f.openForm(0,0,a,s):f.setVal(e)},error:function(){}})},g.on("keydown",(function(e){13!=e.keyCode&&9!=e.keyCode||f.actionText(!1)})),this.setVal=function(e){f.oldValue=0,f.setValue(e);var t={newValue:e,propertyName:f.getColumnName()};f.fireValueChanged(t,!0),t=null},this.openForm=function(e,i,n,a){f.oldValue=f.value;var s=new t.productContainerTree(e,i,n,a);null!=s&&(s.showDialog(),s.onClosing=function(e){f.setVal(e)}),s=null},this.disposeComponent=function(){h.off(t.Events.onClick),f=null,g=null,h=null,this.setVisible=null}}function N(i,n,a,s,l,o){this.colSql=i,this.windowNo=n,this.cache={},this.isExe=s,this.headerItemID=o,this.needtoParse=!1,this.frmat=null,l&&t.DisplayType.IsNumeric(l.getDisplayType())&&(this.frmat=t.DisplayType.GetNumberFormat(l.getDisplayType())),this.frmat=null,l&&t.DisplayType.IsNumeric(l.getDisplayType())&&(this.frmat=t.DisplayType.GetNumberFormat(l.getDisplayType())),i.contains("@")&&(this.needtoParse=!0);var d=e("<span "+(' for="'+a+'"')+"></span>");r.call(this,d,t.DisplayType.Label,!0,"lbl"+a),this.disposeComponent=function(){d=null,self=null,this.frmat&&this.frmat.dispose(),this.format=null,this.cache={},this.cache=null}}function M(t,i,n,a,s,l,o){var d=e('<div class="vis-progressCtrlWrap"></div>'),c=e("<input>",{type:"range",step:"1",name:t,maxlength:l,"data-type":"int"}),p=e('<output  class="vis-progress-output">');d.append(p).append(c),r.call(this,d,o,n,t,i),this.rangeCtrl=c,this.oputput=p,p.text(0),this.setText=function(e){p.text(e)},this.setRange=function(e){null!=e?c.val(e):c.val(0)},this.getRange=function(){return c.val()},n||!a?this.setReadOnly(!0):this.setReadOnly(!1);var u=this;p.keypress((function(t){(t.which<46||t.which>59)&&t.preventDefault(),(46==t.which&&-1!=e(this).val().indexOf(".")||44==t.which&&-1!=e(this).val().indexOf(","))&&t.preventDefault()})).on("blur",(function(){e.isNumeric(c.attr("max"))&&Number(c.attr("max"))<Number(e(this).text())&&e(this).text(c.attr("max")),c.val(e(this).text()||0).change()})),c.on("input",(function(e){e.stopPropagation();var t=c.val();p.show(),p.text(t)})),c.on("change",(function(e){e.stopPropagation();var t=c.val();if(t!==u.oldValue){var i={newValue:t,propertyName:u.getName()};u.fireValueChanged(i),i=null}})),this.disposeComponent=function(){d=null,c=null,this.rangeCtrl=this.$oputput=null,u=null}}function k(i,n,a,s,l,o,d,c,p){var u=t.DisplayType.TelePhone;this.obscureType=c;var g=e("<input>",{type:"tel",name:i,maxlength:o}),h=e('<button class="input-group-text"><i class="fa fa-phone" /></button>');r.call(this,g,u,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtn=function(e){if(0==e)return h},this.getBtnCount=function(){return this.editingGrid?0:1};var v=this;g.on("change",(function(e){e.stopPropagation();var t=v.iti?v.iti.getNumber():v.ctrl.val();if(this.value=t,t!==v.oldValue){var i={newValue:t,propertyName:v.getName()};v.fireValueChanged(i),i=null}c&&v.setReadOnly(!0)})),g.on("keypress",(function(e){var t=e.which?e.which:e.keyCode;return!(t>31&&(t<48||t>57))||43==t&&this.value.indexOf("+")<0})),g.on("countrychange",(function(e,t){v.settingVal})),g.on("blur",(function(e){})),h.on("click",(function(){if(!v.editingGrid)if(window.VA048){var e=v.getValue();if(!e||""==e)return;var i={};i.tonumbers=e,i.username="",i.userimg="",i.isconference=!1,i.reftableid=-1,i.refrecordid=-1,i.windowno=0,i.windowid=0,i.tableid=0,i.recordid=0,i.withrecording=!1,i.withcall=!0,VA048.Apps.GetCallingInstance(!0,i,!1)}else t.ADialog.info("ComModuleNotInstalled")})),this.disposeComponent=function(){g.off("change"),g=null,v.iti&&v.iti.destroy(),v=null}}function O(i,n,a,s,l,o,d,c,p){var u=t.DisplayType.Color;this.obscureType=c;var g=e("<input>",{type:"color",name:i,maxlength:o}),h=e('<button class="input-group-text"><i class="fa fa-phone" /></button>');r.call(this,g,u,a,i,n),a||!s?this.setReadOnly(!0):this.setReadOnly(!1),this.getBtn=function(e){if(0==e)return h},this.getBtnCount=function(){return 0};var v=this;g.on("change",(function(e){e.stopPropagation();var t=v.ctrl.val();if(this.value=t,t!==v.oldValue){var i={newValue:t,propertyName:v.getName()};v.fireValueChanged(i),i=null}c&&v.setReadOnly(!0)})),g.on("blur",(function(e){})),h.on("click",(function(){})),this.disposeComponent=function(){g.off("change"),g=null,v=null}}t.DisplayType={String:10,Integer:11,Amount:12,ID:13,Text:14,Date:15,DateTime:16,List:17,Table:18,TableDir:19,YesNo:20,Location:21,Number:22,Binary:23,Time:24,Account:25,RowID:26,Color:27,Button:28,Quantity:29,Search:30,Locator:31,Image:32,Assignment:33,Memo:34,PAttribute:35,TextLong:36,CostPrice:37,FilePath:38,FileName:39,URL:40,PrinterName:42,Label:44,MultiKey:45,GAttribute:46,AmtDimension:47,ProductContainer:48,ProgressBar:49,TelePhone:50,IsString:function(e){return t.DisplayType.String==e},IsText:function(e){return e==t.DisplayType.String||e==t.DisplayType.Text||e==t.DisplayType.TextLong||e==t.DisplayType.Memo||e==t.DisplayType.FilePath||e==t.DisplayType.FileName||e==t.DisplayType.URL||e==t.DisplayType.PrinterName||e==t.DisplayType.TelePhone||e==t.DisplayType.Color},IsLookup:function(e){return t.DisplayType.List==e||e==t.DisplayType.TableDir||e==t.DisplayType.Table||e==t.DisplayType.Search||e==t.DisplayType.MultiKey||e==t.DisplayType.ProductContainer},IsInt:function(e){return e==t.DisplayType.Integer||e==t.DisplayType.ProgressBar},IsSearch:function(e){return e==this.Search},IsID:function(e){return e==t.DisplayType.ID||e==t.DisplayType.Table||e==t.DisplayType.TableDir||e==t.DisplayType.Search||e==t.DisplayType.Location||e==t.DisplayType.Locator||e==t.DisplayType.Account||e==t.DisplayType.Assignment||e==t.DisplayType.PAttribute||e==t.DisplayType.Image||e==t.DisplayType.AmtDimension||e==t.DisplayType.ProductContainer},IsNumeric:function(e){return e==t.DisplayType.Amount||e==t.DisplayType.Number||e==t.DisplayType.CostPrice||e==t.DisplayType.Integer||e==t.DisplayType.Quantity||e==t.DisplayType.ProgressBar},IsDate:function(e){return e==t.DisplayType.Date||e==t.DisplayType.DateTime||e==t.DisplayType.Time},IsLOB:function(e){return e==t.DisplayType.Binary||e==t.DisplayType.TextLong},MAX_DIGITS:28,INTEGER_DIGITS:10,MAX_FRACTION:12,AMOUNT_FRACTION:2,GetNumberFormat:function(e){return e==this.Integer||e==this.ProgressBar?new t.Format(this.INTEGER_DIGITS,0,0):e==this.Quantity?new t.Format(this.MAX_DIGITS,this.MAX_FRACTION,0):e==this.Amount||e==this.CostPrice?new t.Format(this.MAX_DIGITS,this.MAX_FRACTION,this.AMOUNT_FRACTION):new t.Format(this.MAX_DIGITS,this.MAX_FRACTION,1)}},t.VControlFactory={getControl:function(e,i,n,a,s){if(!i)return null;var l=i.getColumnName(),o=i.getIsMandatory(!1);if(i.getIsHeading())return null;i.getIsDisplayed();var r=i.getMinValue(),p=i.getMaxValue(),N=null,L=i.getDisplayType(),R=i.getIsReadOnly(),E=i.getIsEditable(!1),P=i.getWindowNo(),U=0,F=!1;if(e&&(U=e.getTabNo(),F=!e.getIsMapView()),L==t.DisplayType.Button){var B=new u(l,o,R,E,i.getHeader(),i.getDescription(),i.getHelp(),i.getAD_Process_ID(),i.getIsLink(),i.getIsRightPaneLink(),i.getAD_Form_ID(),i.getIsBackgroundProcess(),i.getAskUserBGProcess());B.setField(i),B.setReferenceKey(i.getAD_Reference_Value_ID()),N=B}else if(L==t.DisplayType.TelePhone){(ae=new k(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),i.getVFormat(),i.getObscureType(),i.getIsEncryptedField())).setField(i),N=ae}else if(L==t.DisplayType.Color){(ae=new O(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),i.getVFormat(),i.getObscureType(),i.getIsEncryptedField())).setField(i),N=ae}else if(L==t.DisplayType.String){(ae=new d(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),i.getVFormat(),i.getObscureType(),i.getIsEncryptedField())).setField(i),N=ae}else if(L==t.DisplayType.YesNo){var W=new g(l,o,R,E,i.getHeader(),i.getDescription(),i.getIsSwitch());W.setField(i),N=W}else if(t.DisplayType.IsDate(L)){L==t.DisplayType.DateTime&&(readOnly=!0);var j=new v(l,o,R,E,L,i.getHeader());j.setName(l),j.setField(i),N=j}else if(t.DisplayType.IsLookup(L)||t.DisplayType.ID==L){var G,q=i.getLookup();if(a&&null!=q&&q.disableValidation(),a)if(null==q||L!=t.DisplayType.Search&&q.getDisplayType()!=t.DisplayType.Search)(G=new h(l,o,R,E,q,i.getDisplayLength(),L,i.getZoomWindow_ID())).setDisplayType(L),G.setField(i),N=G;else(H=new f(l,o,R,E,L=t.DisplayType.Search,q,i.getZoomWindow_ID())).setField(i),N=H;else if(L!=t.DisplayType.Search&&L!=t.DisplayType.MultiKey&&L!=t.DisplayType.ProductContainer)(G=new h(l,o,R,E,q,i.getDisplayLength(),L,i.getZoomWindow_ID())).setField(i),N=G;else if(L==t.DisplayType.ProductContainer){(se=new V(l,o,R,E,L,i.getLookup(),P)).setField(i),N=se}else{var H;(H=new f(l,o,R,E,L,q,i.getZoomWindow_ID())).setField(i),N=H}}else if(L==t.DisplayType.Location){var z=new D(l,o,R,E,L,i.getLookup(),F);z.setField(i),N=z}else if(L==t.DisplayType.Locator){var Q=new w(l,o,R,E,L,i.getLookup());Q.setField(i),N=Q}else if(t.DisplayType.Text==L||t.DisplayType.TextLong==L||t.DisplayType.Memo==L){var J=new m(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),L);J.setField(i),N=J}else if(t.DisplayType.IsNumeric(L)){if(t.DisplayType.Amount==L||t.DisplayType.Quantity==L||t.DisplayType.CostPrice==L){var $=new y(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),L,"FixedHeader");$.setMinValue(r),$.setMaxValue(p),$.setField(i),N=$}else if(t.DisplayType.Integer==L){var K=new I(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),"FixedHeader");K.setField(i),N=K}else if(t.DisplayType.Number==L){var Y=new y(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),L,"FixedHeader");Y.setField(i),Y.setMinValue(r),Y.setMaxValue(p),N=Y}else if(L==t.DisplayType.ProgressBar){var X=new M(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),L);X.setField(i),X.setMinValue(r),X.setMaxValue(p),N=X}}else if(L==t.DisplayType.PAttribute){(Z=new b(l,o,R,E,L,i.getLookup(),P,!1,!1,!1,!0,U)).setField(i),N=Z}else if(L==t.DisplayType.GAttribute){var Z;(Z=new b(l,o,R,E,L,i.getLookup(),P,!1,!1,!1,!1,U)).setField(i),N=Z}else if(L==t.DisplayType.Account){var ee=new C(l,o,R,E,L,i.getLookup(),P,i.getHeader());ee.setField(i),N=ee}else if(L==t.DisplayType.Binary){var te=new S(l,o,R,E,P);te.setField(i),N=te}else if(L==t.DisplayType.Image){var ie=new _(l,o,R,P);ie.setField(i),N=ie}else if(L==t.DisplayType.URL){(ne=new x(l,o,R,E,i.getDisplayLength(),i.getFieldLength())).setField(i),N=ne}else if(L==t.DisplayType.FileName||L==t.DisplayType.FilePath){var ne;(ne=new A(l,o,R,E,P,L)).setField(i),N=ne}else if(L==t.DisplayType.Label){var ae;(ae=new c(i.getHelp(),l,!1,!0)).setField(i),N=ae}else if(L==t.DisplayType.AmtDimension){(se=new T(l,o,R,E,L,i.getLookup(),P)).setField(i),se.setDefaultValue(i.vo.DefaultValue),N=se}else if(L==t.DisplayType.ProductContainer){var se;(se=new V(l,o,R,E,L,i.getLookup(),P)).setField(i),N=se}null==N&&((ae=new d(l,o,R,E,i.getDisplayLength(),i.getFieldLength(),i.getVFormat(),i.getObscureType(),i.getIsEncryptedField())).setField(i),N=ae);return N},getLabel:function(e){if(null==e)return null;var i=e.getDisplayType();return e.getIsFieldOnly()||i==t.DisplayType.YesNo||i==t.DisplayType.Button||i==t.DisplayType.Label?null:new t.Controls.VLabel(e.getHeader(),e.getColumnName(),e.getIsMandatory())},getHeaderLabel:function(e){if(null==e)return null;var i=e.getDisplayType();return e.getHeaderIconOnly()&&e.getHeaderHeadingOnly()||e.getHeaderIconOnly()||i==t.DisplayType.Button||i==t.DisplayType.Label?null:new t.Controls.VLabel(e.getHeader(),e.getColumnName(),e.getIsMandatory())},getReadOnlyControl:function(e,i,n,a,s){if(!i)return null;var l=i.getColumnName(),o=i.getIsMandatory(!1),r=i.getWindowNo(),d=i.getOrginalDisplayType(),c=i.getIsReadOnly(),g=i.getIsEditable(!1),h=null;if(d==t.DisplayType.Image){var v=new _(l,o,!0,r);v.setDimension(120,140),v.hideText(),v.hideEditIcon(),h=v}else if(d==t.DisplayType.Button){var f=new u(l,o,c,g,i.getHeader(),i.getDescription(),i.getHelp(),i.getAD_Process_ID(),i.getIsLink(),i.getIsRightPaneLink(),i.getAD_Form_ID(),i.getIsBackgroundProcess(),i.getAskUserBGProcess());f.setField(i,!0),h=f}else{var m=new p(i.getHelp(),l,!1,!0);m.setField(i),t.DisplayType.IsNumeric(d)&&(m.format=t.DisplayType.GetNumberFormat(d)),h=m}return h},getIcon:function(e){return e.getFontClass()?"<i class='"+e.getFontClass()+"'> </i>":e.getAD_Image_ID()>0?"<img src='"+t.Application.contextUrl+"Images/Thumb16x16/"+e.getAD_Image_ID()+".jpg' > ":void 0}},r.prototype.getControl=function(){return this.ctrl},r.prototype.getRoot=function(){return this.root?this.root:this.ctrl},r.prototype.getField=function(){return this.mField},r.prototype.getName=function(){return this.colName},r.prototype.getColumnName=function(){return this.colName},r.prototype.getIsMandatory=function(){return this.isMandatory},r.prototype.getIsReadonly=function(){return this.readOnly},r.prototype.getDisplayType=function(){return this.displayType},r.prototype.getIsVisible=function(){return this.visible},r.prototype.getValue=function(){return this.ctrl.val()},r.prototype.getDisplay=function(){return this.ctrl.val()},r.prototype.getBtnCount=function(){return 0},r.prototype.setName=function(e,t){t?this.name=t+e:this.colName=e},r.prototype.setField=function(e){this.mField=e},r.prototype.setValue=function(e){},r.prototype.setVisible=function(e){this.visible=e,e?this.ctrl.show():this.ctrl.hide()},r.prototype.setReadOnly=function(e){this.isReadOnly=e,this.ctrl.prop("disabled",!!e),this.setBackground(!1)},r.prototype.setHtmlStyle=function(e){e&&this.dynStyle!=e?(e.contains(":")?(this.dynStyle||(this.oldStyle=this.ctrl.attr("style")),this.ctrl.removeAttr(e).attr("style",e)):this.ctrl.addClass(e),this.dynStyle=e):!e&&this.dynStyle&&(this.dynStyle.contains(":")?(this.ctrl.removeAttr("style"),this.oldStyle&&this.ctrl.attr("style",this.oldStyle)):this.ctrl.removeClass(this.dynStyle),this.oldStyle=null,this.dynStyle=null)},r.prototype.setDefaultFocus=function(e){e&&this.ctrl.focus()},r.prototype.setMandatory=function(e){this.isMandatory=e,this.setBackground(!1)},r.prototype.setBackground=function(e){if(!this.colName.startsWith("lbl")&&this.displayType!=t.DisplayType.Label&&this.displayType!=t.DisplayType.YesNo&&this.displayType!=t.DisplayType.Button)if("boolean"==typeof e)if(e)this.setBackground("vis-ev-col-error");else if(this.isReadOnly)this.setBackground("vis-ev-col-readonly");else if(this.isMandatory){var i=this.getValue();if(i&&i.toString().length>0)return void this.setBackground("");this.setBackground("vis-ev-col-mandatory")}else this.setBackground("");else{if(this.activeClass==e)return;this.ctrl.removeClass("vis-ev-col-error"),this.ctrl.removeClass("vis-ev-col-readonly"),this.ctrl.removeClass("vis-ev-col-mandatory"),e.length>0&&this.ctrl.addClass(e),this.activeClass=e}},r.prototype.setDisplayType=function(e){this.displayType=e},r.prototype.addVetoableChangeListener=function(e){this.vetoablechangeListner=e},r.prototype.fireValueChanged=function(e,t){if(this.isReadOnly){var i=this.oldValue;return this.oldValue="",void this.setValue(i)}this.editingGrid&&(this.gridPos.dialog||t)?window.setTimeout((function(t){0!=t.ctrl.parent().length&&t.ctrl.detach(),t.editingGrid.editChange.call(t.editingGrid,t.ctrl[0],t.gridPos.index,t.gridPos.col,e,e.newValue),t.oldValue==e.newValue&&t.vetoablechangeListner.vetoablechange(e),t=null,e=null}),10,this):this.vetoablechangeListner&&!this.editingGrid&&window.setTimeout((function(t){t.vetoablechangeListner.vetoablechange(e),t=null,e=null}),10,this)},r.prototype.fireRefreshUI=function(e){this.vetoablechangeListner&&window.setTimeout((function(t){t.vetoablechangeListner.refreshUI(e),t=null,e=null}),10,this)},r.prototype.addActionListner=function(e){this.actionListner=e},r.prototype.invokeActionPerformed=function(e){this.actionListner&&this.actionListner.actionPerformed(e)},r.prototype.init=function(){},r.prototype.detach=function(){this.ctrl.detach()},r.prototype.dispose=function(){console.log("dispose "),this.ctrl.remove(),this.ctrl=null,this.mField=null,this.displayType=null,this.isReadOnly=null,this.colName=null,this.isMandatory=null,this.oldValue=null,this.vetoablechangeListner=null,this.actionListner=null,this.disposeComponent()},t.Utility.inheritPrototype(d,r),d.prototype.setReadOnly=function(e,t){e||!this.obscureType||t||this.mField.getIsInserting()&&""==this.ctrl.val()||(e=!0),this.isReadOnly=e,this.ctrl.prop("disabled",!!e),this.setBackground(!1)},d.prototype.setValue=function(e){this.oldValue!=e&&(!this.obscureType||this.mField.getIsInserting()&&""==this.ctrl.val()?this.ctrl.val(e):(this.ctrl.val(t.Env.getObscureValue(this.obscureType,e)),this.setReadOnly(!0)),this.oldValue=e)},d.prototype.getDisplay=function(){return this.ctrl.val()},t.Utility.inheritPrototype(c,r),t.Utility.inheritPrototype(p,r),p.prototype.setValue=function(e,i){this.oldValue!=e&&(this.oldValue=e,this.mField.getDisplayType()==t.DisplayType.TelePhone&&e&&"- -"!=e?this.ctrl.html(t.VTelePhoneInstance.getHtml(e)):(this.ctrl.text(e),i&&this.ctrl.html(e)))},p.prototype.getValue=function(){return null!=this.value?this.ctrl.text().toString():null},t.Utility.inheritPrototype(u,r),u.prototype.referenceList={},u.prototype.setField=function(e,i){this.mField=e,!e.getShowIcon()||""==e.getFontClass()&&""==e.getImageName()||(""!=e.getFontClass()?this.setIcon(e.getFontClass()):this.setIcon(t.Application.contextUrl+"Images/Thumb16x16/"+e.getImageName(),!0)),this.setLayout(i)},u.prototype.setReferenceKey=function(e){e&&e>0&&195!=e&&135!=e&&234!=e&&435!=e&&this.readReference(e)},u.prototype.setValue=function(e){this.value=e;var i=this.text;if(null==e||this.colName.equals("Record_ID"));else if(null!=this.values)i=this.values[e];else if(null!=this.lookup){var n=this.lookup.get(e);null!=n&&(i=n.getName())}i||(i=t.Msg.getMsg("Invalid")+" { '"+e+"' }"),this.setText(null!=i?i:"")},u.prototype.setReadOnly=function(e){this.isReadOnly=e,this.dynStyle&&this.dynStyle.indexOf("opacity")>-1||this.ctrl.css("opacity",e?.6:1),this.isLink||this.ctrl.prop("disabled",!!e),this.setBackground(!1)},u.prototype.getValue=function(){return null!=this.value?this.value.toString():null},u.prototype.getDisplay=function(){return this.value},u.prototype.readReference=function(e){if(this.values=null,this.referenceList&&(this.values=this.referenceList[e]),this.values)return this.values;var i;this.values={},i=t.Env.isBaseLanguage(t.Env.getCtx(),"")?"VIS_82":"VIS_148";var n=[];n[0]=new t.DB.SqlParam("@AD_Reference_ID",e);try{for(var a=s(i,n);a.read();)this.values[a.getString(0)]=a.getString(1);this.referenceList[e]=this.values,a.close()}catch(e){t.Logging.VLogger.getVLogger().get().log(t.Logging.Level.SEVERE,i,e)}},u.prototype.getProcess_ID=function(){return this.AD_Process_ID},u.prototype.getAD_Form_ID=function(){return this.AD_Form_ID},u.prototype.getDescription=function(){return this.description},u.prototype.getHelp=function(){return this.help},u.prototype.getAskUserBGProcess=function(){return this.askUserBGProcess},u.prototype.getIsBackgroundProcess=function(){return this.isBackgroundProcess},t.Utility.inheritPrototype(g,r),g.prototype.setValue=function(e){this.oldValue!=e&&(this.oldValue=e,this.cBox.prop("checked",e))},g.prototype.getValue=function(){return this.cBox.prop("checked")},g.prototype.getDisplay=function(){return this.cBox.prop("checked").toString()},t.Utility.inheritPrototype(h,r),h.prototype.setValue=function(e,i){if(this.oldValue!=e){if(this.settingValue=!0,this.oldValue=e,this.ctrl.val(e),null==e)return this.lastDisplay="",void(this.settingValue=!1);if(null==this.lookup)return this.lastDisplay=e.toString(),void(this.settingValue=!1);this.lastDisplay=this.lookup.getDisplay(e,!0),this.lastDisplay.equals("<-1>")&&(this.lastDisplay="",this.oldValue=null),this.inserting=i;var n=this.lastDisplay.startsWith("<")&&this.lastDisplay.endsWith(">");if(null==this.ctrl.val()||this.inserting&&this.lookup.getDisplayType()!=t.DisplayType.Search){if(n&&this.lookup.loading)return window.setTimeout((function(t){t.setValue(e,i),t=null}),500,this),void(this.oldValue="oldValue");if(n&&(this.lastDisplay=this.lookup.getDisplay(e,!1),n=this.lastDisplay.startsWith("<")&&this.lastDisplay.endsWith(">")),n)this.oldValue="old",this.ctrl.val(null),this.inserting&&this.ctrl.trigger("change");else if(null==this.ctrl.val())if(this.inserting&&!this.lookup.info.isParent&&this.lookup.getIsValidated()&&this.lookup.allLoaded)this.lookup.fillCombobox(this.getIsMandatory(),!1,!1,!1),this.lookup.loading||this.refreshOptions(this.lookup.data,e);else{var a=null;if(this.lookup.loading||(a=this.lookup.getFromList(e)),null==a&&(a=this.lookup.get(e)),null!=a){var s=t.Utility.Util.getIdentifierDisplayVal(a.Name);this.ctrl.append('<option value="'+a.Key+'">'+s+"</option>"),this.ctrl.val(e)}}null==this.ctrl.val()&&null!=e&&(this.oldValue=null)}this.settingValue=!1}this.inserting=!1},h.prototype.getDisplayValue=function(e){var t="";return e.indexOf("Images/")>-1?(t=e.replace("^^"+e.substring(e.indexOf("Images/"),e.lastIndexOf("^^")+3),"_")).indexOf("Images/")>-1&&(t=t.replace(t.substring(t.indexOf("Images/"),t.lastIndexOf("^^")+3),"_")):t=e,t},h.prototype.getValue=function(){var e=this.ctrl.val();return"-1"==e?null:e},h.prototype.refreshOptions=function(e,i){for(var n=[],a=-1,s=0;s<e.length;s++){i&&i==e[s].Key&&(a=s);var l=t.Utility.Util.getIdentifierDisplayVal(e[s].Name);n[s]='<option value="'+e[s].Key+'">'+l+"</option>"}this.ctrl.empty(),this.ctrl.html(n.join("")),this.ctrl[0].selectedIndex=a},h.prototype.getDisplay=function(){return null==this.lookup?this.ctrl.val():this.lookup.getDisplay(this.ctrl.val())},t.Utility.inheritPrototype(v,r),v.prototype.setValue=function(e){if(this.oldValue!=e){if(this.oldValue=e,null==e||""==e)return void this.ctrl.val("");var i=new Date(e);this.displayType!=t.DisplayType.Date&&i.setMinutes(-i.getTimezoneOffset()+i.getMinutes());var n=(e=i.toISOString()).substring(0,e.length-1),a=e.indexOf("T");if(this.displayType==t.DisplayType.DateTime)this.ctrl.val(n);else if(this.displayType==t.DisplayType.Date)this.ctrl.val(n.substring(0,a));else{var s=i.getUTCHours(),l=i.getUTCMinutes();this.ctrl.val((s<10?"0"+s:s)+":"+(l<10?"0"+l:l))}}},v.prototype.getValue=function(){var e=this.ctrl.val();if(null==e||""==e)return null;var i=null;if(this.displayType==t.DisplayType.Time){(i=new Date(0)).setYear(1990);var n=e.match(/(\d+)\:(\d+)/),a=parseInt(n[1],10),s=parseInt(n[2],10);i.setHours(a),i.setMinutes(s)}else i=new Date(e+"Z");try{return this.displayType==t.DisplayType.DateTime&&i.setMinutes(i.getTimezoneOffset()+i.getMinutes()),i.toISOString().replace(".000Z","Z")}catch(t){return console.log(e),new Date}},v.prototype.getDisplay=function(){return this.getValue()},t.Utility.inheritPrototype(f,r),f.prototype.setValue=function(e,i,n){if(this.oldValue!=e||i){if(this.settingValue=!0,this.oldValue=e,this.value=e,null==e){if(this.lastDisplay="",this.ctrl.val(""),this.settingValue=!1,n){var a={newValue:e,propertyName:this.getName()};this.fireValueChanged(a),a=null}return}if(null==this.lookup)return this.ctrl.val(e.toString()),this.lastDisplay=e.toString(),void(this.settingValue=!1);if(this.displayType!==t.DisplayType.MultiKey)this.lastDisplay=this.lookup.getDisplay(e);else{for(var s=e.toString().split(","),l="",o=0,r=s.length;o<r;o++){var d=s[o];isNaN(d)||(d=Number(d)),0!=l.length?l+=", "+this.lookup.getDisplay(d):l+=this.lookup.getDisplay(d)}this.lastDisplay=l}this.lastDisplay.equals("<-1>")&&(this.lastDisplay="",this.oldValue=null,this.value=null),this.value=e;var c=t.Utility.Util.getIdentifierDisplayVal(this.lastDisplay);if(this.ctrl.val(t.Utility.decodeText(c)),this.settingValue=!1,n){-1!=e&&""!=e||(e=null);a={newValue:e,propertyName:this.getName()};this.fireValueChanged(a),a=null}}else null==e&&this.ctrl.val("")},f.prototype.getValue=function(){return this.value},f.prototype.getMultipleIds=function(){return this.infoMultipleIds},f.prototype.getDisplay=function(){return null==this.lookup?this.value:this.lookup.getDisplay(this.value)},f.prototype.setCustomInfo=function(e){null!=e&&(this.custInfoWin=e)},t.Utility.inheritPrototype(m,r),m.prototype.setValue=function(e){this.oldValue!=e&&(this.oldValue=e,this.ctrl.val(e))},m.prototype.getDisplay=function(){return this.ctrl.val()},t.Utility.inheritPrototype(y,r),y.prototype.setValue=function(e){if(this.oldValue!=e){this.oldValue=e,e=this.format.GetFormatedValue(e),this.ctrl.attr("type","text");var t=this.format.GetFormatAmount(e,"init",this.dotFormatter);this.ctrl.val(t)}},y.prototype.getValue=function(){var e=this.$super.getValue.call(this);return e=this.format.GetConvertedNumber(e,this.dotFormatter),isNaN(e)||null===e?null:Number(e)},y.prototype.getDisplay=function(){return this.ctrl.val()},y.prototype.setMaxValue=function(t){e.isNumeric(t)&&this.ctrl.attr("max",t)},y.prototype.setMinValue=function(t){e.isNumeric(t)&&this.ctrl.attr("min",t)},t.Utility.inheritPrototype(I,r),I.prototype.setValue=function(e){this.oldValue!=e&&(this.oldValue=e,this.ctrl.val(e))},I.prototype.getValue=function(){var e=this.$super.getValue.call(this);return null===e?null:(this.editingGrid&&(e=this.format.GetFormatedValue(e)),e)},I.prototype.getDisplay=function(){return this.ctrl.val()},t.Utility.inheritPrototype(D,r),D.prototype.setValue=function(e){if(this.oldValue!=e){if(this.settingValue=!0,this.oldValue=e,this.value=e,null==e)return this.lastDisplay="",this.ctrl.val(""),void(this.settingValue=!1);if(null==this.lookup)return this.ctrl.val(e.toString()),this.lastDisplay=e.toString(),void(this.settingValue=!1);this.lastDisplay=this.lookup.getDisplay(e),this.lastDisplay.equals("<-1>")&&(this.lastDisplay="",this.oldValue=null,this.value=null),this.value=e,this.ctrl.val(t.Utility.decodeText(this.lastDisplay)),this.settingValue=!0}},D.prototype.getValue=function(){return this.value},D.prototype.getDisplay=function(){return null==this.lookup?this.value:this.lookup.getDisplay(this.value)},t.Utility.inheritPrototype(w,r),w.prototype.getOnlyWarehouseID=function(){var e=t.Env.getCtx();if("572"==e.getContext(this.windowNum,"0|AD_Table_ID",!0))return 0;var i=e.getContext(this.windowNum,"M_Warehouse_ID",!0),n=0;try{null!=i&&i.length>0&&(n=Number(i))}catch(e){}return n},w.prototype.getOnlyProductID=function(){var e=t.Env.getCtx();if("572"==e.getContext(this.windowNum,"0|AD_Table_ID",!0))return 0;var i=e.getContext(this.windowNum,"M_Product_ID",!0),n=0;try{null!=i&&i.length>0&&(n=Number(i))}catch(e){}return n},w.prototype.showLocatorForm=function(e,i){var n=0;null!=this.value&&(n=Number(this.value)),this.lookup.setOnlyWarehouseID(e),this.lookup.setOnlyProductID(i);var a="Y".equals(t.context.getWindowContext(this.windowNum,"IsReturnTrx")),s=t.Env.getCtx().isSOTrx(this.windowNum),l=(s&&!a||!s&&a)&&"M_Locator_ID"==this.columnName;this.lookup.setOnlyOutgoing(l),this.lookup.refresh(),self=this;var o=new t.LocatorForm(this.columnName,this.lookup,n,this.mandatory,e,this.windowNum);o.load(),o.showDialog(),o.onClose=function(e){if(self.oldValue!=e){self.setValue(e);var t={newValue:e,propertyName:self.columnName};self.fireValueChanged(t),t=null}}},w.prototype.setValue=function(e){if(this.oldValue!=e){if(this.settingValue=!0,this.oldValue=e,this.value=e,null==e)return this.lastDisplay="",this.ctrl.val(""),void(this.settingValue=!1);if(null==this.lookup)return this.ctrl.val(e.toString()),this.lastDisplay=e.toString(),void(this.settingValue=!1);this.lastDisplay=this.lookup.getDisplay(e),this.lastDisplay.equals("<-1>")&&(this.lastDisplay="",this.oldValue=null,this.value=null),this.value=e,this.ctrl.val(this.lastDisplay),this.settingValue=!0}},w.prototype.getValue=function(){return this.value},w.prototype.getDisplay=function(){return null==this.lookup?this.value:this.lookup.getDisplay(this.value)},t.Utility.inheritPrototype(b,r),b.prototype.setValue=function(e){null!=e&&0!==e||(this.ctrl.text(""),this.value=e),this.value=e,this.ctrl.val(this.lookup.getDisplay(e))},b.prototype.setField=function(e){null!=e&&(this.windowNo=e.getWindowNo(),this.AD_Column_ID=e.getAD_Column_ID()),this.mField=e},b.prototype.getValue=function(){return this.value},b.prototype.genSetInstanceIDs=function(){return this.setInstanceIDs},b.prototype.getDisplay=function(){return this.ctrl.val()},b.prototype.getCanSaveRecord=function(){return this.canSaveRecord},b.prototype.setCanSaveRecord=function(e){return this.canSaveRecord=e},t.Utility.inheritPrototype(C,r),C.prototype.setValue=function(e){this.oldValue!=e&&(this.oldValue=e,this.value=e,this.ctrl.val(this.lookup.getDisplay(e)))},C.prototype.getValue=function(){return this.value},C.prototype.getDisplay=function(){return this.ctrl.val()},t.Utility.inheritPrototype(_,r),_.prototype.setValue=function(e){if(this.oldValue!=e){if(this.oldValue=e,this.value=e,null==e)return this.setIcon(null),this.value=0,void(this&&this.ctrl.val(null));this.refreshImage(e)}},_.prototype.refreshImage=function(i){var n=this;e.ajax({url:t.Application.contextUrl+"VImageForm/GetImageAsByte",dataType:"json",data:{ad_image_id:i},success:function(e){(e=JSON.parse(e))?n.setIcon(e.Bytes,e.Path):n.setIcon(null,null),n.ctrl.val(i),n=null}})},_.prototype.setReadOnly=function(e){this.isReadOnly=e,this.isLink?this.ctrl.css("opacity",e?.6:1):this.ctrl.prop("disabled",!!e),this.setBackground(!1)},_.prototype.getValue=function(){return this.value},_.prototype.getDisplay=function(){return this.value},t.Utility.inheritPrototype(S,r),S.prototype.setValue=function(e){if(this.oldValue!=e)if(this.oldValue=e,null==e)this.setText("-"),this.value=e,this.ctrl.val(e);else{var t="?";if(e.length>0)t="#"+e.length;else t=e.GetType().FullName;this.setText(null!=t?t:""),this.value=e,this.ctrl.val(e)}},S.prototype.setReadOnly=function(e){this.isReadOnly=e,this.ctrl.prop("disabled",!!e),this.setBackground(!1)},S.prototype.getValue=function(){return this.value},S.prototype.getDisplay=function(){return this.value},t.Utility.inheritPrototype(x,r),x.prototype.setValue=function(e){if(this.oldValue!=e){if(this.oldValue=e,this.value=e,null==e)return this.lastDisplay="",void this.ctrl.val("");this.value=e,this.ctrl.val(e),this.ctrl.val(e)}},x.prototype.getValue=function(){return this.value},x.prototype.getDisplay=function(){return this.ctrl.val()},t.Utility.inheritPrototype(A,r),A.prototype.setValue=function(e){this.oldValue!=e&&(this.oldValue=e,this.value=e,this.ctrl.val(e))},A.prototype.setReadOnly=function(e){this.isReadOnly=e,this.ctrl.prop("disabled",!!e),this.setBackground(!1)},A.prototype.getValue=function(){return this.value},A.prototype.getDisplay=function(){return this.value},t.Utility.inheritPrototype(T,r),T.prototype.setValue=function(e,t){if(this.oldValue!=e){if(this.settingValue=!0,this.oldValue=e,this.value=e,null==e)return this.lastDisplay="",this.ctrl.val(""),void(this.settingValue=!1);if(null==this.lookup)return this.ctrl.val(e.toString()),this.lastDisplay=e.toString(),void(this.settingValue=!1);if(this.lastDisplay=this.lookup.getDisplay(e),this.lastDisplay&&this.lastDisplay.equals("<-1>")&&(this.lastDisplay="",this.oldValue=null,this.value=null),this.lastDisplay&&this.lastDisplay.indexOf("<")>-1?this.value=this.lastDisplay:this.value=e,this.lastDisplay){var i=this.format.GetFormatedValue(this.lastDisplay);this.ctrl.val(this.format.GetFormatAmount(i,"init",this.dotFormatter))}this.settingValue=!0}},T.prototype.getValue=function(){return this.value},T.prototype.getDisplay=function(){return null==this.lookup?this.value:this.lookup.getDisplay(this.value)},t.Utility.inheritPrototype(V,r),V.prototype.setValue=function(e,i,n){if(this.oldValue!=e){if(this.settingValue=!0,this.oldValue=e,this.value=e,null==e){if(this.lastDisplay="",this.ctrl.val(""),this.settingValue=!1,n){var a={newValue:e,propertyName:this.getName()};this.fireValueChanged(a),a=null}return}if(null==this.lookup)return this.ctrl.val(e.toString()),this.lastDisplay=e.toString(),void(this.settingValue=!1);this.lastDisplay=this.lookup.getDisplay(e),this.lastDisplay.equals("<-1>")&&(this.lastDisplay="",this.oldValue=null,this.value=null),this.lastDisplay.indexOf("<")>-1?this.value=this.lastDisplay:this.value=e,this.ctrl.val(t.Utility.decodeText(this.lastDisplay)),this.settingValue=!0}},V.prototype.getValue=function(){return this.value},V.prototype.getDisplay=function(){return null==this.lookup?this.value:this.lookup.getDisplay(this.value)},t.Utility.inheritPrototype(N,r),N.prototype.setValue=function(i,n,a){var s=null,l=[];if(this.needtoParse)if(a&&!e.isEmptyObject(a)){l=t.Env.parseSQLFromRecords(this.colSql,a);for(var o=0;o<l.length>0;o++)this.colSql=this.colSql.replace("@"+l[o].Key+"@",l[o].Value);s=this.colSql}else l=t.Env.parseContext2(t.context,this.windowNo,0,this.colSql,!1,!0),s=t.Env.parseContext(t.context,this.windowNo,0,this.colSql,!1,!0);else s=this.colSql;if(s&&0!=s.length){var r="-1",d=s.toUpperCase().lastIndexOf("WHERE");if(d>-1&&(r=s.substring(d)),this.cache[r])this.ctrl.text(this.cache[r]),n&&this.ctrl.html(this.cache[r]);else{if(-1==s.toLowerCase().indexOf("select"))return this.cache[r]=s,void this.ctrl.text(s);var c=this;e.ajax({type:"Post",url:t.Application.contextUrl+"Form/GetKeyText",data:{Validation:JSON.stringify(l),AD_HeaderItem_ID:c.headerItemID},success:function(e){var i=JSON.parse(e);i||0==i?(c.frmat&&(i=c.frmat.GetFormatAmount(c.frmat.GetFormatedValue(i),"init",t.Env.isDecimalPoint())),c.ctrl.text(i)):c.ctrl.text(""),c.isExe||(c.cache[r]=i)}})}}},N.prototype.getValue=function(){return null!=this.value?this.ctrl.text().toString():null},t.Utility.inheritPrototype(M,r),M.prototype.setValue=function(e){this.oldValue!=e&&(this.oldValue=e,this.setText(e),this.setRange(e))},M.prototype.getValue=function(){return this.getRange()},M.prototype.setMaxValue=function(t){e.isNumeric(t)?this.rangeCtrl.attr("max",t):this.rangeCtrl.attr("max",100)},M.prototype.setMinValue=function(t){e.isNumeric(t)&&this.rangeCtrl.attr("min",t)},M.prototype.getDisplay=function(){return this.rangeCtrl.val()},M.prototype.getControl=function(e){return e?(e.addClass("vis-progressCtrlWrap"),e.append(this.oputput),this.rangeCtrl):this.ctrl},M.prototype.setReadOnly=function(e){this.isReadOnly=e,this.ctrl.find("input").prop("disabled",!!e),this.ctrl.find("output").attr("contenteditable",!e),this.setBackground(!1)},M.prototype.setHtmlStyle=function(e){e&&this.dynStyle!=e?(e.contains(":")?(this.dynStyle||(this.oldStyle=this.ctrl.find("input").attr("style")),this.ctrl.find("input").removeAttr(e).attr("style",e),this.ctrl.find("output").removeAttr(e).attr("style",e)):(this.ctrl.find("input").addClass(e),this.ctrl.find("output").addClass(e)),this.dynStyle=e):!e&&this.dynStyle&&(this.dynStyle.contains(":")?(this.ctrl.find("input").removeAttr("style"),this.ctrl.find("output").removeAttr("style"),this.oldStyle&&(this.ctrl.find("input").attr("style",this.oldStyle),this.ctrl.find("output").attr("style",this.oldStyle))):(this.ctrl.find("input").removeClass(this.dynStyle),this.ctrl.find("output").removeClass(this.dynStyle)),this.oldStyle=null,this.dynStyle=null)},t.Utility.inheritPrototype(k,r),k.prototype.setReadOnly=function(e,t){e||!this.obscureType||t||this.mField.getIsInserting()&&""==this.ctrl.val()||(e=!0),this.isReadOnly=e,this.ctrl.prop("disabled",!!e),this.setBackground(!1)},k.prototype.setValue=function(e){this.oldValue!=e&&(this.settingVal=!0,e?this.iti?this.iti.setNumber(e):this.ctrl.val(e):(this.iti?this.iti.setNumber(""):this.ctrl.val(""),this.setCountry()),this.settingVal=!1,this.oldValue=e)},k.prototype.getDisplay=function(){return this.getValue()},k.prototype.getValue=function(){return this.iti?this.iti.getNumber():this.ctrl.val()},k.prototype.init=function(){this.iti=window.intlTelInput(this.ctrl[0],{initialCountry:"auto",separateDialCode:!0,autoPlaceholder:"aggressive",formatOnDisplay:!0,geoIpLookup:function(e,t){window.geoplugin_countryCode?e(geoplugin_countryCode()):e("IN")},utilsScript:n+"Areas/ViennaBase/Scripts/tel_Input/utils.js?1638200991544"})},k.prototype.getControl=function(e){return e?(this.isMasked||(this.ctrl.mask("Z0000000000000000",{translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},Z:{pattern:/[+]/,optional:!0}}}),this.isMasked=!0),this.ctrl):this.ctrl},k.prototype.setCountry=function(){this.iti&&(window.geoplugin_countryCode?this.iti.setCountry(geoplugin_countryCode()):this.iti.setCountry("IN"))},k.prototype.getSelectedCountryData=function(){return this.iti?this.iti.getSelectedCountryData():{dialCode:"+91",iso2:"en"}},k.prototype.detach=function(){this.prnt.detach()},t.Utility.inheritPrototype(O,r),O.prototype.setValue=function(e){this.oldValue!=e&&(this.ctrl.val(e),this.oldValue=e)},t.Controls.IControl=r,t.Controls.VTextBox=d,t.Controls.VLabel=c,t.Controls.VButton=u,t.Controls.VCheckBox=g,t.Controls.VComboBox=h,t.Controls.VTextBoxButton=f,t.Controls.VTextArea=m,t.Controls.VAmountTextBox=y,t.Controls.VNumTextBox=I,t.Controls.VLocation=D,t.Controls.VDate=v,t.Controls.VLocator=w,t.Controls.VAccount=C,t.Controls.VPAttribute=b,t.Controls.VImage=_,t.Controls.VBinary=S,t.Controls.VFile=A,t.Controls.VAmtDimension=T,t.Controls.VProductContainer=V,t.Controls.VKeyText=N,t.Controls.VProgressBar=M,t.Controls.VSpan=p,t.Controls.VTelePhone=k,t.Controls.VColor=O,t.Controls.VURL=x,t.VTelePhoneInstance=(i=null,{getHtml:function(n,a){if(function(){if(!i){var n=new t.Controls.VTelePhone("Mobile",!1,!1,!0,20,20,"",null,!1),a=e("<div>").append(n.getControl());n.init(),a.hide(),e("body").append(a),i=n}}(),!n)return"";n.indexOf("+")<0&&i.setCountry(),i.setValue(n);var s=i.iti.getSelectedCountryData(),l=i.getDisplay();""==l&&(n.indexOf("+")<0&&(n="+"+s.dialCode+n),l=n);var o='<div style="display:flex"><div class="iti__selected-flag"><div class="iti__flag iti__'+s.iso2+'"></div><div/><div style="margin: 0 6px;';return a&&(o+="cursor: pointer;"),o+='"> '+l+"</div > </div>"}})}(jQuery,VIS)},6216:()=>{!function(e,t){var i=e.Application.contextUrl,n=i+"JsonData/GetGridWindow",a=i+"JsonData/InsertOrUpdateWRecords",s=i+"JsonData/DeleteWRecords",l=i+"JsonData/GetWindowRecords",o=i+"JsonData/GetWindowRecordsForTreeNode",r=i+"JsonData/GetFormInfo",d=i+"JsonData/GetProcessInfo",c=i+"JsonData/Process",p=i+"JsonData/ExecuteProcess",u=i+"JsonData/UpdateOrInsertPersonalLock",g=i+"JsonData/GetCardViewDetail",h={insertOrUpdateWRecord:function(e){var i=null;return t.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify(e)}).done((function(e){i=e})),i},getWindowJString:function(e,i){t.ajax({url:n,type:"GET",datatype:"json",async:!0,data:e}).done((function(e){i&&i(e)}))},deleteWRecords:function(e){return new Promise((function(i,n){var a=null;return t.ajax({url:s,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(e)}).done((function(e){i(a=e)})),a}))},getWindowRecords:function(i,n,a,s,o,r,d){var c={fields:n,sqlIn:i,rowCount:a,sqlCount:s,AD_Table_ID:o,obscureFields:r};t.ajax({url:l,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify(c)}).done((function(t){if(d){var i=JSON.parse(t),n=null,a=null,s=null;i&&(n=(new e.DB.DataSet).toJson(i.Tables),a=i.LookupDirect,s=i.CardViewTpl),d(n,a,s)}}))},getWindowRecordsForTreeNode:function(i,n,a,s,l,r,d,c){var p={fields:n,sqlIn:i,rowCount:a,sqlCount:s,AD_Table_ID:l,treeID:r,treeNodeID:d};t.ajax({url:o,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify(p)}).done((function(t){if(c){var i=null;t&&(i=(new e.DB.DataSet).toJson(t)),c(i)}}))},getWindowRecord:function(n,a,s){var l=null;return t.ajax({url:i+"JsonData/GetWindowRecord",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({sql:n,fields:a,obscureFields:s})}).done((function(t){t&&(l=(new e.DB.DataReader).toJson(t))})),l},updateInsertLocks:function(e,i,n,a){var s=null,l={AD_User_ID:e,AD_Table_ID:i,Record_ID:n,locked:a};return t.ajax({url:u,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify(l)}).done((function(e){s=e})),s},getFormDataString:function(e,i){t.ajax({url:r,type:"GET",datatype:"json",async:!0,data:e}).done((function(e){i&&i(e)}))},getProcessDataString:function(e,i){t.ajax({url:d,type:"GET",datatype:"json",async:!0,data:e}).done((function(e){i&&i(e)}))},process:function(e,i){var n=!!i,a=null;return t.ajax({url:c,type:"POST",datatype:"json",async:n,data:e}).done((function(e){a=e,i&&i(e)})),a},processAsyncFalse:function(e,i){t.ajax({url:c,type:"GET",datatype:"json",async:!1,data:e}).done((function(e){i&&i(e)}))},executeProcess:function(e,i){var n=!!i,a=null;return t.ajax({url:p,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:n,data:JSON.stringify(e)}).done((function(e){a=e,i&&i(e)})),a},updateClientCtx:function(e,n){t.ajax({url:i+"JsonData/UpdateCtx",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify({dCtx:e})}).done((function(e){n&&n(e)}))},getJSONRecord:function(i,n){var a=null;-1==i.indexOf(e.Application.contextUrl)&&(i=e.Application.contextUrl+i);var s=n;return("object"!=typeof n||null===n||Array.isArray(n))&&(s={fields:n}),t.ajax({url:i,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify(s)}).done((function(e){e&&(a=JSON.parse(e))})).fail((function(e,t,i){alert(i)})),a},getJSONData:function(e,i,n){var a=!!n,s=null;return t.ajax({url:e,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(i)}).done((function(e){e&&(s=e,"string"==typeof e&&(s=JSON.parse(e))),a&&n(s)})),s},subscribeUnsubscribeRecords:function(i,n,a,s,l){var o,r;0==i?(o=e.Application.contextUrl+"Subscribe/Subscribe",r={AD_Window_ID:n,Record_ID:a,AD_Table_ID:s}):(o=e.Application.contextUrl+"Subscribe/UnSubscribe",r={AD_Window_ID:n,Record_ID:a,AD_Table_ID:s}),t.ajax({url:o,type:"GET",dataType:"Json",data:r,success:function(t){0==t?0==i?e.ADialog.error("SubscriptionFailed"):e.ADialog.error("UnSubscriptionFailed"):2==t&&e.ADialog.info("AlreadyUnsubscribed"),l()},error:function(t){e.ADialog.error(e.Msg.getMsg("Error")+t.statusText)}})},getChatRecords:function(i,n){t.ajax({url:e.Application.contextUrl+"Chat/LoadChat",data:i,type:"GET",cache:!1,datatype:"Json",success:function(e){n&&n(e)}})},saveChat:function(i){t.ajax({url:e.Application.contextUrl+"Chat/SaveChat",type:"POST",dataType:"Json",data:i,success:function(e){e?console.log("Chat Saved"):console.log("Chat Not Saved")},error:function(e){console.log("Chat Not Saved")}})},getTreeAsString:function(e,n){var a=null,s=!!n;return t.ajax({url:i+"Tree/GetTreeAsString",async:s,data:e}).done((function(e){a=e,n&&n(e)})),a},getCardViewInfo:function(e,i,n,a,s){var l={AD_Window_ID:e,AD_Tab_ID:i,AD_CardView_ID:n,SQL:a};t.ajax({url:g,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify(l)}).done((function(e){if(s){var t=null;e&&(t=e,"string"==typeof e&&(t=JSON.parse(e))),s(t)}}))},postJSONData:function(e,i,n){var a=!!n,s=null;return t.ajax({url:e,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:a,data:JSON.stringify(i)}).done((function(e){e&&(s=e,"string"==typeof e&&(s=JSON.parse(e))),a&&n(s)})),s}};e.dataContext=h}(VIS,jQuery)},1105:()=>{!function(e){e.desktopMgr=function(){var t=null,i=null,n={},l=[],o=!1,r=$("#vis_home"),d=($("#vis_mainSection"),$("#vis_mainConatiner")),c=$("#vis_taskbar"),p=$("#vis_appMenu"),u=$("#vis_mainMenu"),g=$("#vis_closeMenu"),h=$("#vis_cloud_daysleft"),v=$("#vis_menuSearch"),f=$("#vis_divTree"),m=$("#vis_menuOverlay"),y=$(".vis-app-footer-c-r"),I=null,D=null;function w(t){window.setTimeout((function(){$.ajax({url:e.Application.contextUrl+"Account/Refresh",complete:function(){w(180)}})}),1e3*t)}function b(){s.closePopup(),u.attr("style","display: none !important"),m.fadeOut(),v.val(""),v.blur()}function C(){var t=0;t=(e.Application.isMobile||e.Application.isIOS)&&document.documentElement?document.documentElement.clientHeight:window.innerHeight,t-=23,e.Utility.Util.getValueOfInt(e.context.ctx["#FRAMEWORK_VERSION"])<2&&(t-=43),e.Env.setScreenHeight(t),document.documentElement.style.setProperty("--vis-screen-height",.01*t+"px"),e.viewManager&&e.viewManager.sizeChanged(t,window.innerwidth)}function _(t,i){e.viewManager.startAction(t,i),b()}function S(e){if(e.length>0){if("vis_lhome"==e[0].id)return;D&&D.removeClass("vis-app-f-selected"),D=e.addClass("vis-app-f-selected"),e=null}}function x(t){i?i.hide():d.children("div").hide(),n[t]&&((i=n[t]).css({opacity:0}),i.show().animate({opacity:1},500,"linear",(function(){e.viewManager.resize(t)}))),-1!=l.indexOf(t)&&l.splice(l.indexOf(t),1),l.push(t),b()}return C(),function(){y.on("click",(function(){e.UserSession.show()})),m.on(e.Events.onTouchStartOrClick,(function(e){e.preventDefault(),b()}));var t=Date.now();function i(i){(d=$(i.target)).hasClass("fa fa-arrow-left")&&(d=d.parent());var n=d.parent();if(d.hasClass("vis-menuitm-backbtn"))d.closest("ul").css("display","none"),u.find(".vismenu-parent").show(),f.find(".vismenu-selectedMbTab").removeClass("vismenu-selectedMbTab"),f.find('[data-val="'+n.data("ulid")+'"]').siblings().show(),f.find('[data-val="'+n.data("ulid")+'"]').show(),f.find("ul:not(.vismenu-parent)").hide(),f.find("li:not(.vis-hasSubMenu)").hide(),s&&s.setIsMenuHeaderClicked(!1);else if("LABEL"===i.target.nodeName&&"Y"==n.data("con")){var a=n.data("val");if(!s)return;o=s.getFilterValue(),s.setIsMenuHeaderClicked(!1);var l=f.find('[data-ulid="'+a+'"]');l.css("display","flex").addClass("vismenu-selectedMbTab"),l.find("ul").css("display","block"),l.find("li").hide(),l.find(".vis-subNavFirstElement").show(),l.find(".vis-menu-innerFolders").show(),l.find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),"A"!=o?l.find('li > a[data-action="'+o+'"]').parent().css("display","flex"):l.find("li:not(.vis-menusubItem)").css("display","flex"),u.find(".vismenu-parent").hide(),s.hideMobileEmptyFolder(),"Y"==n.data("summary")?(n.siblings().hide(),n.hide()):(n.parent().siblings().hide(),n.hide())}else{if("LABEL"===i.target.nodeName){if(Date.now()-t<300)return i.preventDefault(),i.stopPropagation(),void(t=Date.now());t=Date.now()}if("A"===i.target.nodeName){if("yes"==(d=$(i.target)).data("isfavbtn"))return void e.FavouriteHelper.showOverlay(d);if("Y"==d.data("summary")){var o;o=s?s.getFilterValue():null,u.find(".vis-navmenuItems-Container").hide(),d.parent().siblings().removeClass("vis-navSelected"),d.parent().addClass("vis-navSelected");var r=u.find("#Menu"+d.data("value"));return r.removeAttr("style"),r.find(".vis-menuSum-hide").removeClass("vis-menuSum-hide"),f.find(".vismenu-hidden-header").hide(),f.find(".vis-nav-AllItems").hide(),f.find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),null!=o&&("A"!=o?f.find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):f.find(".fa-minus").removeClass("fa-minus").addClass("fa-plus")),r.find(".vismenu-subSummaryNode").css("display","none"),void(s&&s.hideEmptyFolders())}return void _(d.data("action"),d.data("actionid"))}if("I"===i.target.nodeName){var d;if((d=$(i.target)).hasClass("vis-navAccordian")){if(d.hasClass("fa-plus")){d.removeClass("fa-plus").addClass("fa-minus");var c=d.data("pid");f.find('[data-ulid="'+c+'"]').show()}else{d.removeClass("fa-minus").addClass("fa-plus");c=d.data("pid");f.find('[data-ulid="'+c+'"]').hide()}return}if("yes"==(d=d.parent()).data("isfavbtn"))return void e.FavouriteHelper.showOverlay(d)}}}f.on("click",(function(e){i(e)})),f.on("keyDown",(function(e){13==e.which&&i(e)})),$(f.find(".vis-navLeftWrap a")[0]).trigger("click"),c.on(e.Events.onClick,"LI",(function(t){if(t.preventDefault(),"I"===t.target.nodeName||"SPAN"===t.target.nodeName)return i=$(t.currentTarget),void(l[l.length-1]==i[0].id?e.viewManager.closeFrame(i[0].id):(x(i[0].id),S(i)));var i,n=null;"LI"===t.target.nodeName?n=$(t.target):"LI"===t.target.parentNode.nodeName&&(n=$(t.target.parentNode)),n&&(x(n[0].id),S(n)),n=null})),p.on("click",(function(t){e.MRole.getIsDisableMenu()||(t.preventDefault(),window.setTimeout((function(){v.focus(),$("#vis_divTree").on("focus","li",(function(e){var t=$(e.target);$(t).off("keydown"),$(t).on("keydown",(function(e){"Enter"==e.key&&(t.siblings("label").length>0&&$(t.siblings("label")).trigger("click"),t.siblings("a").length>0&&$(t.siblings("label")).trigger("a"))})),$(t.siblings("label")).css("border","1px solid rgba(var(--v-c-primary), 1)")})),$("#vis_divTree").on("focusout","li",(function(e){var t=$(e.target);$(t.siblings("label")).css("border","1px solid white")}))}),2),m.fadeIn(),u.attr("style","display: block !important"))})),g.on("click",(function(e){e.preventDefault(),b()})),o&&v.bind("input",(function(){!function(e,t){if(""===e||e.length<1)return;for(var i=0;i<t.options.length;i++)if(t.options[i].value===e){var n=$(t.options[i]);_(n.data("action"),n.data("actionid")),v.val("");break}}(v.val(),this.list)})),$("#visMarket").click((function(){(new(e.Utility.getFunctionByName("Market.ImpModule.Market_",window))).show()})),$(window).resize(C),window.onbeforeunload=function(t){$.ajax({url:e.Application.contextUrl+"Account/LogOffHandler",type:"POST"})},w(1)}(),e.Application.contextFullUrl.toLower().indexOf("softwareonthecloud.com")>-1?$.ajax({url:e.Application.contextUrl+"home/GetSubscriptionDaysLeft/",success:function(t){var i=JSON.parse(t);i&&("True"==i||""==i?h.css("display","none"):i>1?h.text(e.Msg.getMsg("VIS_TrialPeriod")+": "+i+" "+e.Msg.getMsg("VIS_TrialDaysLeft")):1==i&&h.text(e.Msg.getMsg("VIS_TrialPeriod")+": "+i+" "+e.Msg.getMsg("VIS_TrialDayLeft")))},error:function(e){h.css("display","none")}}):h.css("display","none"),{startMenuAction:_,getMainConatiner:function(){return d},toggleContainer:x,registerView:function(e,t){return n[e]=t,l.push(e),x(e),t},unRegisterView:function(e){c.find("LI#"+e).remove(),n[e],n[e]=null,delete n[e],l.pop();var t="";return x(t=l.length>0?l[l.length-1]:"vis_lhome"),S(c.find("LI#"+t)),!0},addTaskBarItem:function(e,t,i){var n=["<li id="+e+">"];t&&(t.indexOf(".")>-1?n.push('<img src= "'+t+'" />'):n.push('<i class= "'+t+'" />')),n.push("<a>"+i+'</a><span style="padding:0 7px;"><i class="fa fa-times-circle-o" /></span></li>');var a=$(n.join(" "));c.append(a),S(a),a=null},start:function(){var l,d,c;c=[],o||(d=v.attr("list"),(l=$("#"+d)).length>0&&(c=[],l.find("option").each((function(){c.push({label:this.value,value:this.value,action:$(this).data("action"),id:$(this).data("actionid")})})),v.autocomplete({source:c,open:function(){window.setTimeout((function(){$(".ui-autocomplete").css("z-index",1e3);var e=60*window.innerHeight/100;$(".ui-autocomplete").css("max-height",e)}))},select:function(e,i){t=i.item},close:function(e,i){t&&t.id&&t.action&&(_(t.action,t.id),v.val("")),t=null}})),l.remove()),s.init(f,$("#vis_filterMenu"),u),a.init($("#vis_home_ca"),$("#vis_userName")),function(){e.MRole.getIsDisableMenu()||($("#vis_lhome").show(),n.vis_lhome=r,i=r.show(),e.HomeMgr.initHome(r));e.MRole.getIsDisableMenu()&&($(".vis-topMenu").hide(),$(".vis-menuHeaderLogo").show());var t=e.MRole.getHomePage();t&&parseInt(t)>0&&_("X",t)}(),historyMgr.restoreHistory(),window.addEventListener("DOMContentLoaded",e.sseManager.start,!1)},activateTaskBarItemUsingID:function(e){var t=e.data("wid");S(c.find("LI#"+t))},openMenu:function(){p.trigger("click")},closeMenu:function(){g.trigger("click")},getNavSection:function(){return I||(I=$(".vis-app-action-nav")),I},getMenuDiv:function(){return p}}}();var t,i,n,a=function(){var t,i,n,a,s,l,o,r,d,c,p,u,g,h,v,f,m,y,I=!1,D=!1,w="",b=$('<div class="vis-wakeup-main" >').hide();function C(){b.show(),o.show("slideDown"),r.prop("disabled",!1),d.prop("disabled",!0)}function _(e){return I&&(i.val(c),n.html(p),a.html(u),s.html(g),"-1"==h.val()&&s.val(null),d.prop("disabled",!0),T(t,[]),I=!1),b.hide(),o.hide("slideUp"),e.preventDefault(),!1}function S(e,t,s){""!=s.client&&""!=s.id&&$.ajax(t,{data:s}).success((function(t){!function(e,t){D=!0,e.empty();var s=Globalize.localize("SelectWarehouse");e===i?s=Globalize.localize("SelectRole"):e===n?s=Globalize.localize("SelectClient"):e===a&&(s=Globalize.localize("SelectOrg"));$("<option />",{val:"-1",text:s}).appendTo(e),$(t).each((function(){$("<option />",{val:this.Key,text:this.Name}).appendTo(e)})),D=!1}(e,t.data)})).fail((function(e){alert(e)}))}function x(){if(!D){I||(I=!0,d.prop("disabled",!1)),combo=this,combo.id===i.attr("id")?(n.empty(),a.empty(),s.empty(),S(n,w+"Account/GetClients",{Id:combo.value})):combo.id===n.attr("id")?(a.empty(),s.empty(),S(a,w+"Account/GetOrgs",{role:i.val(),user:e.context.getAD_User_ID(),client:combo.value})):combo.id===a.attr("id")?(s.empty(),S(s,w+"Account/GetWarehouse",{id:a.val()})):(combo.id,s.attr("id"));var t=$("#"+combo.id+"Name"),l=this.options[this.selectedIndex].innerHTML;t.val(l)}}function A(e){var t=$(this);T(t,[]),r.prop("disabled",!0),d.prop("disabled",!0),t.find("#vis_home_langugage").val(localStorage.getItem("vis_login_langCode")),t.valid&&!t.valid()||$.post(t.attr("action"),t.serializeArray()).done((function(e){(e=e||{}).success?(window.location=e.redirect||location.href,-1!=window.location.href.indexOf("#")&&location.reload()):e.errors&&(T(t,e.errors),r.prop("disabled",!1),d.prop("disabled",!1))})).error((function(){T(t,["An unknown error happened."]),r.prop("disabled",!1),d.prop("disabled",!1)})),e.preventDefault()}var T=function(e,t){var i,n=(i=e,i.find(".validation-summary-errors, .validation-summary-valid")).removeClass("validation-summary-valid").addClass("validation-summary-errors"),a=$.map(t,(function(e){return"<li>"+Globalize.localize(e)+"</li>"})).join("");n.find("ul").empty().append(a)};return{init:function(I,D){I.remove(),l=D,o=I,t=I.find("#vis_changeAuthForm"),i=I.find("#vis_home_role"),n=I.find("#vis_home_client"),a=I.find("#vis_home_org"),s=I.find("#vis_home_warehouse"),h=I.find("#vis_home_warehouseId"),r=I.find("#vis-auth-close"),d=I.find("#vis-auth-change"),v=I.find('label[for="Login2Model_Role"]'),f=I.find('label[for="Login2Model_Client"]'),m=I.find('label[for="Login2Model_Org"]'),y=I.find('label[for="Login2Model_Warehouse"]'),c=i.val(),p=n.html(),u=a.html(),g=s.html(),l.on("click",C),b.on("click",_),r.on("click",_),i.on("change",x),n.on("change",x),a.on("change",x),s.on("change",x),t.submit(A),$("body").append(b),$("body").append(o),w=e.Application.contextUrl,v.text(Globalize.localize("Role")),f.text(Globalize.localize("Client")),m.text(Globalize.localize("Organization")),y.text(Globalize.localize("Warehouse")),d.val(e.Msg.getMsg("Change")),r.val(e.Msg.getMsg("Close")),"-1"==h.val()&&s.val(null)}}}(),s=function(){var t=null,i=null,n=!1,a=null,s=null,l=!1,o=null,r=$('<div class="vis-dialog vis-filter-dialog">');function d(e){var i=[];t=a.find(".vis-navMainContent");for(var n=a.find(".vismenu-hidden-header"),s=0;s<n.length;s++)itm=$(n[s]),i.push(itm[0].outerHTML);return i}function c(e){if("A"!=r.find("input[type=radio]:checked").val()){if(a.find(".vismenu-parent").is(":visible"))return;var t=a.find(".vismenu-selectedMbTab"),i=[];t&&t.length>0?(i=t.find("ul"),t.find(".vis-menuSum-hide").removeClass("vis-menuSum-hide")):(i=a.find("ul"),a.find(".vis-menuSum-hide").removeClass("vis-menuSum-hide"));for(var n=0;n<i.length;n++){if(!(c=$(i[n])).hasClass("vismenu-parent")){for(var s=c.find("li"),o=!1,d=0;d<s.length;d++){if($(s[d]).is(":visible")&&!$(s[d]).hasClass("vis-menu-innerFolders")){o=!1;break}o=!0}o&&(c.addClass("vis-menuSum-hide"),c.css("display",""),c.parent().css("display",""))}}t&&t.length>0&&!l?i=t.find(".vis-menuitm-backbtn"):(i=a.find(".vis-menuitm-backbtn"),t=null);for(n=0;n<i.length;n++){var c;for(s=(c=$(i[n]).parent()).siblings(),o=!1,d=0;d<s.length;d++){if($(s[d]).is(":visible")){o=!1;break}o=!0}o&&(null==t||0==t.length||l)&&(c.css("display",""),c.addClass("vis-menuSum-hide"))}}}function p(){if("A"!=r.find("input[type=radio]:checked").val()){var e=t.find(".vis-navmenuItems-Container").find("ul");t.find(".vis-menuSum-hide").removeClass("vis-menuSum-hide"),t.find(".vismenu-subSummaryNode").css("display","");for(var i=0;i<e.length;i++){for(var n=$(e[i]),a=n.find("li"),s=!1,l=0;l<a.length;l++){if($(a[l]).is(":visible")){s=!1;break}s=!0}s&&n.closest(".vis-navSubMenu").addClass("vis-menuSum-hide")}e=t.find(".vis-navmenuItems-Container-allItems");for(i=0;i<e.length;i++){s=!1;if((a=$(e[i]).find(".vis-navSubMenu")).length>0)for(l=0;l<a.length;l++){if(!$(a[l]).hasClass("vis-menuSum-hide")){s=!1;break}s=!0}for(a=$(e[i]).find("li"),l=0;l<a.length;l++){if($(a[l]).is(":visible")){s=!1;break}s=!0}s&&$(e[i]).addClass("vis-menuSum-hide")}}else t.find(".vis-menuSum-hide").removeClass("vis-menuSum-hide")}function u(){n=!n;var t=Math.round(o.find(".vis-navFilterIco").offset().left)-84;e.Application.isRTL&&r.css("right","auto"),r.css("left",t),n?r.show("slide-down"):r.hide("slide-up")}function g(){return r.find("input[type=radio]:checked").val()}function h(e){l=e}function v(){n&&u()}return{init:function(n,f,m){var y;r.html('<input type="radio" name="filter" id="vis_filter_radio_1" value="A" checked style="margin-bottom:5px;margin:1px;" /><label for="vis_filter_radio_1">'+e.Msg.getMsg("All")+'</label><br><input type="radio" name="filter" id="vis_filter_radio_2" value="W" style="margin-bottom:5px;margin:1px;" /><label for="vis_filter_radio_2">'+e.Msg.getMsg("Window")+'</label><br><input type="radio" name="filter" id="vis_filter_radio_3" value="X" style="margin-bottom:5px;margin:1px;"/><label for="vis_filter_radio_3">'+e.Msg.getMsg("Form")+'</label><br><input type="radio" name="filter" id="vis_filter_radio_4" value="P" style="margin-bottom:5px;margin:1px;"/><label for="vis_filter_radio_4">'+e.Msg.getMsg("Process")+'</label><br><input type="radio" name="filter" id="vis_filter_radio_5" value="R" style="margin-bottom:20px;margin:1px;"/><label for="vis_filter_radio_5">'+e.Msg.getMsg("Report")+'</label><br/><input type="button" name="filter" value='+e.Msg.getMsg("Filter")+"></input>"),o=m,a=n,y=d(),t.html(),y,i=f,$("body").append(r),function(){if((e.Application.isMobile||e.Application.isIOS)&&document.documentElement)return;var t=a.find(".vis-navmenuItems-Container");s=$("<div class='vis-nav-AllItems'></div>");for(var i=0;i<t.length;i++)s.append($(t[i]).clone().removeAttr("style").addClass("vis-navmenuItems-Container-allItems"));s.hide(),a.find(".vis-navMainContent").append(s)}(),function(){function t(){var t=r.find("input[type=radio]:checked").val();!function(t){if((e.Application.isMobile||e.Application.isIOS)&&document.documentElement){if(a.find(".vismenu-parent").is(":visible"))return;a.find(".vis-menuSum-hide").removeClass("vis-menuSum-hide"),"A"===t?a.find("li").show():(a.find("li").hide(),a.find(".vis-menu-innerFolders").show(),a.find(".vis-menuitm-backbtn").parent().show(),a.find('li > a[data-action="'+t+'"]').parent().show()),c()}else a.find(".vis-navSubMenu").removeClass("vis-menuSum-hide"),s.is(":visible")&&s.find(".vis-navMainContent").removeAttr("style"),"A"===t?a.find(".vis-navMainContent li").show():(a.find(".vis-navMainContent li").hide(),a.find('.vis-navMainContent li > a[data-action="'+t+'"]').parent().show()),p()}(t),"A"==t?(o.find(".vis-removeFilter").hide(),a.find(".vismenu-subSummaryNode").css("display","none"),(e.Application.isMobile||e.Application.isIOS)&&document.documentElement?l?(a.find(".vis-menusubItem").css("display",""),a.find(".fa-plus").removeClass("fa-plus").addClass("fa-minus")):(a.find(".vis-menusubItem").css("display","none"),a.find(".fa-minus").removeClass("fa-minus").addClass("fa-plus")):a.find(".fa-minus").removeClass("fa-minus").addClass("fa-plus")):(o.find(".vis-removeFilter").show(),a.find(".fa-plus").removeClass("fa-plus").addClass("fa-minus")),v()}i.on("click",u),r.on("click","input[type=button]",(function(e){e.stopPropagation(),t()})),o.find(".vis-removeFilter").on("click",(function(){r.find("#vis_filter_radio_1").prop("checked",!0),t()})),o.find(".vis-menu-headerName").click((function(){h(!0),function(){if((e.Application.isMobile||e.Application.isIOS)&&document.documentElement){var t=g();a.find("li").hide(),a.find(".vis-subNavFirstElement").show(),a.find(".vis-menu-innerFolders").show(),a.find("ul").show(),"A"==t?a.find("li").show():a.find('li > a[data-action="'+t+'"]').parent().show(),a.find(".vis-subNavFirstElement").css({position:"relative",top:"0px"}),a.find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),a.find(".vismenu-parent").hide(),c(!0)}else a.find(".vis-navmenuItems-Container").hide(),s.find(".vis-navmenuItems-Container").removeAttr("style"),s.find(".vismenu-hidden-header").show(),a.find(".vis-navSelected").removeClass("vis-navSelected"),s.show(),a.find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),s.find(".vismenu-subSummaryNode").css("display",""),p()}()}))}()},closePopup:v,hideEmptyFolders:p,getFilterValue:g,hideMobileEmptyFolder:c,setIsMenuHeaderClicked:h}}(),l=(t=$('<div class="vis-wakeup-main"></div><div class="vis-wakeup-outerwrap"><div class="vis-wakeup-content"><div class="vis-wakeup-headsec"></div><div class="vis-wakeup-datawrp"><strong>Oh no! Something went wrong</strong><div class="vis-wakeup-text"></div><button>Refresh</button></div></div></div></div>'),i=t.find("button"),t.find(".vis-wakeup-sleep"),t.find(".vis-wakeup-awake"),n=t.find(".vis-wakeup-text"),i.on("click",(function(){i.prop("disabled",!0),window.location.reload()})),{init:function(e){n.text(e),$("body").append(t)}}),o=!1;$(document).ajaxError((function(t,i){401===i.status?o||(l.init(e.Msg.getMsg("UnAuthorized")),o=!0):999===i.status?o||(l.init(e.Msg.getMsg("WakeupText")),o=!0):console.log(i.responseText)}))}(VIS)},4412:()=>{!function(e,t){e.FavouriteHelper=function(){var i,n,a,s,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=!1;function f(){l=t('<div style="width:100%;height:100%">'),o=t("<ul class='vis-apanel-rb-ul' style='width:100%;height:100%'>"),u=t("<li data-isfav='no' data-id='favaction'>").append(e.Msg.getMsg("AddFav")),g=t("<li data-isfav='yes' data-id='favaction'>").append(e.Msg.getMsg("RemoveFav")),h=t("<li data-isfav='"+d.data("isfav")+"' data-id='favaction'>").append(e.Msg.getMsg("OpenNewTab")),o.append(u),o.append(g),o.append(h),l.append(o),u.on("click",m),g.on("click",m),h.on("click",y)}function m(){var l;"yes"==s?(d.find("span").remove(),(l=t("#vis_divTree").find('[data-value="'+d.data("value")+'"]'))&&l.length>0&&(t(l[1]).find("span.fa.fa-star").length>0&&(t(l[1]).attr("data-isfav","no"),t(l[1]).find("span.fa.fa-star").remove()),e.Application.isMobile||e.Application.isIOS?t(l[5])&&(t(l[5]).attr("data-isfav","no"),t(l[5]).find("span.fa.fa-star").remove()):t(l[3])&&(t(l[3]).attr("data-isfav","no"),t(l[3]).find("span.fa.fa-star").remove())),d.attr("data-isfav","no"),function(i){t.ajax({url:e.Application.contextUrl+"Home/RemoveNodeFavourite/?nodeID="+i,dataType:"json"})}(r),e.favMgr.removeFavourite(r)):((c={}).Action=i,c.WindowID=n,c.FormID=n,c.ProcessID=n,c.NodeID=r,c.Name=a,d.attr("data-isfav","yes"),d.prepend('<span class="fa fa-star"></span>'),(l=t("#vis_divTree").find('[data-value="'+d.data("value")+'"]'))&&l.length>2&&(0==t(l[1]).find("span.fa.fa-star").length?(t(l[1]).prepend('<span class="fa fa-star"></span>'),t(l[1]).attr("data-isfav","yes")):e.Application.isMobile||e.Application.isIOS?(t(l[5]).prepend('<span class="fa fa-star"></span>'),t(l[5]).attr("data-isfav","yes")):(t(l[3]).prepend('<span class="fa fa-star"></span>'),t(l[3]).attr("data-isfav","yes"))),function(i){t.ajax({url:e.Application.contextUrl+"Home/SetNodeFavourite/?nodeID="+i,dataType:"json"})}(r),e.favMgr.addFavourite(c))}function y(){e.viewManager.startActionInNewTab(i,n)}return{removeFavourite:function(e){p||(p=t("#vis_divTree"));var i=p.children(0).find("[data-value='"+e+"']"),n=t(i.children()[1]);n.removeClass("vis-favitmchecked"),n.addClass("vis-favitmunchecked"),n.data("isfav","no")},showOverlay:function(e){r=(d=e).data("value"),i=d.data("action"),n=d.data("actionid"),a=d.data("name"),s=d.attr("data-isfav"),v||(f(),v=!0),"yes"==s?(u.css("display","none"),g.css("display","block")):(u.css("display","block"),g.css("display","none")),d.w2overlay(l.clone(!0),{css:{height:"300px"}})}}}()}(VIS,jQuery)},9508:()=>{!function(e,t){function i(i){var n,a,s;this.$parent,this.mPanel,this.ctx=e.Env.getCtx(),this.log=e.Logging.VLogger.getVLogger("VIS.AForm"),n=t("<div class='vis-height-full vis-app-aform-root' >"),a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),s=t("<div class='vis-height-full'>"),n.append(s).append(a),this.setSize=function(e,t){n.height(e),s.height(e)},this.setSize(i),this.getRoot=function(){return n},this.getContentGrid=function(){return s},this.setBusy=function(e,t){isLocked=e,a[0].style.visibility=e?"visible":"hidden"},this.disposeComponent=function(){n.remove(),n=null,s.remove(),s=null,a.remove(),a=null,this.$parentWindow=null,this.ctx=null,this.getRoot=null,this.getContentGrid=null,this.setBusy=null,this.setSize=null}}i.prototype.openForm=function(t,i,n,a){if(t.IsReport)return e.ADialog.info("Form Report is not supported"),!1;this.parent=i;var s="";s=t.Prefix+t.ClassName;try{var l=s.split(".");a=null,"react"==l[1].toLowerCase()&&(a=l[2],s=l[0]+"."+l[1]);var o=new(e.Utility.getFunctionByName(s,window))(n);o.init(n,this,a),this.mPanel=o,o=null}catch(i){return this.log.log(e.Logging.Level.WARNING,"Class="+s+", AD_Form Name="+t.Name,i),!1}return this.setBusy(!1),this.windowNo=n,this.setTitle(e.Env.getHeader(this.ctx,n)),this.parent.setName(t.DisplayName),i=null,!0},i.prototype.openWidget=function(t,i){try{var n=t.split(".");additionalInfo=null,"react"==n[1].toLowerCase()&&(additionalInfo=n[2],t=n[0]+"."+n[1]);var a=new(e.Utility.getFunctionByName(t,window))(i);a.init(i,this,additionalInfo),this.mPanel=a,a=null}catch(i){return this.log.log(e.Logging.Level.WARNING,"Class="+t,i),!1}this.setBusy(!1)},i.prototype.setTitle=function(t){this.parent&&this.parent.setTitle(e.Utility.Util.cleanMnemonic(t))},i.prototype.hideHeader=function(e){this.parent&&this.parent.hideHeader(e)},i.prototype.hideCloseIcon=function(e){this.parent&&this.parent.hideCloseIcon(e)},i.prototype.sizeChanged=function(e,t){this.setSize(e),this.mPanel&&this.mPanel.sizeChanged&&this.mPanel.sizeChanged(e,t)},i.prototype.refresh=function(){this.mPanel&&this.mPanel.refresh&&this.mPanel.refresh()},i.prototype.addChangeListener=function(e){this.mPanel&&this.mPanel.addChangeListener&&(this.listener=e,this.mPanel.addChangeListener(e))},i.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.mPanel&&(this.mPanel.disposeComponent&&this.mPanel.dispose(),this.mPanel=null),this.parent&&(this.parent.dispose(),this.parent=null),e.Env.clearWinContext(this.ctx,this.windowNo),this.disposeComponent())},e.AForm=i}(VIS,jQuery)},161:()=>{!function(e,t){e.TestForm=function(){var i,n,a,s;this.frame,this.windowNo,i=t("<div>"),n=t("<input type='text'>"),a=t("<input type='button'>").val("Show"),s=t("<input type='button'>").val("Close"),i.append(n).append(a).append(s);var l=this;a.on(e.Events.onTouchStartOrClick,(function(){var e=n.val();l.widgetFirevalueChanged(e)})),s.on(e.Events.onTouchStartOrClick,(function(){confirm("wanna close this form???")&&l.dispose()})),this.getRoot=function(){return i},this.disposeComponent=function(){l=null,i&&i.remove(),i=null,a&&a.off(e.Events.onTouchStartOrClick),s&&s.off(e.Events.onTouchStartOrClick),n=a=s=null,this.getRoot=null,this.disposeComponent=null}},e.TestForm.prototype.init=function(e,t){this.frame=t,this.frame.getContentGrid().append(this.getRoot())},e.TestForm.prototype.widgetFirevalueChanged=function(e){this.listener&&this.listener.widgetFirevalueChanged(e)},e.TestForm.prototype.addChangeListener=function(e){this.listener=e},e.TestForm.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.TestMsgForm=function(){var i,n,a,s;this.frame,this.windowNo,i=t("<div>"),n=t("<input type='text'>"),a=t("<input type='button'>").val("Start"),s=t("<input type='button' disable>").val("Stop"),i.append(n).append(a).append(s);var l=this;function o(e,t){e?(s.hide(),a.show(),n.css("color","red")):(s.show(),a.hide(),n.css("color","green")),n.val(t)}a.on(e.Events.onTouchStartOrClick,(function(){l.sendRequest(!1),o(!1,"started")})),s.on(e.Events.onTouchStartOrClick,(function(){l.sendRequest(!0),o(!0,"Stopped")})),this.getRoot=function(){return i},this.onmessage=function(e){"DEMOS"==e.Event?o(!1,e.Message):"DEMOE"==e.Event&&o(!0,e.Message)},this.disposeComponent=function(){l=null,i&&i.remove(),i=null,a&&a.off(e.Events.onTouchStartOrClick),s&&s.off(e.Events.onTouchStartOrClick),n=a=s=null,this.getRoot=null,this.disposeComponent=null}},e.TestMsgForm.prototype.init=function(t,i){this.frame=i,this.frame.getContentGrid().append(this.getRoot()),e.sseManager.register(this)},e.TestMsgForm.prototype.sendRequest=function(t){e.dataContext.postJSONData(e.Application.contextUrl+"Message/Demo",{IsStop:t},(function(e){}))},e.TestMsgForm.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null,e.sseManager.unregister(this)}}(VIS,jQuery)},2109:()=>{!function(e,t){function i(){this.frame,this.windowNo,this.log=e.Logging.VLogger.getVLogger("GenerateXModel");var i=this,n=t("<div style='width: 100%; height: 100%; background-color: white;'>"),a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),s=null,l=null,o=null,r=null;function d(){t.ajax({url:e.Application.contextUrl+"GenerateXModel/GenXModelGetTable",type:"POST",async:!1,success:function(t){var i=t.result;if(i)for(var n=0;n<i.length;n++)r.append("<option value='"+i[n].AD_Table_ID+"'>"+e.Utility.encodeText(i[n].Name)+"</option>")},error:function(e){i.log.info(e)}})}function c(){null!=s&&s.on(e.Events.onTouchStartOrClick,(function(){var i,n,a,o;p(!0),i="",n=!1,a=r.find("option:selected").val(),o="",t.ajax({url:e.Application.contextUrl+"Form/GenerateXClasses",dataType:"json",data:{directory:i,chkStatus:n,tableId:a,classType:o},success:function(t){if(null!=t.contant){var i="data:text/csv;charset=utf-8,"+encodeURIComponent(t.contant);l.attr("download",t.fileName).attr("href",i).attr("target","_blank"),e.ADialog.info(t.msg),l.css("display","block"),s.css("display","none")}p(!1)}}),p(!1)})),null!=l&&l.on(e.Events.onTouchStartOrClick,(function(){l.css("display","none"),s.css("display","block")})),null!=o&&o.on(e.Events.onTouchStartOrClick,(function(){i.dispose()}))}varchkAllTable=null,vartxtpath=null,varchkClassType=null;e.Application.contextUrl;function p(e){a.css("display",e?"block":"none")}this.Initialize=function(){var t;t=(t='<div style="width: 400px;margin: 20px auto;vertical-align: middle;"><div style="width: 400px;float: left;"><div style="width: 100px;float: left;   margin-top: 8px;"><span>'+e.Msg.getMsg("VISPRO_SelectTable")+'</span></div><div style="width: 300px;float: left;"><select style="width: 100%;float: left;" class="VIS_Pref_pass" id="cmbAllTable_@windowNo"></select></div></div><div style="float: left;margin-left: 5px;margin-top: 7px; display: none;"><input id="chkAllTable_@windowNo" type="checkbox" /><span>'+e.Msg.getMsg("VISPRO_AllTable")+'</span></div><div style="width: 400px;float: left; display: none;"><div style="width: 100px;float: left;"><span>'+e.Msg.getMsg("VISPRO_Path")+'</span></div><div style="width: 300px;float: left;"><input style="width: 81%;float: left;" class="VIS_Pref_pass" type="text" id="txtpath_@windowNo" /><input type="file" multiple="" webkitdirectory="" style="height: -1px; width:30px "></div></div><div style="width: 400px;float: left; display: none;"><div style="width: 100px;float: left;"><span>'+e.Msg.getMsg("VISPRO_EntityType")+'</span></div><div style="width: 300px;float: left;"><input id="chkClassType_@windowNo" type="checkbox" /><span>'+e.Msg.getMsg("VISPRO_ClassType")+'</span></div></div><div class="VIS-locator-DivStyle" style="text-align: right"><input type="button" id="btnCancel_@windowNo" style="margin-bottom:0px;margin-top:0px; float:right " value="'+e.Msg.getMsg("Cancel")+'" class="VIS_Pref_btn-2" /><input type="button" id="btnOk_@windowNo" style="margin-bottom:0px;margin-top:0px; float:right; margin-right:10px" class="VIS_Pref_btn-2" value="'+e.Msg.getMsg("VIS_Genrate")+'" /><a href="javascript:void(0)" class="VIS_Pref_pass-btn" style="display: none; margin-bottom: 0px; margin-top: 0px;float: right; margin-right: 10px;" id="btnOkA_@windowNo" >'+e.Msg.getMsg("VIS_Download")+"</a></div></div>").replaceAll("@windowNo",i.windowNo),n.html(t),n.append(a),s=n.find("#btnOk_"+i.windowNo),o=n.find("#btnCancel_"+i.windowNo),l=n.find("#btnOkA_"+i.windowNo),r=n.find("#cmbAllTable_"+i.windowNo),chkAllTable=n.find("#chkAllTable_"+i.windowNo),txtpath=n.find("#txtpath_"+i.windowNo),chkClassType=n.find("#chkClassType_"+i.windowNo),d(),c(),p(!1)},this.getRoot=function(){return n},this.disposeComponent=function(){s&&s.off(e.Events.onTouchStartOrClick),o&&o.off(e.Events.onTouchStartOrClick),i=null,this.windowNo=null,n=null,a=null,this.getRoot=null,this.disposeComponent=null}}e.AForms=e.AForms||{},i.prototype.init=function(e,t){this.frame=t,this.windowNo=e;try{this.Initialize()}catch(e){}this.frame.getContentGrid().append(this.getRoot())},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.AForms.GenerateXModel=i}(VIS,jQuery)},589:()=>{!function(e,t){function i(){this.frame,this.windowNo;var i=this,n=t("<div style='height:100%;background-color:white;' >"),a=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null;this.$ReqControlWarehouse=null;var f=null,m=null,y=null;this.$ReqControlLocator=null;var I=null,D=null,w=null,b=null,C=null;function _(t,i){return e.context.getWindowContext(t,i,!1)}function S(i,n,a){t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/ProductContainer",data:{Name:i,WarehouseId:n,LocatorId:a},dataType:"json",success:function(t){var i=JSON.parse(t);i?function(t){var i=[],n=[];i.push({field:"ContainerName",caption:e.Msg.getMsg("ContainerName"),size:"15%"}),i.push({field:"Width",caption:e.Msg.getMsg("Width"),size:"15%"}),i.push({field:"Height",caption:e.Msg.getMsg("Height"),size:"15%"}),i.push({field:"ParentPath",caption:e.Msg.getMsg("ParentPath"),size:"22%"}),i.push({field:"M_ProductContainer_ID",caption:e.Msg.getMsg("M_ProductContainer_ID"),hidden:!0}),i.push({field:"Ref_M_Container_ID",caption:e.Msg.getMsg("Ref_M_Container_ID"),hidden:!0});for(var a=0;a<t.length;a++){var s={};s.M_ProductContainer_ID=t[a].M_ProductContainer_ID,s.Ref_M_Container_ID=t[a].Ref_M_Container_ID,s.ContainerName=t[a].ContainerName,s.ParentPath=t[a].ParentPath,s.Width=t[a].Width,s.Height=t[a].Height,s.recid=a+1,n[a]=s}C=(C="PCont_gridContainer"+Math.random()).replace(".",""),w2utils.encodeTags(n),b=w.w2grid({name:C,recordHeight:20,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!0,selectColumn:!1,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:i,records:n,onClick:function(e){$selectedContainerId=b.get(e.recid).M_ProductContainer_ID}})}(i):w2ui[C].clear()},error:function(e){console.log(e)}})}function x(e){a[0].style.visibility=e}this.$selectedContainerId=null,this.Initialize=function(){x("visible"),s=t('<div class="Page-content" style="height:100%;background-color:white;">'),o=t(' <div class="formLeft" style="background-color: rgb(241, 241, 241);display: inline-block; float: left;width:23%;height:87.8%;overflow:auto;padding-left: 7px;">'),l=t('<div class="VIS_formDataRow">'),d=t("<div id=PCont_Name_"+i.windowNo+' class="VIS_formData">'),p=t("<label>"+e.Msg.translate(e.Env.getCtx(),"Name")+"</label><br>"),u=t("<input type=text id=containerName_"+i.windowNo+" ></input>"),d.append(p).append(u),l.append(d),o.append(l),l=t('<div class="VIS_formDataRow">'),d=t("<div id=PCont_WarehouseSearch_"+i.windowNo+' class="VIS_formData" style="margin-top:20px">'),g=t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_Warehouse_ID")+"</label><br>"),d.append(g),l.append(d),o.append(l),l=t('<div class="VIS_formDataRow">'),d=t("<div id=PCont_LocatorSearch_"+i.windowNo+' class="VIS_formData" style="margin-top:20px">'),f=t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_Locator_ID")+"</label><br>"),d.append(f).append(m),l.append(d),o.append(l),l=t('<div class="VIS_formDataRow">'),d=t('<div class="VIS_formData">'),I=t('<input type=button id="PCont_btnSearch_'+i.windowNo+' class="#" style="margin-top:20px;width: 100px;" value = '+e.Msg.getMsg("Search")+"></input>"),d.append(I),l.append(d),o.append(l),r=t(' <div class="formRight" style="display: inline-block; float: left; width: 75%; height: 87.8%; margin-left: 10px;">'),w=t('<div style="display: inline-block; float: left; width: 75%; height: 87.8%; margin-left: 10px;">'),c=t("<div>"),D=t('<input type=button id="PCont_OK_'+i.windowNo+' style="margin-top:20px;width: 100px;" value = '+e.Msg.getMsg("OK")+"></input>"),c.append(D),r.append(w).append(c),s.append(o).append(r),n.append(s).append(a),h=n.find("#PCont_WarehouseSearch_"+i.windowNo),function(){v=e.MLookupFactory.get(e.Env.getCtx(),i.windowNo,3798,e.DisplayType.Search,"M_Warehouse_ID",0,!1,null),this.$ReqControlWarehouse=new e.Controls.VTextBoxButton("M_Warehouse_ID",!0,!0,!0,e.DisplayType.Search,v),this.$ReqControlWarehouse.getControl().css("width","55%"),this.$ReqControlWarehouse.getBtn(0).css("height","29px"),this.$ReqControlWarehouse.getBtn(0).css("margin-top","-1px"),this.$ReqControlWarehouse.getBtn(0).css("width","14%"),this.$ReqControlWarehouse.getBtn(1).css("height","29px"),this.$ReqControlWarehouse.getBtn(1).css("margin-top","-1px"),this.$ReqControlWarehouse.getBtn(1).css("width","14%"),h.append(this.$ReqControlWarehouse.getControl()),h.append(this.$ReqControlWarehouse.getBtn(0)),h.append(this.$ReqControlWarehouse.getBtn(1));var t=_(i.windowNo,"M_Warehouse_ID");$ReqControlWarehouse.setValue(t)}(),m=n.find("#PCont_LocatorSearch_"+i.windowNo),function(){y=new e.MLocatorLookup(e.Env.getCtx(),i.windowNo),this.$ReqControlLocator=new e.Controls.VLocator("M_Locator_ID",!0,!0,!0,e.DisplayType.Locator,y),this.$ReqControlLocator.getControl().css("width","55%"),this.$ReqControlLocator.getBtn(0).css("height","29px"),this.$ReqControlLocator.getBtn(0).css("margin-top","-1px"),this.$ReqControlLocator.getBtn(0).css("width","14%"),this.$ReqControlLocator.getBtn(1).css("height","29px"),this.$ReqControlLocator.getBtn(1).css("margin-top","-1px"),this.$ReqControlLocator.getBtn(1).css("width","14%"),m.append(this.$ReqControlLocator.getControl()),m.append(this.$ReqControlLocator.getBtn(0)),m.append(this.$ReqControlLocator.getBtn(1));var t=_(i.windowNo,"M_Locator_ID");$ReqControlLocator.setValue(t)}(),S(n.find("#containerName_"+i.windowNo)[0].value,$ReqControlWarehouse.value,$ReqControlLocator.value),I.on("click",(function(){S(n.find("#containerName_"+i.windowNo)[0].value,$ReqControlWarehouse.value,$ReqControlLocator.value)})),D.on("click",(function(){var a=e.context.getWindowTabContext(i.windowNo,1,"KeyColumnName"),s=0;a.length>0?(s=e.context.getWindowContext(i.windowNo,a,!0))>0&&$selectedContainerId>0?function(a,s,l){t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/UpdateProductContainer",data:{TableName:a,RecordId:s,ContainerId:l},dataType:"json",success:function(t){JSON.parse(t)?(w2alert(e.Msg.getMsg("VIS_UpdatedSuccess")),S(n.find("#containerName_"+i.windowNo)[0].value,$ReqControlWarehouse.value,$ReqControlLocator.value)):w2alert(e.Msg.getMsg("VIS_NotUpdated"))},error:function(e){console.log(e)}})}(a,s,$selectedContainerId):w2alert(e.Msg.getMsg("VIS_RecordNotSelected")):w2alert(e.Msg.getMsg("VIS_TableNotFound"))})),x("hidden")},this.getRoot=function(){return n},this.formSizeChanged=function(e,t){},this.sizeChanged=function(e,t){},disposeComponent=function(){this.$ReqControlWarehouse=null;this.$ReqControlLocator=null;this.$selectedContainerId=null}}e.AForms=e.AForms||{},i.prototype.init=function(e,t){this.frame=t,this.windowNo=e;this.Initialize();this.frame.getContentGrid().append(this.getRoot()),this.formSizeChanged()},i.prototype.sizeChanged=function(e,t){this.formSizeChanged(e,t)},i.prototype.refresh=function(e,t){this.formSizeChanged()},i.prototype.dispose=function(){disposeComponent(),this.frame=null},e.AForms.productContainer=i}(VIS,jQuery)},4340:()=>{!function(e,t){function i(){this.frame,this.windowNo;var i=this,n=t("<div style='height:100%;background-color:white;' class='vis-forms-container' >"),a=t("<div class='vis-busyindicatorouterwrap'><div class='vis-busyindicatorinnerwrap'><i class='vis-busyindicatordiv'></i></div></div>"),s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null;this.grdname;var T=null,V=null,N=null,M=null,k=50,O=1,L=1,R=1,E=0,P=1,U=0,F=[];function B(){var i="0"==h.val()||null==h.val()?0:parseInt(h.val());t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/LoadLocator",data:{fromWarehouse_ID:i},dataType:"json",success:function(t){var i=JSON.parse(t);if(i){y.empty(),y.append("<option value= 0 >Select</option>");for(var n=0;n<i.length;n++)key=e.Utility.Util.getValueOfInt(i[n].ID),value=e.Utility.Util.getValueOfString(i[n].Name),y.append(" <option value="+key+">"+value+"</option>")}else y.append("<option value= 0 >Select</option>");y.prop("selectedIndex",0)},error:function(e){G("hidden"),console.log(e)}})}function W(n,a,s){L=1,R=1,E=0,!1;var l=parseInt(e.context.getWindowContext(i.windowNo,"AD_Org_ID",!0)),o=e.context.getWindowContext(i.windowNo,"MovementDate",!0),r="0"==f.val()||null==f.val()?0:parseInt(f.val());a&&(L=parseInt(cmbPage.val()),0!=s&&(-1==s?(L-=1)<1&&(L=1):1==s&&(L+=1)>P&&(L=P))),t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/MoveContainer",data:{container:n,movementDate:o,AD_Org_ID:l,locator:r,page:L,size:k},dataType:"json",success:function(n){var s=JSON.parse(n);if(s){if(1==L&&s.length>0&&(E=s[0].ContainerRecord,R=Math.ceil(E/k)),function(n){var a=[],s=[];a.push({field:"ProductName",caption:e.Msg.translate(e.Env.getCtx(),"ProductName"),size:"20%"}),a.push({field:"ASI",caption:e.Msg.translate(e.Env.getCtx(),"ASI"),size:"15%"}),a.push({field:"UomName",caption:e.Msg.translate(e.Env.getCtx(),"UomName"),size:"15%"}),a.push({field:"ContainerQty",caption:e.Msg.translate(e.Env.getCtx(),"ContainerQty"),size:"10%"}),a.push({field:"MoveQty",caption:e.Msg.translate(e.Env.getCtx(),"MoveQty"),editable:{type:"float"},render:"number:4",sortable:!1,size:"10%"}),a.push({field:"M_ProductContainer_ID",caption:e.Msg.translate(e.Env.getCtx(),"M_ProductContainer_ID"),hidden:!0}),a.push({field:"M_PRODUCT_ID",caption:e.Msg.translate(e.Env.getCtx(),"M_PRODUCT_ID"),hidden:!0}),a.push({field:"M_AttributeSetInstance_ID",caption:e.Msg.translate(e.Env.getCtx(),"M_AttributeSetInstance_ID"),size:"15%",hidden:!0}),a.push({field:"C_Uom_ID",caption:e.Msg.translate(e.Env.getCtx(),"C_Uom_ID"),size:"15%",hidden:!0}),a.push({field:"M_Transaction_ID",caption:e.Msg.translate(e.Env.getCtx(),"M_Transaction_ID"),size:"15%",hidden:!0});for(var l=0;l<n.length;l++){var o={};if(o.ProductName=n[l].ProductName,o.ASI=n[l].ASI,o.UomName=n[l].UomName,o.ContainerQty=n[l].ContainerQty,o.M_ProductContainer_ID=n[l].M_ProductContainer_ID,o.M_Product_ID=n[l].M_Product_ID,o.M_AttributeSetInstance_ID=n[l].M_AttributeSetInstance_ID,o.C_Uom_ID=n[l].C_Uom_ID,F.length>0){var r=t.map(F,(function(e){if(e.M_Product_ID==n[l].M_Product_ID&&e.M_AttributeSetInstance_ID==n[l].M_AttributeSetInstance_ID)return e}));r.length>0?o.MoveQty=r[0].MoveQty:o.MoveQty=0}else o.MoveQty=0;o.recid=l+1,s[l]=o}grdname="MCont_gridContainer"+Math.random(),grdname=grdname.replace(".",""),w2utils.encodeTags(s),A.w2grid({name:grdname,recordHeight:20,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!0,selectColumn:!1,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},columns:a,records:s,multiSelect:!1,onClick:function(e){},onChange:function(t){if(4==t.column&&t.value_new&&0!=t.value_new){var n=t.value_new,a=w2ui[grdname].get(t.recid).ContainerQty;if(a<0&&n>0)return e.ADialog.error("VIS_CantbePositive"),t.value_new=0,!1;if(Math.abs(n)>Math.abs(a))return e.ADialog.error("VIS_CantGreater"),t.value_new=0,!1;!function(t,n){var a=_.is(":checked"),s=S.is(":checked"),l=e.context.getWindowContext(i.windowNo,"M_Movement_ID",!0);w2ui[grdname].getChanges().length;if(0!=t){var o=w2ui[grdname].get(n);F.push({M_Product_ID:o.M_Product_ID,M_AttributeSetInstance_ID:o.M_AttributeSetInstance_ID,C_UOM_ID:o.C_Uom_ID,FromLocator:parseInt(f.val()),ToLocator:parseInt(y.val()),FromContainer:"0"==w.val()||null==w.val()?0:parseInt(w.val()),ToContainer:"0"==C.val()||null==C.val()?0:parseInt(C.val()),MoveQty:t,M_Movement_ID:l,IsFullMoveContainer:!!a,IsfullContainerQtyWise:!!s})}}(n,t.recid)}}}),(_.is(":checked")||S.is(":checked"))&&w2ui[grdname].lock("")}(s),a)O=L,cmbPage.val(O),O>1?liPrevPage.css("opacity","1"):liPrevPage.css("opacity","0.6"),G("hidden");else{if(P=R,liCurrPage.find("option").remove(),R>0)for(var l=0;l<R;l++)cmbPage.append(t("<option value="+(l+1)+">"+(l+1)+"</option>"));!function(e,t){cmbPage.val(e),t>0?(t>e?liNextPage.css("opacity","1"):liNextPage.css("opacity","0.6"),e>1?liPrevPage.css("opacity","1"):liPrevPage.css("opacity","0.6"),1==t&&(liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6"))):(liPrevPage.css("opacity","0.6"),liNextPage.css("opacity","0.6")),G("hidden")}(O,R),cmbPage.val(L)}!0}},error:function(e){G("hidden"),console.log(e)}})}function j(){var n,a=[],s=_.is(":checked");if(n=S.is(":checked"),s&&null==w.val())return e.ADialog.error("VIS_FullContainerMove",!0,"",""),!1;if(("0"==w.val()||null==w.val()?0:parseInt(w.val()))==("0"==C.val()||null==C.val()?0:parseInt(C.val())))return e.ADialog.error("VIS_ContainerCantSame",!0,"",""),!1;var l=F.length;if(0==l&&!s&&!n)return e.ADialog.error("VIS_MoveQtyNotSelected",!0,"",""),!1;var o=e.context.getWindowContext(i.windowNo,"M_Movement_ID",!0);if(l>0||s||n){if(!s&&!n&&l>0&&(t.each(F,(function(){this.ToLocator=parseInt(y.val()),this.ToContainer="0"==C.val()||null==C.val()?0:parseInt(C.val())})),a=F),s||n){a=[];for(var r=0;r<w2ui[grdname].records.length;r++){var d=w2ui[grdname].records[r];a.push({M_Product_ID:d.M_Product_ID,M_AttributeSetInstance_ID:d.M_AttributeSetInstance_ID,C_UOM_ID:d.C_Uom_ID,FromLocator:parseInt(f.val()),ToLocator:parseInt(y.val()),FromContainer:"0"==w.val()||null==w.val()?0:parseInt(w.val()),ToContainer:"0"==C.val()||null==C.val()?0:parseInt(C.val()),MoveQty:d.ContainerQty,M_Movement_ID:o,IsFullMoveContainer:!!s,IsfullContainerQtyWise:!!n});break}0==a.length&&s&&a.push({M_Product_ID:0,M_AttributeSetInstance_ID:0,C_UOM_ID:0,FromLocator:parseInt(f.val()),ToLocator:parseInt(y.val()),FromContainer:"0"==w.val()||null==w.val()?0:parseInt(w.val()),ToContainer:"0"==C.val()||null==C.val()?0:parseInt(C.val()),MoveQty:0,M_Movement_ID:o,IsFullMoveContainer:!!s,IsfullContainerQtyWise:!!n})}if(0==a.length)return e.ADialog.error("VIS_MoveQtyNotSelected",!0,"",""),!1;t.ajax({url:e.Application.contextUrl+"ProductContainer/SaveMoveData",type:"POST",data:{moveData:JSON.stringify(a)},success:function(t){"VIS_SuccessFullyInserted"==JSON.parse(t)?e.ADialog.info("VIS_SuccessFullyInserted",!0,"",""):e.ADialog.error("Error",!0,e.Msg.translate(e.Env.getCtx(),"VIS_NotInserted")+" - "+t,""),_.prop("checked",!1),S.prop("checked",!1),F=[],i.frame.close()},error:function(e){F=[],i.frame.close(),G("hidden")}})}}function G(e){a[0].style.visibility=e}this.Initialize=function(){var k;G("visible"),function(){s=t('<div class="VIS_main-wrap vis-formouterwrpdiv">'),l=t('<div class="VIS_form-wrap">'),o=t('<div class="VIS_form-row">'),r=t('<div class="VIS_form-col input-group vis-input-wrap">');var i=t('<div class="vis-control-wrap">');p=t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_Warehouse_ID")+"</label>"),u=t('<select disabled class="vis-ev-col-readonly">'),r.append(i),i.append(u).append(p),d=t('<div class="VIS_form-col input-group vis-input-wrap">');var k=t('<div class="vis-control-wrap">');g=t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_WarehouseTo_ID")+"</label>"),h=t('<select disabled class="vis-ev-col-readonly">'),d.append(k),k.append(h).append(g),o.append(r).append(d),l.append(o),o=t('<div class="VIS_form-row">'),r=t('<div class="VIS_form-col input-group vis-input-wrap">');i=t('<div class="vis-control-wrap">');v=t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_Locator_ID")+"</label>"),f=t("<select>"),r.append(i),i.append(f).append(v),d=t('<div class="VIS_form-col input-group vis-input-wrap">');k=t('<div class="vis-control-wrap">');m=t("<label>"+e.Msg.translate(e.Env.getCtx(),"M_LocatorTo_ID")+"</label>"),y=t("<select>"),d.append(k),k.append(y).append(m),o.append(r).append(d),l.append(o),o=t('<div class="VIS_form-row">'),r=t('<div class="VIS_form-col input-group vis-input-wrap">');i=t('<div class="vis-control-wrap">');var O=t('<div class="input-group-append">');D=t("<label>"+e.Msg.translate(e.Env.getCtx(),"VIS_FromContainer")+"</label>"),w=t('<select disabled class="VIS-container-move-combo-width" class="vis-ev-col-readonly" data-hasbtn=" ">'),I=t('<span class="fa fa-cubes input-group-text VIS_buttons-ContainerTree VIS-pallet-icon VIS_Tree-Container-disabled"></span>'),r.append(i),i.append(w).append(D),r.append(O),O.append(I),d=t('<div class="VIS_form-col input-group vis-input-wrap">');k=t('<div class="vis-control-wrap">');var L=t('<div class="input-group-append">');b=t("<label>"+e.Msg.translate(e.Env.getCtx(),"Ref_M_ProductContainerTo_ID")+"</label>"),C=t('<select disabled class="VIS-container-move-combo-width" class="vis-ev-col-readonly" data-hasbtn=" ">'),$btnToContainerTree=t('<span class="fa fa-cubes input-group-text VIS_buttons-ContainerTree VIS-pallet-icon VIS_Tree-Container-disabled"></span>'),d.append(k),k.append(C).append(b),d.append(L),L.append($btnToContainerTree),o.append(r).append(d),l.append(o),o=t('<div class="VIS_form-row">'),r=t('<div class="VIS_form-col input-group vis-input-wrap">');i=t('<div class="vis-control-wrap">');var R=t('<label class="vis-ec-col-lblchkbox" title="'+e.Msg.translate(e.Env.getCtx(),"VIS_MoveFullContainerToolTip")+'"><input type="checkbox" name="">'+e.Msg.translate(e.Env.getCtx(),"VIS_MoveFullContainer")+"</label>");r.append(i),i.append(R),_=R.find("input"),c=t('<div class="VIS_form-col input-group vis-input-wrap">');var E=t('<div class="vis-control-wrap">'),P=t('<label class="vis-ec-col-lblchkbox" title="'+e.Msg.translate(e.Env.getCtx(),"VIS_WithoutContainerToolTip")+'"><input type="checkbox" name="WithoutContainer">'+e.Msg.translate(e.Env.getCtx(),"VIS_WithoutContainer")+"</label>");c.append(E),E.append(P),S=P.find("input"),o.append(r).append(c),l.append(o),x=t(' <div class="VIS_outer-table-wrap">'),A=t('<div class="VIS_outer-table-wrap">'),x.append(A),T=t('<div class="VIS_buttons-wrap">'),M=t('<div class="pull-left" style="display: none;"><label>'+e.Msg.translate(e.Env.getCtx(),"VIS_ContainerGridInfo")+"</label></div>"),V=t('<div class="pull-right">'),N=t('<span class="btn">'+e.Msg.translate(e.Env.getCtx(),"VIS_OK")+"</span>"),U=V,ulPaging=t('<ul style="float:left;margin-top:4px" class="vis-statusbar-ul">'),liFirstPage=t('<li style="display: none; "><div><i class="vis vis-shiftleft" title="'+e.Msg.translate(e.Env.getCtx(),"FirstPage")+'"  style="opacity: 0.6;"></i></div></li>'),liPrevPage=t('<li style="opacity: 1;"><div><i class="vis vis-pageup" title="'+e.Msg.translate(e.Env.getCtx(),"PageUp")+'"  style="opacity: 0.6;"></i></div></li>'),cmbPage=t("<select>"),liCurrPage=t("<li>").append(cmbPage),liNextPage=t('<li style="opacity: 1;"><div><i class="vis vis-pagedown" title="'+e.Msg.translate(e.Env.getCtx(),"PageDown")+'" style="opacity: 0.6;"></i></div></li>'),liLastPage=t('<li style="display: none;"><div><i class="vis vis-shiftright" title="'+e.Msg.translate(e.Env.getCtx(),"LastPage")+'" style="opacity: 0.6;"></div></li>'),ulPaging.append(liFirstPage).append(liPrevPage).append(liCurrPage).append(liNextPage).append(liLastPage),U.append(ulPaging),V.append(N),T.append(M).append(V),s.append(l).append(x).append(T),n.append(s).append(a);var U}(),k=e.context.getWindowContext(i.windowNo,"DTD001_MWarehouseSource_ID",!0),t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/LoadWarehouse",data:{fromWarehouse_ID:k},dataType:"json",success:function(t){var i=JSON.parse(t);if(i)for(var n=0;n<i.length;n++)key=e.Utility.Util.getValueOfInt(i[n].ID),value=e.Utility.Util.getValueOfString(i[n].Name),u.append(" <option value="+key+">"+value+"</option>");u.prop("selectedIndex",0)},error:function(e){G("hidden"),console.log(e)}}),function(){var n=e.context.getWindowContext(i.windowNo,"DTD001_MWarehouseSource_ID",!0);t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/LoadLocator",data:{fromWarehouse_ID:n},dataType:"json",success:function(t){var i=JSON.parse(t);if(i){f.empty(),f.append("<option value= 0 >Select</option>");for(var n=0;n<i.length;n++)key=e.Utility.Util.getValueOfInt(i[n].ID),value=e.Utility.Util.getValueOfString(i[n].Name),f.append(" <option value="+key+">"+value+"</option>")}else f.append("<option value= 0 >Select</option>");f.prop("selectedIndex",0)},error:function(e){G("hidden"),console.log(e)}})}(),function(){var n=e.context.getWindowContext(i.windowNo,"M_Warehouse_ID",!0);""==n&&(n=0),t.ajax({type:"POST",url:e.Application.contextUrl+"ProductContainer/LoadWarehouse",data:{fromWarehouse_ID:n},dataType:"json",success:function(t){var i=JSON.parse(t);if(i)for(var n=0;n<i.length;n++)key=e.Utility.Util.getValueOfInt(i[n].ID),value=e.Utility.Util.getValueOfString(i[n].Name),h.append(" <option value="+key+">"+value+"</option>");h.prop("selectedIndex",0),B()},error:function(e){G("hidden"),console.log(e)}})}(),f.on("change",(function(){G("visible"),w.empty(),"0"==f.val()?I.addClass("VIS_Tree-Container-disabled"):I.removeClass("VIS_Tree-Container-disabled"),window.setTimeout((function(){W(0,!1,0)}),20),G("hidden")})),h.on("change",(function(){G("visible"),C.empty(),B(),G("hidden")})),y.on("change",(function(){G("visible"),C.empty(),"0"==y.val()?$btnToContainerTree.addClass("VIS_Tree-Container-disabled"):$btnToContainerTree.removeClass("VIS_Tree-Container-disabled"),G("hidden")})),W(0,!1,0),N.on("click",(function(){return"0"==h.val()?(e.ADialog.error("VIS_ToWarehouseNotSelected",!0,"",""),!1):"0"==f.val()?(e.ADialog.error("VIS_FromLocatorNotSelected",!0,"",""),!1):"0"==y.val()?(e.ADialog.error("VIS_ToLocatorNotSelected",!0,"",""),!1):null==w.val()&&null==C.val()?(e.ADialog.error("VIS_SelectContainer",!0,"",""),!1):0!=F.length||S.is(":checked")||_.is(":checked")?void(_.is(":checked")?e.ADialog.confirm("VIS_DoYouWantToDeleteManualCL",!0,"","Confirm",(function(e){if(!e)return!1;G("visible"),j(),G("hidden")})):(G("visible"),j(),G("hidden"))):(e.ADialog.error("VIS_MoveQtyNotSelected",!0,"",""),!1)})),I.on("click",(function(){if(!I.hasClass("VIS_Tree-Container-disabled")){var t="0"==u.val()||null==u.val()?0:parseInt(u.val()),i="0"==f.val()||null==f.val()?0:parseInt(f.val()),n=new e.productContainerTree(t,i,null,null);null!=n&&(n.showDialog(),n.onClosing=function(e,t){U=e,e>0&&M.css("display","block"),w.empty(),w.append(" <option value="+e+"  selected>"+t+"</option>"),F=[],W(e,!1,0)}),n=null}})),$btnToContainerTree.on("click",(function(){if(!$btnToContainerTree.hasClass("VIS_Tree-Container-disabled")){var t="0"==h.val()||null==h.val()?0:parseInt(h.val()),i="0"==y.val()||null==y.val()?0:parseInt(y.val()),n=new e.productContainerTree(t,i,null,null);null!=n&&(n.showDialog(),n.onClosing=function(e,t){C.empty(),C.append(" <option value="+e+"  selected>"+t+"</option>")}),n=null}})),_.change((function(){this.checked?(w2ui[grdname].lock(""),t(this).prop("checked",!0),S.prop("checked",!1)):(w2ui[grdname].unlock(""),t(this).prop("checked",!1))})),S.change((function(){this.checked?(w2ui[grdname].lock(""),t(this).prop("checked",!0),_.prop("checked",!1)):(w2ui[grdname].unlock(""),t(this).prop("checked",!1))})),liPrevPage.on("click",(function(e){e.preventDefault(),"1"==t(this).css("opacity")&&(G("visible"),W(U,!0,-1))})),liNextPage.on("click",(function(e){e.preventDefault(),"1"==t(this).css("opacity")&&(G("visible"),W(U,!0,1))})),cmbPage.on("change",(function(e){e.preventDefault(),G("visible"),W(U,!0,0)})),G("hidden")},this.setHeight=function(){return 700},this.getRoot=function(){return n},disposeComponent=function(){s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,D=null,w=null,b=null,C=null,null,null,null,null,_=null,null,S=null,null,null,null,x=null,A=null,null,this.grdname=null,T=null,V=null,null,N=null,null,k=null,L=null,R=null,E=null,null,i=null,n=null}}e.AForms=e.AForms||{},i.prototype.init=function(e,t){this.frame=t,this.windowNo=e;this.Initialize();this.frame.getContentGrid().append(this.getRoot())},i.prototype.dispose=function(){disposeComponent(),this.frame=null},e.AForms.productContainerMove=i}(VIS,jQuery)},8073:()=>{!function(e,t){function i(i,n,a,s){var l=this;this.onClose=null,this.onClosing=null;var o,r,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null;function y(a){t.ajax({url:e.Application.contextUrl+"ProductContainer/LoadContainerAsTree",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",data:{warehouse:i,locator:n,container:0,validation:s},success:function(e){a(e)},error:function(){e.ADialog.error("VIS_ErrorLoadingFromController")}})}function I(e){o='<div id=containerParent style="width:100%;height:400px"><div><div class="well VIS_tree-container" style="width:100%;float: left;"><div id=containerParent1 style="overflow-y: auto;height: 383px;"><ul class="nav nav-list">';for(var i=JSON.parse(e),n=0;n<i.length;n++)if(0!=n)if(i[n-1].Level<i[n].Level)o+='<ul class="nav nav-list tree" style="display: none;">',D(i[n],i[n].Level),n+1==i.length&&(o+="</li> </ul>");else if(i[n-1].Level!=i[n].Level||1==i[n].Level)if(i[n-1].Level>i[n].Level&&1!=i[n].Level){if(i[n-1].Level>i[n].Level)for(var s=i[n-1].Level-i[n].Level,l=0;l<s;l++)w();D(i[n],i[n].Level),n+1==i.length&&(o+="</li>")}else if(1!=i[n].Level);else{if(i[n-1].Level>i[n].Level)for(s=i[n-1].Level-1,l=0;l<s;l++)w();o+="</li>",o+='<li class="divider"></li>',D(i[n],i[n].Level),n+1==i.length&&(o+="</li>")}else o+="</li>",D(i[n],i[n].Level),n+1==i.length&&(o+="</li>");else D(i[n],i[n].Level);o+="</ul> </div> </div> </div> </div>",t("#VIS_ContainerParentChild").html(o),p=t("#VIS_ContainerParentChild")[0],t("label.tree-toggler").click((function(e){t(p).find(".nav-header").removeClass("current"),t(t(this)).addClass("current"),t(this).parent().children("ul.tree").toggle(300)})),u.click((function(e){""!=g.val()&&b(t(p),g.val()),""==g.val()&&t(p).find(".nav-header").removeClass("current")})),a&&u.trigger("click"),t(document).keypress((function(e){var i=e.keyCode?e.keyCode:e.which;13==i&&e.preventDefault(),"13"==i&&""!=g.val()&&b(t(p),g.val())})),t(document).keyup((function(e){""!=$NameInput.val()?$NameInput.css("background-color",C(!1)):$NameInput.css("background-color",C(!0))}))}function D(e,t){o+=1==t?"<li data-value="+e.M_ProductContainer_ID+' class="First">':"<li data-value="+e.M_ProductContainer_ID+">",o+='<label class="tree-toggler nav-header" for='+e.M_ProductContainer_ID+">"+e.ContainerName+'<span class="vis-treewindow-span"><span class="vis-css-treewindow-arrow-up"></span></span></label>'}function w(){o+="</li> </ul>"}function b(e,i){var n=e.find("label:contains('"+i+"')");t("label").removeClass("current"),n.addClass("current"),"none"==t(n).parents(".First").find("ul.tree:last-child").css("display")?(t(n).parents(".First").find("ul.tree:last-child").toggle(),t(n).parents(".First").find("ul.tree:last-child").css("display","block")):t(n).parents(".First").find("ul.tree:last-child").css("display","block"),n[0].scrollIntoView()}function C(e){return e?"#FFB6C1":"White"}function _(){d.find("#AddNewContainer")[0].style.display="none",v[0].style.display="flex",h[0].style.display="none",f[0].style.display="none",d.find("#VIS_DialogOKCancelProductContainer")[0].style.display="block",d.find("#containerParent").css("height","400px"),d.find("#containerParent1").css("height","383px"),d.find("#VIS_ContainerParentChild").css("height","382px"),m[0].style.display="none"}function S(){$searchInput.val(""),$NameInput.val(""),$HeightInput.val(""),$WidthInput.val("")}this.showDialog=function(){var o,D,w,b="";null!=s?o=function(e){var t;e=e.toUpperCase(),e.contains("M_LOCATOR_ID")?t=e.substr(e.indexOf("M_LOCATOR_ID=")+13,e.length):e.contains("M_LOCATORTO_ID")&&(t=e.substr(e.indexOf("M_LOCATORTO_ID=")+15,e.length));null!=t&&(t=t.contains("AND")?t.substr(0,t.indexOf("AND")).trim():t.trim());return t}(s):n>0&&(o=n),null!=o&&(b=e.dataContext.getJSONRecord("ProductContainer/GetWarehouseAndLocatorName",o)),d=t("<div class='vis-formouterwrpdiv' style='float: left; width: 100%;min-height:480px; max-height:480px !important'></div>"),w=t("<div id='AddNewContainer' style='float: left; width: 100%; display:none;'><div class='VIS_form-data-row'><div class='VIS_form-data-col input-group vis-input-wrap'><div class='vis-control-wrap'><input id='VIS_SearchValue' type='text' placeholder=' ' data-placeholder=''><label>"+e.Msg.translate(e.Env.getCtx(),"Value")+"</label></div></div><div class='VIS_form-data-col input-group vis-input-wrap'><div class='vis-control-wrap'><input id='VIS_Name' type='text' class='vis-ev-col-mandatory' placeholder=' ' data-placeholder=''><label>"+e.Msg.translate(e.Env.getCtx(),"Name")+"</label></div></div></div><div class='VIS_form-data-row'><div class='VIS_form-data-col input-group vis-input-wrap'><div class='vis-control-wrap'><input id='VIS_Height' type='Number' placeholder=' ' data-placeholder=''><label>"+e.Msg.translate(e.Env.getCtx(),"Height")+"</label></div></div><div class='VIS_form-data-col input-group vis-input-wrap'><div class='vis-control-wrap'><input id='VIS_Width' type='Number' placeholder=' ' data-placeholder=''><label>"+e.Msg.translate(e.Env.getCtx(),"Width")+"</label></div></div></div><div class='VIS_form-data-row' style='display: none;'><div class='VIS_form-data-col'><label>"+e.Msg.translate(e.Env.getCtx(),"Ref_M_Container_ID")+"</label></div></div></div>"),D=t("<div class='VIS_form-data-row'><div class='VIS_form-search-wrap input-group vis-input-wrap'><div class='vis-control-wrap'><input class='VIS_form-search-wrap input' id='VIS_Search' type='text' placeholder='Search Here...' data-hasbtn=' '></div><div class='input-group-append'><button class='VIS_form-search-wrap button input-group-text' id=VIS_BtnSearch title="+e.Msg.translate(e.Env.getCtx(),"VIS_Search")+"><i class='vis vis-search'></i></button><button class='VIS_form-search-wrap button input-group-text' id=VIS_BtnAdd title="+e.Msg.translate(e.Env.getCtx(),"VIS_NewContainer")+"><i class='vis vis-plus'></i></button><button class='VIS_form-search-wrap button input-group-text' style='display:none;' id=VIS_BtnSave title="+e.Msg.translate(e.Env.getCtx(),"VIS_SaveContainer")+"><i class='vis vis-save'></i></button><button class='VIS_form-search-wrap button input-group-text' style='display:none;' id=VIS_BtnCancel title="+e.Msg.translate(e.Env.getCtx(),"VIS_Cancel")+"><i class='vis vis-mark'></i></button></div></div>"),p=t("<div id='VIS_ContainerParentChild' class='VIS_Tree-Container' ></div>"),r=t("<div id='VIS_DialogOKCancelProductContainer' class='VIS_buttons-wrap VIS_pop-btn-wrap' style='display:block;'> <span class='btn' id=VIS_DialogOK>"+e.Msg.translate(e.Env.getCtx(),"VIS_DialogOK")+"</span> <span class='btn' id=VIS_DialogCancel>"+e.Msg.translate(e.Env.getCtx(),"VIS_DialogCancel")+"</span> </div>"),m=t("<div id='VIS_LabelInfo' class='VIS_Tree-Container-labelInfo'><label>"+b+"</label></div>"),D.append(p),d.append(w).append(D).append(r).append(m),(c=new e.ChildDialog).setContent(d),c.setTitle(e.Msg.translate(e.Env.getCtx(),"VIS_Container")),c.setWidth("450px"),c.setEnableResize(!1),c.setModal(!0),c.show(),c.hidebuttons(),u=d.find("#VIS_BtnSearch"),g=d.find("#VIS_Search"),$searchInput=d.find("#VIS_SearchValue"),$NameInput=d.find("#VIS_Name"),$HeightInput=d.find("#VIS_Height"),$WidthInput=d.find("#VIS_Width"),v=d.find("#VIS_BtnAdd"),h=d.find("#VIS_BtnSave"),f=d.find("#VIS_BtnCancel"),$DialogbtnOk=d.find("#VIS_DialogOK"),$DialogbtnCancel=d.find("#VIS_DialogCancel"),$DialogbtnOk.click((function(i){var n=p,a=t(n).find(".current").length;if(a>1)return e.ADialog.error("VIS_SelectSingleContainer",!0,"",""),!1;if(a>0){var s=parseInt(t(n).find(".current")[0].htmlFor),o=t(t(n).find(".current")[0]).text();l.onClosing(s,o),c.close()}else c.close()})),$DialogbtnCancel.click((function(e){c.close()})),a&&g.val(a),y(I),v.click((function(e){d.find("#AddNewContainer")[0].style.display="block",v[0].style.display="none",h[0].style.display="flex",f[0].style.display="flex",d.find("#VIS_DialogOKCancelProductContainer")[0].style.display="none",d.find("#containerParent").css("height","295px"),d.find("#containerParent1").css("height","275px"),d.find("#VIS_ContainerParentChild").css("height","265px"),m[0].style.display="block"})),f.click((function(e){_(),S()})),h.click((function(a){if(""==$NameInput.val())return e.ADialog.error("VIS_ContainerNameNotSelected",!0,"",""),!1;var l;if(""==i&&""==n&&""==s)return e.ADialog.error("VIS_WarehouseOrLocatorNotFound",!0,"",""),!1;null!=s&&((s=s.toUpperCase()).contains("M_LOCATOR_ID")?l=s.substr(s.indexOf("M_LOCATOR_ID=")+13,s.length):s.contains("M_LOCATORTO_ID")&&(l=s.substr(s.indexOf("M_LOCATORTO_ID=")+15,s.length)),null!=l&&(n=l.contains("AND")?l.substr(0,l.indexOf("AND")).trim():l.trim(),0==parseInt(n)&&e.ADialog.error("VIS_WarehouseOrLocatorNotFound",!0,"","")));var o=p,r=0;if(!(t(o).find(".current").length<=1))return e.ADialog.error("VIS_SelectSingleContainer",!0,"",""),!1;null!=t(o).find(".current")[0]&&(r=parseInt(t(o).find(".current")[0].htmlFor)),function(a,s,l,o,r){t.ajax({url:e.Application.contextUrl+"ProductContainer/SaveContainer",datatype:"json",async:!1,contentType:"application/json; charset=utf-8",data:{warehouseId:i,locatorId:n,value:a,name:s,height:l,width:o,parentContainerId:r},success:function(i){""==JSON.parse(i)?(e.ADialog.info("VIS_ContainerInserted",!0,"",""),t(p).empty(),p=t("<div id='VIS_ContainerParentChild' style='height:382px; float: left; width: 100%;'></div>"),y(I),_(),S()):e.ADialog.error("",!0,JSON.parse(i),"")},error:function(){e.ADialog.error("VIS_ErrorLoadingFromController")}})}($searchInput.val(),$NameInput.val(),""==$HeightInput.val()?0:$HeightInput.val(),""==$WidthInput.val()?0:$WidthInput.val(),r)}))},jQuery.expr[":"].contains=function(e,t,i){return jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())>=0},this.disposeComponent=function(){l=null,d=null,c=null,p=null,u=null,g=null,m=null,h=null,v=null,f=null,null,this.disposeComponent=null}}i.prototype.dispose=function(){this.disposeComponent()},e.productContainerTree=i}(VIS,jQuery)},6094:()=>{!function(e,t){e.createrole=function(i){var n=t("<div>"),a=null,s=null,l=null,o=null,r=null,d=null,c=this,p=null;function u(e){null!=e.keyCode&&13!=e.keyCode||v()}function g(e){null!=e.keyCode&&13!=e.keyCode||f()}function h(){s.val().length>0?s.removeClass("vis-group-mandatory"):s.addClass("vis-group-mandatory")}function v(){var t=new e.orgAccess(c.setSelectedOrg);window.setTimeout((function(){t.intialize(),t.show()}),20)}function f(){var i=s.val(),n=l.val();null!=i&&null!=i&&""!=i?null!=d&&null!=d&&""!=d&&0!=d.length?null!=n&&null!=n&&""!=n&&-1!=n?(p[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Group/AddNewRole",data:{name:i,userLevel:n,orgID:JSON.stringify(d)},success:function(t){var i=JSON.parse(t);i.length>0?e.ADialog.error(i):(e.ADialog.info("Record saved successfully"),a.close()),p[0].style.visibility="hidden"},error:function(){e.ADialog.error("VIS_ErrorSavingRole"),p[0].style.visibility="hidden"}})):e.ADialog.info("VIS_SelectUserLevel"):e.ADialog.info("VIS_SelectOrgAccess"):e.ADialog.info("VIS_PleaseName")}this.intialize=function(){var i;i='<div class="vis-group-assinRole-content"><div class="vis-group-assinRole-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input tabindex="1" maxlength="60" data-placeholder="" placeholder=" " class="vis-group-role-text vis-ev-col-mandatory" type="text"><label>'+e.Msg.getMsg("Role")+'</label></div></div></div><div class="vis-group-assinRole-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><select  tabindex="2"  class="vis-group-role-select" ></select><label>'+e.Msg.getMsg("VIS_UserLevel")+'</label></div></div></div><div class="vis-group-assinRole-data vis-group-asignrole-btnwrap"><a style="float:left"  tabindex="3"  class="vis-group-btn vis-group-orgAccess vis-group-pointer vis-group-grayBtn">'+e.Msg.getMsg("VIS_OrgAccess")+'</a><a  tabindex="4"  class="vis-group-btn vis-group-Save vis-group-pointer vis-group-grayBtn" style="float: right;">'+e.Msg.getMsg("Save")+"</a></div></div>",n.append(i),s=n.find(".vis-group-role-text"),l=n.find(".vis-group-role-select"),o=n.find(".vis-group-orgAccess"),r=n.find(".vis-group-Save"),(p=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",n.append(p),p[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Group/GetUserLevel",success:function(e){var t=JSON.parse(e);if(null!=t&&t.length>0)for(var i=0;i<t.length;i++)l.append('<option value="'+t[i].ID+'">'+t[i].Name+"</option>");p[0].style.visibility="hidden"}}),o.on("click",v),o.on("keydown",u),r.on("click",f),r.on("keydown",g),s.on("change",h)},this.setSelectedOrg=function(e){d=e},this.show=function(){(a=new e.ChildDialog).setContent(n),a.setWidth(550),a.setTitle(e.Msg.getMsg("VIS_CreateRole")),a.setModal(!0),a.onClose=function(){c.dispose(),c=null},a.show(),a.hideButtons()},this.dispose=function(){s.remove(),s=null,l.remove(),l=null,o.remove(),o=null,r.remove(),r=null,n.remove(),n=null,a=null}}}(VIS,jQuery)},1409:()=>{!function(e,t){e.createUser=function(){var i,n=null,a=null,s=null,l=null,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=this,v=null,f=null,m=null,y=null,I=[],D=null,w=null;function b(e){null!=e.keyCode&&13!=e.keyCode||T()}function C(e){null!=e.keyCode&&13!=e.keyCode||N()}function _(e){null!=e.keyCode&&13!=e.keyCode||V()}function S(e){d.val().length>0?d.removeClass("vis-group-mandatory"):d.addClass("vis-group-mandatory")}function x(e){null!=e.keyCode&&13!=e.keyCode||M()}function A(e){var i=t(e.target),n=t.grep(I,(function(e,t){return e.AD_Role_ID==i.data("uid")}));null!=n&&n.length>0&&(n[0].IsAssignedToUser=i.prop("checked")),e.stopPropagation()}function T(){a.find(".vis-group-roleContainer").css("display","none"),a.find(".vis-group-assignContainer").css("display","inherit"),a.append(D),n.find(".vis-group-assignContainer").css({visibility:"visible"}),a.height("400px")}function V(){a.find(".vis-group-assignContainer").css("display","none"),a.find(".vis-group-roleContainer").css("display","inherit"),a.append(y),a.height("403px")}function N(){if("visible"==t(n.find(".vis-group-assignContainer")[0]).css("visibility")){var i=d.val();if(null==i||null==i||""==i)return void e.ADialog.info("VIS_PleaseName");f[0].style.visibility="visible",null!=v&&null!=v||(v=null);var a=e.secureEngine.encrypt(p.val());t.ajax({url:e.Application.contextUrl+"Group/SaveNewUser",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:{Name:i,Email:r.val(),Value:c.val(),password:a,mobile:u.val(),OrgID:JSON.stringify(v)},success:function(t){var i=JSON.parse(t);f[0].style.visibility="hidden",i.length>0?e.ADialog.error(i):(e.ADialog.info("Record saved successfully"),g.close())},error:function(){f[0].style.visibility="hidden",e.ADialog.error("VIS_ErrorSavingUser")}})}}function M(){var i=r.val();if(null!=i&&null!=i&&""!=i){var n=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);if(-1==i.indexOf(";")){if(!n.test(i))return void e.ADialog.error("NotValidEmail",!0,":"+i)}else for(var a=i.split(";"),s=0;s<a.length;s++){if(!n.test(a[s]))return void e.ADialog.error("NotValidEmail",!0,":"+a[s])}var l=t.grep(I,(function(e,t){return 1==e.IsAssignedToUser}));null!=l&&null!=l&&0!=l.length?null!=i&&null!=i&&""!=i&&i.length>0&&(f[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Group/InviteUsers",type:"POST",datatype:"json",async:!0,data:{email:i,roles:JSON.stringify(l)},success:function(t){var i=JSON.parse(t);e.ADialog.info(i),f[0].style.visibility="hidden",g.close()},error:function(){e.ADialog.error("VIS_ErrorInvitingUsers"),f[0].style.visibility="hidden"}})):e.ADialog.info("VIS_SelectRole")}else e.ADialog.error("NotValidEmail")}this.intialize=function(){!function(){n=t("<div>");var i='  <div style="overflow:hidden" class="vis-group-assinRole-content"><div class="vis-group-assinRole-data" style=" margin-top: 5px; margin-bottom: 0; "><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  tabindex="1" class="vis-group-email" type="text" name="Name" data-placeholder="" placeholder=" "><label>'+e.Msg.getMsg("EMail")+'</label></div></div></div><div class="vis-group-assinRole-data vis-creategroup-btnwrap"> <a tabindex="2" class="vis-group-btn vis-group-pointer vis-group-create vis-group-grayBtn" style="float: left;">'+e.Msg.getMsg("Create")+'</a><a tabindex="3" class="vis-group-btn vis-group-pointer vis-group-invite vis-group-blueBtn" style="float: right;">'+e.Msg.getMsg("VIS_Invite")+"</a></div></div>";D=t('<div class="vis-group-assignContainer" style="visibility:hidden"><div class="vis-group-assinRole-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input  tabindex="4" type="text" maxlength="60" data-placeholder="" placeholder=" " class="vis-group-name vis-group-mandatory"  name="Name"><label>'+e.Msg.getMsg("Name")+'</label></div></div></div><div class="vis-group-assinRole-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input tabindex="5" type="text" maxlength="80" data-placeholder="" placeholder=" " class="vis-group-uid"  name="Name"><label>'+e.Msg.getMsg("VIS_UserID")+'</label></div></div></div><div class="vis-group-assinRole-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input tabindex="6" type="password" maxlength="250" data-placeholder="" placeholder=" " class="vis-group-pwd"  name="Name"><label>'+e.Msg.getMsg("Password")+'</label></div></div></div><div class="vis-group-assinRole-data"><div class="input-group vis-input-wrap"><div class="vis-control-wrap"><input tabindex="7" type="text"  maxlength="50" data-placeholder="" placeholder=" " class="vis-group-mobile"  name="Name"><label>'+e.Msg.getMsg("Mobile")+'</label></div></div></div><a tabindex="8" class="vis-group-btn vis-group-Save vis-group-pointer vis-group-grayBtn" style="float: right;">'+e.Msg.getMsg("Save")+"</a></div>"),y=t('<div class="vis-group-roleContainer" ><div> <label >'+e.Msg.getMsg("SelectRole")+"</label> </div></div>"),n.append(i),(a=n.find(".vis-group-assinRole-content")).height("100px"),s=n.find(".vis-group-create"),l=n.find(".vis-group-invite"),o=D.find(".vis-group-Save"),d=D.find(".vis-group-name"),c=D.find(".vis-group-uid"),u=D.find(".vis-group-mobile"),p=D.find(".vis-group-pwd"),r=n.find(".vis-group-email")}(),d.on("change",S),s.on("click",T),s.on("keydown",b),l.on("click",V),l.on("keydown",_),o.on("click",N),o.on("keydown",C),(f=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",n.append(f),i=t(' <script type="text/x-handlebars-template">{{#each this}}<div class="vis-group-user-wrap vis-group-role-pad"  data-UID="{{AD_Role_ID}}"><div class="vis-group-user-profile"><input tabindex="7"  type="checkbox" data-UID="{{AD_Role_ID}}" ><label>{{Name}}</label></div></div>{{/each}}<\/script>').html(),m=Handlebars.compile(i),f[0].style.visibility="visible",t.ajax({url:e.Application.contextUrl+"Group/GetRoleInfo",data:{AD_User_ID:0},success:function(i){var n=JSON.parse(i),a=t('<div style="height:212px;overflow:auto;margin-bottom:10px">');a.append(m(n)),y.append(a),w=t('<a tabindex="400" class="vis-group-btn vis-group-pointer vis-group-finish vis-group-grayBtn" style="float: right;">'+e.Msg.getMsg("VIS_Finish")+"</a>"),y.append(w),w.on("click",M),w.on("keydown",x),t(y.children(".vis-group-user-wrap")).length>0&&t(t(y).children(".vis-group-user-wrap")[0]).trigger("click");for(var s=0;s<n.length;s++)I.push({AD_Role_ID:n[s].AD_Role_ID,IsAssignedToUser:!1});t(y.find("input")).off("click"),t(y.find("input")).on("click",A),f[0].style.visibility="hidden"},error:function(){e.ADialog.error("VIS_ErrorLoadingRoles"),f[0].style.visibility="hidden"}})},this.setSelectedOrg=function(e){v=e},this.show=function(){(g=new e.ChildDialog).setContent(n),g.setPosition({my:"center bottom-3"}),g.setWidth(550),g.setTitle(e.Msg.getMsg("VIS_CreateUser")),g.setModal(!0),g.onClose=function(){h.onClose&&h.onClose(),h.dispose()},g.show(),g.hideButtons()},this.dispose=function(){this.prop=null,$div=null,g=null,h=null,n.remove(),n=null,s.remove(),s=null,l.remove(),l=null,o.remove(),o=null,r.remove(),r=null,d.remove(),d=null,c.remove(),c=null,p.remove(),p=null,u.remove(),u=null,g=null,h=null}}}(VIS,jQuery)},3975:()=>{!function(e,t){function i(){this.frame=null,this.windowNo=null;var i,n,a,s,l,o,r=t('<div class="vis-group-assign-content">'),d=t('<ul class="vis-apanel-rb-ul"></ul>'),c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=null,y=null,I=null,D=null,w=null,b=null,C=null,_=null,S=null,x=null,A=null,T=null,V=null,N=null,M=null,k=-1,O=0,L=[],R=[],E=[],P=[],U=0,F=0,B=0,W=0,j=20;function G(i){var n=t(i.target);return!n.hasClass("vis-group-roless")&&0==n.parents(".vis-group-roless").length&&!n.hasClass("vis-group-save-btn")&&E.length>0?(e.ADialog.confirm("VIS_SaveRole",!0,"","Confirm",(function(e){e?le():E=[]})),i.stopPropagation(),!1):!n.hasClass("vis-group-groupss")&&0==n.parents(".vis-group-groupss").length&&!n.hasClass("vis-group-save-btn")&&P.length>0?(e.ADialog.confirm("VIS_SaveRole",!0,"","Confirm",(function(e){e?oe():P=[]})),i.stopPropagation(),!1):void 0}function q(){var i=' <script type="text/x-handlebars-template">{{#each this}}<div class="vis-group-user-wrap vis-group-roless vis-group-role-pad"  data-UID="{{AD_Role_ID}}"><div class="vis-group-user-profile">{{#if IsAssignedToUser}}{{#if IsUpdate}}<input type="checkbox" data-UID="{{AD_Role_ID}}" checked="">{{else}}<input disabled type="checkbox" data-UID="{{AD_Role_ID}}" checked="">{{/if}}<label style="color: rgba(var(--v-c-on-secondary), 1);font-weight: bold;">{{Name}}</label>{{else}}{{#if IsUpdate}}<input type="checkbox" data-UID="{{AD_Role_ID}}" >{{else}}<input disabled type="checkbox" data-UID="{{AD_Role_ID}}" >{{/if}}<label>{{Name}}</label>{{/if}}</div><div class="vis-group-user-right"><ul><li><span class="vis-group-user-ico vis-group-edit vis vis-edit" title="'+e.Msg.getMsg("Edit")+'" data-UID="{{AD_Role_ID}}-{{roleWindowID}}"></span></li></ul></div></div>{{/each}}<\/script>';a=t(i).html(),s=Handlebars.compile(a)}function H(){var t=new e.createUser;t.intialize(),t.show()}function z(){var t=new e.createrole;t.intialize(),t.show()}function Q(){_[0].style.visibility="visible",0==B&&t.ajax({url:e.Application.contextUrl+"Group/GetWindowIds",async:!1,success:function(e){var t=JSON.parse(e);null!=t&&null!=t&&(B=t.GroupWindowID,t.RoleWindowID,t.UserWindowID)},error:function(){e.Msg.getMsg("VIS_GroupWindowNotFound")}});var i=new e.Query;i.addRestriction("AD_GroupInfo_ID",e.Query.prototype.EQUAL,0),e.viewManager.startWindow(B,i),_[0].style.visibility="hidden"}function J(){W=1,t.ajax({url:e.Application.contextUrl+"Group/GetUserInfo",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:{searchText:h.val(),sortBy:k,pageNo:W,pageSize:j},success:function(e){var i=JSON.parse(e);w.find(".vis-group-user-wrap").remove(),w.append(n(i)),w.off("click"),w.on("click",Z),t(w.children(".vis-group-user-wrap")).length>0&&t(w.children(".vis-group-user-wrap")[0]).trigger("click"),W++},error:function(){e.ADialog.error("VIS_ErrorLoadingContacts"),_[0].style.visibility="hidden"}})}function $(){t(this).scrollTop()+t(this).innerHeight()>=this.scrollHeight&&t.ajax({url:e.Application.contextUrl+"Group/GetUserInfo",type:"GET",datatype:"json",contentType:"application/json; charset=utf-8",async:!0,data:{searchText:h.val(),sortBy:k,pageNo:W,pageSize:j},success:function(e){W++;var t=JSON.parse(e);w.append(n(t)),_[0].style.visibility="hidden"},error:function(){e.ADialog.error("VIS_ErrorLoadingContacts"),_[0].style.visibility="hidden"}})}function K(e){null!=e.keyCode&&13!=e.keyCode||null!=h&&null!=h&&J()}function Y(e){null!=e.keyCode&&13!=e.keyCode||null!=A&&null!=A&&te()}function X(e){null!=e.keyCode&&13!=e.keyCode||null!=S&&null!=S&&ee()}function Z(i){if(!(E.length>0)){var n=t(i.target);if(t(t(w.children(".vis-group-selected-op"))[0]).removeClass("vis-group-selected-op vis-group-selected-opbackground"),t(w).find(".vis-GroupUserRadio").prop("checked",!1),n.hasClass("vis-group-user-wrap"))n.addClass("vis-group-selected-op vis-group-selected-opbackground"),O=n.data("uid"),t(t(n).find(".vis-GroupUserRadio")[0]).prop("checked",!0);else{if(!(t(n.parents(".vis-group-user-wrap")).length>0))return;t(n.parents(".vis-group-user-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground"),O=t(n.parents().find(".vis-group-selected-op")).data("uid"),t(t(t(n).parents(".vis-group-user-wrap")[0]).find(".vis-GroupUserRadio")[0]).prop("checked",!0)}if(n.hasClass("vis-group-user-ico vis-group-edit")){var a=n.data("uid").split("-"),s=new e.Query;s.addRestriction("AD_User_ID",e.Query.prototype.EQUAL,a[0]),e.viewManager.startWindow(a[2],s)}else n.hasClass("vis-group-user-ico vis-group-activeUser")&&"disabled"!=n.attr("disabled")?re(n,!1):n.hasClass("vis-group-user-ico vis-group-inactiveUser")&&"disabled"!=n.attr("disabled")&&re(n,!0);ee(n)}}function ee(i){_[0].style.visibility="visible";var n=S.val();t.ajax({url:e.Application.contextUrl+"Group/GetRoleInfo",data:{AD_User_ID:O,name:n},success:function(e){var i=JSON.parse(e);b.find(".vis-group-user-wrap").remove(),b.append(s(i)),b.off("click"),b.on("click",ie),t(b.children(".vis-group-user-wrap")).length>0&&t(t(b).children(".vis-group-user-wrap")[0]).trigger("click"),L=[];for(var n=0;n<i.length;n++)L.push({AD_Role_ID:i[n].AD_Role_ID,IsAssignedToUser:i[n].IsAssignedToUser});t(b.find("input")).off("click"),t(b.find("input")).on("click",ae),_[0].style.visibility="hidden"},error:function(){e.ADialog.error("VIS_ErrorLoadingRoles"),_[0].style.visibility="hidden"}})}function te(i){_[0].style.visibility="visible";var n=A.val();t.ajax({url:e.Application.contextUrl+"Group/GetGroupInfo",data:{AD_Role_ID:U,name:n},success:function(e){var i=JSON.parse(e);C.find(".vis-group-user-wrap").remove(),C.append(o(i)),C.off("click"),C.on("click",ne),t(C.children(".vis-group-user-wrap")).length>0&&t(t(C).children(".vis-group-user-wrap")[0]).trigger("click"),R=[],_[0].style.visibility="hidden";for(var n=0;n<i.length;n++)0==n&&(B=i[n].GroupWindowID),R.push({AD_Group_ID:i[n].AD_Group_ID,IsAssignedToUser:i[n].IsAssignedToUser});t(C.find("input")).off("click"),t(C.find("input")).on("click",se)},error:function(){e.ADialog.error("VIS_ErrorLoadingGroups"),_[0].style.visibility="hidden"}})}function ie(i){if(!0,P.length>0)e.ADialog.confirm("VIS_SaveGroup",!0,"","Confirm",(function(e){e?oe():P=[]}));else{var n=t(i.target);if(t(t(b.children(".vis-group-selected-op"))[0]).removeClass("vis-group-selected-op vis-group-selected-opbackground"),n.hasClass("vis-group-user-wrap")?(n.addClass("vis-group-selected-op vis-group-selected-opbackground"),U=n.data("uid")):U=t(n.parents(".vis-group-user-wrap")).addClass("vis-group-selected-op vis-group-selected-opbackground").data("uid"),n.hasClass("vis-group-user-ico vis-group-edit")){U=(U=n.data("uid")).split("-");var a=new e.Query;a.addRestriction("AD_Role_ID",e.Query.prototype.EQUAL,U[0]),e.viewManager.startWindow(U[1],a),U=U[0]}null!=U&&te(),void 0===i.originalEvent&&i.stopPropagation()}}function ne(i){!0;var n,a,s=t(i.target);if(t(t(C.children(".vis-group-selected-op"))[0]).removeClass("vis-group-selected-op"),s.hasClass("vis-group-user-wrap")?(s.addClass("vis-group-selected-op"),F=s.data("uid")):(t(s.parents(".vis-group-user-wrap")).addClass("vis-group-selected-op"),F=t(s.parents().find(".vis-group-selected-op")).data("uid")),s.hasClass("vis-group-user-ico vis-group-edit")){F=(F=s.data("uid")).split("-");var l=new e.Query;l.addRestriction("AD_GroupInfo_ID",e.Query.prototype.EQUAL,F[0]),e.viewManager.startWindow(F[1],l)}else s.hasClass("vis-group-user-ico vis-group-info")&&(F=(F=s.data("uid")).split("-"),n=F[0],(a=new e.groupInfo(n)).intialize(),a.show());void 0===i.originalEvent&&i.stopPropagation()}function ae(i){if(P.length>0)e.ADialog.confirm("VIS_SaveGroup",!0,"","Confirm",(function(e){e?oe():P=[]}));else{var n=t(i.target),a=t.grep(L,(function(e,t){return e.AD_Role_ID==n.data("uid")}));null!=a&&a.length>0&&(a[0].IsAssignedToUser=n.prop("checked")),null==(a=t.grep(E,(function(e,t){return e==n.data("uid")})))||0==a.length?E.push(n.data("uid")):E.splice(E.indexOf(n.data("uid")),1),i.stopPropagation()}}function se(i){if(E.length>0)e.ADialog.confirm("VIS_SaveRole",!0,"","Confirm",(function(e){e?le():E=[]}));else{var n=t(i.target),a=t.grep(R,(function(e,t){return e.AD_Group_ID==n.data("uid")}));null!=a&&a.length>0&&(a[0].IsAssignedToUser=n.prop("checked")),null==(a=t.grep(P,(function(e,t){return e==n.data("uid")})))||0==a.length?P.push(n.data("uid")):P.splice(P.indexOf(n.data("uid")),1),i.stopPropagation()}}function le(){_[0].style.visibility="visible",E=[],t.ajax({url:e.Application.contextUrl+"Group/UpdateUserRoles",type:"Post",data:{AD_User_ID:O,roles:JSON.stringify(L)},success:function(){t(t(p.find("h7"))[0]).show(),t(t(p.find("h7"))[0]).fadeOut(1600,"linear"),ee()},error:function(){e.ADialog.error(e.Msg.getMsg("VIS_ErrorSavingRole")),_[0].style.visibility="hidden"}})}function oe(){_[0].style.visibility="visible",P=[],t.ajax({url:e.Application.contextUrl+"Group/UpdateUserGroups",type:"Post",data:{AD_Role_ID:U,AD_Group_ID:F,groups:JSON.stringify(R)},success:function(){t(t(u.find("h7"))[0]).show(),t(t(u.find("h7"))[0]).fadeOut(1600,"linear"),te()},error:function(){e.ADialog.error(e.Msg.getMsg("VIS_ErrorSavingGroups")),_[0].style.visibility="hidden"}})}function re(i,n){_[0].style.visibility="visible";var a="";n?(i.removeClass("vis-group-user-ico vis-group-inactiveUser"),i.addClass("vis-group-user-ico vis-group-activeUser"),a=e.Application.contextUrl+"Group/ActiveUser"):(i.removeClass("vis-group-user-ico vis-group-activeUser"),i.addClass("vis-group-user-ico vis-group-inactiveUser"),a=e.Application.contextUrl+"Group/InActiveUser"),t.ajax({url:a,data:{AD_User_ID:i.data("uid")},success:function(t){JSON.parse(t)<1&&e.ADialog.error("VIS_UserNotUpdated"),n?i.prop("title",e.Msg.getMsg("Active")):i.prop("title",e.Msg.getMsg("InActive")),_[0].style.visibility="hidden"},error:function(){e.ADialog.error("VIS_UserNotUpdated"),_[0].style.visibility="hidden"}})}this.initializeComponent=function(){!function(){r.append('<div class="vis-group-colwrap"><div class="vis-group-content-wrap"></div></div><div class="vis-group-colwrap"><div class="vis-group-content-wrap"></div></div><div class="vis-group-colwrap last-child"><div class="vis-group-content-wrap"></div></div>');var a=r.find(".vis-group-content-wrap");c=t(a[0]),p=t(a[1]),u=t(a[2]),a=null,(_=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'))[0].style.visibility="hidden",r.append(_),_[0].style.visibility="visible",c.append('<div class="vis-group-content-head"><h4 class="vis-group-content-tittle">'+e.Msg.getMsg("VIS_CreateInviteUser")+'</h4><span class=" vis-group-pointer vis-group-head-right">'+e.Msg.getMsg("SortBy")+'</span><button class="vis-group-add-btn vis-groupbtn"><i class="vis vis-addbp"></i></button></div>'),m=c.find(".vis-group-head-right"),c.append('<div class="vis-group-searchwrp"><div class="vis-group-content-headDown"><input class="vis-group-SearchText" value="" placeholder="'+e.Msg.getMsg("Search")+'" type="text"><button class="vis-groupbtn vis-group-search-icon"><i class="vis vis-search"></i></button></div></div>'),h=c.find(".vis-group-SearchText"),v=c.find(".vis-group-search-icon"),f=c.find(".vis-group-add-btn"),g=t('<div class="vis-group-users-container">'),w=t('<div class="vis-group-DataContainer">'),g.height(t(r.parent()).height()-95),c.append(g),g.append(w),s=' <script type="text/x-handlebars-template">{{#each this}}<div class="vis-group-user-wrap"  data-UID="{{AD_UserID}}"><input type="radio" class="vis-GroupUserRadio"><div class="vis-group-user-profile vis-group-pro-width"><div class="vis-group-user-img vis-chatimgwrap">{{#if UserImage}}<img src="'+e.Application.contextUrl+'{{UserImage}}" alt="user-img">{{else}}<i class="fa fa-user"></i>{{/if}}</div><div class="vis-group-user-text">{{#if IsActive }}<p style="font-weight: bold">{{Username}}</p>{{else}}<p>{{Username}}</p>{{/if}}<span>{{Email}}</span><p>{{Country}}</p></div></div><div class="vis-group-user-right"><ul class="vis-flex-directionCol"><li><span class="vis-group-user-ico vis-group-edit vis vis-edit" style="padding-bottom: 15px;" title="'+e.Msg.getMsg("Edit")+'" data-UID="{{AD_UserID}}-{{UserTableID}}-{{UserWindowID}}"></span></li>{{#if IsActive }}{{#if IsUpdate}}<li><span class="vis-group-user-ico vis-group-activeUser fa fa-check-circle" title="'+e.Msg.getMsg("Active")+'" data-UID="{{AD_UserID}}"></span></li>{{else}}<li><span disabled class="vis-group-user-ico vis-group-activeUser fa fa-check-circle" title="'+e.Msg.getMsg("Active")+'" data-UID="{{AD_UserID}}"></span></li>{{/if}}{{else}}{{#if IsUpdate}}<li><span class="vis-group-user-ico vis-group-inactiveUser fa fa-check-circle" title="'+e.Msg.getMsg("InActive")+'"  data-UID="{{AD_UserID}}"></span></li>{{else}}<li><span disabled class="vis-group-user-ico vis-group-inactiveUser fa fa-check-circle" title="'+e.Msg.getMsg("InActive")+'" data-UID="{{AD_UserID}}"></span></li>{{/if}}{{/if}}</ul></div></div>{{/each}}<\/script>',i=t(s).html(),n=Handlebars.compile(i),J(),p.append(' <div class="vis-group-content-head"><h4 class="vis-group-content-tittle vis-group-role">'+e.Msg.getMsg("Role")+'</h4><h7 class="vis-group-SaveMessage">'+e.Msg.getMsg("VIS_RoleSaved")+'</h7><div class="vis-group-top-right"><button class="vis-groupbtn vis-group-add-btn"><i class="vis vis-new" title="'+e.Msg.getMsg("AddNew")+'" ></i></button><button class="vis-groupbtn vis-group-save-btn"><i class="vis vis-save" title="'+e.Msg.getMsg("Save")+'"></i></button></div></div><div class="vis-group-searchwrp"><div class="vis-group-content-headDown"><input class="vis-group-SearchText" value="" placeholder="'+e.Msg.getMsg("Search")+'" type="text"><button class="vis-groupbtn vis-group-search-icon"><i class="vis vis-search"></i></button></div></div>'),I=p.find(".vis-group-save-btn"),y=p.find(".vis-group-add-btn"),S=p.find(".vis-group-SearchText"),x=p.find(".vis-group-search-icon"),D=t('<div class="vis-group-role-container">'),b=t('<div class="vis-group-DataContainer">'),p.append(D),D.append(b),D.height(t(r.parent()).height()-95),q(),u.append('<div class="vis-group-content-head"><h4 class="vis-group-content-tittle vis-group-rights">'+e.Msg.getMsg("VIS_Groups")+'</h4><h7 class="vis-group-SaveMessage">'+e.Msg.getMsg("VIS_GroupSaved")+'</h7><div class="vis-group-top-right"><div class="vis-group-top-right"><button class="vis-groupbtn vis-group-add-btn"><i class="vis vis-new" title="'+e.Msg.getMsg("AddNew")+'"></i></button><button class="vis-groupbtn vis-group-save-btn"><i class="vis vis-save" title="'+e.Msg.getMsg("Save")+'"></i></button></div></div></div><div class="vis-group-searchwrp"><div class="vis-group-content-headDown"><input class="vis-group-SearchText"  value="" placeholder="'+e.Msg.getMsg("Search")+'" type="text"><button class="vis-groupbtn vis-group-search-icon"><i class="vis vis-search"></i></button></div></div>'),A=u.find(".vis-group-SearchText"),T=u.find(".vis-group-search-icon"),V=u.find(".vis-group-add-btn"),N=u.find(".vis-group-save-btn"),M=t('<div class="vis-group-role-container">'),C=t('<div class="vis-group-DataContainer">'),u.append(M),M.append(C),M.height(t(r.parent()).height()-95),function(){var i=' <script type="text/x-handlebars-template">{{#each this}}<div class="vis-group-user-wrap vis-group-groupss vis-group-role-pad" data-UID="{{AD_Group_ID}}"><div class="vis-group-user-profile">{{#if IsAssignedToUser}}<input type="checkbox" data-UID="{{AD_Group_ID}}" checked=""><label style="color: rgba(var(--v-c-on-secondary), 1);font-weight: bold;">{{Name}}</label>{{else}}<input type="checkbox" data-UID="{{AD_Group_ID}}" ><label>{{Name}}</label>{{/if}}</div><div class="vis-group-user-right"><ul><li><span class="vis-group-user-ico vis-group-edit vis vis-edit" style="margin-right: 10px" title="'+e.Msg.getMsg("Edit")+'" data-UID="{{AD_Group_ID}}-{{GroupWindowID}}"></span></li><li><span class="vis-group-user-ico vis-group-info vis vis-info"   data-UID="{{AD_Group_ID}}-{{GroupWindowID}}"></span></li></ul>                           </div></div>{{/each}}<\/script>';l=t(i).html(),o=Handlebars.compile(l)}();var s}(),f.on("click",H),v.on("click",J),h.on("keydown",K),I.on("click",le),N.on("click",oe),T.on("click",te),A.on("keydown",Y),x.on("click",ee),S.on("keydown",X),V.on("click",Q),y.on("click",z),g.on("scroll",$),r.on("click",G),d.append("<li value=1>"+e.Msg.getMsg("Name")+"</li>"),d.append("<li value=2>"+e.Msg.getMsg("SearchKey")+"</li>"),d.append("<li value=3>"+e.Msg.getMsg("EMail")+"</li>"),m.on("click",(function(){t(this).w2overlay(d.clone(!0))})),d.on(e.Events.onTouchStartOrClick,"LI",(function(e){k=t(this).val(),J()}))},this.disposeComponent=function(){null!=f&&null!=f&&f.off("click"),v.off("click"),h.off("keydown"),I.off("click"),N.off("click"),T.off("click"),A.off("keydown"),x.off("click"),S.off("keydown"),V.off("click"),y.off("click"),g.off("scroll"),r.off("click"),this.frame=null,this.windowNo=null,c.remove(),c=null,p.remove(),p=null,u.remove(),u=null,g.remove(),g=null,h.remove(),h=null,v.remove(),v=null,f.remove(),f=null,m.remove(),m=null,y.remove(),y=null,I.remove(),I=null,D.remove(),D=null,_.remove(),_=null,A.remove(),A=null,T.remove(),T=null,S.remove(),S=null,x.remove(),x=null,V.remove(),V=null,N.remove(),N=null,M.remove(),M=null,i.remove(),n.remove(),a.remove(),s.remove(),l.remove(),o.remove(),L=null,R=null,E=null,P=null,r.remove(),r=null,d=null,null},this.getRoot=function(){return r}}i.prototype.init=function(e,t){this.frame=t,this.windowNo=e,t.setTitle("VIS_Group"),this.frame.getContentGrid().append(this.getRoot()),this.initializeComponent()},i.prototype.dispose=function(){this.disposeComponent(),this.frame&&this.frame.dispose(),this.frame=null},e.GroupForm=i}(VIS,jQuery)},291:()=>{!function(e,t){e.groupInfo=function(i){var n=null,a=null;this.intialize=function(){n=t('<div  class="vis-forms-container">'),t.ajax({url:e.Application.contextUrl+"Group/GetGroupChildInfo",data:{groupID:i},success:function(t){var i=JSON.parse(t),a='<div class="vis-group-gi-content"><label>'+i.GroupName+"</label>";null!=i.Description&&null!=i.Description&&""!=i.Description&&(a+="<p>"+i.Description+"</p>"),null!=i.WindowName&&null!=i.WindowName&&""!=i.WindowName&&(a+='<div class="vis-group-gi-data"><label>'+e.Msg.getMsg("Windows")+":</label><p>"+i.WindowName+"</p>"),null!=i.FormName&&null!=i.FormName&&""!=i.FormName&&(a+='<div class="vis-group-gi-data"><label>'+e.Msg.getMsg("VIS_Forms")+":</label><p>"+i.FormName+"</p>"),null!=i.ProcessName&&null!=i.ProcessName&&""!=i.ProcessName&&(a+='<div class="vis-group-gi-data"><label>'+e.Msg.getMsg("VIS_Processes")+":</label><p>"+i.ProcessName+"</p>"),null!=i.WorkflowName&&null!=i.WorkflowName&&""!=i.WorkflowName&&(a+='<div class="vis-group-gi-data"><label>'+e.Msg.getMsg("VIS_Workflows")+":</label><p>"+i.WorkflowName+"</p>"),a+="</div>",n.append(a)},error:function(){e.ADialog.error("VIS_ErrorGettingGroupInfo")}})},this.show=function(){(a=new e.ChildDialog).setContent(n),a.setHeight(500),a.setWidth(550),a.setTitle(e.Msg.getMsg("VIS_Groupinfo")),a.setModal(!0),a.onClose=function(){self.onClose&&self.onClose(),self.dispose()},a.show(),a.hideButtons()},this.dispose=function(){self=null,n.remove(),n=null,a=null}}}(VIS,jQuery)},2280:()=>{!function(e,t){e.orgAccess=function(i){var n,a=null,s=null,l=null,o=[],r=this;function d(e){var i=t(e.target);i.prop("checked")?-1==t.inArray(i.data("uid"))&&o.push(i.data("uid")):o.splice(o.indexOf(i.data("uid")),1)}this.intialize=function(){n=t(' <script type="text/x-handlebars-template">{{#each this}}<div style="border-bottom:1px solid rgba(var(--v-c-on-secondary), .2); margin-bottom: 10px" class="vis-group-assinRole-check"><div style="width:100%" class="vis-group-user-profile"><input type="Checkbox" data-uid="{{OrgID}}"> <p style="margin-bottom:2px">{{OrgName}}</p><span class="vis-orgaccess-description">{{Description}}</span></div></div>{{/each}}<\/script>').html(),s=Handlebars.compile(n),a=t("<div>"),t.ajax({url:e.Application.contextUrl+"Group/GetOrgAccess",success:function(e){var i=JSON.parse(e);a.append(s(i)),t(a.find("input")).on("click",d)},error:function(){e.ADialog.error("VIS_ErrorLoadingOrg")}})},this.show=function(){(l=new e.ChildDialog).setContent(a),l.setWidth(450),l.setHeight(350),l.setTitle(e.Msg.getMsg("VIS_OrgAccess")),l.setModal(!0),l.onClose=function(){r.dispose()},l.show(),l.onOkClick=function(e){i(o),r.dispose()},l.onCancelClick=function(){r.dispose()}},this.dispose=function(){this.prop=null,$div=null,a.remove(),a=null,n=null,s=null,l=null,r=null,o=null}}}(VIS,jQuery)},9009:()=>{!function(e,t){var i=e.historyMgr||{};if("replaceState"in history)i.replaceHash=function(e){"#"!==(""+e).charAt(0)&&(e="#"+e),history.replaceState("","",e)};else{var n=location.hash;i.replaceHash=function(e){location.hash!==n&&history.back(),location.hash=e}}i.updateHistory=function(e){i.replaceHash(e)},i.restoreHistory=function(){var e=i.geHashtLocation();t.viewManager.restoreActions(e)},i.geHashtLocation=function(){var e=location.hash;return e.length>1?e.substring(1):""},e.historyMgr=i}(window,VIS)},4011:()=>{VIS.Msg={},VIS.Msg.elements={},VIS.I18N.getLabel=function(e,t,i,n){var a;if(!VIS.I18N.labels[e])return i&&n&&VIS.I18N.getLabelFromServer(e,t,i,n),"["+e+"]";if(a=VIS.I18N.labels[e],t&&t.length&&t.length>0)for(var s=0;s<t.length;s++)a=a.replace("%"+s,t[s]);return i&&n&&("[object Function]"===Object.prototype.toString.call(i[n])?i[n](a):i[n]=a),a},VIS.I18N.getLabelFromServer=function(e,t,i,n){return"UNDEFINED "+e},VIS.Msg.getMsg=function(e,t,i){if(!VIS.I18N.labels[e])return"["+e+"]";label=VIS.Utility.Util.cleanMnemonic(VIS.I18N.labels[e]);var n=label.split("      ");return t||(label=n[0]),i&&n.length>1&&(label=n[1]),label},VIS.Msg.parseTranslation=function(e,t){if(null==t||0==t.length)return t;for(var i,n=t,a="",s=n.indexOf("@");-1!=s;){a+=n.substring(0,s);var l=(n=n.substring(s+1,n.length)).indexOf("@");if(l<0){n="@"+n;break}i=n.substring(0,l),a+=this.translate(e,i),s=(n=n.substring(l+1,n.length)).indexOf("@")}return a+=n},VIS.Msg.translate=function(e,t,i){if(null==t||0==t.length)return t;if(!i)return VIS.Msg.translate3(VIS.Env.getAD_Language(e),e.isSOTrx(),t);var n=null;return $.ajax({url:VIS.Application.contextUrl+"JsonData/GetTranslatedText",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({Columns:t,AD_Language:VIS.Env.getAD_Language(e)})}).done((function(e){n=e})),n?JSON.parse(n):void 0},VIS.Msg.getElement=function(e,t){return VIS.Msg.getElement3(VIS.Env.getAD_Language(e),t,!0)},VIS.Msg.getElement1=function(e){return VIS.Msg.getElement3(VIS.Env.getAD_Language(VIS.Env.getCtx()),e,!0)},VIS.Msg.translate3=function(e,t,i){if(null==i||i.equals(""))return"";var n=e;null!=n&&0!=n.length||(n=VIS.Env.getBaseAD_Language());var a=VIS.Msg.getElement3(n,i,t);return a.equals("")?(a=VIS.Msg.getMsg(i))&&a.length>0?a:i:a.trim()},VIS.Msg.getElement3=function(e,t,i){var n=VIS.Application.contextUrl+"JsonData/JDataSetWithCode",a=function(e,t,i){var a=!!i,s={sql:e,page:1,pageSize:0};t&&(s.param=t);var l=null;return function(e,t,i){var a=null;$.ajax({url:n,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:t,data:JSON.stringify(e)}).done((function(e){a=e,i&&i(e)}))}(s,a,(function(e){l=(new VIS.DB.DataReader).toJson(e),i&&i(l)})),l};if(null==t||t.equals(""))return"";var s=e;if(null!=s&&0!=s.length||(s=VIS.Env.getBaseAD_Language()),VIS.Msg.elements[t])return VIS.Msg.elements[t];var l="",o="",r=null;try{var d;if(null==s||0==s.length||VIS.Env.isBaseLanguage(s,"AD_Element"))o="VIS_73",(d=[])[0]=new VIS.DB.SqlParam("@ColumnName",t.toUpper()),r=a(o,d);else o="VIS_74",(d=[])[0]=new VIS.DB.SqlParam("@ColumnName",t.toUpper()),d[1]=new VIS.DB.SqlParam("@AD_Language",s),r=a(o,d);if(r.read()&&(l=r.getString(0),!i)){var c=r.getString(1);null!=c&&c.length>0&&(l=c)}r.close()}catch(e){r.close()}return null!=l&&(l=l.trim()),VIS.Msg.elements[t]=l,l}},7849:()=>{!function(e,t){VIS.VApp={init:function(){var i,n;!function(){document.getElementById("vis_mainConatiner").removeChild(document.getElementById("vis_busyGrid"));var t=e("#vis_antiForgeryToken").val();e.ajaxSetup({headers:{VerificationToken:t}}),VIS.Application.isIOS=/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase())}(),i=t.context.getAD_Language().replace("_","-"),Globalize.culture(i),VIS.Ini.updateLocalContextFromIni(),(n=t.Logging).VLogMgt.initialize(!0),n.VLogMgt.setLevel(VIS.Ini.getTraceLevel()),VIS.desktopMgr.start(),VIS.themeMgr.init(),VIS.Env.setWINDOW_PAGE_SIZE(VIS.Ini.getLocalStorage(VIS.IniConstants.WIN_PAGESIZE)),e("#vis_userDate").find("span").text(" "+(new Date).toLocaleDateString(t.context.getAD_Language().replace("_","-"),{weekday:"long",year:"numeric",month:"long",day:"numeric"}))}}}(jQuery,VIS)},907:()=>{VIS.Logging=VIS.Logging||{},function(e,t){function i(e,t){this.name=e,this.value=t}function n(e,t){this._level=e,this._sequenceNumber,this._sourceClassName,this._sourceMethodName,this._message=t,this._lineNumber,this._loggerName}function a(){if(a.prototype.singleInstance)return a.prototype.singleInstance;a.prototype.singleInstance=this}function s(){if(s.prototype.singletonInstance)return s.prototype.singletonInstance;s.prototype.singletonInstance=this}function l(){this.offValue=i.OFF.getIntValue(),this.logLevel=i.ALL,this.formatter,this.filter}function o(){if(o.prototype.singleInstance)return o.prototype.singleInstance;this.setFormatter(s.get()),this.setLevel(i.INFO),this.setFilter(a.get()),this.ERROR_SIZE=20,this.m_errors=[],this.m_history=[],this.LOG_SIZE=100,this.m_logs=[],this.m_issueError=!0,o.prototype.singleInstance=this}function r(e){this.levelValue=i.INFO.getIntValue(),this.name=e,this.levelObject,this.handlers=[],this.kids=[],this.manager=c.getLogManager(),this.parent,this.offValue=i.OFF.getIntValue(),this.filter}function d(){r.call(this,""),this.setLevel(i.INFO)}function c(){if(c.prototype.singleInstance)return c.prototype.singleInstance;this.emptyHandlers=[],this.loggers={},this.defaultLevel=i.INFO,this.rootLogger,c.prototype.singleInstance=this}function p(e){r.call(this,e)}function u(){var e=null,t=i.INFO,n=[i.OFF,i.SEVERE,i.WARNING,i.INFO,i.CONFIG,i.FINE,i.FINER,i.FINEST,i.ALL],l=function(t){null!=t&&(r.getLogger("").addHandler(t),e.push(t))},d=function(t){if(null==e){e=[];try{for(var i=r.getLogger("").getHandlers(),n=0;n<i.length;n++)e.contains(i[n])||e.Add(i[n])}catch(e){}null==o.get(!1)&&l(o.get(!0)),g(s.get()),h(a.get())}},p=function(i){if(null!=i){null==e&&d();for(var n=0;n<e.length;n++){e[n].setLevel(i)}i.getIntValue()!=t.getIntValue()&&u(i,null),t=i}},u=function(e,t){if(null!=e){var i=c.getLogManager().getLoggerNames();for(var n in i){var a=n;if(null==t||-1!=a.indexOf(t))r.getLogger(a).setLevel(e)}}},g=function(t){for(var i=0;i<e.length;i++){e[i].setFormatter(t)}},h=function(t){for(var i=0;i<e.length;i++){e[i].setFilter(t)}};return{initialize:d,addHandler:l,setLevel:p,setLevelByString:function(e){if(e)for(var t=0;t<n.length;t++)if(n[t].getName().equals(e))return void p(n[t])},getLevel:function(){return t},shutdown:function(){c.getLogManager().reset()},enable:function(e){if(e)p(t);else{var n=t;p(i.OFF),t=n}},getIsLevelAll:function(){return i.ALL.getIntValue()==t.getIntValue()},getIsLevelFinest:function(){return i.FINEST.getIntValue()>=t.getIntValue()},getIsLevelFiner:function(){return i.FINER.getIntValue()>=t.getIntValue()},getIsLevelFine:function(){return i.FINE.getIntValue()>=t.getIntValue()},getIsLevelInfo:function(){return i.INFO.IntValue()>=t.IntValue()}}}i.prototype.getIntValue=function(){return this.value},i.prototype.getName=function(){return this.name},i.prototype.getLevel=function(e){return i.OFF.getIntValue()==e?i.OFF:i.SEVERE.getIntValue()==e?i.SEVERE:i.WARNING.getIntValue()==e?i.WARNING:i.INFO.getIntValue()==e?i.INFO:i.CONFIG.getIntValue()==e?i.CONFIG:i.FINE.getIntValue()==e?i.FINE:i.FINER.getIntValue()==e?i.FINER:i.FINEST.getIntValue()==e?i.FINEST:i.ALL.getIntValue()==e?i.ALL:void 0},i.OFF=new i("OFF",9999),i.SEVERE=new i("SEVERE",1e3),i.WARNING=new i("WARNING",900),i.INFO=new i("INFO",800),i.CONFIG=new i("CONFIG",700),i.FINE=new i("FINE",600),i.FINER=new i("FINER",500),i.FINEST=new i("FINEST",400),i.ALL=new i("ALL",0),n.prototype.getMessage=function(){return this._message},n.prototype.setMessage=function(e){this._message=e},n.prototype.getSourceClassName=function(){return this._sourceClassName},n.prototype.setSourceClassName=function(e){this._sourceClassName=e},n.prototype.getSourceMethodName=function(){return this._sourceMethodName},n.prototype.setSourceMethodName=function(e){this._sourceMethodName=e},n.prototype.getLineNumber=function(){return this._lineNumber},n.prototype.setLineNumber=function(e){this._lineNumber=e},n.prototype.getLoggerName=function(){return this._loggerName},n.prototype.setLoggerName=function(e){this._loggerName=e},n.prototype.getLevel=function(){return this._level},a.prototype.singleInstance=null,a.get=function(){return a.prototype.singleInstance?a.prototype.singleInstance:new a},a.prototype.getIsLoggable=function(e){if(e.getLevel()===i.SEVERE||e.getLevel()===i.WARNING)return!0;var t=e.getLoggerName();if(t&&t.startsWith("System."))return!1;var n=e.sourceClassName;return!n||!n.startsWith("System.")},s.prototype.singletonInstance=null,s.prototype.NL="/n",s.get=function(){return s.prototype.singletonInstance?s.prototype.singletonInstance:new s},s.prototype.format=function(e){var t=new StringBuilder,n=Date.now.toString("yyyy-MM-dd hh:mm:ss.ms");if(n+="00",e.getLevel()==i.prototype.SEVERE)t.append("===========> "),t.append("    (SEVERE)   ");else if(e.getLevel()==i.WARNING)t.append("-----------\x3e "),t.append("    (WARNING)  ");else{t.append(n.Substring(11,12));e.getLevel()==i.INFO?t.append("    (INFO)     "):e.getLevel()==i.CONFIG?t.append("    (CONFIG)   "):e.getLevel()==i.FINE?t.append("    (FINE)     "):e.getLevel()==i.FINER?t.append("    (FINER)    "):e.getLevel()==i.FINEST&&t.append("    (FINEST)   ")}return t.append(e.message),t.toString()},s.prototype.getHead=function(){return(new StringBuilder).append("*** ").append(DateTime.Now.ToString()).append(" VAdvantage Log ").append(" ***").append("\n").append("ViennaAdvantage").toString()},s.prototype.getTail=function(){return(new StringBuilder).append("*** ").append(" VAdvantage Log").append(" ***").toString()},s.prototype.getClassMethod=function(e){var t="",i=e.getLoggerName();if(null!=i&&-1==i.indexOf("default")&&-1==i.indexOf("global")||(i=e.getSourceClassName()),null!=i){var n=i.lastIndexOf(".");t+=-1!=n?i.substring(n+1):i}else t+=e.getLoggerName();null!=e.getSourceMethodName()&&(t+="."+e.getSourceMethodName());var a=t;return a.equals("Trace.printStack")?"":a},s.prototype.getParameters=function(e){var t="",i=e.getParameters();if(null!=i&&i.length>0)for(var n=0;n<i.length;n++)n>0&&(t+=", "),t+=i[n];return t},s.prototype.getExceptionTrace=function(e){return""},l.prototype.publish=function(e){},l.prototype.close=function(){},l.prototype.flush=function(){},l.prototype.setLevel=function(e){if(null==e)throw new NullReferenceException("No Level");this.logLevel=e},l.prototype.getLevel=function(){return this.logLevel},l.prototype.getFilter=function(){return this.filter},l.prototype.setFilter=function(e){this.filter=e},l.prototype.getIsLoggable=function(e){var t=this.getLevel().getIntValue();if(e.getLevel().getIntValue()<t||t==this.offValue)return!1;var i=this.getFilter();return null==i||i.getIsLoggable(e)},l.prototype.getFormatter=function(){return this.formatter},l.prototype.setFormatter=function(e){this.formatter=e},e.Utility.inheritPrototype(o,l),o.prototype.singleInstance=null,o.get=function(e){return o.prototype.singleInstance?o.prototype.singleInstance:e?new o:null},o.prototype.setLevel=function(e){null!=e&&(e==i.OFF?this.$super.setLevel.call(this,i.SEVERE):e==i.ALL||e==i.FINEST||e==i.FINER?this.$super.setLevel.call(this,i.FINE):this.$super.setLevel.call(this,e))},o.prototype.publish=function(e){if(this.getIsLoggable(e)&&null!=this.m_logs){if(this.m_logs.length>=this.LOG_SIZE&&this.m_logs.shift(),this.m_logs.push(e),e.getLevel()==i.SEVERE){this.m_errors.length>=this.ERROR_SIZE&&(this.m_errors.shift(),this.m_history.shift()),this.m_errors.push(e);for(var t=[],n=0;n<this.m_logs.length;n++){var a=this.m_logs[n];if(a.getLevel()==i.SEVERE){if(0!=t.length)break;t.push(a)}else if(t.push(a),t.length>10)break}if(this.m_history.push(t),this.m_issueError)e.getLoggerName(),e.getSourceMethodName()}console.log(e)}},o.prototype.close=function(){null!=this.m_logs&&(this.m_logs.length=0,this.m_logs=null),null!=this.m_errors&&(this.m_errors.length=0,this.m_errors=null),null!=this.m_history&&(this.m_history.length=0,this.m_history=null)},o.prototype.getColumnNames=function(e){var t=[4];return t[0]="Time",t[1]="Level",t[2]="Class.Method",t[3]="Message",t},o.prototype.getRecords=function(e){return e?this.m_errors.slice():this.m_logs.slice()},o.prototype.getLogData=function(e){for(var t=this.getRecords(e),i=[],n=0,a=t.length;n<a;n++){var l=t[n],o=[];o.push((new Date).toString()),o.push(l.getLevel().getName()),o.push(s.get().getClassMethod(l)),o.push(l.getMessage()),i.push(o)}return i},o.prototype.resetBuffer=function(e){this.m_errors.length=0,this.m_history.length=0,e||(this.m_logs.length=0)},r.prototype.setFilter=function(e){this.filter=e},r.prototype.getFilter=function(){return this.filter},r.prototype.log=function(e,t,a){if(a&&(a.message&&(t+=" => "+a.message),a.stack&&(t+=" ===> "+a.stack)),!(e.getIntValue()<this.levelValue||this.levelValue==i.OFF.getIntValue())){var s=new n(e,t);if(s.setLoggerName(this.name),null==this.filter||this.filter.getIsLoggable(s))for(var l=this;null!=l;){var o=l.getHandlers();if(null!=o)for(var r=0;r<o.length;r++)o[r].publish(s);l=l.getParent()}}},r.prototype.getParent=function(){return this.parent},r.prototype.getHandlers=function(){return null==this.handlers?emptyHandlers:this.handlers},r.prototype.getName=function(){return this.name},r.prototype.setLevel=function(e){this.levelObject=e,this.levelValue=e.getIntValue()},r.prototype.getLevel=function(){return this.levelObject},r.prototype.addHandler=function(e){null==this.handlers&&(handlers=[]),this.handlers.push(e)},r.prototype.removeHandler=function(e){null!=e&&null!=this.handlers&&this.handlers.remove(e)},r.getLogger=function(e){var t=c.getLogManager(),i=t.getLogger(e);return null==i&&(i=new r(e),t.addLogger(i),i=t.getLogger(e)),i},r.prototype.setParent=function(e){this.parent=e},r.prototype.getIsLoggable=function(e){return!(e.getIntValue()<levelValue||levelValue==offValue)},r.prototype.fine=function(e){i.FINE.getIntValue()<this.levelValue||this.log(i.FINE,e)},r.prototype.info=function(e){i.INFO.getIntValue()<this.levelValue||this.log(i.INFO,e)},r.prototype.config=function(e){i.CONFIG.getIntValue()<this.levelValue||this.log(i.CONFIG,e)},r.prototype.finer=function(e){i.FINER.getIntValue()<this.levelValue||this.log(i.FINER,e)},r.prototype.finest=function(e){i.FINEST.getIntValue()<this.levelValue||this.log(i.FINEST,e)},r.prototype.severe=function(e){i.SEVERE.getIntValue()<this.levelValue||this.log(i.SEVERE,e)},r.prototype.warning=function(e){i.WARNING.getIntValue()<this.levelValue||this.log(i.WARNING,e)},r.prototype.saveError=function(e,t){return this.saveError(e,t.message,!0)},r.prototype.saveError=function(e,t,i){return i&&this.warning(e+" "+t.message),!0},r.prototype.getIsLevelFinest=function(){return u.getIsLevelFinest()},e.Utility.inheritPrototype(d,r),c.prototype.singleInstance=null,c.prototype.addLogger=function(e){var t=e.getName(),i=null;return t in this.loggers&&(i=loggers[t]),null==i&&(this.loggers[t]=e,e instanceof d||e.setParent(this.rootLogger),!0)},c.prototype.reset=function(){for(var e in this.loggers)ResetLogger(e)},c.prototype.resetLogger=function(e){var t=this.getLogger(e);if(null!=t){for(var i=t.getHandlers(),n=0;n<i.length;n++){var a=i[n];t.removeHandler(a);try{a.close()}catch(e){}}null!=e&&e.equals("")?t.setLevel(this.defaultLevel):t.setLevel(null)}},c.prototype.getLogger=function(e){return e in this.loggers?this.loggers[e]:null},c.getLogManager=function(){if(!c.prototype.singleInstance){new c;var e=c.prototype.singleInstance;e.rootLogger=new d,e.addLogger(e.rootLogger)}return c.prototype.singleInstance},c.prototype.getLoggerNames=function(){return this.loggers},e.Utility.inheritPrototype(p,r),p.getVLogger=function(t){var i=c.getLogManager();t||(t="");var n=i.getLogger(t);if(null!=n&&n instanceof p)return n;var a=new p(t);return a.setLevel(e.Logging.VLogMgt.getLevel()),i.addLogger(a),a},e.Logging.Level=i,e.Logging.LogRecord=n,e.Logging.VLogFilter=a,e.Logging.VLogFormatter=s,e.Logging.VLogErrorBuffer=o,e.Logging.Logger=r,e.Logging.VLogger=p,e.Logging.LogManager=c,e.Logging.VLogMgt=u()}(VIS,jQuery)},6649:()=>{!function(e,t){e.DB;var i=e.Logging.Level,n=e.Application.contextUrl,a=n+"JsonData/JDataSetWithCode",s=function(i,n,s){var l=!!s,o={sql:i,page:1,pageSize:0};n&&(o.param=n);var r=null;return function(e,i,n){var s=null;t.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){s=e,n&&n(e)}))}(o,l,(function(t){r=(new e.DB.DataReader).toJson(t),s&&s(r)})),r};function l(e,t,i,n,a){this.info=e,this.lookup=null,this.allLoaded=!1,this.hasInactive=!1,this.displayType=a,this.selectedObject,this.windowNo=n,this.validationDisabled=!1,this.tabNo=0,this.colName="",this.data=[],this.ctx=i,t&&(this.lookup=t._lookup,this.allLoaded=t._allLoaded,this.hasInactive=t._hasInactive,this.displayType=t._displayType,this.windowNo=t._WindowNo,this.tabNo=t._TabNo,this.colName=t._columnName,this.info&&(this.info.windowNo=t._WindowNo))}function o(t,i,n,a,s,o){if(l.call(this,t,i),this.lookupDirect={},this.directNullKey,this.AD_Window_ID=n,this.AD_Field_ID=a,this.AD_Tab_ID=s,this.lookupData=o,this.loading=!1,!this.lookupData){var r=t.keyColumn;r&&r.indexOf(".")>-1&&(r=r.substring(r.indexOf(".")+1)),this.lookupData={ctx:e.context.getWindowCtx(t.windowNo),windowNo:t.windowNo,column_ID:t.column_ID,AD_Reference_ID:i._displayType,columnName:r,AD_Reference_Value_ID:t.AD_Reference_Value_ID,isParent:t.isParent,validationCode:e.secureEngine.encrypt(t.validationCode)}}this.nextRead=0,this.cLookup=!1,this.lookupDirectAll={},this.zomQuery=null,this.prepareZQuery(),this.log=e.Logging.VLogger.getVLogger("MLookup")}function r(t,i){l.call(this,null,null,t,i,e.DisplayType.TableDir),this.lookup={},this.load()}function d(t,i){l.call(this,null,null,t,i,e.DisplayType.TableDir),this.C_Locator_ID=0,this.OnlyOrgID=0,this.onlyWarehouseID=0,this.onlyProductID=0,this.onlyOutgoing=!1,this.lookup={},this.maxRows=1e4,this.defaultID="",this.log=e.Logging.VLogger.getVLogger("MLocatorLookup"),this.load(!1),this.disposeLocal=function(){this.lookup=null,this.log=null}}function c(t,i){l.call(this,null,null,t,i,e.DisplayType.TableDir),this.log=e.Logging.VLogger.getVLogger("MAccountLookup"),this.C_ValidCombination_ID=0,this.combination,this.description,this.lst={}}function p(t,i){l.call(this,null,null,t,i,e.DisplayType.TableDir),this.NO_INSTANCE={Key:0,Name:""},this.log=e.Logging.VLogger.getVLogger("MPAttributeLookup")}function u(t,i){l.call(this,null,null,t,i,e.DisplayType.TableDir),this.NO_INSTANCE={Key:0,Name:""},this.log=e.Logging.VLogger.getVLogger("MGAttributeLookup")}function g(t,i){l.call(this,null,null,t,i,e.DisplayType.AmtDimension),this.lookup={}}function h(t,i){l.call(this,null,null,t,i,e.DisplayType.ProductContainer),this.log=e.Logging.VLogger.getVLogger("MProductContainerLookup"),this.lookup={}}l.prototype.INACTIVE_S="~",l.prototype.INACTIVE_E="~",l.prototype.MAX_ROWS=1e4,l.prototype.MINUS_ONE=-1,l.prototype.getValidation=function(){return""},l.prototype.getWindowNo=function(){return this.windowNo},l.prototype.getTabNo=function(){return this.tabNo},l.prototype.setTabNo=function(e){this.tabNo=e},l.prototype.getFieldColName=function(){return this.colName},l.prototype.getDisplayType=function(){return this.displayType},l.prototype.setDisplayType=function(e){this.displayType=e},l.prototype.disableValidation=function(){this.validationDisabled=!0},l.prototype.getIsValidationDisabled=function(){return this.validationDisabled},l.prototype.getIsValidated=function(){return!0},l.prototype.getHasInactive=function(){return this.hasInactive},l.prototype.getData=function(e,t,i,n){return[]},l.prototype.getDisplay=function(e){return""},l.prototype.getSelectedItem=function(){return this.selectedObject},l.prototype.fillCombobox=function(e,t,i,n){var a=this.selectedObject;null!=this.data&&(this.data.length=0),this.data=this.getData(e,t,i,n);var s=0;null!=this.data&&(s=this.data.length),a!=this.selectedObject&&(a=this.selectedObject),null==a&&e&&s>0&&(a=this.data[0],this.selectedObject=a)},l.prototype.setSelectedItem=function(e){(null!=this.selectedObject&&this.selectedObject!==e||null==this.selectedObject&&null!=e)&&this.setSelectedItemAlways(e)},l.prototype.setSelectedItemAlways=function(e){this.data.indexOf(e)>-1||null==e?this.selectedObject=e:this.selectedObject=null},l.prototype.refresh=function(){return 0},l.prototype.getZoomQuery=function(){return null},l.prototype.getColumnName=function(){return this.info.keyColumn},l.prototype.dispose=function(){this.info=null,this.lookup=null,this.allLoaded=null,this._hasInactive=null,this.selectedObject=null,this.data=null,this.ctx=null},l.prototype.removeAllElements=function(){this.data.length>0&&(this.data.length=0,this.selectedObject=null)},l.prototype.clear=function(){this.removeAllElements()},l.prototype.gethasImageIdentifier=function(){return!1},e.Utility.inheritPrototype(o,l),o.prototype.prepareZQuery=function(){if(null!=this.info.zoomQuery&&!t.isEmptyObject(this.info.zoomQuery)){var i=this.info.zoomQuery;this.zomQuery=new e.Query(i._tableName);for(var n=null,a=0;a<i._list.length;a++){var s=i._list[a];n=new e.QueryRestriction(s.ColumnName,s.Code,s.Code_to,s.InfoName,i.InfoDisplay,s.InfoDisplay_to,s.Operator,s.DirectWhereClause,s.AndCondition),this.zomQuery.addRestriction(n)}}},o.prototype.initialize=function(t){return t?this:this.info.isParent||this.info.isKey?(this.hasInactive=!0,this):(this.getDisplayType()==e.DisplayType.Search||this.info.isCreadedUpdatedBy||(this.info.isValidated?this.load(!0,!0):this.fillDirectList()),this)},o.prototype.getValidation=function(){return this.getIsValidationDisabled()?"":this.info.validationCode},o.prototype.getIsValidated=function(){return!!this.getIsValidationDisabled()||null!=this.info&&this.info.isValidated},o.prototype.getData=function(e,t,i,n){var a=this.getData2(t,n);if(i&&this.hasInactive)for(var s=a.length;s>0;s--){var l=a[s-1];if(null!=l){var o=l.Name;o.startsWith(this.INACTIVE_S)&&o.endsWith(this.INACTIVE_E)&&(console.log(o),a.splice(s-1,1))}}if(!e){var r=null;r=null!=this.info.keyColumn&&this.info.keyColumn.toUpperCase().endsWith("_ID")?{Key:-1,Name:""}:{Key:"",Name:""},a.unshift(r)}return a},o.prototype.getData2=function(e,i){return this.allLoaded&&!t.isEmptyObject(this.lookup)||this.refresh(i),this.info.isValidated||!this.info.isValidated&&e&&this.refresh(i),this.getObjectArray(this.lookup)},o.prototype.getObjectArray=function(e){var t=[],i=0;for(var n in e)t[i++]=e[n];return t},o.prototype.getDisplay=function(t,i,n){if(null==t)return"";var a=i?this.getFromList(t):this.get(t);return null==a?"<"+t.toString()+">":n?a.Name:e.Utility.Util.getIdentifierDisplayVal(a.Name)},o.prototype.getLovIconType=function(e,t){var i=this.lookup[" "+e];if(i)return i.icoType},o.prototype.getLOVIconElement=function(t,i,n){var a=this.lookup[" "+t];if(a){var s=a.ico,l=a.icohtml;if(l=l?" style='"+l+"'":"",s){if(s.indexOf(" ")>-1)return n?s:"<i class='"+s+"'"+l+"></i>";var o=s.substring(s.indexOf("Images/")+7);return o=e.Application.contextUrl+"Images/Thumb32x32/"+o,n?o:"<img src='"+o+"'"+l+"></img>"}}},o.prototype.getLOVIconStyle=function(e){var t=this.lookup[" "+e];if(t)return t.icohtml},o.prototype.get=function(i){if(null==i||this.MINUS_ONE===i)return null;this.info.isParent&&this.nextRead<Date.now()&&(this.nextRead=Date.now()+2e3);var n=this.lookup[" "+i];if(n)return n;if(!this.info.isParent&&this.info.isValidated&&this.allLoaded&&this.getDirect(i,!1,!0),!this.allLoaded&&t.isEmptyObject(this.lookup)&&!this.info.isCreadedUpdatedBy&&!this.info.isParent&&this.getDisplayType()!=e.DisplayType.Search&&(this.load(),null!=(n=this.lookup[" "+i])))return n;return this.getDirect(i,!1,!0)},o.prototype.getFromList=function(i){if(null==i||this.MINUS_ONE===i)return null;if(this.info.isParent&&this.nextRead<Date.now())return this.nextRead=Date.now()+2e3,this.get(i);var n;if(null!=(n=this.lookup[" "+i]))return n;if(!this.info.isParent&&this.info.isValidated&&this.allLoaded&&this.getDirectFromList(i,!1,!0),!this.allLoaded&&t.isEmptyObject(this.lookup)&&!this.info.isCreadedUpdatedBy&&!this.info.isParent&&this.getDisplayType()!=e.DisplayType.Search&&null!=(n=this.lookup[" "+i]))return n;var a=this.info.isValidated;return this.getDirectFromList(i,!1,a)},o.prototype.getDirect=function(i,n,a){if(null==i||null==this.info.queryDirect||0==this.info.queryDirect.length)return null;if(i===this.directNullKey)return null;var s=null;if(null!=this.lookupDirect&&(s=this.lookupDirect[i]))return s;var l=this.info.keyColumn.toUpperCase().endsWith("_ID");try{var o=this;t.ajax({url:e.Application.contextUrl+"Lookup/GetLookupDirect",async:!1,type:"post",data:{WindowNo:o.getWindowNo(),AD_Window_ID:o.AD_Window_ID,AD_Tab_ID:o.AD_Tab_ID,AD_Field_ID:o.AD_Field_ID,Key:i,IsNumber:l,LookupData:JSON.stringify(o.lookupData)},success:function(t){var a=(new e.DB.DataReader).toJson(t);if(a.read()){var r=a.getString(2);if(a.getString(3).equals("Y")||(r=o.INACTIVE_S+r+o.INACTIVE_E,o.hasInactive=!0),l){var d=a.getInt(0),c={Key:d,Name:e.Utility.encodeText(r)};n&&(o.lookup[" "+d]=c),s=c}else{var p=a.getString(1),u={Key:p,Name:e.Utility.encodeText(r)};n&&(o.lookup[" "+p]=u),s=u}a.read()&&o.log.log(e.Logging.Level.SEVERE,o.info.keyColumn+": Not unique (first returned) for "+i)}else o.directNullKey=i,s=null},error:function(t){o.log.log(e.Logging.Level.SEVERE,t)}})}catch(t){this.log.log(e.Logging.Level.SEVERE,this.info.keyColumn+": SQL="+this.info.queryDirect+"; Key="+i,t),s=null}return a&&!n&&null!=s&&(null==this.lookupDirect&&(this.lookupDirect={}),this.lookupDirect[i]=s),this.hasInactive=!0,s},o.prototype.getDirectFromList=function(t,i,n){if(null==t||null==this.info.queryDirect||0==this.info.queryDirect.length)return null;if(t===this.directNullKey)return null;var a,s=null;if(null!=this.lookupDirect){var l;if((l=this.lookupDirect[" "+t])&&null!=l)return l}if(!this.lookupDirectAll[" "+t]){var o=this.getFieldColName(),r=e.MLookupCache.getRecordLookup(this.getWindowNo(),this.getTabNo(),o,t);if(r||!r&&0==t){var d={Key:t,Name:e.Utility.encodeText(r)};this.lookupDirectAll[" "+t]=d}}return this.lookupDirectAll[" "+t]?(a=this.lookupDirectAll[" "+t],i&&(this.lookup[" "+t]=a),s=a):this.loading||(this.addInList(t),s=null),n&&!i&&null!=s&&(null==this.lookupDirect&&(this.lookupDirect={}),this.lookupDirect[" "+t]=s),this.hasInactive=!0,s},o.prototype.addInList=function(i){if(!(this.info.queryDirect.length<=0||null==i)){var n=this.info.keyColumn.toUpperCase().endsWith("_ID"),a=(this.info.queryDirect,this);t.ajax({url:e.Application.contextUrl+"Lookup/GetLookupDirect",type:"post",data:{WindowNo:a.getWindowNo(),AD_Window_ID:a.AD_Window_ID,AD_Tab_ID:a.AD_Tab_ID,AD_Field_ID:a.AD_Field_ID,Key:i,IsNumber:n,LookupData:JSON.stringify(a.lookupData)},type:"post",success:function(t){var s=(new e.DB.DataReader).toJson(t);if(s.read()){var l=s.getString(2);if(n){var o=e.Utility.Util.getValueOfInt(s.getCell(0));a.lookupDirectAll[" "+o]={Key:o,Name:e.Utility.encodeText(l)}}else{var r=s.getString(1);a.lookupDirectAll[" "+r]={Key:r,Name:e.Utility.encodeText(l)}}}else a.directNullKey=i},error:function(){}})}},o.prototype.load=function(i,n){var a=this.info.query,s="";this.info.isValidated||(s=e.Env.parseContext2(e.context,this.getWindowNo(),this.getTabNo(),this.info.validationCode,!1,!0));var l=this.info.keyColumn.toUpperCase().endsWith("_ID");this.hasInactive=!1;if(this.lookup={},n&&(this.cLookup=!1,e.MLookupCache.loadFromCache(this.info,this)))return this;var o=1e3,r=this;return i?r.loading=!0:(i=!1,o=0),t.ajax({url:e.Application.contextUrl+"Lookup/GetLookupData",async:i,type:"post",data:{WindowNo:r.getWindowNo(),AD_Window_ID:r.AD_Window_ID,AD_Tab_ID:r.AD_Tab_ID,AD_Field_ID:r.AD_Field_ID,Values:JSON.stringify(s),PageSize:o,LookupData:JSON.stringify(r.lookupData)},success:function(t){var i=(new e.DB.DataReader).toJson(t);r.readData(i,l),n&&e.MLookupCache.loadEnd(r.info,r),r.loading=!1,r=null},error:function(t){r.log.log(e.Logging.Level.SEVERE,r.info.keyColumn+": Loader - "+a,t)}}),0},o.prototype.fillDirectList=function(){if(!(null==this.info.queryAll||this.info.queryAll.length<=0)){this.info.queryAll;if(this.cLookup=!0,!e.MLookupCache.loadFromCache(this.info,this)){var i=this;t.ajax({url:e.Application.contextUrl+"Lookup/GetLookupAll",type:"post",data:{WindowNo:i.getWindowNo(),AD_Window_ID:i.AD_Window_ID,AD_Tab_ID:i.AD_Tab_ID,AD_Field_ID:i.AD_Field_ID,PageSize:100,LookupData:JSON.stringify(i.lookupData)},success:function(t){for(var n=i.info.keyColumn.endsWith("_ID"),a=(new e.DB.DataReader).toJson(t);a.read();){var s=a.getString(2);if(n){var l=a.getInt(0);i.lookupDirectAll[" "+l]={Key:l,Name:e.Utility.encodeText(s)}}else{var o=a.getString(1);i.lookupDirectAll[" "+o]={Key:o,Name:e.Utility.encodeText(s)}}}e.MLookupCache.loadEnd(i.info,i),i.loading=!1,i=null},error:function(e){}}),this.loading=!0}}},o.prototype.readData=function(t,i){var n={},a=0;for(this.allLoaded=!0;t.read();){if(a++>this.MAX_ROWS){this.log.fine(this.info.keyColumn+": Loader - Too many records"),this.allLoaded=!1;break}var s,l=t.getString(2),o={};if(t.getString(3).equals("Y")||(l=this.INACTIVE_S+l+this.INACTIVE_E,this.hasInactive=!0),o=i?{Key:s=t.getInt(0),Name:e.Utility.encodeText(l)}:{Key:s=t.getString(1),Name:e.Utility.encodeText(l)},t.tables[0].columns.length>4){var r=t.getString(4);if(r&&r.length>0){var d=r.split("|");o.ico=d[0],o.icohtml=d[1]}else o.ico=r;o.icoType=t.getString(5)}n[" "+s]=o}this.lookup=null,this.lookup=n,this.loading=!1},o.prototype.refresh=function(){return this.getDisplayType()==e.DisplayType.Search||this.info.IsCreadedUpdatedBy||this.loading?0:this.load()},o.prototype.clear=function(){this.$super.clear.call(this),this.lookup={}},o.prototype.getCLookup=function(){return this.cLookup&&this.lookupDirectAll,this.lookup},o.prototype.setCLookup=function(e){this.cLookup&&(this.lookupDirectAll=e),this.lookup=e},o.prototype.getIsLoading=function(){return this.loading},o.prototype.setIsLoading=function(e){this.loading=e},o.prototype.getZoomWindow=function(){if(0==arguments.length)return this.info.zoomWindow;var t=arguments[0];return e.ZoomTarget.getZoomAD_Window_ID(this.info.tableName,this.windowNo,t.getWhereClause(),e.context.isSOTrx(this.windowNo))},o.prototype.getZoomQuery=function(){return this.zomQuery},o.prototype.getAD_Reference_Value_ID=function(){return this.info.AD_Reference_Value_ID},o.prototype.gethasImageIdentifier=function(){return this.info.hasImageIdentifier},o.prototype.disableValidation=function(){var t=this.info.validationCode;this.$super.disableValidation.call(this),this.info.isValidated=!0,this.info.validationCode="",null!=t&&t.length>0&&(-1!=t.indexOf("@")&&this.getDisplayType()==e.DisplayType.Table||this.getDisplayType()==e.DisplayType.TableDir)&&this.setDisplayType(e.DisplayType.Search)},o.prototype.dispose=function(){this.$super.dispose.call(this),this.lookupDirect=null,this.directNullKey=null,this.log=null},e.Utility.inheritPrototype(r,l),r.prototype.cacheLookup=null,r.prototype.getDisplay=function(e){if(null==e)return"";var t=this.getLocation(e,null);return null==t?"<"+e.toString()+">":t.Name},r.prototype.get=function(e){if(null==e)return null;var t=this.getLocation(e,null);return null==t?null:t},r.prototype.getColumnName=function(){return"C_Location_ID"},r.prototype.getLocation=function(t,i){if(null==t)return null;if(i){if(t in this.lstLatLng)return this.lstLatLng[t]}else if(t in this.lookup)return this.lookup[t];if(e.context.getLocationBulkReload()){var n=e.dataContext.getJSONData(e.Application.contextUrl+"Location/GetLocation",{id:t});return this.lookup[t]=n.LocItem,this.lstLatLng[t]=n.LocLatLng,i?n.LocLatLng:n.LocItem}var a=this;return e.dataContext.getJSONData(e.Application.contextUrl+"Location/GetLocation",{id:t},(function(e){t in a.lookup||(a.lookup[t]=e.LocItem,a.lstLatLng[t]=e.LocLatLng)})),null},r.prototype.refreshLocation=function(t){if(null==t)return null;var i=e.dataContext.getJSONData(e.Application.contextUrl+"Location/GetLocation",{id:t});return this.lookup[t]=i.LocItem,this.lstLatLng[t]=i.LocLatLng,i},r.prototype.load=function(){var t=this;if(t.lstLatLng={},null!=r.prototype.cacheLookup)return t.lookup=r.prototype.cacheLookup.LocLookup,t.lstLatLng=r.prototype.cacheLookup.LocLatLng,void(t=null);e.dataContext.getJSONData(e.Application.contextUrl+"Location/GetLocations","",(function(e){r.prototype.cacheLookup||(r.prototype.cacheLookup=e),t.lookup=e.LocLookup,t.lstLatLng=e.LocLatLng,t=null}))},r.prototype.getLatLng=function(e){return null==e||e.toString().len<1?null:e in this.lstLatLng?this.lstLatLng[e]:this.getLocation(e,!0)},r.prototype.dispose=function(){this.lstLatLng=null,this.$super.dispose.call(this),this.lookup=null},e.Utility.inheritPrototype(d,l),d.prototype.getDefault=function(){return this.defaultID},d.prototype.getOnlyOrgID=function(){return this.OnlyOrgID},d.prototype.getOnlyWarehouseID=function(){return this.onlyWarehouseID},d.prototype.getOnlyProductId=function(){return this.onlyProductID},d.prototype.getIsOnlyOutgoing=function(){return this.onlyOutgoing},d.prototype.setOnlyOrgID=function(e){this.OnlyOrgID=e},d.prototype.setOnlyWarehouseID=function(e){this.onlyWarehouseID=e},d.prototype.setOnlyProductID=function(e){this.onlyProductID=e},d.prototype.setOnlyOutgoing=function(e){this.onlyOutgoing=e},d.prototype.getDirect=function(t,i,n){if(null==t)return null;var a=[];a[0]=new e.DB.SqlParam("@keyValue",t);var l=s("VIS_92",a),o="";if(!l.read())return null;o=l.getString(0),l.dispose();var r={Key:t,Name:e.Utility.encodeText(o)};return i&&(this.lookup[" "+t]=r),r},d.prototype.getIsValid=function(e){return null==e||null!=this.lookup[e]},d.prototype.load=function(i){var n=0,a=this.getOnlyOrgID(),s=this.getOnlyWarehouseID(),l=this.getOnlyProductId(),o=this.getIsOnlyOutgoing(),r="1";this.lookup=null,this.lookup={},o=null==o||!o.value;try{var d=null;if(i){t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetWareProWiseLocator",data:{colName:r,orgId:a,warehouseId:s,productId:l,onlyIsSOTrx:o},success:function(t){d=(new e.DB.DataSet).toJson(t)}});for(var c=d.getTable(0),p=c.getRows().length,u=0;u<p;u++){if(n++>this.maxRows){this.log.warning("Over Max Rows - "+n);break}var g=e.Utility.Util.getValueOfString(c.getRow(u).getCell(4))+"_"+e.Utility.Util.getValueOfString(c.getRow(u).getCell(1))+"("+e.Utility.Util.getValueOfString(c.getRow(u).getCell(2))+")";this.lookup[c.getRow(u).getCell(0)]={Key:c.getRow(u).getCell(0),Name:g}}d.dispose(),d=null,this.log.fine("Complete #"+n)}else{var h=this;t.ajax({type:"Get",async:!0,url:e.Application.contextUrl+"Form/GetWareProWiseLocator",data:{colName:r,orgId:a,warehouseId:s,productId:l,onlyIsSOTrx:o},success:function(t){d=(new e.DB.DataSet).toJson(t);try{for(var i=d.getTable(0),a=i.getRows().length,s=0;s<a;s++){if(n++>h.maxRows){h.log.warning("Over Max Rows - "+n);break}h.lookup[i.getRow(s).getCell(0)]={Key:i.getRow(s).getCell(0),Name:e.Utility.Util.getValueOfString(i.getRow(s).getCell(1))}}d.dispose(),d=null,h.log.fine("Complete #"+n)}catch(t){h.log(e.Logging.Level.SEVERE,"",t)}h=null}})}}catch(t){this.log.log(e.Logging.Level.SEVERE,finalSql,t)}i&&t.isEmptyObject(this.lookup)&&this.log.Finer(finalSql)},d.prototype.get=function(e){if(null==e)return null;var t=Number(e),i=this.lookup[t];return null!=i?i:this.getDirect(e,!0,null)},d.prototype.getDisplay=function(e){if(null==e)return"";var t=this.get(e);return null==t?"<"+e.toString()+">":t.Name},d.prototype.getData=function(e,i,n,a){this.lookup;return t.map(this.lookup,(function(e){return e}))},d.prototype.refresh=function(){this.log.fine("start");try{this.load(!0)}catch(e){this.log.severe("#"+this.lookup.Count)}return this.log.info("#"+this.lookup.Count),this.lookup.length},d.prototype.getColumnName=function(){return"M_Locator.M_Locator_ID"},d.prototype.getZoomWindow=function(){if(0==arguments.length)return this.info.zoomWindow;var t=arguments[0];return e.ZoomTarget.getZoomAD_Window_ID("M_Locator",this.windowNo,t.getWhereClause(),e.context.isSOTrx(this.windowNo))},d.prototype.dispose=function(){this.disposeLocal(),this.$super.dispose.call(this),this.lookupDirect=null,this.directNullKey=null,this.log=null,this.disposeLocal=null},e.Utility.inheritPrototype(c,l),c.prototype.getDisplay=function(e){return this.containsKey(e)?this.toStringX():"<"+e.toString()+">"},c.prototype.toStringX=function(){return 0==this.C_ValidCombination_ID?"":this.combination},c.prototype.containsKey=function(e){var t=0;return null!=e&&(t=parseInt(e.toString())),this.load(t)},c.prototype.load=function(t){if(0==t)return this.C_ValidCombination_ID=0,this.combination="",this.description="",!0;if(t==this.C_ValidCombination_ID)return!0;var i=this.lst[t];if(i)return this.C_ValidCombination_ID=t,this.combination=i.C,this.description=i.D,!0;var n=e.MLookupCache.getRecordLookup(this.getWindowNo(),this.getTabNo(),"c_validcombination_id",t);if(n)return i={C:n,D:"-"},this.C_ValidCombination_ID=t,this.combination=i.C,this.description=i.D,this.lst[t]=i,!0;var a=[];a[0]=new e.DB.SqlParam("@ID",t);var l=this;return s("VIS_94",a,(function(e){try{if(!e.read())return!1;l.lst[e.getInt(0)]={C:e.getString(1),D:e.getString(2)}}catch(e){return!1}})),!1},c.prototype.getColumnName=function(){return""},c.prototype.getData=function(n,a,s,l){var o=[];n||o.push({Key:-1,Name:""});var r=null;try{for(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetValidAccountCombination",data:{AD_Client_ID,onlyActive:s},success:function(t){r=(new e.DB.DataReader).toJson(jString)}});r.read();)o.push({Key:r.getInt(0),Name:r.getString(1)+" - "+r.getString(2)})}catch(e){this.log.log(i.SEVERE,sql,e)}return o},e.Utility.inheritPrototype(p,l),p.prototype.getDisplay=function(e){if(null==e)return"";var t=this.get(e);return null==t?"<"+e.toString()+">":t.Name},p.prototype.get=function(t){if(null==t)return null;var n=0;if(t instanceof Number)n=t;else try{n=parseInt(t.toString())}catch(e){this.log.log(i.SEVERE,"Value="+t,e)}if(0==n)return this.NO_INSTANCE;var a=null;try{var l=[];l[0]=new e.DB.SqlParam("@M_AttributeSetInstance_ID",n);var o=s("VIS_95",l);o.read()&&(null!=(a=o.getString(0))&&0!=a.length||(a=e.Logging.VLogMgt.getIsLevelFine()?"{"+n+"}":"")),o.dispose(),o=null}catch(e){this.log.log(i.SEVERE,"get",e)}return null==a?null:{Key:n,Name:a}},p.prototype.getColumnName=function(){return"M_AttributeSetInstance_ID"},p.prototype.dispose=function(){this.$super.dispose.call(this),this.NO_INSTANCE=null,this.log=null},e.Utility.inheritPrototype(u,l),u.prototype.getDisplay=function(e){if(null==e)return"";var t=this.get(e);return null==t?"<"+e.toString()+">":t.Name},u.prototype.get=function(t){if(null==t)return null;var n=0;if(t instanceof Number)n=t;else try{n=parseInt(t.toString())}catch(e){this.log.log(i.SEVERE,"Value="+t,e)}if(0==n)return this.NO_INSTANCE;var a=null;try{var l=[];l[0]=new e.DB.SqlParam("@C_GenttributeSetInstance_ID",n);var o=s("VIS_96",l);o.read()&&(null!=(a=o.getString(0))&&0!=a.length||(a=e.Logging.VLogMgt.getIsLevelFine()?"{"+n+"}":"")),o.dispose(),o=null}catch(e){this.log.log(i.SEVERE,"get",e)}return null==a?null:{Key:n,Name:a}},u.prototype.getColumnName=function(){return"C_GenAttributeSetInstance_ID"},u.prototype.dispose=function(){this.$super.dispose.call(this),this.NO_INSTANCE=null,this.log=null},u.prototype.getData=function(n,a,s,l){var o=[];n||o.push({Key:-1,Name:""});var r=null;try{for(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GenAttributeSetInstance",data:{C_GenAttributeSet_ID:e.Env.getCtx().getContextAsInt(this.windowNo,"C_GenAttributeSet_ID"),onlyActive:s},success:function(t){r=(new e.DB.DataReader).toJson(jString)}});r.read();)o.push({Key:r.getInt(0),Name:r.getString(1)+" - "+r.getString(2)})}catch(e){this.log.log(i.SEVERE,sql,e)}return o},e.MLookupFactory={get:function(t,i,n,a,s,l,o,r){r&&r.length>0&&(r=e.secureEngine.encrypt(r)),n&&(n=e.Utility.Util.getValueOfInt(n));var d={ctx:t.getWindowCtx(i),windowNo:i,column_ID:n,AD_Reference_ID:a,columnName:s,AD_Reference_Value_ID:l,isParent:o,validationCode:r},c=e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/GetLookup",d);return new e.MLookup(c._vInfo,c,0,0,0,d)},getMLookUp:function(t,i,n,a){var l="",o=0,r=!1,d="";n&&(n=e.Utility.Util.getValueOfInt(n));var c=null;try{var p=[];p[0]=new e.DB.SqlParam("@Column_ID",n),(c=s("VIS_97".toString(),p,null)).read()&&(l=c.getString(0),o=c.getInt(1),r="Y".equals(c.getString(2)),d=c.getString(3)),c.close(),c=null}catch(e){null!=c&&(c.close(),c=null)}return e.MLookupFactory.get(t,i,n,a,l,o,r,d)},GetLookUpInfo:function(t,i,n,a,s,l,o,r){a&&(a=e.Utility.Util.getValueOfInt(a))}},e.MLookupCache={s_log:e.Logging.VLogger.getVLogger("MLookupCache"),s_loadedLookups:new e.CCache("MLookupCache"),s_sentLookups:new e.CCache("MLookupCacheSent"),s_windowLookup:{},s_windowRecordLookup:{},getKey:function(t){if(null==t)return e.Env.currentTimeMillis();var i=t.windowNo+":";return i+=":"+t.keyColumn+t.AD_Reference_Value_ID+t.query+t.validationCode},loadFromCache:function(e,i){var n=this.getKey(e),a=null,s=!0;return this.s_loadedLookups.contains(n)&&(a=this.s_loadedLookups.get(n)),null==a&&(s=!1),s&&t.isEmptyObject(a)&&(this.s_loadedLookups.remove(n),s=!1),s&&(i.setCLookup(jQuery.extend({},a)),i.setIsLoading(!1)),s||(s=!0,this.s_sentLookups.contains(n)?-1==this.s_sentLookups.get(n).indexOf(i)&&(i.setIsLoading(!0),this.s_sentLookups.get(n).push(i)):(this.s_sentLookups.add(n,[]),s=!1)),s},loadEnd:function(e,i){var n=this.getKey(e);if(i.getCLookup()&&!t.isEmptyObject(i.getCLookup())){if(this.s_loadedLookups.add(n,i.getCLookup()),this.s_sentLookups.contains(n)){if((l=this.s_sentLookups.get(n)).length>0);for(var a=0;a<l.length;a++){var s=l[a];s.setCLookup(t.extend({},i.getCLookup())),s.setIsLoading(!1)}l.length=0,this.s_sentLookups.remove(n)}}else if(this.s_sentLookups.contains(n)){var l=this.s_sentLookups.get(n);for(a=0;a<l.length;a++)l[a].setIsLoading(!1);l.length=0,this.s_sentLookups.remove(n)}},cacheReset:function(e){for(var t=e.toString()+":",i=(this.s_loadedLookups.size(),[]),n=0,a=this.s_loadedLookups.m_cacheK.length;n<a;n++){var s=this.s_loadedLookups.m_cacheK[n];try{null!=s&&s.startsWith(t)&&i.push(s)}catch(e){}}for(var l=0;l<i.length;l++)this.s_loadedLookups.remove(i[l]);this.s_loadedLookups.size();for(var o in this.s_windowRecordLookup)o.startsWith(t)&&delete this.s_windowRecordLookup[o]},addWindowLookup:function(e,t){if(this.s_windowLookup[e])this.s_windowLookup[e].push(t);else{var i=[];i.push(t),this.s_windowLookup[e]=i}},initWindowLookup:function(e){if(this.s_windowLookup[e]){for(var t=this.s_windowLookup[e],i=0,n=t.length;i<n;i++)t[i].initialize();t.length=0,delete this.s_windowLookup[e]}},addRecordLookup:function(e,t,i){var n=e+":"+t;this.s_windowRecordLookup[n]=i},getRecordLookup:function(e,t,i,n){var a=this.s_windowRecordLookup[e+":"+t];return a&&i in a?a[i][n]:null}},e.Utility.inheritPrototype(g,l),g.prototype.cacheLookup=null,g.prototype.getDisplay=function(e){if(null==e)return"";var t=this.get(e);return null==t?"<"+e.toString()+">":t},g.prototype.get=function(t){if(null==t)return null;var n=0;if(t instanceof Number)n=t;else try{n=parseInt(t.toString())}catch(e){this.log.log(i.SEVERE,"Value="+t,e)}if(n in this.lookup)return this.lookup[n];if(0==n)return this.NO_INSTANCE;var a=null;try{var l=[];l[0]=new e.DB.SqlParam("@C_DimAmt_ID",n);var o=s("VIS_99",l);o.read()&&(null!=(a=o.getString(0))&&0!=a.length||(a=e.Logging.VLogMgt.getIsLevelFine()?"{"+n+"}":"")),o.dispose(),o=null,this.lookup[n]=a}catch(e){this.log.log(i.SEVERE,"get",e)}return null==a?null:a},g.prototype.getColumnName=function(){return"C_DimAmt_ID"},g.prototype.refreshAmountDivision=function(t){if(null==t)return null;var n=0;if(t instanceof Number)n=t;else try{n=parseInt(t.toString())}catch(e){this.log.log(i.SEVERE,"Value="+t,e)}if(0==n)return this.NO_INSTANCE;var a=null;try{var l=[];l[0]=new e.DB.SqlParam("@C_DimAmt_ID",n);var o=s("VIS_99",l);o.read()&&(null!=(a=o.getString(0))&&0!=a.length||(a=e.Logging.VLogMgt.getIsLevelFine()?"{"+n+"}":"")),o.dispose(),o=null,this.lookup[n]=a}catch(e){this.log.log(i.SEVERE,"get",e)}return null==a?null:a},g.prototype.dispose=function(){this.lstLatLng=null,this.$super.dispose.call(this),this.lookup=null},e.Utility.inheritPrototype(h,l),h.prototype.cacheLookup=null,h.prototype.getDisplay=function(e){if(null==e)return"";var t=this.get(e);return null==t?"<"+e.toString()+">":t.Name},h.prototype.get=function(a){if(null==a)return null;var s=0;if(a instanceof Number)s=a;else try{s=parseInt(a.toString())}catch(e){this.log.log(i.SEVERE,"Value="+a,e)}if(s in this.lookup)return this.lookup[s];if(0==s)return this.NO_INSTANCE;var l=null;return t.ajax({url:n+"ProductContainer/GetProductContainerInfo",data:{ID:s},async:!1,success:function(t){l=t||(e.Logging.VLogMgt.getIsLevelFine()?"{"+s+"}":"")},error:function(e){this.log.log(i.SEVERE,"get",e)}}),this.lookup[s]=l,null==l?null:{Key:s,Name:l}},h.prototype.getColumnName=function(){return"M_ProductContainer_ID"},h.prototype.dispose=function(){this.lstLatLng=null,this.$super.dispose.call(this),this.lookup=null},e.MLookup=o,e.MLocationLookup=r,e.MAccountLookup=c,e.MPAttributeLookup=p,e.MGAttributeLookup=u,e.MLocatorLookup=d,e.MAmtDivLookup=g,e.MProductContainerLookup=h}(VIS,jQuery)},789:()=>{!function(e,t){function i(t,i,n,a,s,l,o){this._tblName=t,this.rec_ID=n,this.sqlWhere=a,this.gFields=i,this._callbackClose=o,this._newRec=l,this.gridCols=new Array,this.htmlUI=new Array,this.busyInd=null,this.deletable=!1,this.maintTblVer=s,this.defaultColsIniPos=[Version=e.Msg.getMsg("VIS_RecordVersion"),ValidFrom=e.Msg.translate(e.Env.getCtx(),"VersionValidFrom"),Approved=e.Msg.getMsg("VIS_IsVersionApproved")],this.defaultColEleIniPos=[Version="RECORDVERSION",ValidFrom="VERSIONVALIDFROM",Approved="ISVERSIONAPPROVED"],this.defaultCols=[VersionLog=e.Msg.translate(e.Env.getCtx(),"VersionLog"),Delete=e.Msg.getMsg("Action")],this.defaultColElements=[VersionLog="VERSIONLOG",Delete="ACTION"],this.exclCols=[Tenant="AD_Client_ID",Created="Created",CreatedBy="CreatedBy",Updated="Updated",UpdatedBy="UpdatedBy",Export_ID="Export_ID"]}i.prototype.show=function(){var i=!1,n=null,a=null,s=null,l=this,o=this._tblName+","+!0+","+this.sqlWhere,r=e.dataContext.getJSONRecord("JsonData/GetIDTextData",o),d="40%";"Y"==e.dataContext.getJSONRecord("Common/CheckTableDeletable",this._tblName+"_Ver")&&(this.deletable=!0);var c=new e.ChildDialog,p=this.getMasterVersionUI(r);c.setContent(p),this.gridCols.length>8&&(d="70%"),c.setWidth(d),c.setTitle(e.Msg.getMsg("MasterDataVersioning")),c.setModal(!0),c.onClose=function(){n&&(n.off("click"),n=null),s&&(s=null),a&&(a=null),this.deletable&&p.find(".vis-mas-ver-btnDel").off("click"),c=null},c.onOkClick=function(){if(!i)return l.setBusy(!0),setTimeout((function(){if(l._callbackClose){i=!0;var a=s.val();if(a&&""!=a||(a=new Date),!n.prop("checked")&&new Date(s.val())>new Date){var o=p.find(".vis-mas-ver-recRow"),r=!1,d=0;if(o.length>0)for(var u=0;u<o.length;u++){var g=t(o[u]),h=g.find(".vis-mas-ver-valFromDate");if(new Date(t(h).attr("valdt")).getTime()==new Date(new Date(s.val()).setHours(0,0,0,0)).getTime()){r=!0,d=g.attr("recid");break}}if(r)return e.ADialog.confirm("VersionExistOverwrite",!0,"","Confirm",(function(e){e?(l._callbackClose(n.prop("checked"),a,d),c.close(),i=!1):i=!1})),!1;l._callbackClose(n.prop("checked"),a,0),i=!1,c.close()}else l._callbackClose(n.prop("checked"),a,0),i=!1,c.close()}else c.close()}),10),!1},c.onCancelClick=function(){c.close()},c.show(),this.deletable&&p.find(".vis-mas-ver-btnDel").on("click",(function(i){var n=t(i.target).closest(".vis-mas-ver-recRow");if(n.length>0){var a=n.attr("recid");if(a>0){var s=!1;if(s)return;e.ADialog.confirm("DeleteConfirm",!0,"","Confirm",(function(t){if(s=!0,t){var i=l._tblName+"_Ver,"+a,o=e.dataContext.getJSONRecord("Common/DeleteRecord",i);o&&o.Success&&"Y"==o.Success?(n.remove(),(n=p.find(".vis-mas-ver-recRow")).length<=0&&p.find(".vis-mas-ver-gridData").append(l.getNoRecDiv())):o.Success&&""!=o.Msg?e.ADialog.error(o.Msg):e.ADialog.error(e.Msg.getMsg("ErrorDeletingRecord")),s=!1}else s=!1}))}}})),n=p.find(".vis-mas-ver-chkImmSave"),a=p.find(".vis-mas-ver-secValFrom"),s=p.find(".vis-mas-ver-dtVerVal"),n.on("click",(function(){a.toggle(),n.prop("checked")||(l._newRec?s.val(l.getDateString(!0)):s.val(l.getDateString()))})),s.on("change",(function(){var e=new Date(s.val()).setHours(0,0,0,0),t=(new Date).setHours(0,0,0,0);e==t&&s.val(l.getDateString()),l._newRec&&e>=t&&s.val(l.getDateString(!0))})),this.busyInd=p.parent().find(".vis-busyindicatorouterwrap")},i.prototype.getMasterVersionUI=function(i){return t('<div class= "vis-mas-ver-outerwrap"><div class="vis-mas-ver-text">'+e.Msg.getMsg("VersioningColsFoundValidFrom")+'</div><div style="display: flex;"><div class="vis-mas-ver-checkwrap"><input type="checkbox" class="vis-mas-ver-ImmSav vis-mas-ver-chkImmSave" checked="checked"><label>'+e.Msg.getMsg("SaveImmediate")+'</label></div><div class="vis-mas-ver-fieldwrap vis-mas-ver-checkwrap vis-mas-ver-secValFrom" style="display: none;"><label>'+e.Msg.getMsg("VersionValidFrom")+'</label><input type="date" class="vis-mas-ver-ImmSav vis-mas-ver-dtVerVal"></div></div>'+this.getGrid(i)+'</div><div class="vis-busyindicatorouterwrap" style="visibility: hidden;"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>')},i.prototype.getGrid=function(i){this.htmlUI.push('<div class= "vis-mas-ver-gridSection" style="min-height: 300px;">'),this.htmlUI.push("<table>");var n=e.Application.contextUrl+"Areas/VIS/Images/base/delete10.png";if(this.htmlUI.push('<thead class="vis-mas-ver-gridData">'),this.htmlUI.push(this.createHeaders()),this.htmlUI.push("</thead>"),i&&i.Table)if(i.Table.length>0){this.htmlUI.push("<tbody>");for(var a=0;a<i.Table.length;a++){for(var s=i.Table[a],l=Object.keys(s),o={},r=0;r<l.length;r++)o[l[r].toUpperCase()]=s[l[r]];var d="";a%2==0&&(d="style='background-color: #ebf1f3;'"),this.htmlUI.push('<tr recid="'+o[this._tblName.toUpper()+"_VER_ID"]+'"  '+d+' class="vis-mas-ver-recRow">');for(var c=0;c<this.gridCols.length;c++){var p=this.gridCols[c],u=t.grep(this.gFields,(function(e){return e.vo.ColumnName.toUpper()==p}))[0],g="---";if(o[p+"_TXT"])this.htmlUI.push("<td>"+e.Utility.encodeText(o[p+"_TXT"])+"</td>");else if("ACTION"==p)this.deletable&&this.htmlUI.push("<td style='text-align: center;'><button class='vis-mas-ver-btnDel'><img src='"+n+"' /></button></td>");else if(o[p+"_LOC"]||o[p+"_LTR"]||o[p+"_ASI"]||o[p+"_ACT"]||o[p+"_CTR"])u&&(g=u.getLookup().getDisplay(u.value)),this.htmlUI.push("<td>"+e.Utility.encodeText(g)+"</td>");else if(o[p])if("ISVERSIONAPPROVED"==p||u&&u.vo&&u.vo.displayType&&20==u.vo.displayType)"Y"==o[p]?this.htmlUI.push('<td style="text-align: center;"><input type="checkbox" checked="checked" disabled></td>'):this.htmlUI.push('<td style="text-align: center;"><input type="checkbox" disabled></td>');else if("VERSIONVALIDFROM"==p){var h=Globalize.format(new Date(o[p]),"d");this.htmlUI.push('<td class="vis-mas-ver-valFromDate" valdt="'+new Date(o[p])+'">'+h+"</td>")}else if(u&&u.vo&&u.vo.displayType&&15==u.vo.displayType){var v=Globalize.format(new Date(o[p]),"d");this.htmlUI.push('<td dtDate="'+new Date(o[p])+'">'+v+"</td>")}else if(u&&u.vo&&u.vo.displayType&&16==u.vo.displayType){v=Globalize.format(new Date(o[p]+"Z"),"f");this.htmlUI.push('<td dtDate="'+new Date(o[p])+'">'+v+"</td>")}else if(u&&u.vo&&u.vo.displayType&&24==u.vo.displayType){v=Globalize.format(new Date(o[p]+"Z"),"t");this.htmlUI.push('<td dtDate="'+new Date(o[p])+'">'+v+"</td>")}else"RECORDVERSION"==p?this.htmlUI.push('<td style="text-align: center">'+e.Utility.encodeText(o[p])+"</td>"):this.htmlUI.push("<td>"+e.Utility.encodeText(o[p])+"</td>");else this.htmlUI.push("<td> --- </td>")}this.htmlUI.push("</tr>")}this.htmlUI.push("</tbody>")}else this.htmlUI.push(this.getNoRecDiv());else this.htmlUI.push(this.getNoRecDiv());return this.htmlUI.push("</table>"),this.htmlUI.push("</div>"),this.htmlUI.join(" ")},i.prototype.createHeaders=function(){var t=new Array;if(t.push('<tr style="border-bottom: 2px #b5b3b3 solid;">'),this.gFields&&this.gFields.length>0){this.createVerColsHdrs(t,this.defaultColsIniPos,this.defaultColEleIniPos);for(var i=0;i<this.gFields.length;i++){var n=this.gFields[i];(n.vo.IsMaintainVersions||this.maintTblVer)&&this.exclCols.indexOf(n.vo.ColumnName)<0&&(this.gridCols.push(n.vo.ColumnName.toUpper()),20==n.vo.displayType?t.push('<th style="text-align: center;">'+e.Utility.encodeText(n.vo.Header)+"</th>"):t.push("<th>"+e.Utility.encodeText(n.vo.Header)+"</th>"))}this.createVerColsHdrs(t,this.defaultCols,this.defaultColElements)}return t.push("</tr>"),t.join(" ")},i.prototype.createVerColsHdrs=function(t,i,n){for(var a=0;a<i.length;a++)this.gridCols.push(n[a]),"ACTION"==n[a]?this.deletable&&t.push('<th style="text-align: center;">'+e.Utility.encodeText(i[a])+"</th>"):"ISVERSIONAPPROVED"==n[a]||"RECORDVERSION"==n[a]?t.push('<th style="text-align: center;">'+e.Utility.encodeText(i[a])+"</th>"):t.push("<th>"+e.Utility.encodeText(i[a])+"</th>")},i.prototype.getDateString=function(e){var t=new Date;e?t.setDate(t.getDate()-1):t.setDate(t.getDate()+1);var i=t.getFullYear(),n=t.getMonth()+1;n<10&&(n="0"+n);var a=t.getDate();return a<10&&(a="0"+a),i+"-"+n+"-"+a},i.prototype.getNoRecDiv=function(){return'<div class="vis-mas-ver-norecord">'+e.Utility.encodeText(e.Msg.getMsg("NoRecords"))+"</div>"},i.prototype.setBusy=function(e){var t=this.busyInd;t&&t.css("visibility",e?"visible":"hidden")},e.MasterDataVersion=i}(VIS,jQuery)},9192:()=>{String.prototype.equals=function(e,t){return t?this.toString().toLowerCase()===e.toLowerCase():this.toString()===e},String.prototype.equalsIgnoreCase=function(e){return this.toString().toLowerCase()===e.toLowerCase()},String.prototype.startsWith=function(e){return""===e||null!=this&&null!=e&&(e=String(e),this.length>=e.length&&this.slice(0,e.length)===e)},String.prototype.endsWith=function(e){return""===e||null!=this&&null!=e&&(e=String(e),this.length>=e.length&&this.slice(this.length-e.length)===e)},String.prototype.contains=function(e){return this.indexOf(e)>-1},String.prototype.toUpper=function(){return this.toUpperCase()},String.prototype.toLower=function(){return this.toLowerCase()},String.prototype.compareTo=function(e){var t=this.length,n=e.length,a=t<n?t:n;for(i=0;i<a;i++){var s=this.charCodeAt(i),l=e.charCodeAt(i);if(s!=l)return s>l?1:s<l?-1:0}var o=t-n;return o>0?1:o<0?-1:0},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},Number.prototype.compareTo=function(e){var t=this-e;return t>0?1:t<0?-1:0},Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),StringBuilder=function(e){this.str=e||""},StringBuilder.prototype.append=function(e){return this.str+=e,this},StringBuilder.prototype.toString=function(){return this.str},StringBuilder.prototype.endsWith=function(e){return this.str.endsWith(e)},StringBuilder.prototype.replace=function(e,t){var i=this.str;return i=i.replace(new RegExp(e,"g"),t)},StringBuilder.prototype.indexOf=function(e){return this.str.indexOf(e)},StringBuilder.prototype.length=function(){return this.str.length},StringBuilder.prototype.insert=function(e,t){return this.str=e>0?this.str.substring(0,e)+t+this.str.substring(e,this.str.length):t+this.str,this.str},StringBuilder.prototype.clear=function(){return this.str.length=0,this.str="",this},Date.prototype.toUniversalTime=function(){return new Date(this.getTime())}},3289:()=>{!function(e,t){var i=(a=e.Application.contextUrl)+"JsonData/ExecuteNonQuer";function n(i,n,a,s){var l=null;this.parent,this.mPanel,this.ctx=e.Env.getCtx(),this.isLocked=!1,this.log=e.Logging.VLogger.getVLogger("VIS.AProcess"),this.isComplete=!1,this.jpObj=null,this.splitUI=a,this.extrnalForm=s,this.partitionContainer=null,this.parameterContainer=null,this.reportContainer=null,this.reportToolbar=null,this.isReport=!1,this.calculateWidth=!0,this.hideclose=!1,this.showParameterClose=!0,this.cssForAll=null,this.visRepformatIcons=null,this.visSaveCsvIcons=null,this.visSavePdfIcons=null,this.visArchiveIcons=null,this.visRequeryIcons=null,this.visCustomizeIcons=null,this.visPrintIcons=null,this.toolbarColor=null;var o,r,d,c,p,u,g,h,v,f,m,y,I=null,D=t('<i class="fa fa-bars vis-apanel-lb-img" title="Actions"></i>');this.splitUI&&(this.partitionContainer=t('<div class="vis-process-outer-wrap">'),this.parameterContainer=t('<div class="vis-process-left-sidebar vis-leftsidebarouterwrap">'),this.reportAreaContainer=t('<div class="vis-process-main-wrap">'),this.reportToolbar=t('<div class="vis-process-toolbar vis-processtoolpadd">'),this.parameterFixedArea=t('<div class="vis-process-parm-top">'),this.parameterContainer.append(t('<div class="vis-apanel-lb-toggle"></div>').append(D)).append(this.parameterFixedArea),I=t('<div class="vis-process-outer-main-wrap">'),this.$divDesc=t('<div class="vis-process-description">'),this.reportContainer=t('<div class="vis-process-result">'),this.reportAreaContainer.append(this.reportToolbar).append(this.$divDesc).append(this.reportContainer),I.append(this.parameterContainer).append(this.reportAreaContainer),this.partitionContainer.append(I),this.showParameterClose=!1),l=this,this.loadFileTypes=function(){var i=this;t.ajax({url:e.Application.contextUrl+"JsonData/GetReportFileTypes/",dataType:"json",data:{AD_Process_ID:l.jpObj.AD_Process_ID},success:function(n){if(null!=n){var a=jQuery.parseJSON(n);if(0!=a.length){h.append("<option value='S'>"+e.Msg.getMsg("Select")+"</option>");for(var s=0;s<a.length;s++){var l=t("<option value="+a[s].Key+">"+a[s].Name+"</li>");h.append(l),l=null}}else i.showReportTypes(!1)}}})},function(){o=t("<div style='position:relative;width:100%'>"),r=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),c=t("<table  class='vis-process-table'>"),p=t("<button class='vis-button-ok' tabindex=0>").text(e.Msg.getMsg("OK")),u=t("<button class='vis-button-close'>").text(e.Msg.getMsg("Close")),r.css("top","0px"),p.hide(),u.hide(),c.height(n),r.height(n),d=t("<div>"),o.append(c).append(r),I.append(r),h=t('<select style="display:none;width:100%">'),m=t('<label  class="vis-ec-col-lblchkbox" style="display: none;"><input type="checkbox">'+e.Msg.translate(e.context,"IsBackgroundProcess")+"</label>"),f=t(m.find("input")[0]),g=t("<span class='vis-process-description-Span' style='height: 40px;'>").val("asassasasasasaasa"),d.append(g),y=t('<div class="input-group vis-input-wrap">');var i=t('<div class="vis-control-wrap">');v=t('<label style="display:none;">'+e.Msg.getMsg("ChooseReportType")+"</label>");var a=t('<div style="display:inherit"></div>');l.parameterFixedArea.append(y),y.append(i),i.append(m).append(h).append(v),d.append(a),d.append(p).append(u),l.$divDesc.append(d)}(),this.setSize=function(e,t){r.height(e),this.setMsg&&this.setMsg("")},this.setSize(n),this.isBackground=function(){return f.is(":checked")},this.getRoot=function(){return o},this.getContentGrid=function(){return d},this.setBusy=function(e,t){isLocked=e,e?(r[0].style.visibility="visible",r.css("display","")):(r[0].style.visibility="hidden",r.css("display","none"))},this.setMsg=function(e,i){var n=g.find("b");if(g.text().length>0&&e&&e.length>0){var a=t("<span>"+e+"</span>");this.reportContainer.removeClass("vis-process-result"),this.reportContainer.addClass("vis-process-detail-result"),this.reportContainer.empty(),this.reportContainer.append(a)}else g.append(e);var s="";this.isReport&&(!n||n.length<=0)&&(s=t('<strong class="vis-process-papapa vis-procss-more"    style="position: fixed;right: 29px;top:96px"><i class="glyphicon glyphicon-chevron-down"></i></strong>'),g.append(s));var o=t(g.find("p")[0]);(s=g.find(".vis-process-papapa"),this.isReport)&&(o.width()+45>g.width()?s.show():s.hide());this.isReport&&(!n||n.length<=0)&&s.on("click",(function(){var e=l.reportAreaContainer.height(),t=s.find("i");t.hasClass("glyphicon-chevron-up")?(t.addClass("glyphicon-chevron-down"),t.removeClass("glyphicon-chevron-up"),g.css({height:"40px"})):(t.addClass("glyphicon-chevron-up"),t.removeClass("glyphicon-chevron-down"),g.css({height:""})),l.reportContainer.height(e-(l.$divDesc.height()+20))})),this.setMsgHeight(this.isReport)},this.setMsgHeight=function(e){e?(g.css("height","40px"),g.css("max-height","")):(g.css("height",""),l.parent&&g.css("max-height",l.parent.getContentGrid().height()-100+"px")),this.reportContainer.height(this.reportAreaContainer.height()-(this.$divDesc.height()+20)),this.reportAreaContainer.width(this.partitionContainer.width()-this.parameterContainer.width())},this.setParameterHeights=function(e,i){var n=this,a=t(n.partitionContainer.find(".vis-process-outer-main-wrap")[0]);e&&(n.partitionContainer.height(e),a.height(e));var s=a.height();t(n.partitionContainer.find(".vis-pro-para-root")[0]).height(s-114+"px")},this.getParametersContainer=function(){return this.parameterContainer},this.getReportAreaContainer=function(){return this.reportContainer},this.getContentTable=function(){return c},this.getBusyIndicator=function(){return r},this.getToolbar=function(){return this.reportToolbar},this.additemtoToolbar=function(){var e=t('<div class="vis-ad-w-p-t-close vis-ad-process-close"><i class="vis vis-cross"></i></div>');l.reportToolbar.append(e).append(t('<div class="vis-ad-w-p-t-name vis-ad-process-header"><h5>'+l.parent.getName()+"</h5></div >")),e.on("click",(function(){l.parent.dispose()}))},this.showCloseIcon=function(e){this.hideclose=!e},this.showOkIcon=function(e){e?(this.parameterContainer.append(t('<div style="overflow:auto;padding:0 10px">').append(p)),p.removeClass(""),p.addClass("vis-process-ok-btn VIS_Pref_btn-2"),p.show(),window.setTimeout((function(){p.focus()}),100)):p.hide()},this.showParameterCloseIcon=function(e){this.showParameterClose=!!e},this.getShowParameterCloseIcon=function(){return this.showParameterClose},this.setCssForToolbarIcons=function(e){this.cssForAll=e},this.setReportFormatIcons=function(e){this.visRepformatIcons=e},this.setSaveCsvIcons=function(e){this.visSaveCsvIcons=e},this.setSavePdfIcons=function(e){this.visSavePdfIcons=e},this.setArchiveIcons=function(e){this.visArchiveIcons=e},this.setRequeryIcons=function(e){this.visRequeryIcons=e},this.setCustomizeIcons=function(e){this.visCustomizeIcons=e},this.setPrintIcons=function(e){this.visPrintIcons=e},this.setToolbarColor=function(e){this.toolbarColor=e},this.getFileType=function(){return h.val()},this.reportBytes=null,this.reportPath=null,this.showReportTypes=function(e){e?(h.css("display","block"),v.css("display","block")):(h.css("display","none"),v.css("display","none"))},this.showBackgroundProcess=function(e){e?(l.parameterFixedArea.addClass("vis-process-pram-checkbox-text"),m.css("display","flex")):(l.parameterFixedArea.removeClass("vis-process-pram-checkbox-text"),m.css("display","none"))},this.enableBackgroundSetting=function(e){f.prop("checked"),e||y.hide()},this.archiveDocument=function(i,n){i.setBusy(!0),t.ajax({url:e.Application.contextUrl+"JsonData/ArchiveDoc/",dataType:"json",type:"post",data:{AD_Process_ID:n.pi.getAD_Process_ID(),Name:n.pi.getTitle(),AD_Table_ID:n.pi.getTable_ID(),Record_ID:n.pi.getRecord_ID(),C_BPartner_ID:0,isReport:!0,binaryData:l.reportBytes,reportPath:l.reportPath},success:function(t){e.ADialog.info("Archived",!0,"",""),i.setBusy(!1)}})},p.on("click",(function(){l.onclickTrigger(l)})),this.onclickTrigger=function(t){if(t.isComplete)t.dispose();else{var i=null;(i=new e.ProcessInfo(t.jpObj.Name,t.jpObj.AD_Process_ID,0,0)).setAD_User_ID(t.ctx.getAD_User_ID()),i.setAD_Client_ID(t.ctx.getAD_Client_ID()),i.setUseCrystalReportViewer(e.context.getIsUseCrystalReportViewer()),i.setIsBackground(f.is(":checked")),i.setIsReport(t.isReport),i.setActionOrigin(t.ActionOrigin);var n=e.context.getWindowContext(t.windowNo,"WindowName");n||(n="Menu"),i.setOriginName(n);var a=new e.ProcessCtl(t,i,null);i.setFileType(h.val()),t.windowNo?a.process(t.windowNo):a.process(e.Env.getWindowNo()),a=null}},u.on("click",(function(){l.parent.dispose()})),D.on("click",(function(e){e.stopPropagation(),e.preventDefault(),l.parameterContainer.width()>40?(l.parameterContainer.css("flex-basis","40px"),l.parameterFixedArea.hide(),l.getParametersContainer().find(".vis-pro-para-root").hide(),l.getParametersContainer().find(".vis-process-ok-btn").hide()):(l.parameterContainer.css("flex-basis","280px"),l.parameterFixedArea.show(),l.getParametersContainer().find(".vis-pro-para-root").show(),l.getParametersContainer().find(".vis-process-ok-btn").show())})),this.disposeComponent=function(){p&&p.off("click"),u&&u.off("click"),d&&d.remove(),d=null,this.reportContainer&&this.reportContainer.remove(),this.parameterContainer&&this.parameterContainer.remove(),this.reportToolbar&&this.reportToolbar.remove(),this.partitionContainer&&this.partitionContainer.remove(),r&&r.remove(),r=null,p=u=g=null,this.$parentWindow=null,this.isComplete=!1,this.jpObj=null,l=null}}n.prototype.init=function(t,i,n){return null==t.Name||""==t.Name?(e.ADialog.info("Process Name is empty"),fasle):(this.ctx.setWindowContext(n,"IsSOTrx",t.IsSOTrx),i.getContentGrid().append(this.getRoot()),this.isReport=t.IsReport,this.setMsg(t.MessageText),this.setBusy(!1),this.parent=i,this.jpObj=t,this.additemtoToolbar(),t.IsReport?(this.showReportTypes(!0),this.loadFileTypes(),t.IsCrystal&&e.context.getIsUseCrystalReportViewer()&&this.parameterFixedArea.hide()):(this.showBackgroundProcess(!0),this.enableBackgroundSetting(t.IsBackground)),this.setMsgHeight(t.IsReport),t.HasPara||this.showOkIcon(!0),this.splitUI&&t.HasPara&&this.onclickTrigger(this),this.splitUI&&(this.parent.getContentGrid().empty(),this.parent.getContentGrid().append(this.partitionContainer)),this.windowNo=n,!0)},n.prototype.setActionOrigin=function(e){this.ActionOrigin=e},n.prototype.setTitle=function(t){this.parent&&this.parent.setTitle(e.Utility.Util.cleanMnemonic(t))},n.prototype.lockUI=function(e){this.isLocked=!0,this.setBusy(!0)},n.prototype.unlockUI=function(t){t.logs&&t.logs.length>0&&(t.logs=null),e.ProcessInfoUtil.setLogFromDB(t);var i="";t&&t.getSummary()?i="<p style='float: left;width: 100%;'><font color=\""+(t.getIsError()?"#FF0000":"#0000FF")+'">** '+t.getSummary()+"</font></p>":this.jpObj.IsReport||(i="<p style='float: left;width: 100%;'><font color=\""+(t.getIsError()?"#FF0000":"#0000FF")+'">** </font></p>'),t.customHTML&&""!=t.customHTML?i+=t.customHTML:i+=t.getLogInfo(!0),this.setMsg(i),this.setBusy(!1),t.setSummary(""),this.isLocked=!1},n.prototype.getIsUILocked=function(){return this.isLocked},n.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.mPanel&&(this.mPanel.dispose(),this.mPanel=null),this.parent&&(this.parent.dispose(),this.parent=null),e.Env.clearWinContext(this.ctx,this.windowNo),this.disposeComponent())};a=e.Application.contextUrl,i=a+"JsonData/ExecuteNonQuer";var a,s=function(e,n,a){var s=!!a,l=null;return t.ajax({url:i+"iesWithCode",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:s,data:JSON.stringify(data)}).done((function(e){l=e,a&&a(e)})),l};n.prototype.createUI=function(i,n,a){var l,o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,f=null,m=[],y=null,I=null,D=null,w=null,b=null,C=this,_=null;function S(t){n.pi.setFileType(t),n.pi.setActionOrigin(C.ActionOrigin);var i=e.context.getWindowContext(C.windowNo,"WindowName");return i||(i="Menu"),n.pi.setOriginName(i),{processInfo:n.pi.toJson(),parameterList:n.paraList}}function x(t,i){e.dataContext.executeProcess(t,(function(e){if(null!=e.error)return n.pi.setSummary(e.error,!0),n.unlock(),void(n=null);var t=JSON.parse(e.result);if(t.IsError)return n.pi.setSummary(t.Message,!0),n.unlock(),void(n=null);i(t)}))}function A(i,n){try{if(i.HTML){n.getRightInnerDiv().html(i.HTML);var a=document.getElementsByClassName("vis-reptabledetect");if(a.length>0){for(var s=0,l=0,o=0,r=a.length;o<r;o++)(l=t(a[o]).width())>s&&(s=l);n.getRightDiv().width(t(window).width()-10),n.getRightDiv().css("min-width",t(window).width()+"px"),n.getRightInnerDiv().width(s+50)}n.getRightInnerDiv().width(s)}else if(i.ReportFilePath){var d=t("<iframe style = 'width:100%;height:99.4%;' pluginspage='http://www.adobe.com/products/acrobat/readstep2.html'>");d.attr("src",e.Application.contextUrl+i.ReportFilePath),n.getRightDiv().empty().append(d),C.reportPath=i.ReportFilePath}}catch(e){}n.setBusy(!1)}function T(){i.setBusy(!0),window.setTimeout((function(){if(n.pi.dynamicAction&&n.pi.dynamicAction.length>0)q(n.REPORT_TYPE_PDF,n.pi.getPageNo());else if(n.pi.GetAD_ReportView_ID()>0)$(n.pi.getPageNo(),0,null);else if(n.pi.getIsJasperReport())z(n.REPORT_TYPE_PDF,n.pi.getPageNo());else if(n.pi.getIsReportFormat()){var a=F(n.pi.getAD_Process_ID(),n.pi.getTitle(),n.pi.getAD_PInstance_ID(),n.pi.getTable_ID(),n.pi.getRecord_ID(),n.pi.getPageNo(),n.pi.getPageSize(),!1);t.ajax({url:e.Application.contextUrl+"ReportCom/ExecuteReport",type:"Post",data:a,success:function(n){var a=JSON.parse(n);if(E)window.open(e.Application.contextUrl+a);else{var s=t("<iframe style = 'width:100%;height:99.4%;' pluginspage='http://www.adobe.com/products/acrobat/readstep2.html'>");s.attr("src",e.Application.contextUrl+a),i.getRightDiv().empty().append(s)}C.reportPath=a,i.setBusy(!1)}})}else x(S(n.REPORT_TYPE_PDF),(function(e){A(e,i)}))}),200)}n.pi.setActionOrigin(C.ActionOrigin);var V=e.context.getWindowContext(C.windowNo,"WindowName");V||(V="Menu"),n.pi.setOriginName(V);var N=n.pi.get_AD_PrintFormat_Table_ID();l=e.MRole.getDefault().getIsCanExport(N);var M=[],k=-1;m=[];var O=null;if(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetPrintFormatDetails",data:{AD_Table_ID:N},success:function(t){O=(new e.DB.DataReader).toJson(t);try{for(;O.read();){k=parseInt(k)+1;var i=O.getString(1);M.indexOf(i)>-1&&(i=i+"_"+(parseInt(k)+1));var n={};n.ID=e.Utility.Util.getValueOfInt(O.get(0)),n.Name=i,n.IsDefault=O.getString(3),M.push(O.getString(1)),m.push(n)}O.close()}catch(e){O.close()}O=null}}),C.visRepformatIcons&&0!=C.visRepformatIcons.length||(C.cssForAll?C.visRepformatIcons=C.cssForAll+"vis vis-format":C.visRepformatIcons="vis vis-format"),C.visSaveCsvIcons&&0!=C.visSaveCsvIcons.length?C.visSaveCsvIcons=C.visSaveCsvIcons+" vis-report-icon ":C.visSaveCsvIcons=" vis vis-save-csv",C.visSavePdfIcons&&0!=C.visSavePdfIcons.length?C.visSavePdfIcons=C.visSavePdfIcons+" vis-report-icon ":C.visSavePdfIcons=" vis vis-save-pdf",C.visArchiveIcons&&0!=C.visArchiveIcons.length?C.visArchiveIcons=C.visArchiveIcons+" vis-report-icon ":C.visArchiveIcons=" vis vis-archive",C.visRequeryIcons&&0!=C.visRequeryIcons.length?C.visRequeryIcons=C.visRequeryIcons+" vis-report-icon ":C.visRequeryIcons=" vis vis-refresh",C.visCustomizeIcons&&0!=C.visCustomizeIcons.length?C.visCustomizeIcons=C.visCustomizeIcons+" vis-report-icon ":C.visCustomizeIcons=" vis vis-customize",C.visPrintIcons&&0!=C.visPrintIcons.length?C.visPrintIcons=C.visPrintIcons+" vis-report-icon ":C.visPrintIcons=" vis vis-print ",y=t("<div>"),I=t('<select class="vis-selectcsview-page">'),D=t("<ul class='vis-apanel-rb-ul'>"),C.cssForAll,w=t("<li><a  title='"+e.Msg.getMsg("SaveAllRecordCsv")+"' class='vis vis-csv-all'></a></li>"),b=t("<li><a  title='"+e.Msg.getMsg("SaveAllPagePdf")+"' class='vis vis-pdf-all'></a></li>"),(_=t("<div class='vis-report-header vis-ad-print-process'>")).append(t('<div class="vis-ad-w-p-t-name vis-ad-process-header"><h5>'+C.parent.getName()+"</h5></div >")),o=t('<div class="vis-icon-menuclose"><i class="vis vis-cross"></i></div >'),r=t('<div class="vis-report-top-icons">'),d=t('<ul  class="vis-reporticonsulprint">'),f=t("<li><a class='"+C.visRepformatIcons+"'></a></li>"),D.append(t('<li data-id="-1">').append(e.Msg.getMsg("NewReport"))),y.append(D),d.append(f),l&&(h=t("<li><a title='"+e.Msg.getMsg("SaveCSVPage")+"' class='vis vis-save-csv'></a></li>"),d.append(h)),n.pi.getSupportPaging()&&l){d.append(w);for(var L=1;L<n.pi.getTotalPages()+1;L++)I.append(t("<option value="+L+">"+L+"</option>"));r.append(I)}l&&(v=t("<li><a title='"+e.Msg.getMsg("SavePDFDocumentPage")+"' class='vis vis-save-pdf'></a></li>"),d.append(v)),n.pi.getSupportPaging()&&l?d.append(b):(h.find("a").attr("title",e.Msg.getMsg("SaveCSV")),v.find("a").attr("title",e.Msg.getMsg("SavePdf"))),"Y"==e.context.ctx["#BULK_REPORT_DOWNLOAD"]?(w.css("display",""),b.css("display","")):(w.css("display","none"),b.css("display","none")),c=t("<li><a title='"+e.Msg.getMsg("Archive")+"'  class='vis vis-archive'></a></li>"),d.append(c),p=t("<li><a title='"+e.Msg.getMsg("Requery")+"'  class='vis vis-refresh'></a></li>"),d.append(p),u=t("<li><a style='cursor:pointer;' class='vis vis-customize'></a></li>"),d.append(u),g=t("<li><a style='cursor:pointer;' class='vis vis-print'></a></li>"),d.append(g),a.HTML||(g.css("display","none"),u.css("display","none"),f.css("display","none")),r.append(d),_.append(r),C.hideclose||_.append(o),C.splitUI?(C.reportToolbar.removeClass("vis-processtoolpadd"),C.reportToolbar.empty().append(_),C.reportContainer.empty().append(i.getRoot()),C.extrnalForm&&C.getContentTable().empty().append(C.reportContainer)):(C.parent.getContentGrid().append(_).append(i.getRoot()),i.getRoot().css("width",t(window).width()));var R=C.parent,E=/ipad|iphone|ipod|mobile|android|blackberry|webos|windows phone/i.test(navigator.userAgent.toLowerCase());function P(e,t){var i=n.pi.getOriginName();return i||(i="Menu"),{AD_Process_ID:n.pi.getAD_Process_ID(),Name:n.pi.getTitle(),AD_PInstance_ID:n.pi.getAD_PInstance_ID(),AD_Table_ID:n.pi.getTable_ID(),Record_ID:n.pi.getRecord_ID(),pageNumber:e,page_Size:t,saveAll:!1,ActionOrigin:n.pi.getActionOrigin(),OriginName:i}}function U(e,t,i,a,s,l){return{processInfo:n.pi.toJson(),queryInfo:JSON.stringify(e),code:t,isCreateNew:i,treeID:s,node_ID:a,IsSummary:l}}function F(e,t,i,a,s,l,o,r){var d=n.pi.getOriginName();return d||(d="Menu"),{AD_Process_ID:e,Name:t,AD_PInstance_ID:i,AD_Table_ID:a,Record_ID:s,pageNumber:l,page_Size:o,printAllPages:r,ActionOrigin:n.pi.getActionOrigin(),OriginName:d}}function B(t,i,n,a,s){t.HTML&&t.HTML.length>0?A(t,i):0==a?(window.open(e.Application.contextUrl+t.ReportFilePath),i.setBusy(!1)):W(a,t.ReportFilePath,s,t)}function W(i,n,a,s){a.setBulkBusy(!1),t("#forreportdownload").addClass("hide"),Z+='<input type="checkbox" data-num="'+s+'"  data-url="'+e.Application.contextUrl+n+'" checked />',j((Y+=1)/i*100),Y==i&&setTimeout((function(){var i;j(100),i=e.Msg.getMsg("Generated"),G(),t("#reportcreateresult").addClass("alert alert-success").text(i),t("#forreportdownload").removeClass("hide"),t("<form>",{id:"download_form",html:Z,action:"#",Class:"hide"}).appendTo(document.body).submit()}),1e3)}function j(e){var i=100*t("#reportcreate").find(".progress-bar").width()/t("#reportcreate").width();isNaN(i)&&(i=0),i<=e&&t("#reportcreate").removeClass("hide").find(".progress-bar").attr("aria-valuenow",e).css({width:e+"%"}).text(e.toFixed(0)+"%")}function G(){t("#reportcreateresult").removeClass().text("")}function q(a,s){var l={processInfo:n.pi.toJson()};t.ajax({url:e.Application.contextUrl+n.pi.dynamicAction,type:"Post",data:l,success:function(s){var l=JSON.parse(s);if(E||a!=n.REPORT_TYPE_PDF)window.open(e.Application.contextUrl+l);else{var o=t("<iframe style = 'width:100%;height:99.4%;' pluginspage='http://www.adobe.com/products/acrobat/readstep2.html'>");o.attr("src",e.Application.contextUrl+l),i.getRightDiv().empty().append(o),C.reportPath=l.ReportFilePath}return i.setBusy(!1),l.ReportFilePath}})}function H(a,s,l){n.pi.setPageNo(a);var o={processInfo:n.pi.toJson()};t.ajax({url:e.Application.contextUrl+n.pi.dynamicAction,type:"Post",data:o,success:function(e){e=JSON.parse(e),W(l,e,s,a),i.setBusy(!1)}})}if(o.off("click"),p.off("click"),u.off("click"),g.off("click"),f.off("click"),D.off("click"),c.off("click"),o.on("click",(function(){i&&(i.dispose(),i=null),R&&(R.dispose(),R=null),n.pi&&n.pi.dispose(),n.pi=null,d.empty(),o.off("click"),p.off("click"),u.off("click"),g.off("click"),f.off("click"),D.off("click"),o=null,r=null,d=null,c=null,p=null,u=null,g=null,h=null,v=null,handleEvents=null})),p.on("click",(function(){i.setBusy(!0),i.getRightInnerDiv().html(""),i.getRightInnerDiv().width(0),n.pi.dynamicAction&&n.pi.dynamicAction.length>0?q(n.REPORT_TYPE_PDF,I.val()):T()})),u.on("click",(function(){var t=new e.Query;t.addRestriction("AD_PrintFormat_ID",e.Query.prototype.EQUAL,n.pi.AD_PrintFormat_ID),e.viewManager.startWindow(240,t)})),g.on("click",(function(){if(i.getIsHtmlReport()){var e=window.open();e.document.write("<html><head>"),e.document.write("</head><body >"),e.document.write(i.getHtml()),e.document.write("</body></html>"),e.print(),e.close()}})),f.on("click",(function(){D.empty();for(var i=0;i<m.length;i++){m[i].IsDefault;var n=t('<li><a data-isdefbtn="no" data-id="'+m[i].ID+'">'+m[i].Name+"</a></li>");D.append(n)}D.append(t('<li><a data-id="-1">'+e.Msg.getMsg("NewReport")+"</a>")),t(this).w2overlay(y.clone(!0),{css:{height:"300px"}})})),D.on("click","LI",(function(a){i.setBusy(!0);var l=t(a.target),o=l.data("id");if("yes"!=l.data("isdefbtn")){AD_PrintFormat_ID=o;-1==o&&(o=n.pi.get_AD_PrintFormat_Table_ID,!0);var r=[],d=new e.Query(n.pi.getPrintFormatTableName());r.push(d.getTableName()),r.push(d.getWhereClause(!0));var c=U(r,d.getCode(0),false0,0,!1);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:c,type:"POST",success:function(e){var t=jQuery.parseJSON(e);if(t.IsError)return n.pi.setSummary(t.Message,!0),n.unlock(),void(n=null);A(t.repInfo,i),C.reportPath=t.repInfo.ReportFilePath}})}else{(p=[])[0]=new e.DB.SqlParam("@tableID",n.pi.Ad_Table_ID),p[1]=new e.DB.SqlParam("@tabID",curTab.getAD_Tab_ID()),s(sql);var p;(p=[])[0]=new e.DB.SqlParam("@printForamt",o),s(sql);for(var u=0;u<m.length;u++)m[u].ID==o?m[u].IsDefault="Y":m[u].IsDefault="N"}})),c.on("click",(function(){C.archiveDocument(i,n)})),l){function z(a,s){n.pi.setFileType(a);var l={processInfo:n.pi.toJson()};t.ajax({url:e.Application.contextUrl+"JasperReport/ExecuteReport",type:"Post",data:l,success:function(s){var l=JSON.parse(s);if(E)window.open(e.Application.contextUrl+l);else{if(a==n.REPORT_TYPE_PDF){var o=t("<iframe style = 'width:100%;height:99.4%;' pluginspage='http://www.adobe.com/products/acrobat/readstep2.html'>");o.attr("src",e.Application.contextUrl+l),i.getRightDiv().empty().append(o)}else window.open(e.Application.contextUrl+l);C.reportPath=l}i.setBusy(!1)}})}function Q(a,s,l){n.pi.setPageNo(a);var o={processInfo:n.pi.toJson()};t.ajax({url:e.Application.contextUrl+"JasperReport/ExecuteReport",type:"Post",data:o,success:function(e){e=JSON.parse(e),W(s,e,l,a),i.setBusy(!1)}})}function J(a,s,l){if(n.pi.dynamicAction&&n.pi.dynamicAction.length>0)q(n.REPORT_TYPE_CSV);else{var o=P(a,n.pi.getPageSize());t.ajax({url:e.Application.contextUrl+"ReportCom/ExecuteReportforCsv",type:"Post",data:o,success:function(e){var t=JSON.parse(e);W(l,t="TempDownload/"+t,s,a),i.setBusy(!1)}})}}h.on("click",(function(){n.pi.setFileType("C"),1==n.pi.getPageNo()?(n.pi.setAD_PInstance_ID(0),i.setBusy(!0),x(S(n.REPORT_TYPE_CSV),(function(t){window.open(e.Application.contextUrl+t.ReportFilePath),i.setBusy(!1)}))):(i.setBusy(!0),window.setTimeout((function(){if(n.pi.dynamicAction&&n.pi.dynamicAction.length>0)q(n.REPORT_TYPE_CSV,n.pi.getPageNo());else if(n.pi.GetAD_ReportView_ID()>0)K(I.val(),0,null);else if(n.pi.getIsJasperReport())z("C",n.pi.getPageNo());else{pageNo=I.val();var a=P(pageNo,n.pi.getPageSize());t.ajax({url:e.Application.contextUrl+"ReportCom/ExecuteReportforCsv",type:"Post",data:a,success:function(t){var n=JSON.parse(t);window.open(e.Application.contextUrl+"TempDownload/"+n),i.setBusy(!1)}})}}),100))})),v.on("click",(function(){n.pi.setFileType(n.REPORT_TYPE_PDF),1==n.pi.getPageNo()?(i.setBusy(!0),x(S(n.REPORT_TYPE_PDF),(function(e){A(e,i)}))):T()})),I.on("change",(function(){if(pageNo=I.val(),n.pi.GetAD_ReportView_ID()>0){i.setBusy(!0);var a=[];n.pi.setPageNo(pageNo);var s=new e.Query(n.pi.getPrintFormatTableName());n.pi.getPrintFormatTableName()&&(a.push(s.getTableName()),a.push(s.getWhereClause(!0)));var l=U(a,"",!1,0,0,!1);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",type:"POST",data:l,success:function(e){var t=jQuery.parseJSON(e);if(t.IsError)return n.pi.setSummary(t.Message,!0),n.unlock(),void(n=null);A(t.repInfo,i),C.reportPath=t.repInfo.ReportFilePath}})}else n.pi.setPageNo(pageNo)})),w.on("click",(function(){i.setBusy(!0),Y=0,Z="",n.pi.setFileType("C"),window.setTimeout((function(){var t=new e.BulkDownload(C.windowNo,"CSV");if(t.onClose=function(){},t.show(),n.pi.dynamicAction&&n.pi.dynamicAction.length>0)for(var i=1;i<=n.pi.getTotalPages();i++)H(i,t,n.pi.getTotalPages());else if(n.pi.GetAD_ReportView_ID()>0)for(i=1;i<=n.pi.getTotalPages();i++)K(i,n.pi.getTotalPages(),t);else if(n.pi.getIsJasperReport())for(i=1;i<=n.pi.getTotalPages();i++)Q(i,n.pi.getTotalPages(),t);else for(i=1;i<=n.pi.getTotalPages();i++)J(i,t,n.pi.getTotalPages());n.pi.setPageNo(I.val())}),100)}));var $=function(a,s,l){var o=[],r=new e.Query(n.pi.getPrintFormatTableName());o.push(r.getTableName()),o.push(r.getWhereClause(!0));var d=U(o,"",!1,0,0,!1);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:d,type:"POST",success:function(t){null==t&&e.ADialog.error("ERRORGettingRepData");var n=jQuery.parseJSON(t).repInfo;if(n.ErrorText)return e.ADialog.error(n.ErrorText),void i.setBusy(!0);B(n,i,0,s,l),i.setBusy(!1),C.reportPath=n.ReportFilePath}})},K=function(a,s,l){var o=[],r=new e.Query(n.pi.getPrintFormatTableName());o.push(r.getTableName()),o.push(r.getWhereClause(!0));var d=U(o,"",!1,0,0,!1);t.ajax({url:e.Application.contextUrl+"JsonData/GenerateReport/",dataType:"json",data:d,type:"POST",success:function(t){null==t&&e.ADialog.error("ERRORGettingRepData");var n=jQuery.parseJSON(t).repInfo;if(n.ErrorText)return e.ADialog.error(n.ErrorText),void setBusy(!1);B(n,i,0,s,l),C.reportPath=n.ReportFilePath,i.setBusy(!1)}})};b.on("click",(function(){i.setBusy(!0),Y=0,Z="",n.pi.setFileType(n.REPORT_TYPE_PDF),window.setTimeout((function(){var t=new e.BulkDownload(C.windowNo,"PDF");if(t.onClose=function(){},t.show(),n.pi.dynamicAction&&n.pi.dynamicAction.length>0)for(var i=1;i<=n.pi.getTotalPages();i++)H(i,t,n.pi.getTotalPages());else if(n.pi.GetAD_ReportView_ID()>0)for(i=1;i<=n.pi.getTotalPages();i++)$(i,n.pi.getTotalPages(),t);else if(n.pi.getIsJasperReport())for(i=1;i<=n.pi.getTotalPages();i++)Q(i,n.pi.getTotalPages(),t);else for(i=1;i<=n.pi.getTotalPages();i++)X(i,t,n.pi.getTotalPages());n.pi.setPageNo(I.val())}),100)}));var Y=0;function X(a,s,l){if(n.pi.dynamicAction&&n.pi.dynamicAction.length>0)H(n.REPORT_TYPE_CSV,a);else{var o=F(n.pi.getAD_Process_ID(),n.pi.getTitle(),n.pi.getAD_PInstance_ID(),n.pi.getTable_ID(),n.pi.getRecord_ID(),a,n.pi.getPageSize(),!1);t.ajax({url:e.Application.contextUrl+"ReportCom/ExecuteReport",type:"Post",data:o,success:function(e){var t=JSON.parse(e);W(l,t,s,a),C.reportPath=t,i.setBusy(!1)}})}}var Z=""}},n.prototype.showReport=function(t,i,n,a){this.splitUI||(this.mPanel&&(this.mPanel.dispose(),this.mPanel=null),this.disposeComponent()),this.mPanel=t,this.pCtl=n,this.createUI(t,n,i),this.parent.hideHeader(!0),t.setBusy(!1),"1"!=e.context.ctx.$AutoArchive&&"2"!=e.context.ctx.$AutoArchive||this.archiveDocument(t,n)},n.prototype.showTelerikReport=function(e,t){var i=new KJS.TelerikContainer(e,t);i.getRoot().height(this.parent.getContentGrid().height()),this.parent.getContentGrid().empty(),this.parent.getContentGrid().append(i.getRoot()),i.init()},n.prototype.setReportBytes=function(e){this.reportBytes=e},n.prototype.setReportPath=function(e){this.reportPath=e},n.prototype.sizeChanged=function(e,t){this.setSize(e,t),this.mPanel&&this.mPanel.sizeChanged&&!this.splitUI&&this.mPanel.sizeChanged(e,t),this.setParameterHeights&&this.setParameterHeights(e,t)},n.prototype.refresh=function(){this.setParameterHeights&&this.setParameterHeights(),this.mPanel&&this.mPanel.refresh&&this.mPanel.refresh(),this.setMsg&&this.setMsg("")},e.AProcess=n}(VIS,jQuery)},1867:()=>{!function(e,t){var i=e.Application.contextUrl+"JsonData/JDataSetWithCode",n=function(n,a,s){var l=!!s,o={sql:n,page:1,pageSize:0};a&&(o.param=a);var r=null;return function(e,n,a){var s=null;t.ajax({url:i,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:n,data:JSON.stringify(e)}).done((function(e){s=e,a&&a(e)}))}(o,l,(function(t){r=(new e.DB.DataSet).toJson(t),s&&s(r)})),r};e.ProcessWrapper=function(t,i){this.parent=i;var a=this;!function(){try{var i=[];i[0]=new e.DB.SqlParam("@processName",t);var s=n("VIS_100",i);if(null!=s&&s.getTables()[0].getRows().length>0){var l=s.tables[0].getRow(0).getCell(0),o=s.tables[0].getRow(0).getCell(1),r=s.tables[0].getRow(0).getCell(2),d=s.tables[0].getRow(0).getCell(3);if(l>0){var c=new e.ParameterDialog(a.parent.windowNo,a);c.initDialog(l,o,d,r,!1),c.onCloseMain=function(t){t?e.ADialog.info("ProcessWait",!0,"",""):e.ADialog.info("Process Canceled",!0,"","")},c.showDialog(),c=null}else e.ADialog.info("ProcessNotFound",!0,"","")}}catch(e){}}(),this.lockUI=function(e){a.lockUI&&a.lockUI(e)},this.unlockUI=function(e){a.unlockUI&&a.unlockUI(e)},this.parentcall=function(e){a.parentcall&&a.parentcall(e)}}}(VIS,jQuery)},9407:()=>{VIS.MRole.getDefault=function(){return VIS.MRole},VIS.MRole.log=VIS.Logging.VLogger.getVLogger("MRole"),VIS.MRole.canUpdate=function(e,t,i,n,a){var s=this.vo.UserLevel.trim(),l=!0,o="";return 0==e&&0==t&&-1==s.indexOf("S")?(l=!1,o+="S"):0!=e&&0==t&&-1==s.indexOf("C")?-1==s.indexOf("O")&&this.getIsOrgAccess(t,!0)||(l=!1,o+="C"):0!=e&&0!=t&&-1==s.indexOf("O")&&(l=!1,o+="O"),l&&(l=this.getIsTableAccess(i,!1)),l&&0!=n&&(l=this.getIsRecordAccess(i,n,!1)),!l&&a&&VIS.MRole.log.warning("AccessTableNoUpdate => AD_Client_ID="+e+", AD_Org_ID="+t+", UserLevel="+s+" => missing="+o),l},VIS.MRole.getIsColumnAccess=function(e,t,i){if(!this.getIsTableAccess(e,i))return!1;for(var n=!0,a=this.vo.columnAccess,s=0;s<a.length;s++)if(a[s].IsExclude){if(a[s].AD_Table_ID==e&&a[s].AD_Column_ID==t&&!(n=!i&&!a[s].IsReadOnly))return n}else if(a[s].AD_Table_ID==e&&a[s].AD_Column_ID==t&&!(n=!!i||!a[s].IsReadOnly))return n;return n},VIS.MRole.getIsTableAccessLevel=function(e,t){if(t)return!0;var i=this.vo.tableAccessLevel[e];if(null==i)return!1;if(i.equals(VIS.Consts.ACCESSLEVEL_All))return!0;var n=this.vo.UserLevel.trim();return!(-1==n.indexOf("S")||!i.equals(VIS.Consts.ACCESSLEVEL_SystemOnly)&&!i.equals(VIS.Consts.ACCESSLEVEL_SystemPlusClient))||(!(-1==n.indexOf("C")||!i.equals(VIS.Consts.ACCESSLEVEL_ClientOnly)&&!i.equals(VIS.Consts.ACCESSLEVEL_SystemPlusClient))||!(-1==n.indexOf("O")||!i.equals(VIS.Consts.ACCESSLEVEL_Organization)&&!i.equals(VIS.Consts.ACCESSLEVEL_ClientPlusOrganization)))},VIS.MRole.canView=function(e){var t=this.vo.UserLevel.trim(),i=!0;return VIS.Consts.ACCESSLEVEL_All.equals(e)?i=!0:(VIS.Consts.ACCESSLEVEL_SystemOnly.equals(e)&&-1==t.indexOf("S")||VIS.Consts.ACCESSLEVEL_ClientOnly.equals(e)&&-1==t.indexOf("C")||VIS.Consts.ACCESSLEVEL_Organization.equals(e)&&-1==t.indexOf("O")||VIS.Consts.ACCESSLEVEL_ClientPlusOrganization.equals(e)&&-1==t.indexOf("C")&&-1==t.indexOf("O")||VIS.Consts.ACCESSLEVEL_SystemPlusClient.equals(e)&&-1==t.indexOf("S")&&-1==t.indexOf("C"))&&(i=!1),i||(VIS.MRole.log.warning("AccessTableNoView","Required="+e+"() != UserLevel="+t),i)},VIS.MRole.getIsTableAccess=function(e,t){if(!this.getIsTableAccessLevel(e,t))return!1;for(var i=!0,n=this.vo.tableAccess,a=0;a<n.length;a++)if(VIS.Consts.ACCESSTYPERULE_Accessing.equals(n[a].AccessTypeRule))if(n[a].IsExclude){if(n[a].AD_Table_ID===e)return i=!!t&&n[a].IsReadOnly}else if(i=!1,n[a].AD_Table_ID==e)return i=!!t||!n[a].IsReadOnly;return n=null,i},VIS.MRole.getIsCanReport=function(e){if(!this.vo.IsCanReport)return!1;if(!this.getIsTableAccess(e,!0))return!1;for(var t=!0,i=this.vo.tableAccess,n=0;n<i.length;n++)if(VIS.Consts.ACCESSTYPERULE_Reporting.equals(i[n].AccessTypeRule))if(i[n].IsExclude){if(i[n].AD_Table_ID===e)return t=i[n].IsCanReport}else if(t=!1,i[n].AD_Table_ID===e)return t=i[n].IsCanReport;return i=null,t},VIS.MRole.getIsCanExport=function(e){if(!this.vo.IsCanExport)return!1;if(!this.getIsTableAccess(e,!0))return!1;if(!this.getIsCanReport(e))return!1;for(var t=!0,i=this.vo.tableAccess,n=0;n<i.length;n++)if(VIS.Consts.ACCESSTYPERULE_Exporting.equals(i[n].AccessTypeRule))if(i[n].IsExclude){if(i[n].AD_Table_ID===e)return t=i[n].IsCanExport}else if(t=!1,i[n].AD_Table_ID===e)return t=i[n].IsCanExport;return i=null,t},VIS.MRole.getIsOrgAccess=function(e,t){if(this.vo.IsAccessAllOrgs)return!0;if(0==e&&!t)return!0;for(var i=this.vo.orgAccess,n=0;n<i.length;n++)if(i[n].AD_Org_ID===e)return!t||!i[n].readOnly;return i=null,!1},VIS.MRole.getIsRecordAccess=function(e,t,i){for(var n=!0,a=this.vo.recordAccess,s=null,l=0;l<a.length;l++)if((s=a[l]).AD_Table_ID===e)if(s.IsExclude){if(s.Record_ID===t)return a=null,!!i&&s.IsReadOnly}else if(n=!1,s.Record_ID===t)return a=null,!!i||!s.IsReadOnly;return n},VIS.MRole.getIsSharedRecordAccess=function(e,t){for(var i=this.vo.sharedRecordAccess,n=null,a=0;a<i.length;a++)if((n=i[a]).AD_Table_ID==e&&n.Record_ID==t)return i=null,!0,!n.IsReadOnly;return!0},VIS.MRole.getClientWhere=function(e){if(this.vo.IsAccessAllOrgs)return e||0==this.vo.AD_Client_ID?"AD_Client_ID="+this.vo.AD_Client_ID:"AD_Client_ID IN (0,"+this.vo.AD_Client_ID+")";var t=[];e||t.push("0");for(var i=0;i<this.vo.orgAccess.length;i++){var n=this.vo.orgAccess[i].AD_Client_ID.toString();t.indexOf(n)<0&&t.push(n),n=null}for(var a=new StringBuilder,s=!0,l=0;l<t.length;l++)a.length()>0&&(a.append(","),s=!1),a.append(t[l]);return t=null,s?a.length()>0?"AD_Client_ID="+a.toString():(this.log.log(VIS.Logging.Level.SEVERE,"No Access Org records"),"AD_Client_ID=-1"):"AD_Client_ID IN("+a.toString()+")"},VIS.MRole.getOrgWhere=function(e,t){if(this.vo.IsAccessAllOrgs)return null;var i=[];t||i.push("0");for(var n=this.vo.orgAccess,a=0;a<n.length;a++){var s=n[a].AD_Org_ID.toString();t&&s.readOnly||i.indexOf(s)<0&&i.push(s)}if(n=null,1==i.length)return"COALESCE("+(null==e?"":e+".")+"AD_Org_ID,0)="+i[0];if(0==i.length)return this.log.log(VIS.Logging.Level.SEVERE,"No Access Org records"),(null==e?"":e+".")+"AD_Org_ID=-1";for(var l=new StringBuilder,o=new StringBuilder,r=0,d=0;d<i.length;d++)o.length()>0&&o.append(","),o.append(i[d]),++r%999!=0&&r!=i.length||(l.length()>0&&l.append(" OR "),l.append("COALESCE("+(null==e?"":e+".")+"AD_Org_ID,0) IN(").append(o.toString()).append(")"),o=null,o=new StringBuilder);return"("+l.toString()+")"},VIS.MRole.getAD_Table_ID=function(e){var t=this.vo.tableName[e];return null!=t?t:0},VIS.MRole.getSynonym=function(e){var t=this.columnSynonym[e];return t||null},VIS.MRole.getKeyColumnName=function(e,t){var i=this.getSynonym(t);if(null==i)return t;for(var n=0;n<e.length;n++){var a=e[n];if(t.equals("AD_User_ID")){if(a.getTableName().equals("AD_User"))return t}else if(t.equals("AD_ElementValue_ID")&&a.getTableName().equals("AD_ElementValue"))return t}return i},VIS.MRole.getDependentAccess=function(e,t,i,n){if(0==t.length&&0==i.length)return"";0!=t.length&&0!=i.length&&this.log.warning("Mixing Include and Excluse rules - Will not return values");var a=new StringBuilder(" AND ");if(n&&a.append(" ( "),1==t.length)a.append(e).append("=").append(t[0]);else if(t.length>1){a.append(e).append(" IN (");for(var s=0;s<t.length;s++)s>0&&a.append(","),a.append(t[s]);a.append(")")}else if(1==i.length)a.append(e).append("<>").append(i[0]);else if(i.length>1){a.append(e).append(" NOT IN (");for(s=0;s<i.length;s++)s>0&&a.append(","),a.append(i[s]);a.append(")")}return n&&a.append(" OR ").append(e).append(" IS NULL").append(" ) "),a.toString()},VIS.MRole.getDependentRecordWhereColumn=function(e,t){var i=t,n=e.indexOf(t)-1,a=e.charAt(n);if("."==a){for(var s=new StringBuilder;" "!=a&&","!=a&&"("!=a;)s.insert(0,a),a=e.charAt(--n);return s.append(t),s.toString()}return i},VIS.MRole.getRecordWhere=function(e,t,i){for(var n=new StringBuilder,a=new StringBuilder,s=!1,l=this.vo.recordAccess,o=0;o<l.length;o++)l[o].AD_Table_ID==e&&(l[o].IsExclude?(0==a.length()?a.append(t).append(" NOT IN ("):a.append(","),a.append(l[o].Record_ID)):i&&l[o].IsReadOnly||(0==n.length()?n.append(t).append(" IN ("):n.append(","),n.append(l[o].Record_ID)),s=s||l[o].IsIncludeNull);var r=new StringBuilder;if(a.length()>0&&(s&&r.append("("),r.append(a).append(")"),s&&r.append(" OR ").append(t).append(" IS NULL )"),s=!1),n.length()>0&&(r.length()>0&&r.append(" AND "),s&&r.append("("),r.append(n).append(")"),s&&r.append(" OR ").append(t).append(" IS NULL )")),!this.vo.IsPersonalAccess&&!this.vo.tableData[e].IsView&&this.vo.tableData[e].HasKey){var d=" NOT IN ( SELECT Record_ID FROM AD_Private_Access WHERE AD_Table_ID = "+e+" AND AD_User_ID <> "+this.vo.AD_User_ID+" AND IsActive = 'Y' )";r.length()>0&&r.append(" AND "),r.append(t).append(d)}return l=null,r.toString()},VIS.MRole.getDocWhere=function(e){var t=VIS.Application.contextUrl+"JsonData/JDataSetWithCode";if(!this.vo.IsUseBPRestrictions)return"";var i=[];i[0]=new VIS.DB.SqlParam("@TableName",e);var n=function(e,i,n){var a=!!n,s=null;return function(e,i,n){var a=null;$.ajax({url:t,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){a=e,n&&n(e)}))}({sql:e,page:1,pageSize:0},a,(function(e){t=(new VIS.DB.DataSet).toJson(e);var t=(new VIS.DB.DataSet).toJson(e);s=t.getTable(0).getRows().length>0?t.getTable(0).getRow(0).getCell(0):null,t.dispose(),t=null,a&&n(s)})),s}("VIS_101");if(!(0!=(n?parseInt(n):0)))return"";var a=VIS.context.getAD_User_ID();return $.ajax({type:"Get",async:!1,url:VIS.Application.contextUrl+"Form/GetDocWhere",data:{AD_User_ID:a,TableName:e},success:function(e){docAccess=e},error:function(e){console.log(e)}}),docAccess},VIS.MRole.addAccessSQL=function(e,t,n,a,s){n&&VIS.Utility.Util.isEmpty(t)&&(n=!1);var l=new StringBuilder,o="",r=e.lastIndexOf(" ORDER BY ");-1!=r?(o=e.substring(r),l.append(e.substring(0,r))):l.append(e);var d=new VIS.AccessSqlParser(l.toString()),c=d.getTableInfo(d.getMainSqlIndex());-1==d.getMainSql().indexOf(" WHERE ")?l.append(" WHERE "):l.append(" AND ");var p="";if(c.length>0&&(c[0].getTableName().equals(t)||c[0].getSynonym().equals(t))&&(p=c[0].getSynonym(),VIS.Utility.Util.isEmpty(p)&&(p=c[0].getTableName())),!VIS.Utility.Util.isEmpty(t)&&VIS.Utility.Util.isEmpty(p)){var u="TableName not correctly parsed - TableNameIn="+t+" - "+d;c.length>0&&(u+=" - #1 "+c[0]),u+="\n = "+e,this.log.log(VIS.Logging.Level.SEVERE,u),p=t}if(n&&!VIS.Utility.Util.isEmpty(p)&&l.append(p).append("."),l.append(this.getClientWhere(a)),this.vo.IsAccessAllOrgs||s||(l.append(" AND "),n&&!VIS.Utility.Util.isEmpty(p)?l.append(this.getOrgWhere(p,a)):l.append(this.getOrgWhere(null,a))),this.vo.IsUseBPRestrictions){var g=this.getDocWhere(p);g.length()>0&&(l.append(" AND "),l.append(g))}var h,v=0;for(i=0;i<c.length;i++){var f=(h=c[i]).getTableName();if(0!=(v=this.getAD_Table_ID(f))&&!this.vo.IsAccessAllOrgs&&s){var m=h.getSynonym();(null==m||m.isEmpty())&&(m=f),l.append(" AND "),l.append(this.getOrgWhere(m,a))}if(0!=v&&!this.getIsTableAccess(v,!a)){l.append(" AND 1=3"),this.log.fine("No access to AD_Table_ID="+v+" - "+f+" - "+l);break}var y="";n&&(0==(y=h.getSynonym()).length&&(y=f),y+="."),y+=f+"_ID";var I=this.getRecordWhere(v,y,a);I.length>0&&(l.append(" AND ").append(I),this.log.finest("Record access - "+I))}h=null;var D=d.getMainSql();v=0;var w=null,b=[],C=[],_=!1,S=this.vo.recordDependentAccess;for(i=0;i<S.length;i++){var x=this.getKeyColumnName(d.getTableInfo(d.getMainSqlIndex()),S[i].KeyColumnName);if(null!=x){var A=D.indexOf(x);if(-1!=A){var T=D.charAt(A-1);if(!(","!=T&&"."!=T&&" "!=T&&"("!=T||","!=(T=D.charAt(A+x.length))&&" "!=T&&")"!=T)){0!=v&&v!=S[i].AD_Table_ID&&l.append(this.getDependentAccess(w,b,C,_)),v=S[i].AD_Table_ID,S[i].IsExclude?(C.push(S[i].Record_ID),this.log.fine("Exclude "+x+" - "+S[i])):a&&S[i].IsReadOnly||b.push(S[i].Record_ID),_=_||S[i].IsIncludeNull;w=this.getDependentRecordWhereColumn(D,x)}}}}return l.append(this.getDependentAccess(w,b,C,_)),l.append(o),l.toString()},VIS.MRole.getWindowAccess=function(e){return!!this.vo.windowAccess[e]},VIS.MRole.getFormAccess=function(e){return!!this.vo.formAccess[e]},VIS.MRole.getProcessAccess=function(e){return!!this.vo.processAccess[e]},VIS.MRole.getIsClientAccess=function(e,t){if(0==e&&!t)return!0;if(this.vo.IsAccessAllOrgs)return this.vo.AD_Client_ID==e;for(var i=this.vo.orgAccess,n=0;n<i.length;n++)if(i[n].AD_Client_ID==e){if(!t)return!0;if(!i[n].readOnly)return!0}return!1},VIS.MRole.getIsShowPreference=function(){return this.vo.IsShowPreference},VIS.MRole.getName=function(){return this.vo.Name},VIS.MRole.getPreferenceType=function(){return this.vo.PreferenceType},VIS.MRole.getIsDisplayClient=function(){return this.vo.IsDisplayClient},VIS.MRole.getIsDisplayOrg=function(){return this.vo.IsDisplayOrg},VIS.MRole.getIsPersonalLock=function(){return this.vo.IsPersonalLock},VIS.MRole.getIsShowSharedRecord=function(){return this.vo.ShowSharedRecords},VIS.MRole.getMaxQueryRecords=function(){return this.vo.MaxQueryRecords},VIS.MRole.getIsQueryMax=function(e){var t=this.getMaxQueryRecords();return t>0&&e>t},VIS.MRole.getIsShowAcct=function(){return this.vo.IsShowAcct},VIS.MRole.getIsOverwritePriceLimit=function(){return this.vo.IsOverwritePriceLimit},VIS.MRole.getIsOverrideReturnPolicy=function(){return this.vo.IsOverrideReturnPolicy},VIS.MRole.getIsDisableMenu=function(){return this.vo.IsDisableMenu},VIS.MRole.getHomePage=function(){return this.vo.HomePage},VIS.MRole.toStringX=function(e){var t=new StringBuilder;return t.append(VIS.Msg.translate(e,"AD_Role_ID")).append("=").append(this.getName()).append(" - ").append(VIS.Msg.translate(e,"IsCanExport")).append("=").append(this.getIsCanExport()).append(" - ").append(VIS.Msg.translate(e,"IsCanReport")).append("=").append(this.getIsCanReport()).append(VIS.Env.NL).append(VIS.Env.NL),t.toString()}},2857:()=>{var e=e||function(e,t){var i={},n=i.lib={},a=function(){},s=n.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=n.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||r).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var a=0;a<e;a++)t[n+a>>>2]|=(i[a>>>2]>>>24-a%4*8&255)<<24-(n+a)%4*8;else if(65535<i.length)for(a=0;a<e;a+=4)t[n+a>>>2]=i[a>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*e.random()|0);return new l.init(i,t)}}),o=i.enc={},r=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++){var a=t[n>>>2]>>>24-n%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(i,t/2)}},d=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(i,t)}},c=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},p=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,a=i.sigBytes,s=this.blockSize,o=a/(4*s);if(t=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*s,a=e.min(4*t,a),t){for(var r=0;r<t;r+=s)this._doProcessBlock(n,r);r=n.splice(0,t),i.sigBytes-=a}return new l.init(r,a)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=p.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new u.HMAC.init(e,i).finalize(t)}}});var u=i.algo={};return i}(Math);!function(){var t=e,i=t.lib.WordArray;t.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp(),e=[];for(var a=0;a<i;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;4>l&&a+.75*l<i;l++)e.push(n.charAt(s>>>6*(3-l)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,n=this._map;(a=n.charAt(64))&&(-1!=(a=e.indexOf(a))&&(t=a));for(var a=[],s=0,l=0;l<t;l++)if(l%4){var o=n.indexOf(e.charAt(l-1))<<l%4*2,r=n.indexOf(e.charAt(l))>>>6-l%4*2;a[s>>>2]|=(o|r)<<24-s%4*8,s++}return i.create(a,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function i(e,t,i,n,a,s,l){return((e=e+(t&i|~t&n)+a+l)<<s|e>>>32-s)+t}function n(e,t,i,n,a,s,l){return((e=e+(t&n|i&~n)+a+l)<<s|e>>>32-s)+t}function a(e,t,i,n,a,s,l){return((e=e+(t^i^n)+a+l)<<s|e>>>32-s)+t}function s(e,t,i,n,a,s,l){return((e=e+(i^(t|~n))+a+l)<<s|e>>>32-s)+t}for(var l=e,o=(d=l.lib).WordArray,r=d.Hasher,d=l.algo,c=[],p=0;64>p;p++)c[p]=4294967296*t.abs(t.sin(p+1))|0;d=d.MD5=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var l=0;16>l;l++){var o=e[r=t+l];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}l=this._hash.words;var r=e[t+0],d=(o=e[t+1],e[t+2]),p=e[t+3],u=e[t+4],g=e[t+5],h=e[t+6],v=e[t+7],f=e[t+8],m=e[t+9],y=e[t+10],I=e[t+11],D=e[t+12],w=e[t+13],b=e[t+14],C=e[t+15],_=i(_=l[0],A=l[1],x=l[2],S=l[3],r,7,c[0]),S=i(S,_,A,x,o,12,c[1]),x=i(x,S,_,A,d,17,c[2]),A=i(A,x,S,_,p,22,c[3]);_=i(_,A,x,S,u,7,c[4]),S=i(S,_,A,x,g,12,c[5]),x=i(x,S,_,A,h,17,c[6]),A=i(A,x,S,_,v,22,c[7]),_=i(_,A,x,S,f,7,c[8]),S=i(S,_,A,x,m,12,c[9]),x=i(x,S,_,A,y,17,c[10]),A=i(A,x,S,_,I,22,c[11]),_=i(_,A,x,S,D,7,c[12]),S=i(S,_,A,x,w,12,c[13]),x=i(x,S,_,A,b,17,c[14]),_=n(_,A=i(A,x,S,_,C,22,c[15]),x,S,o,5,c[16]),S=n(S,_,A,x,h,9,c[17]),x=n(x,S,_,A,I,14,c[18]),A=n(A,x,S,_,r,20,c[19]),_=n(_,A,x,S,g,5,c[20]),S=n(S,_,A,x,y,9,c[21]),x=n(x,S,_,A,C,14,c[22]),A=n(A,x,S,_,u,20,c[23]),_=n(_,A,x,S,m,5,c[24]),S=n(S,_,A,x,b,9,c[25]),x=n(x,S,_,A,p,14,c[26]),A=n(A,x,S,_,f,20,c[27]),_=n(_,A,x,S,w,5,c[28]),S=n(S,_,A,x,d,9,c[29]),x=n(x,S,_,A,v,14,c[30]),_=a(_,A=n(A,x,S,_,D,20,c[31]),x,S,g,4,c[32]),S=a(S,_,A,x,f,11,c[33]),x=a(x,S,_,A,I,16,c[34]),A=a(A,x,S,_,b,23,c[35]),_=a(_,A,x,S,o,4,c[36]),S=a(S,_,A,x,u,11,c[37]),x=a(x,S,_,A,v,16,c[38]),A=a(A,x,S,_,y,23,c[39]),_=a(_,A,x,S,w,4,c[40]),S=a(S,_,A,x,r,11,c[41]),x=a(x,S,_,A,p,16,c[42]),A=a(A,x,S,_,h,23,c[43]),_=a(_,A,x,S,m,4,c[44]),S=a(S,_,A,x,D,11,c[45]),x=a(x,S,_,A,C,16,c[46]),_=s(_,A=a(A,x,S,_,d,23,c[47]),x,S,r,6,c[48]),S=s(S,_,A,x,v,10,c[49]),x=s(x,S,_,A,b,15,c[50]),A=s(A,x,S,_,g,21,c[51]),_=s(_,A,x,S,D,6,c[52]),S=s(S,_,A,x,p,10,c[53]),x=s(x,S,_,A,y,15,c[54]),A=s(A,x,S,_,o,21,c[55]),_=s(_,A,x,S,f,6,c[56]),S=s(S,_,A,x,C,10,c[57]),x=s(x,S,_,A,h,15,c[58]),A=s(A,x,S,_,w,21,c[59]),_=s(_,A,x,S,u,6,c[60]),S=s(S,_,A,x,I,10,c[61]),x=s(x,S,_,A,d,15,c[62]),A=s(A,x,S,_,m,21,c[63]);l[0]=l[0]+_|0,l[1]=l[1]+A|0,l[2]=l[2]+x|0,l[3]=l[3]+S|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;i[a>>>5]|=128<<24-a%32;var s=t.floor(n/4294967296);for(i[15+(a+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(a+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(i.length+1),this._process(),i=(e=this._hash).words,n=0;4>n;n++)a=i[n],i[n]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return e},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),l.MD5=r._createHelper(d),l.HmacMD5=r._createHmacHelper(d)}(Math),function(){var t,i=e,n=(t=i.lib).Base,a=t.WordArray,s=(t=i.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var i=(o=this.cfg).hasher.create(),n=a.create(),s=n.words,l=o.keySize,o=o.iterations;s.length<l;){r&&i.update(r);var r=i.update(e).finalize(t);i.reset();for(var d=1;d<o;d++)r=i.finalize(r),i.reset();n.concat(r)}return n.sigBytes=4*l,n}});i.EvpKDF=function(e,t,i){return s.create(i).compute(e,t)}}(),e.lib.Cipher||function(t){var i=(h=e).lib,n=i.Base,a=i.WordArray,s=i.BufferedBlockAlgorithm,l=h.enc.Base64,o=h.algo.EvpKDF,r=i.Cipher=s.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,i){this.cfg=this.cfg.extend(i),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,i,n){return("string"==typeof i?v:g).encrypt(e,t,i,n)},decrypt:function(t,i,n){return("string"==typeof i?v:g).decrypt(e,t,i,n)}}}});i.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var d=h.mode={},c=function(e,t,i){var n=this._iv;n?this._iv=undefined:n=this._prevBlock;for(var a=0;a<i;a++)e[t+a]^=n[a]},p=(i.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();p.Encryptor=p.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize;c.call(this,e,t,n),i.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),p.Decryptor=p.extend({processBlock:function(e,t){var i=this._cipher,n=i.blockSize,a=e.slice(t,t+n);i.decryptBlock(e,t),c.call(this,e,t,n),this._prevBlock=a}}),d=d.CBC=p,p=(h.pad={}).Pkcs7={pad:function(e,t){for(var i,n=(i=(i=4*t)-e.sigBytes%i)<<24|i<<16|i<<8|i,s=[],l=0;l<i;l+=4)s.push(n);i=a.create(s,i),e.concat(i)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},i.BlockCipher=r.extend({cfg:r.cfg.extend({mode:d,padding:p}),reset:function(){r.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else i=t.createDecryptor,this._minBufferSize=1;this._mode=i.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var u=i.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),g=(d=(h.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?a.create([1398893684,1701076831]).concat(e).concat(t):t).toString(l)},parse:function(e){var t=(e=l.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var i=a.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return u.create({ciphertext:e,salt:i})}},i.SerializableCipher=n.extend({cfg:n.extend({format:d}),encrypt:function(e,t,i,n){n=this.cfg.extend(n);var a=e.createEncryptor(i,n);return t=a.finalize(t),a=a.cfg,u.create({ciphertext:t,key:i,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,i,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(i,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),h=(h.kdf={}).OpenSSL={execute:function(e,t,i,n){return n||(n=a.random(8)),e=o.create({keySize:t+i}).compute(e,n),i=a.create(e.words.slice(t),4*i),e.sigBytes=4*t,u.create({key:e,iv:i,salt:n})}},v=i.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:h}),encrypt:function(e,t,i,n){return i=(n=this.cfg.extend(n)).kdf.execute(i,e.keySize,e.ivSize),n.iv=i.iv,(e=g.encrypt.call(this,e,t,i.key,n)).mixIn(i),e},decrypt:function(e,t,i,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),i=n.kdf.execute(i,e.keySize,e.ivSize,t.salt),n.iv=i.iv,g.decrypt.call(this,e,t,i.key,n)}})}(),function(){for(var t=e,i=t.lib.BlockCipher,n=t.algo,a=[],s=[],l=[],o=[],r=[],d=[],c=[],p=[],u=[],g=[],h=[],v=0;256>v;v++)h[v]=128>v?v<<1:v<<1^283;var f=0,m=0;for(v=0;256>v;v++){var y=(y=m^m<<1^m<<2^m<<3^m<<4)>>>8^255&y^99;a[f]=y,s[y]=f;var I=h[f],D=h[I],w=h[D],b=257*h[y]^16843008*y;l[f]=b<<24|b>>>8,o[f]=b<<16|b>>>16,r[f]=b<<8|b>>>24,d[f]=b,b=16843009*w^65537*D^257*I^16843008*f,c[y]=b<<24|b>>>8,p[y]=b<<16|b>>>16,u[y]=b<<8|b>>>24,g[y]=b,f?(f=I^h[h[h[w^I]]],m^=h[h[m]]):f=m=1}var C=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=i.extend({_doReset:function(){for(var e=(i=this._key).words,t=i.sigBytes/4,i=4*((this._nRounds=t+6)+1),n=this._keySchedule=[],s=0;s<i;s++)if(s<t)n[s]=e[s];else{var l=n[s-1];s%t?6<t&&4==s%t&&(l=a[l>>>24]<<24|a[l>>>16&255]<<16|a[l>>>8&255]<<8|a[255&l]):(l=a[(l=l<<8|l>>>24)>>>24]<<24|a[l>>>16&255]<<16|a[l>>>8&255]<<8|a[255&l],l^=C[s/t|0]<<24),n[s]=n[s-t]^l}for(e=this._invKeySchedule=[],t=0;t<i;t++)s=i-t,l=t%4?n[s]:n[s-4],e[t]=4>t||4>=s?l:c[a[l>>>24]]^p[a[l>>>16&255]]^u[a[l>>>8&255]]^g[a[255&l]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,l,o,r,d,a)},decryptBlock:function(e,t){var i=e[t+1];e[t+1]=e[t+3],e[t+3]=i,this._doCryptBlock(e,t,this._invKeySchedule,c,p,u,g,s),i=e[t+1],e[t+1]=e[t+3],e[t+3]=i},_doCryptBlock:function(e,t,i,n,a,s,l,o){for(var r=this._nRounds,d=e[t]^i[0],c=e[t+1]^i[1],p=e[t+2]^i[2],u=e[t+3]^i[3],g=4,h=1;h<r;h++){var v=n[d>>>24]^a[c>>>16&255]^s[p>>>8&255]^l[255&u]^i[g++],f=n[c>>>24]^a[p>>>16&255]^s[u>>>8&255]^l[255&d]^i[g++],m=n[p>>>24]^a[u>>>16&255]^s[d>>>8&255]^l[255&c]^i[g++];u=n[u>>>24]^a[d>>>16&255]^s[c>>>8&255]^l[255&p]^i[g++],d=v,c=f,p=m}v=(o[d>>>24]<<24|o[c>>>16&255]<<16|o[p>>>8&255]<<8|o[255&u])^i[g++],f=(o[c>>>24]<<24|o[p>>>16&255]<<16|o[u>>>8&255]<<8|o[255&d])^i[g++],m=(o[p>>>24]<<24|o[u>>>16&255]<<16|o[d>>>8&255]<<8|o[255&c])^i[g++],u=(o[u>>>24]<<24|o[d>>>16&255]<<16|o[c>>>8&255]<<8|o[255&p])^i[g++],e[t]=v,e[t+1]=f,e[t+2]=m,e[t+3]=u},keySize:8});t.AES=i._createHelper(n)}(),function(e,t){var i=t.enc.Utf8.parse(e.context.getContext("#key")),n=t.enc.Utf8.parse(e.context.getContext("#key"));e.secureEngine={encrypt:function(e){var a="";return(e||0===e)&&(a=t.AES.encrypt(t.enc.Utf8.parse(e.toString()),i,{keySize:16,iv:n,mode:t.mode.CBC,padding:t.pad.Pkcs7})),a.toString()},decrypt:function(e){var a="";return(e||e.length>12)&&(a=t.AES.decrypt(e,i,{keySize:16,iv:n,mode:t.mode.CBC,padding:t.pad.Pkcs7})),a.toString(t.enc.Utf8)},isEncrypted:function(e){if(e||e.length>12)return!0}}}(VIS,e)},5151:()=>{!function(e,t){e.sseManager=function(){var e=[];function t(t){for(var i=0,n=e.length;i<n;i++)e[i].onmessage&&e[i].onmessage(t)}return{start:function(){new EventSource("Message/Get").onmessage=function(e){var i=JSON.parse(e.data);if(i&&i.length>0)for(var n=0,a=i.length;n<a;n++)"MSG"==i[n].Event?toastr.success(i[n].Message,"",{timeOut:4e3,positionClass:"toast-top-center",closeButton:!0}):t(i[n])}},register:function(t){e.indexOf(t)<0&&e.push(t)},unregister:function(t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}}}()}(VIS,jQuery)},3745:()=>{!function(e,t){function i(i,n,a,s,l){this.selectionChangeListner=null,this.windowNo=i;var o="",r=null,d=[],c=[],p=-1,u=null,g=null,h=null,v=0,f=0;this.onDemandTree=s,this.currentNode=0,this.searchNode=!1,this.isSummaryNode=!1,this.gc=l;var m,y,I,D,w=this,b=null,C=null,_=null,S=null,x=null;e.Application.contextUrl;b=t("<table style='width:100%;height:100%'><tr><td style='height:100%'><div class='vis-css-treewindow' ></td></tr><tr><td style='text-align:center'><div class='vis-tree-search'><div class='input-group'><input type='text' class='form-control ui-autocomplete-input' placeholder='Search'>  <span class='input-group-append'><button class='input-group-text'><a href='#' class='vis vis-search' tabindex='-1'></a></button></span></div></div></td></tr></table>"),(C=b.find(".vis-css-treewindow")).css({"max-width":"290px"}),b.find(".vis-tree-search"),_=b.find(".input-group-addon"),S=b.find("input"),x=t("<ul class='vis-apanel-rb-ul'>"),m=t("<li data-action='Copy'>").text(e.Msg.getMsg("Copy")),y=t("<li data-action='Move'>").text(e.Msg.getMsg("Move")),I=t("<li data-action='Cancel'>").text(e.Msg.getMsg("Cancel")),x.append(m),w.onDemandTree&&(D=t("<li data-action='MoveHere'>").text(e.Msg.getMsg("MoveHere")),x.append(D)),x.append(y).append(I);w=this;function A(e){var t=S.val();if(null==t||t.length<2)w.searchNode=!1;else{var i=w.containsTextInArray(c,t,p);if(i>-1){var n=d[i];w.currentNode=n,p=i,w.setSelectedNode(n),w.selectionChangeListner?w.selectionChangeListner.nodeSelectionChanged({newValue:n,propertyName:""}):w.searchNode=!1}else w.searchNode=!1}}this.setSize=function(e,t){C.height(e-40)},this.setTabID=function(e){f=e},this.initTree=function(n){v=n,"undefined"!=this.onDemandTree&&null!=this.onDemandTree||(this.onDemandTree=!1);var s={AD_Tree_ID:v,editable:a,windowNo:i,onDemandTree:this.onDemandTree,AD_Tab_ID:f};e.dataContext.getTreeAsString(s,(function(e){if(C.html(e),d.length=0,c.length=0,C.find("LI").each((function(e,i){var n=t(i),a=n.find(">label");a.length<1&&(a=n.find(">A")),d.push(n.data("value")),c.push(a.text())})),r=C.find(">ul"),o=r.data("tablename"),r=r.find(">li>ul"),w.onDemandTree&&C){var i=C.find("ul");if(i&&i.length>1){var n=t(i.find("ul")[0]).children();n&&n.length>0&&!w.gc.isZoomAction?t(n[0]).trigger("click"):w.gc.isZoomAction||(w.gc.query(w.selectionChangeListner.aPanel.curTab.getOnlyCurrentDays(),0,!1),w.selectionChangeListner.aPanel.setBusy(!1))}}}))},this.updateArray=function(e,t){d.push(t),c.push(e)},this.getRoot=function(){return b},C.on(e.Events.onClick,(function(e){if("INPUT"===e.target.nodeName||"LI"===e.target.nodeName||"A"===e.target.nodeName){var i=t(e.target);if("INPUT"===e.target.nodeName&&(i=t(e.target.parentNode)),w.selectionChangeListner){var n,a;if(w.onDemandTree)(n=b.find("*.vis-css-treewindow-selected")).length>0&&n.removeClass("vis-css-treewindow-selected"),(a=t(t(e.target).parent())).find(">label").length>0?a.find(">label").addClass("vis-css-treewindow-selected"):(a.find(">a").addClass("vis-css-treewindow-selected"),t(a.find("label")[0]).addClass("vis-css-treewindow-selected"));else(n=b.find("*.vis-css-treewindow-selected")).length>0&&n.removeClass("vis-css-treewindow-selected"),(a=t(t(e.target).parent())).find(">label").length>0?a.find(">label").addClass("vis-css-treewindow-selected"):(a.find(">a").addClass("vis-css-treewindow-selected"),t(a.find("label")[0]).addClass("vis-css-treewindow-selected"));"Y"==i.data("summary")?w.isSummaryNode=!0:w.isSummaryNode=!1,w.currentNode=i.data("value"),w.selectionChangeListner.nodeSelectionChanged({newValue:i.data("value"),propertyName:"",isSummaryNode:w.isSummaryNode})}e.stopPropagation()}else if("SPAN"===e.target.nodeName&&("SPAN"==e.target.parentNode.nodeName||"LI"==e.target.parentNode.nodeName)){var s=t(e.target.parentNode);"SPAN"===e.target.parentNode.nodeName&&(s=t(e.target.parentNode.parentNode)),u=s,m.hide(),I.hide(),y.hide(),w.onDemandTree&&D.hide(),null!=g?(y.show(),I.show()):(m.show(),w.onDemandTree&&D.show()),t(e.target).w2overlay(x.clone(!0))}})),_.on(e.Events.onTouchStartOrClick,(function(e){w.searchNode=!0,A(e)})),S.on("keydown",(function(e){13==e.keyCode&&(w.searchNode=!0,A(e))})),x.on(e.Events.onTouchStartOrClick,"LI",(function(i){var n=t(i.target).data("action");if("Copy"==n)g=u;else if("Move"==n)h=u,function(){if(null!=g&&null!=h&&g.data("value")!=h.data("value")){var i=g.parent();g.remove();var n=i.parent().data("value"),a=null,s=h,l=0;if("Y"!=h.data("summary"))s=h.parent(),l=h.index(),g.insertAfter(s.children()[l]),a=s.parent().data("value");else{var r=s.find(">ul");r.children().length>0?g.insertBefore(r.children()[l]):g.appendTo(r),a=s.data("value"),s=r}var d=i.children(),c=0,p=[],u=[];for(c=0;c<d.length;c++){var f=t(d[c]);p.push(f.data("value"))}if(n!=a)for(d=s.children(),c=0;c<d.length;c++)f=t(d[c]),u.push(f.data("value"));t.ajax({type:"post",async:!0,url:e.Application.contextUrl+"Form/UpdateTree",data:{oldParentChildren:JSON.stringify(p),newParentChildren:JSON.stringify(u),oldId:n,newId:a,AD_Tree_ID:v,tableName:o},success:function(e){console.log(e)},error:function(e){}})}}(),g=null,h=null,u=null;else if("MoveHere"==n){var a=w.selectionChangeListner.vTable.getSelection(!0),s="";if(w.selectionChangeListner.aPanel.setBusy(!0),a&&a.length>0)for(var l=w.selectionChangeListner.vTable.grid,r=w.selectionChangeListner.getMTab().gridTable.keyColumnName.toLower(),d=0;d<a.length;d++)s+=0==d?l.get(a[d]+1)[r]:","+l.get(a[d]+1)[r];var c={nodeID:s,oldParentID:0,newParentID:u.data("value"),AD_Tree_ID:v};t.ajax({url:e.Application.contextUrl+"Tree/UpdateTree",dataType:"json",data:c,success:function(e){e>0&&w.selectionChangeListner.removeRecord()},error:function(e){w.selectionChangeListner.aPanel.setBusy(!1)}}),u=null,g=null}else"Cancel"==n&&(g=null,u=null)})),this.getRootNode=function(){return r},this.disposeLocal=function(){C.off(e.Events.onClick),_.off(e.Events.onTouchStartOrClick),x.off(e.Events.onTouchStartOrClick),x=null,C=null,b.remove(),b=null,w=null}}i.prototype.containsTextInArray=function(e,t,i){for(var n=i+1;n<e.length;n++)if(-1!=n&&e[n].trim().toLowerCase().contains(t.trim().toLowerCase()))return n;return i>-1?(i=-1,this.containsTextInArray(e,t,i)):-1},i.prototype.addSelectionChangeListner=function(e){this.selectionChangeListner=e},i.prototype.setSelectedNode=function(e){return-1!=e?this.selectID(e,!0):(this.currentNode=0,!1)},i.prototype.selectID=function(e,t){if(!this.onDemandTree||this.searchNode){this.currentNode=e,this.searchNode=!1;var i=this.getRoot(),n=i.find("li[data-value='"+e+"']");if(this.isSummaryNode="Y"==n.data("summary"),null!=n&&n.length>0){var a=i.find("*.vis-css-treewindow-selected");a.length>0&&a.removeClass("vis-css-treewindow-selected"),n.find(">label").length>0?n.find(">label").addClass("vis-css-treewindow-selected"):n.find(">a").addClass("vis-css-treewindow-selected");for(var s=n;null!=n;){var l=n.find("input");l.length>0&&(l.prop("checked")||l.prop("checked",!0)),"UL"==(n=n.parent())[0].nodeName&&(n=n.parent()),"LI"==n[0].nodeName||(n=null)}return s[0].scrollIntoView(),!0}return!1}},i.prototype.nodeChanged=function(e,i,n,a,s,l){if(console.log("Save="+e+", KeyID="+i+", Name="+n+", Description="+a+", IsSummary="+s+", ImageInd="+l),0!=i){var o=this.getRoot(),r=!1,d=o.find("li[data-value='"+i+"']");if(null!=d&&d.length>0&&(r=!0),!r&&e)if(this.onDemandTree){if((c=o.find("*.vis-css-treewindow-selected"))&&s)(u=t(c.parent()).find("ul"))&&u.length>0?t(u[0]).append(this.getNode(i,n,a,s,l,this.windowNo)):t(c.parent()).append(t("<ul>").append(this.getNode(i,n,a,s,l,this.windowNo)))}else{var c,p="Y"==(c=o.find("*.vis-css-treewindow-selected")).parent("li").data("summary");if(c&&p){var u;(u=t(c.parent()).find("ul"))&&u.length>0?t(u[0]).append(this.getNode(i,n,a,s,l,this.windowNo)):t(c.parent()).append(t("<ul>").append(this.getNode(i,n,a,s,l,this.windowNo))),this.updateArray(n,i)}else{var g=this.getRootNode(),h=this.getNode(i,n,a,s,l,this.windowNo);g.append(h),h[0].scrollIntoView(),this.updateArray(n,i)}}else if(r&&e){this.toggleTypeOfNode(d,s,i,this.windowNo,l),s&&0==d.find(">ul").length&&d.append(t("<ul>"));var v=d.find(">label");v&&0!=v.length||(v=d.find(">a")),v.length>0&&v.text(n)}else if(r&&!e){var f=d.find(">ul");f.length>0&&(f.remove(),this.getRootNode().append(f.children())),d.remove()}else d=null}},i.prototype.getNode=function(i,n,a,s,l,o){n=e.Utility.encodeText(n);var r='<li data-value="'+i+'"';return r+=s?'data-summary="Y" class="vis-hasSubMenu"> <input type="checkbox" id="'+o+i+'"><label for="'+o+i+'">'+n+'</label><span class="vis-treewindow-span"><span class="vis-css-treewindow-arrow-up"></span></span><ul><ul>':'data-summary="N"> <a href="javascript:void(0)" data-value="'+i+'" data-action="'+l+'" data-actionid="'+i+'"><span style="font-size:11px;margin-right:5px"'+this.getClassIcon(l)+"></span>"+n+'</a > <span class="vis-treewindow-span"><span class="vis-css-treewindow-arrow-up"> </span></span></li>',t(r)},i.prototype.getIcon=function(e){switch(e){case"W":case"X":case"V":default:return"mWindow.png";case"R":return"mReport.png";case"P":return"mProcess.png";case"F":return"mWorkflow.png";case"B":return"mWorkbench.png";case"D":return"mDocAction.png"}},i.prototype.getClassIcon=function(e){switch(e){case"W":return"class = 'fa fa-window-maximize'";case"R":return"class = 'vis vis-report'";case"P":case"T":return"class = 'fa fa-cog'";case"F":case"B":case"V":case"D":default:return"class = 'fa fa-clone'";case"X":return"class = 'fa fa-list-alt'";case"O":return"class = 'fa fa-circle'"}},i.prototype.toggleTypeOfNode=function(t,i,n,a,s){if(i!==("Y"==t.data("summary"))){var l=t.find(">ul");l.remove(),t.data("summary",i?"Y":"N"),t.toggleClass("vis-hasSubMenu"),i?t.html('<input type="checkbox" id="'+a+n+'"><label for="'+a+n+'">'+name+'</label><span class="vis-treewindow-span"><span class="vis-css-treewindow-arrow-up"></span></span>'):t.html('<img src="'+e.Application.contextUrl+"Areas/VIS/Images/login/"+this.getIcon(s)+'">  <a href="javascript:void(0)" data-value="'+n+'" data-action="'+s+'" data-actionid="'+n+'"> '+name+'</a><span class="vis-treewindow-span"><span class="vis-css-treewindow-arrow-up"> </span></span>'),l.length>0&&t.append(l)}else if(!i){var o=t.find(">a");if(o.length>0){o.data("action");o!=s&&(t.find(">img").attr("src",e.Application.contextUrl+"Areas/VIS/Images/login/"+this.getIcon(s)),o.data("action",s)),o=null}}},i.prototype.dispose=function(){this.disposeLocal(),this.addPropertyChangeListner=null},e.TreePanel=i}(VIS,jQuery)},7063:()=>{VISUtil=window.VISUtil||{},function(e,t){function i(e){this.pattern,this.applyPattern(e)}function n(e,t){this.name=e,this.value=t,this.isDate=!1,this.isByteArray=!1}function a(){this.tables=[],this.total=0}function s(){this.count=0,this.totalPage=0,this.page=1,this.columns=[],this.rows=[],this.totalRecord=0,this.columnsName=[]}function l(e,t){this.cells=e.cells,this.id=e.id,this.parent=t}function o(){return this.rowIndex=-1,this.tables=[],this.curTable,this}function r(){}function d(){this.List={sq:{decimalSeparator:!1},ar:{decimalSeparator:!0},bg:{decimalSeparator:!1},be:{decimalSeparator:!1},ca:{decimalSeparator:!1},zh:{decimalSeparator:!0},"zh-HK":{decimalSeparator:!0},"zh-CN":{decimalSeparator:!0},"zh-TW":{decimalSeparator:!0},hr:{decimalSeparator:!0},cs:{decimalSeparator:!1},da:{decimalSeparator:!1},nl:{decimalSeparator:!1},en:{decimalSeparator:!0},"en-AU":{decimalSeparator:!0},"en-CA":{decimalSeparator:!0},"en-IN":{decimalSeparator:!0},"en-NZ":{decimalSeparator:!0},"en-ZA":{decimalSeparator:!0},"en-US":{decimalSeparator:!0},"en-GB":{decimalSeparator:!0},et:{decimalSeparator:!1},fi:{decimalSeparator:!1},fr:{decimalSeparator:!1},"fr-CA":{decimalSeparator:!1},"fr-FR":{decimalSeparator:!1},"fr-CH":{decimalSeparator:!1},de:{decimalSeparator:!1},"de-AT":{decimalSeparator:!1},"de-DE":{decimalSeparator:!1},"de-LI":{decimalSeparator:!1},"de-CH":{decimalSeparator:!1},el:{decimalSeparator:!1},he:{decimalSeparator:!0},hi:{decimalSeparator:!0},hu:{decimalSeparator:!1},is:{decimalSeparator:!1},it:{decimalSeparator:!1},"it-IT":{decimalSeparator:!1},"it-CH":{decimalSeparator:!1},ja:{decimalSeparator:!0},ko:{decimalSeparator:!0},lv:{decimalSeparator:!1},lt:{decimalSeparator:!1},mk:{decimalSeparator:!1},nb:{decimalSeparator:!1},nn:{decimalSeparator:!1},pl:{decimalSeparator:!1},pt:{decimalSeparator:!1},"pt-BR":{decimalSeparator:!1},"pt-PT":{decimalSeparator:!1},ro:{decimalSeparator:!1},ru:{decimalSeparator:!1},sr:{decimalSeparator:!1},sh:{decimalSeparator:!1},sk:{decimalSeparator:!1},sl:{decimalSeparator:!1},es:{decimalSeparator:!1},"es-AR":{decimalSeparator:!1},"es-CL":{decimalSeparator:!1},"es-CO":{decimalSeparator:!1},"es-CR":{decimalSeparator:!1},"es-HN":{decimalSeparator:!1},"es-MX":{decimalSeparator:!1},"es-PE":{decimalSeparator:!1},"es-ES":{decimalSeparator:!1},"es-US":{decimalSeparator:!1},"es-UY":{decimalSeparator:!1},"es-VE":{decimalSeparator:!1},sv:{decimalSeparator:!1},th:{decimalSeparator:!0},tr:{decimalSeparator:!1},uk:{decimalSeparator:!1},vi:{decimalSeparator:!1}}}e.Events=function(){var e="click",t="touchstart";"onmouseover"in document&&"ontouchstart"in document?(e="click",t="click"):"ontouchstart"in document?(e="touchstart",t="touchstart"):(e="click",t="click");return{onTouchStartOrClick:e,onTouchEndOrClick:"ontouchend"in document?"touchend":"click",onClick:"click",onTouchStartAndClick:t}}(),e.Actions={zoom:"zoom",refresh:"refresh",preference:"preference",add:"add",update:"update",remove:"delete",contact:"contact",addnewrec:"AddNewRecord",addproduct:"AddProduct"},e.EnvConstants={WINDOW_FIND:1110,WINDOW_MLOOKUP:1111,WINDOW_CUSTOMIZE:1112,WINDOW_INFO:1113,TAB_INFO:1113,WINDOW_ACCOUNT:1114,WINDOW_TEMP:111e5,INT32MAXVALUE:2147483647},e.Format=function(t,i,n){var a=function(a){if(isNaN(a)||null===a)return 0;var s=a.toString(),l=s.indexOf(".");if(-1!=l){var o=s.substring(0,l);if(o.length>t)return(o=o.substring(0,t))+s.substring(l,s.Length-l)}else if(0===i&&0===n){if(s>e.EnvConstants.INT32MAXVALUE)return e.EnvConstants.INT32MAXVALUE;if(s<-1*(e.EnvConstants.INT32MAXVALUE+1))return-1*(e.EnvConstants.INT32MAXVALUE+1)}return a};this.GetFormatedValue=function(e){var t=a(e).toString();return 0!=n&&(t.indexOf(".")<=-1?t=parseFloat(t).toFixed(n):t.split(".")[1].length>n?(t=parseFloat(t).toFixed(i),t=parseFloat(t)):(n===i||t.split(".")[1].length<n)&&(t=parseFloat(t).toFixed(n))),t},this.GetConvertedNumber=function(e,t){if(e=this.GetConvertedString(e,t),t){var i=e.split(".");return Number.isSafeInteger(Number(i[0]))?Number(String(e).replace(/[^0-9.-]+/g,"")):Number.MAX_SAFE_INTEGER}i=e.split(",");return Number.isSafeInteger(Number(i[0]))?Number(String(e).replace(/[^0-9,-]+/g,"").replace(/[,]+/g,".")):Number.MAX_SAFE_INTEGER},this.GetConvertedString=function(e,t){var i="";return t?null!=(i=e.match(/[.]+/g))&&i.length>1?"":String(String(e).replace(/[^0-9.-]+/g,"")):null!=(i=e.match(/[,]+/g))&&i.length>1?"":String(String(e).replace(/[^0-9,-]+/g,"").replace(/[,]+/g,","))},this.GetFormatAmount=function(e,t,i){var n=window.navigator.language,a=String(e),s="";if("init"==t?s=a.split("."):"blur"!=t&&"formatOnly"!=t||(s=i?a.split("."):a.split(",")),null!=s[1])var l=s[1].replace(/[\D\s\,_\-]+/g,"");var o=s[0].replace(/[\s\.\,_]+/g,"");return o=o?parseInt(o,10):0,null!=l?"init"==t||"formatOnly"==t?i?o.toLocaleString(n)+"."+l:o.toLocaleString(n)+","+l:i?o+"."+l:o+","+l:"init"==t||"formatOnly"==t?o.toLocaleString(n):o},this.getMinFractionDigit=function(){return n},this.getMaxFractionDigit=function(){return i},this.getLocaleAmount=function(t){var i=this.GetFormatedValue(t).toLocaleString(void 0,{maximumFractionDigits:6});return!e.Env.isDecimalPoint()&&i.contains(".")&&(i=i.replace(".",",")),this.GetFormatAmount(i,"formatOnly",e.Env.isDecimalPoint())},this.dispose=function(){this.GetFormatedValue=null,this.GetConvertedNumber=null,this.GetConvertedString=null,this.GetFormatAmount=null,a=null}},e.Utility={divCoding:t("<div>"),inheritPrototype:function(e,t){var i=Object.create(t.prototype);i.constructor=e,e.prototype=i,e.prototype.$super=t.prototype},getBusyPanel:function(){return t("<div>").html(t("<strong>").html("Loading...."))},getFunctionByName:function(e,t){[].slice.call(arguments).splice(2);for(var i=e.split("."),n=i.pop(),a=0;a<i.length;a++)t=t[i[a]];return t[n]},utf8_to_b64:function(e){return window.btoa(unescape(encodeURIComponent(e)))},b64_to_utf8:function(e){return decodeURIComponent(escape(window.atob(e)))},decodeText:function(e){return this.divCoding.html(e).text()},encodeText:function(e){return this.divCoding.text(e).html()}},e.Utility.encode=e.Utility.utf8_to_b64,e.Utility.decode=e.Utility.b64_to_utf8,e.Utility.Util={getValueOfInt:function(e){return null==e||""==e.toString().trim()||isNaN(e)?0:parseInt(e.toString())},getValueOfDecimal:function(e){return null==e||""==e.toString().trim()||isNaN(e)?0:parseFloat(e.toString())},getValueOfDouble:function(e){return null==e||""==e.toString().trim()||isNaN(e)?0:parseFloat(e.toString())},getValueOfString:function(e){return null==e||""==e.toString().trim()||null==e?"":e.toString()},getValueOfDate:function(e){return null==e||""==e.toString().trim()?0:e?new Date(e):null},getValueOfFormattedDateTime:function(e){if(null==e||""==e.toString().trim())return 0;if(e){var t=new Date(e);return t.getFullYear()+"-"+(1===t.getMonth().toString().length?"0"+(t.getMonth()+1).toString():t.getMonth()+1)+"-"+(1===t.getDate().toString().length?"0"+t.getDate().toString():t.getDate())+"T"+(1===t.getHours().toString().length?"0"+t.getHours().toString():t.getHours())+":"+(1===t.getMinutes().toString().length?"0"+t.getMinutes().toString():t.getMinutes())+":"+(1===t.getSeconds().toString().length?"0"+t.getSeconds().toString():t.getSeconds())}return null},getValueOfBoolean:function(e){return null==e||""==e.toString().trim()?null:"true"==e.toString().toLowerCase()||"Y"==e.toString()},contains:function(e,t){return e.indexOf(t)>-1},isEmpty:function(e){return null==e||0===e.length},cleanMnemonic:function(e){if(null==e||0==e.length)return e;var t=e.indexOf("&");return-1==t||t+1<e.length&&" "!=e.charAt(t+1)&&(e=e.substring(0,t)+e.substring(t+1)),e},scale:function(e){if(isNaN(e))return 0;var t=1.1;t=t.toLocaleString().substring(1,2);var i=e.toString().split(t);return i.length>2||1==i.length?0:i[1].length},getIdentifierDisplayVal:function(e){var t="";return e&&e.indexOf("Images/")>-1?((t=e.replace("^^"+e.substring(e.indexOf("Images/"),e.lastIndexOf("^^")+3),"_")).indexOf("Images/")>-1&&(t=t.replace(t.substring(t.indexOf("Images/"),t.lastIndexOf("^^")+3),"_")),t.endsWith("_")&&(t=t.substring(0,t.length-1)),t.startsWith("_")&&(t=t.substring(1))):t=e,t}},e.Env=function(){var t=1,i=50,n=400,a="904",s="944",l="A04",o="A44";function r(e,t){var i;i=e.split(".");var n=Globalize.format(Number(i[0]),"N",Globalize.cultureSelector),a=""===i[1]?".0":i[1];return e=n.substring(0,n.length-3)+t+a}function d(e){if(null!=e){var t=e.getContext("#AD_Language");if(null!=t&&t.length>0)return t}return"en_US"}function c(){return"en_US"}function p(e){return 1.1.toLocaleString(e).substring(1,2)}return{getWindowNo:function(){return t++},getCtx:function(){return e.context},parseContext:function(e,t,i,n,a,s){if("number"!=typeof i&&(s=a,a=n,n=i,i=0),null==n||0==n.length)return"";for(var l="",o=new String(""),r=n.indexOf("@");-1!=r&&r!=n.lastIndexOf("@");){n.substring(0,r);o+=n.substring(0,r);var d=(n=n.substring(r+1,n.length)).indexOf("@");if(d<0)return"";var c="";if((l=n.substring(0,d)).contains(".")&&(l=l.substring(0,l.indexOf("."))),0==(c=e.getWindowContext(t,i,l,a)).length&&(l.startsWith("#")||l.startsWith("$"))&&(c=e.getContext(l)),0==c.length){if(!s)return"";o+=" NULL "}else o+=c;r=(n=n.substring(d+1,n.length)).indexOf("@")}return o+=n},parseContext2:function(e,t,i,n,a,s){"number"!=typeof i&&(s=a,a=n,n=i,i=0);var l=[];if(null==n||0==n.length)return"";for(var o="",r=(new String(""),n.indexOf("@"));-1!=r&&r!=n.lastIndexOf("@");){n.substring(0,r);n.substring(0,r);var d=(n=n.substring(r+1,n.length)).indexOf("@");if(d<0)return"";var c="";if((o=n.substring(0,d)).contains(".")&&(o=o.substring(0,o.indexOf("."))),0==(c=e.getWindowContext(t,i,o,a)).length&&(o.startsWith("#")||o.startsWith("$"))&&(c=e.getContext(o)),0==c.length){if(!s)return"";o.endsWith("_ID")?l.push({Key:o,Value:-1}):l.push({Key:o,Value:null})," NULL "}else l.push({Key:o,Value:c}),c;r=(n=n.substring(d+1,n.length)).indexOf("@")}return n,l},parseSQLFromRecords:function(e,t){var i=[];if(null==e||0==e.length)return"";for(var n="",a=(new String(""),e.indexOf("@"));-1!=a&&a!=e.lastIndexOf("@");){e.substring(0,a);e.substring(0,a);var s=(e=e.substring(a+1,e.length)).indexOf("@");if(s<0)return"";var l="";if((n=e.substring(0,s)).contains(".")&&(n=n.substring(0,n.indexOf("."))),0==(l=t[n.toLowerCase()]).length&&(n.startsWith("#")||n.startsWith("$"))&&(l=ctx.getContext(n)),0==l.length){if(!ignoreUnparsable)return"";i.push({Key:n,Value:null})," NULL "}else i.push({Key:n,Value:l}),l;a=(e=e.substring(s+1,e.length)).indexOf("@")}return e,i},getWINDOW_PAGE_SIZE:function(){return i},setWINDOW_PAGE_SIZE:function(e){e&&0!=e.toString().length||(e=50),i=e},setScreenHeight:function(e){n=e},getScreenHeight:function(){return n},getPreference:function(e,t,i,n){if(null==e||null==i)throw new IllegalArgumentException("Require Context");var a=null;return n?0==(a=e.getContext("#"+i)).length&&(a=e.getContext("$"+i)):0==(a=e.getContext("P"+t+"|"+i)).length&&(a=e.getContext("P|"+i)),null==a?"":a},getHeader:function(e,t){var i="";return t>0&&(i+=e.getWindowContext(t,"WindowName",!1)+"  "),i},clearWinContext:function(e,i){if(null==e)throw new Error("Require Context");var n,a=[];for(var s in e)s.startsWith(t+"|")&&a.push(s);for(;a.length>0;)e[n=a.pop()]=null,delete e[n],n=null},removeCultCommaDot:function(e,t){if(isNaN(e)||null===e)return"0";var i=e.toString();return i.contains(t)&&(i=i.split(t).join("")),i},numberCultureValueFormat:r,numberDisplay:function(t,i,n){return i=(i=e.Env.removeCultCommaDot(i,t.thousendSeprator)).split(t.decimalSeprator).join("."),i=t.format.GetFormatedValue(i),n===e.DisplayType.Amount?i=Globalize.format(Number(i),"N",Globalize.cultureSelector):n===e.DisplayType.Number&&(i=r(i.toString(),t.decimalSeprator)),i},isBaseLanguage:function(e,t){return"en_US"==("string"!=typeof e?d(e):e)},getAD_Language:d,getBaseAD_Language:c,currentTimeMillis:function(){return Date.now},signum:function(e){return null==e||""==e.toString().trim()||isNaN(e)?0:e>0?1:e<0?-1:0},startBrowser:function(e){window.open(e)},isDecimalPoint:function(e){var t=window.navigator.language;return e&&""!=e&&(t=e),","!=p(t)},getDecimalSeparator:p,ZERO:0,ONE:1,ONEHUNDRED:100,NL:"\r\n",SHOW_CLIENT_ORG:0,SHOW_CLIENT_ONLY:1,SHOW_ORG_ONLY:2,HIDE_CLIENT_ORG:3,NULLString:"NULLValue",approveCol:"IsApproved",getObscureValue:function(e,t){if(t){if(e==a)return t.replace(/[^a-zA-Z0-9\.\-\@]/gi,"").replace(/[0-9](?=[\w\.\-\@]{4})/g,"*");if(e==s){for(var i=(t=t.replace(/[^a-zA-Z0-9\.\-\@\s]/gi,"")).length,n="",r=0;r<i;r++){var d=t[r];r>3&&r<i-4&&!isNaN(d)&&(d="*"),n+=d}return n}if(e==l)return t.replace(/[^a-zA-Z0-9\.\s\@\-]/gi,"").replace(/[a-zA-Z0-9\s\.\@\-](?=[a-zA-Z0-9\s\.\@\-]{4})/g,"*");if(e==o){for(i=(t=t.replace(/[^a-zA-Z0-9\@\.\s\-]/gi,"")).length,n="",r=0;r<i;r++){d=t[r];r>3&&r<i-4&&(d="*"),n+=d}return n}}}}}(),e.AEnv=function(){var i=null,n=0,a=e.Application.contextUrl+"JsonData/JDataSetWithCode",s=function(i,n,s){var l=!!s,o={sql:i,page:1,pageSize:0};n&&(o.param=n);var r=null;return function(e,i,n){var s=null;t.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){s=e,n&&n(e)}))}(o,l,(function(t){r=(new e.DB.DataReader).toJson(t),s&&s(r)})),r};function l(i,n){var a=null,s=0,l=0,o=null;if(t.ajax({type:"Get",async:!1,url:e.Application.contextUrl+"Form/GetZoomWindowID",data:{AD_Table_ID:i},success:function(t){o=(new e.DB.DataReader).toJson(t)}}),o.read()&&(a=o.get(0).toString(),s=e.Utility.Util.getValueOfInt(o.getInt(1)),l=e.Utility.Util.getValueOfInt(o.getInt(2))),o.dispose(),null!=a&&0!=s){if(0!=l){var r=a+"_ID="+n;if(0==(s=e.ZoomTarget.getZoomAD_Window_ID(a,0,r,!0)))return}e.viewManager.startWindow(s,e.Query.prototype.getEqualQuery(a+"_ID",n))}}return{getGridWindow:function(t,i,n){e.dataContext.getWindowJString({windowNo:t,AD_Window_ID:i},n)},getContextPopup:function(i,n){var a=t("<ul class='vis-apanel-rb-ul'>");return void 0!==i[e.Actions.zoom]&&(a.append(t("<li data-action='"+e.Actions.zoom+"' style='opacity:"+(i[e.Actions.zoom]?.7:1)+"'><i data-action='"+e.Actions.zoom+"' class='fa fa-search-plus'></i><span data-action='"+e.Actions.zoom+"'>"+e.Msg.getMsg("Zoom")+"</span></li>")),i[e.Actions.addnewrec]&&a.append(t("<li data-action='"+e.Actions.addnewrec+"' style='opacity:"+(i[e.Actions.zoom]?.7:1)+"'><i data-action='"+e.Actions.addnewrec+"' class='fa fa-plus'></i><span data-action='"+e.Actions.addnewrec+"'>"+e.Msg.getMsg("AddNew")+"</span></li>"))),i[e.Actions.preference]&&a.append(t("<li data-action='"+e.Actions.preference+"'><i data-action='"+e.Actions.preference+"' class='fa fa-cog'></i><span data-action='"+e.Actions.preference+"'>"+e.Msg.getMsg("Preference")+"</span></li>")),i[e.Actions.refresh]&&a.append(t("<li data-action='"+e.Actions.refresh+"'><i data-action='"+e.Actions.refresh+"' class='fa fa-refresh'></i><span data-action='"+e.Actions.refresh+"'>"+e.Msg.getMsg("Requery")+"</span></li>")),i[e.Actions.add]&&a.append(t("<li data-action='"+e.Actions.add+"'><i data-action='"+e.Actions.add+"' class='vis vis-addbp'></i><span data-action='"+e.Actions.add+"'>"+e.Msg.getMsg("Add")+"</span></li>")),i[e.Actions.addproduct]&&a.append(t("<li data-action='"+e.Actions.addproduct+"'><i data-action='"+e.Actions.addproduct+"' class='fa fa-plus'></i><span data-action='"+e.Actions.addproduct+"'>"+e.Msg.getMsg("AddProduct")+"</span></li>")),i[e.Actions.update]&&a.append(t("<li data-action='"+e.Actions.update+"'><i data-action='"+e.Actions.update+"' class='vis vis-updatebp'></i><span data-action='"+e.Actions.update+"'>"+e.Msg.getMsg("Update")+"</span></li>")),i[e.Actions.remove]&&a.append(t("<li data-action='"+e.Actions.remove+"'><i data-action='"+e.Actions.remove+"' class='fa fa-arrow-left'></i><span data-action='"+e.Actions.remove+"'>"+e.Msg.getMsg("Clear")+"</span></li>")),i[e.Actions.contact]&&a.append(t("<li data-action='"+e.Actions.contact+"'><i data-action='"+e.Actions.contact+"' class='fa fa-user'></i><span data-action='"+e.Actions.contact+"'>"+e.Msg.getMsg("Contact")+"</span></li>")),a},getZoomButton:function(e){return t('<button class="vis-controls-txtbtn-table-td2" '+(e?"disabled":"")+' ><i class="vis vis-find" /></button>')},getIsWorkflowProcess:function(){if(null==i){i=!1;var a=645;e.MRole.getIsTableAccess(a,!0)?i=!0:(a=644,e.MRole.getIsTableAccess(a,!0)&&(i=!0)),i&&t.ajax({type:"Get",async:!0,url:e.Application.contextUrl+"Form/GetWorkflowWindowID",data:{AD_Table_ID:a},success:function(e){var t=JSON.parse(e);t&&!isNaN(t)&&(n=parseInt(t)),0==n&&(n=297)}})}return i},startWorkflowProcess:function(t,i){var a=null;0!=t&&0!=i&&((a=new e.Query("AD_WF_Process")).addRestriction("AD_Table_ID",e.Query.prototype.EQUAL,t),a.addRestriction("Record_ID",e.Query.prototype.EQUAL,i),e.viewManager.startWindow(n,a))},zoom:l,wfzoom:function(t,i,n){var a=null,o=0,r=0,d=0,c=[];c[0]=new e.DB.SqlParam("@AD_Table_ID",t),c[1]=new e.DB.SqlParam("@AD_WF_Activity_ID",n);var p=null;if((p=s("VIS_146",c)).read()){if(a=p.get(0).toString(),o=e.Utility.Util.getValueOfInt(p.getInt(1)),r=e.Utility.Util.getValueOfInt(p.getInt(2)),d=e.Utility.Util.getValueOfInt(p.getInt(3)),p.dispose(),null!=a||0!=o||null==d||0==d)if(null==d||0==d){if(0!=r){var u=a+"_ID="+i;if(0==(o=e.ZoomTarget.getZoomAD_Window_ID(a,0,u,!0)))return}e.viewManager.startWindow(o,e.Query.prototype.getEqualQuery(a+"_ID",i))}else{new e.Query;e.viewManager.startWindow(d,e.Query.prototype.getEqualQuery(a+"_ID",i))}}else l(t,i)}}}(),i.prototype.typeList=["","","number","","date","","time","","choice"],i.prototype.modifierList=["","","currency","","percent","","integer"],i.prototype.dateModifierList=["","","short","","medium","","long","","full"],i.prototype.allFormats={currency:"C",decimal:"D",general:"G",number:"N",percent:"P",shortdate:"d",longdate:"D",shorttime:"t",longtime:"T",fulltime:"T",fulldate:"D",mediumdate:"d",mediumtime:"t",choice:""},i.prototype.applyPattern=function(e){if(this.cmpreFormat(e)){for(var t=[],i=new StringBuilder(""),n=0;n<e.length;++n){var a=e[n];"{"==a?(0==i.length()||(t.push(i.toString()),i.clear()),i.append(a)):"}"==a?(i.append(a),t.push(i.toString()),i.clear()):n==e.length?(t.add(i.toString()),i.clear()):i.append(a)}this.pattern=this.parsePattren(t)}else this.pattern=e},i.prototype.parsePattren=function(e){for(var t=new StringBuilder(" "),i=0;i<e.length;i++){var n=e[i];n.startsWith("{")&&this.cmpreFormat(n)?(n=this.getFormat(n.split(",")),t.append(n)):t.append(n)}return t.toString()},i.prototype.getFormat=function(e){var t=new StringBuilder(e[0]),i="";switch(this.findKeyword(e[1],this.typeList)){case 0:break;case 1:case 2:switch(this.findKeyword(e[2].toString(),this.modifierList)){case 0:default:i=this.allFormats.number;break;case 1:case 2:i=this.allFormats.currency;break;case 3:case 4:i=this.allFormats.percent;break;case 5:case 6:i=this.allFormats.decimal}break;case 3:case 4:switch(this.findKeyword(e[2],this.dateModifierList)){case 0:case 1:case 2:i=this.allFormats.shortdate;break;case 3:case 4:i=this.allFormats.mediumdate;break;case 5:case 6:i=this.allFormats.longdate;break;case 7:case 8:i=this.allFormats.fulldate;break;default:i=e[3].ToString()}break;case 5:case 6:switch(this.FindKeyword(e[2].ToString(),this.dateModifierList)){case 0:case 1:case 2:i=this.allFormats.shorttime;break;case 3:case 4:case 5:case 6:case 7:case 8:i=this.allFormats.mediumtime;break;default:i=e[2].ToString()}break;case 7:case 8:try{i=e[3],this.allFormats.choice=e[3].ToString()}catch(e){throw new ArgumentException("Choice Pattern incorrect")}break;default:throw new ArgumentException("unknown format type at ")}return e=null,i="",t.append(i).append("}"),t.toString()},i.prototype.format=function(e){var t=this.pattern;this.pattern=null;for(var i=0;i<e.length;i++){var n=new RegExp("\\{"+i+"\\}","gm");t=t.replace(n,e[i])}return t},i.prototype.cmpreFormat=function(e){return!!(e.contains("number,")||e.contains("date,")||e.contains("time,")||e.contains("custom,"))},i.prototype.findKeyword=function(e,t){for(var i=0;i<t.length;i++)if(e.equals(t[i]))return i;return-1},e.DB={QUOTE:"'",getDBDateFormat:function(e,t,i){var n="";i||e.setMinutes(-e.getTimezoneOffset());var a=(n=e.toISOString()).split("T");return n=a[0],t&&(n+=" "+a[1].substring(0,a[1].length-5)),n},to_date:function(e,t){e&&e.toString().length>0?e instanceof Date?time=e:time=new Date(e):time=null,"Invaild Date"==time.toString()&&(time=null);var i="";return null==time?t?"TRUNC(SysDate)":"SysDate":(i+="TO_DATE('",time,t?(i+=this.getDBDateFormat(time,!1,!1),i+="','YYYY-MM-DD')"):(i+=this.getDBDateFormat(time,!0,!0),i+="','YYYY-MM-DD HH24:MI:SS')"),i.toString())},to_char:function(t,i,n){var a="TRIM(TO_CHAR(";return a=a.concat(t),e.DisplayType.IsNumeric(i)?a=i==e.DisplayType.Amount?a.concat(",'9G999G999G999G990D00'"):a.concat(",'TM9'"):e.DisplayType.IsDate(i)&&(a=a.concat(",'").concat("yyyy-MM-dd").concat("'")),(a=a.concat("))")).toString()},to_string:function(e,t){if(null==e&&0==e.length)return"NULL";null!=t&&(t=0);var i=e;0!=t&&i.length>t&&(i=e.substring(0,t));var n=new StringBuilder;n.append(this.QUOTE);for(var a=0;a<i.length;a++){var s=i.charAt(a);s==this.QUOTE?n.append("''"):n.append(s)}return n.append(this.QUOTE),i=n.toString(),n.clear(),i}},n.prototype.setIsDate=function(e){this.isDate=e},n.prototype.setIsByteArray=function(e){this.isByteArray=e},a.prototype.toJson=function(i){var n=i;"string"==typeof i&&(n=JSON.parse(i)),n=t.isArray(n)?n:[n];for(var a=0;a<n.length;a++){var s=new e.DB.DataTable;s.toJson(n[a]),this.tables.push(s)}return n=null,this},a.prototype.getTable=function(e){return e>-1&&e<this.tables.length?this.tables[e]:null},a.prototype.getTables=function(){return this.tables},a.prototype.dispose=function(){for(var e=this.tables.length;e>0;e--)this.tables.pop().dispose();this.tables.length=0,this.tables=null},s.prototype.toJson=function(t){if(t){if(this.totalRecord=t.records,this.totalPage=t.total,this.page=t.page,t.columns){for(var i=0;i<t.columns.length;i++)this.columnsName[i]=t.columns[i].name;for(var n=0;n<t.rows.length;n++)this.rows.push(new e.DB.DataRow(t.rows[n],this));this.columns=t.columns}this.count=this.rows.count}t=null},s.prototype.getRowCount=function(){return this.rows.length},s.prototype.getColumnCount=function(){return this.columns.length},s.prototype.getRow=function(e){return e>-1&&e<this.rows.length?this.rows[e]:null},s.prototype.getRows=function(){return this.rows},s.prototype.getColumnsName=function(){return this.columnsName},s.prototype.dispose=function(){for(this.count=0,this.totalPage=0,this.page=1,this.columns.length=0,this.columns=null;this.rows.length>0;)this.rows.pop().dispose();this.rows.length=0,this.rows=null,this.totalRecord=0},l.prototype.getCell=function(e){var t=-1,i="";isNaN(e)?(e=e.toLowerCase(),t=this.parent.columnsName.indexOf(e),i=e):(t=e,i=this.parent.columnsName[t]);this.parent.columns[t].type;return this.cells[i]},l.prototype.getJSCells=function(){return this.cells},l.prototype.dispose=function(){this.cells.length=0,this.cells=null,this.id=null,this.parent=null},o.prototype.toJson=function(i){var n=JSON.parse(i);n=t.isArray(n)?n:[n];for(var a=0;a<n.length;a++){var s=new e.DB.DataTable;s.toJson(n[a]),this.tables.push(s),0===a&&(this.curTable=this.tables[a])}return n=null,this},o.prototype.read=function(){return!!this.curTable&&!(++this.rowIndex>=this.curTable.getRowCount())},o.prototype.getCell=function(e){return this.curTable.getRow(this.rowIndex).getCell(e)},o.prototype.get=function(e){return this.curTable.getRow(this.rowIndex).getCell(e)},o.prototype.getString=function(e){var t=this.curTable.getRow(this.rowIndex).getCell(e);return null==t?"":t.toString()},o.prototype.getInt=function(e){var t=this.curTable.getRow(this.rowIndex).getCell(e);return null==t?0:parseInt(t)},o.prototype.getDecimal=function(e){var t=this.curTable.getRow(this.rowIndex).getCell(e);return null==t?0:parseFloat(t)},o.prototype.getDateTime=function(e){return this.curTable.getRow(this.rowIndex).getCell(e)},o.prototype.setTableIndex=function(e){this.rowIndex=0,this.curTable=this.tables[e]},o.prototype.close=function(){},o.prototype.dispose=function(){this.curTable=null;for(var e=this.tables.length;e>0;e--)this.tables.pop().dispose();this.tables.length=0,this.tables=null,this.rowIndex=null},r.prototype.max=function(e,t){return null==e?t:null==t||e>t?e:t},d.prototype.isDecimalSeparatorDot=function(e){return e&&null!=this.List[e]?this.List[e].decimalSeparator:null},e.DB.DataSet=a,e.DB.DataTable=s,e.DB.DataRow=l,e.DB.SqlParam=n,e.DB.DataReader=o,e.MessageFormat=i,e.TimeUtil=r,e.CultureSeparator=d}(VIS,jQuery)},1511:()=>{!function(e){var t=e.desktopMgr,i=t.getMainConatiner();function n(t){this.frame=new e.AWindow,this.frame.setName("Form"),this.onOpened=null,this.onClose=null;var i=null;this.contentDispose=null,this.error=!1,this.windowNo=t||e.Env.getWindowNo(),this.hideH=!1;var n=this;this.setContent=function(t){t.getRoot&&t.getRoot()||(e.Dialog.error("Error",!0,"class must define root element  and implement getRoot function"),t.dispose(),this.error=!0),t.sizeChanged||(t.sizeChanged=function(){}),t.refresh||(t.refresh=function(){}),t.dispose&&(this.contentDispose=t.dispose,t.dispose=function(){n.dispose()}),i=t,this.frame.setCFrameContent(t,this.windowNo),this.hideH&&this.frame.hideHeader(this.hideH)},this.dispose=function(){this.disposing||(this.disposing=!0,this.contentDispose.call(i),this.frame&&this.frame.dispose(),this.frame=null,this.onOpened=null,this.onClose=null,i=null,this.contentDispose=null,n=null)}}n.prototype.setTitle=function(e){this.frame.setTitle(e)},n.prototype.getTitle=function(e){return this.frame.getTitle()},n.prototype.setName=function(e){this.frame.setName(e)},n.prototype.show=function(){this.error?this.dispose():(e.viewManager.startCFrame(this.frame),this.onOpened&&this.onOpened())},n.prototype.hideHeader=function(e){this.hideH=e,this.frame.cPanel&&this.frame.hideHeader(e)},e.viewManager=function(){var n="P",a="R",s="W",l="X",o="!",r=[],d={},c=[],p=!1,u=null,g=null,h=null,v=!1,f=0,m=null;return h=t.getMenuDiv(),$(document).on("keydown",x).on("keyup",A),u=t.getNavSection(),(g=u.find(".vis-app-action-nav-inner")).on("click",N),{startAction:y,restoreActions:function(t){try{historyMgr.updateHistory("#");var i=[];if(-1!=t.indexOf("&")&&(i=(t=t.split("&"))[1].split(","),t=t[0]),(t=e.Utility.decode(t)).length>0){v=!0;for(var r=t.split(o),d=0,c=r.length;d<c;d++)if(r[d].length>0){var p=r[d],u=p.substring(0,1),g=p.substring(2);if(l===u){if(!e.MRole.getFormAccess(g)){console.log("No Form Access"),i&&i.length>0&&i.shift();continue}i&&i.length>0&&(g+="&"+i.shift())}else if(n===u||a===u){if(!e.MRole.getProcessAccess(g)){console.log("No Process Access");continue}}else if(s===u){if(!e.MRole.getWindowAccess(g)){console.log("No Window Access"),i&&i.length>0&&i.shift();continue}i&&i.length>0&&(g+="&"+i.shift())}y(u,g)}}}catch(e){historyMgr.updateHistory("#"),console.log(e)}},resize:function(e){d[e]&&(m=d[e].refresh())},sizeChanged:function(e,t){for(var i in C(),d)d[i].sizeChanged(e,t)},startWindow:b,startForm:_,startCFrame:function(e){e.onClosed=w,e.show(i),I(e.getId(),"fa fa-list-alt",e.getName(),null),S(e)},startActionInNewTab:function(t,i){if(t&&i){var n=t+"="+i;return n=D(n),void window.open(e.Application.contextUrl+"#"+n)}alert("improper data")},closeFrame:function(e){return d[e].dispose()}};function y(t,o){s===t?b(o):l===t?_(o):n!==t&&a!==t||function(t,n){var a=new e.AWindow;a.initProcess(t,I,n,!0)&&(a.onClosed=w,a.show(i),S(a))}(o,t)}function I(i,n,a,s){if(v)!function(){if(++f==Object.keys(d).length)for(var e in v=!1,d)I(d[e].id,d[e].img,d[e].name,d[e].hid)}();else{var l="fa fa-window-maximize";n&&(l=n),t.addTaskBarItem(i,l,a),s&&i.slice(i.indexOf("_")+1)!=e.MRole.getHomePage()&&(r.push(s),historyMgr.updateHistory(D(r.join(o))))}}function D(t){return t=e.Utility.encode(t)}function w(i,n,a,s){if(t.unRegisterView(i),a){var l=r.indexOf(a);l>-1&&r.splice(l,1),historyMgr.updateHistory(D(r.join(o)))}var p=d[i];return d[i]=null,delete d[i],m=null,!s||!function(t){if(!e.Ini.getIsCacheWindow())return!1;for(var i=0;i<c.length;i++){if(c[i].getAD_Window_ID()==t.getAD_Window_ID())return!0}if(0!=t.getAD_Window_ID())try{return c.push(t),c.length>10&&c.splice(0,1),!0}catch(e){return!1}return!1}(p)}function b(t,n){var a=null;-1!=t.toString().indexOf("&")&&(a=t.split("&")[1],t=t.split("&")[0]);var l=function(e){for(var t=0;t<c.length;t++){var i=c[t];if(i.getAD_Window_ID()==e)return c.splice(t,1),i}return}(t);return l&&!l.hasError?(l.refreshData(),l.show(i,I),S(l),C(),l):((l=new e.AWindow).initWindow(t,n,I,s,a)&&(l.onClosed=w,l.show(i),S(l),C()),l)}function C(){var e=".w2ui-reset table{font-family: var(--v-c-font-family);";Math.round(100*window.devicePixelRatio)>=100?e+="font-size: 0.85rem !important;}":e+="font-size: 1rem !important;}",this.styleTag?(this.styleTag.remove(),$(".vis-gc-vtable").removeClass("w2ui-reset"),$(".vis-gc-vtable").addClass("w2ui-reset")):$(".vis-gc-vtable").addClass("w2ui-reset"),this.styleTag=document.createElement("style"),this.styleTag.type="text/css",this.styleTag.innerHTML=e,$($("head")[0]).append(this.styleTag)}function _(t,n){-1!=t.toString().indexOf("&")&&(n=t.split("&")[1],t=t.split("&")[0]);var a=new e.AWindow;e.MRole.getIsDisableMenu()&&a.hideCloseIcon(!0),a.initForm(t,I,l,n)&&(a.onClosed=w,a.show(i),S(a))}function S(e){t.registerView(e.getId(),e.getRootLayout()),d[e.getId()]=e}function x(i){if($(".ui-widget-overlay.ui-front").length>0&&(i.altKey&&i.ctrlKey||i.altKey))return!1;if(i.altKey&&88==i.keyCode)m.dispose();else if(i.altKey&&77==i.keyCode)t.openMenu();else if("none"!=h.css("display")&&27==i.keyCode)t.closeMenu();else if(i.altKey&&76==i.keyCode)e.ADialog.confirm("LogOut?",!0,"","Confirm",(function(e){e&&$("#logoutForm").trigger("submit")}));else if(!i.altKey&&(i.ctrlKey||i.ctrlKey&&i.shiftKey)&&32==i.keyCode){if(!d||Object.keys(d).length<=0)return;i.ctrlKey&&i.shiftKey?T(!0,!1):T(!0,!0),i.preventDefault(),i.stopPropagation()}else i.altKey&&i.ctrlKey&&(37==i.keyCode||39==i.keyCode)?(m.navigateThroghtShortcut(39==i.keyCode),i.preventDefault(),i.stopPropagation()):m&&"function"==typeof m.keyDown&&m.keyDown.call(m,i)}function A(e){e.ctrlKey||(T(!1),p=!1)}function T(e,t){if(e){if(u.css("display","flex"),!p){var i=[];$.each(d,(function(e,t){t.img&&""!=t.img||(t.img="fa fa-list-alt");var n=t.img;i.push("<div tabindex="+e+' data-wid="'+t.id+'" class="'),m.id==t.id&&i.push("vis-current-nav-window "),i.push('vis-nav-window">'),i.push("<span>"+t.name+'</span><div class="vis-nav-content-wrap">'),n.indexOf(".")>-1?(n=n.replace("Thumb16x16","Thumb140x120"),i.push('<img data-wid="'+t.id+'" class="vis-nav-window-img" src="'+n+'" alt="'+t.name+'"> </img>')):i.push('<i data-wid="'+t.id+'" class="'+n+'"></i>'),i.push("</div></div>")})),g.append(i.join(" ")),p=!0}if(t)(!(n=g.find(".vis-current-nav-window").next())||n.length<=0)&&(n=g.children().first());else(!(n=g.find(".vis-current-nav-window").prev())||n.length<=0)&&(n=g.children().last());g.find(".vis-current-nav-window").removeClass("vis-current-nav-window"),n.addClass("vis-current-nav-window").focus()}else{var n;p&&V(n=g.find(".vis-current-nav-window"))}}function V(e){m.id!=e.data("wid")&&(t.toggleContainer(e.data("wid")),t.activateTaskBarItemUsingID(e)),u.css("display","none"),g.empty(),p=!1}function N(e){var t=$(e.target);(t.hasClass("vis-nav-window")||t.hasClass("vis-nav-window-img"))&&V(t)}}(),e.CFrame=n}(VIS)},3338:()=>{!function(e,t){e.WForm=function(i,n,a,s){var l,o,r,d,c=e.Env.getCtx(),p=e.Logging.VLogger.getVLogger("VIS.AForm"),u=e.Env.getWindowNo(),g=this;l=t("<div class='vis-height-full'>"),o=t("<div class='vis-apanel-busy'>"),r=t("<div class='vis-height-full'>"),l.append(r).append(o),d=new e.ChildDialog,e.dataContext.getFormDataString({AD_Form_ID:n},(function(i){if(null!=i.error)return e.ADialog.error(i.error),g.dispose(),void(g=null);var n=t.parseJSON(i.result);if(n.IsError)return e.ADialog.error(n.Message),g.dispose(),void(g=null);d.setTitle(n.DisplayName),openForm(n,g,s),n=null})),this.getWindowNo=function(){return u},this.getAD_Table_ID=function(){return a.getAD_Table_ID()},this.getAD_Window_ID=function(){return a.getAD_Window_ID()},this.getRecord_ID=function(){return a.getRecord_ID()},this.getContentGrid=function(){return r},this.close=function(){d&&d.close()},this.disposeComponent=function(){l.remove(),l=null,r.remove(),r=null,this.getContentGrid=null,g=null},openForm=function(t,n,s){if(t.IsReport)return e.ADialog.info("Form Report is not supported"),!1;var l;l=t.Prefix+t.ClassName,console.log(l),p.info("Form Name= "+t.Name+", Class="+l),c.setWindowContext(u,"WindowName",t.DisplayName);try{var o=new(e.Utility.getFunctionByName(l,window))(u);o.init(s,g),o.setRecordID&&o.setRecordID(a.getRecord_ID()),function(e){d.setContent(r),e.setHeight?d.setHeight(e.setHeight()):d.setHeight(i);e.setWidth?d.setWidth(e.setWidth()):d.setWidth(window.innerWidth-100);d.setModal(!0),d.onClose=function(){e.dispose&&e.dispose(),d.dispose&&d.dispose(),a.dataRefresh(),g.disposeComponent&&g.disposeComponent()},d.show(),d.hidebuttons()}(o)}catch(i){return p.log(e.Logging.Level.WARNING,"Class="+l+", AD_Form Name="+t.Name,i),!1}return!0}}}(VIS,jQuery)},9659:()=>{!function(e,t){e.changeUserImage=function(){var i=t("#vis-textStatus"),n=t("#vis-img-OKStatus"),a=t("#vis-img-CancelStatus"),s=t("#vis-labelStatus");function l(){i=t("#vis-textStatus"),t.ajax({url:e.Application.contextUrl+"Home/SaveStatus",dataType:"json",type:"POST",async:!1,data:{status:i.val()},success:function(e){JSON.parse(e).length>0?(i.css("visibility","hidden"),a.css("visibility","hidden"),n.css("visibility","hidden"),s.css("visibility","visible"),s.text(JSON.parse(e))):(i.css("visibility","visible"),a.css("visibility","hidden"),n.css("visibility","hidden"),s.css("visibility","visible"),s.text(JSON.parse(e)))}})}t("#vis-file-input").change((function(){var i=document.getElementById("vis-file-input").files[0];if(null!=i){var n=i.type.split("/").pop().toLowerCase();if("jpeg"!=n&&"jpg"!=n&&"png"!=n&&"ico"!=n&&"webp"!=n&&"svg"!=n)return e.ADialog.info("SelectImageOnly"),!1;var a=new XMLHttpRequest,s=new FormData;s.append("file",i),a.open("POST",e.Application.contextUrl+"Home/SaveImageAsByte",!0),a.send(s),a.addEventListener("load",(function(e){var i=e.target.response,n=JSON.parse(i),a=JSON.parse(n);t(".vis-userAvatar-Container").find("i").remove().find("img").remove(),t(".vis-userAvatar-Container").find("img").remove(),t(".vis-userAvatar-Container").append('<img id="imgUsrImage" alt="User avatar" class="vis-userAvatar-Large"></img>'),t("#imgUsrImage").attr("src","data:image/jpg;base64,"+a)}),!1)}})),t("#vis-file-input-remove").on("click",(function(){t(".vis-userAvatar-Container").find("img").length>0&&e.ADialog.confirm("ConfirmDeleteImage",!0,"","Confirm",(function(i){i&&t.ajax({url:e.Application.contextUrl+"Home/DeleteUserImage",success:function(e){t(".vis-userAvatar-Container").find("img").remove(),t(".vis-userAvatar-Container").append('<i id="imgUsrImage" class="vis-userAvatar-Large vis vis-user"></i>'),t(".vis-app-user-img-wrap").find("img").remove(),document.getElementById("vis-file-input").value=null},error:function(e){}})}))})),n.on("click",(function(){l()})),a.on("click",(function(){i.css("visibility","hidden"),a.css("visibility","hidden"),n.css("visibility","hidden"),s.css("visibility","visible")})),i.on("focus",(function(){a.css("visibility","visible"),n.css("visibility","visible")})),i.on("keypress",(function(e){13==(e.keyCode||e.which)&&l()})),i.on("blur",(function(){})),s.on("click",(function(){s.css("visibility","hidden"),i.css("visibility","visible"),i.val(s.text()),i.focus()}))}}(VIS,jQuery)},5028:()=>{!function(e,t){e.favMgr=function(){var i,n,a;return{init:function(o){i=o.find("#vis_favScroll"),t.ajax({url:e.Application.contextUrl+"Home/GetFavouriteNode",dataType:"json",error:function(){alert(e.Msg.getMsg("ERRORGetFavouriteNode"))},success:function(e){if(i.empty(),e.result)for(var t=0,a=e.result.length;t<a;t++)s(e.result[t]);l(n.find("li").length),i.append(n)}}),a=t("#userFav-Tab"),(n=t('<ul class="vis-userFavourites-ListMenu">')).on("click",(function(i){var a,s=t(i.target);if("action"==s.data("btn"))e.viewManager.startAction(s.data("action"),s.data("id"));else if("zoom"==s.data("btn"))e.viewManager.startActionInNewTab(s.data("action"),s.data("id"));else if("remove"==s.data("btn")){a=s.data("id"),e.FavouriteHelper.removeFavourite(a),t.ajax({url:e.Application.contextUrl+"Home/RemoveNodeFavourite/?nodeID="+a,dataType:"json"});var o=t(s).parent().parent();o.empty(),o.remove(),l(n.find("li").length)}}))},addFavourite:function(e){s(e),l(n.find("li").length)},removeFavourite:function(e){if(null==n)return;for(var i=n.find("li"),a=null,s=0,o=i.length;s<o;s++)(a=t(i[s])).data("nodeid")===e&&a.remove();i=a=null,l(n.find("li").length)}};function s(i){if(null!=n){var a=t('<li data-nodeid="'+i.NodeID+'" >'),s=0;"W"==i.Action?s=i.WindowID:"X"==i.Action?s=i.FormID:("P"==i.Action||"R"==i.Action)&&(s=i.ProcessID);var l=t('<a href="#" data-id="'+s+'" data-action="'+i.Action+'" data-nodeid="'+i.NodeID+'" data-btn="action" style="overflow: auto;" >'),o=t('<div class="vis-favboxtopico">'),r=t("<a href='javascript:void(0)' data-id='"+i.NodeID+"'  data-btn='remove' class='vis vis-removefav'>");o.append(r);var d=t("<a href='javascript:void(0)' data-id='"+s+"' data-action='"+i.Action+"' data-btn='zoom' class='vis vis-new-tab'>");o.append(d),a.append(o),a.append(l);var c=i.Name;if(c.length>27){c=c.substr(0,27),l.append(c);var p=t("<a href='#' class='VIS_Pref_tooltip' style='display: inline-block;'>").append("..."),u=t("<span style='width: inherit;'>");u.append(t("<img class='VIS_Pref_callout'>").attr("src",e.Application.contextUrl+"Areas/VIS/Images/ccc.png").append("ToolTip Text")),u.append(t("<label class='VIS_Pref_Label_Font'>").append(i.Name)),p.append(u),l.append(p)}else l.append(i.Name);n.append(a)}}function l(t){a.empty(),a.html("<span><i class='vis vis-favourite'></i></span><span class='favouriteTabLabel-Large'>"+e.Msg.getMsg("Favourites")+" - </span><strong>"+t+"</strong>")}}()}(VIS,jQuery)},6288:()=>{!function(e,t){e.HomeMgr=function(){"use strict";var i=null,n=null,a=!1;return{initHome:function(s){t("#vis_userDate").show(),i=s;var l=t('<div class="vis-add-widgetContainer" style="display:none"><button class="vis-add-widgetButton">+</button><p>'+e.Msg.getMsg("VISEditHomeMsg")+"</p></div>"),o=t('<div class="vis-widget-container" style="--rowheight:'+(i.width()-25)/9+'px">');function r(){var e=(i.find(".vis-home-leftPanel").width()-25)/9;t(window).width()<=500?e=(i.find(".vis-home-leftPanel").width()-25)/3:t(window).width()<=960&&(e=(i.find(".vis-home-leftPanel").width()-25)/6),i.find(".vis-widget-container").attr("style","--rowheight:"+e+"px")}function d(){var e=t(window).width();t(".scrollerHorizontal").width(e),r()}function c(){var n=i.find(".vis-home-leftPanel"),s=i.find(".vis-home-rightPanel");l.add(t("#vis_editHome")).on("click",(function(){n.animate({width:"70%"},300),i.find(".vis-add-widgetContainer").hide("slide",{direction:"left"},300),s.show("slide",{direction:"right"},200),i.find(".vis-home-leftPanel").sortable("enable"),a=!0,i.find(".vis-widgetDelete").show(),t("#vis_editHome").hide(),setTimeout((function(){r()}),300)})),i.find("#btnCloseWidget").click((function(){var l;n.animate({width:"100%"},300),i.find(".vis-widget-container .vis-widget-item").length>0?i.find(".vis-add-widgetContainer").hide():i.find(".vis-add-widgetContainer").show(),s.hide("slide",{direction:"left"},300),i.find(".vis-home-leftPanel").sortable("disable"),i.find(".vis-widgetDelete").hide(),t("#vis_editHome").show(),a=!1,l=[],t(".vis-widget-item").each((function(e){l.push({SRNO:e+1,WidgetSizeID:t(this).data("ws")})})),l.length>0&&e.dataContext.getJSONData(e.Application.contextUrl+"Home/SaveDashboard",l,(function(e){})),setTimeout((function(){r()}),300)})),n.on("click",".vis-widgetDelete",(function(i){var n=t(this).closest(".vis-widget-item");if(n.data("wid")){var a={id:n.data("wid")};e.dataContext.getJSONData(e.Application.contextUrl+"Home/DeleteWidgetFromHome",a,(function(e){}))}n.slideUp((function(){t(this).remove()}))}))}function p(){i.find(".vis-widgetDrag-item").draggable({helper:"clone",start:function(e,t){t.helper.position()},revert:"invalid"}),i.find(".vis-home-leftPanel").droppable({accept:".vis-widgetDrag-item",drop:function(e,i){var a=t(i.helper).data("idx");u(n[a])}}),function(e){e.sortable({items:".vis-widget-item",disabled:!0,sort:function(e,i){i.helper.position(),t(i.placeholder).addClass("ui-sortable-placeholder")},start:function(e,i){i.helper.position(),t(i.helper).addClass("ui-sortable-helper")},stop:function(e,i){t(i.helper).removeClass("ui-sortable-helper")}})}(i.find(".vis-home-leftPanel"))}function u(i){var n="hsl("+Math.floor(360*Math.random())+", 100%, "+(Math.floor(16*Math.random())+75)+"%)",s=new e.AForm;s.openWidget(i.ClassName,99999);var l=s.getRoot();l.addClass("vis-widget-item"),l.css("background-color",n),l.attr("data-ws",i.WidgetSizeID),l.attr("data-wid",i.ID),s.addChangeListener(e.HomeMgr),l.css({gridRow:"span "+i.Rows,gridColumn:"span "+i.Cols,display:"none"});var r=t('<i class="fa fa-trash-o vis-widgetDelete" aria-hidden="true" ></i>');a?r.show():r.hide(),l.append(r),o.append(l),l.slideDown("slow")}i.load(e.Application.contextUrl+"Home/Home",(function(){d(),function(){o.append(l),i.find(".vis-home-leftPanel").append(o);var a=e.Application.contextUrl+"Home/GetWidgets";e.dataContext.getJSONData(a,null,(function(e){if(e){n=e,i.find(".vis-widget-body").empty();for(var a=0;a<e.length;a++){0===i.find(".vis-widget-body").find('div:contains("'+e[a].ModuleName+'")').length&&(i.find(".vis-widget-body").append(t('<div class="vis-main-widget-heading">'+e[a].ModuleName+"</div>")),i.find(".vis-widget-body").append(t('<div class="vis-widgetDrag-container">')));var s=t('<div class="vis-widgetDrag-item" data-idx="'+a+'"><img class="vis-widgetImg" src="'+e[a].Img+'" /><div class="vis-widgetSize">'+e[a].DisplayName+'<span style="display:block">'+e[a].Rows+"X"+e[a].Cols+"<span></div></div>");i.find(".vis-widgetDrag-container:last").append(s)}p()}})),a=e.Application.contextUrl+"Home/GetUserWidgets",e.dataContext.getJSONData(a,null,(function(e){if(e&&e.length>0){t(".vis-add-widgetContainer").hide();for(var i=0;i<e.length;i++)u(e[i]);p()}else t(".vis-add-widgetContainer").show()}))}(),c(),t(window).resize(d)}))}}}(),e.HomeMgr.widgetFirevalueChanged=function(e){}}(VIS,jQuery)},8225:()=>{!function(e,t){function i(i){var n=t("<div>"),a=t('<div style="width:auto;z-index:1">').html('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),s=e.Logging.VLogger.getVLogger("SettingDialog");n.append(a);var l=null,o=null;this.show=function(){(l=new e.ChildDialog).setWidth(540),l.setHeight(400),l.setTitle(e.Msg.getMsg("Setting")),l.setContent(n),l.show()},this.disposeComponent=function(){a.off("click"),a.remove(),o&&(o.length=0),o=null,this.show=null,n=null,l&&l.dispose()},e.dataContext.getJSONData(e.Application.contextUrl+"Home/GetSettingItems",{AD_Shortcut_ID:i},(function(i){o=i;var n=null,r=['<ul class="vis-userLinks-ListMenu">'];if(i)for(var d=0;d<i.length;d++)n=i[d],r.push('<li data-index="'+d+'" ><a data-index="'+d+'" href="javascript:void(0)">'),n.HasImage?!n.IsImageByteArray&&n.IconUrl.indexOf(".")<0?r.push('<i data-index="'+d+'" class="'+n.IconUrl+'"'):(r.push('<img data-index="'+d+'"  src="'),n.IsImageByteArray?r.push("data:image/*;base64,"+n.IconBytes):r.push(e.Application.contextUrl+n.IconUrl)):r.push('<i data-index="'+d+'" class="vis vis-shortcut"'),r.push('" />'),r.push(n.ShortcutName+"</a></li>");r.push("</ul>"),a.empty(),a.html(r.join(" ")),a.on("click",(function(i){var n=t(i.target).data("index");if((n||"0"==n)&&n<o.length){var a=o[n];if(a.HasChild)e.Msg.getMsg("settingDialog");else if(a.Url||a.Url.length>0)e.Env.startBrowser(a.Url);else if(a.SpecialAction&&a.SpecialAction.length>0){var r=a.SpecialAction;a.ActionName;try{var d=new(e.Utility.getFunctionByName(r,window));d.show(),d=null}catch(i){return s.log(e.Logging.Level.WARNING,"Class="+r+", Action Class Name="+r,i),!1}}else{if(null==a.Action||a.Action.length<=0||a.ActionID<1)return;e.viewManager.startAction(a.Action,a.ActionID)}l.close()}}))}))}i.prototype.dispose=function(){this.disposeComponent()},e.shortcutMgr=function(){var n,a=null,s=e.Logging.VLogger.getVLogger("ShortCut"),l=t("#userLinks-Tab");return{init:function(o,r){n=o.find("#vis_linkScroll"),e.favMgr.init(r),e.dataContext.getJSONData(e.Application.contextUrl+"Home/GetShortcutItems",null,(function(i){a=i;var s,o=null,r=['<ul class="vis-userLinks-ListMenu">'];if(i)for(var d=0;d<i.length;d++)o=i[d],r.push('<li data-index="'+d+'" ><a data-index="'+d+'" href="javascript:void(0)">'),o.HasImage?!o.IsImageByteArray&&o.IconUrl.indexOf(".")<0?r.push('<i data-index="'+d+'" class="'+o.IconUrl+'"'):(r.push('<img data-index="'+d+'"  src="'),o.IsImageByteArray?r.push("data:image/*;base64,"+o.IconBytes):r.push(e.Application.contextUrl+o.IconUrl)):r.push('<i data-index="'+d+'" class="vis vis-shortcut"'),r.push('" />'),r.push(o.ShortcutName+"</a></li>");r.push("</ul>"),n.empty(),n.html(r.join(" ")),r=[],s=i.length,l.empty(),l.append(t("<span><i class='fa fa-link' aria-hidden='true' style='transform: rotate(90deg);'></i></span>")),l.append(e.Msg.getMsg("Links")+" - "),l.append(t("<strong>").append(s))})),n.on("click",(function(n){var l=t(n.target).data("index");if((l||"0"==l)&&l<a.length){var o=a[l];if(o.HasChild){var r=new i(o.KeyID);r.show(),r=null}else if(o.Url||o.Url.length>0)e.Env.startBrowser(o.Url);else if(o.SpecialAction&&o.SpecialAction.length>0){var d=o.SpecialAction;o.ActionName;try{var c=new(e.Utility.getFunctionByName(d,window));c.show(),c=null}catch(n){return s.log(e.Logging.Level.WARNING,"Class="+d+", Action Class Name="+d,n),!1}}else{if(null==o.Action||o.Action.length<=0||o.ActionID<1)return;e.viewManager.startAction(o.Action,o.ActionID)}}}))}}}()}(VIS,jQuery)},5162:()=>{!function(e,t){e.UserSession=function(){var i=!1,n=t("<div class='vis-chatOverlay'></div>");t("body").append(n);var a=null;n.append(a);var s=null,l=null;function o(t){var i={sessionid:e.context.getContext("#AD_Session_ID"),txt:l.val()};e.dataContext.postJSONData(e.Application.contextUrl+"Message/PushMessage",i,(function(e){l.val(""),l.focus()}))}function r(e,t){a.append('<li key="'+e+'"><div class="vis-app-user-img-wrap"><i class="fa fa-user"></i><img src="" alt="profile image"></div><p>'+t.Name+'</p><span class="vis-chatLoginStatus"></span> </li>')}return n.append(t('<ul class="list-unstyled m-0"></ul><div class="d-flex vis-chatBoxInputWrap"><textarea placeholder="broadcast message(beta)"></textarea><button><i class="fa fa-paper-plane"></i></button></div>')),a=n.find("ul"),s=n.find("button"),(l=n.find("textarea")).on("keydown",(function(e){var t=e&&e.which?e.which:e.keyCode;13==t&&(e.preventDefault(),o(e)),27==t&&l.val("")})),s.on("click",o),{show:function(){i?(n.css("visibility","hidden"),i=!1):(a.empty(),n.css("visibility","visible"),e.dataContext.getJSONData(e.Application.contextUrl+"Message/GetSessionList",null,(function(e){if(null!==e)for(var t in e)r(t,e[t])})),i=!0)},onmessage:function(e){"LOGIN"===e.Event?(data=JSON.parse(e.Message),r(data.Key,data)):"LOGOFF"===e.Event&&(data=JSON.parse(e.Message),function(e){a.find("li[key='"+e+"']").remove()}(data.Key))}}}(),e.sseManager.register(e.UserSession)}(VIS,jQuery)},8111:()=>{VIS=window.VIS||{},function(e,t){var i=e.Utility.Util;function n(){e.CalloutEngine.call(this,"calloutColumn")}function a(){e.CalloutEngine.call(this,"VIS.CalloutCheckDocAction")}function s(){e.CalloutEngine.call(this,"VIS.CalloutGetTableID")}e.Utility.inheritPrototype(n,e.CalloutEngine),n.prototype.setDBColumnName=function(i,n,a,s,l,o){if(!this.isCalloutActive()&&null!=l&&0!=l){this.setCalloutActive(!0);var r=a;return t.ajax({url:e.Application.contextUrl+"VIS/CalloutColumn/GetDBColunName",data:{AD_Element_ID:l},success:function(e){e&&r.setValue("ColumnName",e)},error:function(e){this.log.severe(e)}}),this.setCalloutActive(!1),a=l=null,""}},n.prototype.checkColumnLength=function(t,i,n,a,s,l){if(!this.isCalloutActive()&&null!=s&&0!=s)return this.setCalloutActive(!0),s.length>43&&(a.setValue(""),e.ADialog.error("VIS_CheckColumnLength")),this.setCalloutActive(!1),a=s=null,""},n.prototype.checkTableLength=function(t,i,n,a,s,l){if(!this.isCalloutActive()&&null!=s&&0!=s)return this.setCalloutActive(!0),s.length>40&&(a.setValue(""),e.ADialog.error("VIS_CheckTableLength")),this.setCalloutActive(!1),a=s=null,""},n.prototype.checkOrgAccess=function(n,a,s,l,o,r){if(!this.isCalloutActive()&&null!=o){var d=i.getValueOfInt(s.getValue("AD_User_ID"));return this.setCalloutActive(!0),t.ajax({url:e.Application.contextUrl+"VIS/CalloutColumn/CheckOrgAccessByRole",data:{AD_Role_ID:o,AD_User_ID:d},success:function(t){"NoRoleAcc"==t&&e.ADialog.warn("VIS_NoRoleAccess"),"NoUserAcc"==t&&e.ADialog.warn("VIS_NoUserAccess")},error:function(e){this.log.severe(e)}}),this.setCalloutActive(!1),s=o=null,""}},n.prototype.buttonDisable=function(e,t,i,n,a,s){if(!this.isCalloutActive()&&null!=a)return this.setCalloutActive(!0),i.setValue("IsExpireLink","N"),this.setCalloutActive(!1),i=a=null,""},n.prototype.SetBIUserName=function(n,a,s,l,o,r){if(!this.isCalloutActive()&&null!=o){this.setCalloutActive(!0);var d=i.getValueOfInt(s.getValue("AD_User_ID"));return t.ajax({url:e.Application.contextUrl+"VIS/CalloutColumn/GetEmailAddress",data:{AD_User_ID:d},async:!1,success:function(e){e&&s.setValue("VA037_BIUserName",e)},error:function(e){this.log.severe(e)}}),this.setCalloutActive(!1),s=o=null,""}},e.calloutColumn=n,e.Utility.inheritPrototype(a,e.CalloutEngine),a.prototype.CheckDocActionInTable=function(t,n,a,s,l,o){return this.isCalloutActive()||null==l||""==l.toString()||(this.setCalloutActive(!0),e.dataContext.getJSONRecord("VIS/SurveyPanel/CheckDocActionInTable",i.getValueOfInt(l))?a.setValue("IsDocAction","Y"):a.setValue("IsDocAction","N"),this.setCalloutActive(!1)),""},e.CalloutCheckDocAction=a,e.Utility.inheritPrototype(s,e.CalloutEngine),s.prototype.CalloutGetTableIDByTab=function(t,n,a,s,l,o){if(this.isCalloutActive()||null==l||""==l.toString())return"";this.setCalloutActive(!0);var r=e.dataContext.getJSONRecord("VIS/SurveyPanel/CalloutGetTableIDByTab",i.getValueOfInt(l));return a.setValue("AD_Table_ID",r),e.dataContext.getJSONRecord("VIS/SurveyPanel/CheckDocActionInTable",i.getValueOfInt(r))?a.setValue("IsDocAction","Y"):a.setValue("IsDocAction","N"),this.setCalloutActive(!1),""},e.CalloutGetTableID=s}(VIS,jQuery)},453:()=>{!function(e,t){function i(e,t,i){this.parent=e,this.pi=t,this.windowNo,this.paraList=null,this.splitUI=e.splitUI,this.parameters=null,this.cansplitUI=function(e){splitUI=e},this.getFileType=function(){return e.getFileType()},this.setBusy=function(t){e.setBusy(t)},this.isBackground=function(){return e.isBackground()}}function n(i,n,a){this.bytes=null,this.RptFileName=i,this.Pi=n;var s=null,l=null;$innerRightDiv=null;var o=null,r=t("<div class='vis-apanel-busy' style='width:98%;height:98%;position:absolute'>");s=t("<div class='vis-height-full'>"),(l=t("<div class='vis-height-full'>")).css("background-color","rgba(var(--v-c-primary), .3)"),$innerRightDiv=t("<div class='vis-height-full' style='padding:5px;'>"),s.append(l),s.append(r),a?(l.append($innerRightDiv),$innerRightDiv.html(i)):n.getIsBiHtml()?((o=t("<iframe style = 'width:100%;height:99.4%;'>")).attr("src",e.Application.contextUrl+"BiPanel/GetHTMLReport?info="+window.encodeURIComponent(i)),l.css("height","95%"),l.css("width","100%"),l.append(o)):((o=t("<iframe style = 'width:100%;height:99.4%;' pluginspage='http://www.adobe.com/products/acrobat/readstep2.html'>")).attr("src",e.Application.contextUrl+i),l.css("height","95%"),l.css("width","100%"),l.append(o)),this.getRoot=function(){return s},this.getRightDiv=function(){return l},this.getRightInnerDiv=function(){return $innerRightDiv},this.getIsHtmlReport=function(){return a},this.getHtml=function(){return i},this.disposeComponent=function(){null!=s&&(s.remove(),s=null)},this.setBusy=function(e){r.css("display",e?"block":"none")},this.sizeChanged=function(e,t){},this.refresh=function(){o&&(window.setTimeout((function(){o.css("height","99.4%")}),50),o.css("height",o.height()-1))}}i.prototype.REPORT_TYPE_CSV="C",i.prototype.REPORT_TYPE_PDF="P",i.prototype.REPORT_TYPE_RTF="R",i.prototype.REPORT_TYPE_BIHTML="B",i.prototype.ORIGIN_WINDOW="W",i.prototype.ORIGIN_FORM="F",i.prototype.ORIGIN_MENU="P",i.prototype.process=function(t){this.lock(),this.windowNo=t,this.pi.setWindowNo(t);var i=this;this.jObjectFromServer=null;var n={processInfo:this.pi.toJson()};e.dataContext.process(n,(function(e){if(null!=e.error)return i.pi.setSummary(e.error,!0),i.unlock(),void(i=null);var t=JSON.parse(e.result);if(t.IsError)return i.pi.setSummary(t.Message,!0),i.unlock(),void(i=null);i.complete(t),i=null}))},i.prototype.complete=function(t){if(this.jObjectFromServer=t,this.pi.setAD_PInstance_ID(t.AD_PInstance_ID),this.pi.setIsBiHtml(t.IsBiHTMlReport),this.pi.setCustomHTML(t.CustomHTML),this.pi.set_AD_PrintFormat_ID(t.AD_PrintFormat_ID),t&&t.ReportProcessInfo&&(this.pi.setIsReport(t.ReportProcessInfo.IsReport),this.pi.setTotalPages(t.ReportProcessInfo.TotalPage),this.pi.setSupportPaging(t.ReportProcessInfo.SupportPaging),this.pi.setPageSize(t.ReportProcessInfo.PageSize)),t.ShowParameter){this.pi.setAD_PInstance_ID(t.AD_PInstance_ID);try{var i=new e.ProcessParameter(this.pi,this,this.windowNo);this.splitUI&&(this.parent.parameterContainer.append(i.getRoot()),this.parent.setParameterHeights()),i.initDialog(t.ProcessFields),this.splitUI?i.showCloseIcon(this.parent.getShowParameterCloseIcon()):(i.showDialog(),i=null)}catch(e){this.pi.setSummary(e.message,!0)}this.unlock()}else{if(t.IsTelerikReport)window.KJS&&this.parent&&this.parent.showTelerikReport(this.pi.AD_PInstance_ID,this.pi.getTable_ID());else if(this.unlock(),this.parent)if(t.AskForNewTab&&t.HTML&&t.HTML.length>0)e.ADialog.confirm("VIS_OpenNewTab",!0,"","Confirm",(function(i){i&&window.open(e.Application.contextUrl+t.ReportFilePath)}));else if(t.ReportFilePath){if(/ipad|iphone|ipod|mobile|android|blackberry|webos|windows phone/i.test(navigator.userAgent.toLowerCase()))window.open(e.Application.contextUrl+t.ReportFilePath);else if(this.parent.setReportBytes){this.parent.setReportBytes(t.Report),this.parent.setReportPath(t.ReportFilePath);var n=null;t.HTML&&t.HTML.length>0?(n=new e.PdfViewer(t.HTML,null,!0),this.parent.showReport(n,t,this)):t.ReportFilePath&&t.ReportFilePath.length>0&&(n=new e.PdfViewer(t.ReportFilePath,this.pi),!0,this.parent.showReport(n,t,this))}else window.open(e.Application.contextUrl+t.ReportFilePath)}else if(this.pi.getUseCrystalReportViewer()&&this.pi.getIsReport()){new e.ReportViewerContainer(this).show()}this.setBusy(!1),this.dispose()}},i.prototype.onProcessDialogClosed=function(t,i){if(t){var n=this;this.paraList=i,this.lock();var a={processInfo:n.pi.toJson(),parameterList:i};e.dataContext.executeProcess(a,(function(e){if(null!=e.error)return n.pi.setSummary(e.error,!0),n.unlock(),void(n=null);var t=JSON.parse(e.result);if(t.IsError)return n.pi.setSummary(t.Message,!0),n.unlock(),void(n=null);n.complete(t),this.splitUI||(n=null)}))}},i.prototype.unlock=function(){var t=this.jObjectFromServer?this.jObjectFromServer.Result:null;null!=t&&-1!=t.indexOf("@")?this.pi.setSummary(e.Msg.parseTranslation(e.Env.getCtx(),t)):t&&this.pi.setSummary(t),this.jObjectFromServer&&this.pi.setError(this.jObjectFromServer.IsError),this.parent&&this.parent.unlockUI(this.pi)},i.prototype.lock=function(){this.parent&&this.parent.lockUI(this.pi)},i.prototype.dispose=function(){this.splitUI||(this.parent=null)},n.prototype.dispose=function(){this.disposeComponent()},e.PdfViewer=n,e.ProcessCtl=i}(VIS,jQuery)},2766:()=>{!function(e,t){function i(t,i,n,a){this.title=t,this.AD_Process_ID=i,this.table_ID=n,this.tableName="",this.record_ID=a,this.AD_User_ID=0,this.AD_Client_ID=0,this.className=null,this.AD_PInstance_ID=0,this.summary="",this.error=!1,this.batch=!1,this.timeout=!1,this.parameter=null,this.AD_PrintFormat_Table_ID=0,this.AD_PrintFormat_ID=0,this.isReportFormat=!1,this.isCrystal=!1,this.totalrecords=0,this.isTelerikReport=!1,this.supportPaging=!1,this.dynamicAction="",this.pageSize=e.context.ctx["#REPORT_PAGE_SIZE"],this.totalPage=1,this.pageNo=1,this.fileType=e.ProcessCtl.prototype.REPORT_TYPE_PDF,this.windowNo=0,this.tableName="",this.AD_Window_ID=0,this.AD_ReportView_ID=0,this.printFormatTableName="",this.useCrystalReportViewer=!1,this.isReport=!1,this.isBackground=!1,this.ActionOrigin="",this.OriginName="",this.isBiHtml=!1}i.prototype.toJson=function(){return{Title:this.title,Process_ID:this.AD_Process_ID,AD_PInstance_ID:this.AD_PInstance_ID,Record_ID:this.record_ID,Error:this.error,Summary:this.getSummary(),ClassName:this.className,AD_Table_ID:this.table_ID,AD_TableName:this.tableName,AD_User_ID:this.AD_User_ID,AD_Client_ID:this.AD_Client_ID,Batch:this.batch,TimeOut:this.timeout,AD_PrintFormat_Table_ID:this.AD_PrintFormat_Table_ID,PrintFormatTableName:this.printFormatTableName,AD_PrintFormat_ID:this.AD_PrintFormat_ID,SupportPaging:this.supportPaging,DynamicAction:this.dynamicAction,PageSize:this.pageSize,TotalPage:this.totalPage,PageNo:this.pageNo,FileType:this.fileType,AD_Window_ID:this.AD_Window_ID,WindowNo:this.windowNo,AD_ReportView_ID:this.AD_ReportView_ID,UseCrystalReportViewer:this.useCrystalReportViewer,IsReport:this.isReport,IsBackground:this.isBackground,ActionOrigin:this.ActionOrigin,OriginName:this.OriginName}},i.prototype.fromJson=function(e){var t=null;return t=this instanceof i?this:new i(e.Title,e.Process_ID),e&&e.length>0&&function(e,t){e.className=t.ClassName,e.record_ID=t.Record_ID,e.error=t.Error,e.AD_PInstance_ID=t.AD_PInstance_ID,e.summary=t.Summary,e.table_ID=t.AD_Table_ID,e.tableName=t.AD_TableName,e.AD_User_ID=t.AD_User_ID,e.AD_Client_ID=t.AD_Client_ID,e.batch=t.Batch,e.timeout=t.TimeOut,e.AD_PrintFormat_Table_ID=t.AD_PrintFormat_Table_ID,e.printFormatTableName=t.PrintFormatTableName,e.AD_PrintFormat_ID=t.AD_PrintFormat_ID,e.isCrystal=t.IsCrystal,e.isReportFormat=t.IsReportFormat,e.totalrecords=parseInt(t.TotalRecords),e.isTelerikReport=t.IsTelerikReport,e.supportPaging=t.SupportPaging,e.dynamicAction=t.DynamicAction,e.pageSize=t.PageSize,e.title=t.Title,e.AD_Process_ID=t.Process_ID,e.totalPage=t.TotalPage,e.pageNo=t.PageNo,e.windowNo=t.WindowNo,e.AD_ReportView_ID=t.AD_ReportView_ID,e.isJasperReport=t.IsJasperReport,e.useCrystalReportViewer=t.UseCrystalReportViewer,e.isReport=t.IsReport,e.isBackground=t.IsBackground,e.ActionOrigin=t.ActionOrigin,e.OriginName=t.OriginName}(t,e),t},i.prototype.setPrintFormatTableName=function(e){this.printFormatTableName=e},i.prototype.getPrintFormatTableName=function(){return this.printFormatTableName},i.prototype.setSupportPaging=function(e){this.supportPaging=e},i.prototype.getSupportPaging=function(){return this.supportPaging},i.prototype.setTotalPages=function(e){this.totalPage=e},i.prototype.getTotalPages=function(){return this.totalPage},i.prototype.setPageNo=function(e){this.pageNo=e},i.prototype.getPageNo=function(){return this.pageNo},i.prototype.setPageSize=function(e){this.pageSize=e},i.prototype.getPageSize=function(){return this.pageSize},i.prototype.setError=function(e){this.error=e},i.prototype.getIsError=function(){return this.error},i.prototype.getIsBatch=function(){return this.batch},i.prototype.setIsBatch=function(e){this.batch=e},i.prototype.getAD_PInstance_ID=function(){return this.AD_PInstance_ID},i.prototype.setAD_PInstance_ID=function(e){this.AD_PInstance_ID=e},i.prototype.getAD_Process_ID=function(){return this.AD_Process_ID},i.prototype.setAD_Process_ID=function(e){this.AD_Process_ID=e},i.prototype.getClassName=function(){return this.className},i.prototype.setClassName=function(e){this.className=e,null!=e&&0==e.length&&(this.className=null)},i.prototype.getTable_ID=function(){return this.table_ID},i.prototype.setTable_ID=function(e){this.table_ID=e},i.prototype.setTable_Name=function(e){this.tableName=e},i.prototype.getTable_Name=function(){return this.tableName},i.prototype.setPrintFormatTableName=function(e){this.printFormatTableName=e},i.prototype.getPrintFormatTableName=function(){return this.printFormatTableName},i.prototype.getRecord_ID=function(){return this.record_ID},i.prototype.setRecord_ID=function(e){this.record_ID=e},i.prototype.getTitle=function(){return this.title},i.prototype.setTitle=function(e){this.title=e},i.prototype.setAD_Client_ID=function(e){this.AD_Client_ID=e},i.prototype.getAD_Client_ID=function(){return this.AD_Client_ID},i.prototype.setAD_User_ID=function(e){this.AD_User_ID=e},i.prototype.getAD_User_ID=function(){return this.AD_User_ID},i.prototype.getParameter=function(){return this.parameter},i.prototype.setParameter=function(e){this.parameter=e},i.prototype.setIsTimeout=function(e){this.timeout=e},i.prototype.getIsTimeout=function(){return this.timeout},i.prototype.set_AD_PrintFormat_Table_ID=function(e){this.AD_PrintFormat_Table_ID=e},i.prototype.get_AD_PrintFormat_Table_ID=function(){return this.AD_PrintFormat_Table_ID},i.prototype.set_AD_PrintFormat_ID=function(e){this.AD_PrintFormat_ID=e},i.prototype.Get_AD_PrintFormat_ID=function(){return this.AD_PrintFormat_ID},i.prototype.setIsCrystal=function(e){this.isCrystal=e},i.prototype.getIsCrystal=function(){return this.isCrystal},i.prototype.setIsTelerikReport=function(e){this.isTelerikReport=e},i.prototype.getIsTelerikReport=function(){return this.isTelerikReport},i.prototype.setIsReportFormat=function(e){this.isReportFormat=e},i.prototype.getIsReportFormat=function(){return this.isReportFormat},i.prototype.getTotalRecord=function(){return this.totalrecords},i.prototype.getFileType=function(){return this.fileType},i.prototype.setFileType=function(e){this.fileType=e},i.prototype.setWindowNo=function(e){this.windowNo=e},i.prototype.getWindowNo=function(){return this.windowNo},i.prototype.setUseCrystalReportViewer=function(e){this.useCrystalReportViewer=e},i.prototype.getUseCrystalReportViewer=function(){return this.useCrystalReportViewer},i.prototype.setIsReport=function(e){this.isReport=e},i.prototype.getIsReport=function(){return this.isReport},i.prototype.GetAD_ReportView_ID=function(){return this.AD_ReportView_ID},i.prototype.SetAD_ReportView_ID=function(e){this.AD_ReportView_ID=e},i.prototype.setIsJasperReport=function(e){this.isJasperReport=e},i.prototype.getIsJasperReport=function(){return this.isJasperReport},i.prototype.setAD_Window_ID=function(e){this.AD_Window_ID=e},i.prototype.getAD_Window_ID=function(){return this.AD_Window_ID},i.prototype.setIsBackground=function(e){this.isBackground=e},i.prototype.getIsBackground=function(){return this.isBackground},i.prototype.getActionOrigin=function(){return this.ActionOrigin},i.prototype.setActionOrigin=function(e){this.ActionOrigin=e},i.prototype.getOriginName=function(){return this.OriginName},i.prototype.setOriginName=function(e){this.OriginName=e},i.prototype.setIsBiHtml=function(e){this.isBiHtml=e},i.prototype.getIsBiHtml=function(){return this.isBiHtml},i.prototype.setSummary=function(e,t){2==arguments.length&&this.setError(t),this.summary=e},i.prototype.getSummary=function(){return this.summary},i.prototype.setCustomHTML=function(e){this.customHTML=e},i.prototype.getCustomHTML=function(){return this.customHTML},i.prototype.addLog=function(e,t,i,n,a){return this.addLogEntry(new s(e,t,i,n,a))},i.prototype.addLogEntry=function(e){if(null==e)return null;null==this.logs&&(this.logs=[]);for(var t=e.getLog_ID(),i=0;i<this.logs.length;i++){var n=this.logs[i];if(t==n.getLog_ID())return n}return this.logs.push(e),e},i.prototype.getLogInfo=function(t){if(null==this.logs)return"";var i=new StringBuilder;t&&i.append('<div class=\'vis-process-result-table\'><table width="100%" border="0" cellspacing="0" cellpadding="2">');for(var n=!1,a=!1,s=!1,l=0;l<this.logs.length;l++){null!=(o=this.logs[l]).getP_Date()&&(n=!0),null!=o.getP_Number()&&(a=!0),null!=o.getP_Msg()&&(s=!0)}for(l=0;l<this.logs.length;l++){var o;if(t?i.append("<tr>"):l>0&&i.append("\n"),null!=(o=this.logs[l]).getP_Date()){i.append(t?"<td>":"");o.getP_Date();i.append(t?"</td>":" \t")}else n&&i.append(t?"<td>&nbsp;</td>":" \t");null!=o.getP_Number()?i.append(t?"<td>":"").append(o.getP_Number()).append(t?"</td>":" \t"):a&&i.append(t?"<td>&nbsp;</td>":" \t"),null!=o.getP_Msg()?i.append(t?"<td>":"").append(e.Msg.parseTranslation(e.Env.getCtx(),o.getP_Msg())).append(t?"</td>":""):s&&i.append(t?"<td>&nbsp;</td>":""),t&&i.append("</tr>")}return t&&i.append("</table></div>"),i.toString()},i.prototype.dispose=function(){this.title=null,this.AD_Process_ID=null,this.table_ID=null,this.tableName=null,this.record_ID=null,this.AD_User_ID=null,this.AD_Client_ID,this.className=null,this.AD_PInstance_ID=null,this.summary=null,this.error=null,this.batch=null,this.timeout=null,this.parameter=null,this.AD_PrintFormat_Table_ID=null,this.AD_PrintFormat_ID=null,this.isReportFormat=null,this.isCrystal=null,this.totalrecords=null,this.isJasperReport=null,this.customHTML=null};var n=e.Application.contextUrl+"JsonData/JDataSetWithCode",a=function(i,a,s){var l=!!s,o={sql:i,page:1,pageSize:0};a&&(o.param=a);var r=null;return function(e,i,a){var s=null;t.ajax({url:n,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){s=e,a&&a(e)}))}(o,l,(function(t){r=(new e.DB.DataReader).toJson(t),s&&s(r)})),r};function s(e,t,i,n,a){this.P_ID,this.P_Date,this.P_Number,this.P_Msg,e?this.setLog_ID(e):this.setLog_ID(this.Log_ID++),this.setP_ID(t),this.setP_Date(i),this.setP_Number(n),this.setP_Msg(a)}e.ProcessInfoUtil={setLogFromDB:function(t){var i=[];i[0]=new e.DB.SqlParam("@AD_PInstance_ID",t.getAD_PInstance_ID());var n=null;try{for(n=a("VIS_144",i);n.read();)t.addLog(n.getInt(0),n.getInt(1),n.getDateTime(2),n.getDecimal(3),n.getString(4))}catch(e){console.log(e)}finally{n&&n.dispose()}}},s.prototype.Log_ID=0,s.prototype.getLog_ID=function(){return this.Log_ID},s.prototype.setLog_ID=function(e){this.Log_ID=e},s.prototype.getP_ID=function(){return this.P_ID},s.prototype.setP_ID=function(e){this.P_ID=e},s.prototype.getP_Date=function(){return this.P_Date},s.prototype.setP_Date=function(e){this.P_Date=e},s.prototype.getP_Number=function(){return this.P_Number},s.prototype.setP_Number=function(e){this.P_Number=e},s.prototype.getP_Msg=function(){return this.P_Msg},s.prototype.setP_Msg=function(e){this.P_Msg=e},e.ProcessInfo=i}(VIS,jQuery)},6119:()=>{!function(e,t){function i(i,n,a){this.pi=i,this.parent=n,this.windowNo=a,this.gridFields=[],this.depOnFieldColumn=[],this.depOnField=[],this.vEditors=[],this.vEditors2=[],this.mFields=[],this.mFields2=[],this.isOkClicked=!1;var s,l,o,r,d,c,p,u,g=n.splitUI;this.onClosed,s=t("<div class='vis-pro-para-root'>"),l=t("<table class='vis-processpara-table vis-formouterwrpdiv'>"),p=t('<div class="vis-processbtnwrap">'),(u=t('<div class="vis-para-maxheight">')).append(l),s.append(u).append(p),(d=t('<input type="button" class="vis-process-ok-btn" >').val(e.Msg.getMsg("OK"))).addClass("VIS_Pref_btn-2"),(c=t("<input type='button'>").val(e.Msg.getMsg("Close"))).addClass("VIS_Pref_btn-2"),g||u.css("height","auto");var h=this;this.addLine=function(){o=r=null,o=t("<tr>"),t("<td class=''>"),r=t("<td class='vis-processpara-table-td3'>"),l.append(o.append(r)),g&&(l.width("100%"),o.addClass("vis-processpara-table-SplitUI"),r.addClass("vis-processpara-table-SplitUI"))},this.addFields=function(e,i){if(i){var n=null;e&&(n=e.getControl());var a=t('<div class="input-group vis-input-wrap">'),s=t('<div class="vis-control-wrap">');r.append(a),a.append(s);var l=i.getControl().attr("placeholder"," ").attr("data-placeholder","");if(s.append(l),n&&s.append(n),i.getBtnCount()>0){i.getControl().attr("placeholder"," ").attr("data-placeholder","").attr("data-hasbtn"," "),l.attr("type");var o=i.getBtn(0),d=t('<div class="input-group-append">');d.append(o),a.append(d);var c=i.getBtn(1);c&&d.append(c)}else l.attr("type")}},this.addButtons=function(){this.addLine(),p.append(c).append(d)},this.canOpenDialog=function(e){g=e},this.showCloseIcon=function(e){e||c.hide()},this.showDialog=function(){s.dialog({modal:!0,width:"auto",closeText:e.Msg.getMsg("close"),close:function(){h.parent&&h.parent.onProcessDialogClosed(h.isOkClicked,h.parameterList),h.dispose(),h=null}}),window.setTimeout((function(){c.focus()}),200)},this.getRoot=function(){return s},this.onClose=function(e){h.isOkClicked=e,s.dialog("close")},c.on(e.Events.onTouchStartAndClick,(function(e){e.stopPropagation(),e.preventDefault(),h.onClose(!1)})),d.on(e.Events.onTouchStartAndClick,(function(t){if(g){if(h.isOkClicked=!0,n.setBusy(!0),!(i=h.saveParameters()))return void n.setBusy(!1);h.pi.setAD_PInstance_ID(0),h.pi.setPageNo(1),h.parent.getFileType()?h.pi.setFileType(h.parent.getFileType()):h.pi.setFileType(e.ProcessCtl.prototype.REPORT_TYPE_PDF),h.pi.setIsBackground(h.parent.isBackground()),h.parameterList=i,h.parent.onProcessDialogClosed(h.isOkClicked,h.parameterList)}else{var i;if(t.stopPropagation(),t.preventDefault(),!(i=h.saveParameters()))return;h.parameterList=i,h.onClose(!0,i)}})),this.setHeights=function(){},this.disposeComponent=function(){c.off(e.Events.onTouchStartOrClick),d.off(e.Events.onTouchStartOrClick),s.dialog("destroy"),s.remove(),h=null,this.gridFields.length=0,this.gridFields=null,this.depOnFieldColumn.length=0,this.depOnFieldColumn,this.depOnField.length=0,this.depOnField=null,this.vEditors.length=0,this.vEditors2.length=0,this.mFields.length=0,this.mFields2.length=0,this.parent=null,this.parameterList=null,this.pi=null,this.addLine=null,this.addFields=null,this.addButtons=null,this.showDialog=null,this.onClose=null,this.isOkClicked=null,s=l=o=r=d=c=null}}i.prototype.initDialog=function(i){for(var n=null,a=0,s=i.length;a<s;a++){n=new e.GridField(i[a]),this.addLine(),this.mFields.push(n);for(var l=n.getDependentOn(!1),o=0;o<l.length;o++)this.depOnField.push(n),this.depOnFieldColumn.push(l[o]);var r=e.VControlFactory.getLabel(n),d=e.VControlFactory.getControl(null,n,!1);if(d){var c=n.getDefault(e.context,this.windowNo);d.setValue(c),d.addVetoableChangeListener(this),n.getDisplayType()==e.DisplayType.AmtDimension&&(d.hideButton(!1),d.setReadOnlyTextbox(!1),d.getControl().css("width","100%"))}if(n.setPropertyChangeListener(d),this.vEditors.push(d),this.addFields(r,d),0==a&&d&&window.setTimeout((function(e){e.vEditors[0].setDefaultFocus(!0)}),200,this),n.getIsRange()){this.addLine();var p={};t.extend(!0,p,i[a]);var u=new e.GridField(p);this.mFields2.push(u);var g=e.VControlFactory.getControl(null,u,!1);if(g){c=u.getDefault2(e.context,this.windowNo);g.setValue(c),g.addVetoableChangeListener(this),n.getDisplayType()==e.DisplayType.AmtDimension&&(g.hideButton(!1),g.setReadOnlyTextbox(!1),g.getControl().css("width","100%"))}this.vEditors2.push(g),this.addFields(null,g)}else this.mFields2.push(null),this.vEditors2.push(null)}return this.addButtons(),!0},i.prototype.vetoablechange=function(t){console.log(t);for(var i=null==t.newValue?"":t.newValue.toString(),n=t.propertyName,a=0;a<this.mFields.length;a++)if(this.mFields[a].getColumnName().toLower()==n.toLower()){var s=this.vEditors[a];if(s instanceof e.Controls.IControl){var l=this.mFields[a].getIsEditable(!0);s.setReadOnly(l)}if(this.mFields[a].getDisplayType()==e.DisplayType.YesNo){"Y"==i.toString()||"N"==i.toString()?e.Env.getCtx().setWindowContext(this.windowNo,n,i.toString()):e.Env.getCtx().setWindowContext(this.windowNo,n,"true"==i.toString().toLowerCase()?"Y":"N");break}e.Env.getCtx().setWindowContext(this.windowNo,n,i);break}if(-1!==this.depOnFieldColumn.indexOf(n))for(var o=this.getDependantFields(n),r=(a=0,o.length);a<r;a++){var d=o[a];if(null!=d&&("M_Product_ID"!=n||"M_Locator_ID"!=d.getColumnName()&&"M_LocatorTo_ID"!=d.getColumnName())){var c=d.getDefault(e.Env.getCtx(),this.windowNo);if(null==c)for(var p=0;p<this.vEditors.length;p++)if(this.vEditors[p].colName==d.getColumnName()){this.vEditors[p].ctrl[0].selectedIndex=-1;break}d.refreshLookup(),d.setValue(c,!0)}}},i.prototype.getDependantFields=function(e){var t=[];if(-1!=this.depOnFieldColumn.indexOf(e))for(var i=this.depOnFieldColumn.length,n=0;n<i;n++)this.depOnFieldColumn[n].equals(e)&&t.indexOf(this.depOnField[n])<0&&t.push(this.depOnField[n]);return t},i.prototype.saveParameters=function(){var t=new StringBuilder,i=this.mFields.length,n=0;for(n=0;n<i;n++){var a=this.mFields[n];if(a.getIsMandatory(!0)){var s=this.vEditors[n].getValue();null==s||0==s.toString().length?(a.setInserting(!0),a.setError(!0),t.length()>0&&t.append(", "),t.append(a.getHeader())):a.setError(!1);var l=this.vEditors2[n];if(null!=l){var o=l.getValue(),r=this.mFields2[n];null==o||0==o.toString().length?(a.setInserting(!0),r.setError(!0),t.length()>0&&t.append(", "),t.append(a.getHeader())):r.setError(!1)}}}if(0!=t.length())return e.ADialog.error("FillMandatory",!0,t.toString()),!1;var d=[],c={};for(n=0;n<i;n++){var p=this.vEditors[n],u=this.vEditors2[n],g=p.getValue();p.getDisplayType()==e.DisplayType.AmtDimension&&(g=p.getText());var h=null;if(null!=u&&(h=u.getValue(),u.getDisplayType()==e.DisplayType.AmtDimension&&(g=u.getText())),null!==g&&""!==g||null!==h&&""!==h){c={};var v=this.mFields[n];c.Name=v.getColumnName(),c.DisplayType=v.getDisplayType(),c.Result=g,c.Result2=h,c.LoadRecursiveData=v.getLoadRecursiveData(),c.ShowChildOfSelected=v.getShowChildOfSelected(),c.AD_Column_ID=v.getAD_Column_ID(),c.Info=p.getDisplay(),p.getDisplayType()==e.DisplayType.MultiKey&&(c.Info=p.lastDisplay),null!=u&&(c.Info_To=u.getDisplay()),d.push(c)}}return d},i.prototype.dispose=function(){this.disposeComponent()},e.ProcessParameter=i}(VIS,jQuery)},931:()=>{VIS=window.VIS||{},function(){function e(){this.record_ID=0,this.windowNo=0,this.table_ID=0,this.frame,this.curTab=null,this.selectedRow=null,this.panelWidth;var e,t,i,n,a,s,l,o,r=$('<div class="VIS-root-div"></div>'),d=10,c=0,p=0,u=0,g=0,h=0,v=0,f=0,m=0,y=0,I=null;function D(e){var t=r.closest(".vis-ad-w-p-ap-tp-outerwrap"),i=t.find(".vis-ad-w-p-ap-tp-o-b-head"),n=t.find(".vis-ad-w-p-ap-tp-o-b-content"),a=t.height(),s=i.height()+40;n.height();n.css("height",a-s);var l=$("#VIS_pagingHtml"+y).height()+10;$("#VIS_recordDetail"+y).is(":visible")?($("#VIS_recordDetail"+y).css("height",(a-s)/2+50),$("#VIS_HistoryGrd"+y).css("height",(a-s)/2-l-50)):$("#VIS_HistoryGrd"+y).css("height",a-(s+l))}function w(e,t){if(u>0){if(p=u%d==0?u/d:Math.floor(u/d)+1,(c=VIS.Utility.Util.getValueOfInt($("#VIS_ddlPages"+y).find(":selected").val())>0?VIS.Utility.Util.getValueOfInt($("#VIS_ddlPages"+y).find(":selected").val()):1)>0&&c-1,p>=c+1&&c+1,VIS.Utility.Util.getValueOfInt($("#VIS_ddlPages"+y).find(":selected").val())<=0||$("#VIS_ddlPages"+y).children("option").length<=0){$("#VIS_ddlPages"+y).empty();for(var i=1;i<=p;i++)1==i?$("#VIS_ddlPages"+y).append(new Option(i,i,!0,!0)):$("#VIS_ddlPages"+y).append(new Option(i,i,!1,!1))}p>1&&p>VIS.Utility.Util.getValueOfInt($("#VIS_ddlPages"+y).find(":selected").val())?$("#VIS_pagingText"+y).html('<span class="vis-ad-w-p-s-statusdb" id="VIS_pageIndx'+y+'">1/'+f+"</span><span>Showing Result "+((c-1)*d+1)+"-"+c*d+" of "+u+"</span>"):p>1&&p==VIS.Utility.Util.getValueOfInt($("#VIS_ddlPages"+y).find(":selected").val())?$("#VIS_pagingText"+y).html('<span class="vis-ad-w-p-s-statusdb" id="VIS_pageIndx'+y+'">1/'+f+"</span><span>Showing Result "+((c-1)*d+1)+"-"+u+" of "+u+"</span>"):1==p&&$("#VIS_pagingText"+y).html('<span class="vis-ad-w-p-s-statusdb" id="VIS_pageIndx'+y+'">1/'+f+"</span><span>Showing Result 1-"+u+" of "+u+"</span>")}else $("#VIS_pagingText"+y).html('<span class="vis-ad-w-p-s-statusdb" id="VIS_pageIndx'+y+'">0/0</span><span>Showing Result 0-0 of 0</span>'),$("#VIS_ddlPages"+y).empty()}function b(e,t){$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetHistoryRecordsCount",data:{RecordId:e,AD_Table_ID:t},success:function(e){var t;null!=(t=JSON.parse(e))&&(u=t,$("#VIS_ddlPages"+y).empty(),w())},error:function(e){}})}function C(e){g=$("#VIS_ddlPages"+y).find(":selected").val(),_(h,VIS.Utility.Util.getValueOfInt(g),y,m),c=g}function _(e,t,i,n){$("#VIS_tabPanelDataLoader"+i).show(),$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetHistoryRecordDetails",data:{RecordId:e,AD_Table_ID:n,CurrentPage:t},success:function(e){var a;null!=(a=JSON.parse(e))&&(l=a,S(a,i,!1),$("#VIS_recordDetail"+i).hide(),D(),VIS.Utility.Util.getValueOfInt(t)>0&&w(0,VIS.Utility.Util.getValueOfInt(t)),$("#VIS_tabPanelDataLoader"+i).hide(),$("#VIS_ddlPages"+i).one("change",C),$("#VIS_prevPage"+i).one("click"),$("#VIS_nextPage"+i).one("click"),$("#VIS_prevPage"+i).one("click",(function(e){g=$("#VIS_ddlPages"+i).find(":selected").val(),VIS.Utility.Util.getValueOfInt(g)>1&&($("#VIS_prevPage"+i).off("click"),$("#VIS_ddlPages"+i).off("change"),_(h,VIS.Utility.Util.getValueOfInt(g)-1,i,n),c=g,$("#VIS_ddlPages"+i).val(VIS.Utility.Util.getValueOfInt(g)-1),e.stopPropagation(),e.stopImmediatePropagation())})),$("#VIS_nextPage"+i).one("click",(function(e){g=$("#VIS_ddlPages"+i).find(":selected").val(),VIS.Utility.Util.getValueOfInt(g)<$("#VIS_ddlPages"+i).children("option").length&&($("#VIS_nextPage"+i).off("click"),$("#VIS_ddlPages"+i).off("change"),_(h,VIS.Utility.Util.getValueOfInt(g)+1,i,n),c=g,$("#VIS_ddlPages"+i).val(VIS.Utility.Util.getValueOfInt(g)+1),e.stopPropagation(),e.stopImmediatePropagation())})))},error:function(e){}})}function S(t,i,n){var a=$('<div class="VIS-tabPanelDataLoader" id="VIS_tabPanelDataLoader'+i+'"><i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i></div>'),s=$('<div class="VIS-tp-mainContainer"></div>'),o=$('<div class="VIS-tp-topSearchWrp"><button id="VIS_btnRefresh'+i+'" class="VIS-tp-refreshIcon" ><i class="vis vis-refresh"></i></button><div class="VIS-tp-searchControl"><input id="VIS_txtSearch'+i+'" type="text" placeholder="Search"><i id="VIS_faSearch'+i+'" class="fa fa-search"></i></div></div>');if(t.length>0){var d,c=$('<div class="VIS-tp-recordswrap"></div>');f=t.length,$("#VIS_pageIndx"+i).text("1/"+f);for(var p=0;p<t.length;p++)"email"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="email" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap "><div data-recid="'+p+'" class= "VIS-tp-recordIcon" ><i data-recid="'+p+'" class="vis vis-email"></i></div ><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><i data-recid="'+p+'" class="fa fa-arrow-up"></i><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+("true"==VIS.Utility.Util.getValueOfString(t[p].HasAttachment)?'" class="vis vis-attachment1"></i>':'"></i>')+'<small data-recid="'+p+'">By: '+t[p].UserName+"</small></div></div>"):"inbox"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="email" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap "><div data-recid="'+p+'" class= "VIS-tp-recordIcon" ><i data-recid="'+p+'" class="vis vis-email"></i></div ><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><i data-recid="'+p+'" class="fa fa-arrow-down"></i><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+("true"==VIS.Utility.Util.getValueOfString(t[p].HasAttachment)?'" class="vis vis-attachment1"></i>':'"></i>')+'<small data-recid="'+p+'">By: '+t[p].UserName+"</small></div></div>"):"call"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="call" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap  "><div data-recid="'+p+'" class= "VIS-tp-recordIcon" ><i data-recid="'+p+'" class="fa fa-phone" aria-hidden="true" title="Call" ></i></div ><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+("true"==VIS.Utility.Util.getValueOfString(t[p].HasAttachment)?'" class="vis vis-attachment1">&nbsp;</i>':'">&nbsp;</i>')+'<small data-recid="'+p+'">By: '+t[p].UserName+"</small></div></div>"):"chat"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="chat" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap  "><div data-recid="'+p+'" class= "VIS-tp-recordIcon" ><i data-recid="'+p+'" class="vis vis-chat" title="chat" ></i></div ><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+'">&nbsp;</i><small data-recid="'+p+'">By: '+t[p].UserName+"</small></div></div>"):"letter"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="letter" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap "><div data-recid="'+p+'" class= "VIS-tp-recordIcon" ><i data-recid="'+p+'" class="vis vis-letter"></i></div ><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+("true"==VIS.Utility.Util.getValueOfString(t[p].HasAttachment)?'" class="vis vis-attachment1">&nbsp;</i>':'">&nbsp;</i>')+'<small data-recid="'+p+'">By: '+t[p].UserName+"</small></div></div>"):"appointment"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="appointment" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap "><div data-recid="'+p+'" class="VIS-tp-recordIcon"><i data-recid="'+p+'" class="vis vis-appointment" title="appointment"></i></div><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+'">&nbsp;</i><small data-recid="'+p+'">By: '+t[p].UserName+"</small></div></div>"):"task"==t[p].Type.toLower()?d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="task" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap "><div data-recid="'+p+'" class="VIS-tp-recordIcon"><i data-recid="'+p+'" class="vis vis-task" title="task"></i></div><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight">'+(t[p].IsTaskClosed?'<span data-recid="'+p+'" class="VIS-tp-taskTag">'+VIS.Msg.getMsg("Closed")+"</span>":"")+'<i data-recid="'+p+'">&nbsp;</i><small data-recid="'+p+'" >By: '+t[p].UserName+"</small></div></div>"):"attachment"==t[p].Type.toLower()&&(d=$('<div data-rid="'+t[p].ID+'" data-username="'+t[p].UserName+'" data-winno="'+i+'" data-atype="attachment" data-recid="'+p+'" id="rowId'+p+'" class="VIS-tp-recordWrap "><div data-recid="'+p+'" class= "VIS-tp-recordIcon" title="attachment"><i data-recid="'+p+'" class="vis vis-attachmentx"></i></div ><div data-recid="'+p+'" class="VIS-tp-recordInfo"><h6 data-recid="'+p+'">'+new Date(t[p].Created).toLocaleString()+'</h6><div data-recid="'+p+'" class="VIS-tp-recordSubject"><p data-recid="'+p+'">'+t[p].Subject+'</p></div></div><div data-recid="'+p+'" class="VIS-tp-recordInfoRight"><i data-recid="'+p+'" >&nbsp;</i><small data-recid="'+p+'" >By: '+t[p].UserName+"</small></div></div>")),c.append(d);n?(r.find(".VIS-tp-recordswrap").empty(),r.find(".VIS-tp-recordswrap").append(c.html())):(s.append(a).append(o).append(c),e.empty(),e.append(s)),r.find(".VIS-tp-recordWrap").click((function(e){var t,n=e.target;t=VIS.Utility.Util.getValueOfInt($(n).data("recid")),r.find("#rowId"+t).addClass("VIS-tp-selectedRecord"),VIS.Utility.Util.getValueOfInt(v)>=0&&t!=VIS.Utility.Util.getValueOfInt(v)&&r.find("#rowId"+v).hasClass("VIS-tp-selectedRecord")&&r.find("#rowId"+v).removeClass("VIS-tp-selectedRecord"),v=t,$("#VIS_pageIndx"+i).text(VIS.Utility.Util.getValueOfInt(v)+1+"/"+f);var a=r.find("#rowId"+t).data("atype").toString().toUpper(),s=r.find("#rowId"+t).data("rid"),l=r.find("#rowId"+t).data("username");$("#VIS_recordDetail"+i).show(),"EMAIL"==a||"INBOX"==a?A(s,l,i):"CALL"==a?V(s,l,i):"APPOINTMENT"==a?N(s,l,i):"LETTER"==a?T(s,l,i):"TASK"==a?M(s,l,i):"ATTACHMENT"==a?k(s,l,i):"CHAT"==a&&O(s,l,i),D()})),$("#VIS_txtSearch"+i).keyup((function(e){if(null==e.keyCode||13==e.keyCode||8==e.keyCode){var t=$(this).val();if(""!==t||13==e.keyCode){var n=[],a=new RegExp(t,"i"),s=0;$.each(l,(function(e,t){-1==t.Subject.search(a)&&-1==t.UserName.search(a)||(n[s]=t,s++)})),S(n,i,!0),$("#VIS_recordDetail"+i).fadeOut(100),$("#VIS_recordDetail"+i).hide(),""===t&&13==e.keyCode?$("#VIS_pagingHtml"+i).show():$("#VIS_pagingHtml"+i).hide()}}})),$("#VIS_btnRefresh"+i).click((function(){VIS.Utility.Util.getValueOfInt(h)>0&&(b(h,m),_(h,0,i,m)),$("#VIS_recordDetail"+i).hide(),$("#VIS_pagingHtml"+i).show()})),$("#VIS_faSearch"+i).click((function(){var e=$("#VIS_txtSearch"+i).val();if(""===e)VIS.Utility.Util.getValueOfInt(h)>0&&(b(h,m),_(h,0,i,m)),$("#VIS_recordDetail"+i).hide(),$("#VIS_pagingHtml"+i).show();else{var t=[],n=new RegExp(e,"i"),a=0;$.each(l,(function(e,i){-1==i.Subject.search(n)&&-1==i.UserName.search(n)||(t[a]=i,a++)})),S(t,i,!0),$("#VIS_recordDetail"+i).fadeOut(100),$("#VIS_recordDetail"+i).hide(),$("#VIS_pagingHtml"+i).hide()}}))}else s.append(o),e.empty(),e.append(s)}function x(e,t){var i,n,a,s,o=-1;null!=l&&VIS.Utility.Util.getValueOfInt(e)>=0&&VIS.Utility.Util.getValueOfInt(e)<l.length&&(o=VIS.Utility.Util.getValueOfInt(e),n=(i=l[o]).ID,a=i.UserName,s=VIS.Utility.Util.getValueOfString(i.Type).toUpper(),$("#rowId"+o).addClass("VIS-tp-selectedRecord"),VIS.Utility.Util.getValueOfInt(v)>=0&&o!=VIS.Utility.Util.getValueOfInt(v)&&$("#rowId"+v).hasClass("VIS-tp-selectedRecord")&&$("#rowId"+v).removeClass("VIS-tp-selectedRecord"),v=o,$("#VIS_pageIndx"+t).text(VIS.Utility.Util.getValueOfInt(v)+1+"/"+f)),"EMAIL"==s||"INBOX"==s?A(n,a,t):"CALL"==s?V(n,a,t):"APPOINTMENT"==s?N(n,a,t):"LETTER"==s?T(n,a,t):"TASK"==s?M(n,a,t):"ATTACHMENT"==s?k(n,a,t):"CHAT"==s&&O(n,a,t)}function A(e,l,o){$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedMailDetails",datatype:"json",type:"get",cache:!1,data:{ID:e},success:function(d){var c,p,g,h=JSON.parse(d),f=0,m=h.Record_ID,y=h.AD_Table_ID,I=0;c=VIS.Utility.Util.getValueOfString(h.ID);var w,b,C="",_=VIS.Utility.Util.getValueOfString(l).split(" ");if(C=_.length>1?VIS.Utility.Util.getValueOfString(_[0]).substring(0,1).toUpper()+VIS.Utility.Util.getValueOfString(_[1]).substring(0,1).toUpper():VIS.Utility.Util.getValueOfString(l).substring(0,2).toUpper(),""!=VIS.Utility.Util.getValueOfString(h.Cc)||""!=VIS.Utility.Util.getValueOfString(h.Bcc)){if(w='<div class="dropdown show VIS-tp-dropdownWrap">'+h.To+'<a class="btn dropdown-toggle" style="font-size:.75rem;" href = "#" role = "button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" >&nbsp;<i class="fa fa-angle-down VIS-tp-recordLabels"></i></a><div class="dropdown-menu" aria-labelledby="dropdownMenuLink">',""!=VIS.Utility.Util.getValueOfString(h.Cc)){p=VIS.Utility.Util.getValueOfString(h.Cc).split(",");for(var S=0;S<p.length;S++)"undefined"!=p[S]&&""!=p[S]&&(w+=0==S?'<span class="VIS-tp-recordLabels VIS-mail-to">'+VIS.Msg.getMsg("Cc")+':&nbsp; </span><a class="dropdown-item VIS-mail-to" href = "#">'+p[S]+"</a>":'<a class="dropdown-item VIS-mail-to" href="#">'+p[S]+"</a>")}if(""!=VIS.Utility.Util.getValueOfString(h.Bcc)){g=VIS.Utility.Util.getValueOfString(h.Bcc).split(",");for(var A=0;A<g.length;A++)"undefined"!=g[A]&&""!=g[A]&&(w+=0==A?'<span class="VIS-tp-recordLabels VIS-mail-to">'+VIS.Msg.getMsg("Bcc")+':&nbsp; </span><a class="dropdown-item VIS-mail-to" href="#">'+g[A]+"</a>":'<a class="dropdown-item VIS-mail-to" href="#">'+g[A]+"</a>")}w+="</div></div>"}else w=h.To;null!=h.Attach&&h.Attach.length>0&&(f=h.Attach.length,I=h.ID),t.length<1&&(t=$('<div id="VIS_recordDetail'+o+'" class="VIS-tp-detailPanel"></div>')),t.empty(),i=$('<div class="VIS-testPanel VIS-tp-borderBott" ><div class="d-flex align-items-center VIS-tp-leftIcons"><span><i class="fa fa-reply" data-mailto="'+h.To+'" data-mailcc="'+h.Cc+'" data-mailbcc="'+h.Bcc+'" id="VIS_imgReply'+o+'"></i></span><span><i class="fa fa-reply-all" data-mailto="'+h.To+'" data-mailcc="'+h.Cc+'" data-mailbcc="'+h.Bcc+'" id="VIS_imgReplyAll'+o+'"></i></span><span><i class="fa fa-share" id="VIS_imgForward'+o+'"></i></span></div><div class= "align-items-center d-flex VIS-tp-rightIcons" ><span id="VIS_prtHistory'+o+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+o+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+o+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+o+'"><i class="vis vis-cross"></i></span></div ></div > '),b=$('<div class="VIS-tp-contentdiv" ><div id="VIS-tp-comments-input'+o+'" class="VIS-tp-comments-input"><div class="vis-tp-emailDetailWrap"><div class="VIS-mail-user-div"><span class="VIS-mail-user-span">'+C+'</span></div><div class="VIS-contentTitile"><span class="VIS-mail-username">'+l+'</span><span id="VIS_mailSubject'+o+'" class="VIS-mail-subject VIS-tp-recordLabels">'+h.Title+'</span><div class="VIS-mail-content"><div class="VIS-mail-from"><span class="VIS-tp-recordLabels">'+VIS.Msg.getMsg("From")+':&nbsp;</span><span style="word-break: break-word;">'+h.From+"</span></div><small>"+new Date(h.Date).toLocaleString()+'</small></div><span class="VIS-mail-to"><span class="VIS-tp-recordLabels">'+VIS.Msg.getMsg("To")+":&nbsp; </span>"+w+'</span></div></div><div id="VIS_mailBody'+o+'" class="VIS-mail-body" >'+h.Detail+'</div></div ><div id="VIS_viewMoreComments'+o+'" style="display:none;" class="VIS-tp-commentsPanel"></div><div id="VIS_commentsdata'+o+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+o+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+o+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+o+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>'),n=$('<div class="VIS-tp-contentdiv" ><div class="VIS-tp-comments-input'+o+'" ><div class="vis-tp-emailDetailWrap"<div class="VIS-mail-user-div"><span class="VIS-mail-user-span">'+C+'</span></div><div class="VIS-contentTitile"><span class="VIS-mail-username">'+l+'</span><span id="mailSubject" class="VIS-mail-subject VIS-tp-recordLabels">'+h.Title+'</span><div class="VIS-mail-content"><span class="VIS-mail-from"><span class="VIS-tp-recordLabels">'+VIS.Msg.getMsg("From")+':&nbsp;</span><span style="word-break: break-word;">'+h.From+"</span></div><small>"+new Date(h.Date).toLocaleString()+'</small></div><span class="VIS-mail-to"><span class="VIS-tp-recordLabels">'+VIS.Msg.getMsg("To")+":&nbsp; </span>"+w+'</span></div></div><div class="VIS-mail-body" >'+h.Detail+"</div></div>"),a=$('<div class="VIS-tp-downloadAttachment"><div class="VIS-tp-attachments"><i class="vis vis-attachment1" ></i><span> '+f+" "+VIS.Msg.getMsg("Attachments")+'</span></div><div class="VIS-tp-attchDownload" id="dwnldAllAttach"><i class="vis vis-import" title="Download All" style="opacity: 1;"></i><span> '+VIS.Msg.getMsg("VIS_DownloadAll")+"</span></div></div></div>");var T=$('<div class="VIS-tp-emailDetailOuterPanel VIS-tp-recordDetail"></div>');T.append(b).append(a),t.append(i).append(T),r.html().toString().contains("VIS_recordDetail"+o)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+o)||r.append(s),B(VIS.Utility.Util.getValueOfInt(c),!1,!1),$("#VIS_recordDetail"+o).show(),$("#dwnldAllAttach").click((function(){!function(e){if(null==e||0==e)return;$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/DownloadAllAttachments",datatype:"json",type:"get",cache:!1,data:{ID:e,Name:name},success:function(e){var t=JSON.parse(e);if(null!=t&&""!=t){var i=VIS.Application.contextUrl+"TempDownload/"+t;window.open(i)}else VIS.ADialog.error("AttachmentNotFound")}})}(e)})),$("#VIS_btnComments"+o).click((function(e){U(!1,!1,e)})),$("#VIS_txtComments"+o).keyup((function(e){U(!1,!1,e)})),$("#VIS_viewAllComments"+o).click((function(e){$("#VIS_viewAllComments"+o).text()==VIS.Msg.getMsg("HideComments")?($("#VIS_viewMoreComments"+o).empty(),$("#VIS_viewMoreComments"+o).hide(),$("#VIS-tp-comments-input"+o).show(),$("#VIS_commentsMsg"+o).show(),$("#VIS_viewAllComments"+o).text(VIS.Msg.getMsg("ViewMoreComments")),B(VIS.Utility.Util.getValueOfInt(c),!1,!1)):P(VIS.Utility.Util.getValueOfInt(c),!1,!1)})),$("#VIS_imgReply"+o).click((function(e){R(m,y,"<br><br><hr>"+$("#VIS_mailBody"+o).html(),$("#VIS_mailSubject"+o).text(),I,"R",e)})),$("#VIS_imgReplyAll"+o).click((function(e){R(m,y,"<br><br><hr>"+$("#VIS_mailBody"+o).html(),$("#VIS_mailSubject"+o).text(),I,"RA",e)})),$("#VIS_imgForward"+o).click((function(e){R(m,y,"<br><br><hr>"+$("#VIS_mailBody"+o).html(),$("#VIS_mailSubject"+o).text(),I,"F",e)})),$("#VIS_prtHistory"+o).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+o).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,o)})),$("#VIS_nextRecord"+o).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,o)})),$("#VIS_btnClose"+o).click((function(){$("#VIS_recordDetail"+o).hide(),D()}))}})}function T(e,l,o){$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedLetterDetails",datatype:"json",type:"get",cache:!1,data:{ID:e},success:function(d){var c,p=JSON.parse(d);c=VIS.Utility.Util.getValueOfString(p.ID);var g="",h="",f=VIS.Utility.Util.getValueOfString(l).split(" ");h=f.length>1?VIS.Utility.Util.getValueOfString(f[0]).substring(0,1).toUpper()+VIS.Utility.Util.getValueOfString(f[1]).substring(0,1).toUpper():VIS.Utility.Util.getValueOfString(l).substring(0,2).toUpper(),null!=p.Attach&&p.Attach.length>0&&(g=p.Attach[0].Name),t.length<1&&(t=$('<div id="VIS_recordDetail'+o+'" class="VIS-tp-detailsPanel"></div>')),t.empty(),i=$('<div class="VIS-contentHeadOuter VIS-tp-borderBott" ><div class="VIS-tp-recordIcon" ><i class="vis vis-letter"></i></div><div class="VIS-contentHead"><span class="VIS-letter-header" >'+VIS.Msg.getMsg("Letter")+'</span></div><div class="align-items-center d-flex VIS-tp-rightIcons" ><span id="VIS_prtHistory'+o+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+o+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+o+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+o+'"><i class="vis vis-cross"></i></span></div></div>'),$mailbodyhtml=$('<div class="VIS-tp-contentdiv" ><div id="VIS-tp-comments-input'+o+'" class="VIS-tp-comments-input"><div style="width: 100%"><table height="50px" width="100%"><tr height="50px"><td style="width:60px"><div class="VIS-mail-user-div"><span class="VIS-mail-user-span">'+h+'</span></div></td><td height="50px"><span class="VIS-mail-username">'+l+'</span><span id="mailSubject" class="VIS-mail-subject VIS-tp-recordLabels">'+p.Title+'</span><span class="VIS-mail-to">&nbsp;</span><span class="VIS-mail-from">&nbsp;</span></td><td height="50px" class="VIS-mail-date">'+new Date(p.Date).toLocaleString()+'</td></tr></table></div><div id="mailBody" class="VIS-mail-body" >'+p.Detail+'</div></div><div id="VIS_viewMoreComments'+o+'" style="display:none;" class="VIS-tp-commentsPanel"></div><div id="VIS_commentsdata'+o+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+o+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+o+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+o+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div> '),n=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div class="" ><div style="width:100%" ><table height="50px" width="100%"><tr height="50px"><td><div class="VIS-mail-user-div"><span class="VIS-mail-user-span">'+h+'</span></div></td><td height="50px"><span class="VIS-mail-username">'+l+'</span><span id="mailSubject" class="VIS-mail-subject VIS-tp-recordLabels">'+p.Title+'</span><span class="VIS-mail-to">&nbsp;</span><span class="VIS-mail-from">&nbsp;</span></td><td height="50px" class="VIS-mail-date">'+p.Date+'</td></tr></table></div><div id="mailBody" class="VIS-mail-body" >'+p.Detail+"</div></div>"),a=$('<div class="VIS-tp-downloadAttachment"><div class="VIS-tp-attachments"><i class="vis vis-attachment1" ></i><span> '+g+'</span></div><div class="VIS-tp-attchDownload" id="dwnldLetterAttach"><i class="vis vis-import" title="Download" style="opacity: 1;"></i><span> '+VIS.Msg.getMsg("VIS_Download")+"</span></div></div></div>");var m=$('<div class="VIS-tp-emailDetailOuterPanel VIS-tp-recordDetail"></div>');m.append($mailbodyhtml).append(a),t.append(i).append(m),r.html().toString().contains("VIS_recordDetail"+o)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+o)||r.append(s),B(VIS.Utility.Util.getValueOfInt(c),!1,!1),$("#VIS_recordDetail"+o).show(),$("#VIS_btnComments"+o).click((function(e){U(!1,!1,e)})),$("#VIS_txtComments"+o).keyup((function(e){U(!1,!1,e)})),$("#VIS_viewAllComments"+o).click((function(e){$("#VIS_viewAllComments"+o).text()==VIS.Msg.getMsg("HideComments")?($("#VIS_viewMoreComments"+o).empty(),$("#VIS_viewMoreComments"+o).hide(),$("#VIS-tp-comments-input"+o).show(),$("#VIS_commentsMsg"+o).show(),$("#VIS_viewAllComments"+o).text(VIS.Msg.getMsg("ViewMoreComments")),B(VIS.Utility.Util.getValueOfInt(c),!1,!1)):P(VIS.Utility.Util.getValueOfInt(c),!1,!1)})),$("#dwnldLetterAttach").click((function(){!function(e,t){if(null==e||0==e)return;$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/DownloadAttachment",datatype:"json",type:"get",cache:!1,data:{ID:e,Name:t},success:function(e){var t=JSON.parse(e);if(null!=t&&""!=t){var i=VIS.Application.contextUrl+"TempDownload/"+t;window.open(i)}else VIS.ADialog.error("AttachmentNotFound")}})}(e,g)})),$("#VIS_prtHistory"+o).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+o).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,o)})),$("#VIS_nextRecord"+o).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,o)})),$("#VIS_btnClose"+o).click((function(){$("#VIS_recordDetail"+o).hide(),D()}))}})}function V(e,l,o){var d=VIS.Utility.Util.getValueOfInt(e);$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedCallDetails",datatype:"json",type:"get",cache:!1,data:{ID:e},success:function(e){var c,p,g=JSON.parse(e),h=d,f="";attach_ID=0,attachLine_ID=0;var m=g.VA048_Duration>=60?function(e){var t=~~(e%3600/60),i=e%60,n="";~~(e/3600)>0&&(n+=hrs+":"+(t<10?"0":""));return n+=t+":"+(i<10?"0":""),(n+=""+i)+" "+VIS.Msg.getMsg("VA048_Minutes")}(g.VA048_Duration):g.VA048_Duration+" "+VIS.Msg.getMsg("VA048_Seconds");null!=g.Attach&&g.Attach.length>0&&(f=g.Attach[0].Name,attach_ID=g.Attach[0].AttID,attachLine_ID=g.Attach[0].ID),"completed"==VIS.Utility.Util.getValueOfString(g.VA048_Status).toLower()&&(p='style = "color: #42d819;"'),t.length<1&&(t=$('<div id="VIS_recordDetail'+o+'" class="VIS-tp-detailsPanel"></div>')),t.empty(),i=$('<div class="VIS-tp-borderBott"><div class="VIS-contentHeadOuter"><div class= "VIS-tp-recordIcon" ><i class="fa fa-phone" aria-hidden="true" title="Call"></i></div ><div class="VIS-contentHead"><div class="VIS-contentTitile"><h6 class="mb-0">'+l+"</h6><small>"+g.VA048_From+'</small></div><div class="align-items-center d-flex VIS-tp-rightIcons"><span id="VIS_prtHistory'+o+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+o+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+o+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+o+'"><i class="vis vis-cross"></i></span></div></div></div></div>'),c=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div id="VIS-tp-comments-input'+o+'" class="VIS-tp-comments-input"><div class="" ><table height="50px" width="100%"><tr class="VIS-call-col-header" ><td>'+VIS.Msg.getMsg("VA048_To")+"</td><td>"+VIS.Msg.getMsg("VA048_Duration")+'</td></tr><tr class="VIS-call-col-data " ><td>'+g.VA048_To+"</td><td>"+m+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Created")+"</td><td>"+VIS.Msg.getMsg("VA048_Status")+'</td></tr><tr class="VIS-call-col-data"><td>'+new Date(g.Created).toLocaleString()+"</td><td "+p+" >"+g.VA048_Status+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("VA048_Price")+"</td><td>"+VIS.Msg.getMsg("VA048_PriceUnit")+'</td></tr><tr class="VIS-call-col-data"><td>'+g.VA048_Price+"</td><td>"+g.VA048_Price_Unit+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Category")+"</td><td>"+VIS.Msg.getMsg("Attachments")+'</td></tr><tr class="VIS-call-col-data"><td>'+VIS.Msg.getMsg("VA048_CallType")+'</td><td class="VIS-tp-attchDownload" id="dwnldCallAttach">'+f+'</td></tr></table></div></div><div id="VIS_viewMoreComments'+o+'" style="display:none;" class="VIS-tp-commentsPanel" ></div><div id="VIS_commentsdata'+o+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+o+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+o+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+o+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>'),n=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div id="VIS-tp-comments-input'+o+'" class="VIS-tp-comments-input"><div class="" ><table height="50px" width="100%"><tr class="VIS-call-col-header" ><td>'+VIS.Msg.getMsg("VA048_To")+"</td><td>"+VIS.Msg.getMsg("VA048_Duration")+'</td></tr><tr class="VIS-call-col-data " ><td>'+g.VA048_To+"</td><td>"+g.VA048_Duration+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Created")+"</td><td>"+VIS.Msg.getMsg("VA048_Status")+'</td></tr><tr class="VIS-call-col-data"><td>'+g.Created+'</td><td style="color: #42d819;">'+g.VA048_Status+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("VA048_Price")+"Price</td><td>"+VIS.Msg.getMsg("VA048_PriceUnit")+'Price Unit</td></tr><tr class="VIS-call-col-data"><td>'+g.VA048_Price+"</td><td>"+g.VA048_Price_Unit+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Category")+"</td><td>"+VIS.Msg.getMsg("Attachments")+'</td></tr><tr class="VIS-call-col-data"><td>'+VIS.Msg.getMsg("VA048_CallType")+'</td><td class="VIS-tp-attchDownload" id="dwnldCallAttach">'+f+"</td></tr></table></div></div>"),a=$('<div id="VIS_commentsdata'+o+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+o+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+o+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+o+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>');var y=$('<div class="VIS-mail-header VIS-tp-recordDetail"></div>');y.append(c),t.append(i).append(y),r.html().toString().contains("VIS_recordDetail"+o)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+o)||r.append(s),B(VIS.Utility.Util.getValueOfInt(h),!1,!0),$("#VIS_recordDetail"+o).show(),$("#dwnldCallAttach").click((function(){!function(e,t,i){if(null==e||0==e)return;$.ajax({url:VIS.Application.contextUrl+"AttachmentHistory/DownloadAttachmentCall",datatype:"json",type:"get",cache:!1,data:{AttID:t,ID:e,Name:i},success:function(e){var t=JSON.parse(e);if(null!=t&&""!=t){var i=VIS.Application.contextUrl+"TempDownload/"+t;window.open(i)}else VIS.ADialog.error("AttachmentNotFound")}})}(attachLine_ID,attach_ID,f)})),$("#VIS_btnComments"+o).click((function(e){U(!1,!0,e)})),$("#VIS_txtComments"+o).keyup((function(e){U(!1,!0,e)})),$("#VIS_viewAllComments"+o).click((function(e){$("#VIS_viewAllComments"+o).text()==VIS.Msg.getMsg("HideComments")?($("#VIS_viewMoreComments"+o).empty(),$("#VIS_viewMoreComments"+o).hide(),$("#VIS-tp-comments-input"+o).show(),$("#VIS_commentsMsg"+o).show(),$("#VIS_viewAllComments"+o).text(VIS.Msg.getMsg("ViewMoreComments")),B(VIS.Utility.Util.getValueOfInt(h),!1,!0)):P(VIS.Utility.Util.getValueOfInt(h),!1,!0)})),$("#VIS_prtHistory"+o).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+o).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,o)})),$("#VIS_nextRecord"+o).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,o)})),$("#VIS_btnClose"+o).click((function(){$("#VIS_recordDetail"+o).hide(),D()}))}})}function N(e,l,o){var d,c,p="",g=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedAppointmentDetails",{record_ID:e},null);if(null!=g){strApp="",c=VIS.Utility.Util.getValueOfString(g.AppointmentsInfo_ID);var h=g.AttendeeInfo;if(null!=h&&""!=h&&(names=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"AttachmentHistory/GetUser",{UserQry:h},null),null!=names&&names.length>0)){strApp="";for(var f=0;f<names.length;f++)strApp+=names[f]+", ";strApp=strApp.substring(0,strApp.length-2),p=strApp}t.length<1&&(t=$('<div id="VIS_recordDetail'+o+'" class="VIS-tp-detailsPanel"></div>')),t.empty(),i=$('<div class="VIS-tp-borderBott"><div class="VIS-contentHeadOuter"><div class= "VIS-tp-recordIcon" ><i class="vis vis-task" title="task"></i></div ><div class="VIS-contentHead"><div class="VIS-contentTitile"><h6 class="mb-0">'+VIS.Msg.getMsg("Appointment")+"</h6><small>"+g.Subject+'</small></div><div class="align-items-center d-flex VIS-tp-rightIcons"><span id="VIS_prtHistory'+o+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+o+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+o+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+o+'"><i class="vis vis-cross"></i></span></div></div></div></div>'),d=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div id="VIS-tp-comments-input'+o+'" class="VIS-tp-comments-input"><div ><table height="50px" width="100%"><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Location")+"</td><td>"+VIS.Msg.getMsg("AllDay")+'</td></tr><tr class="VIS-call-col-data"><td>'+g.Location+"</td><td>"+g.Allday+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("StartDate")+"</td><td>"+VIS.Msg.getMsg("EndDate")+'</td></tr><tr class="VIS-call-col-data"><td>'+new Date(g.StartDate).toLocaleString()+"</td><td>"+new Date(g.EndDate).toLocaleString()+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Contacts")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+p+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Description")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+g.Description+'</td></tr></table></div></div><div id="VIS_viewMoreComments'+o+'" style="display:none;" class="VIS-tp-commentsPanel"></div><div id="VIS_commentsdata'+o+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+o+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+o+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+o+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>'),n=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div id="VIS-tp-comments-input'+o+'" class="VIS-tp-comments-input"><div ><table height="50px" width="100%"><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Location")+"</td><td>"+VIS.Msg.getMsg("AllDay")+'</td></tr><tr class="VIS-call-col-data"><td>'+g.Location+"</td><td>"+g.Allday+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("StartDate")+"</td><td>"+VIS.Msg.getMsg("EndDate")+'</td></tr><tr class="VIS-call-col-data"><td>'+g.StartDate+"</td><td>"+g.EndDate+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Contacts")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+p+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Description")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+g.Description+"</td></tr></table></div></div>"),a=$('<div id="ViewMoreComments'+o+'" style="display:none;" class="VIS-tp-commentsPanel"></div><div id="VIS_commentsdata'+o+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+o+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+o+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+o+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>');var m=$('<div class="VIS-mail-header VIS-tp-recordDetail"></div>');m.append(d),t.append(i).append(m),r.html().toString().contains("VIS_recordDetail"+o)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+o)||r.append(s),B(VIS.Utility.Util.getValueOfInt(c),!0,!1),p="",$("#VIS_recordDetail"+o).show(),$("#VIS_btnComments"+o).click((function(e){U(!0,!1,e)})),$("#VIS_txtComments"+o).keyup((function(e){U(!0,!1,e)})),$("#VIS_viewAllComments"+o).click((function(e){$("#VIS_viewAllComments"+o).text()==VIS.Msg.getMsg("HideComments")?($("#VIS_viewMoreComments"+o).empty(),$("#VIS_viewMoreComments"+o).hide(),$("#VIS-tp-comments-input"+o).show(),$("#VIS_commentsMsg"+o).show(),$("#VIS_viewAllComments"+o).text(VIS.Msg.getMsg("ViewMoreComments")),B(VIS.Utility.Util.getValueOfInt(c),!0,!1)):P(VIS.Utility.Util.getValueOfInt(c),!0,!1)})),$("#VIS_prtHistory"+o).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+o).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,o)})),$("#VIS_nextRecord"+o).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,o)})),$("#VIS_btnClose"+o).click((function(){$("#VIS_recordDetail"+o).hide(),D()}))}}function M(e,l,d){$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedTaskDetails",datatype:"json",type:"get",cache:!1,data:{record_ID:e},success:function(e){var l,c,p=JSON.parse(e);if(null!=p){var g,h,f="",m=p.AttendeeInfo;if(o=p.IsTaskClosed,l=VIS.Utility.Util.getValueOfString(p.AppointmentsInfo_ID),null!=m&&""!=m&&(names=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"AttachmentHistory/GetUser",{UserQry:m},null),null!=names&&names.length>0)){f="";for(var y=0;y<names.length;y++)f+=names[y]+", ";f=f.substring(0,f.length-2)}""!=VIS.Utility.Util.getValueOfString(p.PriorityKey)&&("1"==p.PriorityKey?(h="color: #f60000;",g="Urgent"):"3"==p.PriorityKey?(h="color: #fb9300;",g="High"):"5"==p.PriorityKey?(h="color: #6f04e8;",g="Medium"):"7"==p.PriorityKey?(h="color: #03e5f3;",g="Low"):"9"==p.PriorityKey&&(h="color: #42d819;",g="Minor")),t.length<1&&(t=$('<div id="VIS_recordDetail'+d+'" class="VIS-tp-detailsPanel"></div>')),t.empty(),i=$('<div class="VIS-tp-borderBott"><div class="VIS-contentHeadOuter"><div class= "VIS-tp-recordIcon" ><i class="vis vis-task" title="task"></i></div ><div class="VIS-contentHead"><div class="VIS-contentTitile"><h6 class="mb-0">'+VIS.Msg.getMsg("Task")+"</h6><small>"+p.Subject+'</small></div><div class="align-items-center d-flex VIS-tp-rightIcons"><span id="VIS_prtHistory'+d+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+d+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+d+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+d+'"><i class="vis vis-cross"></i></span></div></div></div></div>'),c=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div id="VIS-tp-comments-input'+d+'" class="VIS-tp-comments-input"><div class="VIS-tp-taskcontTag" >'+(p.IsTaskClosed?'<span class="VIS-tp-taskTag">'+VIS.Msg.getMsg("Closed")+"</span>":"")+'<table height="50px" width="100%"><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Priority")+"</td><td>"+VIS.Msg.getMsg("Status")+'</td></tr><tr class="VIS-call-col-data"><td style="'+h+'">'+g+"</td><td>"+10*VIS.Utility.Util.getValueOfInt(p.TaskStatus)+'%</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("StartDate")+"</td><td>"+VIS.Msg.getMsg("EndDate")+'</td></tr><tr class="VIS-call-col-data"><td>'+new Date(p.StartDate).toLocaleString()+"</td><td>"+new Date(p.EndDate).toLocaleString()+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("ASSIGNEDTO")+"</td><td>"+VIS.Msg.getMsg("Category")+'</td></tr><tr class="VIS-call-col-data"><td>'+p.AssignedTo+"</td><td>"+p.CategoryName+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Result")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+p.Result+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Description")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+p.Description+'</td></tr><tr><td><div class="vis-float-left vis-frm-ls-top"><input id="VIS_chkTaskComplete'+d+'" value="1" type="checkbox" class="vis-float-left"><label id="VIS_lblTaskComplete'+d+'" for="chkTaskComplete" class="wsp-task-from-inputLabel vis-float-left" style="margin:0 0 0 5px;">'+VIS.Msg.getMsg("Closed")+'</label></div></td><td><div class="vis-float-right"><a href="javascript:void(0)" id="VIS_hlnktaskdone'+d+'" class="vis-btn vis-btn-done vis-icon-doneButton vis-float-right vis-btnOk"> <span class="vis-btn-ico vis-btn-done-bg vis-btn-done-border"></span>'+VIS.Msg.getMsg("Done")+'</a></div></td></tr></table></div></div><div id="VIS_viewMoreComments'+d+'" style="display:none;" class="VIS-tp-commentsPanel"></div><div id="VIS_commentsdata'+d+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+d+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+d+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+d+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>'),n=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div id="VIS-tp-comments-input'+d+'" class="VIS-tp-comments-input"><div class="VIS-tp-taskcontTag" >'+(p.IsTaskClosed?'<span class="VIS-tp-taskTag">'+VIS.Msg.getMsg("Closed")+"</span>":"")+'<table height="50px" width="100%"><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("Priority")+"</td><td>"+VIS.Msg.getMsg("Status")+'</td></tr><tr class="VIS-call-col-data"><td style="'+h+'">'+p.Priority+"</td><td>"+10*VIS.Utility.Util.getValueOfInt(p.TaskStatus)+'%</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("StartDate")+"</td><td>"+VIS.Msg.getMsg("EndDate")+'</td></tr><tr class="VIS-call-col-data"><td>'+p.StartDate+"</td><td>"+p.EndDate+'</td></tr><tr class="VIS-call-col-header"><td>'+VIS.Msg.getMsg("ASSIGNEDTO")+"</td><td>"+VIS.Msg.getMsg("Category")+'</td></tr><tr class="VIS-call-col-data"><td>'+p.AssignedTo+"</td><td>"+p.CategoryName+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Result")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+p.Result+'</td></tr><tr class="VIS-call-col-header"><td colspan="2">'+VIS.Msg.getMsg("Description")+'</td></tr><tr class="VIS-call-col-data"><td colspan="2">'+p.Description+"</td></tr></table></div></div>"),a=$('<div id="VIS_viewMoreComments'+d+'" style="display:none;" class="VIS-tp-commentsPanel"></div><div id="VIS_commentsdata'+d+'"><div class="pr-0 m-0 VIS-tp-commentsField d-flex flex-column w-100"><p id="VIS_viewAllComments'+d+'" class="vis-attachhistory-view-comments" > '+VIS.Msg.getMsg("ViewMoreComments")+'</p><div class="vis-attachhistory-comments vis-feedMessage m-0"><input id="VIS_txtComments'+d+'" type="text" placeholder="'+VIS.Msg.getMsg("TypeComment")+'"></input><span id="VIS_btnComments'+d+'" class="vis-attachhistory-comment-icon vis vis-sms"></span></div></div></div>');var w=$('<div class="VIS-mail-header VIS-tp-recordDetail"></div>');w.append(c),t.append(i).append(w),r.html().toString().contains("VIS_recordDetail"+d)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+d)||r.append(s),B(VIS.Utility.Util.getValueOfInt(l),!0,!1),"",$("#VIS_recordDetail"+d).show(),$("#VIS_btnComments"+d).click((function(e){U(!0,!1,e)})),$("#VIS_txtComments"+d).keyup((function(e){U(!0,!1,e)})),$("#VIS_viewAllComments"+d).click((function(e){$("#VIS_viewAllComments"+d).text()==VIS.Msg.getMsg("HideComments")?($("#VIS_viewMoreComments"+d).empty(),$("#VIS_viewMoreComments"+d).hide(),$("#VIS-tp-comments-input"+d).show(),$("#VIS_commentsMsg"+d).show(),$("#VIS_viewAllComments"+d).text(VIS.Msg.getMsg("ViewMoreComments")),B(VIS.Utility.Util.getValueOfInt(l),!0,!1)):P(VIS.Utility.Util.getValueOfInt(l),!0,!1)})),$("#VIS_prtHistory"+d).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+d).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,d)})),$("#VIS_nextRecord"+d).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,d)})),$("#VIS_btnClose"+d).click((function(){$("#VIS_recordDetail"+d).hide(),D()})),o&&(c.find("#VIS_chkTaskComplete"+d).hide(),c.find("#VIS_hlnktaskdone"+d).hide(),c.find("#VIS_lblTaskComplete"+d).hide()),c.find("#VIS_hlnktaskdone"+d).on("click",(function(e){null!=I&&I.empty();var t=p.Subject,i=p.CategoryName,n=p.StartDate,a=p.EndDate;if(a<n)I.append(VIS.Msg.getMsg("WSP_EndDateShouldBeGreaterThanStartDate"));else{var s=p.Description,l=p.Result,o=p.PriorityKey,r=(p.Priority,parseInt(p.TaskStatus)),u=(p.TaskStatus,"");u=!!c.find("#VIS_chkTaskComplete"+d).prop("checked",!0).is(":checked");var g=[],h=p.AppointmentsInfo_ID;WspSharedUser=[];var v=0,f=p.UserID;v=null!=f&&0!=f?f:VIS.context.getAD_User_ID(),g.push({AppointmentsInfo_ID:h,Title:t,Description:s,Start:n,End:a,Categories:i,TaskStatus:r,PriorityKey:o,Ad_User_ID:v,Contacts:[],ContactsInfo:WspSharedUser,isClosed:u,Result:l}),""!=t&&t.trim().length>0&&$.ajax({url:VIS.Application.contextUrl+"WSP/Home/UpdateJson_Task",type:"POST",datatype:"JSON",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify({models:g}),success:function(e){JSON.parse(e);VIS.ADialog.info("WSP_TaskUpdated",!0,null),c.find("#VIS_chkTaskComplete"+d).hide(),c.find("#VIS_hlnktaskdone"+d).hide(),c.find("#VIS_lblTaskComplete"+d).hide()}})}}))}},error:function(e){}})}function k(e,a,l){$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedAttachmentDetails",datatype:"json",type:"get",cache:!1,data:{record_ID:e},success:function(e){var a=JSON.parse(e),o="";if(null!=a&&a.length>0)for(var d=0;d<a.length;d++){o+='<div class="VIS-tp-recordWrap"><div class="VIS-tp-attachIcon">'+(".doc"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()||".docx"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()?'<i class="vis vis-doc-word"></i>':".xls"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()||".xlsx"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()?'<i class="vis vis-doc-excel"></i>':".ppt"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()||".pptx"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()?'<i class="vis vis-doc-pp"></i>':".pdf"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()?'<i class="vis vis-doc-pdf"></i>':".txt"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()?'<i class="vis vis-doc-text"></i>':(".png"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()||".jpg"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()||".jpeg"==VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower()||VIS.Utility.Util.getValueOfString(a[d].FileType).toString().toLower(),'<i class="vis vis-doc-img"></i>'))+'</div><div data-filename="'+VIS.Utility.Util.getValueOfString(a[d].FileName)+'" data-attid="'+VIS.Utility.Util.getValueOfString(a[d].AD_Attachment_ID)+'" data-id="'+VIS.Utility.Util.getValueOfString(a[d].ID)+'" class="VIS-tp-attachInfo" ><h6>'+VIS.Utility.Util.getValueOfString(a[d].FileName)+"</h6><small>"+VIS.Utility.Util.getValueOfString(a[d].FileSize)+' kb</small></div><div class="VIS-tp-recordInfoRight"><span class="VIS-tp-dateTime">'+new Date(a[d].CreatedOn).toLocaleString()+"</span><small>By: "+VIS.Utility.Util.getValueOfString(a[d].CreatedBy)+"</small></div></div>"}t.length<1&&(t=$('<div id="VIS_recordDetail'+l+'" class="VIS-tp-detailsPanel"></div>')),t.empty(),i=$('<div class="VIS-contentHeadOuter VIS-tp-borderBott"><div class= "VIS-tp-recordIcon" ><i class="vis vis-attachmentx"></i></div><div class="VIS-contentHead"><span class="VIS-letter-header">'+VIS.Msg.getMsg("Attachment")+'</span></div><div class="align-items-center d-flex VIS-tp-rightIcons" ><span id="VIS_prtHistory'+l+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+l+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+l+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+l+'"><i class="vis vis-cross"></i></span></div></div>'),n=$('<div class="VIS-tp-contentdiv"><div class="VIS-tp-contentWrap VIS-tp-attachmentContent">'+o+"</div></div>");var c=$('<div class="VIS-mail-header VIS-tp-recordDetail"></div>');c.append(n),t.append(i).append(c),r.html().toString().contains("VIS_recordDetail"+l)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+l)||r.append(s),attdInfo="",$("#VIS_recordDetail"+l).show(),$(".VIS-tp-attachInfo").click((function(e){$(".VIS-tp-contentWrap").css({cursor:"wait"}),function(e){var t=e.target,i="",n="",a="";$(t).is("div")?(i=$(t).data("filename"),a=$(t).data("attid"),n=$(t).data("id")):$(t).is("h6")&&(i=$(t).parent().data("filename"),a=$(t).parent().data("attid"),n=$(t).parent().data("id"));if(null==n||0==n)return;$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/DownloadHistoryAttachment",datatype:"json",type:"get",cache:!1,data:{AttID:a,ID:n,Name:i},success:function(e){var t=JSON.parse(e);if(null!=t&&""!=t){var i=VIS.Application.contextUrl+"TempDownload/"+t;$("#tblAttach").css({cursor:"default"}),window.open(i)}else VIS.ADialog.error("AttachmentNotFound")}})}(e)})),$("#VIS_prtHistory"+l).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+l).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,l)})),$("#VIS_nextRecord"+l).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,l)})),$("#VIS_btnClose"+l).click((function(){$("#VIS_recordDetail"+l).hide(),D()}))}})}function O(e,l,o){$.ajax({url:VIS.Application.contextUrl+"VIS/HistoryDetailsData/GetSelectedChatDetails",datatype:"json",type:"get",cache:!1,data:{record_ID:e},success:function(l){var d,c=JSON.parse(l),p="",g=!1,h=0,f=VIS.context.getAD_User_Name();if(null!=c&&c.length>0)for(var m=0;m<c.length;m++){if(null!=c[m].Created&&""!=c[m].Created){var y=new Date,I=(d=new Date(c[m].Created.toString())).getHours(),w=d.getMinutes(),b=" AM";0==I?I=12:I<12||(12==I?b=" PM":I>12&&(I-=12,b=" PM")),d.getMonth()+"/"+d.getDate()+"/"+d.getFullYear()+" | "+(I>=10?I:"0"+I)+":"+(w>=10?w:"0"+w)+b}0==m&&(p='<div class="VIS-tp-contentWrap VIS-tp-attachmentContent">'),0!=m&&m!=VIS.Utility.Util.getValueOfInt(c.length)-1||d.getDate()==y.getDate()&&d.getMonth()==y.getMonth()&&d.getFullYear()==y.getFullYear()&&(g=!0),h=VIS.Utility.Util.getValueOfInt(c[m].Record_ID),f.toString().toLower()==c[m].UserName.toString().toLower()?p+='<div class="VIS-tp-recordWrap VIS-tp-msgSend"><div class="VIS-tp-userImg" >'+c[m].UserImage+'</div><div class="VIS-tp-recordInfo pr-0"><div class="VIS-tp-chatInfo"><h6>'+c[m].UserName+"</h6><span>"+d.toLocaleString()+'</span></div><p class="VIS-tp-message">'+c[m].CharacterData+"</p></div></div >":p+='<div class="VIS-tp-recordWrap VIS-tp-msgRecevied"><div class="VIS-tp-userImg" >'+c[m].UserImage+'</div><div class="VIS-tp-recordInfo pr-0"><div class="VIS-tp-chatInfo"><h6>'+c[m].UserName+"</h6><span>"+d.toLocaleString()+'</span></div><p class="VIS-tp-message">'+c[m].CharacterData+"</p></div></div>",m==c.length-1&&(p+="</div>")}t.length<1&&(t=$('<div id="VIS_recordDetail'+o+'" class="VIS-tp-detailsPanel"></div>')),t.empty();var C="";g&&(C='<div class="VIS-chatBoxWrap"><div class="VIS-chat-box"><textarea id="VIS_chatBox'+o+'" class="VIS-chat-msgbox" style="height:46px;" maxlength="500"></textarea></div><div class="VIS-chat-send-div"><div style="float:left;"></div><div class="VIS-chat-send"><i class="fa fa-paper-plane VIS-tp-chatBtn" data-chid="'+VIS.Utility.Util.getValueOfInt(e).toString()+'" data-recid="'+h.toString()+'" id="VIS_imgSend'+o+'" ></i><i id="VIS_imgCancel'+o+'" class="fa fa-times-circle VIS-tp-chatBtn"></i></div></div></div>'),i=$('<div class="VIS-contentHeadOuter VIS-tp-borderBott" ><div class= "VIS-tp-recordIcon" ><i class="vis vis-chat"></i></div><div class="VIS-contentHead"><span class="VIS-letter-header">'+VIS.Msg.getMsg("Chat")+'</span></div><div class="align-items-center d-flex VIS-tp-rightIcons" ><span id="VIS_prtHistory'+o+'"><i class="vis vis-print" title="Print"></i></span><span><i id="VIS_prevRecord'+o+'" class="fa fa-arrow-left"></i></span><span><i id="VIS_nextRecord'+o+'" class="fa fa-arrow-right"></i></span><span class="VIS-close-btn" id="VIS_btnClose'+o+'"><i class="vis vis-cross"></i></span></div></div>'),n=$('<div class="VIS-tp-contentdiv VIS-tp-contentPanel"><div class="'+(g?"VIS-chatContentWrap":"")+'" >'+p+"</div>"),a=$(C+"</div>");var _=$('<div class="VIS-mail-header VIS-tp-recordDetail"></div>');_.append(n).append(a),t.append(i).append(_),r.html().toString().contains("VIS_recordDetail"+o)||r.append(t),r.html().toString().contains("VIS_pagingHtml"+o)||r.append(s),attdInfo="",$("#VIS_recordDetail"+o).show(),$("#VIS_imgSend"+o).click((function(e){E(e)})),$("#VIS_imgCancel"+o).click((function(e){$("#VIS_chatBox"+o).val("")})),$("#VIS_prtHistory"+o).find("i").click((function(){L(n.html())})),$("#VIS_prevRecord"+o).click((function(){v>0&&x(VIS.Utility.Util.getValueOfInt(v)-1,o)})),$("#VIS_nextRecord"+o).click((function(){v<VIS.Utility.Util.getValueOfInt(u)-1&&x(VIS.Utility.Util.getValueOfInt(v)+1,o)})),$("#VIS_btnClose"+o).click((function(){$("#VIS_recordDetail"+o).hide(),D()}))}})}function L(e){var t=window.open(),i='<link rel="stylesheet" href="'+VIS.Application.contextUrl+'Areas/VIS/Content/VIS.all.min.css" />';t.document.write(i+e),setTimeout((function(){t.print(),t.close()}),300)}function R(e,t,i,n,a,s,l){var o,r,d,c=null,p=l.target;!$(p).is("i")||"R"!=s&&"RA"!=s||(o=$(p).data("mailto"),r=$(p).data("mailcc"),d=$(p).data("mailbcc")),"R"==s||"RA"==s?c=new VIS.Email(o,null,null,e,!0,!0,t,i,"RE: "+VIS.Utility.Util.getValueOfString(n),a):"F"==s&&(c=new VIS.Email("",null,null,e,!0,!0,t,i,"FW: "+VIS.Utility.Util.getValueOfString(n),a));var u=new VIS.CFrame;u.setName(VIS.Msg.getMsg("EMail")),u.setTitle(VIS.Msg.getMsg("EMail")),u.hideHeader(!0),u.setContent(c),u.show(),"RA"==s&&c.showCcBccMails(r.replace(/,/g,""),d.replace(/,/g,"")),c.initializeComponent()}function E(e){var t=e.target,i=0,n=0;_AD_Table_ID=876,$(t).is("i")&&(i=$(t).data("recid"),n=$(t).data("chid"));var a=$("#VIS_chatBox"+y).val();if(""==$.trim(a)||""==a||null==a)return VIS.ADialog.info("EnterData"),null!=e&&e.preventDefault(),!1;var s=new VIS.Chat(i,n,_AD_Table_ID,"info: test",this.windowNo);s.prop.ChatText=a,s.onClose=function(){},VIS.dataContext.saveChat(s.prop),O(n,0,y)}function P(e,t,i){$.ajax({url:VIS.Application.contextUrl+"AttachmentHistory/ViewChatonHistory",datatype:"json",type:"POST",cache:!1,data:{record_ID:e,isAppointment:t,isCall:i},success:function(e){!function(e,t,i){if(e.length>0){for(var n='<div class="vis-attachhistory-comments-container">',a=0;a<e.length;a++)n=F(n,e[a]);n+="</div>",$("#VIS_viewMoreComments"+y).show(),$("#VIS-tp-comments-input"+y).hide(),$("#VIS_viewMoreComments"+y).empty(),$("#VIS_commentsMsg"+y).hide(),$("#VIS_viewAllComments"+y).text(VIS.Msg.getMsg("HideComments")),$("#VIS_viewMoreComments"+y).height(r.find(".VIS-tp-contentdiv").height()-$("#VIS_commentsdata"+y).height()),$("#VIS_viewMoreComments"+y).append(n)}}(JSON.parse(e))},error:function(e){VIS.ADialog.error("RecordNotSaved")}})}function U(e,t,i){var n=i.target;if((null==i.keyCode||13==i.keyCode)&&(null!=i.keyCode||$(n).hasClass("vis-attachhistory-comment-icon"))){var a;if(0!=(a=$("#rowId"+v).data("rid"))){var s;0!=(s=$("#VIS_txtComments"+y).val()).length&&$.ajax({url:VIS.Application.contextUrl+"AttachmentHistory/SaveComment",datatype:"json",type:"POST",cache:!1,data:{ID:a,Text:s,isAppointment:e,isCall:t},success:function(e){var t,i,n,a=JSON.parse(e);null!=a&&(n=a.length-1),i="VIS_NoRecordFound"!=a[n].UserImage&&"VIS_FileDoesn'tExist"!=a[n].UserImage&&null!=a[n].UserImage?'<img  class="userAvatar-Feeds"  src="'+a[n].UserImage+"?"+new Date+'">':'<i class="fa fa-user userAvatar-Feeds"></i>',$("#VIS_txtComments"+y).val(""),$("#VIS_commentsdata"+y).html().contains("VIS_commentsMsg")?(t=$('<div class= "vis-attachhistory-comment-detail VIS-feedDetails-cmnt d-flex" >'+i+'<div class="vis-attachhistory-comment-text ml-0"><div class="d-flex justify-content-between VIS-tp-commentHead"><h6 class="VIS-attachhistory-comment-text">Me </h6><div class="vis-attachhistory-comment-dateTime"><p>'+(new Date).toLocaleString().replace(",","").replace(/:.. /," ")+'</p></div></div><p class= "VIS-attachhistory-comment-text" >'+s+"</p></div></div>"),$("#VIS_commentsMsg"+y).empty(),$("#VIS_commentsMsg"+y).append(t),$("#VIS_viewMoreComments"+y).is(":visible")&&$("#VIS_viewMoreComments"+y).append(t),$("#VIS_commentsdata"+y).show(),$("#VIS_commentsMsg"+y).show()):(t=$('<div id="VIS_commentsMsg'+y+'"  class="vis-attachhistory-comment-data mb-0 VIS-tp-commentData"><div class= "vis-attachhistory-comment-detail VIS-feedDetails-cmnt d-flex" >'+i+'<div class="vis-attachhistory-comment-text ml-0"><div class="d-flex justify-content-between VIS-tp-commentHead"><h6 class="VIS-attachhistory-comment-text">Me </h6><div class="vis-attachhistory-comment-dateTime"><p>'+(new Date).toLocaleString().replace(",","").replace(/:.. /," ")+'</p></div></div><p class= "VIS-attachhistory-comment-text" >'+s+"</p></div></div></div>"),$("#VIS_commentsdata"+y).prepend(t),$("#VIS_viewMoreComments"+y).is(":visible")&&$("#VIS_viewMoreComments"+y).append(t))},error:function(e){VIS.ADialog.error("RecordNotSaved")}})}}}function F(e,t){return e+=' <div class="vis-attachhistory-comment-data  mb-0 VIS-tp-commentData"><div class="vis-attachhistory-comment-detail VIS-feedDetails-cmnt d-flex">',"VIS_NoRecordFound"!=t.UserImage&&"VIS_FileDoesn'tExist"!=t.UserImage&&null!=t.UserImage?e+='<img  class="userAvatar-Feeds"  src="'+t.UserImage+"?"+new Date+'">':e+='<i class="fa fa-user userAvatar-Feeds"></i>',e+='<div class="vis-attachhistory-comment-text ml-0">',t.CreatedBy==VIS.Env.getCtx().getAD_User_ID()?e+='<div class="d-flex justify-content-between VIS-tp-commentHead"><h6 class="VIS-attachhistory-comment-text">'+VIS.Msg.getMsg("Me")+" </h6>":e+='<div class="d-flex justify-content-between VIS-tp-commentHead"><h6 class="VIS-attachhistory-comment-text">'+t.UserName+"</h6>",e+='<div class="vis-attachhistory-comment-dateTime"><p>'+new Date(t.Created).toLocaleString()+'</p></div></div> <p class="VIS-attachhistory-comment-text">'+t.CharacterData+"</p></div></div></div>"}function B(e,t,i){$.ajax({url:VIS.Application.contextUrl+"AttachmentHistory/ViewChatonLastHistory",datatype:"json",type:"POST",cache:!1,data:{record_ID:e,isAppointment:t,isCall:i},success:function(e){var t=JSON.parse(e);if(t.length>0){var i="";i=function(e,t){return e+='<div class="vis-attachhistory-comment-detail VIS-feedDetails-cmnt d-flex">',"VIS_NoRecordFound"!=t.UserImage&&"VIS_FileDoesn'tExist"!=t.UserImage&&null!=t.UserImage?e+='<img  class="userAvatar-Feeds"  src="'+t.UserImage+"?"+new Date+'">':e+='<i class="fa fa-user userAvatar-Feeds"></i>',e+='<div class="vis-attachhistory-comment-text ml-0">',t.CreatedBy==VIS.Env.getCtx().getAD_User_ID()?e+='<div class="d-flex justify-content-between VIS-tp-commentHead"><h6 class="VIS-attachhistory-comment-text">'+VIS.Msg.getMsg("Me")+" </h6>":e+='<div class="d-flex justify-content-between VIS-tp-commentHead"><h6 class="VIS-attachhistory-comment-text">'+t.UserName+"</h6>",e+='<div class="vis-attachhistory-comment-dateTime"><p>'+new Date(t.Created).toLocaleString()+'</p></div></div> <p class="VIS-attachhistory-comment-text">'+t.CharacterData+"</p></div></div > ",$("#VIS_commentsdata"+y).html().contains("VIS_commentsMsg")||(e='<div id="VIS_commentsMsg'+y+'" class="vis-attachhistory-comment-data  mb-0 VIS-tp-commentData">'+e+"</div >"),e}(i,t[0]),$("#VIS_commentsMsg"+y).empty(),$("#VIS_commentsdata"+y).html().contains("VIS_commentsMsg")?$("#VIS_commentsMsg"+y).prepend(i):$("#VIS_commentsdata"+y).prepend(i)}}})}this.init=function(){e=$('<div class="VIS-testPanel VIS-HistGrd-data" id="VIS_HistoryGrd'+this.windowNo+'" ></div>'),t=$('<div id="VIS_recordDetail'+this.windowNo+'" style="display:none;" class="VIS-tp-detailsPanel"></div>'),r.prepend(e),s=$('<div id="VIS_pagingHtml'+this.windowNo+'" class="vis-ad-w-p-s-pages VIS-root-pagingHtml"><ul class="vis-ad-w-p-s-plst w-100"><li class="flex-fill"><div id="VIS_pagingText'+this.windowNo+'" class="vis-ad-w-p-s-result"><span class="vis-ad-w-p-s-statusdb" id="VIS_pageIndx'+y+'">0/0</span><span>Showing Result 0-0 of 0</span></div></li><li id="VIS_prevPage'+this.windowNo+'" style="opacity: 1;"><div ><i class="vis vis-pageup" title="Page Up(Alt+ Pg Up)" })="" style="opacity: 1;"></i></div></li><li><select id="VIS_ddlPages'+this.windowNo+'" class="vis-statusbar-combo"><option></option></select></li><li id="VIS_nextPage'+this.windowNo+'" style="opacity: 1;"><div ><i class="vis vis-pagedown" title="Page Down(Alt+ Pg Dn)" })="" style="opacity: 1;"></i></div></li></div></ul></div>'),$('<div id="VIS_viewMoreComments'+this.windowNo+'" style="display:none;" class="VIS-tp-commentsPanel"></div>'),r.append(s),r.append(t),y=this.windowNo,D()},this.getRoot=function(){return r},this.update=function(e){h=e,b(e,m=this.table_ID),_(e,0,this.windowNo,m)},this.disposeComponent=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,_gridCtrl=null,r.remove(),r=null,y=0}}e.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init(),window_No=e,this.table_ID=t.getAD_Table_ID()},e.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.update(e)},e.prototype.sizeChanged=function(e){this.panelWidth=e},e.prototype.dispose=function(){this.disposeComponent()},VIS.HistoryDetailsTabPanel=e}()},4565:()=>{VIS=window.VIS||{},function(){function e(){var e,t;this.record_ID=0,this.windowNo=0,this.curTab=null,this.selectedRow=null,this.panelWidth,this.extraInfo=null,this.init=function(){if(e=$('<div style="height:100%;width:100%"></div>'),window.VA037)t=$('<iframe height=100%; width="100%"; frameborder="0" ></iframe>'),e.html(t);else{var i=$('<span class="vis-bi-tab-panel">'+VIS.Msg.getMsg("PleaseInstallBIReportTool")+"</span>");e.append(i)}},this.update=function(e){n(e)},this.getRoot=function(){return e};var i=this,n=function(e){if(t){var n=i.extraInfo,a=n.match(/\@.+?\@/g);if(a)for(var s=0;s<a.length;s++){var l=a[s].replaceAll("@","");VIS.Env.getCtx().getContext(l).length>0?l=VIS.Env.getCtx().getContext(l):VIS.Env.getCtx().getContext(i.windowNo,l).length>0?l=VIS.Env.getCtx().getContext(i.windowNo,l):VIS.Env.getCtx().getContext(i.windowNo,i.curTab().getTabNo(),l).length>0&&(l=VIS.Env.getCtx().getContext(i.windowNo,i.curTab().getTabNo(),l)),n=n.replaceAll(a[s],l)}var o=VIS.Application.contextUrl+"BiPanel/GetUserBILogin?recID="+e+"&extraInfo="+window.encodeURIComponent(n);t.prop("src",o)}};this.disposeComponent=function(){t&&t.remove(),e.remove(),t=null,e=null}}e.prototype.startPanel=function(e,t,i){this.windowNo=e,this.curTab=t,this.extraInfo=i,this.init()},e.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.update(e)},e.prototype.sizeChanged=function(e){this.panelWidth=e},e.prototype.dispose=function(){this.disposeComponent()},VIS.BiPanel=e}()},1140:()=>{VIS=window.VIS||{},function(){function e(){this.record_ID=0,this.windowNo=99999,this.curTab=null,this.selectedRow=null,this.panelWidth,this.extraInfo=null,this.isCheckListFill=!1;var e,t,i=this,n=null,a=null,s=0,l=0,o=0,r=0,d=!1,c=0,p=0,u=0,g=0,h=0,v={},f=0,m=!0,y=null,I='<a href="javascript:;">'+VIS.Msg.getMsg("VIS_ClickHere")+"</a>",D=$('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"></i></div></div>'),w=function(e){D.css("display",e?"block":"none")},b=null,C=null;function _(t,l,D,_){var A,T="width: calc(100% - 35px);height: calc(100% - 71px);position: absolute;";i.curTab&&i.curTab.getIsTPBottomAligned()&&(T="");var V='<div class="VIS_SI_Main'+i.windowNo+'" style="'+T+'"><div class="vis-tp-mainContainer"> <ol class="list-unstyled vis-tp-orderListWrap"> ';if("CL"==l){if(t.length>0)for(var N=0;N<t.length;N++)V+='<li class="VIS_SI_'+t[N].Item.AD_SurveyItem_ID+' align-items-center d-flex mb-3 pb-3 vis-tp-listItem"><h6 class="mr-2 mb-0" style="min-width:15px;text-algin:right">'+(N+1)+'.</h6><input class="VIS_Answ_'+i.windowNo+'" data-id="VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+'" data-surveyitem='+t[N].Item.AD_SurveyItem_ID+' data-surveyvalue="0" data-survey='+t[N].Item.AD_Survey_ID+' type= "checkbox" ><p class="VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+'" data-qtype="'+l+'" data-mandatory="'+t[N].Item.IsMandatory+'">'+t[N].Item.Question,(d||"Y"==t[N].Item.IsMandatory)&&(V+='<sub style="color:red;font-size: 100%;bottom: unset;">*</sub>'),V+="</p></li>";V+="</ol>"}else{if(t.length>0)for(N=0;N<t.length;N++)if("CB"==t[N].Item.AnswerType){V+='<li class="mb-3"> <h6 data-qtype="'+t[N].Item.AnswerType+'" data-mandatory="'+t[N].Item.IsMandatory+'" class= "VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+' mb-3 vis-tp-qus ml"> '+(N+1)+". "+t[N].Item.Question,(d||"Y"==t[N].Item.IsMandatory)&&(V+='<sub style="color:red;font-size: 100%;bottom: unset;">*</sub>'),V+='</h6 > <div class="vis-tp-listWrap"> ';for(var M=0;M<t[N].Values.length;M++)V+=' <div class="VIS_SI_'+t[N].Values[M].AD_SurveyValue_ID+' align-items-center d-flex mb-3 vis-tp-listItem">  <input  data-id="VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+'"',"SL"==t[N].Item.AnswerSelection?V+=' class="VIS_Answ_'+t[N].Values[M].AD_SurveyValue_ID+" group_"+t[N].Item.AD_SurveyItem_ID+'" ':V+=' class="VIS_Answ_'+t[N].Values[M].AD_SurveyValue_ID+'"',V+=" data-surveyitem="+t[N].Item.AD_SurveyItem_ID+" data-surveyvalue="+t[N].Values[M].AD_SurveyValue_ID+"  data-survey="+t[N].Item.AD_Survey_ID+' value="'+t[N].Values[M].Answer+'" type="checkbox"> <p>'+t[N].Values[M].Answer+"</p> </div>";V+="</div> </li > "}else if("OP"==t[N].Item.AnswerType){V+='<li class="mb-3"> <h6 data-qtype='+t[N].Item.AnswerType+' data-mandatory="'+t[N].Item.IsMandatory+'" class="VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+' mb-3 vis-tp-qus">'+(N+1)+". "+t[N].Item.Question,(d||"Y"==t[N].Item.IsMandatory)&&(V+='<sub style="color:red;font-size: 100%;bottom: unset;">*</sub>'),V+='</h6 > <div class="vis-tp-listWrap"> ';for(M=0;M<t[N].Values.length;M++)V+='<div  class=" VIS_SI_'+t[N].Values[M].AD_SurveyValue_ID+' align-items-center d-flex mb-3 vis-tp-listItem"> <input type="radio" name=VIS_'+t[N].Item.AD_SurveyItem_ID+" data-id=VIS_Quest_"+t[N].Item.AD_SurveyItem_ID+" data-surveyitem="+t[N].Item.AD_SurveyItem_ID+" data-surveyvalue="+t[N].Values[M].AD_SurveyValue_ID+" data-survey="+t[N].Item.AD_Survey_ID+' class = "VIS_Answ_'+t[N].Values[M].AD_SurveyValue_ID+'" value="'+t[N].Values[M].Answer+'" > <p>'+t[N].Values[M].Answer+"</p></div>";V+="</div></li > "}else"TX"==t[N].Item.AnswerType&&(V+='<li class="mb-3"> <h6 data-qtype='+t[N].Item.AnswerType+' data-mandatory="'+t[N].Item.IsMandatory+'" class="VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+' mb-3 vis-tp-qus ml">'+(N+1)+". "+t[N].Item.Question,(d||"Y"==t[N].Item.IsMandatory)&&(V+='<sub style="color:red;font-size: 100%;bottom: unset;">*</sub>'),V+='</h6 > <textarea class="VIS_Answ_'+t[N].Item.AD_SurveyItem_ID+'" data-id=VIS_Quest_'+t[N].Item.AD_SurveyItem_ID+" data-surveyitem="+t[N].Item.AD_SurveyItem_ID+' data-surveyvalue="0" data-survey='+t[N].Item.AD_Survey_ID+'  cols="30" rows="10" placeholder="Enter your text here"></textarea> </li > ');V+="</ol > "}if(V+="</div ></div > ",A=$(V),0==r&&(a.find(".response").append(A.clone(!0).removeAttr("style")),a.find("input,textarea").attr("disabled","disabled")),p>0&&h>=p)n.hide(),e.find("#quesMessage_"+i.windowNo).html(VIS.Msg.getMsg("VIS_AlreadySubmittedResponse")),e.find("#quesMessage_"+i.windowNo).removeClass("vis-displayNone");else{n.append(A);var k=n.find(".VIS_SI_Main"+i.windowNo),O="bottom: 0px;position: absolute;width: calc(100% - 35px);";i.curTab&&i.curTab.getIsTPBottomAligned()&&(O="bottom: 0px;position: absolute;width: calc(100% - 10px);");var L='<div class="vis-survey" style="'+O+'">',R=k.find("[class^=VIS_Quest_]").length;c>0&&R>c&&(L+='<div class="'+(VIS.Application.isRTL?" float-right":" float-left")+'"><a class="prev btn mr-2"><i class="fa fa-chevron-'+(VIS.Application.isRTL?"right":"left")+'" aria-hidden="true"></i> '+VIS.Msg.getMsg("VIS_Prev")+"</a></div>"),L+='<div style="padding-bottom: 10px;" class="vis-tp-btnWrap'+(VIS.Application.isRTL?" float-left":" float-right")+'" > <a class="next btn">'+VIS.Msg.getMsg("VIS_Next")+' <i class="fa fa-chevron-'+(VIS.Application.isRTL?"left":"right")+'" aria-hidden="true"></i></a><a href="#" id="VIS_SI_BtnSubmit_'+i.windowNo+'" class="btn" >'+VIS.Msg.getMsg("VIS_Submit")+"</a> </div >",L+="<div>",n.append(L),c>0&&R>c&&n.find(".vis-tp-orderListWrap li:gt("+(c-1)+")").addClass("hideQuestion"),h>0&&(n.hide(),e.find("#quesMessage_"+i.windowNo).html('<span class="d-block px-2 text-center w-100">'+VIS.Msg.getMsg("VIS_SubmitAgain")+" "+I+"</span>"),e.find("#quesMessage_"+i.windowNo).removeClass("vis-displayNone"),e.find("#quesMessage_"+i.windowNo+" a").click((function(){n.show(),e.find("#quesMessage_"+i.windowNo).addClass("vis-displayNone"),n.find(".vis-tp-orderListWrap li").removeClass("hideQuestion"),n.find(".vis-tp-orderListWrap li:gt("+(c-1)+")").addClass("hideQuestion"),x()})))}if(0!=r)return 0==r?n.css("height",b):n.css("height","74vh"),y.find(".respTab").hide(),void y.find(".quesTab").hide();!function(t){v={},f=0,w(!0),$.ajax({url:VIS.Application.contextUrl+"VIS/SurveyPanel/CheckResponseAccess",data:{AD_Survey_ID:t,AD_SurveyAssignment_ID:u,AD_User_ID:VIS.context.getAD_User_ID(),AD_Role_ID:VIS.context.getAD_Role_ID(),Record_ID:i.record_ID,AD_window_ID:s,AD_Table_ID:o,IsSelfShow:m},success:function(t){w(!1);var s=[];if(!(null!=(s=JSON.parse(t))&&s.length>0))return 0==r?n.css("height",b):n.css("height","74vh"),y.find(".respTab").hide(),void y.find(".quesTab").hide();var l=0;y.find(".respTab").show(),y.find(".quesTab").show(),m?n.css("height",C):n.css("height",b),y.find(".responseCount").text(s.length);for(var o=0;o<s.length;o++)v["U"+s[o].User_ID]||(v["U"+s[o].User_ID]=[]),v["U"+s[o].User_ID].push({id:s[o].AD_SurveyResponse_ID,Created:new Date(s[o].Created).toLocaleString()}),a.find('select option[value="'+s[o].User_ID+'"]').length>0||("Self"==s[o].Name&&0==l?(l++,a.find("select").append('<option selected value="'+s[o].User_ID+'">'+s[o].Name+"</option>")):a.find("select").append('<option value="'+s[o].User_ID+'" >'+s[o].Name+"</option>"));var d=VIS.context.getAD_User_ID();if(v["U"+d]){g=v["U"+d][0].id,v["U"+d].length>1?(a.find(".next").removeAttr("disabled"),a.find(".prev").attr("disabled","disabled")):(a.find(".prev").attr("disabled","disabled"),a.find(".next").attr("disabled","disabled")),a.find(".resStatus").text("1/"+v["U"+d].length),a.find(".submittedDate").text(v["U"+d][0].Created);var u=!0;p>0&&v["U"+d].length>=p&&(n.hide(),e.find("#quesMessage_"+i.windowNo).html(VIS.Msg.getMsg("VIS_AlreadySubmittedResponse")),e.find("#quesMessage_"+i.windowNo).removeClass("vis-displayNone"),u=!1),u&&v["U"+d].length>0&&(n.hide(),e.find("#quesMessage_"+i.windowNo).html('<span class="d-block px-2 text-center w-100">'+VIS.Msg.getMsg("VIS_SubmitAgain")+" "+I+"</span>"),e.find("#quesMessage_"+i.windowNo).removeClass("vis-displayNone"),e.find("#quesMessage_"+i.windowNo+" a").click((function(){n.show(),e.find("#quesMessage_"+i.windowNo).addClass("vis-displayNone"),n.find(".vis-tp-orderListWrap li").removeClass("hideQuestion"),n.find(".vis-tp-orderListWrap li:gt("+(c-1)+")").addClass("hideQuestion"),x()}))),0==r&&S(d)}else a.find("select option:selected").change()},error:function(e){w(!1)}})}(_)}function S(e){a.find("input").prop("checked",!1),a.find("textarea").val(""),w(!0),$.ajax({url:VIS.Application.contextUrl+"VIS/SurveyPanel/GetResponseList",data:{AD_window_ID:s,AD_Table_ID:o,Record_ID:i.record_ID,AD_User_ID:e,AD_SurveyResponse_ID:g},success:function(e){var t;if(null!=(t=JSON.parse(e))&&t.length>0)for(var i=0;i<t.length;i++)"TX"==t[i].AnswerType?a.find('[data-surveyitem="'+t[i].AD_SurveyItem_ID+'"][data-surveyvalue="'+t[i].AD_SurveyValue_ID+'"]').val(t[i].Answer):a.find('[data-surveyitem="'+t[i].AD_SurveyItem_ID+'"][data-surveyvalue="'+t[i].AD_SurveyValue_ID+'"]').prop("checked",!0);w(!1)},error:function(e){w(!1)}})}function x(){n.find(".vis-tp-orderListWrap li:last").is(":hidden")?($btnSubmit.hide(),n.find(".next").show()):($btnSubmit.show(),n.find(".next").hide()),n.find(".vis-tp-orderListWrap li:first").is(":hidden")?n.find(".prev").show():n.find(".prev").hide(),n.find(".vis-tp-orderListWrap").scrollTop(0)}this.init=function(){w(!1),e=$("<div></div>").append(D),b=VIS.Env.getScreenHeight()-230,i.curTab.getIsHeaderPanel()&&(b=b-VIS.Utility.Util.getValueOfInt(i.curTab.getHeaderHeight().replace("px"," "))-10),(!b||b<0)&&(b=$(".divWorkflowActivity").height()-19),b?(C=b-38+"px",b+="px"):(b="100%",C="100%");var t=$('<div class="vis-surveyTab"><div class="vis-tabPrimary"><ul class="nav vis-primarySection nav-tabs mb-1" id="surveyTab_'+i.windowNo+'" role="tablist"><li class="nav-item vis-firstResLink  text-center ">  <a    class="nav-link active quesTab text-center"    id="home-tab"    data-toggle="tab"    href="#quesSec_'+i.windowNo+'"    >'+VIS.Msg.getMsg("VIS_Questions")+'</a></li><li class="nav-item text-center" >  <a style="display:none"    class="nav-link respTab text-center"    id="profile-tab"    data-toggle="tab"    href="#resp_'+i.windowNo+'"    >'+VIS.Msg.getMsg("Response")+'<span class="badge badge-light responseCount'+(VIS.Application.isRTL?" mr-1":" ml-1")+'">0</span></a></li></ul><div class="tab-content"><div class="tab-pane fade show active" style="width:100%;" id="quesSec_'+i.windowNo+'"><div class="align-items-center d-flex justify-content-center vis-displayNone" style="height:'+C+'" id="quesMessage_'+i.windowNo+'"></div><div style="height:'+C+';overflow-y:auto !important;" id="ques_'+i.windowNo+'"></div></div><div class="tab-pane fade mt-2" style="height:'+C+';width:100%;overflow:auto !important;" id="resp_'+i.windowNo+'"><div class="d-flex align-items-center justify-content-between mr-2 ml-2"><div class="d-flex align-items-center '+(VIS.Application.isRTL?" ml-1":" mr-1")+'"><span class="d-inline-block '+(VIS.Application.isRTL?" ml-1":" mr-1")+'">'+VIS.Msg.getMsg("SelectUser")+'</span><select class="w-100"></select></div> <div class="align-items-center d-flex"> <span class="'+(VIS.Application.isRTL?"ml-1":"mr-1")+' ">'+VIS.Msg.getMsg("Response")+':</span><span class="align-items-center d-flex"><button class="vis-cusPagination prev"><i class="fa fa-chevron-circle-'+(VIS.Application.isRTL?"right ml-1":"left mr-1")+' " aria-hidden="true"></i></button><span class="resStatus vis-surveyPagination">0/0</span class="d-flex align-items-center"><button class="vis-cusPagination next"><i class="fa fa-chevron-circle-'+(VIS.Application.isRTL?"left mr-1":"right ml-1")+'" aria-hidden="true"></i></button></span></div></div> <div class="'+(VIS.Application.isRTL?"text-left ml-2":"text-right mr-2")+' mt-2"  style="font-size: 12px;font-style: italic;" >'+VIS.Msg.getMsg("VIS_Submitted")+': <span class="submittedDate"></span></div><div class="response"></div></div > </div></div></div>');e.append(t),y=e.find("#surveyTab_"+i.windowNo),n=e.find("#ques_"+i.windowNo),a=e.find("#resp_"+i.windowNo)},this.update=function(t){if(i.isCheckListFill){if(t<0)return!1;i.SaveData(t)}else i.panelDetails(this.curTab.vo.AD_Window_ID,this.curTab.vo.AD_Tab_ID,this.curTab.getAD_Table_ID(),t,e,0)},this.setisCheckListFill=function(e){this.isCheckListFill=e},this.panelDetails=function(e,t,y,I,D,b){i.isCheckListFill=!1,i.record_ID=I,s=e,l=t,o=y,r=b,n.empty(),D.find(".vis-surveyTab .vis-primarySection").show(),D.find("#quesMessage_"+i.windowNo).addClass("vis-displayNone"),a.find(".response").empty(),d=!1,c=0,f=0,p=0,w(!0),$.ajax({url:VIS.Application.contextUrl+"VIS/SurveyPanel/GetSurveyAssignments",data:{AD_window_ID:e,AD_Tab_ID:t,AD_Table_ID:y,AD_Record_ID:i.record_ID,AD_WF_Activity_ID:r},success:function(e){w(!1);var t,s,l,o;null!=(t=JSON.parse(e))&&t.length>0?(d=t[0].IsMandatory,c=t[0].QuestionsPerPage,m=t[0].IsSelfshow,p=t[0].Limit,h=t[0].ResponseCount,u=t[0].SurveyAssignment_ID,g=t[0].SurveyResponse_ID,s=t[0].Survey_ID,l=t[0].SurveyType,o=D,w(!0),$.ajax({url:VIS.Application.contextUrl+"VIS/SurveyPanel/GetSurveyItems",data:{AD_Survey_ID:s},success:function(e){w(!1);var t=[];null!=(t=JSON.parse(e))&&(_(t,l,o,s),$mainDiv=n.find(".VIS_SI_Main"+i.windowNo),$btnSubmit=n.find("#VIS_SI_BtnSubmit_"+i.windowNo),$btnSubmit.off().on("click",(function(e){i.SaveData(i.record_ID)})),n.find("[class*=group_]").off().click((function(){$(this).next().attr("data-qtype")&&"CL"==$(this).next().attr("data-qtype")||function(e,t){for(var i=n[0].getElementsByClassName(t),a=0;a<i.length;a++)i[a]==e||(i[a].checked=!1)}(this,"group_"+$(this).data("surveyitem"))})),n.find(".next").off().click((function(){var e=n.find(".vis-tp-orderListWrap").children("li:visible:last");e.nextAll(":lt("+c+")").removeClass("hideQuestion"),e.next().prevAll().addClass("hideQuestion"),x()})),n.find(".prev").off().click((function(){var e=n.find(".vis-tp-orderListWrap").children("li:visible:first");e.prevAll(":lt("+c+")").removeClass("hideQuestion"),e.prev().nextAll().addClass("hideQuestion"),x()})),a.find("select").off().change((function(){f=0;var e=a.find("select option:selected").val();g=v["U"+e][0].id,a.find(".submittedDate").text(v["U"+e][0].Created),a.find(".resStatus").text(f+1+"/"+v["U"+e].length),1==v["U"+e].length?(a.find(".next").attr("disabled","disabled"),a.find(".prev").attr("disabled","disabled")):(a.find(".next").removeAttr("disabled"),a.find(".prev").attr("disabled","disabled")),S(e)})),a.find(".next").off().click((function(){f++;var e=a.find("select option:selected").val();g=v["U"+e][f].id,a.find(".submittedDate").text(v["U"+e][f].Created),f>=v["U"+e].length-1&&$(this).attr("disabled","disabled"),a.find(".prev").removeAttr("disabled"),a.find(".resStatus").text(f+1+"/"+v["U"+e].length),S(e)})),a.find(".prev").off().click((function(){f--;var e=a.find("select option:selected").val();g=v["U"+e][f].id,a.find(".submittedDate").text(v["U"+e][f].Created),0==f&&$(this).attr("disabled","disabled"),a.find(".next").removeAttr("disabled"),a.find(".resStatus").text(f+1+"/"+v["U"+e].length),S(e)})),x())},error:function(e){w(!1)}})):r>0&&(D.find(".vis-surveyTab .vis-primarySection").hide(),D.find("#quesMessage_"+i.windowNo).html(VIS.Msg.getMsg("VIS_NoCheckListFound")),D.find("#quesMessage_"+i.windowNo).removeClass("vis-displayNone"))},error:function(e){w(!1)}})},this.getRoot=function(){return e},this.SaveData=function(t){w(!0);for(var a=n.find(".VIS_SI_Main"+i.windowNo),c=(a.find("[class^=VIS_Answ_]"),a.find("[class^=VIS_Quest_]")),p={Questions:[]},u=0,g=0;g<c.length;g++){var h=!0,v=n.find('[data-id="'+c[g].classList[0]+'"]');if(u=v[0].dataset.survey,"CB"==c[g].dataset.qtype||"OP"==c[g].dataset.qtype||"CL"==c[g].dataset.qtype){if(v.length>0){for(var f=0;f<v.length;f++)$(v[f]).is(":checked")&&(h=!1,p.Questions.push({Question:c[g].textContent,Answer:$(v[f]).val(),AD_SurveyItem_ID:v[f].dataset.surveyitem,AD_SurveyValue_ID:v[f].dataset.surveyvalue}));if((d||"Y"==c[g].dataset.mandatory)&&h)return VIS.ADialog.error("FillMandatory",!0,"Ques-"+(g+1)),void w(!1)}}else if("TX"==c[g].dataset.qtype&&($(v[0]).val().length>0&&(h=!1),p.Questions.push({Question:c[g].textContent,Answer:$(v[0]).val(),AD_SurveyItem_ID:v[0].dataset.surveyitem,AD_SurveyValue_ID:v[0].dataset.surveyvalue}),(d||"Y"==c[g].dataset.mandatory)&&h))return VIS.ADialog.error("FillMandatory",!0,"Ques-"+(g+1)),void w(!1)}if(0==r&&t<=0&&p.Questions.length>0)return i.isCheckListFill=!0,toastr.success(VIS.Msg.getMsg("CheckWillAutoSaveAfterNewRecordSave"),"",{timeOut:3e3,positionClass:"toast-top-right",closeButton:!0}),void w(!1);i.isCheckListFill=!1,$.ajax({type:"POST",url:VIS.Application.contextUrl+"VIS/SurveyPanel/SaveSurveyResponse",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({surveyResponseValue:p.Questions,AD_Window_ID:s,AD_Survey_ID:u,AD_Tab_ID:l,Record_ID:t,AD_Table_ID:o,AD_WF_Activity_ID:r}),success:function(t){n.find("input").prop("checked",!1),n.find("textarea").val(""),toastr.success(VIS.Msg.getMsg("CheckListSaved"),"",{timeOut:3e3,positionClass:"toast-top-right",closeButton:!0}),i.isCheckListFill=!1,0==r?i.update(i.record_ID):i.panelDetails(s,l,o,i.record_ID,e,r),w(!1)},error:function(e){w(!1)}})},this.disposeComponent=function(){t&&t.remove(),e.remove(),t=null,e=null}}e.prototype.startPanel=function(e,t,i){this.windowNo=e,this.curTab=t,this.extraInfo=i,this.init()},e.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.update(e)},e.prototype.sizeChanged=function(e){this.panelWidth=e},e.prototype.dispose=function(){this.disposeComponent()},VIS.SurveyPanel=e}()},5069:()=>{VIS=window.VIS||{},function(){function e(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.selectedRow=null,this.panelWidth;var e=$('<div class="vis-mas-verinf-wrap"></div>'),t=null;this.init=function(){var i='<div class="vis-mas-verinf-hdrCtr"><div class="vis-mas-verinf-hdrsLft">'+VIS.Msg.getMsg("FieldName")+'</div><div class="vis-mas-verinf-hdrsRgt">'+VIS.Msg.getMsg("OldValue")+'</div></div><div class="vis-mas-verinf-CngCtr"></div>';e.append(i),t=e.find(".vis-mas-verinf-CngCtr")},this.getRoot=function(){return e},this.update=function(e){try{if(this.selectedRow.recordversion>1){this.selectedRow.RID=this.record_ID,this.selectedRow.TName=this.curTab.vo.TableName,this.selectedRow.TabID=this.curTab.vo.AD_Tab_ID,this.selectedRow.TblID=this.curTab.vo.AD_Table_ID;var i=this;$.ajax({type:"POST",async:!0,url:VIS.Application.contextUrl+"JsonData/GetVerInfo",contentType:"application/json; charset=utf-8",data:"{ 'RowData': '"+JSON.stringify(this.selectedRow)+"' }",success:function(e){i.curTab;if(t.empty(),e){var n=JSON.parse(e);if(n.ColumnNames&&n.ColumnNames.length>0){for(var a=new Array,s=0;s<n.ColumnNames.length;s++){var l=10;try{l=$.grep(i.curTab.gridTable.gTable.m_fields,(function(e){return e._vo.ColumnName==n.DBColNames[s]}))[0]._vo.displayType}catch(e){l=10}var o=n.OldVals[s];15==l?o=Globalize.format(new Date(o),"d"):16==l?o=Globalize.format(new Date(o+"Z"),"f"):24==l&&(o=Globalize.format(new Date(o+"Z"),"t")),""==n.OldVals[s]&&(o="&nbsp"),a.push('<div class="vis-mas-verinf-cntCtr"><div class="vis-mas-verinf-cnt">'+n.ColumnNames[s]+'</div><div class="vis-mas-verinf-cnt">'+o+"</div></div>")}t.append(a.join(" "))}}},error:function(e){}})}else 1==this.selectedRow.recordversion?(t.empty(),t.append('<div class="vis-mas-verinf-newrecord">'+VIS.Msg.getMsg("FirstVersion")+"</div>")):(t.empty(),t.append('<div class="vis-mas-verinf-newrecord">'+VIS.Msg.getMsg("NoVersionsFound")+"</div>"))}catch(e){}},this.disposeComponent=function(){this.record_ID=0,this.windowNo=0,this.curTab=null,this.rowSource=null,this.panelWidth=null,e.remove(),e=null}}e.prototype.startPanel=function(e,t){this.windowNo=e,this.curTab=t,this.init()},e.prototype.refreshPanelData=function(e,t){this.record_ID=e,this.selectedRow=t,this.update(e)},e.prototype.sizeChanged=function(e,t){this.panelWidth=t},e.prototype.dispose=function(){this.disposeComponent()},VIS.verinfo=e}()}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";n(9192),n(7063),n(907),n(6581),n(6451),n(1105),n(1511),n(4144),n(4011),n(9407),n(8716),n(6649),n(3745),n(103),n(9508),n(3289),n(453),n(2766),n(6119),n(6216),n(8281),n(6288),n(9659),n(8225),n(9009),n(2857),n(2512),n(7511),n(7950),n(935),n(3652),n(7984),n(5307),n(9589),n(3953),n(4869),n(9740),n(3158),n(2640),n(3698),n(3213),n(7350),n(6893),n(3547),n(3952),n(5851),n(6393),n(297),n(2421),n(3022),n(5344),n(8448),n(7358),n(6674),n(8037),n(2109),n(7053),n(2502),n(9221),n(7931),n(2869),n(5028),n(1634),n(2972),n(4412),n(2604),n(8106),n(5097),n(5814),n(1087),n(9849),n(3975),n(1409),n(2280),n(291),n(6094),n(6135),n(6949),n(792),n(9468),n(4831),n(1867),n(5887),n(5710),n(4058),n(589),n(4340),n(8073),n(3338),n(789),n(4565),n(8111),n(5151),n(5069),n(931),n(1140),n(2105),n(161),n(2839),n(7849),n(5162)})()})();