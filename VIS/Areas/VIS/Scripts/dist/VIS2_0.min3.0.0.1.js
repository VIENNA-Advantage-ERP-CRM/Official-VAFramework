(()=>{var e={4072:()=>{!function(e,t){function i(i,a){this.aTabbedPane=i;var s=a;this.tabLIObj=[],this.tabItems=[],this.tabIds=[],this.tabs=[],this.headerTab=null,this.aNew=null,this.aSave=null,this.aDelete=null,this.aRefresh=null;var n=null,o=null,r=null,l=null,d=null,c=null,h=null,u=this;function p(e){e?s.css("display","none"):s.css("display","flex")}n=s.find(".vis-ad-w-p-t-c-inc-tc"),o=s.find(".vis-ad-w-p-t-c-inc"),r=s.find(".vis-ad-w-p-inc-tabs-oflow").hide(),s.find(".vis-ad-w-p-inc-tabs"),s.css("display","flex"),l=s.find(".vis-ad-w-p-inc-content"),d=s.find(".vis-ad-w-p-inc-tb-lc"),c=s.find(".vis-ad-w-p-inc-tab-a-list"),h=s.find(".vis-ad-w-p-inc-tab-ac-buttons");var g=function(e){u.actionPerformed(e)};r.on("click",(function(e){e.stopPropagation();var i=t(e.target).data("dir");if(i){var a=o.width(),s=n.width(),r=o.scrollLeft(),l=Math.ceil(a/2),d=0;if("r"==i){if(r+l>=s-l)return;var c=s-a;d=r+l,o.animate({scrollLeft:d>c?c:d},1e3)}else if("b"==i){if(0==r)return;d=r-l,o.animate({scrollLeft:d<0?0:d},1e3)}if("rl"==i){if(r+l>=s-l)return;c=s-a;o.animate({scrollLeft:c},500)}else if("bf"==i){if(0==r)return;d=r-l,o.animate({scrollLeft:0},500)}}})),this.setTabControl=function(e){if(this.resetListners(),this.headerTab=e,n.empty(),0!=e.ChildTabsItems.length){p();for(var t=0;t<e.ChildTabsItems.length;t++){var i=e.ChildTabsItems[t],a=i.getListItm();this.tabLIObj[i.action]=a,n.append(a),i.setEnabled(!1),i.onAction=null,e.TabLevel+1>=e.ChildTabs[t].getTabLevel()&&(i.onAction=this.onTabChange,i.setEnabled(!0)),e.ChildEle[t].addSubTabDataStatusListner(this),this.tabItems.push(e.ChildEle[t]),this.tabIds.push(i.getAction()),this.tabs.push(i),0==t&&(this.selectedTab=a)}}else p(!0)},this.setSelectedTab=function(e){this.selectedTab&&this.selectedTab.removeClass("vis-apanel-tab-selected"),this.selectedTab=this.tabLIObj[e],this.selectedTab.addClass("vis-apanel-tab-selected")},this.onTabChange=function(e){u.tabActionPerformed(e)},this.getLayout=function(){return l},this.setTabNavigation=function(){n.width()>o.width()?e.Application.isMobile||r.show():r.hide()},this.createToolBar=function(){var e=this.aTabbedPane.getAPanel();this.aRefresh=e.addActions(e.ACTION_NAME_REFRESH,null,!0,!0,!1,g,null,"Shct_CV_Refresh","Refresh"),this.aDelete=e.addActions(e.ACTION_NAME_DELETE,null,!0,!0,!1,g,null,"Shct_CV_Delete","Delete"),this.aNew=e.addActions(e.ACTION_NAME_NEW,null,!0,!0,!1,g,null,"Shct_CV_New","New"),this.aIgnore=e.addActions("UNO",null,!0,!0,!1,g,null,"Shct_CV_Ignore","Ignore"),this.aSave=e.addActions("SAR",null,!0,!0,!1,g,null,"Shct_CV_Save","Save"),this.aMulti=e.addActions("Multi",null,!1,!0,!0,g,!0,"Shct_CV_MultiRow"),d.append(this.aIgnore.getListItm()),d.append(this.aNew.getListItm()),d.append(this.aDelete.getListItm()),d.append(this.aSave.getListItm()),d.append(this.aRefresh.getListItm()),d.append(this.aMulti.getListItm())},this.createToolBar(),this.finishLayout=function(){e.Application.isMobile||o.addClass("vis-ad-w-p-t-c-mob")},this.setDynamicActions=function(e,t){if(h.css("display","none"),null!=e)if(t)e.detachDynamicAction();else{var i=0,a=[];if(e.leftPaneLinkItems.length>0)for(a=this.curGC.leftPaneLinkItems,i=0;i<a.length;i++)c.append(a[i].getControl());if(i=0,e.rightPaneLinkItems.length>0)for(a=this.curGC.rightPaneLinkItems,i=0;i<a.length;i++)c.append(a[i].getControl());(e.leftPaneLinkItems.length>0||e.rightPaneLinkItems.length>0)&&(h.css("display","flex"),h.find("span").show()),a=null}},this.disposeComponents=function(){u=null,s.remove(),$ulToobar=$ulNav=s=n=o=r=null,c=h=null}}i.prototype.resetListners=function(){for(var e=0;e<this.tabItems.length;e++)this.tabItems[e].removeSubTabDataStatusListner();this.tabLIObj=[],this.tabItems=[],this.tabIds=[],this.tabs=[],this.setDynamicActions(this.curGC,!0),this.curST&&this.curST.setVisible(!1),this.curGC&&this.curGC.setVisible(!1),this.curST=this.curGC=null,this.curTabIndex=-1},i.prototype.getTabElement=function(e){return this.newTabIndex=this.tabIds.indexOf(e),this.tabItems[this.newTabIndex]},i.prototype.getIsZoomToHeader=function(e){return this.curTabIndex==this.tabIds.indexOf(e)},i.prototype.onParentTabChange=function(e){e=e.replace("st_",""),this.aTabbedPane.getAPanel().onTabChange(e)},i.prototype.tabActionPerformed=function(t){var i,a=!1,s=this.getTabElement(t),n=this.curST||this.curGC,o=null,r=this;i=this.newTabIndex<this.curTabIndex;var l=null,d=null;s instanceof e.VSortTab?(d=s,a=!0):l=s;var c=!0;if(null!=this.curGC){if(this.curTab.needSave(!0,!1))if(this.curTab.needSave(!0,!0))if(e.Env.getCtx().isAutoCommit(this.curWindowNo)){if(!this.curTab.dataSave(!0))return this.setBusy(!1,!0),!1}else c=!1,e.ADialog.confirm("SaveChanges?",!0,this.curTab.getCommitWarning(),"Confirm",(function(e){if(e){if(!r.curTab.dataSave(!0))return r.setBusy(!1,!0),!1}else r.curTab.dataIgnore();n=r.curGC,o=r.curGC,r.curGC=null,r.tabActionPerformedCallback(t,i,a,s,n,o,l,d)}));else r.curTab.dataIgnore();c&&(n=this.curGC,o=this.curGC,this.curGC=null)}return c&&null!=this.curST&&(this.curST.saveData(),n=this.curST,this.curST=null),c&&r.tabActionPerformedCallback(t,i,a,s,n,o,l,d),!0},i.prototype.sizeChanged=function(){this.setTabNavigation()},i.prototype.refresh=function(){this.curGC&&this.curGC.vTable.resize()},i.prototype.tabActionPerformedCallback=function(t,i,a,s,n,o,r,l){if(this.setDynamicActions(o,!0),this.getIsZoomToHeader(t))return console.log("zoom to parent tab"),this.onParentTabChange(t),!1;if(this.curTabIndex=this.newTabIndex,a)this.curST=l,l.loadData();else{if(this.curGC=r,r.activate(o),this.setDynamicActions(this.curGC),this.curTab=r.getMTab(),!r.isZoomAction&&this.curTab.getTabLevel()>0){var d=new e.Query;this.curTab.query=d}i&&this.curTab.getIsCurrent()?r.dataRefresh():this.reQuery()}a?(this.aMulti.setPressed(!1),this.aMulti.setEnabled(!1),this.aNew.setEnabled(!1),this.aDelete.setEnabled(!1),this.aRefresh.setEnabled(!1)):(this.aMulti.setEnabled(!0),this.aMulti.setPressed(this.curGC.getIsSingleRow()||this.curGC.getIsMapRow()),this.aRefresh.setEnabled(!0)),n&&(n.setVisible(!1),n.getRoot().detach()),this.getLayout().append(s.getRoot()),s.setVisible(!0),this.setSelectedTab(t),this.setTabNavigation(),n=s=null},i.prototype.reQuery=function(){this.curTabIndex<0&&this.tabs.length>0?this.onTabChange(this.tabs[0].getAction()):this.curGC&&(this.curTab.getTableModel().setCurrentPage(1),this.curGC.onDemandTree&&!this.curGC.isZoomAction||(this.curTab.searchText="",this.curGC.query(this.curTab.getOnlyCurrentDays(),0,!1)))},i.prototype.dataStatusChanged=function(t){if(t){$ths=this,t.getIsError()&&!t.getIsConfirmed()?(e.ADialogCallback.error(t.getAD_Message(),t.getInfo(),null,(function(){var e=$ths.curTab.getLastFocus();e&&(e.focus(),$ths.curTab.setLastFocus(null))})),t.setConfirmed(!0),this.errorDisplayed=!0):t.getIsWarning()&&!t.getIsConfirmed()&&(e.ADialog.warn(t.getAD_Message(),!0,t.getInfo()),t.setConfirmed(!0));var i=t.getIsChanged()||t.getIsInserting(),a=this.curTab.getIsReadOnly(),s=!a;s&&(s=this.curTab.getIsInsertRecord()),this.aNew.setEnabled(!i&&s),this.aRefresh.setEnabled(!i),this.aDelete.setEnabled(!i&&!a&&t.getCurrentRow()>-1),a&&this.curTab.getIsAlwaysUpdateField()&&(a=!1),this.aIgnore.setEnabled(i&&!a),this.aSave.setEnabled(i&&!a),0==t.getTotalRows()&&s&&(this.aNew.setEnabled(!0),this.aDelete.setEnabled(!1)),this.aMulti.setPressed(this.curGC.getIsSingleRow()||this.curGC.getIsMapRow()),this.curTab.getRecord_ID()<1&&this.aDelete.setEnabled(!1),this.evaluate(null),t.getIsInserting()||this.aTabbedPane.getAPanel().setStatusInfo()}else this.curGC&&this.curTab.needSave(!0,!1)&&this.curTab.needSave(!0,!0)&&this.curGC.dataIgnore(),this.reQuery()},i.prototype.actionPerformed=function(t){if(!this.getIsUILocked()){var i=this;setTimeout((function(){t.source instanceof e.Controls.VButton?i.actionButton(t.source)||i.setBusy(!1,!0):i.actionPerformedCallback(i,t)})),this.setBusy(!0)}},i.prototype.actionPerformedCallback=function(t,i){if(t.aMulti.getAction()===i)t.aMulti.setPressed(!t.curGC.getIsSingleRow()),t.curGC.switchRowPresentation();else if(t.aRefresh.getAction()===i)t.cmd_save(!1),t.curGC.dataRefreshAll();else if(t.aIgnore.getAction()===i)t.curGC.dataIgnore();else if(t.aSave.getAction()===i)t.cmd_save(!0);else if(t.aNew.getAction()===i)if(this.curGC.aPanel.curTab.needSave())e.ADialog.warn("VIS_SaveParentFirst");else{if(!t.curTab.getIsInsertRecord())return;t.curGC.dataNew(!1)}else t.aDelete.getAction()===i&&t.cmd_delete();t.setBusy(!1),t=null},i.prototype.cmd_save=function(t,i){if(null!=this.curST&&(t=!1),this.errorDisplayed=!1,null!=this.curST)return this.curST.saveData(),void this.aSave.setEnabled(!1);var a=!0;if(this.curTab.getCommitWarning().length>0&&this.curTab.needSave(!0,!1)){a=!1;var s=this;e.ADialog.confirm("SaveChanges?",!0,this.curTab.getCommitWarning(),"Confirm",(function(e){if(e){var i=s.curGC.dataSave(t);t&&!i&&s.errorDisplayed,t&&s.curGC.dynamicDisplay(-1)}})),i&&i(n)}if(a){var n=this.curGC.dataSave(t);return t&&!n&&this.errorDisplayed,t&&this.curGC.dynamicDisplay(-1),i&&i(n),n}},i.prototype.cmd_delete=function(){if(!this.curTab.getIsReadOnly()){var t=this.curGC.canDeleteRecords();if(t.length>0)e.ADialog.error("CannotDelete",!0," [ "+t.join(",")+"]");else{var i=this;e.ADialog.confirm("DeleteRecord?",!0,"","Confirm",(function(e){e&&i.curGC.dataDeleteAsync(),i=null}))}}},i.prototype.actionButton=function(e){this.aTabbedPane.getAPanel().actionButton(e,this)},i.prototype.keyDown=function(e){if(e.altKey&&e.ctrlKey&&this.curGC){var t=this.aNew.getIsEnabled();switch(e.keyCode){case 78:t&&this.actionPerformed(this.aNew.getAction());break;case 68:t&&this.actionPerformed(this.aDelete.getAction());break;case 81:t&&this.actionPerformed(this.aRefresh.getAction());break;case 83:this.actionPerformed(this.aSave.getAction());break;case 84:this.actionPerformed(this.aMulti.getAction());break;case 90:t||this.actionPerformed(this.aIgnore.getAction())}e.preventDefault(),e.stopPropagation()}},i.prototype.evaluate=function(t){for(var i=0;i<this.tabItems.length;i++){var a=this.tabItems[i];if(a instanceof e.GridController){var s=a,n=this.headerTab.TabLevel+1>=this.headerTab.ChildTabs[i].getTabLevel()&&s.getIsDisplayed();this.tabs[i].setEnabled(n)}}},i.prototype.setBusy=function(e){this.aTabbedPane.getAPanel().setBusy(e)},i.prototype.getIsUILocked=function(){this.aTabbedPane.getAPanel().getIsUILocked()},i.prototype.dispose=function(){this.disposeComponents(),this.aNew.dispose(),this.aSave.dispose(),this.aDelete.dispose(),this.aRefresh.dispose(),this.aPanel=null},e.ContentPane=i}(VIS,jQuery)},6863:()=>{!function(e,t){function i(i,a){var s,n,o,r=(s=i,' <div class="vis-fp-bodycontent vis-formouterwrpdiv">                                                      <div class="vis-fp-viwall" >                                                           <span>'+e.Msg.getMsg("ViewMore")+'</span>                                    </div>                                                                         <div class="vis-fp-datawrap">      <div class="vis-fp-static-ctrlwrp">                                           <div class="vis-fp-static-ctrlinnerwrp"></div>         </div>                                                                            <div class="vis-fp-custcolumns" id="accordion_'+s+'"">                         <div class="card">                                                                    <div class="card-header" style="cursor:pointer" data-toggle="collapse" href="#collapseOne_'+s+'">                                                             <span>'+e.Msg.getMsg("CustomCondition")+'</span>                                                   <a class="card-link" >                      <i class="vis vis-arrow-up"></i>                                              </a>                                                                          </div>                                                                            <div id="collapseOne_'+s+'"" class="collapse" data-parent="#accordion_'+s+'" >                 <div class="card-body">                                                               <div class="input-group vis-input-wrap">                                              <div class="vis-control-wrap">                                                        <select class="vis-fp-cols">                                                      </select>                                                                         <label class="vis-fp-lblcols">'+e.Msg.getMsg("Column")+'</label>                                  </div>                                                                        </div>                                                                            <div class="input-group vis-input-wrap">                                              <div class="vis-control-wrap">                                                        <select class="vis-fp-op">                                                        </select>                                                                         <label class="vis-fp-lblop">'+e.Msg.getMsg("Operator")+'</label>                                  </div>                                                                        </div>                                                                            <div class="vis-fp-valueone">                                                     </div>                                                                            <div class="vis-fp-valuetwo">                                                     </div>                                                                            <div class="vis-fp-valuethree">                                                   </div>                                                                            <div class="vis-fp-cc-addbtnwrp">                                                     <span class="vis-fp-cc-addbutton">'+e.Msg.getMsg("ADD")+'</span>                                  </div>                                                                        </div>                                                                        </div>                                                                        </div>                                                                            <div class="vis-fp-custcoltagswrp">                                                   <div class="vis-fp-custcoltag">                                                   </div>                                                                        </div>\x3c!-- vis-fp-custcoltagswrp --\x3e                                          </div>  </div>                                                                      </div>'),l=null,d=t(r),c=(d.find(".vis-fp-datawrap"),d.find(".vis-fp-static-ctrlwrp")),h=d.find(".vis-fp-static-ctrlinnerwrp"),u=d.find(".vis-fp-viwall"),p=t(u.find("span")[0]),g=d.find(".vis-fp-custcolumns"),f=g.find(".vis-fp-cols"),v=g.find(".vis-fp-op"),m=g.find("#drpDynamicOp_"+i),b=g.find(".vis-fp-cc-addbtnwrp"),y=g.find(".vis-fp-valueone"),T=g.find(".vis-fp-valuetwo"),C=g.find(".vis-fp-custcoltag");p.text(e.Msg.getMsg("ViewMore")),this.curGC=a,this.winNo=i,this.selectionfields=null,this.curTabfields=null,this.curTab=null,this.listOfFilterQueries=[],this.ctrlObjects={},this.getRoot=function(){return d},this.setLayout=function(){if(this.selectionfields&&this.selectionfields.length>0)for(var i=0;i<this.selectionfields.length;i++){var a,s,n=this.selectionfields[i],o={};if(e.DisplayType.IsLookup(n.getDisplayType())||e.DisplayType.ID==n.getDisplayType()){if((o=jQuery.extend(!0,{},n)).lookup=jQuery.extend(!0,{},n.lookup),!o.lookup||!o.lookup.initialize)continue;o.lookup.initialize()}else o=n;this.selectionfields[i]=o,(a=o.getIsKey()?new e.Controls.VNumTextBox(o.getColumnName(),!1,!1,!0,o.getDisplayLength(),o.getFieldLength(),o.getColumnName()):e.VControlFactory.getControl(null,o,!0,!0,!1)).setReadOnly(!1),a.setMandatory(!1),this.ctrlObjects[o.getColumnName()]=a;var r=t('<div class="vis-fp-inputgroupseprtr" data-ColumnName="'+a.getName()+'" data-cid="'+a.getName()+"_"+this.curTab.getAD_Tab_ID()+'"></div>'),l=t('<div class="vis-control-wrap">'),d=t('<div class="input-group vis-input-wrap">');if(o.getDisplayType()==e.DisplayType.YesNo){var c=[];c.push('<div class="vis-fp-lst-searchrcrds">'),c.push('<div class="vis-fp-inputspan">'),c.push('<div class="vis-fp-istagwrap"><input class="vis-fp-chboxInput vis-fp-inputvalueforupdate" type="checkbox" data-column="'+a.getName()+'" data-keyval="'+a.getName()+'_Y" data-id="Y"'),c.push('><span data-id="Y">'+e.Msg.getMsg("Yes")+"</span> </div>"),c.push("</div>"),c.push('<div class="vis-fp-inputspan">'),c.push('<div class="vis-fp-istagwrap"><input class="vis-fp-chboxInput vis-fp-inputvalueforupdate" type="checkbox" data-column="'+a.getName()+'" data-keyval="'+a.getName()+'_N" data-id="N"'),c.push('><span data-id="N">'+e.Msg.getMsg("No")+"</span> </div>"),c.push("</div>"),c.push("</div>"),l.append("<label>"+o.getHeader()+"</label>"),d.append(l),d.append(c.join(""))}else s=e.VControlFactory.getLabel(o),a.addVetoableChangeListener(this),l.append(a.getControl()),s&&(s.getControl().find("sup").hide(),s&&l.append(s.getControl())),d.append(l);if(a&&a.getBtnCount()>1){var u=a.getBtn(0);if(u){var p=t('<div class="input-group-append">');p.append(u),d.append(p)}}r.append(d),h.append(r),this.getFilterOption(o)}},this.fireValChanged=function(e){this.refreshAll(e)},this.vetoablechange=function(e){var i,a=d.find('[data-cid="'+e.propertyName+"_"+this.curTab.getAD_Tab_ID()+'"]'),s=t.grep(this.selectionfields,(function(t,i){if(t.getColumnName()==e.propertyName)return t}));i=s[0].lookup&&s[0].lookup.getDisplay?s[0].lookup.getDisplay(e.newValue):e.newValue,this.ctrlObjects[e.propertyName]&&this.ctrlObjects[e.propertyName].setValue(e.newValue);var n="hsl("+Math.floor(360*Math.random())+", 100%, "+(Math.floor(16*Math.random())+75)+"%)",o=t('<span data-id="'+e.newValue+'" class="vis-fp-inputvalueforupdate" >'+i+"</span>"),r=t('<i data-id="'+e.newValue+'" data-keyval="'+e.propertyName+"_"+e.newValue+'" class="vis vis-mark"></i></div></div>');a.append(t('<div class="vis-fp-currntrcrdswrap">').append(t('<div style="background-color:'+n+'" class="vis-fp-currntrcrds">').append(o).append(r))),this.ctrlObjects[e.propertyName]&&this.ctrlObjects[e.propertyName].setValue(null),this.fireValChanged(e.propertyName)},this.setFilterOptions=function(e,i){var a,s=[],n=[],o=c.find('[data-cid="'+i+"_"+this.curTab.getAD_Tab_ID()+'"]');if(o&&o.length>0){var r=(a=o.find(".vis-fp-lst-searchrcrds")).find("input");if(r&&r.length>0)for(var l=0;l<r.length;l++){var d=t(r[l]);d.is(":checked")&&(s.push(d.data("id")),d.parent().parent().find(".vis-fp-spanCount").text("(0)"),n.push(d.parent().parent())),d.parent().parent().remove()}}a&&0!=a.length||(a=t('<div class="vis-fp-lst-searchrcrds vis-fp-lst-searchrcrdswrp"></div>'),o.append(a));for(var h=0;h<e.length;h++){var u=[],p=e[h].ID;isNaN(p)||(p=parseFloat(p));var g=s.indexOf(p);g>-1?(n[g].find(".vis-fp-spanCount").text("("+e[h].Count+")"),a.append(n[g]),n.splice(g,1),s.splice(g,1)):h<5&&(u.push('<div class="vis-fp-inputspan">'),u.push('<div class="vis-fp-istagwrap"><input class="vis-fp-chboxInput vis-fp-inputvalueforupdate" type="checkbox" data-column="'+i+'" data-keyval="'+i+"_"+e[h].ID+'" data-id="'+e[h].ID+'"'),u.push('><span data-id="'+e[h].ID+'">'+e[h].Name+'</span> </div><span class="vis-fp-spanCount">('+e[h].Count+")</span>"),u.push("</div>"),a.append(u.join("")))}for(h=0;h<n.length;h++)a.append(n[h]);n=[],s=[]},this.hardRefreshFilterPanel=function(){c.find(".vis-fp-lst-searchrcrdswrp").remove(),c.find(".vis-fp-currntrcrdswrap").remove(),C.find(".vis-fp-currntrcrds").remove(),l=[],f.val(-1),v.val(-1),S(),S(!0)},this.getFilterClause=function(){return function(i){var a="",s=d.find(".vis-fp-inputgroupseprtr");if(s&&s.length>0)for(var n=0;n<s.length;n++){var o=t(s[n]),r=o.find(".vis-fp-inputvalueforupdate"),l=o.data("columnname");if(r&&r.length>0){for(var c="",h=0;h<r.length;h++){var u=t(r[h]);if("checkbox"!=u[0].type||u.is(":checked")){var p=i.parseWhereCondition(l,e.Query.prototype.EQUAL,u.data("id"),null);c+=""!=c?" OR "+p:"("+p}}""!=c&&(c+=")",a+=""!=a?" AND "+c:c);for(var g=!1,f=0;f<i.listOfFilterQueries.length;f++)i.listOfFilterQueries[f].columnName==l&&(g=!0,""!=c?i.listOfFilterQueries[f].whereClause=c:i.listOfFilterQueries.splice(f,1));g||""==c||i.listOfFilterQueries.push({columnName:l,whereClause:c})}else for(f=0;f<i.listOfFilterQueries.length;f++)i.listOfFilterQueries[f].columnName==l&&i.listOfFilterQueries.splice(f,1)}var v=D.getDynamicFilter();return""!=v&&(""!=a?a+=" AND "+v:a=v),a}(this)},this.fillColumns=function(e){f.append(e)};var D=this;function I(e){var i=y.children()[1],a=null;y.children().length>2&&(a=y.children()[2]),a?t(a).prop("disabled",!e).prop("readonly",!e):null!=i&&t(i).prop("disabled",!e).prop("readonly",!e)}function w(e){var i=T.children()[1],a=null;T.children().length>2&&(a=T.children()[2]),a?t(a).prop("disabled",!e).prop("readonly",!e):null!=i&&t(i).prop("disabled",!e).prop("readonly",!e)}function S(e){var t=null;null!=(t=e?o:n)&&t.setValue(null)}function A(i,a){i&&(n=null),o=null;var s=null;null!=(s=i?y.children()[0]:T.children()[0])&&(t(s).remove(),s=null);var r=null;if(null!=(r=null!=a?a.getIsKey()?new e.Controls.VNumTextBox(a.getColumnName(),!1,!1,!0,a.getDisplayLength(),a.getFieldLength(),a.getColumnName()):e.VControlFactory.getControl(null,a,!0,!0,!1):new e.Controls.VTextBox("columnName",!1,!0,!1,20,20,"format","GetObscureType",!1))){r.setMandatory(!1),r.setReadOnly(!1),a.getDisplayType()==e.DisplayType.AmtDimension&&(r.hideButton(!1),r.setReadOnlyTextbox(!1)),e.DisplayType.Text==a.getDisplayType()||e.DisplayType.TextLong==a.getDisplayType()?(r.getControl().attr("rows","1"),r.getControl().css("width","100%")):e.DisplayType.YesNo==a.getDisplayType()?r.getControl().css("clear","both"):e.DisplayType.IsDate(a.getDisplayType())&&r.getControl().css("line-height","1");var l=null,d=t('<div class="input-group vis-input-wrap">'),c=t('<div class="vis-control-wrap">');if(r.getBtnCount()>0&&!(r instanceof e.Controls.VComboBox)&&(l=r.getBtn(0)),i){if(y.append(d),d.append(c),c.append(r.getControl()),n=r,l){var h=t('<div class="input-group-append">');d.append(h),h.append(l)}a.getDisplayType()==e.DisplayType.YesNo||c.append("<label>"+e.Msg.getMsg("QueryValue")+"</label>")}else{if(T.append(d),d.append(c),c.append(r.getControl()),o=r,l){h=t('<div class="input-group-append">');d.append(h),h.append(l)}if(a.getDisplayType()==e.DisplayType.YesNo);else{var u=t("<label>"+e.Msg.getMsg("VIS_QueryValueTo")+"</label>");c.append(u)}}a.getDisplayType(),e.DisplayType.AmtDimension}}function _(t){var i=null;return null!=(i=t?n:o)?i.getDisplayType()==e.DisplayType.YesNo?"true"==i.getValue().toString().toLowerCase()?"Y":"N":i.displayType==e.DisplayType.AmtDimension?i.getText():i.getValue():""}function P(t){var i=null;return null!=(i=t?n:o)?i.displayType==e.DisplayType.AmtDimension?i.getText():i.getDisplay():""}function N(e){var t=C.find('[data-id="'+e+'"]');if(t.length>0&&t.remove(),e in l){var i=[],a=l[e],s="hsl("+Math.floor(360*Math.random())+", 100%, "+(Math.floor(16*Math.random())+75)+"%)";i.push('<div class="vis-fp-currntrcrds" style="background-color:'+s+'" data-id="'+e+'"><span  class="vis-fp-inputvalueforupdate">');for(var n=0;n<a.length;n++)0!=n?i.push(" | "):(i.push(a[n].Name),i.push(a[n].Optr)),i.push(a[n].Text);i.push('</span> <i class="vis vis-mark"></i></div>'),C.append(i.join(" "))}D.fireValChanged(),S(),S(!0)}c.on("click","i",(function(e){var i=t(this);i.hasClass("vis-mark")&&(i.parent().parent().remove(),D.fireValChanged(i.data("keyval")))})),C.on("click","i",(function(e){var i=t(this);i.hasClass("vis-mark")&&function(e){null==l&&(l={});e in l&&delete l[e];N(e)}(i.parent().data("id"))})),d.on("click",(function(e){if($target=t(e.target),$target.is("input")&&$target.hasClass("vis-fp-chboxInput")){var i=$target.data("column");D.fireValChanged(i)}})),b.on("click",(function(e){!function(){var e=f.val();if(!e||"-1"==e)return!1;var t=f.find("option:selected").text(),i="";if(null==t||0==t.trim().length)return!1;i=e.toString();var a=v.val();null!=a&&null!=a||(a=v.find("option:selected").text());v.val();!function(e,t,i,a,s,n,o,r){null==l&&(l={});t in l||(l[t]=[]);l[t].push({Name:e,Value:n,Value2:n,Text:s,Text2:o,Optr:i,Where:D.parseWhereCondition(t,i,n,r)}),N(t)}(t,i,a,0,P(!0),_(!0),P(!1),_(!1))}()})),u.on("click","span",(function(t){c.toggleClass("vis-fp-static-ctrlwrp-auto"),p.text()==e.Msg.getMsg("ViewMore")?p.text(e.Msg.getMsg("ViewLess")):p.text(e.Msg.getMsg("ViewMore"))})),f.on("change",(function(t){var i=f.val(),a=D.getTargetMField(i);if(i&&"-1"!=i){var s=null;s=i.endsWith("_ID")||i.endsWith("_Acct")||i.endsWith("_ID_1")||i.endsWith("_ID_2")||i.endsWith("_ID_3")?D.getOperatorsQuery(e.Query.prototype.OPERATORS_ID):i.startsWith("Is")?D.getOperatorsQuery(e.Query.prototype.OPERATORS_YN):e.DisplayType.IsDate(a.getDisplayType())?D.getOperatorsQuery(e.Query.prototype.OPERATORS):D.getOperatorsQuery(e.Query.prototype.CVOPERATORS),null!=a&&e.DisplayType.IsDate(a.getDisplayType())&&e.Query.prototype.BETWEEN.equals(s)&&(A(!1,a),I(!1),w(!0)),a.getDisplayType(),e.DisplayType.DateTime,v.html(s),v[0].SelectedIndex=0,A(!0,a),v.prop("disabled",!1)}I(!0),w(!1),T.hide()})),v.on("change",(function(t){var i=f.val(),a=D.getTargetMField(i);e.Query.prototype.BETWEEN.equals(v.val())?(A(!1,a),w(!0),T.show()):T.hide()})),d.on("mouseover",(function(){h.height()>c.parent().height()-60&&h.height()+15>=c.height()?u.css("visibility","visible"):u.css("visibility","hidden")})),d.on("mouseout",(function(){p.text()==e.Msg.getMsg("ViewMore")&&u.css("visibility","hidden")})),m.on("change",(function(){!function(e){var t=m[0].selectedIndex;if(e)return divYear.hide(),divMonth.hide(),void divDay.hide();divYear.show(),divMonth.show(),chkDynamic.is(":checked")?divDay.show():divDay.hide();txtDay.prop("readonly",!1),txtMonth.prop("min",1),3==t||6==t?(txtMonth.prop("min",0),txtDay.val(0),txtMonth.val(0),txtYear.val(1)):2==t||5==t?(divYear.hide(),txtYear.val(""),txtMonth.val(1),txtDay.val(0)):1==t||4==t?(divYear.hide(),divMonth.hide(),txtDay.val(0)):0==t&&(txtDay.prop("readonly",!0),divYear.hide(),divMonth.hide(),txtDay.val(0))}()})),this.disposeComponent=function(){d.remove(),this.listOfFilterQueries=[],D=null},this.getDynamicFilter=function(){var e="";for(var t in l){for(var i=l[t],a=[],s=0;s<i.length;s++)0==s?(a.push(" ( "),a.push(i[s].Where)):a.push(" OR "+i[s].Where);a.length>0&&a.push(" ) "),""!=e&&(e+=" AND "),e+=a.join(" ")}return e}}i.prototype.init=function(){if(!this.initialzed){this.curTab=this.curGC.getMTab();var t=this.curTab.getFields();this.selectionfields=[],this.curTabfields=[];for(var i='<option value="-1"> </option>',a=[],s=0;s<t.length;s++){var n=t[s],o=jQuery.extend(!0,{},n);if(n.lookup&&(e.DisplayType.IsLookup(n.getDisplayType())||e.DisplayType.ID==n.getDisplayType())&&(o.lookup=jQuery.extend(!0,{},n.lookup),o.lookup.initialize&&o.lookup.initialize()),this.curTabfields.push(o),!o.getIsEncrypted()){var r=o.getColumnName();o.getDisplayType()==e.DisplayType.Button&&(0==o.getAD_Reference_Value_ID()?o.setDisplayType(e.DisplayType.String):r.endsWith("_ID")?o.setDisplayType(e.DisplayType.Table):(o.setDisplayType(e.DisplayType.List),o.lookup=new e.MLookupFactory.getMLookUp(e.context,this.winNo,o.getAD_Column_ID(),e.DisplayType.List)));var l=o.getHeader();(null!=l&&0!=l.length||null!=(l=e.Msg.getElement(e.context,r))&&0!=l.Length)&&(o.getIsKey()&&(l+=" (ID)"),(!e.DisplayType.IsLookup(o.getDisplayType())&&e.DisplayType.ID!=o.getDisplayType()||o.lookup)&&(o.getIsSelectionColumn()?this.selectionfields.push(o):a.push({value:r,text:l})))}}a.sort((function(e,t){var i=e.text.toUpperCase(),a=t.text.toUpperCase();return i>a?1:i<a?-1:0}));for(var d=0;d<a.length;d++)i+='<option value="'+a[d].value+'">'+a[d].text+"</option>";this.fillColumns(i),this.selectionfields.sort((function(e,t){return e.getSelectionSeqNo()-t.getSelectionSeqNo()})),this.getFixedColumns(),this.setLayout(),this.initialzed=!0}},i.prototype.getFixedColumns=function(){this.selectionfields&&0!=this.selectionfields.length||(this.selectionfields=t.grep(this.curTabfields,(function(e,t){if("Name"==e.getColumnName()||"Value"==e.getColumnName()||"DocumentNo"==e.getColumnName())return e})))},i.prototype.getFilterOption=function(t,i){if(i||(i=""),t&&t.getShowFilterOption()){var s="";t.getLookup()&&t.getLookup().info&&(t.getLookup().info.keyColumn,t.getLookup().info.displayColSubQ,s=e.Env.parseContext(e.Env.getCtx(),this.winNo,this.curTab.getTabNo(),t.getLookup().info.validationCode,!1),t.getLookup().info.tableName);var n=this.curTab.getWhereClause();n=e.Env.parseContext(e.Env.getCtx(),this.winNo,this.curTab.getTabNo(),n,!1);var o=this.curTab.getLinkWhereClause();o&&o.length>0&&(i+=""!=i?" AND "+o:" "+o),n&&n.length>0&&(i+=""!=i?" AND "+n:" "+n);var r=this.getDynamicFilter();r&&r.length>0&&(i+=""!=i?" AND "+r:" "+r);var l={ctx:e.context.getWindowCtx(this.winNo),windowNo:this.winNo,column_ID:t.getAD_Column_ID(),AD_Reference_ID:t.getDisplayType(),columnName:t.getColumnName(),AD_Reference_Value_ID:t.getAD_Reference_Value_ID(),validationCode:e.secureEngine.encrypt(s),whereClause:e.secureEngine.encrypt(i),isParent:!1,pTableName:this.curTab.getTableName()},d=this;a.getFilters(l).then((function(e){var t=e.keyCol;e=e.list,d.setFilterOptions(e,t),d=null}))}},i.prototype.refreshFilterOptions=function(e,t){if(t&&this.hardRefreshFilterPanel(),this.selectionfields)for(var i=0;i<this.selectionfields.length;i++)if(this.selectionfields[i].getShowFilterOption()){var a=this.selectionfields[i];if(a.getColumnName()!=e){for(var s="",n=0;n<this.listOfFilterQueries.length;n++){var o=this.listOfFilterQueries[n];o.columnName!=a.getColumnName()&&(s.length>1&&(s+=" AND "),s+=o.whereClause)}this.getFilterOption(a,s)}}},i.prototype.refreshAll=function(t,i){var a=new e.Query(this.curTab.getTableName(),!0);this.curGC.applyFilters(a),this.refreshFilterOptions(t)},i.prototype.getTargetMField=function(e){if(null==e||0==e.length)return null;for(var t=0;t<this.curTabfields.length;t++){var i=this.curTabfields[t];if(e.equals(i.getColumnName()))return i}return null},i.prototype.parseValue=function(t,i){if(null==i)return null;var a=t.getDisplayType(),s=i.toString();if(null==s||s.equals(e.Env.NULLString)||""==s||"NULL"==s.toUpper())return null;try{if(a==e.DisplayType.Integer||e.DisplayType.IsID(a)&&t.getColumnName().endsWith("_ID"))return parseInt(s);if(e.DisplayType.IsNumeric(a))return parseFloat(s);if(e.DisplayType.IsDate(a)){var n="";try{return new Date(s)}catch(e){n=""}try{return Date.Parse(n)}catch(e){return null}}}catch(i){var o=i.message;null!=o&&0!=o.length||(o=i.toString());var r="";return r+=t.getColumnName()+" = "+s+" - "+o,e.ADialog.error("ValidationError",!0,r.toString()),null}return s},i.prototype.createDirectSql=function(t,i,a,s,n){var o="",r=/(\d{4})-(\d{2})-(\d{2})T(\d{2})\:(\d{2})\:(\d{2})/;return"string"==typeof t&&isNaN(t)&&t.toString().toUpper()!="NULLValue".toUpper()&&(o+=" UPPER( "),o+=this.curTab.getTableName()+"."+a,"string"==typeof t&&isNaN(t)&&t.toString().toUpper()!="NULLValue".toUpper()&&(o+=" ) "),null==t||"NULL".equals(t.toString().toUpper())||"NullValue".toUpper().equals(t.toString().toUpper())?s.equals(e.Query.prototype.EQUAL)?o+=" IS NULL ":o+=" IS NOT NULL ":(o+=s,(e.Query.prototype.IN.equals(s)||e.Query.prototype.NOT_IN.equals(s))&&(o+="("),t instanceof Date||t&&r.test(t.toString())?o+=e.DB.to_date(t,!1):"string"==typeof t&&isNaN(t)?n?(o+=" UPPER( ",o+=e.DB.to_string(t.toString()),o+=" ) "):o+=t.toString():o+=t,e.Query.prototype.BETWEEN.equals(s)?(o+=" AND ",i instanceof Date||i&&r.test(i.toString())?o+=e.DB.to_date(i,!1):"string"==typeof i?(o+=" UPPER( ",o+=e.DB.to_string(i.toString()),o+=" ) "):o+=i):(e.Query.prototype.IN.equals(s)||e.Query.prototype.NOT_IN.equals(s))&&(o+=")")),o},i.prototype.parseWhereCondition=function(t,i,a,s){var n=this.getTargetMField(t),o=n.getColumnSQL();null!=a&&a.length>0&&e.DisplayType.IsText(n.getDisplayType())&&i==e.Query.prototype.EQUAL&&(i=e.Query.prototype.LIKE,a="%"+a+"%");var r="",l=null,d=null;if(null!=a&&(a.toString().trim().startsWith("adddays")||a.toString().trim().startsWith("@"))||(l=this.parseValue(n,a)),(null==a||a.toString().length<1)&&(l=e.Env.NULLString),e.DisplayType.IsDate(n.getDisplayType())&&e.Query.prototype.BETWEEN.equals(i)&&(d=this.parseValue(n,s)),n.getIsVirtualColumn())o=n.vo.ColumnSQL,t=n.vo.ColumnSQL,e.Query.prototype.BETWEEN.equals(i)?((null==s||s.toString().trim().length<1)&&(l=null,d=null),d=this.parseValue(n,s),r=this.createDirectSql(l,d,t,i,!0)):r=this.createDirectSql(l,d,t,i,!0);else{var c="IsActive",h="Amount";if(n.getDisplayType()==e.DisplayType.DateTime&&e.Query.prototype.EQUAL.equals(i)&&l){var u=l.getFullYear(),p=l.getMonth(),g=l.getDate();d=new Date(u,p,g,24,0,0),l=new Date(u,p,g,0,0,0),i=e.Query.prototype.BETWEEN}if(e.Query.prototype.BETWEEN.equals(i)){if((null==(s=d)||s.toString().trim().length<1)&&(l=null,d=null),n.getDisplayType()==e.DisplayType.AmtDimension){var f="SELECT C_DimAmt_ID FROM C_DimAmt WHERE "+c+"='Y' AND "+h+" "+i+a+" AND "+s;l=e.MRole.getDefault().addAccessSQL(f.toString(),"C_DimAmt",e.MRole.SQL_NOTQUALIFIED,e.MRole.SQL_RO),i=e.Query.prototype.IN}r=this.createDirectSql(l,d,o,i,!1)}else{if(n.getDisplayType()==e.DisplayType.AmtDimension){f="SELECT C_DimAmt_ID FROM C_DimAmt WHERE "+c+"='Y' AND "+h+" "+i+a;l=e.MRole.getDefault().addAccessSQL(f.toString(),"C_DimAmt",e.MRole.SQL_NOTQUALIFIED,e.MRole.SQL_RO),i=e.Query.prototype.IN}null==l&&null!=a&&(a.toString().trim().startsWith("adddays")||a.toString().trim().startsWith("@"))?(r=t+i+a,n.getDisplayType()==e.DisplayType.AmtDimension&&(r=t+e.Query.prototype.IN+"("+l+")")):r=this.createDirectSql(l,d,o,i,!0)}}return r},i.prototype.dispose=function(){this.disposeComponent(),this.curGC=this.curTab=this.curTabfields=this.selectionfields=null},i.prototype.getOperatorsQuery=function(t,i){var a="",s="";for(var n in t)s=t[n],i&&(s=e.Msg.getMsg(s)),a+='<option value="'+n+'">'+s+"</option>";return a};var a={getFilters:function(i){return new Promise((function(a,s){var n=null;t.ajax({url:e.Application.contextUrl+"JsonData/GetRecordForFilter",type:"POST",data:{data:JSON.stringify(i)}}).done((function(e){n=e,n=JSON.parse(n),a(n)}))}))}};e.FilterPanel=i}(VIS,jQuery)},3502:()=>{!function(e,t){function i(i){var a=null,s=!1;this.headerItems=null;var n=this;this.curTab=null,this.controls=[],this.textAlignEnum={C:"Center",R:"flex-end",L:"flex-start"},this.alignItemEnum={C:"Center",T:"flex-start",B:"flex-end"},this.windowNo=0,this.dynamicStyle=[],this.styleTag=document.createElement("style");var o=i.find(".fa-angle-double-left");i.css("flex-direction","column"),o.parent().css("display","flex"),this.setHeaderLayout=function(e,s){if(e.getIsHeaderPanel()&&(n.headerItems=e.getHeaderPanelItems(),n.gTab=e,n.windowNo=n.gTab.getWindowNo(),n.headerItems)){a=t('<div class="vis-ad-w-p-header_root_common">');var o=this.headerParentCustomUISettings(s);i.addClass(o)}},this.setHeaderItems=function(i,a){if(this.controls&&this.controls.length>0&&!i&&!a)for(var s=0;s<this.controls.length;s++){var o=this.controls[s];if(o){var c=o.control,h=o.field,u=c.control;if(null==h&&null!=u){u.setValue(null);continue}if(null==u&&!h.getIsHeading())continue;var p=l(h,u);if(u instanceof e.Controls.VButton&&(!p||p.indexOf("{")>-1)&&(p=h.getValue()),u instanceof e.Controls.VButton)r(p,u,h);else if(h.lookup&&h.lookup.gethasImageIdentifier()){p=e.Utility.Util.getIdentifierDisplayVal(p);var g=o.img;g.attr("src","");var f=o.imgspan;f.text("");var v=null,m=null;if(h.lookup.displayType==e.DisplayType.List){v=h.lookup.getLOVIconElement(h.getValue(),!0,!0),m=h.lookup.getLOVIconStyle(h.getValue());var b="";!v&&p&&(b=p.substring(0,1)),v?v.contains("Images/")?(g.attr("src",v).attr("style",m),f.hide(),g.show()):(b=v,f.empty(),f.append("<i class='"+b+"' style='"+m+"'></i>"),f.show(),g.hide()):(b||(b=""),f.empty(),f.text(b).attr("style",m),f.show(),g.hide())}else{(v=d(h))&&!v.contains("Images/")?(b=v,f.text(b),f.show(),g.attr("src",""),g.hide()):(g.attr("src",v),f.hide(),g.show())}r(p,u,h)}else r(p,u,h)}}else{if(!i)return;var y=this.curTab.gridTable.gridFields;y=(y=t.grep(y,(function(e){if(e.getIsHeaderPanelitem())return e}))).sort((function(e,t){return e.getHeaderSeqno()-t.getHeaderSeqno()}));var T=null;for(var C in i.HeaderItems){var D=i.HeaderItems[C],I=D.StartColumn,w=D.ColumnSpan,S=D.StartRow,A=D.RowSpan,_=D.JustifyItems,P=D.AlignItems,N=D.Padding,x=D.BackgroundColor;x||(x="");var R=D.FontColor;R||(R="");var L=D.FontSize;L||(L="");var E=null,k=null,V=null,M=null,G=(u=null,this.applyCustomUISettings(C,I,w,S,A,_,P,x,R,L,N));if((E=a.find("."+G)).length<=0&&(E=t('<div class="vis-w-p-header-data-f '+G+'">')),D.IsStaticContent){c={};ContentFieldValue=D.ContentFieldValue;var F=e.Msg.getMsg(D.ContentFieldLabel);F.indexOf("[")>-1&&(F=D.ContentFieldLabel),V=t('<div class="vis-w-p-header-data-label">'+F+"</div>"),D.FieldLabelStyle&&V.attr("style",D.FieldLabelStyle);var O="";ContentFieldValue.indexOf("fa-")>-1||ContentFieldValue.indexOf("vis-")>-1?(-1!=ContentFieldValue.indexOf("fa-")&&-1==ContentFieldValue.indexOf("fa ")?ContentFieldValue="fa "+ContentFieldValue:-1!=ContentFieldValue.indexOf("vis-")&&-1==ContentFieldValue.indexOf("vis ")&&(ContentFieldValue="vis "+ContentFieldValue),O=t('<i class="'+ContentFieldValue+'"></i>')):ContentFieldValue.indexOf("data:image/")>-1?O=t('<img src="'+ContentFieldValue+'"/>'):(ContentFieldValue=e.Msg.getMsg(ContentFieldValue),ContentFieldValue.indexOf("[")>-1&&(ContentFieldValue=D.ContentFieldValue),O=t('<span class="">'+ContentFieldValue+"</span>")),D.FieldValueStyle&&O.attr("style",D.FieldValueStyle),E.append(V).append(O),a.append(E)}else{if(!T){T={},y=y.sort((function(e,t){return e.getHeaderSeqno()-t.getHeaderSeqno()}));for(s=0;s<y.length;s++){var H=y[s];H.getIsHeaderPanelitem()&&(H.getHeaderSeqno()in T?T[H.getHeaderSeqno()].push(H):T[H.getHeaderSeqno()]=[H])}}var U=T[C];if(!U&&D.ColSql.length<0)continue;if(!U&&D.ColSql.length>0){c={};if(V=t('<div class="vis-w-p-header-Label-f"></div>'),null==(u=new e.Controls.VKeyText(D.ColSql,n.gTab.getWindowNo(),n.gTab.getWindowNo()+"_"+C,D.IsAlwaysExecute,h,D.AD_GridLayoutItems_ID)))continue;c.control=u;var B={control:c,field:null};V.append(u.getControl()),E.append(V),a.append(E),n.controls.push(B)}else if(U)for(var W=0;W<U.length;W++){if(h=U[W]){c={};if(k=t('<div class="vis-w-p-header-icon-f"></div>'),V=t('<div class="vis-w-p-header-Label-f"></div>'),h.getDisplayType()==e.DisplayType.Image){V.addClass("vis-w-p-header-Label-center-f");var q=this.justifyAlignImageItems(C,_,P);V.addClass(q)}M=e.VControlFactory.getHeaderLabel(h,!0),u=D.ColSql.length>0?new e.Controls.VKeyText(D.ColSql,n.gTab.getWindowNo(),n.gTab.getWindowNo()+"_"+C,D.IsAlwaysExecute,null,D.AD_GridLayoutItems_ID):e.VControlFactory.getReadOnlyControl(this.curTab,h,!1,!1,!1),h.getDisplayType()==e.DisplayType.Button&&null!=u&&u.addActionListner(this);var z=this.applyCustomUIForFieldValue(C,I,S,h);u.getControl().addClass(z),c.control=u;B={control:c,field:h};var Q=t("<span></span>"),j=e.VControlFactory.getIcon(h);if(null!=u){var Y=null;M&&(Y=M.getControl().addClass("vis-w-p-header-data-label"));p=l(h);if((X=h.getHeaderStyle())&&X.length>0&&(X=X.split("|")),X&&X.length>0)for(var $=0;$<X.length;$++)if(X[$].indexOf("@img::")>-1||X[$].indexOf("@span::")>-1){E.append(k);var J="";X[$].indexOf("@img::")>-1?J=X[$].replace("@img::",""):X[$].indexOf("@span::")&&(J=X[$].replace("@span::","")),k.attr("style",J)}else X[$].indexOf("@value::")>-1?E.append(V):X[$].indexOf("<br>")>-1?E.css("flex-direction","column"):(E.append(k),E.append(V));else E.append(k),E.append(V);var K=t("<img>"),Z=t("<span>");if(B.img=K,h.lookup&&h.lookup.gethasImageIdentifier()){B.imgspan=Z;v=null,b=null,m=null;var X=null;e.DisplayType.List==h.lookup.displayType?(v=h.lookup.getLOVIconElement(h.getValue(),!0),m=h.lookup.getLOVIconStyle(h.getValue()),!v&&p&&(b=p.substring(0,1)),v&&!v.contains("Images/")?(b=v,Z.text(b),K.attr("src",""),K.hide()):(K.attr("src",v),K.show())):(p=e.Utility.Util.getIdentifierDisplayVal(p),(v=d(h))&&!v.contains("Images/")?(b=v,Z.text(b),K.attr("src",""),K.hide()):(K.attr("src",v),K.show())),k.append(Z),k.append(K),h.getHeaderIconOnly()||h.getHeaderHeadingOnly()?h.getHeaderIconOnly()&&h.getHeaderHeadingOnly()?k.remove():h.getHeaderIconOnly()?(null!=b?K.hide():Z.hide(),Y&&Y.length>0&&Y.remove()):h.getHeaderHeadingOnly()&&(Y&&Y.length>0&&V.append(Y),k.remove()):(null!=b?K.hide():Z.hide(),Y&&Y.length>0&&V.append(Y)),V.append(u.getControl()),a.append(E),r(p,u,h)}else Q.addClass("vis-w-p-header-icon-fixed"),B.imgspan=Q,h.getDisplayType()==e.DisplayType.Button?k.remove():h.getHeaderIconOnly()||h.getHeaderHeadingOnly()?h.getHeaderIconOnly()&&h.getHeaderHeadingOnly()?k.remove():h.getHeaderIconOnly()?(k.append(Q.append(j)),Y&&Y.length>0&&Y.hide()):h.getHeaderHeadingOnly()&&(Y&&Y.length>0&&V.append(Y),k.remove()):(k.append(Q.append(j)),Y&&Y.length>0&&V.append(Y)),r(p,u,h);V.append(u.getControl()),a.append(E),n.controls.push(B)}}}}}}};var r=function(t,i,a){if(t){if(t.startsWith&&t.startsWith("<")&&t.endsWith(">")&&(t=t.replace("<","").replace(">","")),a.getDisplayType()==e.DisplayType.Image){var s=i.getValue();i.getControl().show(),s==t&&i.refreshImage(t)}else i.format&&(t=i.format.GetFormatAmount(i.format.GetFormatedValue(t),"init",e.Env.isDecimalPoint()));i.setValue(e.Utility.decodeText(t),!1)}else a.getDisplayType()==e.DisplayType.Image?(i.getControl().hide(),i.setValue(null,!1)):a.getDisplayType()==e.DisplayType.Button&&a.getAD_Reference_Value_ID()>0?i.setText("- -"):i.setValue("- -",!0)},l=function(t){var i=t.getValue();if(n.pRowData&&(i=n.pRowData[t.getColumnName().toLower()]),i){var a=t.getDisplayType();if(t.lookup){if((i=t.lookup.getDisplay(i,!0,!0)).startsWith&&i.startsWith("<")&&i.endsWith(">")){i=i.replace("<","").replace(">","");var s=t.lookup.getDirect(i,!0,!0);s&&s.Name&&(i=s.Name)}}else if(e.DisplayType.IsDate(a))i=i.toString().replace("Z",""),i=a==e.DisplayType.DateTime?new Date(i).toLocaleString():a==e.DisplayType.Date?new Date(i).toLocaleDateString():new Date(i).toLocaleTimeString();else if(a==e.DisplayType.YesNo){var o=i.toString();t.getIsEncryptedColumn()&&(o=e.secureEngine.decrypt(o)),i=o.equals("true")}else i=i.toString();t.getIsEncryptedField()&&i&&i.length>0&&(i=i.replace(/[a-zA-Z0-9-. ]/g,"*").replace(/[^a-zA-Z0-9-. ]/g,"*")),t.getObscureType()&&i&&i.length>0&&(i=e.Env.getObscureValue(t.getObscureType(),i))}else i=null;return i},d=function(t){var i=t.getValue();if(null!=(i=t.lookup.getDisplay(i,!0,!0))&&i&&i.indexOf("Images/")>-1){var a=i.substring(i.indexOf("Images/")+7,i.lastIndexOf("^^"));if(a=e.Application.contextUrl+"Images/Thumb140x120/"+a,!(0==n||a.indexOf("nothing.png")>-1))return a;(i=i.replace("^^"+i.substring(i.indexOf("Images/"),i.lastIndexOf("^^")+2),"^^^")).indexOf("Images/")>-1&&(i=i.replace(i.substring(i.indexOf("Images/"),i.lastIndexOf("^^")+2),"^^^")),i=i.split("^^^");for(var s="",n=0;n<i.length;n++)if(i[n].trim().length>0){if(0==s.length)var o=i[n].trim().split(" ");return s=o[0].substring(0,1).toUpper(),o.length>1?s+=o[o.length-1].substring(0,1).toUpper():s=o[0].substring(0,2).toUpper(),s}}};this.getRoot=function(){return a},this.getParent=function(){return i},this.hidePanel=function(){return i.hide()},this.showPanel=function(){return i.show()},this.alignHorzontal=function(){s=!0,i.removeClass("vis-ad-w-p-header-l").addClass("vis-ad-w-p-header-t"),o.removeClass("fa-angle-double-left").addClass("fa-angle-double-up"),o.parent().css("background-color","transparent"),i.css("flex-direction","row")},o.on("click",(function(){n.curGC.vTabPanel&&setTimeout((function(){n.curGC.vTabPanel.setSize(0)}),200),s?0==i.height()?(i.height(n.gTab.getHeaderHeight()),a.show(),i.find(".vis-ad-w-p-header-arrow-l").css("padding",""),o.removeClass("fa-angle-double-down").addClass("fa-angle-double-up").removeClass("vis-ad-w-p-header-v")):(i.height(0),a.hide(),i.find(".vis-ad-w-p-header-arrow-l").css("padding","0px"),o.removeClass("fa-angle-double-up").addClass("fa-angle-double-down").addClass("vis-ad-w-p-header-v")):0==i.width()?(o.removeClass("fa-angle-double-right").addClass("fa-angle-double-left").removeClass("vis-ad-w-p-header-h"),i.width(n.gTab.getHeaderWidth()),i.find(".vis-ad-w-p-header-arrow-l").css("padding",""),window.setTimeout((function(){a.show()}),50)):(i.width(0),a.hide(),i.find(".vis-ad-w-p-header-arrow-l").css("padding","0px"),o.removeClass("fa-angle-double-left").addClass("fa-angle-double-right").addClass("vis-ad-w-p-header-h")),n.sizeChangedListner&&n.sizeChangedListner.onSizeChanged&&n.sizeChangedListner.onSizeChanged()})),this.disposeComponent=function(){o.remove(),o=null,this.styleTag.remove(),this.styleTag=null,this.headerItems=null,n=null,this.curTab=null,this.controls=null,a.remove(),a=null,i.remove(),i=null}}i.prototype.init=function(e){this.aPanel=e.getAPanel(),this.curTab=e.getMTab(),this.curGC=e;var i=this.curTab.getHeaderBackColor();this.setHeaderLayout(this.curTab,i);var a=this.getRoot(),s=this.getParent(),n="vis-w-p-Header-Root-v",o=this.curTab.getHeaderHorizontal(),r=this.curTab.getHeaderHeight(),l=this.curTab.getHeaderWidth(),d=this.curTab.getHeaderPadding(),c=this.headerUISettings(o,r,l,"",d);if(a.addClass(c),o&&(this.alignHorzontal(),n="vis-w-p-Header-Root-h"),this.headerItems&&!(this.headerItems.length<=0)){for(var h=0;h<this.headerItems.length;h++){var u=this.headerItems[h],p=u.HeaderTotalRow,g=u.HeaderTotalColumn;(i=u.HeaderBackColor)||(i=""),(d=u.HeaderPadding)||(d="");var f=this.fieldGroupContainerUISettings(g,p,i,d,h),v=t('<div class="'+n+" "+f+'">');a.append(v),!u||!u.HeaderItems||u.HeaderItems.length<=0||this.setHeaderItems(u,v)}this.addStyleToDom(),s.append(a)}},i.prototype.addSizeChangeListner=function(e){this.sizeChangedListner=e},i.prototype.fieldGroupContainerUISettings=function(e,t,i,a,s){var n="vis-ad-w-p-fg_container_"+t+"_"+e+"_"+this.windowNo+"_"+s;return this.dynamicStyle.push(" ."+n+" {"),this.dynamicStyle.push("grid-template-columns:repeat("+e+", 1fr);grid-template-rows:repeat("+t+", auto);padding:"+a+";"+i),this.dynamicStyle.push("} "),n},i.prototype.addStyleToDom=function(){this.styleTag.type="text/css",this.styleTag.innerHTML=this.dynamicStyle.join(" "),t(t("head")[0]).append(this.styleTag)},i.prototype.headerUISettings=function(e,t,i,a,s){var n="vis-ad-w-p-header_root_"+this.windowNo;return this.dynamicStyle.push(" ."+n+" {display:flex;overflow:auto;"),e?this.dynamicStyle.push("flex:1;flex-direction:row;height: "+t+"; "):this.dynamicStyle.push("flex-direction:column;width: "+i+";height:calc(100vh - 94px); "),this.dynamicStyle.push("padding:"+s+";"+a),this.dynamicStyle.push("} "),n},i.prototype.headerParentCustomUISettings=function(e){var t="vis-ad-w-p-header_Custom_"+this.windowNo;return this.dynamicStyle.push(" ."+t+" {flex:1;"),this.dynamicStyle.push("background: rgba(var(--v-c-primary));"),this.dynamicStyle.push(e),this.dynamicStyle.push("} "),t},i.prototype.applyCustomUISettings=function(e,t,i,a,s,n,o,r,l,d,c){var h="vis-hp-FieldGroup_"+a+"_"+t+"_"+this.windowNo+"_"+e;return this.dynamicStyle.push("."+h+"  {grid-column:"+t+" / span "+i+"; grid-row: "+a+" / span "+s+";"),this.dynamicStyle.push("justify-content:"+this.textAlignEnum[n]+";align-items:"+this.alignItemEnum[o]),this.dynamicStyle.push(";font-size:"+d+";color:"+l+";padding:"+c+";"),this.dynamicStyle.push(r),this.dynamicStyle.push("} "),h},i.prototype.applyCustomUIForFieldValue=function(e,t,i,s){var n=s.getHeaderStyle(),o="vis-hp-FieldValue_"+i+"_"+t+"_"+this.windowNo+"_"+e+"_"+s.getAD_Column_ID();return n&&n.toLower().indexOf("@value::")>-1&&(n=a(n,"@value::")),this.dynamicStyle.push("."+o+"  {"+n+"} "),o},i.prototype.applyCustomUIForFieldImg=function(e,t,i,s){var n=s.getHeaderStyle(),o="vis-hp-FieldImgValue_"+i+"_"+t+"_"+this.windowNo+"_"+e;return n&&n.toLower().indexOf("@img::")>-1&&(n=a(n,"@img::")),this.dynamicStyle.push("."+o+"  {"+n+"} "),o},i.prototype.applyCustomUIForFieldSpan=function(e,t,i,s){var n=s.getHeaderStyle(),o="vis-hp-FieldImgValue_"+i+"_"+t+"_"+this.windowNo+"_"+e;return n&&n.toLower().indexOf("@span::")>-1&&(n=a(n,"@span::")),this.dynamicStyle.push("."+o+"  {"+n+"} "),o};var a=function(e,t){if(e&&e.toLower().indexOf(t)>-1)for(var i=e.split("|"),a=0;a<i.length;a++)if(i[a].toLower().indexOf(t)>-1)return i[a].toLower().replace(t,"").trim()};i.prototype.justifyAlignImageItems=function(e,t,i){var a="vis-w-p-header-label-center-justify_"+e+"_"+this.windowNo;return this.dynamicStyle.push(" ."+a+" {justify-content:"+this.textAlignEnum[t]+";align-items:"+this.alignItemEnum[i]+"}"),a},i.prototype.navigate=function(e){if(this.isChild=e,this.pRowData=null,this.isChild){var t=this;this.curTab.getTableModel().getRowFromDB(this.curTab.getCurrentRow(),(function(e){t.pRowData=e,t.setHeaderItems(),t.isChild=!1}))}else this.setHeaderItems(),this.isChild=!1},i.prototype.dispose=function(){this.aPanel=null,this.curTab=null,this.curGC=null,this.sizeChangedListner=null,this.disposeComponent()},i.prototype.actionPerformed=function(e){this.aPanel.getIsWindowAction(e.source.getField().getAD_Reference_Value_ID())&&this.aPanel.toolbarActionList.indexOf(e.source.getField().vo.DefaultValue)>-1||e.source.getField().getIsAction()&&"MTU"===e.source.getField().getAction()||!this.aPanel.curTab.needSave(!0,!1)?this.aPanel.actionPerformed(e,this):this.aPanel.cmd_save(!0)},i.prototype.cmd_save=function(e,t){return this.aPanel.cmd_save2(e,this.curTab,this.curGC,this.aPanel,t)},e.HeaderPanel=i}(VIS,jQuery)},7529:()=>{!function(e,t){var i=e.Application.contextUrl,a=i+"JsonData/JDataSetWithCode",s=function(t,i,a){var s=!!a,n={sql:t,page:1,pageSize:0};i&&(n.param=i);var r=null;return o(n,s,(function(t){r=(new e.DB.DataSet).toJson(t),a&&a(r)})),r},n=function(t,i,a){var s=!!a,n={sql:t,page:1,pageSize:0};i&&(n.param=i);var r=null;return o(n,s,(function(t){i=(new e.DB.DataSet).toJson(t);var i=(new e.DB.DataSet).toJson(t);r=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null,i.dispose(),i=null,s&&a(r)})),r};function o(e,i,s){var n=null;return t.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){n=e,s&&s(e)})),n}var r=document.querySelector("#vis-ad-paneltmp").content;function l(){var i,a,n,o,l,d,c,h,u,p,g,f,v,m,b,y,T,C,D,I,w;this.$parentWindow,this.ctx=e.Env.getCtx(),this.curGC,this.curST,this.curTab,this.vTabbedPane=new e.VTabbedPane(!1),this.statusBar=new e.StatusBar,this.curWinTab=null,this.curTabIndex,this.firstTabId=null,this.DocActionVariables={},this.DocActionVariables.STATUS_COMPLETED="CO",this.DocActionVariables.STATUS_CLOSED="CL",this.DocActionVariables.STATUS_VOIDED="VO",this.DocActionVariables.STATUS_REVERSED="RE",this.toolbarCreated=!1,this.errorDisplayed=!1,this.isPersonalLock=e.MRole.getIsPersonalLock(),this.isShowSharedRecord=e.MRole.getIsShowSharedRecord(),this.log=e.Logging.VLogger.getVLogger("APanel"),this.isSummaryVisible=!1,this.lastView="";var S,A,_="",P="",N="",x="",R=null,L=null,E=null,k=null,V=null,M=null;this.excludeFromShare=["ad_org","m_warehouse","ad_sharerecordorg"];var G=[],F={};this.defaultSearch=!0,this.isAutoCompleteOpen=!1,this.instructionPop={},this.instructionPop[this.ACTION_NAME_NEW]=!1,this.tabStack=[],this.toolbarActionList=["UNO","NRD","SAR","DRD","RQY","RET","PRT","BVW"];var O,H=function(){v.attr("title",e.Msg.getMsg("FilterRecord")),V.attr("title",e.Msg.getMsg("Settings"))},U=this,B=function(){m.on("click",(function(e){m.find(".vis-window-instruc-overlay-new").remove(),m.find(".vis-window-instruc-overlay-new-li").removeClass(".vis-window-instruc-overlay-new-li"),t(e.target).is(":focus")&&U.compositViewChangeSave(e)}))};this.createSearchAutoComplete=function(i){if(u){var a=this;u.autocomplete({select:function(t,i){U.defaultSearch=!1,U.isSummaryVisible?U.curTab.setShowSummaryNodes(!0):U.curTab.setShowSummaryNodes(!1);var a=new e.Query(U.curTab.getTableName(),!1);U.curTab.searchText=i.item.value,U.curTab.userQueryID=i.item.id,i.item.code!=e.Msg.getMsg("All")&&(U.curGC.searchCode=i.item.code),U.curGC.applyFilters(a),g.css("visibility","visible"),f.css("visibility","visible").css("transform","rotate(360deg)"),t.stopPropagation()},minLength:0,open:function(e,t){a.isAutoCompleteOpen=!0},close:function(e,t){f.css("transform","rotate(360deg)"),window.setTimeout((function(){a.isAutoCompleteOpen=!1}),400)},source:[]}),u.autocomplete().data("ui-autocomplete")._renderItem=function(i,s){var n=null;n=0==a.curTab.getTabLevel()?s.defaultids&&s.userid>0?t("<span title='"+e.Msg.getMsg("DefaultSearch")+"'  data-id='"+s.id+"' class='VIS-winSearch-defaultIcon'></span>"):t("<span title='"+e.Msg.getMsg("MakeDefaultSearch")+"' data-id='"+s.id+"' class='VIS-winSearch-NonDefaultIcon'></span>"):t("<span title='"+e.Msg.getMsg("DefaultSearch")+"'  data-id='"+s.id+"'></span>");var o=t("<li>").append(t("<a style='display:block' title='"+s.title+"'>"+s.label+"</a>").append(n)).appendTo(i);return n.on("click",(function(i){var a=t(this).data("id");t.ajax({url:e.Application.contextUrl+"JsonData/InsertUpdateDefaultSearch",dataType:"json",data:{AD_Tab_ID:U.curTab.getAD_Tab_ID(),AD_Table_ID:U.curTab.getAD_Table_ID(),AD_User_ID:U.ctx.getAD_User_ID(),AD_UserQuery_ID:a},success:function(e){},error:function(e){console.log(e)}})})),o}}},O=document.importNode(r,!0),m=t(O.querySelector(".vis-ad-w-p")),b=m.find(".vis-ad-w-p-busy"),o=m.find(".vis-ad-w-p-tb-lc"),n=m.find(".vis-ad-w-p-nav-btns"),d=m.find(".vis-ad-w-p-t-c-tc"),c=m.find(".vis-ad-w-p-t-c"),h=m.find(".vis-ad-w-p-tabs-oflow").hide(),A=m.find(".vis-ad-w-p-tabs-t"),M=m.find(".vis-ad-w-p-action").hide(),T=m.find(".vis-ad-w-p-tb-rc-abar").hide(),C=m.find(".vis-ad-w-p-a-m-slist"),D=m.find(".vis-ad-w-p-a-m-dlist"),I=m.find(".vis-ad-w-p-a-main"),w=m.find(".vis-ad-w-p-a-oflow"),_=m.find(".vis-ad-w-p-header-l"),S=m.find(".vis-ad-w-p-center-inctab"),y=m.find(".vis-ad-w-p-tb-rc-a-list"),a=m.find(".vis-ad-w-p-center-view"),l=m.find(".vis-ad-w-p-status"),R=m.find(".vis-ad-w-p-actionpanel-r"),u=m.find(".vis-ad-w-p-tb-s-input"),g=m.find(".vis-ad-w-p-tb-s-icon"),f=m.find(".vis-ad-w-p-tb-s-icon-down"),u.attr("placeholder",e.Msg.getMsg("Search")),p=m.find(".vis-ad-w-p-tb-s-btn"),L=m.find(".vis-ad-w-p-tb-advsrch"),E=m.find(".vis-ad-w-p-t-close"),k=m.find(".vis-ad-w-p-t-name h5"),v=m.find("span.vis-ad-w-p-tb-rc-action"),P=m.find(".vis-ad-w-p-filterpnl").hide(),V=m.find(".vis-ad-w-p-setting"),N=P.find(".vis-fp-bodywrap"),P.find(".vis-fp-header h4").text(e.Msg.getMsg("Filter")),x=P.find(".vis-fp-header .vis-mark"),H(),B(),l.append(this.statusBar.getRoot()),this.hideToolbar=function(e){e?o.find("*").hide():o.find("*").show()},this.hideTabLinks=function(e){e?A.find("*").css("visibility","hidden"):A.find("*").css("visibility","show")},this.hideActionbar=function(e){e?(T.hide(),M.hide()):(T.show(),M.show())},this.setSize=function(e,t){},this.getIsWindowAction=function(e){return 435==e};var W=function(e){U.actionPerformed(e)};this.onTabChange=function(e){U.tabActionPerformed(e)},this.statusBar.onComboChange=function(e){U.setBusy(!0),setTimeout((function(){U.curGC.navigatePageExact(e+1),U.curGC.onDemandTree||U.setBusy(!1)}),100)},this.createToolBar=function(){this.aRefresh=this.addActions(this.ACTION_NAME_REFRESH,null,!0,!0,!1,W,null,"Shct_Refresh","Refresh"),this.aDelete=this.addActions(this.ACTION_NAME_DELETE,null,!0,!0,!1,W,null,"Shct_Delete","Delete"),this.aNew=this.addActions(this.ACTION_NAME_NEW,null,!0,!1,!1,W,null,"Shct_New","New"),this.aIgnore=this.addActions("UNO",null,!0,!0,!1,W,null,"Shct_Ignore","Ignore"),this.aSave=this.addActions("SAR",null,!0,!0,!1,W,null,"Shct_Save","Save"),this.aFind=this.addActions("Find",null,!0,!0,!1,W,null,"Shct_Find"),this.aInfo=this.addActions("Info",null,!0,!0,!1,W,null,"Shct_Info"),this.aReport=this.addActions("RET",null,!0,!0,!1,W,null,"Shct_Report","Report"),this.aPrint=this.addActions("PRT",null,!0,!0,!1,W,null,"Shct_Print","Print"),this.aBack=this.addActions("BVW",null,!0,!0,!1,W,null,"Shct_Back","back-arrow"),o.append(this.aBack.getListItm()),o.append(this.aIgnore.getListItm()),o.append(this.aNew.getListItm()),o.append(this.aDelete.getListItm()),o.append(this.aSave.getListItm()),o.append(this.aRefresh.getListItm()),o.append(this.aReport.getListItm()),o.append(this.aPrint.getListItm()),this.gridWindow.getIsHideToolbar()||o.find("LI").hide(),L.append(this.aFind.getListItm()),this.aPrevious=this.addActions(this.ACTION_NAME_PREV,null,!0,!0,!0,W,null,"Shct_PrevRec"),this.aFirst=this.addActions(this.ACTION_NAME_FIRST,null,!0,!0,!0,W,null,"Shct_FirstRec"),this.aLast=this.addActions(this.ACTION_NAME_LAST,null,!0,!0,!0,W,null,"Shct_LastRec"),this.aNext=this.addActions(this.ACTION_NAME_NEXT,null,!0,!0,!0,W,null,"Shct_NextRec"),this.aMulti=this.addActions("Multi",null,!1,!0,!0,W,!1,"Shct_MultiRow","Multix"),this.aSingle=this.addActions("Single",null,!1,!0,!0,W,!1,"Shct_MultiRow","Multi"),this.aCard=this.addActions("Card",null,!1,!0,!0,W,!1,"Shct_CardView","card-o"),this.aMap=this.addActions("Map",null,!1,!0,!0,W),n.append(this.aPrevious.getListItm()).append(this.aNext.getListItm()),n.append(this.aMulti.getListItm()),n.append(this.aSingle.getListItm()),n.append(this.aCard.getListItm()),n.append(this.aMap.getListItm().hide()),this.aPageUp=this.addActions(this.ACTION_NAME_PAGEUP,null,!0,!0,!0,W,null,"Shct_PageUp"),this.aPageFirst=this.addActions("PageFirst",null,!0,!0,!0,W,null,"Shct_PageFirst"),this.aPageLast=this.addActions("PageLast",null,!0,!0,!0,W,null,"Shct_PageLast"),this.aPageDown=this.addActions(this.ACTION_NAME_PAGEDOWN,null,!0,!0,!0,W,null,"Shct_PageDown");var i=this.gridWindow;actionItemCount_Right=0,i.getIsHideActionbar()||(T.show(),M.show()),this.aBatchUpdate=this.addActions("BUE",null,!1,!1,!1,W),"Y"===e.Env.getCtx().getContext("#ENABLE_BATCHUPDATE")&&100==this.ctx.getAD_User_ID()&&(this.aBatchUpdate.setTextDirection("r"),C.append(this.aBatchUpdate.getListItmIT())),i.getIsAppointment()&&(this.aAppointment=this.addActions("APT",null,!1,!1,!1,W),this.aAppointment.setTextDirection("r"),C.append(this.aAppointment.getListItmIT())),i.getIsTask()&&(this.aTask=this.addActions("TAK",null,!1,!1,!1,W),this.aTask.setTextDirection("r"),C.append(this.aTask.getListItmIT())),i.getIsEmail()&&(this.aEmail=this.addActions("EML",null,!1,!1,!1,W),this.aEmail.setTextDirection("r"),C.append(this.aEmail.getListItmIT())),i.getIsLetter()&&(this.aLetter=this.addActions("LER",null,!1,!1,!1,W),this.aLetter.setTextDirection("r"),C.append(this.aLetter.getListItmIT())),i.getIsSms()&&(this.aSms=this.addActions("SMS",null,!1,!1,!1,W),this.aSms.setTextDirection("r"),C.append(this.aSms.getListItmIT())),i.getIsFaxEmail()&&(this.aFaxEmail=this.addActions("FaxEmail",null,!1,!1,!1,W),this.aFaxEmail.setTextDirection("r"),C.append(this.aFaxEmail.getListItmIT())),i.getIsChat()&&(this.aChat=this.addActions(this.ACTION_NAME_CHAT,null,!1,!1,!1,W,!0),this.aChat.setTextDirection("r"),C.append(this.aChat.getListItmIT())),i.getIsAttachment()&&(this.aAttachment=this.addActions("ATT",null,!1,!1,!1,W,!0),this.aAttachment.setTextDirection("r"),C.append(this.aAttachment.getListItmIT())),i.getIsHistory()&&(this.aHistory=this.addActions("HIY",null,!1,!1,!1,W),this.aHistory.setTextDirection("r"),C.append(this.aHistory.getListItmIT())),i.getIsCheckRequest()&&(this.aRequest=this.addActions("CRT",null,!0,!1,!1,W),this.aRequest.setTextDirection("r"),C.append(this.aRequest.getListItmIT())),e.AEnv.getIsWorkflowProcess()&&(this.aWorkflow=this.addActions("Workflow",null,!0,!1,!1,W),this.aWorkflow.setTextDirection("r"),C.append(this.aWorkflow.getListItmIT())),i.getIsCopyReocrd()&&(this.aCopy=this.addActions("CRD",null,!1,!1,!1,W),this.aCopy.setTextDirection("r"),C.append(this.aCopy.getListItmIT())),i.getIsSubscribedRecord()&&(this.aSubscribe=this.addActions("SRD",null,!0,!1,!1,W,!0),this.aSubscribe.setTextDirection("r"),C.append(this.aSubscribe.getListItmIT())),i.getIsZoomAcross()&&(this.aZoomAcross=this.addActions("ZAS",null,!0,!1,!1,W),this.aZoomAcross.setTextDirection("r"),C.append(this.aZoomAcross.getListItmIT())),e.MRole.getFormAccess(this.ctx.getContextAsInt("DMS_Form_ID"))&&(i.getIsCreatedDocument()&&(this.aCreateDocument=this.addActions("CDT",null,!1,!1,!1,W),this.aCreateDocument.setTextDirection("r"),C.append(this.aCreateDocument.getListItmIT())),i.getIsUploadedDocument()&&(this.aUploadDocument=this.addActions("UDT",null,!1,!1,!1,W),this.aUploadDocument.setTextDirection("r"),C.append(this.aUploadDocument.getListItmIT())),i.getIsViewDocument()&&(this.aViewDocument=this.addActions("VDT",null,!1,!1,!1,W,!0),this.aViewDocument.setTextDirection("r"),C.append(this.aViewDocument.getListItmIT())),i.getIsAttachDocumentFrom()&&(this.aAttachFrom=this.addActions("ADF",null,!1,!1,!1,W,!0),this.aAttachFrom.setTextDirection("r"),C.append(this.aAttachFrom.getListItmIT())),i.getIsGenerateAttachmentCode()&&(this.aGenerateAttachmentCode=this.addActions("CAC",null,!1,!1,!1,W),this.aGenerateAttachmentCode.setTextDirection("r"),C.append(this.aGenerateAttachmentCode.getListItmIT()))),i.getIsMarkToExport()&&(this.aMarkToExport=this.addActions("MTE",null,!1,!1,!1,W,!0),this.aMarkToExport.setTextDirection("r"),C.append(this.aMarkToExport.getListItmIT())),i.getIsImportMap()&&(this.aImportMap=this.addActions("IMP",null,!1,!1,!1,W),this.aImportMap.setTextDirection("r"),C.append(this.aImportMap.getListItmIT())),i.getIsArchive(),i.getIsAttachmail(),i.getIsRoleCenterView(),this.isPersonalLock&&(this.aLock=this.addActions("Lock",null,!0,!1,!1,W,!0),this.aLock.setTextDirection("r"),C.append(this.aLock.getListItmIT()),this.aRecAccess=this.addActions("RecordAccess",null,!0,!1,!1,W,!0),this.aRecAccess.setTextDirection("r"),C.append(this.aRecAccess.getListItmIT())),this.isShowSharedRecord&&"M"==i.getWindowType()?(this.aSharedRecord=this.addActions(this.ACTION_NAME_SHAREDREC,null,!0,!1,!1,W,!0),this.aSharedRecord.setTextDirection("r"),C.append(this.aSharedRecord.getListItmIT())):this.isShowSharedRecord=!1,this.aPreference=this.addActions("Preference",null,!1,!1,!0,W),e.MRole.getDefault().getIsShowPreference()&&y.append(this.aPreference.getListItmIT()),this.aHelp=this.addActions("Help",null,!0,!1,!0,W),y.append(this.aHelp.getListItmIT()),this.aCardDialog=this.addActions("CardDialog",null,!0,!1,!0,W),y.append(this.aCardDialog.getListItmIT()),this.aShowSummaryLevel=this.addActions("ShowSummaryNodes",null,!0,!1,!0,W,!0),y.append(this.aShowSummaryLevel.getListItmIT()),i=null,this.statusBar.setPageItem(this.aPageUp.getListItm()),this.statusBar.setComboPage(),this.statusBar.setPageItem(this.aPageDown.getListItm()),this.statusBar.render(),this.toolbarCreated=!0,this.setRightBarVisibility=function(e){e&&t(y.parent()[0]).removeClass("show")},A.show(),l.show(),e.Application.isMobile&&(w.hide(),I.addClass("vis-ad-w-p-a-main-mob"),c.addClass("vis-ad-w-p-t-c-mob")),U.vTabbedPane.finishLayout(e.Application.isMobile),U.gridWindow.getIsHideTabLinks()&&A.find("*").css("visibility","hidden"),H()},this.setDynamicActions=function(){if(null!=this.curGC){D.css("display","none");var e=0,t=[];if(this.curGC.leftPaneLinkItems.length>0)for(t=this.curGC.leftPaneLinkItems,e=0;e<t.length;e++)D.append(t[e].getControl());if(e=0,this.curGC.rightPaneLinkItems.length>0)for(t=this.curGC.rightPaneLinkItems,e=0;e<t.length;e++)D.append(t[e].getControl());(this.curGC.leftPaneLinkItems.length>0||this.curGC.rightPaneLinkItems.length>0)&&(D.css("display","flex"),this.updateLabelVisbility()),t=null}},this.getRoot=function(){return m},this.getLayout=function(){return a},this.getIncludedEmptyArea=function(){return S},this.getParentDetailPane=function(){return _},this.getFilterPane=function(){return N},this.clearSearchBox=function(){g.css("visibility","hidden"),U.defaultSearch=!0,U.clearSearchText(),u.val("")},this.showTabPanel=function(e){if(e){var t="vis-ad-w-p-center-flow-",a="vis-ad-w-p-actionpanel-";i=this.curTab.getIsTPBottomAligned()?"b":"r";var s=this.curTab.getIsTPBottomAligned()?"r":"b";R.hasClass(a+i)||(R.parent().removeClass(t+s).addClass(t+i),R.removeClass(),R.addClass(a+i)),this.curGC&&R.append(this.curGC.getTabPanel()),R.css({display:"grid"}),this.curGC.getIsSingleRow()&&"b"==i&&(this.getLayout().removeClass("vis-ad-w-p-center-view-height"),this.getLayout().find(".vis-ad-w-p-vc-editview").css("position","unset"))}else R.css({display:"none"})},this.showFilterPanel=function(e){this.curGC?(N.append(this.curGC.getFilterPanel()),this.curGC.initFilterUI(),e||this.curGC.refreshFilterPanelData()):P.hide()},this.setTabPanelclass=function(e){},this.getTabControl=function(){return d},this.getLinkControl=function(){return" New Link Control for header Composite"},this.setTabControl=function(t){G=t;for(var i=0;i<t.length;i++){var a=t[i].getListItm();F[G[i].action]=a,d.append(a)}d.width()>c.width()&&(e.Application.isMobile||h.show())},this.setTabNavigation=function(){d.width()>c.width()?e.Application.isMobile||h.show():h.hide()},this.setSelectedTab=function(e){this.selectedTab&&this.selectedTab.removeClass("vis-apanel-tab-selected"),this.selectedTab=F[e],this.selectedTab.addClass("vis-apanel-tab-selected")},this.navigateThroghtShortcut=function(e){var t=null;e?(!(t=d.find(".vis-apanel-tab-selected").nextAll("[style='opacity: 1;']:first"))||t.length<=0)&&(t=d.children().first()):(!(t=d.find(".vis-apanel-tab-selected").prevAll("[style='opacity: 1;']:first"))||t.length<=0)&&(t=d.children().last()),t.trigger("click")},this.setBusy=function(e,t){this.isLocked=e,b[0].style.visibility=e?"visible":"hidden"},this.startFilterPanel=function(e){e?(P.hide(),U.refresh()):(P.show(),this.refresh())},this.getTabSuffix=function(){return i},v.on("click",(function(e){U.startFilterPanel()})),x.on("click",(function(e){U.startFilterPanel(!0)})),h.on("click",(function(i){i.stopPropagation();var a=t(i.target).data("dir");if(a){var s=c.width(),n=d.width(),o=c.scrollLeft(),r=Math.ceil(s/2),l=0;if(e.Application.isRTL&&("r"==a?a="b":"rl"==a?a="bf":"bf"==a?a="rl":"b"==a&&(a="r")),"r"==a){if(o+r>=n-r&&!e.Application.isRTL)return;var h=n-s;l=o+r,c.animate({scrollLeft:l>h?h:l},1e3)}else if("b"==a)if(e.Application.isRTL)l=o-r,c.animate({scrollLeft:l>0?0:l},1e3);else{if(0==o)return;l=o-r,c.animate({scrollLeft:l<0?0:l},1e3)}if("rl"==a){if(o+r>=n-r)return;if(e.Application.isRTL)c.animate({scrollLeft:0},500);else{h=n-s;c.animate({scrollLeft:h},500)}}else if("bf"==a)if(e.Application.isRTL){h=n-s;c.animate({scrollLeft:-h},500)}else{if(0==o)return;l=o-r,c.animate({scrollLeft:0},500)}}})),w.on("click",(function(e){e.stopPropagation();var i=t(e.target).data("dir");if(i){var a=I.height(),s=C.height()+D.height(),n=I.scrollTop(),o=Math.ceil(a/2),r=0;if("d"==i){if(n+o>=s-o)return;var l=s-a;r=n+o,I.animate({scrollTop:r>l?l:r},1e3)}else if("u"==i){if(0==n)return;r=n-o,I.animate({scrollTop:r<0?0:r},1e3)}}})),p.on(e.Events.onTouchStartOrClick,(function(e){U.cmd_find(u.val()),U.clearSearchText(),u.val(""),e.stopPropagation()})),e.Application.isMobile||u.on("keyup",(function(t){var i=t.charCode||t.keyCode;if(13==i){if(!U.defaultSearch)return;U.cmd_find(u.val()),u.val("")}else if(8==i&&"visible"==g.css("visibility")){t.preventDefault(),U.defaultSearch=!0,u.val(""),g.css("visibility","hidden");var a=new e.Query;a.addRestriction(" 1 = 1 "),U.findRecords(a)}})),f.on("click",(function(){U.isAutoCompleteOpen?f.css("transform","rotate(360deg)"):(f.css("transform","rotate(180deg)"),U.refreshSavedASearchList(!0))})),g.on("click",(function(){g.css("visibility","hidden"),U.defaultSearch=!0,U.clearSearchText(),u.val("");var t=new e.Query;U.findRecords(t),f.css("transform","rotate(360deg)")})),this.setAdvancedSerachText=function(e,t){e?g.css("visibility","hidden"):(g.css("visibility","visible"),f.css("visibility","visible")),u.val(t)},this.toggleASearchIcons=function(e,t){e&&t?(g.css("visibility","visible"),f.css("visibility","visible")):e&&!t?(g.css("visibility","hidden"),f.css("visibility","visible")):(g.css("visibility","hidden"),f.css("visibility","hidden"))},this.setSearchFocus=function(e){e?u.focus():u.trigger("focusout")},this.refreshSavedASearchList=function(t,i){var a=[];a[0]=new e.DB.SqlParam("@AD_Tab_ID",U.curTab.getAD_Tab_ID()),a[1]=new e.DB.SqlParam("@AD_User_ID",parseInt(U.ctx.getAD_User_ID())),a[2]=new e.DB.SqlParam("@AD_Tab_ID1",U.curTab.getAD_Tab_ID()),a[3]=new e.DB.SqlParam("@AD_User_ID1",parseInt(U.ctx.getAD_User_ID())),a[4]=new e.DB.SqlParam("@AD_Client_ID",parseInt(U.ctx.getAD_Client_ID())),a[5]=new e.DB.SqlParam("@AD_Tab_ID2",U.curTab.getAD_Tab_ID()),a[6]=new e.DB.SqlParam("@AD_Table_ID",U.curTab.getAD_Table_ID());var n=this;s("VIS_116",a,(function(a){var s=[];if(a&&a.tables[0].rows&&a.tables[0].rows.length>0){f.css("visibility","visible"),s.push({label:e.Msg.getMsg("All"),value:e.Msg.getMsg("All"),code:e.Msg.getMsg("All")});for(var o=0;o<a.tables[0].rows.length;o++)a.tables[0].rows[o].cells.ad_defaultuserquery_id>0?(s.push({title:a.tables[0].rows[o].cells.title,label:a.tables[0].rows[o].cells.name,value:a.tables[0].rows[o].cells.name,code:a.tables[0].rows[o].cells.code,id:a.tables[0].rows[o].cells.ad_userquery_id,defaultids:a.tables[0].rows[o].cells.ad_defaultuserquery_id,userid:a.tables[0].rows[o].cells.ad_defaultuserquery_id}),!0):s.push({title:a.tables[0].rows[o].cells.title,label:a.tables[0].rows[o].cells.name,value:a.tables[0].rows[o].cells.name,code:a.tables[0].rows[o].cells.code,id:a.tables[0].rows[o].cells.ad_userquery_id})}else n.toggleASearchIcons(!1,!1);i||(i=u.val()),i&&i.length>0?(i.length>25?u.val(i.substr(0,25)+"..."):u.val(i),g.css("visibility","visible"),n.defaultSearch=!1):g.css("visibility","hidden"),u.autocomplete("option","source",s),t&&(u.autocomplete("search",""),u.trigger("focus"))}))},this.findRecords=function(t){this.curTab.getTableModel().setCurrentPage(1),this.isSummaryVisible?this.curTab.setShowSummaryNodes(!0):this.curTab.setShowSummaryNodes(!1),this.curGC.skipRowInserting(!0),t||(t=new e.Query),this.curGC.applyFilters(t)},this.setTitle=function(e){k.text(e)},this.highlightButton=function(t,i){var a=i.$li,s=this.getRoot();if(i.getAction()==this.ACTION_NAME_NEW){if((!t||u.val().length>0)&&(this.instructionPop[this.ACTION_NAME_NEW]=!0),this.instructionPop[this.ACTION_NAME_NEW])return void(s.find(".vis-window-instruc-overlay-new").length>0&&(s.find(".vis-window-instruc-overlay-new").remove(),a.removeClass("vis-window-instruc-overlay-new-li")));s.find(".vis-window-instruc-overlay-new").length<=0&&(s.prepend('<div class="vis-window-instruc-overlay-new"><div class="vis-window-instruc-overlay-new-inn"><p>'+e.Msg.getMsg("CreateNewRec")+"</p></div></div>"),a.addClass("vis-window-instruc-overlay-new-li"),this.instructionPop[this.ACTION_NAME_NEW]=!0)}},E.on("click",(function(e){U.$parentWindow.dispose()})),this.updateLabelVisbility=function(){parseInt(I.width())>50?(C.find("span").show(),D.find("span").show()):(C.find("span").hide(),D.find("span").hide())},T.on(e.Events.onTouchStartOrClick,(function(e){e.stopPropagation(),e.preventDefault();var t=parseInt(I.width());t>50?(C.find("span").hide(),D.find("span").hide()):I.css({position:"absolute"}),I.animate({width:t>50?"30":"220"},300,"swing",(function(){t<50?(C.find("span").show(),D.find("span").show()):(I.css({position:""}),I.css({width:""})),U.curGC&&U.curGC.multiRowResize(),U.setTabNavigation()}))})),this.disposeComponent=function(){if(p.off(e.Events.onTouchStartOrClick),u.remove(),u=null,T.off(e.onTouchStartOrClick),w.off("click"),h.off("click"),m.remove(),b.remove(),m=b=a=n=o=l=null,U=null,W=null,this.toolbarCreated&&(this.aRefresh.dispose(),this.aDelete.dispose(),this.aNew.dispose(),this.aSave.dispose(),this.aPrevious.dispose(),this.aFirst.dispose(),this.aLast.dispose(),this.aNext.dispose(),this.aPageUp.dispose(),this.aPageFirst.dispose(),this.aPageLast.dispose(),this.aPageDown.dispose(),this.aCard.dispose(),this.aCardDialog.dispose(),this.aShowSummaryLevel&&this.aShowSummaryLevel.dispose(),this.aChat&&this.aChat.dispose(),this.aAppointment&&this.aAppointment.dispose(),this.aBatchUpdate&&this.aBatchUpdate.dispose(),this.aHelp.dispose(),this.aSubscribe&&this.aSubscribe.dispose(),this.aAttachment&&this.aAttachment.dispose(),this.aHistory&&this.aHistory.dispose(),this.aZoomAcross&&this.aZoomAcross.dispose(),this.aRequest&&this.aRequest.dispose(),this.aMarkToExport&&this.aMarkToExport.dispose(),this.aWorkflow&&this.aWorkflow.dispose(),this.aRecAccess&&this.aRecAccess.dispose(),this.aImportMap&&this.aImportMap.dispose(),this.aRefresh=this.aDelete=this.aNew=this.aPrevious=this.aFirst=this.aLast=this.aNext=null,this.aChat=this.aPageUp=this.aPageFirst=this.aPageLast=this.aPageDown=null,this.aHelp=this.aSubscribe=this.aAttachment=null,this.toolbarCreated=null,this.aZoomAcross=this.aRequest=this.aMark=this.aWorkflow=this.aHistory=null,this.aAppointment=null,this.aBatchUpdate=null,this.aRecAccess=this.aImportMap=this.aCard=this.aCardDialog=this.aShowSummaryLevel=null),this.statusBar.dispose(),this.statusBar.onComboChange=null,this.statusBar=null,this.getRoot=null,this.getLayout=null,this.setBusy=null,this.createToolBar=null,this.$parentWindow=null,this.ctx=null,this.curGC=null,this.curST=null,this.curTab=null,this.vTabbedPane=null,this.curWinTab=null,this.curTabIndex=null,this.firstTabId=null,_.remove(),_=null,this.getParentDetailPane=null,G)for(var t=0;t<G.length;t++)G[t].dispose();G=null,F=null,d.remove()}}l.prototype.ACTION_NAME_FIRST="First",l.prototype.ACTION_NAME_LAST="Last",l.prototype.ACTION_NAME_PREV="Previous",l.prototype.ACTION_NAME_NEXT="Next",l.prototype.ACTION_NAME_PAGEDOWN="PageDown",l.prototype.ACTION_NAME_PAGEUP="PageUp",l.prototype.ACTION_NAME_NEW="NRD",l.prototype.ACTION_NAME_DELETE="DRD",l.prototype.ACTION_NAME_REFRESH="RQY",l.prototype.ACTION_NAME_FIND="Find",l.prototype.ACTION_NAME_CHAT="CHT",l.prototype.ACTION_NAME_APPOINTMENT="Appointment",l.prototype.ACTION_NAME_ARCHIVE="Archive",l.prototype.ACTION_NAME_SHAREDREC="RSD";var d=null;function c(i,a,s,n,o,r,l){var d=i.getName(),c=!1,u=!0;try{if(1==i.getAskUserBGProcess()||1==i.getIsBackgroundProcess()){var p=t('<div class="vis-confirm-popup-check"><label>'+e.Msg.translate(e.context,"IsBackgroundProcess")+"</label></div>"),g=t('<input type="checkbox">'),f=i.getIsBackgroundProcess();g.prop("checked",f),g.prop("disabled",f),p.prepend(g),e.ADialog.confirmCustomUI("StartProcess?",!0,i.getDescription()+"\n"+i.getHelp(),"Confirm",p,(function(e){if(e)return isBg=g.is(":checked"),h(i,a,s,n,l,o,c,d,isBg)}))}else{var v=i.getIsBackgroundProcess();if(r||i.getDescription().equals("")&&i.getHelp().equals("")||(u=!1,e.ADialog.confirm("StartProcess?",!0,i.getDescription()+"\n"+i.getHelp(),"Confirm",(function(e){if(e)return h(i,a,s,n,l,o,c,d,v)}))),u)return h(i,a,s,n,l,o,c,d,v)}}catch(t){e.ADialog.error("Error?",!0,"error in process : "+t.message),c=!1}return!1}function h(t,i,a,s,n,o,r,l,d){var c=t.getDescription();null!=c&&0!=c.length||(c=l);var h=new e.ProcessInfo(c,t.getProcess_ID(),i,a);h.setAD_User_ID(s.getAD_User_ID()),h.setAD_Client_ID(s.getAD_Client_ID()),h.setAD_Window_ID(void 0===o.$parentWindow?0:o.$parentWindow.AD_Window_ID),h.setUseCrystalReportViewer(s.getIsUseCrystalReportViewer()),h.setIsBatch(n),h.setIsBackground(d);var u=new e.ProcessCtl(o,h,null);return t.isPdf?h.setFileType(e.ProcessCtl.prototype.REPORT_TYPE_PDF):t.isCsv&&h.setFileType(e.ProcessCtl.prototype.REPORT_TYPE_CSV),u.process(o.curWindowNo),!0,o=null,t=null,n=!1,startWOasking=!1,actionProcessAfterSave=null,true}function u(i,a){if(window.VADMS){if("CDT"==a){var s=new e.CFrame,n=new window.VADMS.editDocument(0,"",0,"",0,null,"",i.curTab.getAD_Window_ID(),i.curTab.getAD_Table_ID(),i.curTab.getRecord_ID());s.setName(e.Msg.getMsg("VADMS_CreateDocument")),s.setTitle(e.Msg.getMsg("VADMS_CreateDocument")),s.hideHeader(!0),s.setContent(n),n.initialize(),s.show()}else if("ADF"==a){var o=e.context.getContext("VADMS_Document_ID");if(o.length>0){var r={docID:o,winID:i.curTab.getAD_Window_ID(),tableID:i.curTab.getAD_Table_ID(),recID:i.curTab.getRecord_ID()};t.ajax({url:e.Application.contextUrl+"JsonData/AttachFrom",dataType:"json",data:r,success:function(t){"OK"==JSON.parse(t)?(i.curTab.loadDocuments(),i.aViewDocument.setPressed(i.curTab.hasDocument()),e.ADialog.confirm("AttachWithOther",!0,"","Confirm",(function(t){t||e.context.setContext("VADMS_Document_ID",0)})),i=null):e.ADialog.error("NotAttached",!0,"")}})}}else if("VDT"==a){s=new e.CFrame;var l=new window.VADMS.DocumentManagementSystem;s.setName(e.Msg.getMsg("VADMS_Document")),s.setTitle(e.Msg.getMsg("VADMS_Document")),s.hideHeader(!0),l.setWindowNo(e.Env.getWindowNo()),l.setWindowID(i.curTab.getAD_Window_ID()),l.setTableID(i.curTab.getAD_Table_ID()),l.setRecordID(i.curTab.getRecord_ID()),l.setWindowName(i.gridWindow.getName()),s.setContent(l),l.initialize(),s.show()}else if("UDT"==a)window.VADMS.uploaddocument(0,i.curTab.getAD_Window_ID(),i.curTab.getAD_Table_ID(),i.curTab.getRecord_ID(),i.$parentWindow.name,i.curTab.getName());else if("CAC"==a){var d=i.curTab.getAD_Window_ID()+"|"+i.curTab.getAD_Table_ID()+"|"+i.curTab.getRecord_ID()+"|"+i.$parentWindow.name+"|"+i.curTab.getName();e.context.setContext("VADMS_WinTableRecID",d),e.ADialog.info("VADMS_CodeSetIntoContext",!0,"")}}else e.ADialog.error("PleaseInstallDMSModule",!0,"")}l.prototype.keyDown=function(e){if(!e.ctrlKey&&e.altKey&&this.curGC){var t=this.aNew.getIsEnabled();switch(e.keyCode){case 78:t&&this.actionPerformed(this.aNew.getAction());break;case 83:this.ShortcutNavigation(this.aSave.getAction());break;case 66:t&&this.aBack.getIsEnabled()&&this.actionPerformed(this.aBack.getAction());break;case 68:t&&this.actionPerformed(this.aDelete.getAction());break;case 90:t||this.actionPerformed(this.aIgnore.getAction());break;case 80:t&&this.actionPerformed(this.aPrint.getAction());break;case 82:t&&this.actionPerformed(this.aReport.getAction());break;case 81:t&&this.actionPerformed(this.aRefresh.getAction());break;case 65:this.actionPerformed(this.aFind.getAction());break;case 70:this.setSearchFocus(!0);break;case 37:this.ShortcutNavigation(this.aFirst.getAction());break;case 39:this.ShortcutNavigation(this.aLast.getAction());break;case 38:this.ShortcutNavigation(this.aPrevious.getAction());break;case 40:this.ShortcutNavigation(this.aNext.getAction());break;case 84:this.curGC&&this.curGC.getIsSingleRow()?this.actionPerformed(this.aMulti.getAction()):this.actionPerformed(this.aSingle.getAction());break;case 86:this.actionPerformed(this.aCard.getAction());break;case 88:this.$parentWindow.dispose();break;case 79:this.startFilterPanel();break;case 33:if(e.ctrlKey){this.aPageFirst.isEnabled&&this.ShortcutNavigation(this.aPageFirst.getAction());break}this.aPageUp.isEnabled&&this.ShortcutNavigation(this.aPageUp.getAction());break;case 34:if(e.ctrlKey){this.aPageLast.isEnabled&&this.ShortcutNavigation(this.aPageLast.getAction());break}this.aPageDown.isEnabled&&this.ShortcutNavigation(this.aPageDown.getAction())}e.preventDefault(),e.stopPropagation()}else 112==e.keyCode?(this.actionPerformed(this.aHelp.getAction()),e.preventDefault(),e.stopPropagation()):e.altKey&&33==e.keyCode?e.ctrlKey?this.aPageFirst.isEnabled&&this.ShortcutNavigation(this.aPageFirst.getAction()):this.aPageUp.isEnabled&&this.ShortcutNavigation(this.aPageUp.getAction()):e.altKey&&34==e.keyCode?e.ctrlKey?this.aPageLast.isEnabled&&this.ShortcutNavigation(this.aPageLast.getAction()):this.aPageDown.isEnabled&&this.ShortcutNavigation(this.aPageDown.getAction()):this.vTabbedPane&&this.vTabbedPane.keyDown&&this.vTabbedPane.keyDown(e);9===e.keyCode&&this.compositViewChangeSave(e)},l.prototype.ShortcutNavigation=function(e){var i=this,a=t(document.activeElement);a&&a.length>0&&a.trigger("change"),window.setTimeout((function(){i.actionPerformed(e)}),200)},l.prototype.sizeChanged=function(e,t){this.setTabNavigation(),this.vTabbedPane.sizeChanged()},l.prototype.refresh=function(){this.curGC&&(this.curGC.vTable.resize(),this.curGC.vIncludedGC&&this.curGC.vIncludedGC.vTable.refresh()),this.vTabbedPane.refresh()},l.prototype.refreshData=function(){var e=this;window.setTimeout((function(){e.curTab.getAD_Tab_ID()==e.firstTabId.split("_")[1]?e.curGC.dataRefreshAll():e.selectFirstTab(!1,(function(){e.curGC.dataRefreshAll()})),e.setBusy(!1)}),100),this.setBusy(!0)},l.prototype.addActions=function(t,i,a,s,n,o,r,l,d){var c={action:t,parent:i,enableDisable:a,toggle:r,imageOnly:s,isSmall:n,onAction:o,toolTipText:l};return d&&(c.iconName=d),t=new e.AppsAction(c)},l.prototype.compositViewChangeSave=function(i){var a=this;if(t(i.target).closest(".vis-ad-w-p-center-inctab").length>0||t(i.target).closest(".vis-ad-w-p-vc").length>0){var s=t(document.activeElement);setTimeout((function(){var i=t(document.activeElement).closest(".vis-ad-w-p-center-inctab").length>0?"vis-ad-w-p-center-inctab":"vis-ad-w-p-vc";if(d||(d=i),d!==i&&""!==d){if("vis-ad-w-p-vc"==d){var n=a.vTabbedPane.contentPane.curTab.getLastFocus();a.vTabbedPane.contentPane.curTab.setLastFocus(null),n&&a.curTab.setLastFocus(n)}if("vis-ad-w-p-center-inctab"==d){n=a.curTab.getLastFocus();a.curTab.setLastFocus(null),a=a.vTabbedPane.contentPane,n&&a.curTab.setLastFocus(n)}if(null!=a.curGC)if(a.curTab.needSave(!0,!1))if(a.curTab.needSave(!0,!0))if(e.Env.getCtx().isAutoCommit(a.curWindowNo)){if("vis-ad-w-p-vc"==d)if(!a.curGC.IsCheckListRequire())return a.curTab.getLastFocus().focus(),!1;if(!a.curTab.dataSave(!0))return!1;a.curTab.setLastFocus(s)}else canExecute=!1,e.ADialog.confirm("SaveChanges?",!0,a.curTab.getCommitWarning(),"Confirm",(function(e){if(e){if(!a.curTab.dataSave(!0))return!1;a.curTab.setLastFocus(s)}}));else a.curTab.setLastFocus(s);else a.curTab.setLastFocus(s);else a.curTab.setLastFocus(s)}else a.curTab.setLastFocus(s);d=i}),100)}},l.prototype.showHideViewIcon=function(e){null!=this.curTab&&null!=this.curGC?(null!=this.actionParams.IsHideGridToggle?this.actionParams.IsHideGridToggle?this.aMulti.hide():this.aMulti.show():this.curTab.getIsHideGridToggle()?this.aMulti.hide():this.aMulti.show(),null!=this.actionParams.IsHideSingleToggle?this.actionParams.IsHideSingleToggle?this.aSingle.hide():this.aSingle.show():this.curTab.getIsHideSingleToggle()?this.aSingle.hide():this.aSingle.show(),null!=this.actionParams.IsHideCardToggle?this.actionParams.IsHideCardToggle?this.aCard.hide():this.aCard.show():this.curTab.getIsHideCardToggle()?this.aCard.hide():this.aCard.show(),e.hide()):(this.aMulti.hide(),this.aSingle.hide(),this.aCard.hide())},l.prototype.initPanel=function(i,a,s,n,o){this.$parentWindow=s;var r=new e.GridWindow(i);this.gridWindow=r,this.createToolBar();var l=s.getWindowNo(),d=this.ctx.isAutoNew(),c=r.getTabs();this.ctx.setAutoCommit(l,this.ctx.isAutoCommit()),this.ctx.setAutoNew(l,d),this.ctx.setIsSOTrx(l,r.getIsSOTrx()),!d&&r.getIsTransaction()&&this.ctx.setAutoNew(l,!0),this.ctx.setContext(l,"WindowName",r.getName());var h,u=r.getIsCompositeView();if(this.vTabbedPane.init(this,u),!a&&o){a=new e.Query;var p=c[0].getKeyColumnName();0==p.length&&(p=c[0].getLinkColumnName()),0!=p.length&&(p.endsWith("_ID"),a.addRestriction(p,e.Query.prototype.EQUAL,o))}for(var g=[],f={},v=!1,m=!0,b=0;b<c.length;b++){var y=l+"_"+c[b].getAD_Tab_ID(),T={action:y,text:c[b].getName(),toolTipText:c[b].getDescription(),textOnly:!0,iconName:"",isHideTab:c[b].getIsHideTabName()};c[b].getTabLevel()>0&&(T.textOnly=!1,c[b].getTabLevel()>3?T.iconName="tl-4":T.iconName="tl-"+c[b].getTabLevel()),g[b]=new e.AppsAction(T),h=c[b],m&&(0===b&&(null==a||null!=a.list&&0==a.list.length||-10==a.list[0].code)?(this.curTab=h,this.firstTabId=y,v=!0,m=!1,null!=a&&h.setQuery(a)):null!=a&&null!=a.list&&a.list.length>0&&a.list[0].columnName&&h.getKeyColumnName().toUpperCase()==a.list[0].columnName.toUpperCase()&&(this.firstTabId=y,h.setQuery(a),this.curTab=h,v=!0,m=!1,b>0&&this.setParentsContext(c,b)));var C=null;if(h.getIsSortTab()){C=new e.VSortTab(l,h.getAD_Table_ID(),h.getAD_ColumnSortOrder_ID(),h.getAD_ColumnSortYesNo_ID(),h.getIsReadOnly(),y),0==b&&(firstTabId=y)}else{var D=new e.GridController(!0,!0,y);if(D.initGrid(!1,l,this,h),v&&(this.curGC=D,v=!1),0!==b||v||(this.curTab=h,this.curGC=D,this.firstTabId=y,h.getIsHeaderPanel()&&(D.initHeaderPanel(this.getParentDetailPane()),this.vHeaderPanel=D.vHeaderPanel,h.isHPanelNotShowInMultiRow&&"Y"!=h.getTabLayout()&&(D.vHeaderPanel.hidePanel(),D.vHeaderPanel.sizeChangedListner&&D.vHeaderPanel.sizeChangedListner.onSizeChanged&&D.vHeaderPanel.sizeChangedListner.onSizeChanged()))),D.initFilterPanel(l,this.getFilterPane()),C=D,0===b&&n&&(this.showHideViewIcon(this.aSingle),D.switchSingleRow()),0!=h.getIncluded_Tab_ID()&&(f[h.getIncluded_Tab_ID()]=D),h.getHasPanel()&&D.initTabPanel(r.getWindowWidth(),l),!u&&!t.isEmptyObject(f)){var I=f[h.getAD_Tab_ID()];if(null!=I)I.includeTab(D)}}this.vTabbedPane.addTab(y,h,C,g[b]),g[b].onAction=this.onTabChange}m&&null!=a&&null!=a.list&&a.list.length>0&&this.curTab.setQuery(a),this.vTabbedPane.setTabControl(g),g=null,this.ctx.setWindowContext(l,"WindowName",i._vo.DisplayName),s.setTitle(e.Env.getHeader(this.ctx,l)),this.setTitle(e.Env.getHeader(this.ctx,l)),s.setName(i._vo.DisplayName),this.curWindowNo=l,u&&this.setIncTabReziable(),i=null,s=null},l.prototype.setIncTabReziable=function(){var e=this.getIncludedEmptyArea(),t=this;e.is(".ui-resizable")||e.resizable({handles:"n",ghost:!0,minHeight:40,maxHeight:500,resize:function(t,i){e.css("flex-basis",i.size.height+"px")},start:function(e,t){},stop:function(i,a){e.css({"flex-basis":a.size.height+"px",top:"",width:""}),t.refresh()}})},l.prototype.setIncTabReziable=function(){var e=this.getIncludedEmptyArea(),t=this;e.is(".ui-resizable")||e.resizable({handles:"n",ghost:!0,minHeight:40,maxHeight:500,resize:function(t,i){e.css("flex-basis",i.size.height+"px")},start:function(e,t){},stop:function(i,a){e.css({"flex-basis":a.size.height+"px",top:"",width:""}),t.refresh()}})},l.prototype.setParentsContext=function(t,i){for(var a=[],s=t[i].query.list[0].code,n=i-1;n>=0;n--)t[n].getTabLevel()!=t[i].getTabLevel()&&t[n].getTabLevel()<t[i].getTabLevel()&&(a.push({TabNo:t[n].getTabNo(),columnName:t[n].getKeyColumnName(),childTableKeyColumn:t[i].getKeyColumnName(),index:n}),i=n);if(a){var o=t[i].getWindowNo();for(n=0;n<a.length;n++){s&&(t[a[n].index].query.addRestriction(a[n].childTableKeyColumn,e.Query.prototype.EQUAL,s),t[a[n].index].setIsZoomAction(!0));var r={SelectColumn:a[n].columnName,SelectTable:a[n].childTableKeyColumn.substr(0,a[n].childTableKeyColumn.length-3),WhereColumn:a[n].childTableKeyColumn,WhereValue:s};(s=e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/GetZoomParentRec",r))&&e.context.setWindowContext(o,a[n].columnName,s.toString())}}},l.prototype.selectFirstTab=function(e){this.curTab.setIsZoomAction(e),setTimeout((function(e){e.tabActionPerformed(e.firstTabId),e.setTabNavigation(),e=null}),10,this)},l.prototype.getIsUILocked=function(){return this.isLocked},l.prototype.lockUI=function(e){this.setBusy(!0,!1)},l.prototype.unlockUI=function(i){var a=null!=i&&i.getAD_Process_ID()!=this.curTab.getAD_Process_ID();if(a)if(this.curTab.dataRefresh(),i.getIsTimeout()&&e.context.setWindowContext(this.curWindowNo,"Processed","Y"),this.curGC.dynamicDisplay(-1),this.setStatusLine(i.getSummary(),i.getIsError()),i.customHTML&&""!=i.customHTML)this.displayDialog(t(i.customHTML));else{e.ProcessInfoUtil.setLogFromDB(i);var s=i.getLogInfo();s.length>0&&(e.ADialog.info(i.getTitle(),!0,s,""),this.setStatusLine(i.getSummary(),i.getIsError()))}this.setBusy(!1,a)},l.prototype.displayDialog=function(i){var a=new e.ChildDialog;a.setTitle("");var s=window.innerWidth-150,n=window.innerHeight-120,o=t('<div style="max-height: '+n+"px; max-width: "+s+'px; min-width: 150px; min-height: 60px;"></div>');o.append(i),a.setContent(o),a.close=function(){a.dispose()},a.show(),a.hidebuttons()},l.prototype.actionPerformed=function(t,i){if(!this.getIsUILocked()){if(t.source instanceof e.Controls.VButton){var a=t.source.getField();if(!this.getIsWindowAction(a.getAD_Reference_Value_ID())&&!a.getIsAction()&&(!a.getIsEditable(!0)||this.curTab.getIsReadOnly()))return}this.setBusy(!0);var s=this;setTimeout((function(){if(t.source instanceof e.Controls.VButton){var a=t.source.getField().vo.DefaultValue;return s.getIsWindowAction(t.source.mField.getAD_Reference_Value_ID())&&s.toolbarActionList.indexOf(a)>-1?void s.actionPerformedCallback(s,a):void(s.actionButton(t.source,i)||s.setBusy(!1,!0))}s.actionPerformedCallback(s,t)}),10)}},l.prototype.actionPerformedCallback=function(t,i){if("Multi"===i||"Card"===i||"Single"===i){var a="Y";if("Multi"===i?a="N":"Single"===i?a="Y":"Card"===i&&(a="C"),this.tabStack.length>0){var s=this.curWinTab.getSelectedIndex(),n=this.tabStack.find((function(e){return e.tabSeq===s}));n.tabView.includes(a)&&(n.tabView=[]),n.tabView.push(a)}this.setBackEnable()}t.aFirst.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigate(0)):t.aPrevious.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigateRelative(-1)):t.aLast.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigate(t.curTab.getRowCount()-1)):t.aNext.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigateRelative(1)):t.aSingle.getAction()===i?(t.showHideViewIcon(t.aSingle),t.curGC.switchSingleRow(!0)):t.aMulti.getAction()===i?(t.showHideViewIcon(t.aMulti),t.curGC.switchMultiRow()):t.aCard.getAction()===i?(t.showHideViewIcon(t.aCard),t.curGC.switchCardRow()):t.aMap.getAction()===i?t.curGC.switchMapRow():t.aBack.getAction()===i?t.cmd_back():t.aPageUp.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigatePage(-1)):t.aPageFirst.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigatePage(0)):t.aPageDown.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigatePage(1)):t.aPageLast.getAction()===i?(t.isDefaultFocusSet=!1,t.curGC.navigatePage("last")):t.aRefresh.getAction()===i?t.cmd_refresh():t.aIgnore.getAction()===i?t.cmd_ignore():t.aSave.getAction()===i?t.cmd_save(!0):t.aNew.getAction()===i?t.cmd_new(!1):t.aCopy&&t.aCopy.getAction()===i?t.cmd_new(!0):t.aDelete.getAction()===i?t.cmd_delete():t.aFind.getAction()===i?t.cmd_finddialog():t.aBatchUpdate&&t.aBatchUpdate.getAction()===i?t.cmd_batchUpdatedialog():t.aChat&&t.aChat.getAction()===i?t.cmd_chat():t.aAttachment&&t.aAttachment.getAction()===i?t.cmd_attachment():t.aHistory&&t.aHistory.getAction()==i?t.cmd_history():t.aPreference.getAction()===i?t.cmd_preference():t.aHelp.getAction()===i?t.cmd_help():t.aCardDialog.getAction()===i?t.cmd_cardDialog():t.aAppointment&&t.aAppointment.getAction()===i?t.cmd_appointment():t.aTask&&t.aTask.getAction()===i?t.cmd_task():t.aSubscribe&&t.aSubscribe.getAction()===i?t.cmd_subscribe():t.aImportMap&&t.aImportMap.getAction()===i?t.cmd_ImportMap():t.aEmail&&t.aEmail.getAction()===i?t.cmd_email():t.aLetter&&t.aLetter.getAction()===i?t.cmd_letter():t.aSms&&t.aSms.getAction()===i?t.cmd_sms():t.aInfo.getAction()===i?t.cmd_infoWindow():t.aZoomAcross&&t.aZoomAcross.getAction()===i?t.cmd_zoomAcross():t.aRequest&&t.aRequest.getAction()===i?t.cmd_request():t.aReport.getAction()===i?t.cmd_report():t.isPersonalLock&&t.aLock.getAction()===i?t.cmd_lock():t.isPersonalLock&&t.aRecAccess.getAction()===i?t.cmd_recAccess():t.isShowSharedRecord&&t.aSharedRecord.getAction()===i?t.cmd_RecordShared():null!=t.aWorkflow&&i===t.aWorkflow.getAction()?t.curTab.getRecord_ID()>0&&e.AEnv.startWorkflowProcess(t.curTab.getAD_Table_ID(),t.curTab.getRecord_ID()):t.aPrint.getAction()===i?t.cmd_print():t.aCreateDocument&&t.aCreateDocument.getAction()===i||t.aUploadDocument&&t.aUploadDocument.getAction()===i||t.aViewDocument&&t.aViewDocument.getAction()===i||t.aAttachFrom&&t.aAttachFrom.getAction()===i||t.aGenerateAttachmentCode&&t.aGenerateAttachmentCode.getAction()===i?u(t,i):t.aMarkToExport&&t.aMarkToExport.getAction()===i?t.cmd_markToExport():t.aShowSummaryLevel.getAction()==i&&t.ShowSummaryNodes(),t.setRightBarVisibility(!0),t.setBusy(!1),t=null},l.prototype.actionButton=function(t,i){var a=!1,s=!1,n=t.getColumnName(),o=e.context;i||(i=this);var r=this,l=0,d=0,c=0;if(i.curTab&&(l=i.curTab.getTabNo(),d=o.getTabRecordContext(r.curWindowNo,l,"AD_Table_ID",!1),c=o.getTabRecordContext(r.curWindowNo,l,"Record_ID",!1)),d<0&&(d=o.getContextAsInt(r.curWindowNo,"AD_Table_ID")),c<0&&(c=o.getContextAsInt(r.curWindowNo,"Record_ID")),!n.equals("Record_ID")){var h=!0;return t.getField().getIsAction()&&"MTU"===t.getField().getAction()?(r.cmd_ignore(),r.tabActionPerformed(r.vTabbedPane.getNextTabId(t.getField().getTabSeqNo()),t.getField().getAction(),t.getField().getActionParams()),h=!1):i.curTab.needSave(!0,!1)&&(h=!1,i.cmd_save(!0,(function(e){e&&r.actionButtonCallBack(t,a,s,null,n,o,i)}))),h?r.actionButtonCallBack(t,a,s,null,n,o,i):void 0}e.AEnv.zoom(d,c)},l.prototype.actionButtonCallBack=function(i,a,s,n,o,r,l){var d=l.curTab.getAD_Table_ID(),c=l.curTab.getRecord_ID(),h=l.curTab,p=l.curGC,g=this,f=this.curWindowNo,v=i.getField();if(-1==c&&h.getKeyColumnName().equals("AD_Language")&&(c=r.getContextAsInt(f,"AD_Language_ID")),-1==c&&(306==i.getProcess_ID()||307==i.getProcess_ID())){var m=h.getValue("AD_ChangeLog_ID");c=m}if(-1==c&&h.getKeyColumnName().equals("EntityType")&&(c=h.getValue("AD_EntityType_ID")),-1==c&&h.getKeyColumnName().toUpperCase().endsWith("_ID"))e.ADialog.error("SaveErrorRowNotFound",!0,"");else{if(v.getIsAction())return this.tabActionPerformed(this.vTabbedPane.getNextTabId(v.getTabSeqNo()),v.getAction(),v.getActionName(),v.getActionParams()),!0;if(o.equals("PaymentRule")){var b=new e.VPayment(f,h,i);return b.show(),b.init(),void(b.onClose=function(){b.isInitOK()&&(p.dynamicDisplay(i.getName()),p.cmd_save(!1),this.checkAndCallProcess(i,d,c,r,l,a,s))})}if(o.equals("DocAction")){var y=new e.VDocAction(f,h,c);return y.show(),void(y.onClose=function(){if(0==y.getNumberOfOptions())return y.dispose(),void g.log.info("DocAction - No Options");y.isStartProcess()?(s=y.isBatch(),a=!0,g.checkAndCallProcess(i,d,c,r,l,a,s),y.dispose(),l=null):y.dispose()})}if(o.equals("CreateFrom")){var T=!1;if(341==h.getAD_Window_ID()||170==h.getAD_Window_ID())if(window.MMPM){MMPM.Requisition.prototype.create(h.getAD_Window_ID(),h.getRecord_ID());T=!0}else if(window.DTD001){DTD001.Requisition.prototype.create(h.getAD_Window_ID(),h.getRecord_ID());T=!0}if(T)return;var C=e.VCreateFrom.prototype.create(h);if(null!=C)return void(C.isInitOK()?(C.showDialog(),C.onClose=function(e){C.dispose(),h.dataRefresh()},C=null):C.dispose())}else{if(o.equals("GenerateSticker")){if(window.DTD001)DTD001.StickerProduct.prototype.create(h.getAD_Window_ID(),h.getRecord_ID());return}if(o.equals("DTD001_GenerateSticker")){if(window.DTD001)DTD001.MRProductSticker.create(h.getAD_Window_ID(),h.getRecord_ID(),h.getTabLevel());return}if(o.equals("BGT01_CreateLinePo"))return void(window.BGT01&&BGT01.CreateLineMovement(h.getAD_Window_ID(),h.getAD_Tab_ID(),h.getRecord_ID()));if("Posted"==o&&e.MRole.getDefault().getIsShowAcct()){if("Y"!=e.context.getWindowContext(f,"Processed")){var D=e.context.getWindowContext(f,"DocStatus");if(this.DocActionVariables.STATUS_COMPLETED!=D&&this.DocActionVariables.STATUS_CLOSED!=D&&this.DocActionVariables.STATUS_REVERSED!=D&&this.DocActionVariables.STATUS_VOIDED!=D)return void e.ADialog.info(e.Msg.getMsg("PostDocNotComplete"))}var I=h.getValue("Posted");if(null!=I&&"Y"==I){var w=new e.AcctViewer(e.context.getAD_Client_ID(),h.getAD_Table_ID(),h.getRecord_ID(),f,h.getAD_Window_ID());null!=w&&(g.setBusy(!1),w.showDialog()),w=null}else e.ADialog.confirm("PostImmediate?",!0,"","Confirm",(function(i){if(!i)return g.setBusy(!1,!0),!1;g.setBusy(!0,!0);var a,s=null!=I&&"N"!=I;a=function(i){var a=!1;if("Yes"==i&&(a=!0),window.FRPT&&a){var n=Number(e.context.getWindowTabContext(f,0,"AD_Org_ID")),o=h.getAD_Window_ID(),r=Number(e.context.getWindowTabContext(f,0,"C_DocType_ID"));FRPT.PostingLogic(f,h.getAD_Table_ID(),h.getRecord_ID(),s,n,o,r,(function(){p.dataRefresh(),g.setBusy(!1,!0)}))}else t.ajax({url:e.Application.contextUrl+"Posting/PostImmediate",dataType:"json",data:{AD_Client_ID:e.context.getAD_Client_ID(),AD_Table_ID:h.getAD_Table_ID(),Record_ID:h.getRecord_ID(),force:s},error:function(t){g.setBusy(!1,!0),e.ADialog.info("ERRORGettingPostingServer")},success:function(t){"OK"!=t.result?(g.setBusy(!1,!0),e.ADialog.info(t.result)):(g.setBusy(!1,!0),p.dataRefresh())}})},t.ajax({url:e.Application.contextUrl+"Posting/PostByNewLogic",dataType:"json",async:!0,data:{AD_Client_ID:e.context.getAD_Client_ID()},error:function(t){e.ADialog.info(e.Msg.getMsg("ERRORGettingPostingServer"))},success:function(e){a&&a(e.result)}})}));return!1}if(o.equals("SendNewEMail"))return;o.equals("OpenCardDialog")&&g.cmd_cardDialog(!0)}if(i.AD_Process_ID>0){var S=this.checkAndCallProcess(i,d,c,r,l);return l=null,S}if(i.AD_Form_ID>0)if(e.MRole.getFormAccess(i.AD_Form_ID))new e.WForm(e.Env.getScreenHeight(),i.AD_Form_ID,h,f);else e.ADialog.warn("AccessTableNoView");if(g.getIsWindowAction(i.mField.getAD_Reference_Value_ID())){switch(i.mField.vo.DefaultValue){case"APT":g.cmd_appointment();break;case"BUE":g.cmd_batchUpdatedialog();break;case"EML":g.cmd_email();break;case"SMS":g.cmd_sms();break;case"LER":g.cmd_letter();break;case"TAK":g.cmd_task();break;case"CHT":g.cmd_chat();break;case"ATT":g.cmd_attachment(i.getField().evaluateLogicsOnly());break;case"HIY":g.cmd_history();break;case"CRT":g.cmd_request();break;case"CRD":g.cmd_new(!0);break;case"SRD":g.cmd_subscribe();break;case"ZAS":g.cmd_zoomAcross();break;case"MTE":g.cmd_markToExport();break;case"IMP":g.cmd_ImportMap();break;case"RSD":g.cmd_RecordShared();break;case"NRD":g.cmd_new();break;case"SAR":g.cmd_save(!1);break;case"DRD":g.cmd_delete();break;case"RQY":g.cmd_refresh();break;case"BVW":g.cmd_back();break;case"UNO":g.cmd_ignore();break;case"RET":g.cmd_report();break;case"PRT":g.cmd_print();break;default:u(g,i.value)}h=p=g=null}}},l.prototype.checkAndCallProcess=function(e,t,i,a,s,n,o){if(0!=e.getProcess_ID()){var r=!0,l=this;return s.curTab.needSave(!0,!1)&&(r=!1,s.cmd_save(!0,(function(s){return s?c(e,t,i,a,l,n,o):void 0}))),r?c(e,t,i,a,l,n,o):void 0}},l.prototype.tabActionPerformed=function(a,s,n,o){if(("WIW"==s||"FOM"==s)&&""!=n){var r={tableID:this.curTab.getAD_Table_ID(),actionType:s,actionName:n},l=this;return l.setBusy(!0),void t.ajax({url:i+"JsonData/CheckTableMapWithAction",type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(r)}).done((function(i){l.setBusy(!1),list=JSON.parse(i);var a=t("<div>"),s=t("<ul class=vis-apanel-rb-ul>");if(a.append(s),list.length>1){for(var n in list){var o=t("<li data-id='"+list[n].ID+"' data-action='"+list[n].ActionType+"'>");o.append(list[n].Name),o.on("click",(function(i){i.stopImmediatePropagation();var a=t(this).data("id"),s=t(this).data("action");e.viewManager.startAction(s,a);var n=t("#w2ui-overlay-main");n.hide(),n=null})),s.append(o)}t(document.activeElement).w2overlay(a.clone(!0),{align:"right",css:{height:"200px"}})}else 1==list.length&&e.viewManager.startAction(list[0].ActionType,list[0].ID)})).error((function(){l.setBusy(!1)}))}if(!this.vTabbedPane.getIsTabChanged(a))return console.log("tabNotChange"),!1;var d=!1,c=!1,h=this.vTabbedPane.getTabElement(a),u=this.curST||this.curGC,p=null;if("OTD"==s)return e.TabMngr.show(h,u.gTab.keyColumnName,u.gTab.getRecord_ID()),void this.vTabbedPane.restoreTabChange();this.toggleASearchIcons(!1,!1),this.setAdvancedSerachText(!0,"");var g=this;if(this.vTabbedPane.getIsWorkbench());else{this.curWinTab=this.vTabbedPane;var f=this.curWinTab.getSelectedIndex();d=f<this.curTabIndex;var v=null,m=null;h instanceof e.VSortTab?(m=h,c=!0):v=h;var b=!0;if(null!=this.curGC){if(this.curTab.needSave(!0,!1))if(this.curTab.needSave(!0,!0))if(this.ctx.isAutoCommit(this.curWindowNo)){if(!this.curGC.IsCheckListRequire())return this.vTabbedPane.restoreTabChange(),this.setBusy(!1,!0),e.ADialog.error("CheckListRequired"),!1;if(!this.curTab.dataSave(!0))return this.vTabbedPane.restoreTabChange(),this.setBusy(!1,!0),!1}else b=!1,e.ADialog.confirm("SaveChanges?",!0,this.curTab.getCommitWarning(),"Confirm",(function(e){if(e){if(!g.curTab.dataSave(!0))return g.vTabbedPane.restoreTabChange(),g.setBusy(!1,!0),!1}else g.curTab.dataIgnore();u=g.curGC,p=g.curGC,g.curGC=null,null!=g.curST&&(g.curST.saveData(),g.curST.unRegisterAPanel(),u=g.curST,g.curST=null),g.curTabIndex=f,c||(g.curGC=v),g.tabActionPerformedCallback(a,d,c,h,u,p,v,m)}));else g.curTab.dataIgnore();b&&(u=this.curGC,p=this.curGC,this.curGC=null)}b&&(null!=this.curST&&(this.curST.saveData(),this.curST.unRegisterAPanel(),u=this.curST,this.curST=null),this.curTabIndex=f,c||(this.curGC=v)),this.actionParams=o||{};var y=f,T=a;this.curWindowNo;this.tabStack=this.tabStack.filter((function(e){return e.tabSeq<=y}));var C=void 0;this.tabStack.length>0&&(C=this.tabStack.find((function(e){return e.tabSeq===y}))),C||this.tabStack.push({tabSeq:y,tabID:T,tabView:[c?"":v.getMTab().getTabLayout()]})}return b&&g.tabActionPerformedCallback(a,d,c,h,u,p,v,m),!0},l.prototype.tabActionPerformedCallback=function(t,i,a,s,n,o,r,l){n.setVisible(!1),n.getRoot().detach(),this.getLayout().prepend(s.getRoot()),this.vTabbedPane.setSelectedTab(t);var d=i;if(a)s.setVisible(!0),this.curST=l,l.registerAPanel(this),l.loadData();else{var c=r.getMTab();if(s.setVisible(!0),r.activate(o,this.actionParams),o&&o.detachDynamicAction(),this.curTab=r.getMTab(),this.setDynamicActions(),!this.curTab.getIsZoomAction()&&this.curTab.getTabLevel()>0){var h=new e.Query;this.curTab.query=h,d=!1}var u=c.getTabLayout();if(i&&this.curTab.getIsCurrent()){if(this.curTab.getTabLevel(),this.curTab.searchText?this.setAdvancedSerachText(!1,this.curTab.searchText):this.curTab.hasSavedAdvancedSearch&&this.toggleASearchIcons(!0,!1),r.dataRefresh(),this.tabStack.length>0){var p=this.curWinTab.getSelectedIndex(),g=this.tabStack.find((function(e){return e.tabSeq===p}));g.tabView.length>0&&(u=g.tabView[g.tabView.length-1])}}else{var f=c.getIsResetLayout();if(this.actionParams.TabLayout&&["N","Y","C"].indexOf(this.actionParams.TabLayout)>-1&&(u=this.actionParams.TabLayout,f=!0),f&&("N"==u?r.switchMultiRow():"Y"==u?r.switchSingleRow(!0):"C"==u&&r.switchCardRow(!0)),this.curTab.getTableModel().setCurrentPage(1),!this.curGC.onDemandTree||r.isZoomAction){if(this.clearSearchText(),this.setDefaultSearch(r),""!=(this.actionParams.TabWhereClause||"")){var v=new e.Query(this.curTab.getTableName(),!1);v.addRestriction(this.actionParams.TabWhereClause),this.curTab.setQuery(v,!0)}r.query(this.curTab.getOnlyCurrentDays(),0,!1)}else this.setDefaultSearch(r)}"N"==u?this.showHideViewIcon(this.aMulti):"Y"==u?this.showHideViewIcon(this.aSingle):"C"==u&&this.showHideViewIcon(this.aCard),this.curGC.onDemandTree?this.aShowSummaryLevel.show():this.aShowSummaryLevel.hide()}var m=null;this.curGC?m=this.curGC.vGridPanel:(m={}).setEnabled=function(e,t){},a?(this.showHideViewIcon(null),this.aCardDialog.setEnabled(!1),this.aNew.setEnabled(!1),this.aDelete.setEnabled(!1),this.aFind.setEnabled(!1),this.aBatchUpdate.setEnabled(!1),this.aRefresh.setEnabled(!1),this.aNext.setEnabled(!1),this.aLast.setEnabled(!1),this.aFirst.setEnabled(!1),this.aPrevious.setEnabled(!1),this.aPageFirst.setEnabled(!1),this.aPageUp.setEnabled(!1),this.aPageLast.setEnabled(!1),this.aPageDown.setEnabled(!1)):(this.aCardDialog.setEnabled(!0),this.aFind.setEnabled(!0),this.aBatchUpdate&&this.aBatchUpdate,this.aRefresh.setEnabled(!0),m.setEnabled("RQY",!0)),this.showTabPanel(!this.actionParams.IsHideTabPanel&&this.curTab.getHasPanel()),this.showFilterPanel(d),null!=this.actionParams.IsShowFilterPanel&&this.startFilterPanel(!this.actionParams.IsShowFilterPanel),this.refresh(),this.setTabNavigation(),this.aParentDetail&&this.aParentDetail.evaluate(s),n=s=null,0==this.curTab.getAD_Process_ID()?(this.aPrint.setEnabled(!1),m.setEnabled("PRT",!1)):(this.aPrint.setEnabled(!0),m.setEnabled("PRT",!0)),!this.actionParams.IsHideMapToggle&&this.curTab.getIsMapView()?this.aMap.show():this.aMap.hide(),this.actionParams.IsHideRecordNav||this.curTab.getIsHideRecordNav()?(this.aNext.hide(),this.aPrevious.hide()):(this.aNext.show(),this.aPrevious.show()),this.actionParams.IsHideToolbar||this.gridWindow.getIsHideToolbar()?this.hideToolbar(!0):this.hideToolbar(!1),this.actionParams.IsHideTabLinks||this.gridWindow.getIsHideTabLinks()?this.hideTabLinks(!0):this.hideTabLinks(!1),this.actionParams.IsHideTabLinks||this.gridWindow.getIsHideTabLinks()?this.hideTabLinks(!0):this.hideTabLinks(!1),this.actionParams.IsHideActionbar||this.gridWindow.getIsHideActionbar()?this.hideActionbar(!0):this.hideActionbar(!1)},l.prototype.onQueryCompleted=function(){},l.prototype.onQueryCompleted=function(){},l.prototype.setDefaultSearch=function(t){var i=this,a=[];a[0]=new e.DB.SqlParam("@AD_Tab_ID",this.curTab.getAD_Tab_ID()),a[1]=new e.DB.SqlParam("@AD_User_ID",parseInt(this.ctx.getAD_User_ID())),a[2]=new e.DB.SqlParam("@AD_Tab_ID1",this.curTab.getAD_Tab_ID()),a[3]=new e.DB.SqlParam("@AD_User_ID1",parseInt(this.ctx.getAD_User_ID())),a[4]=new e.DB.SqlParam("@AD_Client_ID",parseInt(this.ctx.getAD_Client_ID())),a[5]=new e.DB.SqlParam("@AD_Tab_ID2",this.curTab.getAD_Tab_ID()),a[6]=new e.DB.SqlParam("@AD_Table_ID",this.curTab.getAD_Table_ID());var n=s("VIS_117",a);if(n&&n.tables[0].rows&&n.tables[0].rows.length>0)if(i.curTab.hasSavedAdvancedSearch=!0,0!=i.curTab.getTabLevel()||t.gTab.getIsZoomAction())i.toggleASearchIcons(!0,!1);else{for(var o=!1,r=0;r<n.tables[0].rows.length;r++)if(n.tables[0].rows[r].cells.ad_defaultuserquery_id>0){o=!0,i.setAdvancedSerachText(!1,n.tables[0].rows[r].cells.name);var l=new e.Query(i.curTab.getTableName(),!1);l.addRestriction(n.tables[0].rows[r].cells.code),i.curTab.setQuery(l),i.defaultSearch=!1,i.curTab.searchText=n.tables[0].rows[r].cells.name,toastr.success(e.Msg.getMsg("DefaultSerachExist"),"",{timeOut:4e3,positionClass:"toast-top-center",closeButton:!0})}i.curTab.hasSavedAdvancedSearch,i.toggleASearchIcons(!0,o)}else i.toggleASearchIcons(!1,!1),i.setAdvancedSerachText(!0,"")},l.prototype.dataStatusChanged=function(t){var i=null;this.curGC?i=this.curGC.vGridPanel:(i={}).setEnabled=function(e,t){};var a=t.getMessage();(this.curTab.getIsQueryActive()||this.curTab.getOnlyCurrentDays()>0)&&(a="[ "+a+" ]"),this.statusBar.setStatusDB(a,t);var s=this;if(null!=t.getAD_Message()||null!=t.getInfo()){var n=new StringBuilder,o=t.getAD_Message();null!=o&&o.length>0&&n.append(e.Msg.getMsg(t.getAD_Message()));var r=t.getInfo();if(null!=r&&r.length>0&&(n.length()>0&&!n.endsWith(":")&&n.append(": "),n.append(r)),n.length()>0)-1!=n.indexOf("\n")&&n.replace("\n"," - "),this.setStatusLine(n.toString(),t.getIsError())}t.getIsError()&&!t.getIsConfirmed()?(e.ADialogCallback.error(t.getAD_Message(),t.getInfo(),null,(function(){var e=s.curTab.getLastFocus();e&&(e.focus(),s.curTab.setLastFocus(null))})),t.setConfirmed(!0),this.errorDisplayed=!0):t.getIsWarning()&&!t.getIsConfirmed()&&(e.ADialogCallback.warn(t.getAD_Message(),t.getInfo(),null,(function(){var e=s.curTab.getLastFocus();e&&(e.focus(),s.curTab.setLastFocus(null))})),t.setConfirmed(!0));var l=t.getIsFirstRow();this.aFirst.setEnabled(!l),this.aPrevious.setEnabled(!l);var d=t.getIsLastRow();this.aNext.setEnabled(!d),this.aLast.setEnabled(!d);var c=t.getIsFirstPage();this.aPageFirst.setEnabled(!c),this.aPageUp.setEnabled(!c);var h=t.getIsLastPage();this.aPageLast.setEnabled(!h),this.aPageDown.setEnabled(!h);var u=t.getIsChanged()||t.getIsInserting(),p=this.curTab.getIsReadOnly(),g=!p;g&&(g=this.curTab.getIsInsertRecord()),this.aNew.setEnabled(!u&&g),i.setEnabled("NRD",!u&&g),this.aCopy&&this.aCopy.setEnabled(!u&&g),this.aRefresh.setEnabled(!u),i.setEnabled("RQY",!u),this.aDelete.setEnabled(!u&&!p&&t.getCurrentRow()>-1&&!this.actionParams.IsDeleteDisabled),i.setEnabled("DRD",!u&&!p&&t.getCurrentRow()>-1&&!this.actionParams.IsDeleteDisabled),p&&this.curTab.getIsAlwaysUpdateField()&&(p=!1),this.aIgnore.setEnabled(u&&!p),i.setEnabled("UNO",u&&!p),this.aSave.setEnabled(u&&!p),i.setEnabled("SAR",u&&!p),this.aCardDialog.setEnabled(!u),0==t.getTotalRows()&&g?(this.aNew.setEnabled(!0),i.setEnabled("NRD",!0),this.aDelete.setEnabled(!1),i.setEnabled("DRD",!0),this.curGC.isZoomAction||this.highlightButton(!0,this.aNew)):this.highlightButton(!1,this.aNew),this.setBackEnable(),this.aChat&&this.aChat.setPressed(this.curTab.hasChat()),this.aAttachment&&this.aAttachment.setPressed(this.curTab.hasAttachment()),this.aMarkToExport&&this.aMarkToExport.setPressed(this.curTab.hasMarked()),this.aSubscribe&&this.aSubscribe.setPressed(this.curTab.HasSubscribed()),this.isPersonalLock&&(this.aLock.setEnabled(!0),i.setEnabled(this.aLock.getAction(),!0),this.aLock.setPressed(this.curTab.getIsLocked()),this.aRecAccess.setEnabled(!0),i.setEnabled(this.aRecAccess.getAction(),!0)),this.isShowSharedRecord&&this.aSharedRecord&&(this.curTab.getValue("AD_Org_ID")>0&&-1==this.excludeFromShare.indexOf(this.curTab.getTableName().toLowerCase())?(this.aSharedRecord.setEnabled(!0),i.setEnabled(this.aSharedRecord.getAction(),!0),this.aSharedRecord.setPressed(this.curTab.hasShared())):(this.aSharedRecord.setEnabled(!1),i.setEnabled(this.aSharedRecord.getAction(),!1))),-1==this.curTab.getRecord_ID()?(this.aChat&&(this.aChat.setEnabled(!1),i.setEnabled(this.aChat.getAction(),!1)),this.aAttachment&&(this.aAttachment.setEnabled(!1),i.setEnabled(this.aAttachment.getAction(),!1)),this.aSubscribe&&(this.aSubscribe.setEnabled(!1),i.setEnabled(this.aSubscribe.getAction(),!1)),this.aHistory&&(this.aHistory.setEnabled(!1),i.setEnabled(this.aHistory.getAction(),!1)),this.aEmail&&(this.aEmail.setEnabled(!1),i.setEnabled(this.aEmail.getAction(),!1)),this.aLetter&&(this.aLetter.setEnabled(!1),i.setEnabled(this.aLetter.getAction(),!1)),this.aSms&&(this.aSms.setEnabled(!1),i.setEnabled(this.aSms.getAction(),!1)),this.aFaxEmail&&(this.aFaxEmail.setEnabled(!1),i.setEnabled(this.aFaxEmail.getAction(),!1)),this.aCreateDocument&&(this.aCreateDocument.setEnabled(!1),i.setEnabled(this.aCreateDocument.getAction(),!1)),this.aUploadDocument&&(this.aUploadDocument.setEnabled(!1),i.setEnabled(this.aUploadDocument.getAction(),!1)),this.aViewDocument&&(this.aViewDocument.setEnabled(!1),i.setEnabled(this.aViewDocument.getAction(),!1)),this.aAttachFrom&&(this.aAttachFrom.setEnabled(!1),i.setEnabled(this.aAttachment.getAction(),!1)),this.aZoomAcross&&(this.aZoomAcross.setEnabled(!1),i.setEnabled(this.aZoomAcross.getAction(),!1)),this.aMarkToExport&&(this.aMarkToExport.setEnabled(!1),i.setEnabled(this.aMarkToExport.getAction(),!1)),this.aArchive&&(this.aArchive.setEnabled(!1),i.setEnabled(this.aArchive.getAction(),!1)),this.aEmailAttach&&(this.aEmailAttach.setEnabled(!1),i.setEnabled(this.aEmailAttach.getAction(),!1)),this.aAppointment&&(this.aAppointment.setEnabled(!1),i.setEnabled(this.aAppointment.getAction(),!1)),this.aTask&&(this.aTask.setEnabled(!1),i.setEnabled(this.aTask.getAction(),!1)),this.aRequest&&(this.aRequest.setEnabled(!1),i.setEnabled(this.aRequest.getAction(),!1)),this.aWorkflow&&(this.aWorkflow.setEnabled(!1),i.setEnabled(this.aWorkflow.getAction(),!1)),this.aCopy&&(this.aCopy.setEnabled(!1),i.setEnabled(this.aCopy.getAction(),!1)),this.aLock&&(this.aLock.setEnabled(!1),i.setEnabled(this.aLock.getAction(),!1)),this.aRecAccess&&(this.aRecAccess.setEnabled(!1),i.setEnabled(this.aRecAccess.getAction(),!1)),this.aSharedRecord&&(this.aSharedRecord.setEnabled(!1),i.setEnabled(this.aSharedRecord.getAction(),!1)),this.aBatchUpdate&&(this.aBatchUpdate.setEnabled(!1),i.setEnabled(this.aBatchUpdate.getAction(),!1))):(this.aChat&&(this.aChat.setEnabled(!0),i.setEnabled(this.aChat.getAction(),!0)),this.aAttachment&&(this.aAttachment.setEnabled(!0),i.setEnabled(this.aAttachment.getAction(),!0)),this.aSubscribe&&(this.aSubscribe.setEnabled(!0),i.setEnabled(this.aSubscribe.getAction(),!0)),this.aHistory&&(this.aHistory.setEnabled(!0),i.setEnabled(this.aHistory.getAction(),!0)),this.aEmail&&(this.aEmail.setEnabled(!0),i.setEnabled(this.aEmail.getAction(),!0)),this.aLetter&&(this.aLetter.setEnabled(!0),i.setEnabled(this.aLetter.getAction(),!0)),this.aSms&&(this.aSms.setEnabled(!0),i.setEnabled(this.aSms.getAction(),!0)),this.aFaxEmail&&(this.aFaxEmail.setEnabled(!0),i.setEnabled(this.aFaxEmail.getAction(),!0)),this.aImportMap&&(this.aImportMap.setEnabled(!0),i.setEnabled(this.aImportMap.getAction(),!0)),this.aCreateDocument&&(this.aCreateDocument.setEnabled(!0),i.setEnabled(this.aCreateDocument.getAction(),!0)),this.aUploadDocument&&(this.aUploadDocument.setEnabled(!0),i.setEnabled(this.aUploadDocument.getAction(),!0)),this.aViewDocument&&(this.aViewDocument.setEnabled(!0),i.setEnabled(this.aViewDocument.getAction(),!0)),this.aAttachFrom&&(this.aAttachFrom.setEnabled(!0),i.setEnabled(this.aAttachFrom.getAction(),!0)),this.aZoomAcross&&(this.aZoomAcross.setEnabled(!0),i.setEnabled(this.aZoomAcross.getAction(),!0)),this.aMarkToExport&&(this.aMarkToExport.setEnabled(!0),i.setEnabled(this.aMarkToExport.getAction(),!0)),this.aArchive&&(this.aArchive.setEnabled(!0),i.setEnabled(this.aArchive.getAction(),!0)),this.aEmailAttach&&(this.aEmailAttach.setEnabled(!0),i.setEnabled(this.aEmailAttach.getAction(),!0)),this.aAppointment&&(this.aAppointment.setEnabled(!0),i.setEnabled(this.aAppointment.getAction(),!0)),this.aTask&&(this.aTask.setEnabled(!0),i.setEnabled(this.aTask.getAction(),!0)),this.aRequest&&(this.aRequest.setEnabled(!0),i.setEnabled(this.aRequest.getAction(),!0)),this.aWorkflow&&(this.aWorkflow.setEnabled(!0),i.setEnabled(this.aWorkflow.getAction(),!0)),this.aCopy&&(this.aCopy.setEnabled(!0),i.setEnabled(this.aCopy.getAction(),!0)),this.aLock&&(this.aLock.setEnabled(!0),i.setEnabled(this.aLock.getAction(),!0)),this.aBatchUpdate&&(this.aBatchUpdate.setEnabled(!0),i.setEnabled(this.aBatchUpdate.getAction(),!0))),t.getIsInserting()?this.statusBar.setInfo(null):this.setStatusInfo(t.getRecord_ID()),this.curWinTab==this.vTabbedPane&&(e.context.setContext(this.curWindowNo,"tb_Index",this.curTabIndex),this.curWinTab.evaluate(null),this.curWinTab.notifyDataChanged(t)),this.curTab.getParentTab()&&this.aSharedRecord&&(this.curTab.loadShared(),this.aSharedRecord.setPressed(this.curTab.hasShared()))},l.prototype.setStatusInfo=function(t){!t&&this.curTab&&(t=this.curTab.getRecord_ID());var i=this;e.GridTab.prototype.getFooterInfo(this.curTab.getTableName(),e.context,this.curTab.getWindowNo(),this.curTab.getTabNo(),t).then((function(e){i&&i.statusBar&&i.statusBar.setInfo(e)}),(function(e){i&&i.statusBar&&i.statusBar.setInfo(e)}))},l.prototype.setStatusLine=function(e,t){this.statusBar.setStatusLine(e,t)},l.prototype.cmd_refresh=function(){this.curGC.dataRefreshAll()},l.prototype.cmd_ignore=function(){this.curGC.dataIgnore()},l.prototype.cmd_help=function(){new e.Apps.help(this.gridWindow)},l.prototype.cmd_cardDialog=function(t){new e.CVDialog(this,t).show()},l.prototype.cmd_save=function(e,t){if(null!=this.curST&&(e=!1),this.errorDisplayed=!1,null!=this.curST)return this.curST.saveData(),this.aSave.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled("SAR",!1));var i=this;return i.cmd_save2(e,i.curTab,i.curGC,i,t)},l.prototype.cmd_save2=function(t,i,a,s,n){var o=!0;if(i.getCommitWarning().length>0&&i.needSave(!0,!1)&&(o=!1,e.ADialog.confirm("SaveChanges?",!0,i.getCommitWarning(),"Confirm",(function(e){if(e){var i=a.dataSave(t);t&&!i&&s.errorDisplayed,a.refreshTabPanelData(s.curTab.getRecord_ID()),t&&a.dynamicDisplay(-1),n&&n(i)}}))),o){var r=a.dataSave(t);return t&&!r&&s.errorDisplayed,t&&a.dynamicDisplay(-1),n&&n(r),a.refreshTabPanelData(i.getRecord_ID()),this.curTab.loadShared(),this.aSharedRecord&&this.aSharedRecord.setPressed(this.curTab.hasShared()),r}},l.prototype.cmd_new=function(t){this.curTab.isCurrentRecordShare&&t?e.ADialog.info("ActionNotAllowedHere"):this.curTab.getIsInsertRecord()&&(this.curGC.setNewRecordLayout(),this.curGC.dataNew(t))},l.prototype.cmd_batchUpdatedialog=function(){if(!this.curTab.getIsReadOnly()){var t=new e.BatchUpdate(this.curWindowNo,this.curTab,this.curGC.getSelectedRows());t.onClose=function(){},t.show()}},l.prototype.cmd_delete=function(){if(!this.curTab.getIsReadOnly())if(this.curTab.IsSharedReadOnly)e.ADialog.error("CannotDelete",!0,"");else{var t=this.curGC.canDeleteRecords();if(t.length>0)e.ADialog.error("CannotDelete",!0," [ "+t.join(",")+"]");else{var i=this;e.ADialog.confirm("DeleteRecord?",!0,"","Confirm",(function(e){e&&i.curGC.dataDeleteAsync()}))}}},l.prototype.cmd_back=function(){var e=this;if(this.tabStack.length>0){var t=this.tabStack[this.tabStack.length-1];if(t.tabView.length>0){this.tabStack[this.tabStack.length-1].tabView.pop();var i=t.tabView[t.tabView.length-1];"N"==i?(e.showHideViewIcon(e.aMulti),e.curGC.switchMultiRow()):"Y"==i?(e.showHideViewIcon(e.aSingle),e.curGC.switchSingleRow(!0)):"C"==i&&(e.showHideViewIcon(e.aCard),e.curGC.switchCardRow(!0))}}this.setBackEnable(),this.tabStack.length>1&&0===this.tabStack[this.tabStack.length-1].tabView.length&&(this.tabStack.pop(),(t=this.tabStack[this.tabStack.length-1])&&Object.keys(t).length>0?(this.curTab.needSave(!0,!1)&&this.curTab.needSave(!0,!0)&&this.cmd_ignore(),this.onTabChange(t.tabID)):this.setBackEnable())},l.prototype.cmd_find=function(e){if(this.curTab)if(this.defaultSearch){this.setBusy(!0);var t=null;e&&""!==e.trim()&&(e="%"+e+"%",t=this.curTab.getSearchQuery(e)),this.findRecords(t)}else this.defaultSearch=!0},l.prototype.cmd_chat=function(){var t=this.curTab.getRecord_ID();if(-1==t)return this.aChat.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aChat.getAction(),!1));for(var i=null,a=null,s=0;s<this.curTab.getFieldCount();s++){var n=this.curTab.getField(s);if(n.getIsKey()&&(i=n.getHeader()),"Name"!=n.getColumnName().toString()&&"DocumentNo"!=n.getColumnName().toString()||null==n.getValue()||""==n.getValue()||(a=n.getValue()),null!=i&&null!=a)break}var o=this,r=new e.Chat(t,this.curTab.getCM_ChatID(),this.curTab.getAD_Table_ID(),i+": "+a,this.curWindowNo);r.onClose=function(){o.curTab.loadChats(),o.aChat.setPressed(o.curTab.hasChat()),o=null},r.show()},l.prototype.cmd_appointment=function(){var t=this.curTab.getRecord_ID(),i=this.curTab.getAD_Table_ID();-1!=t&&e.AppointmentsForm.init(i,t,0,0,!1,!0)},l.prototype.cmd_task=function(){var t=this.curTab.getRecord_ID(),i=this.curTab.getAD_Table_ID();-1!=t&&e.AppointmentsForm.init(i,t,0,0,!0)},l.prototype.cmd_letter=function(){var t=this.curTab.getRecord_ID();if(-1==t)return this.aLetter.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aLetter.getAction(),!1));var i=new e.Email("",this.curTab,this.curGC,t,!1),a=new e.CFrame;a.setName(e.Msg.getMsg("Letter")),a.setTitle(e.Msg.getMsg("Letter")),a.hideHeader(!0),a.setContent(i),a.show(),i.initializeComponent()},l.prototype.cmd_email=function(){var t=this.curTab.getRecord_ID();if(-1==t)return this.aEmail.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aEmail.getAction(),!1));var i=new e.Email("",this.curTab,this.curGC,t,!0),a=new e.CFrame;a.setName(e.Msg.getMsg("EMail")),a.setTitle(e.Msg.getMsg("EMail")),a.hideHeader(!0),a.setContent(i),a.show(),i.initializeComponent()},l.prototype.cmd_report=function(){if(e.MRole.getDefault().getIsCanReport(this.curTab.getAD_Table_ID()))if(this.curTab.needSave(!0,!1))this.cmd_save(!0);else{var t=null;(t=this.curTab.query&&this.curTab.query.list.length>0?this.curTab.query:new e.Query(this.curTab.getTableName())).tableName=this.curTab.getTableName();var i=this.curTab.getLinkColumnName();0==i.length&&(i=this.curTab.getKeyColumnName());for(var a=null,s=null,n=0,o=this.curTab.getFieldCount();n<o;n++){var r=this.curTab.getField(n);if(r.getIsKey()&&(a=r.getHeader()),"Name"!=r.getColumnName()&&"DocumentNo"!=r.getColumnName()||null==r.getValue()||(s=r.getValue()),null!=a&&null!=s)break}var l=0==this.curTab.getParentColumnNames().length;if(0!=i.length&&(!l||null!=this.curTab.getLinkColumnName()&&""!=this.curTab.getLinkColumnName())&&(i.endsWith("_ID")?null==a&&null==s?t.addRestriction(i,e.Query.prototype.EQUAL,e.context.getContextAsInt(this.curWindowNo,i)):t.addRestriction(i,e.Query.prototype.EQUAL,e.context.getContextAsInt(this.curWindowNo,i),a,s):null==a&&null==s?t.addRestriction(i,e.Query.prototype.EQUAL,e.context.getContext(this.curWindowNo,i)):t.addRestriction(i,e.Query.prototype.EQUAL,e.context.getContext(this.curWindowNo,i),a,s)),this.curGC.onDemandTree)if(this.isSummaryVisible)new e.AReport(this.curTab.getAD_Table_ID(),t,this.curTab.getAD_Tab_ID(),this.curWindowNo,this.curTab,this.curGC.treeID,this.curGC.treeNodeID,!0);else new e.AReport(this.curTab.getAD_Table_ID(),t,this.curTab.getAD_Tab_ID(),this.curWindowNo,this.curTab,this.curGC.treeID,this.curGC.treeNodeID,!1);else new e.AReport(this.curTab.getAD_Table_ID(),t,this.curTab.getAD_Tab_ID(),this.curWindowNo,this.curTab,0,0,!1)}else e.ADialog.warn("AccessCannotReport")},l.prototype.cmd_print=function(){var t=this.curGC.getSelectedRows();if(0!=t.length){var i=this.curTab.getAD_Process_ID();if(0!=i){var a="VIS_118",s=[];s[0]=new e.DB.SqlParam("@AD_Process_ID",i);var o=n(a,s),r=n(a="VIS_119");if(t.length>1&&o>0&&r&&r.toString()>"1.0.0.3"){if(this.curTab.needSave(!0,!1))return void this.cmd_save(!0);for(var l="",d=0;d<t.length;d++)0==d?l=t[d][this.curTab.getKeyColumnName().toLower()]:l+=","+t[d][this.curTab.getKeyColumnName().toLower()];new e.APrint(i,this.curTab.getAD_Table_ID(),0,this.curWindowNo,l,this.curTab,!0).start(this.aPrint.getListItmIT())}else{var c=this.curTab.getRecord_ID();if(-1==c)return void e.ADialog.info(e.Msg.getMsg("SelectRecord"));if(this.curTab.needSave(!0,!1))return void this.cmd_save(!0);new e.APrint(i,this.curTab.getAD_Table_ID(),c,this.curWindowNo,null,this.curTab).start(this.aPrint.getListItmIT())}}}else e.ADialog.info("SelectRecord")},l.prototype.cmd_sms=function(){var t=this.curTab.getRecord_ID();if(-1==t)return this.aSms.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aSms.getAction(),!1));var i=new e.Sms(this.curTab,this.curGC,t,!1),a=new e.CFrame;a.setName(e.Msg.getMsg("Sms")),a.setTitle(e.Msg.getMsg("Sms")),a.hideHeader(!0),a.setContent(i),a.show(),i.initializeComponent()},l.prototype.cmd_subscribe=function(){var t=this.curTab.getRecord_ID();if(-1==t)return this.aSubscribe.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aSubscribe.getAction(),!1));var i=this;e.dataContext.subscribeUnsubscribeRecords(this.curTab.getCM_SubScribedID(),this.curTab.getAD_Window_ID(),t,this.curTab.getAD_Table_ID(),(function(){i.curTab.loadSubscribe(),i.aSubscribe.setPressed(i.curTab.HasSubscribed())}))},l.prototype.cmd_ImportMap=function(){if(window.VDIU){if(this.curTab.getIsReadOnly())return void e.ADialog.warn("ReadOnly");var t=new VDIU.ImportExcel(this.curTab.getAD_Window_ID(),this.gridWindow.getName()),i=new e.CFrame;i.setName(e.Msg.getMsg("Import")),i.setTitle(e.Msg.getMsg("Import")),i.setContent(t),i.show(),t.initialize()}else e.ADialog.error("PleaseInstallExcelImportModule")},l.prototype.cmd_attachment=function(t){if(this.curTab.getRecord_ID()<1)return this.aAttachment.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aAttachment.getAction(),!1));var i=this,a=new e.attachmentForm(this.curTab.getWindowNo(),0,this.curTab.getAD_Table_ID(),this.curTab.getRecord_ID(),"",null,null,null,t);a.setIsWindowAction(!0),a.show(),a.onClose=function(){i.curTab.loadAttachments(),i.aAttachment&&i.aAttachment.setPressed(i.curTab.hasAttachment()),i=null}},l.prototype.cmd_history=function(){var t=0,i=0;(Object.keys(this.curGC.getColumnNames()).indexOf("C_BPartner_ID")>0||null!=this.curTab.getField("C_BPartner_ID")&&this.curTab.getField("C_BPartner_ID").getValue()>0)&&(t=this.curTab.getField("C_BPartner_ID").getValue()),(Object.keys(this.curGC.getColumnNames()).indexOf("AD_User_ID")>0||null!=this.curTab.getField("AD_User_ID")&&this.curTab.getField("AD_User_ID").getValue()>0)&&(i=this.curTab.getField("AD_User_ID").getValue()),new e.AttachmentHistory(this.curTab.getAD_Table_ID(),this.curTab.getRecord_ID(),t,i,this.curTab.getKeyColumnName()).show()},l.prototype.cmd_RecordShared=function(){if(this.curTab.getRecord_ID()<1)return this.aSharedRecord.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aSharedRecord.getAction(),!1));if(this.curTab.isCurrentRecordShare)e.ADialog.info("ActionNotAllowedHere");else if(this.curGC.getSelectedRows().length>1)e.ADialog.info("ShareOneRecordOnly");else{var i="Y";if(t.ajax({url:e.Application.contextUrl+"JsonData/CheckAccessForAction",dataType:"json",async:!1,data:{columnName:"ShowSharedRecords",roleID:e.context.getAD_Role_ID()},error:function(e){},success:function(e){i=JSON.parse(e)}}),"Y"!=i)return e.ADialog.info("ActionNotAllowedHere"),!1;var a=this,s=0;if(this.curTab.getParentTab()&&(s=this.curTab.getParentTab().getAD_Table_ID(),!this.curTab.getParentTab().hasShared()&&0!=this.curTab.getParentTab().getValue("AD_Org_ID")))return e.ADialog.info("ShareParentFirst",!0,"",""),void this.aSharedRecord.setPressed(!1);var n=new e.RecordShared(this.curTab.getRecord_ID(),this.curTab.getAD_Table_ID(),this.curTab.getAD_Tab_ID(),this.curTab.getAD_Window_ID(),this.curWindowNo,this.curTab.linkValue,s,this.curTab);n.onClose=function(){a.curTab.loadShared(),a.aSharedRecord.setPressed(a.curTab.hasShared()),a=null},n.show()}},l.prototype.clearSearchText=function(){this.curGC&&(this.curGC.searchCode="",this.curTab.searchText="")},l.prototype.cmd_finddialog=function(){var t=new e.Find(this.curWindowNo,this.curTab,0),i=this,a="";t.onClose=function(){if(t.getIsOKPressed()||t.needRefresh()){i.setAdvancedSerachText(!0,""),i.clearSearchText(),i.isSummaryVisible?i.curTab.setShowSummaryNodes(!0):i.curTab.setShowSummaryNodes(!1);var s=t.getQuery(),n=t.getCurrentDays(),o=t.getIsCreated();if(a=t.getSavedQueryName(),i.curTab.userQueryID=t.getSavedID(),t.dispose(),t=null,i.curTab.getTableModel().setCurrentPage(1),null!=s&&s.getIsActive())i.curTab.setQuery(s),i.curGC.query(0,0,o);else if(null!=s){var r=e.MRole.getDefault().getMaxQueryRecords();i.curTab.setQuery(null),i.curGC.query(n,r,o)}var l=i.curTab.getIsQueryActive()||i.curTab.getOnlyCurrentDays()>0;i.aFind.setPressed(l)}i.refreshSavedASearchList(!1,a),i=null},t.show()},l.prototype.cmd_preference=function(){var t=new e.Framework.UserPreference;t.load(),t.showDialog(),t=null},l.prototype.cmd_infoWindow=function(){e.InfoMenu.show(this.aInfo.getItem())},l.prototype.cmd_zoomAcross=function(){var t=this.curTab.getRecord_ID();if(t>0){var i=new e.Query,a=this.curTab.getKeyColumnName();0==a.length&&(a=this.curTab.getLinkColumnName()),0!=a.length&&(a.endsWith("_ID")?i.addRestriction(a,e.Query.prototype.EQUAL,e.context.getContextAsInt(this.curWindowNo,a)):i.addRestriction(a,e.Query.prototype.EQUAL,e.context.getContext(this.curWindowNo,a))),new e.AZoomAcross(this.aZoomAcross,this.curTab.getTableName(),i,this.curTab.getAD_Window_ID(),this,this.aZoomAcross.getListItmIT(),a,t).init()}},l.prototype.cmd_request=function(){var t=this.curTab.getRecord_ID();if(t>0){var i=this.curTab.getAD_Table_ID(),a=this.curTab.getValue("C_BPartner_ID"),s=new e.ARequest(this.aRequest,i,t,a,null,this.aRequest.getListItmIT());s.getRequests(),s=null}},l.prototype.cmd_markToExport=function(){var t=this.curTab.getRecord_ID(),i=this.curGC.getSelectedRows(),a=null,s=this.curTab.getAD_Table_ID(),n=this.curTab.getTableName();if(-1==t){var o={AD_Table_ID:s};e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/GetKeyColumns",o)}else{var r=n+"_ID",l="";if(this.curGC.singleRow){var d;a=t,(d=new e.MarkModule).init(a,s,n),d.show();var c=this;return void(d.onClose=function(){c.curTab.loadMarking(),c.aMarkToExport.setPressed(c.curTab.hasMarked()),c=null})}if(1==i.length)l=t;else{for(var h=0;h<i.length;h++)l+=i[h][r.toLowerCase()]+",";l.endsWith(",")&&(l=l.substring(0,l.length-1))}(d=new e.MarkModule).init(l,s,n),d.show();c=this;d.onClose=function(){c.curTab.loadMarking(),c.aMarkToExport.setPressed(c.curTab.hasMarked()),c=null}}},l.prototype.cmd_lock=function(){var i;if(this.isPersonalLock){var a=this.curTab.getRecord_ID();if(!(-1==a||a<0)){var s="Y";if(t.ajax({url:e.Application.contextUrl+"JsonData/CheckAccessForAction",dataType:"json",async:!1,data:{columnName:"IsPersonalLock",roleID:e.context.getAD_Role_ID()},error:function(e){},success:function(e){s=JSON.parse(e)}}),"Y"!=s)return e.ADialog.info("ActionNotAllowedHere"),!1;this.curTab.locks(e.context,a,this.aLock.getIsPressed()),this.curTab.loadAttachments(),i=this.curTab.getIsLocked(),this.aLock.setPressed(i)}}},l.prototype.cmd_recAccess=function(){var i="Y";if(t.ajax({url:e.Application.contextUrl+"JsonData/CheckAccessForAction",dataType:"json",async:!1,data:{columnName:"IsPersonalAccess",roleID:e.context.getAD_Role_ID()},error:function(e){},success:function(e){i=JSON.parse(e)}}),"Y"!=i)return e.ADialog.info("ActionNotAllowedHere"),!1;(new e.RecordAccessDialog).Load(this.curTab.getAD_Table_ID(),this.curTab.getRecord_ID())},l.prototype.ShowSummaryNodes=function(){this.isSummaryVisible?(this.aShowSummaryLevel.setPressed(!1),this.isSummaryVisible=!1):(this.aShowSummaryLevel.setPressed(!0),this.isSummaryVisible=!0)},l.prototype.cmd_call=function(){var t=this.curTab.getRecord_ID();if(-1==t)return this.aCall.setEnabled(!1),void(this.curGC&&this.curGC.vGridPanel.setEnabled(this.aCall.getAction(),!1));var i=this.curTab.getAD_Table_ID();if(VA048&&VA048.Apps){var a=new VA048.Apps.CallForm;a.initializeComponent(i,t);var s=new e.CFrame;s.setName(e.Msg.getMsg("Call")),s.setTitle(e.Msg.getMsg("Call")),s.hideHeader(!0),s.setContent(a),s.show()}else alert(e.Msg.getMsg("Please install Communication module first"))},l.prototype.getLastView=function(){return this.lastView||(this.lastView=""),this.lastView},l.prototype.setBackEnable=function(){1==this.tabStack.length&&this.tabStack[0].tabView.length<=1?(this.aBack.setEnabled(!1),this.curGC&&this.curGC.vGridPanel.setEnabled("BVW",!1)):(this.aBack.setEnabled(!0),this.curGC&&this.curGC.vGridPanel.setEnabled("BVW",!0))},l.prototype.dispose=function(){this.aParentDetail&&this.aParentDetail.dispose(),null!=this.curST&&(this.curST.unRegisterAPanel(),this.curST=null),this.vTabbedPane.dispose(),this.vTabbedPane=null,this.gridWindow&&(this.gridWindow.dispose(),this.gridWindow=null,this.ctx.setAutoCommit(this.$parentWindow.getWindowNo(),!1),this.ctx.removeWindow(this.$parentWindow.getWindowNo()),e.MLookupCache.cacheReset(this.$parentWindow.getWindowNo())),this.ctx=null,this.$parentWindow=null,this.tabPages=null,this.curGC=null,this.curST=null,this.aParentDetail=null,this.curTab=null,this.disposeComponent()},e.APanel=l}(VIS,jQuery)},1895:()=>{!function(e,t){e.VTabbedPane=function(e){this.oldTabIndex=-1,this.Items=[],this.ItemsIds=[],this.count=0,this.dependents=[],this.TabItems=[],this.TabLevelsItems=[],this.TabLevels=[],this.tabLIObj=[],this.contentPane=null,this.aTabPaneMgr=null,this.getIsWorkbench=function(){return false}},e.VTabbedPane.prototype.init=function(t,i){this.aPanel=t,this.multiTabView=i,i&&(this.contentPane=new e.ContentPane(this,t.getIncludedEmptyArea()))},e.VTabbedPane.prototype.setTabObject=function(e){this.tabObj=e},e.VTabbedPane.prototype.finishLayout=function(e){this.contentPane&&this.contentPane.finishLayout(e)},e.VTabbedPane.prototype.addTab=function(t,i,a,s){this.ItemsIds[this.count]=t,this.Items[this.count]=a,this.TabItems.push(s);for(var n=i.getDependentOn(),o=0;o<n.length;o++){var r=n[o];this.dependents.indexOf(r)<0&&this.dependents.push(r)}if(this.count++,this.multiTabView){var l=i.getTabLevel();this.TabLevels.push(l);var d={action:t="st_"+s.getAction(),text:i.getName(),toolTipText:i.getDescription(),textOnly:!0,iconName:""},c=new e.AppsAction(d);for(var h in this.TabLevelsItems)this.TabLevelsItems[h].TabLevel<=l&&(this.TabLevelsItems[h].ChildEle.push(a),this.TabLevelsItems[h].ChildTabs.push(i),this.TabLevelsItems[h].ChildTabsItems.push(c));this.TabLevelsItems.push({TabLevel:l,ChildEle:[],ChildTabs:[],ChildTabsItems:[],Id:t})}},e.VTabbedPane.prototype.getIsTabChanged=function(t){var i=this.ItemsIds.indexOf(t),a=this.oldTabIndex;if(i===a)return console.log("same tab"),!1;var s,n=null;if((s=this.Items[i])instanceof e.GridController&&!(n=s).getIsDisplayed())return!1;if(null!=n&&a>=0&&i!=a&&(null!=(s=this.Items[a])&&s instanceof e.GridController)){if(n.getTabLevel()>s.getTabLevel()+1){for(var o=i-1;o>=0;o--){var r=this.Items[o],l=null;if(r instanceof e.GridController&&(l=r).getTabLevel()==s.getTabLevel()+1)return e.ADialog.warn("TabSwitchJumpGo",!0,"",l.getTitle()),!1}return e.ADialog.warn("TabSwitchJump"),!1}s.setMnemonics(!1)}return null!=n&&n.setMnemonics(!0),this.oldTabIndex=i,!0},e.VTabbedPane.prototype.restoreTabChange=function(){this.oldTabIndex=-1},e.VTabbedPane.prototype.getNextTabId=function(e){(!e||e<0)&&(e=0),e>=this.ItemsIds.length&&(e=this.ItemsIds.length-1);var t=this.oldTabIndex;return(t=e)!=this.oldTabIndex?this.ItemsIds[t]:this.ItemsIds[this.oldTabIndex]},e.VTabbedPane.prototype.getPreviousTabId=function(){return this.oldTabIndex>0?this.ItemsIds[this.oldTabIndex-1]:this.ItemsIds[this.oldTabIndex]},e.VTabbedPane.prototype.getTabElement=function(e){return this.Items[this.oldTabIndex]},e.VTabbedPane.prototype.getSelectedIndex=function(){return this.oldTabIndex},e.VTabbedPane.prototype.sizeChanged=function(e,t){for(var i in this.Items)this.Items[i].sizeChanged(e,t)},e.VTabbedPane.prototype.evaluate=function(t){var i=null==t,a=null;if(i||(i=null==(a=t)||this.dependents.indexOf(a)>-1),i)for(var s=0;s<this.TabItems.length;s++){var n=this.Items[s];if(n instanceof e.GridController){var o=n.getIsDisplayed();this.TabItems[s].setEnabled(o)}}},e.VTabbedPane.prototype.setTabControl=function(e){var t=this.aPanel.getTabControl();if(this.multiTabView)for(i=0;i<e.length;i++){a=e[i].getListItm();this.tabLIObj[e[i].action]=a,t.append(a.hide())}else{t=this.aPanel.getTabControl();for(var i=0;i<e.length;i++){var a=e[i].getListItm();this.tabLIObj[e[i].action]=a,e[i].isHideTab&&a.hide(),t.append(a)}this.aPanel.setTabNavigation()}},e.VTabbedPane.prototype.setSelectedTab=function(e){if(this.selectedTab&&this.selectedTab.removeClass("vis-apanel-tab-selected"),this.selectedTab=this.tabLIObj[e],this.selectedTab.addClass("vis-apanel-tab-selected"),this.multiTabView){this.aPanel.getTabControl();for(var t in this.tabLIObj)this.tabLIObj[t].hide();for(var i=0;i<=this.oldTabIndex;i++)this.tabLIObj[this.ItemsIds[i]].show();this.contentPane.setTabControl(this.TabLevelsItems[this.oldTabIndex])}},e.VTabbedPane.prototype.getAPanel=function(){return this.aPanel},e.VTabbedPane.prototype.notifyDataChanged=function(e){this.multiTabView&&this.contentPane.dataStatusChanged()},e.VTabbedPane.prototype.sizeChanged=function(){this.multiTabView&&this.contentPane.sizeChanged()},e.VTabbedPane.prototype.refresh=function(){this.multiTabView&&this.contentPane.refresh()},e.VTabbedPane.prototype.keyDown=function(e){return this.contentPane&&this.contentPane.keyDown&&this.contentPane.keyDown(e),this},e.VTabbedPane.prototype.dispose=function(){for(var e in this.Items)this.Items[e].dispose(),this.Items[e]=null;if(this.TabItems.length=0,this.TabItems=null,this.Items.length=0,this.Items=null,this.ItemsIds.length=0,this.ItemsIds=null,this.dependents.length=0,this.dependents=null,this.TabAppsItems)for(var t=0;t<this.TabAppsItems.length;t++)this.TabAppsItems[t].dispose();this.contentPane&&this.contentPane.dispose(),this.contentPane=null,this.TabAppsItems=null}}(VIS,jQuery)},2496:()=>{!function(e,t){function i(i,a){this.bufferList=[],this.grid;var s=this,n=t("<div id='TabDialog' style='width:100%;height:100%'>"),o=e.Application.contextUrl,r=null,l=i.gTab;this.show=function(){ch=new e.ChildDialog,ch.setContent(n),ch.setHeight(500),ch.setWidth("80%"),ch.setTitle(l.getName()),ch.setModal(!0),ch.onClose=function(){s.grid.destroy(),n.empty(),n=null},ch.show(),s.gridSetup(i.getMTab().gridTable.gridFields,n,"TabDialog",i.getMTab(),i)},this.gridSetup=function(i,n,d,c,h){if(!c.getIsDisplayed(!0))return 0;this.id=d,this.$container=n;var u=[],p=null,g=(i.length,0),f=i.slice(0);f.sort((function(e,t){return e.getMRSeqNo()-t.getMRSeqNo()}));for(var v=-1,m=0;m<f.length;m++)if(null!=(p=f[m])){var b=p.getColumnName(),y=p.getDisplayType();++v,p.getIsKey()?this.indexKeyColumn=v:b.equals("IsActive")?this.indexActiveColumn=v:b.equals("Processed")?this.indexProcessedColumn=v:b.equals("AD_Client_ID")?this.indexClientColumn=v:b.equals("AD_Org_ID")&&(this.indexOrgColumn=v);var T=p.getIsDisplayedMR?p.getIsDisplayedMR():p.getIsDisplayed(),C=p.getIsMandatory(!1),D=p.getIsReadOnly(),I=p.getIsEditable(!1);if(!p.getIsHeading()){var w={resizable:!0,selfCellStyleRender:!1};w.gridField=p,!D&&I||(w.readOnly=!0),w.caption=p.getHeader(),C&&(w.caption+='<sup style="color:red;font-size: 11px;top: 0;">*</sup>'),w.field=b.toLowerCase(),w.hidden=!T;var S=w.gridField.getColumnWidth();if(w.size=S?S+"px":"100px",p.getIsIdentifier()&&p.getDisplayType()!=e.DisplayType.Image&&null==this.hyperLinkCell?0==w.hidden&&(this.hyperLinkCell=b,w.style="text-decoration:underline; color:rgba(var(--v-c-primary), 1) !important; cursor:pointer"):p.getDisplayType()==e.DisplayType.TelePhone&&0==w.hidden&&(w.style="text-decoration:underline; color:rgba(var(--v-c-primary), 1) !important; "),y==e.DisplayType.Amount)w.sortable=!0,w.customFormat=e.DisplayType.GetNumberFormat(y),w.render=function(e,t,i){var a=e[u[i].field];return a||(a=0),'<div data-type="int">'+(a=parseFloat(a).toLocaleString(void 0,{minimumFractionDigits:u[i].customFormat.getMinFractionDigit(),maximumFractionDigits:u[i].customFormat.getMaxFractionDigit()}))+"</div>"};else if(y==e.DisplayType.Integer)w.sortable=!0,w.customFormat=e.DisplayType.GetNumberFormat(y),w.render=function(e,t,i){var a=e[u[i].field];if(a)return'<div data-type="int">'+a+"</div>"};else if(y==e.DisplayType.ProgressBar)w.sortable=!0,w.selfCellStyleRender=!0,w.render=function(e,t,i){var a=u[i].field,n=u[i].gridField,o="";""!=n.getStyleLogic()&&(o=s.evaluateStyleLogic(t,n.getStyleLogic())),o||(o="");var r=e[a];return e.changes&&void 0!==e.changes[a]&&(r=e.changes[a]),'<div class="vis-progress-gridbar" style="'+o+'"><div class="vis-progress-percent-bar" style = "width:'+(r||0)+"%;"+o+'" ></div><div class="vis-progress-gridoutput" > '+(r||"")+"</div></div >"};else if(e.DisplayType.IsNumeric(y))w.sortable=!0,w.customFormat=e.DisplayType.GetNumberFormat(y),w.render=function(e,t,i){var a=e[u[i].field];if(a)return'<div data-type="int">'+(a=parseFloat(a).toLocaleString(void 0,{minimumFractionDigits:u[i].customFormat.getMinFractionDigit(),maximumFractionDigits:u[i].customFormat.getMaxFractionDigit()}))+"</div>"};else if(y==e.DisplayType.YesNo){w.sortable=!0;b.toLowerCase();w.gridField.getIsSwitch()&&(w.render="switch"),w.editable={type:"checkbox"}}else y==e.DisplayType.String||y==e.DisplayType.Text||y==e.DisplayType.TextLong||y==e.DisplayType.Memo?(w.sortable=!0,p.getIsEncryptedField()?w.render=function(e,t,i){var a=u[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),(s=e[u[i].field])||0===s?s.replace(/\w|\W/g,"*"):""}:p.getObscureType()?w.render=function(t,i,a){var s=t[u[a].field];return s||0===s?e.Env.getObscureValue(u[a].gridField.getObscureType(),s):""}:w.render=function(e,t,i){var a=u[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s||0==s?s=w2utils.encodeTags(s):""}):e.DisplayType.IsLookup(y)||y==e.DisplayType.ID?(w.sortable=!0,w.lookup=p.getLookup(),T&&(w.render=function(i,a,s){var n,o,r=u[s].lookup,l=u[s].field,d=i[l],c=u[s].gridField.getGridImageStyle(),h=u[s].gridField.getWindowNo();if(u[s].customClass="",c&&!(n=u[s].customClass)){u[s].customClass="vis-grd-custom-"+u[s].gridField.getAD_Column_ID()+h,n=".vis-grd-custom-"+u[s].gridField.getAD_Column_ID()+h+"{"+c+"}";var p=document.createElement("style");p.type="text/css",p.innerHTML=n,t(t("head")[0]).append(p)}if(i.changes&&i.changes[l],r)if(r.displayType==e.DisplayType.MultiKey)if(d){for(var g=d.toString().split(","),f="",v=0,m=g.length;v<m;v++){var b=g[v];isNaN(b)||(b=Number(b)),0!=f.length?f+=", "+r.getDisplay(b):f+=r.getDisplay(b)}o=f}else o=r.getDisplay(d,!0,!0);else o=r.getDisplay(d,!0,!0);var y="";if(r&&e.DisplayType.List==r.displayType){var T="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+60+"%)",C=r.getLovIconType(d,!0),D=r.getLOVIconElement(d,!0),I="";if(!D){if(0==I.length)var w=o.trim().split(" ");I=w[0].substring(0,1).toUpper(),w.length>1?I+=w[w.length-1].substring(0,1).toUpper():I=w[0].substring(0,2).toUpper()}if("B"==C)y="<div class='vis-grid-td-icon-grp'>",y+=D?"<div class='"+u[s].customClass+" vis-grid-row-td-icon'> "+D+"</div> ":"<div style='background-color:"+T+"' class='"+u[s].customClass+" vis-grid-row-td-icon'><span>"+I+"</span></div>",y+="<span> "+o+"</span ><div>";else{if("T"==C)return o;"I"==C&&(y="<div class='vis-grid-td-icon-grp' style='Justify-Content:center'>",y+=D?"<div class='"+u[s].customClass+" vis-grid-row-td-icon'> "+D+"</div> ":"<div style='background-color:"+T+"' class='"+u[s].customClass+" vis-grid-row-td-icon'><span>"+I+"</span></div>",y+="<div>")}}else if(r&&r.gethasImageIdentifier()){var S=o.indexOf("Images/");if(-1==S)return o;var A=o.substring(S+7,o.lastIndexOf("^^"));A=e.Application.contextUrl+"Images/Thumb32x32/"+A,(o=o.replace("^^"+o.substring(S,o.lastIndexOf("^^")+2),"^^^")).indexOf("Images/")>-1&&(o=o.replace(o.substring(S,o.lastIndexOf("^^")+2),"^^^")),o=o.split("^^^"),y="<div class='vis-grid-td-icon-grp'>";I="";for(var _=0;_<o.length;_++){T="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+60+"%)";if(o[_].trim().length>0){if(0==I.length)w=o[_].trim().split(" ");I=w[0].substring(0,1).toUpper(),w.length>1?I+=w[w.length-1].substring(0,1).toUpper():I=w[0].substring(0,2).toUpper(),_>0&&A.indexOf("nothing.png")>-1&&I.length>0&&(y+="<div style='background-color:"+T+"' class='"+u[s].customClass+" vis-grid-row-td-icon' ><span>"+I+"</span></div>"),y+="<span>"+o[_]+"</span>"}(0==_||A.indexOf("nothing.png")>-1)&&-1==A.indexOf("nothing.png")&&(y+="<div style='background-color:"+T+"' class='"+u[s].customClass+" vis-grid-row-td-icon' > <img src='"+A+"'></div > ")}}return""==y?o:y})):e.DisplayType.IsDate(y)?(w.sortable=!0,w.displayType=y,w.render=function(t,i,a){var s=u[a],n=u[a].field,o=t[n];if(t.changes&&void 0!==t.changes[n]&&(o=t.changes[n]),o)if(s.displayType==e.DisplayType.Date){var r=new Date(o);r.setMinutes(r.getTimezoneOffset()+r.getMinutes()),o=r.toLocaleDateString()}else o=s.displayType==e.DisplayType.DateTime?new Date(o).toLocaleString():new Date(o).toTimeString();else o="";return o}):y==e.DisplayType.Location||y==e.DisplayType.Locator?(w.sortable=!0,w.lookup=p.getLookup(),T&&(w.render=function(e,t,i){var a=u[i].lookup,s=u[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):y==e.DisplayType.AmtDimension?(w.sortable=!0,w.lookup=p.getLookup(),T&&(w.render=function(e,t,i){var a=u[i].lookup,s=u[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):y==e.DisplayType.ProductContainer?(w.sortable=!0,w.lookup=p.getLookup(),T&&(w.render=function(e,t,i){var a=u[i].lookup,s=u[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):y==e.DisplayType.Account||y==e.DisplayType.PAttribute?(w.sortable=!0,w.lookup=p.getLookup(),T&&(w.render=function(e,t,i){var a=u[i].lookup,s=u[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):y==e.DisplayType.PAttribute?(w.sortable=!0,w.render="int"):y==e.DisplayType.Button?w.sortable=!0:y==e.DisplayType.Image?(w.sortable=!0,w.render=function(i,a,s){var n,o=u[s].field,r=u[s].gridField.getGridImageStyle(),l=u[s].gridField.getWindowNo();if(r&&!(n=u[s].customClass)){u[s].customClass="vis-grd-custom-"+u[s].gridField.getAD_Column_ID()+l,n=".vis-grd-custom-"+u[s].gridField.getAD_Column_ID()+l+"{"+r+"}";var d=document.createElement("style");d.type="text/css",d.innerHTML=n,t(t("head")[0]).append(d)}var c=i["imgurlcolumn"+o];return i.changes&&void 0!==i.changes[o]&&(c=i.changes[o]),c?(c=c.toString().replace("Images/","Images/Thumb32x32/"),n?'<div class="vis-grid-row-td-icon-center"><div class="'+u[s].customClass+' vis-grid-row-td-icon"><img src="'+e.Application.contextUrl+c+'"></div></div>':'<div class="vis-grid-row-td-icon-center"><div class="vis-grid-row-td-icon"><img src="'+e.Application.contextUrl+c+'"></div></div>'):c='<div class="vis-grid-row-td-icon-center">-</div>'}):e.DisplayType.IsLOB(y)?(w.sortable=!0,w.render=function(e,t,i){var a=u[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s||(s=""),"#"+s.toString().length}):e.DisplayType.TelePhone==y?(w.sortable=!0,w.render=function(t,i,a){var s=u[a].field,n=t[s];return t.changes&&void 0!==t.changes[s]&&(n=t.changes[s]),n?e.VTelePhoneInstance.getHtml(n,!0):""}):e.DisplayType.Color==y?(w.sortable=!0,w.render=function(e,t,i){var a=u[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s?'<div style="background-color:'+s+';" ></div>':""}):(w.sortable=!0,w.render=function(e,t,i){var a=u[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s||0==s?s=w2utils.encodeTags(s):""});""!=p.getHtmlStyle()&&(w.style=p.getHtmlStyle()),w.hidden||g++,u.push(w),w.columnName=b}}if(g>0){var A=Math.floor(100/g);for(var _ in u)u[_].hidden||(!u[_].size<0&&(u[_].size=A+"%",u[_].min=100),null==this.hyperLinkCell&&(this.hyperLinkCell=u[_].columnName,u[_].style="text-decoration:underline; color:rgba(var(--v-c-primary), 1) !important; cursor:pointer"))}var P={page:0,pageSize:0,treeID:0,treeNode_ID:0,card_ID:0,ad_Tab_ID:l.getAD_Tab_ID(),tableName:l.getTableName()};t.ajax({url:o+"Window/GetWindowRecords",type:"post",data:{ctx:e.context.getWindowCtx(h.windowNo),Columns:Object.keys(h.getColumnNames()),TableName:l.getTableName(),WhereClause:e.secureEngine.encrypt(a),ObscureFields:[],sqlIn:P,AD_Window_ID:l.getAD_Window_ID(),WindowNo:h.windowNo,AD_Tab_ID:l.getAD_Tab_ID(),SummaryOnly:!1,Encryptedfields:[],AD_Table_ID:l.getAD_Table_ID(),MaxRows:0,DoPaging:!1},success:function(t){var i=JSON.parse(t);try{var a=null;if(i&&(r=(new e.DB.DataSet).toJson(i.Tables),a=i.LookupDirect),null!=r){if(0!=r.getTables().length)for(var n=r.getTable(0).getRows(),o=r.getTable(0).getColumnsName(),c=0;c<n.length;c++){for(var p=n[c].getJSCells(),g=0;g<o.length;g++)p[o[g]]=l.gridTable.readDataOfColumn(o[g],p[o[g]]);p.recid=c+1,p.editable=!1,s.bufferList[c]=p}r.dispose(),r=null,a&&e.MLookupCache.addRecordLookup(h.windowNo,l.getTabNo(),a),s.grid=s.$container.w2grid({name:d,columns:u,records:s.bufferList,editable:!1,show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},recordHeight:41})}}catch(e){}},error:function(){}})}}e.TabMngr={show:function(e,t,a){new i(e,t+"="+a).show()}}}(VIS,jQuery)},7428:()=>{!function(e,t){var i=document.querySelector("#vis-ad-tabpnltmp").content;function a(a,s){this.width=s,this.tabPanels=[];var n=document.importNode(i,!0),o=t(n.querySelector(".vis-ad-w-p-ap-tp-outerwrap")),r=o.find(".vis-ad-w-p-ap-tp-o-icorbar ul"),l=o.find(".vis-ad-w-p-ap-tp-o-b-head"),d=o.find(".vis-ad-w-p-ap-tp-o-b-head h6"),c=o.find(".vis-ad-w-p-ap-tp-o-b-head span"),h=o.find(".vis-ad-w-p-ap-tp-o-b-content");this.isClosed=!0,s<=25?s=s<=0?75:25:s>75&&(s=75),s=100-s,s=t(document).width()*s/100,this.width=s;var u=this,p=null;function g(e){p&&p.removeClass("vis-ad-w-p-ap-tp-o-li-selected"),p=null,h.empty(),e?(p=e.addClass("vis-ad-w-p-ap-tp-o-li-selected"),d.text(e.data("name")),u.setCurrentPanel(e.data("cname"),a,e.data("extrainfo"))):u.setCurrentPanel(null),u.curTabPanel?(h.append(u.curTabPanel.getRoot()),u.setSize(s)):u.setSize(35)}r.on("click","LI",(function(e){g(t(e.currentTarget))})),c.on("click",(function(){g(null)})),this.getRoot=function(){return o},this.getcurTabPanel=function(){return this.curTabPanel},this.setPanelList=function(e,t){r.append(e);var i=r.find("[default='true']").first();i&&i.length>0?i.trigger("click"):g(null)},this.setSize=function(i){if(!(!this.isClosed&&i&&i>40)){0==i&&(i=this.width);var a=o.closest(".vis-ad-w-p-center").height()-40;if(i&&i>40){if(!this.curTabPanel)return;a||(a=e.Env.getScreenHeight()-225,this.gTab.getIsHeaderPanel()&&(a=a-e.Utility.Util.getValueOfInt(this.curTabPanel.curTab.getHeaderHeight().replace("px"," "))-10)),this.curTabPanel.curTab.getIsTPBottomAligned()?(o.css({height:"100%",width:"100%"}),h.css({height:"100%",width:t(document).width()-72+"px",overflow:"auto"})):(o.css({height:a+"px",width:i+"px"}),h.css({height:a+"px",width:i-35+"px",overflow:"auto"})),l.show(),h.show()}else o.css({height:"35px",width:"35px"}),h.css({height:"35px",width:"0px"}),this.isClosed=!0,l.hide(),h.hide();this.sizeChangedListner&&this.sizeChangedListner.onSizeChanged&&this.sizeChangedListner.onSizeChanged(i&&i>40)}},this.disposeComponent=function(){o.remove(),h.remove(),p=null,u=null}}a.prototype.init=function(t){this.gTab=t;var i=this.gTab.getTabPanels(),a=0;if(i&&i.length>0){var s=[];a=i[0].getAD_TabPanel_ID();for(var n=0;n<i.length;n++){var o="";o=i[n].getIconPath()?i[n].getIconPath():"fa fa-object-group",s.push('<li default="'+i[n].getIsDefault()+'" data-panelid="'+i[n].getAD_TabPanel_ID()+'" data-cname="'+i[n].getClassName()+'" data-name="'+i[n].getName()+'"  data-extrainfo="'+i[n].getExtraInfo()+'" >'),o.indexOf(".")>-1?s.push('<img alt = "'+i[n].getName()+'" title = "'+i[n].getName()+'"  src = "'+e.Application.contextUrl+"Areas/"+o+'" onerror=this.src="'+e.Application.contextUrl+'Areas/VIS/Images/base/defpanel.ico"></img >'):s.push('<span> <i title = "'+i[n].getName()+'" class="'+o+'" ></i></span>'),s.push("</li>"),i[n].getIsDefault()&&(a=i[n].getAD_TabPanel_ID())}}this.setPanelList(s.join(" "),a)},a.prototype.addSizeChangeListner=function(e){this.sizeChangedListner=e},a.prototype.setCurrentPanel=function(t,i,a){if(this.curTabPanel&&(this.curTabPanel.dispose&&this.curTabPanel.dispose(),this.curTabPanel=null),t){var s=e.Utility.getFunctionByName(t,window);if(s){var n=new s;n.startPanel(i,this.gTab,a),this.curTabPanel=n,(this.gTab.getRecord_ID()>-1||this.gTab.getCurrentRow()>-1)&&n.refreshPanelData(this.gTab.getRecord_ID(),this.gTab.getTableModel().getRow(this.gTab.getCurrentRow()))}}},a.prototype.refreshPanelData=function(e,t){this.curTabPanel&&this.curTabPanel.refreshPanelData(e,t)},a.prototype.setTabPanelSize=function(e){0==e&&(e=this.width),this.setSize(e)},a.prototype.dispose=function(){this.disposeComponent(),this.sizeChnagedListner=null,this.gTab=null,this.curTabPanel&&(this.curTabPanel.dispose(),this.curTabPanel=null)},e.VTabPanel=a}(VIS,jQuery)},7670:()=>{!function(e,t){var i=document.querySelector("#vis-ad-viewctrltmp").content;function a(e,i,a){var s=null;return t.ajax({url:o,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){s=e,a&&a(e)})),s}var s=function(t,i,s){var n=!!s,o={sql:t,page:1,pageSize:0};i&&(o.param=i);var r=null;return a(o,n,(function(t){var i=(new e.DB.DataSet).toJson(t);i=(new e.DB.DataSet).toJson(t);r=i.getTable(0).getRows().length>0?i.getTable(0).getRow(0).getCell(0):null,i.dispose(),i=null,n&&s(r)})),r},n=e.Application.contextUrl,o=n+"JsonData/JDataSetWithCode";e.GridController=function(a,s,n){this.id=n,this.vGridPanel=new e.VGridPanel,this.vTable=new e.VTable,this.vCardView=new e.VCardView,this.vMapView=new e.VMapView,this.vHeaderPanel=null,this.windowNo=0,this.aPanel=null,this.singleRow=!1,this.isCardRow=!1,this.doPaging=s,this.vIncludedGC=null,this.m_tree=null,this.onRowInserted=null,this.onRowInserting=null,this.actionParams={},this.rightPaneLinkItems=[],this.leftPaneLinkItems=[],this.showClient=!1,this.showOrg=!1;var o=e.Env.getCtx().getShowClientOrg();o==e.Env.SHOW_CLIENT_ONLY?this.showClient=!0:o==e.Env.SHOW_ORG_ONLY?this.showOrg=!0:o==e.Env.SHOW_CLIENT_ORG&&(this.showOrg=!0,this.showClient=!0),this.isParentDetailVisible=!1,this.isIncludedGCVisible=!1,this.displayAsIncludedGC=!1;var r,l,d,c,h,u,p,g,f,v,m=[],b=null,y=null;v=document.importNode(i,!0),h=t(v.querySelector(".vis-ad-w-p-vc")).hide(),g=h.find(".vis-ad-w-p-vc-tree").hide(),c=h.find(".vis-ad-w-p-vc-actions").hide(),u=h.find(".vis-ad-w-p-vc-header"),p=t("<div class='vis-gc-vtable'>"),r=t("<div class='vis-ad-w-p-vc-editview' id='AS_"+n+"'>"),l=t("<div class='vis-gc-vcard'>"),d=t("<div class='vis-gc-vmap'>"),h.find(".vis-ad-w-p-vc-gc").append(p).append(r).append(l).append(d);var T=this,C=function(e){if("edit"==e){if(T.displayAsIncludedGC)return void(T.aPanel.tabActionPerformed(T.id)&&T.switchSingleRow())}else if(T.displayAsIncludedGC){if(!T.aPanel.tabActionPerformed(T.id))return;T.switchSingleRow(),setTimeout((function(e){e.aPanel.cmd_new()}),500,T)}};f=new e.AppsAction({action:"new",parent:null,enableDisable:!0,toggle:!1,imageOnly:!0,isSmall:!0,onAction:C}),y=new e.AppsAction({action:"edit",parent:null,enableDisable:!0,toggle:!1,imageOnly:!0,isSmall:!0,onAction:C}),c.append(y.getListItm()).append(f.getListItm()),this.initLayout=function(){this.layoutLoaded=!0},this.sizeChanged=function(e,t){},this.sizeChanged(),r.append(this.vGridPanel.getRoot()),this.getRoot=function(){return h},this.getTreeArea=function(){return g},this.getId=function(){return n},this.setRecord=function(e){},this.getVTablePanel=function(){return p},this.getVPanel=function(){return r},this.getVCardPanel=function(){return l},this.getVMapPanel=function(){return d},this.setUI=function(e){e?(u.html(this.gTab.getName()),u.css("display","block"),c.css("display","flex"),y.setEnabled(!1),this.vTable.grid.show.selectColumn=!1):(u.css("display","none"),c.css("display","none"),this.vTable.grid.show.selectColumn=!0)},this.enableDisableToolbarItems=function(e){y.setEnabled(e)},this.vTable.onSelect=function(e){T.aPanel&&T.aPanel.setBusy&&T.aPanel.setBusy(!0),T.cancelSel=!1,T.onTableRowSelect(e),T.cancelSel&&(e.isCancelled=!0),T.aPanel&&T.aPanel.setBusy&&T.aPanel.setBusy(!1)},this.vTable.onCellValueChanged=function(e,t){t?window.setTimeout((function(){T.vetoablechange(e),T.vTable.refreshCells()}),10):(T.vetoablechange(e),T.vTable.refreshCells())},this.vCardView.onCardEdit=function(e,t){T.onTableRowSelect(e),t||T.aPanel.actionPerformedCallback(T.aPanel,"Single")},this.vTable.onSort=function(e){window.setTimeout((function(){T.navigate(T.gTab.getCurrentRow(),!0)}),10)},this.disposeComponent=function(){this.rightPaneLinkItems.length=0,this.rightPaneLinkItems=null,this.leftPaneLinkItems.length=0,this.leftPaneLinkItems=null,p=null,$divRecords=null;for(var e=0;e<m.length;e++)m[e].dispose("ul_"+this.id);m=null,this.seletedTab=null,this.vGridPanel.dispose(),this.vGridPanel=null,this.vCardView.dispose(),this.vCardView.onSelect=null,this.vMapView.dispose(),this.vTable.dispose(),this.vTable.onSelect=null,this.vTable.onSort=null,this.vTable=null,p=null,r=null,l=null,d=null,T=null,this.getId=null,this.getReocrdDiv=null,this.getRoot=null,this.getVTablePanel=null,this.getVPanel=null,this.getVCardPanel=null,h.remove(),h=null,b&&b.destroy(),b=null,this.onRowInserted=null}},e.GridController.prototype.initTabPanel=function(t,i){this.vTabPanel=new e.VTabPanel(i,t),this.vTabPanel.init(this.getMTab()),this.vTabPanel.addSizeChangeListner(this)},e.GridController.prototype.initHeaderPanel=function(t){this.vHeaderPanel=new e.HeaderPanel(t),this.vHeaderPanel.init(this),this.vHeaderPanel.addSizeChangeListner(this)},e.GridController.prototype.initFilterPanel=function(t){this.aFilterPanel=new e.FilterPanel(t,this)},e.GridController.prototype.initFilterUI=function(){this.aFilterPanel&&this.aFilterPanel.init()},e.GridController.prototype.getTabPanel=function(){return this.vTabPanel.getRoot()},e.GridController.prototype.getFilterPanel=function(){return this.aFilterPanel.getRoot()},e.GridController.prototype.onSizeChanged=function(e){this.multiRowResize(),this.vIncludedGC&&this.vIncludedGC.multiRowResize()},e.GridController.prototype.refreshTabPanelData=function(e){this.vTabPanel&&this.vTabPanel.refreshPanelData(e,this.gTab.getTableModel().getRow(this.gTab.getCurrentRow()))},e.GridController.prototype.getSurveyCondition=function(e){if(this.vTabPanel&&this.vTabPanel.curTabPanel.getSurveyCondition)return this.vTabPanel.curTabPanel.getSurveyCondition()},e.GridController.prototype.IsCheckListRequire=function(i){var a=!0,s=!1;if(this.gTab.getHasPanel())for(var n=this.gTab.getTabPanels(),o=0;o<n.length;o++)"VIS.SurveyPanel"==n[o].getClassName()&&(s=!0,o=n.length);if(!s)return!0;var r=this.gTab.getAD_Table_ID(),l=this.gTab.getRecord_ID(),d=this.gTab.getAD_Window_ID(),c=(this.gTab.currentRow,this.gTab),h=!1;return this.vTabPanel.curTabPanel&&this.vTabPanel.curTabPanel.isCheckListFill&&(h=this.vTabPanel.curTabPanel.isCheckListFill),t.ajax({async:!1,url:e.Application.contextUrl+"SurveyPanel/IsCheckListRequire",data:{AD_Window_ID:d,AD_Table_ID:r,Record_ID:l},success:function(t){if((t=(t=JSON.parse(t))[0]).ResponseCount>0)a=!0;else if(""!=t.Condition){var i=e.Evaluator.evaluateLogicByRowData(c,t.Condition);a=!(!i||!h)||!i}else a=!0},error:function(e){console.log(e)}}),a},e.GridController.prototype.SaveSurvey=function(e){return this.vTabPanel.curTabPanel.SaveData(e)},e.GridController.prototype.refreshFilterPanelData=function(){this.aFilterPanel&&this.aFilterPanel.refreshFilterOptions("",!0)},e.GridController.prototype.initGrid=function(t,i,a,n){var o=n.gridTable.gridFields,r=null,l=i+"_"+n.vo.AD_Tab_ID,d=i+"_c"+n.vo.AD_Tab_ID,c=i+"_m"+n.vo.AD_Tab_ID;n.getTableModel().setDoPaging(this.doPaging);var h=e.MRole;h.getIsDisplayClient()&&this.showClient||n.getField("AD_Client_ID").setDisplayed(!1),h.getIsDisplayOrg()&&this.showOrg||n.getField("AD_Org_ID").setDisplayed(!1);var u=this.vTable.setupGridTable(a,o,this.getVTablePanel(),l,n,this);if(n.addDataStatusListener(this),!t){this.vCardView.setupCardView(a,n,this.getVCardPanel(),d),n.getIsMapView()&&this.vMapView.setupMapView(a,this,n,this.getVMapPanel(),c);for(var p=0;p<u;p++)if((r=o[p]).getIsDisplayed()){var g=e.VControlFactory.getControl(n,r,!1,!1,!1);if(null==g&&!r.getIsHeading())continue;null!=g&&(g.setReadOnly(!0),r.setPropertyChangeListener(g),g.addVetoableChangeListener(this)),this.vGridPanel.addField(g,r),g instanceof e.Controls.VButton&&(r.getIsLink()&&r.getIsRightPaneLink()&&this.rightPaneLinkItems.push(g),435==r.getAD_Reference_Value_ID()&&g.setReadOnly(!1),g.addActionListner(this)),g=null}this.vGridPanel.flushLayout(n.getHideFGFrom())}var f=0;if(n.getIsTreeTab()){var v="",m=[],b=n.getAD_Table_ID();208!=b&&291!=b||(v=208==b?"VIS_155":"VIS_156",m[0]=new e.DB.SqlParam("@AD_Org_ID",e.Env.getCtx().getAD_Org_ID()),f=e.Utility.Util.getValueOfInt(s(v,m)),m=[]),0==f&&(v="VIS_120",m[0]=new e.DB.SqlParam("@AD_Client_ID",e.Env.getCtx().getAD_Client_ID()),m[1]=new e.DB.SqlParam("@AD_Table_ID",b),f=s(v,m)),f>0&&(this.treeID=f,n.getShowSummaryLevel()?(this.onDemandTree=!0,this.m_tree=new e.TreePanel(i,!1,!0,!0,this),a.aShowSummaryLevel.show()):(this.onDemandTree=!1,this.m_tree=new e.TreePanel(i,!1,!0,!1,this),a.aShowSummaryLevel.hide()),this.m_tree.setTabID(n.getAD_Tab_ID()),0==n.getTabNo()&&this.m_tree.initTree(f),this.getTreeArea().append(this.m_tree.getRoot()),this.m_tree.addSelectionChangeListner(this),this.getTreeArea().show())}n.getTableModel().addTableModelListener(this.vTable),n.getTableModel().addCardModelListener(this.vCardView),n.getTableModel().addRowChangedListener(this),n.getTableModel().addQueryCompleteListner(this),n.getTableModel().setDoPaging(this.doPaging),n.getTableModel().setCurrentPage(1),this.gTab=n,this.windowNo=i,this.onlyMultiRow=t,this.aPanel=a;var y=n.getTabLayout();"N"==y?this.singleRow=!1:"Y"==y?this.switchSingleRow(!0):"C"==y&&(this.isCardRow=!1,this.switchCardRow(!0))},e.GridController.prototype.getIsHeaderPanel=function(){return this.gTab.getIsHeaderPanel()},e.GridController.prototype.detachDynamicAction=function(){var e=0,t=0;for(e=0,t=this.leftPaneLinkItems.length;e<t;e++)this.leftPaneLinkItems[e].getControl().detach();for(e=0,t=this.rightPaneLinkItems.length;e<t;e++)this.rightPaneLinkItems[e].getControl().detach();e=null,t=null,this.vTabPanel&&this.vTabPanel.getRoot().detach(),this.aFilterPanel&&this.aFilterPanel.getRoot().detach()},e.GridController.prototype.switchRowPresentation=function(){this.singleRow?this.switchMultiRow():this.switchSingleRow()},e.GridController.prototype.getIsSingleRow=function(){return this.singleRow},e.GridController.prototype.getIsCardRow=function(){return this.isCardRow},e.GridController.prototype.getIsMapRow=function(){return this.isMapRow},e.GridController.prototype.onTableRowSelect=function(e){if(!this.rowSetting&&0!=this.gTab.getRowCount()){var t=this.vTable.get(e.recid,!0),i=this.gTab.getCurrentRow();if(-1==t&&i>=0)return this.vTable.select(e.recid),void this.vCardView.navigate(e.recid,!this.isCardRow);if(t!=i)this.rowSetting=!0,this.navigate(t),this.rowSetting=!1;else if(!this.settingGridSelecton)return;this.dynamicDisplay(-1);var a=this;this.getIsSingleRow()?a.notifyDependents():window.setTimeout((function(){a.notifyDependents()}),50)}},e.GridController.prototype.switchIncludedGC=function(){null!=this.vIncludedGC&&this.switchIncludedGC()},e.GridController.prototype.dynamicDisplay=function(t){if(null!=this.gTab&&!this.isCardRow&&!this.isMapRow){this.gTab.getRecord_ID();if(this.getIsSingleRow()){if(this.gTab.getIsOpen()){if(t>=0){var i=this.gTab.getField(t),a=i.getColumnName();if(0==this.gTab.getDependantFields(a).length&&i.getCallout().length>0)return}for(var s=0==this.gTab.getRowCount(),n=this.vGridPanel.getComponents(),o=n.length,r=0;r<o;r++){var l=n[r];if(null!=(a=l.getName())){a.startsWith("lbl")&&(a=a.substring(3));var d=this.gTab.getField(a);if(null!=d){if(d.getDisplayType()==e.DisplayType.Button&&435==d.getAD_Reference_Value_ID())continue;if(d.getIsDisplayed(!0)){var c=l.tag;if(l.getIsVisible()||null!=c&&"undefined"!=c&&!c||(l.setVisible(!0),this.vGridPanel.setVisible(a,!0)),l instanceof e.Controls.IControl){var h=l;if(s)h.setReadOnly(!0);else{var u=d.getIsEditable(!0)&&!this.gTab.getIsReadOnly();if(h.setReadOnly(!u),h.showObscureButton&&h.showObscureButton(u),h.setMandatory(d.getIsMandatory(!0)),h.setBackground(d.getIsError()),!d.getIsDefaultFocus()||this.isDefaultFocusSet||l.getName().startsWith("lbl")||(h.setDefaultFocus(!0),this.isDefaultFocusSet=!0),!l.getName().startsWith("lbl")&&""!=d.getStyleLogic()){var p=d.getStyleLogic().split(","),g=this.evaluateStyleCondition(d,p);h.setHtmlStyle(g)}}}}else l.getIsVisible()&&(l.setVisible(!1),this.vGridPanel.setVisible(a,!1));d.getIsDisplayed(!0)||d.getIsMandatory(!0)||d.setError(!1)}}}}}else this.dynamicDisplayLinks(t)}},e.GridController.prototype.evaluateStyleCondition=function(t,i){for(var a=null,s=0;s<i.length;s++){var n=i[s].split("?");if(2==n.length&&e.Evaluator.evaluateLogic(t,n[0])){a=n[1];break}}return a},e.GridController.prototype.dynamicDisplayLinks=function(t){if(!this.displayAsIncludedGC)for(var i=0==this.gTab.getRowCount(),a=this.vGridPanel.getLinkComponents(),s=0;s<a.length;s++){var n=a[s],o=n.getName();if(null!=o){o.startsWith("lbl")&&(o=o.substring(3));var r=this.gTab.getField(o);if(null!=r){if(r.getIsDisplayed(!0)){var l=n.tag;if(n.getIsVisible()||null!=l&&"undefined"!=l&&!l||n.setVisible(!0),n instanceof e.Controls.IControl){var d=n;if(i)d.setReadOnly(!0);else{var c=r.getIsEditable(!0)&&!this.gTab.getIsReadOnly();d.setReadOnly(!c),d.setMandatory(r.getIsMandatory(!0)),d.setBackground(r.getIsError())}}}else n.getIsVisible()&&n.setVisible(!1);r.getIsDisplayed(!0)||r.getIsMandatory(!0)||r.setError(!1)}}}},e.GridController.prototype.setDefaultFocus=function(){this.gTab.getRowCount();for(var e=this.vGridPanel.getComponents(),t=e.length,i=0;i<t;i++){var a=e[i].getName();if(null!=a){var s=this.gTab.getField(a);if(null!=s&&s.getIsDefaultFocus()){this.vTable.setDefaultFocus(a);break}}}},e.GridController.prototype.setVisible=function(e){this.layoutLoaded||this.initLayout(),e?(this.getRoot().show(),this.vTable.resize()):this.getRoot().hide()},e.GridController.prototype.getMTab=function(){return this.gTab},e.GridController.prototype.getAPanel=function(){return this.aPanel},e.GridController.prototype.getIsDisplayed=function(){return this.gTab.getIsDisplayed(!1)},e.GridController.prototype.getTabLevel=function(){return this.gTab.getTabLevel()},e.GridController.prototype.getTitle=function(){return this.gTab.getName()},e.GridController.prototype.getSelection=function(e){return this.vTable.getSelection(e)},e.GridController.prototype.getSelectedRows=function(){return this.vTable.getSelectedRows()},e.GridController.prototype.getColumnNames=function(){if(this.colNames)return this.colNames;for(var e=this.gTab.getTableModel().getFields(),t={},i=0;i<e.length;i++)t[e[i].getColumnName()]=e[i].getHeader();return this.colNames=t,this.colNames},e.GridController.prototype.setMnemonics=function(e){},e.GridController.prototype.activate=function(e,t){if(this.vTable.activate(),e=e||{},this.vTable.setReadOnly(!1),this.displayAsIncludedGC){var i=this.aPanel.getLayout();this.setUI(!1),this.getRoot().detach(),i.append(this.getRoot()),this.displayAsIncludedGC=!1,this.aPanel.getIncludedEmptyArea().css({display:"none"})}else if(0==this.gTab.getIncluded_Tab_ID()){var a=e.vIncludedGC;if(a){i=a.aPanel.getLayout();a.setUI(!1),a.getRoot().detach(),this.aPanel.getIncludedEmptyArea().css({display:"none"})}}this.isIncludedGCVisible=!1,this.vIncludedGC&&(this.vIncludedGC.displayAsIncludedGC=!1,this.vIncludedGC.isIncludedGCVisible=!1),this.activateTree(),this.actionParams=t,t?null!=t.IsHideHeaderPanel?t.IsHideHeaderPanel?this.vHeaderPanel?this.vHeaderPanel.hidePanel():this.aPanel.vHeaderPanel&&this.aPanel.vHeaderPanel.hidePanel():this.vHeaderPanel?this.vHeaderPanel.showPanel():this.aPanel.vHeaderPanel&&this.aPanel.vHeaderPanel.showPanel():this.gTab.isHPanelNotShowInMultiRow&&!this.actionParams.IsHideHeaderPanel&&null!=this.vHeaderPanel&&(this.vHeaderPanel.showPanel(),this.vHeaderPanel.sizeChangedListner&&this.vHeaderPanel.sizeChangedListner.onSizeChanged&&this.vHeaderPanel.sizeChangedListner.onSizeChanged()):this.actionParams={},this.gTab.actionParams=this.actionParams,this.actionParams.Card_ID>0&&(this.gTab.getTableModel().setCardID(this.actionParams.Card_ID),!this.isCardRow&&this.vCardView&&(this.vCardView.cardID=this.actionParams.Card_ID))},e.GridController.prototype.multiRowResize=function(){this.singleRow||this.isCardRow||this.vTable.resize()},e.GridController.prototype.activateTree=function(){if(this.gTab.getIsTreeTab()&&this.gTab.getTabNo()>0){var t=0;if(this.gTab.getTabLevel()>0){var i=this.gTab.getKeyColumnName(),s="AD_Tree_ID";i.startsWith("CM")&&(i.equals("CM_Container_ID")?s="AD_TreeCMC_ID":i.equals("CM_CStage_ID")?s="AD_TreeCMS_ID":i.equals("CM_Template_ID")?s="AD_TreeCMT_ID":i.equals("CM_Media_ID")&&(s="AD_TreeCMM_ID")),t=e.Env.getCtx().getWindowContextAsInt(this.windowNo,s)}if(0==t){var n=this.gTab.getAD_Table_ID(),o=e.Env.getCtx().getAD_Client_ID();if(0==n)return 0;var r=[];r[0]=new e.DB.SqlParam("@AD_Client_ID",o),r[1]=new e.DB.SqlParam("@AD_Table_ID",n);var l=function(t,i,s){var n=!!s,o={sql:t,page:1,pageSize:0};i&&(o.param=i);var r=null;return a(o,n,(function(t){r=(new e.DB.DataReader).toJson(t),n&&s(r)})),r}("VIS_121",r);l.read()&&(t=l.getInt(0)),l=null}null!=this.m_tree&&t>0&&this.m_tree.initTree(t)}},e.GridController.prototype.nodeSelectionChanged=function(e){if(null!=e){var t=e.newValue;if(null!=t){var i=t;if(this.treeNodeID=i,this.gTab.SetSelectedNode(i),this.gTab.SetIsSummaryNode(e.isSummaryNode),this.onDemandTree)return this.aPanel&&this.aPanel.setBusy&&this.aPanel.setBusy(!0),this.gTab.setTreeNodeID(i),this.gTab.gridTable.setCurrentPage(1),this.navigate(0),void this.query(0,0,!1,i,this.treeID,this.gTab.getAD_Table_ID());for(var a=this.gTab.getRowCount(),s=-1,n=0;n<a;n++)if(this.gTab.getKeyID(n)==i){s=n;break}-1!=s&&this.navigate(s)}}},e.GridController.prototype.skipRowInserting=function(e){this.skipInserting=e},e.GridController.prototype.query=function(e,t,i,a,s,n){this.aPanel&&this.aPanel.setBusy&&this.aPanel.setBusy(!0),this.onDemandTree&&(a&&this.gTab.setTreeNodeID(a),s&&this.gTab.setTreeID(s),n&&this.gTab.setTreeTable(n),this.aPanel.isSummaryVisible?this.gTab.setShowSummaryNodes(!0):this.gTab.setShowSummaryNodes(!1));this.gTab.prepareQuery(e,t,i,!1)},e.GridController.prototype.applyFilters=function(e){var t,i=[];if(this.searchCode&&""!=this.searchCode&&i.push(this.searchCode),""!=e.getWhereClause()&&i.push(e.getWhereClause()),this.aFilterPanel){var a=this.aFilterPanel.getFilterClause();""!=a&&i.push(a)}t=e.getWhereClause(!0),e.clear(),i.length>0?(e.addRestriction(i.join(" AND ")),e.reportWhere=t):e=null,this.getMTab().getTableModel().setCurrentPage(1),this.getMTab().setQuery(e),this.query(0,0,null)},e.GridController.prototype.queryCompleted=function(e){this.vTable.clear(),this.gTab.clearSelectedRow(),this.vTable.add(this.gTab.getTableModel().getDataTable()),this.gTab.getTableModel().setSortModel(this.vTable.getGrid().records),this.displayAsIncludedGC||(this.onRowInserting?this.onRowInserting():this.checkInsertNewRow()),this.navigate(this.gTab.getCurrentRow(),!this.gTab.getTableModel().getIsInserting()),this.isCardRow&&this.vCardView.refreshUI(this.getVCardPanel().width()),this.isMapRow&&this.vMapView.refreshUI(this.getVMapPanel().width()),this.aPanel&&this.aPanel.setBusy(this.isCardRow),this.skipInserting=!1,this.dynamicDisplay(-1)},e.GridController.prototype.checkInsertNewRow=function(){if(null==this.aPanel||this.aContentPane)return!1;var t=!0,i=this.gTab.getLinkColumnName(),a=e.context.getWindowContext(this.windowNo,i);return i.Length>0&&0==a.length&&(t=!1),!(0!=this.gTab.getTableModel().getTotalRowCount()&&null!=this.gTab.getTableModel().getTotalRowCount()&&!this.actionParams.IsTabInNewMode||this.gTab.getIsReadOnly()||!(1==this.gTab.getIsZoomAction()||e.context.getIsAutoNew(this.windowNo)||this.gTab.getIsQueryNewRecord()||this.gTab.getIsAutoNewRecord()||this.actionParams.IsTabInNewMode)||!t||!this.gTab.getIsInsertRecord()||this.skipInserting)&&(this.setNewRecordLayout(),this.dataNew(!1),!0)},e.GridController.prototype.setNewRecordLayout=function(){var e=this.gTab.getNewRecordView();"S"==e?(this.switchSingleRow(),this.aPanel.showHideViewIcon(this.aPanel.aSingle)):"G"==e?(this.isNewClick=!0,this.switchMultiRow(),this.aPanel.showHideViewIcon(this.aPanel.aMulti)):this.getIsCardRow()&&(this.switchSingleRow(),this.aPanel.showHideViewIcon(this.aPanel.aSingle))},e.GridController.prototype.vetoablechange=function(e){var t=this.gTab.getTableModel(),i=this.gTab.getCurrentRow(),a=t.findColumn(e.propertyName);t.setValueAt(e.newValue,i,a)},e.GridController.prototype.actionPerformed=function(e){this.aContentPane?this.aContentPane.actionPerformed(e):this.aPanel.actionPerformed(e)},e.GridController.prototype.refreshUI=function(e){this.dataRefreshAll()},e.GridController.prototype.navigate=function(e,t){if(!t&&e==this.gTab.getCurrentRow())return this.gTab.getCurrentRow();var i=this.gTab.navigate(e,!0,t);return i>-1&&!this.rowSetting?(this.settingGridSelecton=!0,this.vTable.select(i),this.settingGridSelecton=!1,this.vCardView.navigate(i,!this.isCardRow)):i>-1&&this.isCardRow&&(this.settingGridSelecton=!0,this.vTable.select(i),this.settingGridSelecton=!1,this.vCardView.navigate(i,!0)),this.vHeaderPanel&&this.vHeaderPanel.navigate(),-1==i?(this.cancelSel=!0,void this.refreshTabPanelData(-1)):(i>-1&&this.refreshTabPanelData(this.gTab.getRecord_ID()),this.navigateTreeNode(e),this.gTab.getCurrentRow())},e.GridController.prototype.navigateTreeNode=function(i){if(null!=this.m_tree&&(this.m_tree.setSelectedNode(this.gTab.getRecord_ID()),this.gTab.SetIsSummaryNode(this.m_tree.isSummaryNode)),this.vTable.scrollInView(i),this.onDemandTree){var a=this.gTab.getRecord_ID(),s=this.treeID,n=this.aPanel;t.ajax({url:e.Application.contextUrl+"JsonData/GetTreeNodePath",data:{nodeID:a,treeID:s},success:function(e){var t=JSON.parse(e);n.setStatusLine(t)},error:function(e){console.log(e)}})}},e.GridController.prototype.navigatePageExact=function(e){this.gTab.getTableModel().setCurrentPage(e),this.query(this.gTab.getOnlyCurrentDays(),0,!1,this.treeNodeID,this.treeID,this.gTab.getAD_Table_ID())},e.GridController.prototype.navigatePage=function(e){this.gTab.getTableModel().setCurrentPageRelative(e),this.query(this.gTab.getOnlyCurrentDays(),0,!1,this.treeNodeID,this.treeID,this.gTab.getAD_Table_ID())},e.GridController.prototype.navigateRelative=function(e){return this.navigate(this.gTab.getCurrentRow()+e)},e.GridController.prototype.dataRefresh=function(){this.gTab.dataRefresh();this.dynamicDisplay(-1),window.setTimeout((function(e){e.notifyDependents(),e=null}),500,this)},e.GridController.prototype.dataRefreshAll=function(){this.gTab.dataRefreshAll()},e.GridController.prototype.dataSave=function(t){var i=this;if(!i.IsCheckListRequire())return e.ADialog.error("CheckListRequired"),!1;null!=i.m_tree&&(i.gTab.SetSelectedNode(i.m_tree.currentNode),i.gTab.setTreeID(i.treeID));var a=i.gTab.dataSave(t);return a&&t&&i.vHeaderPanel&&i.vHeaderPanel.navigate(),a},e.GridController.prototype.dataNew=function(e){this.isDefaultFocusSet=!1,this.gTab.dataNew(e),this.dynamicDisplay(-1),this.notifyDependents(),this.onRowInserted&&this.onRowInserted(),this.isDefaultFocusSet=!0},e.GridController.prototype.canDeleteRecords=function(){for(var t=this.vTable.getSelection(!0),i=this.vTable.getGrid().records,a=[],s=0;s<t.length;s++){var n=i[t[s]];"ad_client_id"in n&&(e.MRole.getIsClientAccess(n.ad_client_id,!0)||a.push(t[s]))}return a},e.GridController.prototype.dataDelete=function(){var e=this.gTab.dataDelete(this.vTable.getSelection(!0));return this.vTabPanel&&this.vTabPanel.curTabPanel&&this.vTabPanel.curTabPanel.isCheckListFill&&this.vTabPanel.curTabPanel.setisCheckListFill(!1),this.refreshTabPanelData(this.gTab.getRecord_ID()),this.dynamicDisplay(-1),e},e.GridController.prototype.dataDeleteAsync=function(){this.aPanel.setBusy(!0);var e=this;e.gTab.getTableModel().dataDeleteAsync(e.vTable.getSelection(!0),e.gTab.currentRow).then((function(t){e.gTab.setCurrentRow(e.gTab.currentRow,!0),e.vTabPanel&&e.vTabPanel.curTabPanel&&e.vTabPanel.curTabPanel.isCheckListFill&&e.vTabPanel.curTabPanel.setisCheckListFill(!1),e.refreshTabPanelData(e.gTab.getRecord_ID()),e.dynamicDisplay(-1),e.aPanel.setBusy(!1)}))},e.GridController.prototype.rowChanged=function(e,i){if(null!=this.m_tree)if(!t.isArray(i)||e){if(!(i<=0)){var a=this.gTab.getValue("Name"),s=this.gTab.getValue("Description"),n=this.gTab.getValue("IsSummary"),o=1==n||"Y"==n,r=this.gTab.getValue("Action");-1!=this.gTab.gridTable.columns.indexOf("Action")||r||o||(r="O"),this.m_tree.nodeChanged(e,i,a,s,o,r)}}else for(var l=0;l<i.length;l++)this.m_tree.nodeChanged(e,i[l],"","","","")},e.GridController.prototype.dataIgnore=function(){this.gTab.dataIgnore(),this.dynamicDisplay(-1),this.notifyDependents(),this.vTable.refreshUndo()},e.GridController.prototype.addSubTabDataStatusListner=function(e){this.aContentPane=e},e.GridController.prototype.removeSubTabDataStatusListner=function(){this.aContentPane=null},e.GridController.prototype.dataStatusChanged=function(t){if(this.displayAsIncludedGC)this.enableDisableToolbarItems(!0);else{this.aContentPane?this.aContentPane.dataStatusChanged(t):this.aPanel.dataStatusChanged(t);var i=t.getChangedColumn();if(this.vHeaderPanel?this.vHeaderPanel.navigate():this.aPanel.vHeaderPanel&&this.aPanel.vHeaderPanel.navigate(!0),"VER"==t.m_info&&(t.m_info="",this.gTab.setCurrentRow(t.m_currentRow),this.dynamicDisplay(i)),t.getIsChanged()&&!(i<0)){var a=this.gTab.getField(i);if(null!=a)if(a.getCallout().length>0){var s=this.gTab.processFieldChange(a);s.length>0&&e.ADialog.error(s)}else{var n=a.getColumnName();dependants=this.gTab.getDependantFields(n);for(var o=0;o<dependants.length;o++){var r=dependants[o];if(null!=r){var l=r.getLookup();if(null!=l)-1!=l.getValidation().indexOf(n)&&(this.gTab.getTableModel().setDisableNotification(!0),this.gTab.setValue(r,null),this.gTab.getTableModel().setDisableNotification(!1))}}}this.dynamicDisplay(i)}}},e.GridController.prototype.includeTab=function(e){var t=e.getMTab();return this.gTab.getIncluded_Tab_ID()==t.getAD_Tab_ID()&&(this.vIncludedGC=e,this.vIncludedGC.switchMultiRow(),!0)},e.GridController.prototype.switchSingleRow=function(e){if(!this.onlyMultiRow&&!this.singleRow){this.singleRow=!0,this.isCardRow=!1,this.isMapRow=!1;var t=this.getVTablePanel(),i=this.getVPanel();this.isIncludedGCVisible,t.hide(),i.css("display","block"),this.getVCardPanel().hide(),this.getVMapPanel().hide(),this.gTab.isHPanelNotShowInMultiRow&&!this.actionParams.IsHideHeaderPanel&&null!=this.vHeaderPanel&&(this.vHeaderPanel.showPanel(),this.vHeaderPanel.sizeChangedListner&&this.vHeaderPanel.sizeChangedListner.onSizeChanged&&this.vHeaderPanel.sizeChangedListner.onSizeChanged()),this.dynamicDisplay(-1),"b"==this.aPanel.getTabSuffix()&&(this.aPanel.getLayout().removeClass("vis-ad-w-p-center-view-height"),this.getRoot().find(".vis-ad-w-p-vc-editview").css("position","unset"))}},e.GridController.prototype.switchMultiRow=function(e){if(this.singleRow||this.isCardRow){"b"==this.aPanel.getTabSuffix()&&(this.aPanel.getLayout().addClass("vis-ad-w-p-center-view-height"),this.getRoot().find(".vis-ad-w-p-vc-editview").css("position","absolute")),this.singleRow=!1,this.isCardRow=!1,this.isMapRow=!1;var t=this.getVTablePanel();this.getVPanel().hide(),this.getVCardPanel().hide(),this.getVMapPanel().hide(),this.isIncludedGCVisible?t.css({float:"right"}):t.css({float:""}),t.show(),t=null,this.vTable.resize(),this.vTable.refreshRow(),(this.gTab.isHPanelNotShowInMultiRow||this.actionParams.IsHideHeaderPanel)&&null!=this.vHeaderPanel&&(this.vHeaderPanel.hidePanel(),this.vHeaderPanel.sizeChangedListner&&this.vHeaderPanel.sizeChangedListner.onSizeChanged&&this.vHeaderPanel.sizeChangedListner.onSizeChanged()),this.isNewClick=!1}},e.GridController.prototype.switchCardRow=function(t){if(!this.isCardRow){this.singleRow=!1,this.isCardRow=!0,this.isMapRow=!1,this.getVTablePanel().hide(),this.getVPanel().hide(),this.getVMapPanel().hide();var i=this.getVCardPanel();if(this.isIncludedGCVisible?i.css({float:"right"}):i.css({float:""}),i.css("display","block"),this.gTab.getTableModel().setCardID(this.vCardView.cardID),!t){this.aPanel.clearSearchBox(),this.refreshFilterPanelData(),this.vCardView.resetCard();var a=new e.Query;this.getMTab().setQuery(a),this.query(this.gTab.getOnlyCurrentDays(),0,!1)}i=null}},e.GridController.prototype.switchMapRow=function(e){if(!this.isMapRow){this.isMapRow=!0,this.getVTablePanel().hide(),this.getVPanel().hide(),this.getVCardPanel().hide();var t=this.getVMapPanel();this.isIncludedGCVisible?t.css({float:"right"}):t.css({float:""}),t.show(),this.vMapView.refreshUI(this.getVMapPanel().width(),e),t=null}},e.GridController.prototype.notifyDependents=function(){this.vIncludedGC&&this.switchIncludedGC()},e.GridController.prototype.switchIncludedGC=function(){if(this.vIncludedGC&&!this.displayAsIncludedGC){if(!this.isIncludedGCVisible){var t=this.aPanel.getIncludedEmptyArea();t.empty();var i=this.vIncludedGC.getRoot();i.detach(),this.vIncludedGC.setUI(!0),t.append(i),t.height(e.Application.isMobile?250:350),t.css("display","flex"),i.show(),this.vIncludedGC.vTable.activate(),this.vIncludedGC.vTable.setReadOnly(!0),this.isIncludedGCVisible=!0,this.singleRow||(this.singleRow=!0,this.switchMultiRow()),this.vIncludedGC.displayAsIncludedGC=!0,this.vIncludedGC.singleRow=!0,this.vIncludedGC.switchMultiRow(),this.vTable.resize()}window.setTimeout((function(e){e.vIncludedGC.query(0,0,!1),e=null}),1,this)}},e.GridController.prototype.removeRecord=function(e){var t=this.vTable.getSelection(!0);if(t&&t.length>0)for(var i=0;i<t.length;i++)this.vTable.grid.unselect(t[i]+1),this.vTable.grid.remove(t[i]+1);this.navigate(0),this.aPanel.setBusy(!1)},e.GridController.prototype.dispose=function(){this.gTab.removeDataStatusListener(this.aPanel),this.gTab.removeDataStatusListener(),this.gTab.getTableModel().removeTableModelListener(this.vTable),this.gTab.getTableModel().removeCardModelListener(this.vCardView),this.gTab.getTableModel().removeRowChangedListener(),this.gTab.getTableModel().removeQueryCompleteListner(),this.disposeComponent(),this.gTab=null,this.windowNo=null,this.onlyMultiRow=null,this.aPanel=null,this.m_tree&&this.m_tree.dispose(),this.vTabPanel&&(this.vTabPanel.dispose(),this.vTabPanel=null),this.aFilterPanel&&(this.aFilterPanel.dispose(),this.aFilterPanel=null),this.vHeaderPanel&&this.vHeaderPanel.dispose(),this.m_tree=null},e.GridController.prototype.HEADER_HEIGHT=55}(VIS,jQuery)},7893:()=>{!function(e,t){e.ThemeCnfgtor=function(){var i=t("<div class='vis-forms-container'>"),a=t("<div class='vis-apanel-busy'>"),s=e.Env.getWindowNo(),n=null,o=null,r=null,l=null,d=null,c=null,h=null,u=null,p=this;function g(){f("0, 152, 247","255, 255, 255","238, 238, 238","51, 51, 51"),v(!0),i.load(e.Application.contextUrl+"Theme/ThemeCnfgtr/?windowNo="+s,(function(a){i.find("#divTheme_"+s),n=i.find(".vis-thed-clrpickerouterwrap"),o=i.find(".vis-thed-botsavesec"),l=n.find('input[name="primary"]'),d=n.find('input[name="onprimary"]'),c=n.find('input[name="secondary"]'),h=n.find('input[name="onsecondary"]'),u=o.find("input"),r=i.find(".vis-thed-savedlistwrap"),n.find("input").on("change",(function(e){"primary"==this.name?document.documentElement.style.setProperty("--v-c-th-primary",T(this.value)):"onprimary"==this.name?document.documentElement.style.setProperty("--v-c-th-on-primary",T(this.value)):"secondary"==this.name?document.documentElement.style.setProperty("--v-c-th-secondary",T(this.value)):"onsecondary"==this.name&&document.documentElement.style.setProperty("--v-c-th-on-secondary",T(this.value))})),o.find("a").on("click",(function(i){if(""!=u.val().trim()){var a,s,n,o,r,p,g,f="sandd"==t(this).data("action");v(!0),a=T(l.val()),s=T(d.val()),n=T(c.val()),o=T(h.val()),r=f,p=u.val(),(g={}).Primary=a,g.OnPrimary=s,g.Seconadary=n,g.OnSecondary=o,g.IsDefault=r,g.Name=p,v(!0),e.dataContext.postJSONData(e.Application.contextUrl+"Theme/Save",g,m)}else e.ADialog.error("EnterName")})),r.on("click","LI",(function(i){v(!0);var a=t(i.currentTarget).data("id");i.target.className.indexOf("vis-delete")>-1?e.ADialog.confirm("DeleteRecord?",!0,"","Confirm",(function(t){t?e.dataContext.postJSONData(e.Application.contextUrl+"Theme/Delete",{id:a},(function(e){b()})):v(!1)})):e.dataContext.postJSONData(e.Application.contextUrl+"Theme/SetDefault",{id:a},(function(e){b()}))})),b()}))}function f(e,t,i,a){document.documentElement.style.setProperty("--v-c-th-primary",e),document.documentElement.style.setProperty("--v-c-th-on-primary",t),document.documentElement.style.setProperty("--v-c-th-secondary",i),document.documentElement.style.setProperty("--v-c-th-on-secondary",a)}function v(e){a[0].style.visibility=e?"visible":"hidden"}function m(e){e>0?(b(),u.val("")):v(!1)}function b(){v(!0),r.empty(),e.dataContext.getJSONData(e.Application.contextUrl+"Theme/GetList",{id:0},(function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i];t.push('<li class="vis-thed-savedlistitem'),a.IsDefault&&t.push(" vis-thed-selectedlistitem"),t.push('" data-id="'+a.Id+'">'),t.push('<div class="vis-theme-rec" style="width:80px">'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.Primary+',1)"></span>'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.OnPrimary+',1)"></span>'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.Seconadary+',1)"></span>'),t.push('<span class="vis-theme-color" style="background-color:rgba('+a.OnSecondary+',1)"></span>'),t.push("</div>"),t.push('<a class="vis-thed-themename">'+a.Name+"</a>"),a.IsDefault&&t.push('<i class="vis vis-markx"></i>'),t.push('<span style="margin:0 3px 0 3px" class="vis vis-delete"></span>'),t.push("</li>"),a.IsDefault&&(l.val(y(a.Primary)),d.val(y(a.OnPrimary)),c.val(y(a.Seconadary)),h.val(y(a.OnSecondary)),f(a.Primary,a.OnPrimary,a.Seconadary,a.OnSecondary))}r.append(t.join(" ")),v(!1)}))}function y(e){var t,i;e=e.split(",");return t=e[0],i=e[1],"#"+(16777216+(e[2]|i<<8|t<<16)).toString(16).slice(1)}function T(e){var t=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(function(e,t,i,a){return t+t+i+i+a+a}));var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}(e);return t?t.r+","+t.g+","+t.b:t}this.show=function(){g(),function(){var s=t(window).width()-150,n=t(window).height()-10;a.height(n),a.width(s),i.append(a);var o=new e.ChildDialog;o.setContent(i),o.setWidth(s),o.setHeight(n),o.setTitle(e.Msg.getMsg("ThemeConfig")),o.setModal(!0),o.onClose=function(){p.dispose(),t("#ui-datepicker-div").remove(),i=null,p=null},o.show(),o.hideButtons()}()},this.dispose=function(){i.remove(),i=null,p=null}}}(VIS,jQuery)},8789:()=>{!function(e,t){function i(e){var i=t('<div class=vis-cv-rd-top><i class="vis vis-arrow-up"></i></div>'),a=t('<div class=vis-cv-rd-down><i class="vis vis-arrow-down"></i></div>'),s=t("<div class=vis-cv-rd-body>");function n(e){if(s[0].clientHeight+s[0].scrollTop>=s[0].scrollHeight?a.css("opacity",".6"):a.css("opacity","1"),0==s[0].scrollTop?i.css("opacity",".6"):i.css("opacity","1"),"up"==e){if(i.css("opacity")<1)return;s[0].scrollTop-=60}else{if(a.css("opacity")<1)return;s[0].scrollTop+=60}}e.append(i).append(s).append(a),this.addItem=function(e){var i=t('<span class="vis-cv-rd-body-item">');i.text(e),s.append(i),s[0].clientHeight<s[0].scrollHeight&&a.css("opacity","1")},this.reset=function(){s.empty(),i.css("opacity",".5"),a.css("opacity",".5")},this.dispose=function(){s.empty(),i.off(),a.off()},i.on("click",(function(){n("up")})),a.on("click",(function(){n("down")}))}function a(){var a;this.cGroupInfo={},this.cCols=[],this.cConditions=[],this.cGroup=null,this.mTab,this.AD_Window_ID,this.AD_Tab_ID,this.groupCtrls=[],this.fields=[],this.grpCount=0,this.oldGrpCount=0,this.grpColName="",this.hasIncludedCols=!1,this.GroupSequence=null,this.ExcludedGroup=null,this.onCardEdit=null,this.cardViewData=null;var s,n=null,o=null,r=null,l=null,d=this,c=null;this.isAutoCompleteOpen=!1;var h=null,u=null;this.cardID=0;var p,g=null;function f(){c.scrollLeft(n.scrollLeft())}this.editID=0,this.VCardRightPanel=null,this.SyncScroll=function(){f()},p=t("body").width()-65,a=t("<div class='vis-cv-body vis-noselect'>"),u=t("<div class='vis-cv-ld'>"),h=t("<div class='vis-cv-rd'>"),n=t("<div class='vis-cv-main' style='max-width:"+p+"px'>"),s=t("<div class='vis-cv-header'>"),o=t('<input  class="vis-vs-card-autoComplete" style="display:inline">'),r=t("<p>"),l=t('<span class="vis-ad-w-p-tb-s-icon-down vis-cv-cardlist"><i class="fa fa-ellipsis-h"></i></span>'),c=t("<div class='vis-cv-groupHeader'style='overflow:hidden; max-width:"+p+"px'>"),g=t('<a href="javascript:;" class="vis-dailogOpen">'+e.Msg.getMsg("editCardView")+"</a>"),s.append(g).append(o).append(l).append(r),u.append(s).append(c).append(n),a.append(u).append(h),n.scroll((function(){f()})),o.autocomplete({select:function(e,i){m(i.item.id,i.item.label);var a=t(e.currentTarget);a.find(".vis-cv-card-selected-card").removeClass("vis-cv-card-selected-card"),a.find('[data-checkid="'+i.item.id+'"]').addClass("vis-cv-card-selected-card"),e.stopPropagation()},minLength:0,open:function(e,t){d.isAutoCompleteOpen=!0},close:function(e,t){window.setTimeout((function(){d.isAutoCompleteOpen=!1}),600)},source:[]}),o.autocomplete().data("ui-autocomplete")._renderItem=function(i,a){var s=null,n=null;s="Y"==a.isDefault?t("<span title='"+e.Msg.getMsg("DefaultCard")+"'  data-id='"+a.id+"' class='VIS-winSearch-defaultIcon'></span>"):t("<span title='"+e.Msg.getMsg("MakeDefaultCard")+"' data-id='"+a.id+"' class='VIS-winSearch-NonDefaultIcon'></span>"),n=t("<span class='fa fa-check-circle vis-cv-card-selected-card-listitem'></span>");var o=null;return o=d.AD_CardView_ID==a.id?t("<li style='white-space:normal !important; max-width:210px !important'>").append(t("<a  data-checkid='"+a.id+"'  class='vis-cv-card-selected-card' style='display:block' title='"+a.title+"'></a>").append(n).append("<p>"+a.label+"</p>").append(s)).prependTo(i):t("<li style='white-space:normal !important; max-width:210px !important'>").append(t("<a  data-checkid='"+a.id+"'  style='display:block' title='"+a.title+"'></a>").append(n).append("<p>"+a.label+"</p>").append(s)).prependTo(i),a.Created!=e.context.getAD_User_ID()&&o.find("p").text(a.label+" (S)"),s.on("click",(function(i){var a=t(this).data("id");t.ajax({url:e.Application.contextUrl+"JsonData/InsertUpdateDefaultCard",dataType:"json",data:{AD_Tab_ID:d.mTab.getAD_Tab_ID(),AD_Card_ID:a},success:function(e){},error:function(e){console.log(e)}})})),o},g.click((function(){d.aPanel.cmd_cardDialog()})),this.VCardRightPanel=new i(h),this.getRoot=function(){return a},this.getRightDiv=function(){return h},this.getBody=function(){return n},this.setHeader=function(e){r.text(e)},this.getHeader=function(){return s},this.getGroupHeader=function(){return c},this.sizeChanged=function(e,t){a.height(e-12+"px"),h.height(e-12+"px"),this.calculateWidth(t)},this.setBusy=function(e){this.aPanel.setBusy(!1)},this.calculateWidth=function(e){this.navigate()},n.on("mousedown touchstart","div.vis-cv-card",(function(e){if(d.onCardEdit){var i,a=t(e.target);if("SPAN"==a[0].nodeName&&a.hasClass("vis-cv-card-edit"))((i=a.data("recid"))||0===i)&&(d.editID=i,d.onCardEdit({recid:i}));else{for(var s=0;!(a.hasClass("vis-cv-card")||s>5);)a=a.parent(),s++;((i=a.data("recid"))||0===i)&&(d.onCardEdit({recid:i},!0),d.navigate(i,!1,!0))}}e.stopPropagation()})),this.getAD_CardView_ID=function(){return this.AD_CardView_ID},this.getField_Group_ID=function(){return this.cGroup?this.cGroup.getAD_Field_ID():0},this.getCardCmb=function(){return o};var v=function(){var t=e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/GetCardsInfo",{AD_Tab_ID:d.mTab.getAD_Tab_ID()});t&&d.fillCardViewList(t,!0)},m=function(e,t){d.getCardViewData(d.mTab,e,t)},b=null,y=null;this.navigate=function(e,t,i){e&&(y=e),t||(b&&b.length>0&&b.toggleClass("vis-cv-card-selected"),0!=(b=n.find("div.vis-cv-card[name~=vc_"+y+"]")).length&&(b.toggleClass("vis-cv-card-selected"),i||b[0].scrollIntoView()))},this.dC=function(){for(n.off("click"),this.onCardEdit=null,d=null,a.remove(),n.remove(),s.remove(),o.remove(),o=null,l.remove(),l=null,a=n=s=null,this.getRoot=this.getBody=this.setHeader=this.getHeader=this.dC=null,b=null,this.cGroupInfo={},this.cCols.length=0,this.cConditions.length=0,this.cGroup=null,this.mTab=null,this.fields.length=0,this.grpCount=null;this.groupCtrls.length>0;)this.groupCtrls.pop().dispose();this.VCardRightPanel&&this.VCardRightPanel.dispose(),this.VCardRightPanel=null},this.fillCardViewList=function(t,i){o.empty();var a=[];if(t&&t.length>0){for(var s=t.length-1;s>=0;s--)t[s].Name=e.Utility.decodeText(t[s].Name),t[s].IsDefault?a.push({title:t[s].Name,label:t[s].Name,value:t[s].Name,id:t[s].AD_CardView_ID,isDefault:"Y",Created:t[s].Created}):a.push({title:t[s].Name,label:t[s].Name,value:t[s].Name,id:t[s].AD_CardView_ID,isDefault:"N",Created:t[s].Created});o.autocomplete("option","source",a,"position",{my:"left top",at:"left bottom"}),i&&o.autocomplete("search",""),this.AD_CardView_ID&&o.val(this.cardName)}},o.one("focus",v),o.on("change",m),l.on("click",(function(){v()}))}function s(i,a,s,o,r,l,d,c,h,u){var p,g=null,f=[];windowNo=u.curTab.getWindowNo(),g=t("<div class='vis-cv-cg vis-pull-left'><div data-key='"+h+"'  class='vis-cv-grpbody'></div></div></div>"),p=g.find(".vis-cv-grpbody"),i&&g.css({"margin-right":"0px",width:"100%"}),this.getRoot=function(){return g},this.getBody=function(){return p},this.setWidth=function(e){g.width(e)},function(){var t=null;if(this.fieldStyles={},a)for(var s=0;s<a.length;s++)t=new n(o,a[s],l,d,c,windowNo,this.fieldStyles,u),i&&t.getRoot().width("240px").css({margin:"5px 12px 12px 5px",float:e.Application.isRTL?"right":"left"}),0==s&&t.addStyleToDom(),f.push(t),p.append(t.getRoot()),t.evaluate(r)}(),this.dC=function(){for(;f.length>0;)f.pop().dispose();g.remove(),g=null,p=null,this.getBody=null,this.getRoot=null}}function n(i,a,s,n,o,r,l,d){this.record=a,this.aPanel=d,this.dynamicStyle=[],this.textAlignEnum={C:"Center",R:"flex-end",L:"flex-start"},this.alignItemEnum={C:"Center",T:"flex-start",B:"flex-end"},this.dynamicStyle=[],this.styleTag=document.createElement("style"),this.windowNo=r,this.fieldStyles=l;var c=t('<div class="vis-cv-card va-dragdrop" data-recid='+a.recid+" name = vc_"+a.recid+" ></div>"),h=t('<span class="glyphicon glyphicon-pencil vis-cv-card-edit vis-pull-right" data-recid='+a.recid+"></span>");c.append(h);var u,p=null,g=t('<div class="vis-ad-w-p-card_root_common">');c.append(g),this.fieldStyles["vis-ad-w-p-card-Custom_"+r]||(this.fieldStyles["vis-ad-w-p-card-Custom_"+r]={}),this.headerCustom=this.fieldStyles["vis-ad-w-p-card-Custom_"+r].headerParentCustomUISettings,this.headerCustom||(this.headerCustom=this.headerParentCustomUISettings(n),this.fieldStyles["vis-ad-w-p-card-Custom_"+r].headerParentCustomUISettings=this.headerCustom),c.addClass(this.headerCustom),this.fieldStyles["root_"+r]||(this.fieldStyles["root_"+r]={}),this.rootCustomStyle=this.fieldStyles["root_"+r].headerUISettings,this.rootCustomStyle||(this.rootCustomStyle=this.headerUISettings("",o),this.fieldStyles["root_"+r].headerUISettings=this.rootCustomStyle),g.addClass(this.rootCustomStyle),this.setHeaderItems=function(i,a,s,n){if(i){var o=null;for(var r in i.HeaderItems){var l=i.HeaderItems[r],d=l.StartColumn,c=l.ColumnSpan,h=l.StartRow,u=l.RowSpan,p=l.JustifyItems,g=l.AlignItems,m=l.Padding,C=l.BackgroundColor,D=l.HideFieldIcon,I=l.HideFieldText,w=l.FieldValueStyle,S=l.FieldLabelStyle;C||(C="");var A=l.FontColor;A||(A="");var _=l.FontSize;_||(_="");var P=null,N=null;$divDBIconSpan=t("<span>"),$divDBLevel=t("<span>");var x=null,R=null,L=null,E=i.AD_GridLayout_ID;if(this.fieldStyles[d+"_"+c+"_"+h+"_"+u+"_"+E]||(this.fieldStyles[d+"_"+c+"_"+h+"_"+u+"_"+E]={}),this.dynamicClassName=this.fieldStyles[d+"_"+c+"_"+h+"_"+u+"_"+E].applyCustomUISettings,this.dynamicClassName||(this.dynamicClassName=this.applyCustomUISettings(r,d,c,h,u,p,g,C,A,_,m),this.fieldStyles[d+"_"+c+"_"+h+"_"+u+"_"+E].applyCustomUISettings=this.dynamicClassName),(P=a.find("."+this.dynamicClassName)).length<=0&&(P=t('<div class="vis-w-p-card-data-f '+this.dynamicClassName+'">')),l.ColSql.length>0){var k={};x=t('<div class="vis-w-p-header-Label-f"></div>');var V=l.ColSql;if(null==(L=new e.Controls.VKeyText(V,this.windowNo,this.windowNo+"_"+r,!1,null,l.AD_GridLayoutItems_ID)))continue;k.control=L;var M={control:k,field:null};x.append(L.getControl()),L.setValue(null,!1,n),(w=l.FieldValueStyle)&&x.attr("style",w),P.append(x),a.append(P)}else{if(!o){o={};for(var G=0;G<s.length;G++){var F=s[G];F.getCardViewSeqNo()in o?o[F.getCardViewSeqNo()].push(F):o[F.getCardViewSeqNo()]=[F]}}var O=o[r];if(!O)continue;for(var H=0;H<O.length;H++){var U=O[H];if(U){U.getCardFieldStyle()&&(w=U.getCardFieldStyle()),U.setCardIconHide(D),U.setCardTextHide(I),this.fieldStyles[U.getColumnName()]||(this.fieldStyles[U.getColumnName()]={});k={};N=t('<div class="vis-w-p-card-icon-f"></div>');var B=C.indexOf("flex-direction"),W="";if(B>-1){var q=C.indexOf(";",B+14);W="display:flex; "+C.substring(B,q)}x=t('<div class="vis-w-p-card-Label-f" style="'+W+'"></div>'),$divDBIconSpan=t('<div class="vis-w-p-card-icon-f"></div>'),$divDBImgSpan=t('<div class="vis-w-p-card-img-f"></div>'),$divDBLevel=t('<div class="vis-w-p-card-Label-f" style="'+W+'"></div>'),R=e.VControlFactory.getHeaderLabel(U,!0),L=e.VControlFactory.getReadOnlyControl(this.curTab,U,!1,!1,!1),U.getOrginalDisplayType()==e.DisplayType.Button&&null!=L&&L.addActionListner(this),this.fieldStyles[U.getColumnName()+"applyCustomUIForLabelValue"]||(this.fieldStyles[U.getColumnName()+"applyCustomUIForLabelValue"]={}),this.dynamicLabelValue=this.fieldStyles[U.getColumnName()+"applyCustomUIForLabelValue"].applyCustomUIForLabelValue,this.dynamicLabelValue||(this.dynamicLabelValue=this.applyCustomUIForLabelValue(r,d,h,U,S),this.fieldStyles[U.getColumnName()+"applyCustomUIForLabelValue"]={applyCustomUIForLabelValue:this.dynamicLabelValue}),R&&R.getControl().addClass(this.dynamicLabelValue),this.fieldStyles[U.getColumnName()+"applyCustomUIForFieldValue"]||(this.fieldStyles[U.getColumnName()+"applyCustomUIForFieldValue"]={}),this.dynamicFieldValue=this.fieldStyles[U.getColumnName()+"applyCustomUIForFieldValue"].applyCustomUIForFieldValue,this.dynamicFieldValue||(this.dynamicFieldValue=this.applyCustomUIForFieldValue(r,d,h,U,w),this.fieldStyles[U.getColumnName()+"applyCustomUIForFieldValue"]={applyCustomUIForFieldValue:this.dynamicFieldValue}),L.getControl().addClass(this.dynamicFieldValue),k.control=L;M={control:k,field:U};var z=t("<span></span>"),Q=e.VControlFactory.getIcon(U);if(null!=L){var j=null;R&&(j=R.getControl().addClass("vis-w-p-card-data-label"));var Y=v(U,n),$=t("<img>"),J=t("<span>");M.img=$;if(U.lookup&&U.lookup.gethasImageIdentifier()){M.imgspan=J;var K=null,Z=null;this.iconStyle=null,e.DisplayType.List==U.lookup.displayType?(U.lookup.getLovIconType(n[U.getColumnName().toLower()],!0),!(K=U.lookup.getLOVIconElement(n[U.getColumnName().toLower()],!0))&&Y&&(K=Z=Y.substring(0,1))):(Y=e.Utility.Util.getIdentifierDisplayVal(Y),K=b(U,n)),K&&!K.contains("Images/")&&-1==K.indexOf("fa fa-")&&-1==K.indexOf("vis vis-")?(Z=K,J.append(Z),Q=null):e.DisplayType.List==U.lookup.displayType?!K||K.contains("Images/")||-1==K.indexOf("fa fa-")&&-1==K.indexOf("vis vis-")?($.attr("src",t(K).attr("src")),J.append($)):(Z=K,t(K).attr("style",this.iconStyle),J.append(K)):-1==K.indexOf("fa fa-")&&-1==K.indexOf("vis vis-")?($.attr("src",K),J.append($)):(Z=t('<i style="'+this.iconStyle+'" class="'+K+'"></i>'),J.append(Z),Q=null);var X=t("<div>"),ee=t('<div class="vis-w-p-card-value-container">');z.addClass("vis-w-p-card-icon-fixed"),M.imgspan=z,null!=Q?(y(w,z,t(Q),$divDBLevel,!0),N.append(z)):y(w,x,J,L.getControl(),!0),T(U,Z,$,J,j,x,N),ee.append(x),e.DisplayType.List!=U.lookup.displayType&&x.append(L.getControl()),P.append(X).append(ee),a.append(P),e.DisplayType.List,U.lookup.displayType,f(Y,L,U)}else if(U.getDisplayType()==e.DisplayType.Image){f(Y,L,U);var te=L.getControl().find("img");if(!U.isCardTextHide()){var ie=t('<label for="'+U.getColumnName()+'" class="vis-w-p-card-data-label">'+U.getHeader()+"</label>");ie.addClass(this.dynamicLabelValue),x.append(ie)}$divDBLevel=null,y(w,x,te,$divDBLevel,!0),P.append(x)}else y(w,P,N,x,!1),z.addClass("vis-w-p-card-icon-fixed"),M.imgspan=z,U.getOrginalDisplayType()==e.DisplayType.Button?N.remove():this.setIconsDisplay(U,N,z,Q,j,x),f(Y,L,U),x.append(L.getControl());a.append(P)}}}}}}},this.setIconsDisplay=function(e,t,i,a,s,n){e.isCardIconHide()||e.isCardTextHide()?e.isCardIconHide()&&e.isCardTextHide()?t.remove():!e.isCardIconHide()&&e.isCardTextHide()?(t.append(i.append(a)),s&&s.length>0&&s.hide()):e.isCardIconHide()&&!e.isCardTextHide()&&(s&&s.length>0&&n.append(s),t.remove()):(t.append(i.append(a)),s&&s.length>0&&n.append(s))},this.setHeader=function(){if(s&&s.length>0)for(var n=0;n<s.length;n++){var o=s[n],r=o.HeaderTotalRow,l=o.HeaderTotalColumn,d=o.HeaderBackColor,h=o.HeaderPadding,g=o.AD_GridLayout_ID;d||(d=""),h||(h=""),this.fieldStyles[l+"_"+r+"_"+d+"_"+h+"_"+g]||(this.fieldStyles[l+"_"+r+"_"+d+"_"+h+"_"+g]={}),this.dymcClass=this.fieldStyles[l+"_"+r+"_"+d+"_"+h+"_"+g].fieldGroupContainerUISettings,this.dymcClass||(this.dymcClass=this.fieldGroupContainerUISettings(l,r,d,h,g),this.fieldStyles[l+"_"+r+"_"+d+"_"+h+"_"+g].fieldGroupContainerUISettings=this.dymcClass);var m=t('<div class="'+this.dymcClass+'">');c.append(m),this.setHeaderItems(o,m,i,a)}else for(var C=0;C<i.length;C++){p=i[C];var D=a[p.getColumnName().toLowerCase()];u=p.getOrginalDisplayType();var I=e.VControlFactory.getHeaderLabel(p,!0),w=e.VControlFactory.getReadOnlyControl(this.curTab,p,!1,!1,!1),S=null;if(I&&(S=I.getControl().addClass("vis-w-p-card-data-label")),p.getOrginalDisplayType()==e.DisplayType.Button&&null!=w&&w.addActionListner(this),p.lookup&&p.lookup.gethasImageIdentifier()){var A=t('<div class="vis-w-p-card-icon-f"></div>'),_=t('<div class="vis-w-p-card-data-f">'),P=t('<div class="vis-w-p-card-Label-f"></div>'),N=null,x=null,R=t("<img>"),L=t("<span>"),E=v(p,a);y(p.cardFieldStyle,_,A,P,!0),e.DisplayType.List==p.lookup.displayType?!(N=p.lookup.getLOVIconElement(a[p.getColumnName().toLower()],!0))&&E&&(N=x=E.substring(0,1)):(E=e.Utility.Util.getIdentifierDisplayVal(E),N=b(p,a)),N&&!N.contains("Images/")?(x=N,L.append(x)):e.DisplayType.List==p.lookup.displayType?R.attr("src",t(N).attr("src")):R.attr("src",N),A.append(L),A.append(R),T(p,x,R,L,S,P,A),P.append(w.getControl()),f(E,w,p),c.append(_)}else{if(e.DisplayType.IsLookup(u))p.getLookup()&&(D=p.getLookup().getDisplay(D));else if(e.DisplayType.YesNo==u)D=D||"Y"==D?e.Msg.getMsg("Yes"):D=e.Msg.getMsg("No");else if(e.DisplayType.IsDate(u))if(D){D=D.replace("Z","");var k=new Date(D);D=u==e.DisplayType.Date?k.toLocaleDateString():u==e.DisplayType.DateTime?k.toDateString():k.toLocaleTimeString()}else D=null;else if(e.DisplayType.Amount==u){D=e.Utility.Util.getValueOfDecimal(D).toLocaleString()}else if(e.DisplayType.Quantity==u){D=e.Utility.Util.getValueOfDecimal(D).toLocaleString()}else{if(e.DisplayType.Image==u){f(D,w,p),I&&c.append(I.getControl()),c.append(w.getControl());continue}if(e.DisplayType.Button==u){f(D,w,p),c.append(w.getControl());continue}}D||0==D||(D=" -- "),D=w2utils.encodeTags(D),p.getIsEncryptedField()&&(D=D.replace(/\w|\W/g,"*")),p.getObscureType()&&(D=e.Env.getObscureValue(p.getObscureType(),D));var V="";V=e.Application.isRTL?"<p><strong title='"+D+"'>"+D+"</strong> :"+p.getHeader()+"</p>":"<p>"+p.getHeader()+": <strong title='"+D+"'>"+D+"</strong></p>",c.append(t(V))}}},this.setColor=function(e,t){e&&c.css("background",e),t&&c.css("color",e)},h.on("touchstart",(function(){t(this).css({color:"gray"})})),this.getRoot=function(){return c},this.setWidth=function(e){c.width(e)},this.dC=function(){h.off("touchstart mouseover"),this.styleTag.remove(),this.styleTag=null,c.remove(),c=null,this.getRoot=null,this.dc=null};var f=function(t,i,a){if(t){if(t.startsWith&&t.startsWith("<")&&t.endsWith(">")&&(t=t.replace("<","").replace(">","")),a.getDisplayType()==e.DisplayType.Image){var s=i.getValue();i.getControl().show(),i.setDimension(240,320),s==t&&i.refreshImage(t)}else i.format&&(t=i.format.GetFormatAmount(i.format.GetFormatedValue(t),"init",e.Env.isDecimalPoint()));i.setValue(t,!1)}else a.getDisplayType()==e.DisplayType.Image?(i.getControl().hide(),i.setValue(null,!1)):a.getOrginalDisplayType()==e.DisplayType.Button&&a.getAD_Reference_Value_ID()>0?i.setText("- -"):i.setValue("- -",!0)},v=function(t,i){var a=i[t.getColumnName().toLowerCase()];if(a){var s=t.getDisplayType();if(t.lookup)a=t.lookup.getDisplay(a,!0,!1);else if(e.DisplayType.IsDate(s))a=s==e.DisplayType.DateTime?new Date(a).toLocaleString():s==e.DisplayType.Date?new Date(a).toLocaleDateString():new Date(a).toLocaleTimeString();else if(s==e.DisplayType.YesNo){var n=a.toString();t.getIsEncryptedColumn()&&(n=e.secureEngine.decrypt(n)),a=n.equals("true")}else a=a.toString();t.getIsEncryptedField()&&a&&a.length>0&&(a=a.replace(/[a-zA-Z0-9-. ]/g,"*").replace(/[^a-zA-Z0-9-. ]/g,"*")),t.getObscureType()&&a&&a.length>0&&(a=e.Env.getObscureValue(t.getObscureType(),a))}else a=null;return a};this.iconStyle=null;var m=this,b=function(t,i,a){var s=i[t.getColumnName().toLowerCase()];if(null==(s=t.lookup.getDisplay(s,!0,!0))||""==s)return"";var n,o=s.indexOf("Images/"),r=s.indexOf("^^");if(null!=s&&s&&(o>-1||r>-1))if(o>-1){var l=s.substring(s.indexOf("Images/")+7,s.lastIndexOf("^^"));l=e.Application.contextUrl+"Images/Thumb32x32/"+l}else-1==o&&r>-1&&(n=(n=s.substring(s.indexOf("***"),s.lastIndexOf("***")+3)).replace("***","").replace("***",""),-1==(o=(s=s.replace(s.substring(s.indexOf("***"),s.lastIndexOf("***")+3),"")).indexOf("vis vis-"))&&(o=s.indexOf("fa fa-")),l=s.substring(o,s.lastIndexOf("^^")),m.iconStyle=n);if(0==c||l.indexOf("nothing.png")>-1&&!n){(s=s.replace("^^"+s.substring(s.indexOf("Images/"),s.lastIndexOf("^^")+2),"^^^")).indexOf("Images/")>-1&&(s=s.replace(s.substring(s.indexOf("Images/"),s.lastIndexOf("^^")+2),"^^^")),s=s.split("^^^");for(var d="",c=0;c<s.length;c++)if(s[c].trim().length>0)return 0==d.length&&(d=s[c].trim().substring(0,1).toUpper()),d}return l},y=function(e,t,i,a,s){var n=e;if(n&&n.length>0&&(n=n.split("|")),n&&n.length>0&&1==s)for(var o=0;o<n.length;o++)if(n[o].indexOf("@img::")>-1||n[o].indexOf("@span::")>-1){t.append(i);var r="";n[o].indexOf("@img::")>-1?r=n[o].replace("@img::",""):n[o].indexOf("@span::")&&(r=n[o].replace("@span::","")),i.attr("style",r)}else n[o].indexOf("@value::")>-1?t.append(a):n[o].indexOf("<br>")>-1?t.css("flex-direction","column"):(t.append(i),t.append(a));else t.append(i),t.append(a)},T=function(e,t,i,a,s,n,o){e.isCardIconHide()||e.isCardTextHide()?e.isCardIconHide()&&e.isCardTextHide()?(o.empty(),o.remove()):e.isCardTextHide()?(null!=t?i.hide():a.hide(),s&&s.length>0&&s.remove()):e.isCardIconHide()&&(s&&s.length>0&&n.append(s),o.empty(),o.remove()):(null!=t?i.hide():a.hide(),s&&s.length>0&&n.append(s))};this.setHeader()}a.prototype.tableModelChanged=function(t,i,a){var s=null;if(t===e.VTable.prototype.ROW_REFRESH)s=i.recid?i.recid:i;else if(t===e.VTable.prototype.ROW_UNDO)this.getBody().find("div.vis-cv-card[name~=vc_"+i+"]").remove();else if(t===e.VTable.prototype.ROW_DELETE){for(var n=i.slice();n.length>0;){var o=n.pop();this.getBody().find("div.vis-cv-card[name~=vc_"+o+"]").remove()}isNaN(a)&&(s=a[0])}else t===e.VTable.prototype.ROW_ADD&&(s=i.recid);s&&(i&&this.replaceCard(i,s),this.navigate(s,null,null))},a.prototype.replaceCard=function(i,a){i.recid=a;var s=new n(this.fields,i,this.headerItems,this.headerStyle,this.headerPadding,this.mTab.getWindowNo(),{},this.aPanel);1==this.grpCount&&s.getRoot().width("240px").css({margin:"5px 12px 12px 5px",float:e.Application.isRTL?"right":"left"}),0==t('head:contains("'+s.headerCustom+' {")').length&&s.addStyleToDom(),this.getRoot().find("[name='vc_"+a+"']").replaceWith(s.getRoot()),s.evaluate(this.cConditions)},a.prototype.setupCardView=function(e,t,i,a){this.mTab=t,this.aPanel=e,t.vo&&t.vo.DefaultCardID?this.cardID=t.vo.DefaultCardID:this.setCardViewData(),i.append(this.getRoot())},a.prototype.getCardViewData=function(e,t,i){this.cardID=t,this.mTab.getTableModel().setCardID(t),this.aPanel.curGC.query(this.mTab.getOnlyCurrentDays(),0,!1),this.getCardCmb().val(i)},a.prototype.resetCard=function(){for(;this.groupCtrls.length>0;)this.groupCtrls.pop().dispose();this.VCardRightPanel.reset(),this.getGroupHeader().empty(),this.groupCtrls.length=0,this.editID=0},a.prototype.setCardViewData=function(e){if(this.hasIncludedCols=!1,this.fields=[],this.cGroup=null,this.cConditions=[],this.GroupCount={},this.headerItems={},e){this.AD_CardView_ID=e.AD_CardView_ID,this.cardName=e.Name,this.GroupSequence=e.GroupSequence,this.ExcludedGroup=e.ExcludedGroup;for(var t=0;t<e.GroupCount.length;t++)this.GroupCount[e.GroupCount[t].Group]=e.GroupCount[t].Count;this.getCardCmb().val(e.Name),(i=this.mTab.getFieldById(e.FieldGroupID))&&(this.cGroup=i),this.cConditions=e.Conditions,this.headerItems=e.HeaderItems,this.headerStyle=e.Style,this.headerPadding=e.Padding;for(t=0;t<e.IncludedCols.length;t++){(i=this.mTab.getFieldById(e.IncludedCols[t].AD_Field_ID))&&(i.setCardViewSeqNo(e.IncludedCols[t].SeqNo),i.setCardFieldStyle(e.IncludedCols[t].HTMLStyle),this.fields.push(i),this.hasIncludedCols=!0)}}var i;this.fields.length<1&&(this.fields.length<1&&((i=this.mTab.getField("Name"))&&this.fields.push(i),(i=this.mTab.getField("Description"))&&this.fields.push(i),(i=this.mTab.getField("Help"))&&this.fields.push(i)));for(var a in this.cGroupInfo)this.cGroupInfo[a].records.length=0;this.cGroupInfo={},this.grpCount=0,this.isProcessed=!1},a.prototype.createGroups=function(){if(this.isProcessed)for(var i in this.cGroupInfo)this.cGroupInfo[i].records=[];else{if(this.cGroup){this.cGroupInfo=[],this.grpCount=0;var a=this.cGroup;if(a){if(a.getDisplayType()==e.DisplayType.YesNo)this.cGroupInfo.true={name:"Yes",records:[],key:!0},this.cGroupInfo.false={name:"No",records:[],key:!1},this.GroupCount.true=this.GroupCount.Y,this.GroupCount.false=this.GroupCount.N,this.grpCount=2;else if(e.DisplayType.IsLookup(a.getDisplayType())&&a.getLookup()){var s=a.getLookup();s.fillCombobox(!0,!0,!0,!1);for(var n=s.data,o=0;o<n.length;o++)this.cGroupInfo[n[o].Key]={name:n[o].Name,records:[],key:n[o].Key},this.grpCount+=1}this.setHeader(a.getHeader())}else this.setHeader(" ")}else this.setHeader(" ");(this.grpCount<1||t.isEmptyObject(this.cGroupInfo))&&(this.cGroupInfo.All={name:e.Msg.getMsg("All"),records:[],key:null},this.grpCount=1),this.isProcessed=!0}},a.prototype.refreshUI=function(e){var t=this.mTab.getTableModel().getCardTemplate();this.setCardViewData(t),this.refresh(e)},a.prototype.refresh=function(i){var a=this;window.setTimeout((function(){0==i&&(i=a.getBody().width()),a.isProcessed=!1,a.createGroups(),records=a.mTab.getTableModel().mSortList;var n=a.getBody();a.resetCard();var o=null;if(1==a.grpCount){var r="",l=null;for(var d in a.cGroupInfo){r=e.Utility.Util.getIdentifierDisplayVal(a.cGroupInfo[d].name),l=a.cGroupInfo[d].key,a.getGroupHeader().append("<div class='vis-cv-head' >"+r+"</div>");break}o=new s(!0,records,r,a.fields,a.cConditions,a.headerItems,a.headerStyle,a.headerPadding,l,a.aPanel),a.groupCtrls.push(o),n.append(o.getRoot()),a.getGroupHeader().find(".vis-cv-head").width(n.find(".vis-cv-grpbody").width()-10),a.getRightDiv().css("display","none")}else{for(var d in a.filterRecord(records),a.cGroupInfo){m(d);var c=a.cGroupInfo[d].key;c=a.GroupCount[c]?a.GroupCount[c]:0;var h=t("<div data-key='"+a.cGroupInfo[d].key+"' class='vis-cv-cg-grp'></div>");h.append("<div class='vis-cv-head' title='"+e.Utility.Util.getIdentifierDisplayVal(a.cGroupInfo[d].name)+" ("+c+")' >"+e.Utility.Util.getIdentifierDisplayVal(a.cGroupInfo[d].name)+"<span> ("+c+")</span></div>"),a.getGroupHeader().append(h)}if(a.cGroup.lookup&&(a.cGroup.lookup.displayType==e.DisplayType.List||a.cGroup.lookup.displayType==e.DisplayType.TableDir||a.cGroup.lookup.displayType==e.DisplayType.Table||a.cGroup.lookup.displayType==e.DisplayType.Search)&&null!=a.GroupSequence&&""!=a.GroupSequence)for(var u=a.GroupSequence.split(","),p=0;p<u.length;p++){var g=n.find(".vis-cv-grpbody[data-key='"+u[p]+"']").parent(),f=a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+u[p]+"']"),v=n.find(".vis-cv-cg").eq(p);g.insertBefore(v),f.insertBefore(a.getGroupHeader().find(".vis-cv-cg-grp").eq(p))}0==a.editID&&a.onCardEdit({recid:n.find(".vis-cv-card:first").attr("data-recid")},!0),a.editID=0,b()}function m(i){o=new s(1===a.grpCount,a.cGroupInfo[i].records,e.Utility.Util.getIdentifierDisplayVal(a.cGroupInfo[i].name),a.fields,a.cConditions,a.headerItems,a.headerStyle,a.headerPaddings,a.cGroupInfo[i].key,a.aPanel),a.groupCtrls.push(o),n.append(o.getRoot());new vaSortable(o.getBody()[0],{attr:"data-recid",selfSort:!0,force:!1,mainNode:".vis-cv-main",ignore:[".vis-cv-card-edit",".vis-ev-col-wrap-button",".cardEmpty"],onclick:function(e,i){var s=t(i).attr("data-recid");a.onCardEdit({recid:s},!0);var n=a.mTab.getFieldById(a.getField_Group_ID());n.getIsReadOnly()||""!=n.getCallout()||!n.getIsEditable(!0,!0)?(vaSortable.prototype.setStopDrag(!0),t(i).css("cursor","not-allowed")):(t(i).css("cursor","default"),vaSortable.prototype.setStopDrag(!1))},onSelect:function(i,s,n){var o=t(i).parent().attr("data-key");if(o!=t(n).attr("data-key")){var r={grpValue:"null"==o?null:o,recordID:a.mTab.getRecord_ID(),columnName:a.cGroup.getColumnName(),tableName:a.mTab.getTableName(),dataType:a.cGroup.getDisplayType()};t.ajax({type:"POST",url:e.Application.contextUrl+"CardView/UpdateCardByDragDrop",dataType:"json",data:r,beforeSend:function(){a.setBusy(!0)},success:function(i){if("1"!=i)e.ADialog.error(i,!0,""),vaSortable.prototype.revertItem();else{var s=t(n).attr("data-key");a.GroupCount[o]||(a.GroupCount[o]=0),a.GroupCount[o]=a.GroupCount[o]+1,a.GroupCount[s]=a.GroupCount[s]-1,a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+s+"']").find("span").text(" ("+a.GroupCount[s]+")"),a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+o+"']").removeClass("emptyGroup").find("span").text(" ("+a.GroupCount[o]+")"),a.getBody().find(".cardEmpty").closest(".emptyGroup").removeClass("emptyGroup"),a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+s+"'] .vis-cv-head").attr("title",a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+s+"']").text()),a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+o+"'] .vis-cv-head").attr("title",a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+o+"']").text()),b(),a.mTab.dataRefresh()}},error:function(t){e.ADialog.error(t.responseText,!0,""),vaSortable.prototype.revertItem(),a.setBusy(!1)},complete:function(){a.setBusy(!1)}})}}})}function b(){a.VCardRightPanel.reset(),a.getRoot().removeClass("emptyGroup").removeAttr("style"),n.find(".cardEmpty").remove();var e=a.ExcludedGroup;e=e.split(",");var i,s=!1;n.find(".vis-cv-grpbody").each((function(i,o){var r=t(o);if(r.parent().removeAttr("style"),r.is(":empty")?(r.append("<div class='va-dragdrop cardEmpty' style='height:"+n.height()+"px'>").parent().addClass("emptyGroup"),a.getGroupHeader().find(".vis-cv-cg-grp").eq(i).addClass("emptyGroup").removeAttr("style")):(a.getGroupHeader().find(".vis-cv-cg-grp").eq(i).css("min-width",r.parent().width()),r.parent().css("min-width",r.parent().width())),-1!=e.indexOf(r.attr("data-key"))){r.parent().hide();var l=a.getGroupHeader().find(".vis-cv-cg-grp[data-key='"+r.attr("data-key")+"']");a.VCardRightPanel.addItem(l.find(".vis-cv-head").text()),s=!0,l.hide()}})),a.getRightDiv().height(a.getRoot().height()),n.find(".vis-cv-grpbody").height((i=n.find(".vis-cv-grpbody"),Math.max.apply(null,i.map((function(){return t(this)[0].scrollHeight})).get()))),s?a.getRightDiv().css("display","flex"):a.getRightDiv().css("display","none")}a.calculateWidth(i),a.SyncScroll(),a.aPanel.setBusy(!1)}),10)},a.prototype.filterRecord=function(t){if(t){for(var i=t.length,a=this.cGroup.getColumnName().toLowerCase(),s=null,n=null,o=!1,r=0;r<i;r++)n=(s=t[r])[a],this.cGroupInfo[n]?(this.cGroupInfo[n].records.push(s),o=!0):(this.cGroupInfo.Other__1||(this.cGroupInfo.Other__1={name:e.Msg.getMsg("No")+" "+this.cGroup.getHeader(),records:[],key:null},this.grpCount+=1,o=!0,o=!0),this.cGroupInfo.Other__1.records.push(s));(this.oldGrpCount!=this.grpCount||o)&&(this.isProcessed=!1),this.oldGrpCount=this.grpCount}},a.prototype.dispose=function(){this.dC()},s.prototype.dispose=function(){this.dC(),vaSortable.prototype.dispose()},n.prototype.addStyleToDom=function(){this.styleTag.type="text/css",this.styleTag.innerHTML=this.dynamicStyle.join(" "),t(t("head")[0]).append(this.styleTag)},n.prototype.applyCustomUIForFieldValue=function(e,t,i,a,s){var n=s,r="vis-hp-card-FieldValue_"+i+"_"+t+"_"+this.windowNo+"_"+e+"_"+a.getAD_Column_ID();return n&&n.toLower().indexOf("@value::")>-1&&(n=o(n,"@value::")),this.dynamicStyle.push("."+r+"  {"+n+"} "),r},n.prototype.applyCustomUIForLabelValue=function(e,t,i,a,s){var n=s,r="vis-hp-card-LabelValue_"+i+"_"+t+"_"+this.windowNo+"_"+e+"_"+a.getAD_Column_ID();return n&&n.toLower().indexOf("@value::")>-1&&(n=o(n,"@value::")),this.dynamicStyle.push("."+r+"  {"+n+"} "),r},n.prototype.justifyAlignImageItems=function(e,t,i){var a="vis-w-p-header-label-center-justify_"+e+"_"+this.windowNo;return this.dynamicStyle.push(" ."+a+" {justify-content:"+this.textAlignEnum[t]+";align-items:"+this.alignItemEnum[i]+"}"),a};var o=function(e,t){if(e&&e.toLower().indexOf(t)>-1)for(var i=e.split("|"),a=0;a<i.length;a++)if(i[a].toLower().indexOf(t)>-1)return i[a].toLower().replace(t,"").trim()};n.prototype.headerParentCustomUISettings=function(e){var t="vis-ad-w-p-card-Custom_"+this.windowNo;return this.dynamicStyle.push(" ."+t+" {flex:1;"),this.dynamicStyle.push(e),this.dynamicStyle.push("} "),t},n.prototype.headerUISettings=function(e,t){var i="vis-ad-w-p-card_root_"+this.windowNo;return this.dynamicStyle.push(" ."+i+" {display:flex;overflow:auto;"),this.dynamicStyle.push("padding:"+t+";"+e),this.dynamicStyle.push("} "),i},n.prototype.fieldGroupContainerUISettings=function(e,t,i,a,s){var n="vis-ad-w-p-fg_card-container_"+t+"_"+e+"_"+this.windowNo+"_"+s;return this.dynamicStyle.push(" ."+n+" {display:grid;"),this.dynamicStyle.push("grid-template-columns:repeat("+e+", 1fr);grid-template-rows:repeat("+t+", auto);padding:"+a+";"+i),this.dynamicStyle.push("} "),n},n.prototype.applyCustomUISettings=function(e,t,i,a,s,n,o,r,l,d,c){var h="vis-hp-card-FieldGroup_"+a+"_"+t+"_"+this.windowNo+"_"+e;return this.dynamicStyle.push("."+h+"  {grid-column:"+t+" / span "+i+"; grid-row: "+a+" / span "+s+";"),this.dynamicStyle.push("justify-content:"+this.textAlignEnum[n]+";align-items:"+this.alignItemEnum[o]),this.dynamicStyle.push(";font-size:"+d+";color:"+l+";padding:"+c+";"),this.dynamicStyle.push(r),this.dynamicStyle.push("} "),h},n.prototype.evaluate=function(t){for(var i=null,a=0;a<t.length;a++)(i=t[a]).ConditionValue&&e.Evaluator.evaluateLogic(this,i.ConditionValue)&&this.setColor(i.Color,i.FColor)},n.prototype.getValueAsString=function(e){var t=this.record[e.toLowerCase()];return t?(!0===t?t="Y":t&&t.toString().endsWith(".000Z")&&(t=t.replace(".000Z","Z")),t=t.toString()):!1===t?t="N":0===t&&(t="0"),t},n.prototype.actionPerformed=function(e){this.aPanel.curTab.needSave(!0,!1)?this.aPanel.cmd_save(!0):(this.curTab=this.aPanel.curTab,this.curGC=this.aPanel.curGC,this.aPanel.actionPerformed(e,this))},n.prototype.cmd_save=function(e,t){return this.aPanel.cmd_save2(e,this.curTab,this.curGC,this.aPanel,t)},n.prototype.dispose=function(){this.dC()},e.VCardView=a}(VIS,jQuery)},6251:()=>{!function(e,t){e.VGridPanel=function(){var i,a,s,n,o,r=null,l=-2,d=-1,c=[],h=[],u={},p=t('<span class="vis-ev-fgbtn" data-state="N">'+e.Msg.getMsg("More")+"...</span>"),g=null,f={rSpan:1,cSpan:0,cSpace:0,orgRSpan:1},v={rSpan:1,cSpan:0,cSpace:0,orgRSpan:1},m={rSpan:1,cSpan:0,cSpace:0,orgRSpan:1},b={rSpan:1,cSpan:0,cSpace:0,orgRSpan:1},y={},T={},C={},D={},I=null;function w(e){var i=t(e.currentTarget),a=i.data("colname");""!=a&&(I&&(I.popover("dispose"),I=null),i.attr("data-content",D[a].help),I=i.popover("show"))}function S(e,i,r,l){e&&(g=a=t("<div class='vis-ev-col'></div>")),i&&(g=s=t("<div class='vis-ev-col vis-ev-col-start2'></div>")),r&&(g=n=t("<div class='vis-ev-col vis-ev-col-start3'></div>")),l&&(g=o=t("<div class='vis-ev-col vis-ev-col-start4'></div>"))}function A(e){e?e.rSpan<=1&&(e={rSpan:1,cSpan:0,cSpace:0,set:!1}):(f={rSpan:1,cSpan:0,cSpace:0,set:!1},v={rSpan:1,cSpan:0,cSpace:0,set:!1},m={rSpan:1,cSpan:0,cSpace:0,set:!1},b={rSpan:1,cSpan:0,cSpace:0,set:!1})}function _(e,t){var i=e.getFieldBreadth(),r=e.getFieldColSpan(),d=e.getCellSpace(),c=e.getIsLongField();if(e.getIsLineBreak()&&(A(),t=!0),t&&(f.rSpan>1&&(--f.rSpan,A(f)),v.rSpan>1&&(--v.rSpan,A(v)),m.rSpan>1&&(--m.rSpan,A(m)),b.rSpan>1&&(--b.rSpan,A(b)),P(),l=0),0==l)if(c)P(),A(),S(!0),a.addClass("vis-ev-col-end4"),l=4;else if(f.rSpan>1)l+=f.cSpan;else if(d>0)d>3&&(d=3),l+=d,d=0;else{if(!a)return S(!0),2==r?v.rSpan<=1&&a.addClass("vis-ev-col-end2"):3==r?v.rSpan<=1&&m.rSpan<=1?a.addClass("vis-ev-col-end3"):v.cSpan<1&&a.addClass("vis-ev-col-end2"):r>3&&(v.rSpan<=1&&m.rSpan<=1&&b.rSpan<=1?a.addClass("vis-ev-col-end4"):v.rSpan<=1&&m.rSpan<=1?a.addClass("vis-ev-col-end3"):v.rSpan<=1&&a.addClass("vis-ev-col-end2")),l+=r-1,void(i>1&&(f.rSpan=i+1,f.set=!0,f.cSpan=r,f.cSpace=d,a.css("grid-row","span "+i)));l+=1}if(1==l)if(v.rSpan>1)l+=v.cSpan;else if(d>0)d>2&&(d=2),l+=d,d=0;else{if(!s)return S(!1,!0),2==r?m.rSpan<=1&&s.addClass("vis-ev-col-end3"):r>=3&&(m.rSpan<=1&&b.rSpan<=1?s.addClass("vis-ev-col-end4"):m.cSpan<1&&s.addClass("vis-ev-col-end3")),l+=r-1,void(i>1&&(v.rSpan=i+1,v.set=!0,v.cSpan=r,v.cSpace=d,s.css("grid-row","span "+i)));l+=1}if(2==l)if(m.rSpan>1)l+=m.cSpan;else if(d>0)d>1&&(d=1),l+=d,d=0;else{if(!n)return S(!1,!1,!0),r>=2&&b.rSpan<=1&&n.addClass("vis-ev-col-end4"),l+=r-1,void(i>1&&(m.rSpan=i+1,m.set=!0,m.cSpan=r,m.cSpace=d,n.css("grid-row","span "+i)));l+=1}3!=l?a||s||n||o?!c&&l>3&&_(e,!0):_(e,t):b.rSpan>1||(o?t=!0:(S(!1,!1,!1,!0),r>=2&&o.addClass("vis-ev-col-end4"),i>1&&(b.rSpan=i+1,b.set=!0,b.cSpan=r,b.cSpace=d,o.css("grid-row","span "+i))))}function P(){a&&i.append(a),s&&i.append(s),n&&i.append(n),o&&i.append(o),a=s=n=o=$td4=null}function N(i){i.stopPropagation();var a=t(this),s=t(i.target),n=a.data("name")+"_"+a.data("seqno"),o=a.data("display"),r=t(a.find(".vis-ev-col-fg-more")[0]),l=!1,d=!1;if(s.is("span")||s.hasClass("vis-ev-col-fg-more")){if("show"!==o)return;l=!0,"Y"==a.data("showmore")?(d=!0,a.data("showmore","N"),r.text(e.Msg.getMsg("ShowLess"))):(a.data("showmore","Y"),r.text(e.Msg.getMsg("ShowMore")))}else"N"==a.data("showmore")&&(d=!0),"show"===o?(a.data("display","hide"),r.hide(),t(a.children()[2]).addClass("vis-ev-col-fg-rotate")):(a.data("display","show"),r.show(),l=!0,t(a.children()[2]).removeClass("vis-ev-col-fg-rotate"));x(n,l,d)}function x(e,t,i){for(var a=T[e],s=0;s<a.length;s++){for(var n=a[s],o=y[n.getColumnName()],r=0;r<o.length;r++)o[r].tag=t,o[r].setVisible(t&&n.getIsDisplayed(!0));t&&n.getIsDisplayed(!0)&&(n.getIsFieldgroupDefault()||i)?C[n.getColumnName()].show():C[n.getColumnName()].hide()}}function R(e,t){y[e]||(y[e]=[]),y[e].push(t)}function L(e,t){var a=1;for(var s in T){if(a>=e){var n=i.find("[data-name='"+s+"'],[data-seqno="+a+"]");n&&n.length>0&&(t?(n.hide(),x(s,!1,!1)):(n.show(),x(s,!0,"N"==n.data("showmore"))))}a++}}function E(){var t=p.data("state"),i=p.data("position");"Y"==t?(L(i,!0),t="N",p.text(e.Msg.getMsg("More")+"...")):(L(i,!1),t="Y",p.text("..."+e.Msg.getMsg("Less"))),p.data("state",t)}(i=t("<div class='vis-ad-w-p-vc-ev-grid'>")).on("click","span.vis-ev-ctrlinfowrap",w),i.on("click","span.vis-ev-fgbtn",E),this.addField=function(i,s){var n=!1;if(s.getIsLink()&&s.getIsRightPaneLink())return c[++d]=i,void h.push(i);if(s.getDisplayType()==e.DisplayType.Button&&435==s.getAD_Reference_Value_ID()){var o=s.getDefault(e.context,this.windowNo);u[o]=i}var p=e.VControlFactory.getLabel(s);if(null!=p||null!=i){var f=s.getIsSameLine();if(function(i){if(null==r&&(r=""),null==i||0==i.length||i.equals(r))return!1;var s=Object.keys(T).length+1;r=i,P(),A(),S(!0);var n=t('<div class="vis-ev-col-fieldgroup" data-showmore="Y" data-name="'+i+'" data-display="show" data-seqno="'+s+'"><span class="vis-ev-col-fg-hdr"  >'+i+' </span> <button class="vis-ev-col-fg-more">'+e.Msg.getMsg("ShowMore")+'</button><button class="vis-ev-fg-arrowBtn"><i class= "fa fa-angle-up"></button></span></div>');return a.append(n),a.addClass("vis-ev-col-end4"),l=0,n.on("click",N),!0}(s.getFieldGroup())&&(f=!1),f?++l>3?(f=!1,n=!0):l<0&&(n=!0):n=!0,_(s,n),null!=p&&(s.getDescription().length,R(s.getColumnName(),p),c[++d]=p),null!=i){var v=s.getVFormat(),m=s.getVFormatError();if(""===v);else i.getControl().on("focusout",(function(i){var a=new RegExp(v);e.DisplayType.IsString(s.getDisplayType())&&null!=t(i.target).val()&&t(i.target).val().toString().trim().length>0&&(a.test(t(i.target).val())||(!m&&m.length>0&&(m=e.Msg.getMsg("RegexFailed")+":"+s.getHeader()),e.ADialogUI.warn(m,"",(function(){t(i.target).focus()}))))}));i.getBtnCount();R(s.getColumnName(),i),c[++d]=i}if(null!=p||null!=i){var b=g;!function(i,a,s,n){var o=n.getHtmlStyle(),r='<div class="input-group vis-input-wrap">';a&&("TEXTAREA"==a.getControl()[0].tagName||a.getControl().hasClass("vis-ev-col-img-ctrl"))&&(r='<div class="input-group vis-input-wrap vis-ev-full-h">');var l=t(r);if(!n.getIsLink()&&n.getDisplayType()!=e.DisplayType.Button&&n.getShowIcon()&&(""!=n.getFontClass()||""!=n.getImageName())){var d=['<div class="input-group-prepend"><span class="input-group-text vis-color-primary">'];""!=n.getFontClass()?d.push('<i class="'+n.getFontClass()+'"></i>'):d.push('<img src="'+e.Application.contextUrl+"Images/Thumb16x16/"+n.getImageName()+'"></img>'),d.push("</span></div>"),l.append(d.join(" "))}null!=a&&""!=o&&(n.getDisplayType()==e.DisplayType.ProgressBar?a.setHtmlStyle(o):a.getControl().attr("style",o));var c=t("<div class='vis-control-wrap'>");!a||"INPUT"!=a.getControl()[0].tagName&&"SELECT"!=a.getControl()[0].tagName&&"TEXTAREA"!=a.getControl()[0].tagName&&"vis-progressCtrlWrap"!=a.getControl()[0].className||"checkbox"==a.getControl()[0].type?(null!=i&&c.append(i.getControl()),a&&c.append(a.getControl())):(c.append(a.getControl().attr("placeholder"," ").attr("data-placeholder","")),null!=i&&c.append(i.getControl()));n.getDisplayType()==e.DisplayType.Label||n.getIsLink()||n.getDisplayType()==e.DisplayType.TelePhone||c.append("<span class='vis-ev-ctrlinfowrap' data-colname='"+n.getColumnName()+"' title='"+n.getDescription()+"'  tabindex='-1' data-toggle='popover' data-trigger='focus'><i class='vis vis-info' aria-hidden='true'></i></span'>");if(c.append("<span class='vis-ev-col-msign'><i class='fa fa-exclamation' aria-hidden='true'></span'>"),l.append(c),a){var h=a.getBtnCount();if(h>0){a.getControl().attr("data-hasBtn"," ");for(var u=0;u<h;){var p=a.getBtn(u);null!=p&&l.append(t('<div class="input-group-append">').append(p)),++u}h=-1,u=0}}s.append(l),n.getDisplayType()==e.DisplayType.TelePhone&&(a.init(),c.css("z-index","auto"))}(p,i,b,s),C[s.getColumnName()]=b,function(e){if(null!=r&&!r.equals("")){var t=null,i=Object.keys(T).length,a=r+"_"+i;T[a]&&(t=T[a]),null==t&&(t=[],T[r+"_"+(i+1)]=t),t.push(e),e.getIsFieldgroupDefault()||C[e.getColumnName()].hide()}}(s),D[s.getColumnName()]={help:s.getHelp()}}}},this.flushLayout=function(e){P(),e>0&&Object.keys(T).length>=e&&function(e){A(),S(!1,!1,!1,!0),p.data("position",e),g.append(p),P(),L(e,!0)}(e)},this.getRoot=function(){return i},this.getComponents=function(){return c},this.getLinkComponents=function(){return h},this.setEnabled=function(e,t){Object.keys(u).length>0&&u[e]&&u[e].setReadOnly(!t)},this.setVisible=function(e,t){C[e]&&(t?C[e].show():C[e].hide())},this.dispose=function(){for(i.off("click","span.vis-ev-ctrlinfowrap",w),i.off(),D={},I&&I.popover("dispose"),I=null,h.length=0,h=null;c.length>0;)c.pop().dispose();for(var e in y)y[e]=null,delete y[e];for(var t in y=null,C={},C=null,T)T[t].length=0,T[t]=null,delete T[e];T=null,d=null,c=null,i.remove(),i=null,this.addField=null,p=null}}}(VIS,jQuery)},7043:()=>{!function(e,t){function i(){this.grid=null,this.id=null,this.$container=null,this.aPanel=null,this.gc=null,this.rendered=!1,this.onSelect=null,this.onCellEditing=null,this.onCellValueChanged=null,this.onSort=null,this.onEdit=null,this.onAdd=null,this.hyperLinkCell=null,this.editColumnIndex=-1;var t=0,i=this,a={caption:"",sortable:!1,render:function(t){return'<img src="'+e.Application.contextUrl+'Areas/VIS/Images/base/pencil.png"  />'},size:"25px"};function s(e){if(i.readOnly)return!1;var t=i.grid.columns[e];return!(!i.mTab.getTableModel().getIsInserting()&&t.readOnly)&&!!t.gridField.getIsEditable(!0,!0)}this.getEditColumn=function(){return a},this.onClick=function(e){t++,this.readOnly||(i.skipEditing=!1,this.records.length>0&&this.records[i.mTab.getCurrentRow()].recid!=e.recid&&(i.skipEditing=!0))},this.onSingleClick=function(a){t++,singleClickTimer=setTimeout((function(){1===t?(t=0,function(t){try{if(i.grid.columns[t.column].columnName==i.hyperLinkCell){i.grid.select(Number(t.recid));var a=i.aPanel.getRoot().find("[name="+t.target+"]").closest(".vis-ad-w-p-center-inctab");a.length>0?a.find(".vis-multi").length>0?a.find(".vis-multi").click():a.find(".vis-edit").click():i.aPanel.actionPerformedCallback(i.aPanel,"Single")}else if(i.grid.columns[t.column].gridField.getDisplayType()==e.DisplayType.TelePhone)if(i.grid.select(Number(t.recid)),window.VA048){var s=i.grid.get(t.recid)[i.grid.columns[t.column].columnName.toLowerCase()];if(!s||""===s)return;var n={};n.tonumbers=s,n.username="",n.userimg="",n.isconference=!1,n.reftableid=-1,n.refrecordid=-1,n.windowno=0,n.windowid=0,n.tableid=0,n.recordid=0,n.withrecording=!1,n.withcall=!0,VA048.Apps.GetCallingInstance(!0,n,!1)}else e.ADialog.info("ComModuleNotInstalled");else i.grid.columns[t.column].gridField.getDisplayType()==e.DisplayType.Button&&(i.grid.select(Number(t.recid)),i.grid.columns[t.column].editable.ctrl.getControl().click())}catch(e){console.log(e)}}(a)):2===t&&(clearTimeout(singleClickTimer),t=0)}),400)},this.onSelectLocal=function(e){i.blockSelect?i.blockSelect=!1:i.onSelect&&i.onSelect(e)},this.checkCellEditable=!0,this.onEditField=function(e){if(i.skipEditing)return i.skipEditing=!1,e.isCancelled=!0,void this.select({recid:e.recid});e.isCancelled=!s(e.column)||e.originalEvent&&e.originalEvent.altKey,i.blockSelect=!e.isCancelled},this.onChange=function(e){if("checkbox"==i.grid.columns[e.column].editable.type){if(this.records.length>0&&this.records[i.mTab.getCurrentRow()].recid!=e.recid)return void(e.isCancelled=!0);e.isCancelled=!s(e.column)}e.onComplete=function(e){var t={newValue:e.value_new,propertyName:i.grid.columns[e.column].field};i.onCellValueChanged&&i.onCellValueChanged(t,"checkbox"==i.grid.columns[e.column].editable.type)}},this.onUnSelect=function(e){},this.onRowAdd=function(e){i.paintRow(e.index)},this.cellStyleRender=function(e,t){var a=i.grid.columns[t];return!a.selfCellStyleRender&&a.gridField&&""!=a.gridField.getStyleLogic()?i.evaluateStyleLogic(e,a.gridField.getStyleLogic()):null},this.paintRow=function(t){var a=this.grid.records[t];!function(t,a){return!i.readOnly&&(a==i.indexActiveColumn&&-1==i.indexProcessedColumn||!!function(t){if(i.readOnly||t<0)return!1;if(i.indexActiveColumn&&i.indexActiveColumn>0){var a=i.grid.getCellValue(t,i.indexActiveColumn);if("boolean"==typeof a){if(!a)return a}else{if(!"True".equals(a))return!1;if("N".equals(a))return!1}}if(i.indexProcessedColumn&&i.indexProcessedColumn>0){var s=i.grid.getCellValue(t,i.indexProcessedColumn);if("boolean"==typeof s){if(s)return!1}else{if("True".equals(s))return!1;if("Y".equals(s))return!1}}var n=function(t){var a=-1;if(void 0!==i.indexClientColumn&&-1!=i.indexClientColumn){null!=(o=i.grid.getCellValue(t,i.indexClientColumn))&&""!==o&&(a=e.Utility.Util.getValueOfInt(o))}var s=0;if(void 0!==i.indexOrgColumn&&-1!=i.indexOrgColumn){null!=(o=i.grid.getCellValue(t,i.indexOrgColumn))&&""!==o&&(s=e.Utility.Util.getValueOfInt(o))}var n=0;if(void 0!==i.indexKeyColumn&&-1!=i.indexKeyColumn){var o;null!=(o=i.grid.getCellValue(t,i.indexKeyColumn))&&""!==o&&(n=e.Utility.Util.getValueOfInt(o))}return[a,s,n]}(t),o=n[0],r=n[1],l=n[2];return e.MRole.canUpdate(o,r,i.AD_Table_ID,l,!1)}(t))}(t,0)?a.style="background-color:rgba(var(--v-c-secondary), .7)":a&&a.style&&delete a.style},this.disposeComponenet=function(){i=null,a=null,this.getEditColumn=null,this.onClick=null}}i.prototype.ROW_ADD="A",i.prototype.ROW_DELETE="D",i.prototype.ROW_REFRESH="F",i.prototype.ROW_UNDO="U",i.prototype.evaluateStyleLogic=function(t,i){this.cellRowIndex=t;for(var a=i.split(","),s=null,n=0;n<a.length;n++){var o=a[n].split("?");if(2==o.length&&e.Evaluator.evaluateLogic(this,o[0])){s=o[1];break}}return s},i.prototype.setupGridTable=function(i,a,s,n,o,r){if(!o.getIsDisplayed(!0))return 0;this.id=n,this.aPanel=i,this.gc=r,this.$container=s,this.mTab=o,this.AD_Table_ID=this.mTab.getAD_Table_ID();var l=[],d=null,c=a.length,h=0,u=a.slice(0);u.sort((function(e,t){return e.getMRSeqNo()-t.getMRSeqNo()}));for(var p=-1,g=0;g<u.length;g++)if(null!=(d=u[g])){var f=d.getColumnName(),v=d.getDisplayType();++p,d.getIsKey()?this.indexKeyColumn=p:f.equals("IsActive")?this.indexActiveColumn=p:f.equals("Processed")?this.indexProcessedColumn=p:f.equals("AD_Client_ID")?this.indexClientColumn=p:f.equals("AD_Org_ID")&&(this.indexOrgColumn=p);var m=d.getIsDisplayedMR?d.getIsDisplayedMR():d.getIsDisplayed(),b=d.getIsMandatory(!1),y=d.getIsReadOnly(),T=d.getIsEditable(!1);if(!d.getIsHeading()){var C={resizable:!0,selfCellStyleRender:!1};C.gridField=d,!y&&T||(C.readOnly=!0),C.caption=d.getHeader(),b&&(C.caption+='<sup style="color:red;font-size: 11px;top: 0;">*</sup>'),C.field=f.toLowerCase(),C.hidden=!m;var D=C.gridField.getColumnWidth();if(C.size=D?D+"px":"100px",d.getIsIdentifier()&&d.getDisplayType()!=e.DisplayType.Image&&null==this.hyperLinkCell?0==C.hidden&&(this.hyperLinkCell=f,C.style="text-decoration:underline; color:rgba(var(--v-c-primary), 1) !important; cursor:pointer"):d.getDisplayType()==e.DisplayType.TelePhone&&0==C.hidden&&(C.style="text-decoration:underline; color:rgba(var(--v-c-primary), 1) !important; "),v==e.DisplayType.Amount)C.sortable=!0,C.customFormat=e.DisplayType.GetNumberFormat(v),C.render=function(e,t,i){var a=e[l[i].field];return a||(a=0),'<div data-type="int">'+(a=parseFloat(a).toLocaleString(void 0,{minimumFractionDigits:l[i].customFormat.getMinFractionDigit(),maximumFractionDigits:l[i].customFormat.getMaxFractionDigit()}))+"</div>"};else if(v==e.DisplayType.Integer)C.sortable=!0,C.customFormat=e.DisplayType.GetNumberFormat(v),C.render=function(e,t,i){var a=e[l[i].field];if(a)return'<div data-type="int">'+a+"</div>"};else if(v==e.DisplayType.ProgressBar)C.sortable=!0,C.selfCellStyleRender=!0,C.render=function(e,t,i){var a=l[i].field,s=l[i].gridField,n="";""!=s.getStyleLogic()&&(n=A.evaluateStyleLogic(t,s.getStyleLogic())),n||(n="");var o=e[a];return e.changes&&void 0!==e.changes[a]&&(o=e.changes[a]),'<div class="vis-progress-gridbar" style="'+n+'"><div class="vis-progress-percent-bar" style = "width:'+(o||0)+"%;"+n+'" ></div><div class="vis-progress-gridoutput" > '+(o||"")+"</div></div >"};else if(e.DisplayType.IsNumeric(v))C.sortable=!0,C.customFormat=e.DisplayType.GetNumberFormat(v),C.render=function(e,t,i){var a=e[l[i].field];if(a)return'<div data-type="int">'+(a=parseFloat(a).toLocaleString(void 0,{minimumFractionDigits:l[i].customFormat.getMinFractionDigit(),maximumFractionDigits:l[i].customFormat.getMaxFractionDigit()}))+"</div>"};else if(v==e.DisplayType.YesNo){C.sortable=!0;f.toLowerCase();C.gridField.getIsSwitch()&&(C.render="switch"),C.editable={type:"checkbox"}}else v==e.DisplayType.String||v==e.DisplayType.Text||v==e.DisplayType.TextLong||v==e.DisplayType.Memo?(C.sortable=!0,d.getIsEncryptedField()?C.render=function(e,t,i){var a=l[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),(s=e[l[i].field])||0===s?s.replace(/\w|\W/g,"*"):""}:d.getObscureType()?C.render=function(t,i,a){var s=t[l[a].field];return s||0===s?e.Env.getObscureValue(l[a].gridField.getObscureType(),s):""}:C.render=function(e,t,i){var a=l[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s||0==s?s=w2utils.encodeTags(s):""}):e.DisplayType.IsLookup(v)||v==e.DisplayType.ID?(C.sortable=!0,C.lookup=d.getLookup(),m&&(C.render=function(i,a,s){var n,o,r=l[s].lookup,d=l[s].field,c=i[d],h=l[s].gridField.getGridImageStyle(),u=l[s].gridField.getWindowNo();if(l[s].customClass="",h&&!(n=l[s].customClass)){l[s].customClass="vis-grd-custom-"+l[s].gridField.getAD_Column_ID()+u,n=".vis-grd-custom-"+l[s].gridField.getAD_Column_ID()+u+"{"+h+"}";var p=document.createElement("style");p.type="text/css",p.innerHTML=n,t(t("head")[0]).append(p)}if(i.changes&&i.changes[d],r)if(r.displayType==e.DisplayType.MultiKey)if(c){for(var g=c.toString().split(","),f="",v=0,m=g.length;v<m;v++){var b=g[v];isNaN(b)||(b=Number(b)),0!=f.length?f+=", "+r.getDisplay(b):f+=r.getDisplay(b)}o=f}else o=r.getDisplay(c,!0,!0);else o=r.getDisplay(c,!0,!0);var y="";if(r&&e.DisplayType.List==r.displayType){var T="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+(Math.floor(16*Math.random())+60)+"%)",C=r.getLovIconType(c,!0),D=r.getLOVIconElement(c,!0),I="";if(!D){if(0==I.length)var w=o.trim().split(" ");I=w[0].substring(0,1).toUpper(),w.length>1?I+=w[w.length-1].substring(0,1).toUpper():I=w[0].substring(0,2).toUpper()}if("B"==C)y="<div class='vis-grid-td-icon-grp'>",y+=D?"<div class='"+l[s].customClass+" vis-grid-row-td-icon'> "+D+"</div> ":"<div style='background-color:"+T+"' class='"+l[s].customClass+" vis-grid-row-td-icon'><span>"+I+"</span></div>",y+="<span> "+o+"</span ><div>";else{if("T"==C)return o;"I"==C&&(y="<div class='vis-grid-td-icon-grp' style='Justify-Content:center'>",y+=D?"<div class='"+l[s].customClass+" vis-grid-row-td-icon'> "+D+"</div> ":"<div style='background-color:"+T+"' class='"+l[s].customClass+" vis-grid-row-td-icon'><span>"+I+"</span></div>",y+="<div>")}}else if(r&&r.gethasImageIdentifier()){var S=o.indexOf("Images/");if(-1==S)return o;var A=o.substring(S+7,o.lastIndexOf("^^"));A=e.Application.contextUrl+"Images/Thumb32x32/"+A,(o=o.replace("^^"+o.substring(S,o.lastIndexOf("^^")+2),"^^^")).indexOf("Images/")>-1&&(o=o.replace(o.substring(S,o.lastIndexOf("^^")+2),"^^^")),o=o.split("^^^"),y="<div class='vis-grid-td-icon-grp'>";I="";for(var _=0;_<o.length;_++){T="hsl("+(Math.floor(360*Math.random())+0)+", 100%,"+(Math.floor(16*Math.random())+60)+"%)";if(o[_].trim().length>0){if(0==I.length)w=o[_].trim().split(" ");I=w[0].substring(0,1).toUpper(),w.length>1?I+=w[w.length-1].substring(0,1).toUpper():I=w[0].substring(0,2).toUpper(),_>0&&A.indexOf("nothing.png")>-1&&I.length>0&&(y+="<div style='background-color:"+T+"' class='"+l[s].customClass+" vis-grid-row-td-icon' ><span>"+I+"</span></div>"),y+="<span>"+o[_]+"</span>"}else A.indexOf("nothing.png")>-1&&I.length>0&&(y+="<div style='background-color:"+T+"' class='"+l[s].customClass+" vis-grid-row-td-icon' ><span>"+I+"</span></div>");(0==_||A.indexOf("nothing.png")>-1)&&-1==A.indexOf("nothing.png")&&(y+="<div style='background-color:"+T+"' class='"+l[s].customClass+" vis-grid-row-td-icon' > <img src='"+A+"'></div > ")}}return""==y?o:y})):e.DisplayType.IsDate(v)?(C.sortable=!0,C.displayType=v,C.render=function(t,i,a){var s=l[a],n=l[a].field,o=t[n];if(t.changes&&void 0!==t.changes[n]&&(o=t.changes[n]),o)if(s.displayType==e.DisplayType.Date){var r=new Date(o);r.setMinutes(r.getTimezoneOffset()+r.getMinutes()),o=r.toLocaleDateString()}else o=s.displayType==e.DisplayType.DateTime?new Date(o).toLocaleString():new Date(o).toTimeString();else o="";return o}):v==e.DisplayType.Location||v==e.DisplayType.Locator?(C.sortable=!0,C.lookup=d.getLookup(),m&&(C.render=function(e,t,i){var a=l[i].lookup,s=l[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):v==e.DisplayType.AmtDimension?(C.sortable=!0,C.lookup=d.getLookup(),m&&(C.render=function(e,t,i){var a=l[i].lookup,s=l[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):v==e.DisplayType.ProductContainer?(C.sortable=!0,C.lookup=d.getLookup(),m&&(C.render=function(e,t,i){var a=l[i].lookup,s=l[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):v==e.DisplayType.Account||v==e.DisplayType.PAttribute?(C.sortable=!0,C.lookup=d.getLookup(),m&&(C.render=function(e,t,i){var a=l[i].lookup,s=l[i].field,n=e[s];return e.changes&&void 0!==e.changes[s]&&(n=e.changes[s]),a&&(n=a.getDisplay(n,!0),n=w2utils.encodeTags(n)),n})):v==e.DisplayType.PAttribute?(C.sortable=!0,C.render="int"):v==e.DisplayType.Button?(C.sortable=!0,C.render=function(e,t,i){e[l[i].field];return'<span style="cursor:pointer" class="vis-ev-col-linkbutton">'+l[i].gridField.getHeader()+"</span>"}):v==e.DisplayType.Image?(C.sortable=!0,C.render=function(i,a,s){var n,o=l[s].field,r=l[s].gridField.getGridImageStyle(),d=l[s].gridField.getWindowNo();if(r&&!(n=l[s].customClass)){l[s].customClass="vis-grd-custom-"+l[s].gridField.getAD_Column_ID()+d,n=".vis-grd-custom-"+l[s].gridField.getAD_Column_ID()+d+"{"+r+"}";var c=document.createElement("style");c.type="text/css",c.innerHTML=n,t(t("head")[0]).append(c)}var h=i["imgurlcolumn"+o];return i.changes&&void 0!==i.changes[o]&&(h=i.changes[o]),h?(h=h.toString().replace("Images/","Images/Thumb32x32/"),n?'<div class="vis-grid-row-td-icon-center"><div class="'+l[s].customClass+' vis-grid-row-td-icon"><img src="'+e.Application.contextUrl+h+'"></div></div>':'<div class="vis-grid-row-td-icon-center"><div class="vis-grid-row-td-icon"><img src="'+e.Application.contextUrl+h+'"></div></div>'):h='<div class="vis-grid-row-td-icon-center"><div class="vis-grid-row-td-icon vis-grid-defualtImage"><i class="fa fa-camera"></div></div>'}):e.DisplayType.IsLOB(v)?(C.sortable=!0,C.render=function(e,t,i){var a=l[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s||(s=""),"#"+s.toString().length}):e.DisplayType.TelePhone==v?(C.sortable=!0,C.render=function(t,i,a){var s=l[a].field,n=t[s];return t.changes&&void 0!==t.changes[s]&&(n=t.changes[s]),n?e.VTelePhoneInstance.getHtml(n,!0):""}):e.DisplayType.Color==v?(C.sortable=!0,C.render=function(e,t,i){var a=l[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s?'<div style="background-color:'+s+';" ></div>':""}):(C.sortable=!0,C.render=function(e,t,i){var a=l[i].field,s=e[a];return e.changes&&void 0!==e.changes[a]&&(s=e.changes[a]),s||0==s?s=w2utils.encodeTags(s):""});""!=d.getHtmlStyle()&&v!=e.DisplayType.Button&&(C.style=d.getHtmlStyle()),C.hidden||h++,l.push(C),C.columnName=f;var I=e.VControlFactory.getControl(o,d,!1,!1,!1);I.setReadOnly(!1),C.editable||(C.editable={type:"custom",ctrl:I}),I.addVetoableChangeListener(r),I instanceof e.Controls.VButton&&I.addActionListner(i)}}if(h>0){var w=Math.floor(100/h);for(var S in l)l[S].hidden||(!l[S].size<0&&(l[S].size=w+"%",l[S].min=100),null==this.hyperLinkCell&&(this.hyperLinkCell=l[S].columnName,l[S].style="text-decoration:underline; color:rgba(var(--v-c-primary), 1) !important; cursor:pointer"))}this.grid=t().w2grid({name:n,autoLoad:!1,columns:l,records:[],show:{toolbar:!1,columnHeaders:!0,lineNumbers:!1,selectColumn:!0,toolbarReload:!1,toolbarColumns:!0,toolbarSearch:!1,toolbarAdd:!1,toolbarDelete:!1,toolbarSave:!1,selectionBorder:!1,recordTitles:!1},recordHeight:41,onSelect:this.onSelectLocal,onUnselect:this.onUnSelect,onSort:this.onSort,onClick:this.onSingleClick,onDblClick:this.onClick,onEditField:this.onEditField,onChange:this.onChange,onRowAdd:this.onRowAdd,onCellStyleRender:this.cellStyleRender});var A=this;return c},i.prototype.getValueAsString=function(t){var i=this.grid.records[this.cellRowIndex],a=this.grid.parseField(i,t.toLowerCase());return this.mTab&&e.DisplayType.YesNo==this.mTab.getField(t).getDisplayType()&&(a=a?"Y":"N"),a?a.toString():""},i.prototype.get=function(e,t){return this.grid.get(e,t)},i.prototype.activate=function(){this.grid&&!this.rendred&&(this.$container.w2render(this.grid.name),this.rendred=!0)},i.prototype.setReadOnly=function(e){this.readOnly=e},i.prototype.getGrid=function(){return this.grid},i.prototype.select=function(e){var t=this.grid.getSelection();if(-1==t.indexOf(e)){if(1==t.length)this.grid.unselect(t[0]);else if(t.length>1)for(;t.length>0;)this.grid.unselect(t.pop());return this.grid.select(e)}},i.prototype.add=function(e){this.grid.add(e)},i.prototype.clear=function(){this.grid.clear(!0),this.grid.reset()},i.prototype.refresh=function(){this.grid.refresh(),console.log("refresh")},i.prototype.resize=function(){this.grid.resize()},i.prototype.setRow=function(e){isNaN(e)?this.grid.set(e.recid,e):this.grid.set(e)},i.prototype.refreshRow=function(e,t){if(!(this.grid.records.length<1)){var i=this.mTab.getCurrentRow();i<0||(void 0!==e&&(i=e),this.paintRow(t?this.grid.get(e,!0):i),this.grid.clearRowChanges(t?e:this.grid.records[i].recid))}},i.prototype.refreshCells=function(){if(!(this.grid.records.length<1)){var e=this.mTab.getCurrentRow();this.paintRow(e),this.grid.refreshRow(this.grid.records[e].recid)}},i.prototype.refreshUndo=function(){if(!(this.grid.records.length<1)){var e=this.mTab.getCurrentRow();this.grid.clearRowChanges(this.grid.records[e].recid),this.paintRow(e),this.grid.refreshRow(this.grid.records[e].recid)}},i.prototype.getSelection=function(e){return this.grid.getSelection(e)},i.prototype.getSelectedRows=function(){for(var e=this.grid.getSelection(!0),t=[],i=0,a=e.length;i<a;i++)t.push(this.grid.records[e[i]]);return t},i.prototype.getColumnNames=function(){for(var e=this.grid.columns,t={},i=0,a=e.length;i<a;i++)t[e[i].columnName]=e[i].caption;return t},i.prototype.scrollInView=function(e){this.grid.scrollIntoView(e)},i.prototype.tableModelChanged=function(t,i,a){if(this.blockSelect=!0,t===e.VTable.prototype.ROW_REFRESH)this.setRow(i),this.refreshRow(i.recid,!0);else{var s=null;if(t===e.VTable.prototype.ROW_UNDO)this.grid.unselect(i),this.grid.remove(i),a>=this.grid.records.length-1&&this.grid.records.length>0?(this.blockSelect=!1,s=this.grid.records[this.grid.records.length-1].recid):a<this.grid.records.length&&(s=this.grid.records[a].recid);else if(t===e.VTable.prototype.ROW_ADD)this.grid.records.splice(a,0,i),s=i.recid,this.grid.refresh(),this.blockSelect=!0;else if(t===e.VTable.prototype.ROW_DELETE){for(var n=i.slice();n.length>0;){var o=n.pop();this.grid.unselect(o),this.grid.remove(o)}isNaN(a)?s=a[0]:this.grid.records.length>0&&(s=this.grid.records[this.grid.records.length-1<a?this.grid.records.length-1:a].recid)}s&&this.select(s),t!==e.VTable.prototype.ROW_ADD||this.gc.getIsCardRow()||this.gc.getIsSingleRow()||this.gc.getIsMapRow()||this.setDefaultFocus()}this.blockSelect=!1},i.prototype.setDefaultFocus=function(e){if(this.mTab.defaultFocusField){e||(e=this.mTab.defaultFocusField.getColumnName());var t=this.grid.getSelection(),i=this.grid.getColumn(e.toLower(),!0);t&&t.length>0&&window.setTimeout(function(){this.grid.editField(t[0],i)}.bind(this),200)}},i.prototype.dispose=function(){this.grid.off("select",this.onSelect),this.grid.off("sort",this.onSort),this.grid.off("click",this.onClick),this.onSelect=null,this.onSort=null;var e=this.grid.columns;for(var t in e)e[t].editable.ctrl&&e[t].editable.ctrl.dispose();this.grid.destroy(),this.grid=null,this.id=null,this.$container=null,this.rendered=null,this.disposeComponenet()},e.VTable=i}(VIS,jQuery)},5155:()=>{!function(e,t){function i(e){var i,a=null,s=t('<div class="vis-mv-main">'),n="",o="",r=[],l=null,d=null,c=null,h=t('<Input id="pac-input" class="controls" type="text" placeholder="Search Box"/>'),u=this;this.locationID="";var p=!(!window.google||!google.maps);new google.maps.Geocoder;function g(e,t,i,s,n){window.setTimeout((function(){!function(e,t,i,s){var n=new google.maps.Marker({position:e,animation:google.maps.Animation.DROP,map:a,title:t,draggable:!0});n.info=new google.maps.InfoWindow({content:t}),n.lid=i,n.ColName=s,n.info.open(a,n),google.maps.event.addListener(n,"click",(function(e){this.info.open(a,this)})),r.push(n)}(e,t,s,n)}),i)}function f(e){for(var t=0;t<r.length;t++)r[t].setMap(e),google.maps.event.clearListeners(r[t],"click"),r[t].info=null}function v(){f(null),r=[]}this.renderMap=function(){a||(this.mapp&&(a=this.mapp),a=new google.maps.Map(n[0],i),function(){var e="",i=u.mapFields;if(i.length>1){e+='<option data-index="-1" value="-1"> </option>';for(var a=0;a<i.length;a++)e+="<option data-index="+a+" value="+i[a].getColumnName()+" >"+i[a].getHeader()+"</option>";d.html(e),d[0].selectedIndex=0,d.on("change",(function(e){u.setBusy(!0),u.curIndex=t(e.target).find("option:selected").data("index"),-1==u.curIndex?u.setMapData(u.mapcols):u.setMapData(u.mapcols[u.curIndex])}))}else c.hide(),n.css("top","0")}())},n=t('<div id="map" class="vis-mv-map">'),o=t('<div class="vis-apanel-busy vis-full-height">').hide(),c=t('<div class="vis-mv-header"> <select class="vis-mv-select vis-pull-right" /> </div>'),d=c.find(".vis-mv-select"),s.append(c).append(h).append(n).append(o),p&&(i={center:new google.maps.LatLng(26,76),zoom:4,mapTypeId:google.maps.MapTypeId.ROADMAP}),this.ResetCombo=function(){d.val(-1),this.curIndex=-1},this.setBusy=function(e){e?o.show():o.hide()},this.getRoot=function(){return s},this.sizeChanged=function(e,t){},this.setMapData=function(e){if(p){if(this.renderMap(),v(),l=null,l=new google.maps.LatLngBounds,google.maps.event.trigger(a,"resize"),-1==u.curIndex)for(var t=Object.keys(e).length,i=Object.keys(e),s=0;s<t;s++){var n=e[i[s]];if(n&&0!=n.length)for(var o=0;o<n.length;o++)try{(u.locationID&&u.locationID==n[o].lid||!u.locationID)&&u.setLatLong(n[o].Latitude,n[o].Longitude,n[o].msg,n[o].lid,n[o].ColName)}catch(e){console.log(e)}}else if(e.length>0)for(s=0;s<e.length;s++)u.setLatLong(e[s].Latitude,e[s].Longitude,e[s].msg,e[s].lid,e[s].ColName);a.fitBounds(l),u.setBusy(!1)}},this.setLatLong=function(e,t,i,s,n){if(e&&t){var o;g(o=new google.maps.LatLng(Number(e),Number(t)),i,100,s,n),l.extend(o),a.fitBounds(l)}},this.dc=function(){v(),a=null,s.remove(),this.cols=this.gc=this.aPanel=this.mapcols=null,this.mapFields=null,this.curIndex=-1,this.getRoot=null,this.dc=null}}i.prototype.setupMapView=function(e,t,i,a,s){this.mapFields=[];for(var n=i.getMapColumns(),o=0;o<n.length;o++){var r=i.getField(n[o]);r&&this.mapFields.push(r)}this.cols=n,this.gc=t,this.aPanel=e,this.mapcols={},this.curIndex=-1,a.append(this.getRoot())},i.prototype.refreshUI=function(e,t){this.locationID=t;var i=this.gc.getSelectedRows(),a=i.length;if(!(i.length<1||this.cols.length<1)){for(var s=0;s<this.cols.length;s++){var n=this.cols[s],o=this.mapFields[s].getLookup();if(!this.locationID||this.locationID==this.mapFields[s].getValue()){for(var r=[],l=0;l<a;l++){var d=i[l][n.toLowerCase()];if(d){var c=o.getLatLng(d);c&&(c.msg=o.getDisplay(d),c.lid=d,c.ColName=n,r.push(c))}}this.mapcols[s]=r}}this.ResetCombo(),-1==this.curIndex?this.setMapData(this.mapcols):this.setMapData(this.mapcols[this.curIndex])}},i.prototype.dispose=function(){this.dc()},e.VMapView=i}(VIS,jQuery)},7648:()=>{!function(e,t){e.Logging.Level;var i=e.Application.contextUrl,a=i+"JsonData/JDataSetWithCode";function s(e,i,s){var n=null;return t.ajax({url:a,type:"POST",datatype:"json",contentType:"application/json; charset=utf-8",async:i,data:JSON.stringify(e)}).done((function(e){n=e,s&&s(e)})),n}var n=document.querySelector("#vis-ad-windowtmp").content;function o(){this.name,this.windowNo,this.id,this.img=null,this.cPanel,this.isHeaderVisible=!0,this.onClosed,this.title="window",this.closeable=!0;var i,a,s,o,r,l=null,d=null;this.onLoad=null,r=document.importNode(n,!0),i=t(r.querySelector(".vis-ad-w")),a=i.find(".vis-ad-w-body"),s=i.find("h5"),o=i.find(".vis-ad-w-close"),d=i.find(".vis-ad-w-toolbar"),l=i.find(".vis-ad-w-header"),this.setTitle=function(e){this.title=e,s.text(this.title)},this.setSize=function(e,t){},this.hideHeader=function(e){this.isHeaderVisible=!e,e?l.hide():l.show(),this.sizeChanged()},this.hideCloseIcon=function(e){e?(o.hide(),this.closeable=!1):(o.show(),this.closeable=!0)},this.isCloseable=function(e){return this.closeable},this.getRootLayout=function(){return i},this.getContentGrid=function(){return a},this.setToolbar=function(e){d.append(e)};var c=this;o.on(e.Events.onTouchStartOrClick,(function(e){e.preventDefault(),e.stopPropagation(),c.dispose()})),this.disposeComponent=function(){c=null,o&&o.off(e.Events.onTouchStartOrClick),o=null,i&&i.remove(),a&&a.remove(),i=a=s=o=null,this.setTitle=null,this.name=null,this.windowNo=null,this.id=null,this.setTitle=null,this.setName=null,this.getRootLayout=null,this.getContentGrid=null,this.onLoad=null}}function r(i){if(i){this.action,this.toggle,this.enableDisable,this.pressed,this.isEnabled=!0,this.text,this.toolTipText,this.imageOnly,this.textOnly,this.onAction=null,this.isSmall,this.iconName="",this.direction="right",t.extend(!0,this,i),this.items={},this.$li,this.text||(this.text=e.I18N.getLabel(this.action),this.text.contains("&")&&(this.text=this.text.replace("&","")),this.toolTipText?this.toolTipText=this.text+e.Msg.getMsg(this.toolTipText):this.toolTipText=this.text,this.toolTipText.contains("&")&&(this.toolTipText=this.text+this.toolTipText.replace("&","")));var a="",s="";this.isSmall,a=""!=this.iconName?this.iconName.toLowerCase():this.action.toLowerCase(),(this.toggle||this.enableDisable)&&(s=a+"x"),this.imgUrl="vis-"+a,this.imgUrlX="vis-"+s}var n=this;this.getListItm=function(i){var a=t("<li>"),s=t("<div></div>"),o=!0,r=!1;return"Save"!=this.action&&"New"!=this.action||a.on("mousedown touchstart",(function(e){r=!0,window.setTimeout((function(e){r&&a.trigger("click")}),1e3)})),a.on(e.Events.onClick,(function(e){r=!1,e.stopPropagation(),o&&n.onAction&&n.isEnabled&&(n.toggle&&n.setPressed(!n.pressed),o=!1,s.css("background-color","red"),setTimeout((function(){s.css("background-color","transparent"),n.onAction(n.action),o=!0}),10))})),this.textOnly?a.append(t("<h5>").text(this.text)):this.imageOnly?(this.img=t('<i class="vis '+this.imgUrl+'" title = "'+this.toolTipText+'">'),a.append(s),s.append(this.img)):("r"==this.direction?a.append("<span>"+this.text+'</span> <i class="vis '+this.imgUrl+'" title="'+this.toolTipText+'" ></i>'):a.append('<i class="vis '+this.imgUrl+'" title="'+this.toolTipText+'"></i><span>'+this.text+"</span>"),this.img=a.find("i")),this.$li=a,a.popover,i&&(this.items[i]=a),this.$li},this.getListItmIT=function(i){if(this.$li)return this.$li;var a=t("<li>"),s=t("<div></div>"),o=!0;return a.on(e.Events.onClick,(function(e){e.stopPropagation(),o&&n.onAction&&n.isEnabled&&(n.toggle&&n.setPressed(!n.pressed),o=!1,s.css("background-color","red"),setTimeout((function(){s.css("background-color","transparent"),n.onAction(n.action),o=!0}),10))})),this.textOnly?a.text(this.text):this.imageOnly?(this.img=t('<i class="vis '+this.imgUrl+'" title = "'+this.toolTipText+'">'),a.append(s),s.append(this.img)):("r"==this.direction?a.append("<span>"+this.text+'</span> <i class="vis '+this.imgUrl+'" title="'+this.toolTipText+'" ></i>'):a.append('<i class="vis '+this.imgUrl+'" title="'+this.toolTipText+'" ></i><span>'+this.text+"</span>"),this.img=a.find("i")),this.$li=a,i&&(this.items[i]=a),this.$li},this.disposeComponent=function(){n=null,this.getListItm=null,this.getListItmIT=null}}o.prototype.setName=function(e){this.name=e},o.prototype.getName=function(){return this.name},o.prototype.sizeChanged=function(t,i){t||(t=e.Env.getScreenHeight()),i||(i=window.innerWidth);var a=this.isHeaderVisible?85:43;try{this.cPanel.sizeChanged(t-a,i)}catch(e){console.log("size changed error")}},o.prototype.refresh=function(){return this.cPanel.refresh(),this},o.prototype.keyDown=function(e){return this.cPanel.keyDown&&this.cPanel.keyDown(e),this},o.prototype.navigateThroghtShortcut=function(e){var i=t(document.activeElement);if(i&&i.length>0){i.trigger("change");var a=this;window.setTimeout((function(){a.cPanel.navigateThroghtShortcut&&a.cPanel.navigateThroghtShortcut(e)}),200)}else this.cPanel.navigateThroghtShortcut&&this.cPanel.navigateThroghtShortcut(e);return this},o.prototype.initWindow=function(i,a,s,n,o){this.cPanel=new e.APanel,this.getContentGrid().css("display","flex");var r=e.Env.getWindowNo();this.id=r+"_"+i,this.hid=n+"="+i;var l=this;return this.hideHeader(!0),e.AEnv.getGridWindow(r,i,(function(i){if(null!=i.error)return l.hasError=!0,e.ADialog.error(i.error),l.dispose(),void(l=null);var n=t.parseJSON(i.result);e.context.setContextOfWindow(t.parseJSON(i.wCtx),r),l.cPanel.initPanel(n,a,l,!1,o),l.sizeChanged(),l.cPanel.createSearchAutoComplete(),l.cPanel.selectFirstTab(null!=a),e.MLookupCache.initWindowLookup(r);var d=l.cPanel.gridWindow,c=null;c=""!=d.getFontName()?d.getFontName():""!=d.getImageUrl()?e.Application.contextUrl+"Images/Thumb16x16/"+d.getImageUrl():"fa fa-window-maximize",l.img=c,s&&s(l.id,c,l.name,l.hid),l.onLoad&&l.onLoad(),n=null,l=null})),this.AD_Window_ID=i,this.windowNo=r,this.getRootLayout().id=this.id,this.getRootLayout().attr("id","AS_"+this.id),this.getContentGrid().append(this.cPanel.getRoot()),!0},o.prototype.setCFrameContent=function(e,t){this.cPanel=e,this.windowNo=t,this.id=this.windowNo+"_CFrame",this.getRootLayout().id=this.id,this.getRootLayout().attr("id","AS_"+this.id),this.getContentGrid().append(this.cPanel.getRoot())},o.prototype.initForm=function(i,a,s,n){this.cPanel=new e.AForm(e.Env.getScreenHeight()-85);var o=e.Env.getWindowNo();this.id=o+"_"+i,this.hid=s+"="+i;var r=this;return e.dataContext.getFormDataString({AD_Form_ID:i},(function(i){if(null!=i.error)return e.ADialog.error(i.error),r.dispose(),void(r=null);var s=t.parseJSON(i.result);if(s.IsError)return e.ADialog.error(s.Message),r.dispose(),void(r=null);if(r.setTitle(s.DisplayName),r.setName(s.DisplayName),!r.cPanel.openForm(s,r,o,n))return r.dispose(),void(r=null);r.sizeChanged();var l="fa fa-list-alt";r.img=l,a&&a(r.id,l,r.name,r.hid),s=null,r=null})),this.windowNo=o,this.getRootLayout().id=this.id,this.getRootLayout().attr("id","AS_"+this.id),this.getContentGrid().append(this.cPanel.getRoot()),!0},o.prototype.initProcess=function(i,a,s,n,o){this.cPanel=new e.AProcess(i,e.Env.getScreenHeight()-0,n,o);var r=e.Env.getWindowNo();this.id=r+"_"+i,this.hid=s+"="+i;var l=this;return this.hideHeader(!0),e.dataContext.getProcessDataString({AD_Process_ID:i},(function(n){if(null!=n.error)return e.ADialog.error(n.error),l.dispose(),void(l=null);var o=t.parseJSON(n.result);if(o.IsError)return e.ADialog.error(o.Message),l.dispose(),void(l=null);if(l.setTitle(""),l.setName(o.Name),o.AD_Process_ID=i,l.cPanel.setActionOrigin(e.ProcessCtl.prototype.ORIGIN_MENU),!l.cPanel.init(o,l,r))return l.dispose(),void(l=null);l.sizeChanged();var d=null;d=""!=o.FontName?o.FontName:""!=o.ImageUrl?e.Application.contextUrl+"Images/Thumb16x16/"+o.ImageUrl:"P"==s?"fa fa-cog":"vis vis-report",l.img=d,a&&a(l.id,d,l.name,l.hid),o=null,l=null})),this.windowNo=r,this.getRootLayout().id=this.id,this.getRootLayout().attr("id","AS_"+this.id),this.getContentGrid().append(this.cPanel.getRoot()),!0},o.prototype.refreshProcess=function(e,t,i,a,s){return this.cPanel&&(this.cPanel.disposeComponent(),this.cPanel=null),!0,this.initProcess(e,t,i,true,s),s.disposeComponent&&(s.getParameterContainer().empty().append(this.cPanel.getParametersContainer()),this.cPanel.getContentTable().css("height",s.getContentContainer().height()),s.getContentContainer().empty().append(this.cPanel.getContentTable()).append(this.cPanel.getBusyIndicator()).css("position","relative"),s.getToolbarContainer().empty().append(this.cPanel.getToolbar())),this.cPanel},o.prototype.getProcessPanel=function(){return this.cPanel},o.prototype.getTitile=function(){return this.title},o.prototype.getAD_Window_ID=function(){return this.AD_Window_ID},o.prototype.show=function(e,t){return e.append(this.getRootLayout()),t&&t(this.id,null,this.name,this.hid),!0},o.prototype.refreshData=function(){this.cPanel.refreshData()},o.prototype.getId=function(){return this.id},o.prototype.getWindowNo=function(){return this.windowNo},o.prototype.dispose=function(){if(this.closeable&&(!this.onClosed||this.onClosed(this.id,this.$layout,this.hid,this.AD_Window_ID)))return this.onClosed=null,this.cPanel&&this.cPanel.dispose(),this.cPanel=null,this.children=null,this.disposeComponent(),!0},r.prototype.setPressed=function(e){this.toggle&&this.pressed!=e&&(this.pressed=e,this.img&&this.toggle&&(e?(this.img.removeClass(this.imgUrl),this.img.addClass(this.imgUrlX)):(this.img.removeClass(this.imgUrlX),this.img.addClass(this.imgUrl))))},r.prototype.setTextDirection=function(e){this.direction=e},r.prototype.getIsPressed=function(){return this.pressed},r.prototype.getAction=function(){return this.action},r.prototype.getPath=function(){return e.Application.contextUrl+"Areas/VIS/Images/base/"},r.prototype.getSeprator=function(e,t){var i=this.getPath();return i+=e?"seprator16.png":"seprator24.png",t?"<li>|</li>":'<li><img src="'+i+'"></li>'},r.prototype.setEnabled=function(e){this.isEnabled=e,this.$li&&this.$li.css("opacity",e?1:.6),this.img&&this.img.prop("disabled",!e).css("opacity",e?1:.6)},r.prototype.highlightNewButton=function(t){if(t){if(this.$li.instructionPopRemoved)return;this.windowContainer||(this.windowContainer=this.$li.closest(".vis-ad-w-p")),this.windowContainer.find(".vis-window-instruc-overlay-new").length<=0&&(this.windowContainer.prepend('<div class="vis-window-instruc-overlay-new"><div class="vis-window-instruc-overlay-new-inn"><p>'+e.Msg.getMsg("CreateNewRec")+"</p></div></div>"),this.$li.addClass("vis-window-instruc-overlay-new-li"))}else this.windowContainer||(this.windowContainer=this.$li.closest(".vis-ad-w-p")),this.windowContainer.find(".vis-window-instruc-overlay-new").remove(),this.windowContainer.find(".vis-window-instruc-overlay-new-inn").remove(),this.$li.removeClass("vis-window-instruc-overlay-new-li"),this.$li.instructionPopRemoved=!0},r.prototype.show=function(){this.$li&&this.$li.show(),this.img&&this.img.show()},r.prototype.hide=function(){this.$li&&this.$li.hide(),this.img&&this.img.hide()},r.prototype.getItem=function(){return this.$li},r.prototype.getIsEnabled=function(){return this.isEnabled},r.prototype.dispose=function(t){if(this.action=this.toggle=this.pressed=this.isEnabled=this.text=this.toolTipText=this.imageOnly=null,this.textOnly=this.onAction=this.isSmall=null,this.$li&&(this.$li.off(e.Events.onClick),this.$li.remove(),this.$li=null),this.img&&(this.img=null),t&&t in this.items){var i=this.items[t];i&&(i.off(e.Events.onClick),i.remove(),i=null),delete this.items[t]}this.disposeComponent()},r.prototype.setIsRo;var l=document.querySelector("#vis-ad-statusbartmp").content;function d(i){var a=document.importNode(l,!0),s=t(a.querySelector(".vis-ad-w-p-s-main"));this.$statusLine=s.find(".vis-ad-w-p-s-msg").find("span"),this.$statusDB=s.find(".vis-ad-w-p-s-statusdb"),this.$infoLine=s.find(".vis-ad-w-p-s-infoline");var n=s.find(".vis-ad-w-p-s-result").find("span"),o=t("<select class='vis-statusbar-combo'>"),r=s.find(".vis-ad-w-p-s-plst");this.text="",this.dse,this.merror,this.mtext;var d=e.Msg.getMsg("ShowingResult"),c=e.Msg.getMsg("of");this.onComboChange,i||this.$infoLine.hide(),this.getRoot=function(){return s},this.render=function(){},this.setPageItem=function(e){r.append(e)},this.setComboPage=function(){r.append(t("<li>").append(o))},this.setPageLine=function(e){if(null!=e){var t=e.getCurrentPage(),i=e.getTotalPage(),a=e.getPageSize(),s=e.getTotalRecords(),r=(t-1)*a,l=r+a;l>s&&(l=s),0==s&&(r-=1);var h=d+" "+(r+1)+"-"+l+" "+c+" "+e.getTotalRecords();if(n.text(h),i!=o[0].options.length){for(var u=[],p=0;p<i;p++)u[p]="<option>"+(p+1)+"</option>";o.empty(),o.html(u.join(""))}o[0].selectedIndex!=t-1&&(o[0].selectedIndex=t-1)}},this.setComboCallback=function(e){selectionCallback=e};var h=this;o.on("change",(function(e){e.stopPropagation(),h.onComboChange&&h.onComboChange(this.selectedIndex)})),this.$statusDB.on("click",(function(){var t=e.Msg.getMsg("Who")+h.text;new e.RecordInfo(t,h.dse).show()})),this.disposeComponent=function(){h=null,s.remove(),r1Col1=null,r2Col1=null,s=null,this.getRoot=null,this.onComboChange=null,r.remove(),r=null,n=null,this.$statusLine=null,this.$statusDB=null,$seprator=null,this.disposeComponent=null,this.setPageItem=null,this.getRoot=null,this.render=null,this.setPageLine=null,this.$infoLine=null,this.text=null,this.dse=null,this.merror=null,this.mtext=null,o.empty(),o.remove(),o=null}}d.prototype.setStatusDB=function(e,t){null==e||0==e.length?this.$statusDB.text(""):this.$statusDB.text(e),this.text=e,this.dse=t,this.setPageLine(t)},d.prototype.setStatusLine=function(e,t){this.merror=t,this.mtext=e,this.$statusLine.text(e)},d.prototype.setInfo=function(e){this.$infoLine.is(":visible")||this.$infoLine.show(),this.$infoLine.text(e)},d.prototype.dispose=function(){this.disposeComponent()},e.AParentDetail=function(i,a){this.gc=i,this.$root=a,this.visible=!1,this.expaned=!1,this.curGC=null;var s,n,o,r,l,d=i.getMTab().getTableModel().getFields(),c=d.length,h=null;h=t("<div class='vis-apanel-bar'>"),s=t("<div class='vis-apanel-bar-fixpart' style='background-color:white'>"),n=t("<div class='vis-apanel-bar-varpart vis-apanel-bar-pdetail'>"),o=t('<div class="vis-apanel-lb-main">'),(r=t("<div class='vis-apanel-lb-oflow' style='border-left: 1px solid white;'>").hide()).html("<a data-dir='u' href='javascript:void(0)'><img style='margin-left:10px' data-dir='u' src='"+e.Application.contextUrl+"Areas/VIS/Images/base/arrow-top.png' ></a><a data-dir='d' href='javascript:void(0)' ><img style='margin-left:10px' data-dir='d' src='"+e.Application.contextUrl+"Areas/VIS/Images/base/arrow-bottom.png' /></a>"),n.append(o).append(r),l=t("<div style='width:192px;overflow-y:auto;padding-left: 4px;padding-right:3px;'>"),o.append(l),h.append(n).append(s),a.append(h),h.hide();var u=this;function p(){for(var t=null,a="",s="",n=0;n<c;n++)if(s=null,(s=(t=d[n]).getValue())&&""!=s&&t.getIsDisplayed()){a+="<h3>"+w2utils.encodeTags(t.getHeader())+"</h3>";var o=t.getDisplayType();if(t.lookup)s=t.lookup.getDisplay(s,!0);else if(e.DisplayType.IsDate(o))s=new Date(s).toLocaleString();else if(o==e.DisplayType.YesNo){var r=s.toString();t.getIsEncryptedColumn()&&(r=e.secureEngine.decrypt(r)),s=r.equals("Y")}else s=s.toString();t.getIsEncryptedColumn()&&o!=e.DisplayType.YesNo&&(s=e.secureEngine.decrypt(s)),a+="<h5>"+w2utils.encodeTags(s)+"</h5>"}l.empty(),l.html("<h1>"+i.getMTab().getName()+"</h1>"+a),u.setSize(h.height())}function g(){u.curGC&&(u.curGC.multiRowResize(),u.curGC.aPanel.setWidth(-1,!0),u.curGC.aPanel.setTabNavigation())}function f(){p(),u.curGC&&(u.curGC.multiRowResize(),u.curGC.aPanel.setWidth(-1,!0),u.curGC.aPanel.setTabNavigation())}s.on(e.Events.onTouchStartOrClick,(function(e){u.$root.width()>20?u.hide():u.show(),e.stopPropagation()})),r.on("click",(function(e){e.stopPropagation();var i=t(e.target).data("dir");if(i){var a=o.height(),s=l.height(),n=o.scrollTop(),r=Math.ceil(a/2),d=0;if("d"==i){if(n+r>=s-r)return;var c=s-a;d=n+r,o.animate({scrollTop:d>c?c:d},1e3,"easeOutBounce")}else if("u"==i){if(0==n)return;d=n-r,o.animate({scrollTop:d<0?0:d},1e3,"easeOutBounce")}}})),this.show=function(){u.expaned?p():(this.expaned=!0,u.visible&&h.show(),a.animate({width:"200px"},300,"swing"),n.show().animate({width:"192px"},300,"swing",f))},this.hide=function(){!this.expaned&&this.visible||(this.expaned=!1,a.animate({width:u.visible?"8px":"0px"},300,"swing"),u.visible||h.hide(),n.hide().animate({width:"0px"},300,"swing",g))},this.setSize=function(t){h.height(t),o.height(t),l.height()>o.height()&&(e.Application.isMobile||(o.height(t-40),r.show()))},this.disposeComponenet=function(){this.gc=null,this.$root=null,this.visible=null,this.expaned=null,r.off("click"),s.off(e.Events.onTouchStartOrClick),s=n=null,h.remove(),h=null,u=null,this.curGC=null,d.length=0,d=null,this.show=null,this.hide=null}},e.AParentDetail.prototype.evaluate=function(e){if(this.curGC=null,this.curGC=e,this.gc.getId()===e.getId())this.visible=!1,this.hide();else{if(this.curGC.isParentDetailVisible=!0,this.visible)return;this.visible=!0,this.show()}},e.AParentDetail.prototype.dispose=function(){this.disposeComponenet()},e.VSortTab=function(i,a,s,n,o,r){var l,d,c,h,u,p,g,f,v;this.winNumber=i,this.tableName=null,this.columnSortName=null,this.columnYesNoName=null,this.keyColumnName=null,this.identifierColumnName=null,this.identifierTranslated=!1,this.parentColumnName=null,this.AD_Table_ID=a,this.AD_ColumnSortOrder_ID=s,this.AD_ColumnSortYesNo_ID=n,this.aPanel=null,this.log=e.Logging.VLogger.getVLogger("VSortTab");e.Application.contextUrl;var m=null;!function(){d=t("<span>").text(e.Msg.getMsg("N")),c=t("<span>").text(e.Msg.getMsg("Y")),h=t("<ul class='vis-sortTab-select' "+(o?" disabled":"")+">"),u=t("<ul class='vis-sortTab-select' "+(o?" disabled":"")+" >"),g=t("<button"+(o?" disabled":"")+" ><i class='fa fa-arrow-left'></i></button"),p=t("<button"+(o?" disabled":"")+" ><i class='fa fa-arrow-right'></i></button"),f=t("<button"+(o?" disabled":"")+" ><i class='fa fa-arrow-up'></i></button"),v=t("<button"+(o?" disabled":"")+" ><i class='fa fa-arrow-down'></i></button"),l=t("<table class='vis-apanel-sorttab' style='display:none;'>");var i=t("<td class='vis-apanel-sorttab-td'>"),a=t('<div class="vis-apanel-sorttab-cont">');a.append(h).append(t("<div class='vis-apanel-sorttab-td-right'>").append(p).append(g)),i.append(t("<div class='vis-apanel-sorttab-td-inner'>").append(d).append(a));var s=t('<div class="vis-apanel-sorttab-cont">');s.append(u).append(t("<div class='vis-apanel-sorttab-td-right'>").append(f).append(v)),i.append(t("<div class='vis-apanel-sorttab-td-inner'>").append(c).append(s)),l.append(t("<tr>").append(i))}(),this.dynInit(a,s,n),this.getRoot=function(){return l},this.getId=function(){return r},this.getlstModel=function(e){return e?u.find("li"):h.find("li")},this.setLabelName=function(e,t){d.text(e),c.text(t)},this.setListOptions=function(e,t){h.empty(),h.append(e),u.empty(),u.append(t)},this.setOldValues=function(e){m=e},this.getOldValues=function(){return m};var b=this;g.on(e.Events.onTouchStartOrClick,(function(e){b.btn_Click("Left"),e.stopPropagation()})),p.on(e.Events.onTouchStartOrClick,(function(e){b.btn_Click("Right"),e.stopPropagation()})),f.on(e.Events.onTouchStartOrClick,(function(e){b.btn_Click("Up"),e.stopPropagation()})),v.on(e.Events.onTouchStartOrClick,(function(e){b.btn_Click("Down"),e.stopPropagation()})),h.on(e.Events.onClick,"LI",(function(){t(this).toggleClass("vis-apanel-sorttab-selected")})),u.on(e.Events.onClick,"LI",(function(){t(this).toggleClass("vis-apanel-sorttab-selected")})),this.btn_Click=function(e){var i=!1,a=null;if("Right"==e){a=h.find("li.vis-apanel-sorttab-selected"),u.children().removeClass("vis-apanel-sorttab-selected");for(var s=0;s<a.length;s++)a[s].remove(),t(a[s]).toggleClass("vis-apanel-sorttab-selected"),u.append(a[s]),i=!0;a.length=0,a=0}else if("Left"==e){a=u.find("li.vis-apanel-sorttab-selected"),h.children().removeClass("vis-apanel-sorttab-selected");for(var n=0;n<a.length;n++)a[n].remove(),t(a[n]).toggleClass("vis-apanel-sorttab-selected"),h.append(a[n]),i=!0;a.length=0,a=0}else{if(null==(a=u.find("li.vis-apanel-sorttab-selected")))return;if(0==a.length)return;var o=t(a[0]);if(null==o)return;u.children().removeClass("vis-apanel-sorttab-selected"),o.addClass("vis-apanel-sorttab-selected");var r=o.index();if("Up"==e){if(0==r)return;o.remove(),o.insertBefore(u.find("li").eq(r-1)),i=!0}else if("Down"==e){if(r>=u.children().length-1)return;o.remove(),o.insertAfter(u.find("li").eq(r)),i=!0}}i&&this.notifyFireChanged(!0)},this.disposeComponent=function(){g.off(e.Events.onTouchStartOrClick),p.off(e.Events.onTouchStartOrClick),f.off(e.Events.onTouchStartOrClick),v.off(e.Events.onTouchStartOrClick),this.seletedTab=null,l.remove(),l=null,b=null,this.winNumber=null,this.tableName=null,this.columnSortName=null,this.columnYesNoName=null,this.keyColumnName=null,this.identifierColumnName=null,this.identifierTranslated=!1,this.parentColumnName=null,this.aPanel=null,this.log=null,h=null,u=null,f=v=g=p=null,this.btn_Click=this.setListOptions=this.getlstModel=this.setLabelName=this.setListOptions=this.getRoot=this.getId=null,console.log("dispose vSortTab")}},e.VSortTab.prototype.notifyFireChanged=function(e){this.aContentPane?this.aContentPane.aSave.setEnabled(e):this.aPanel&&this.aPanel.aSave.setEnabled(e)},e.VSortTab.prototype.dynInit=function(t,i,a){var n=!e.Env.isBaseLanguage(e.Env.getCtx(),""),o="VIS_122",r=[];r[0]=new e.DB.SqlParam("@AD_Table_ID",t),r[1]=new e.DB.SqlParam("@AD_ColumnSortOrder_ID",i),r[2]=new e.DB.SqlParam("@AD_ColumnSortYesNo_ID",a),n&&(o="VIS_123",(r=[])[0]=new e.DB.SqlParam("@AD_Table_ID",t),r[1]=new e.DB.SqlParam("@AD_ColumnSortOrder_ID",i),r[2]=new e.DB.SqlParam("@AD_ColumnSortYesNo_ID",a),r[3]=new e.DB.SqlParam("@AD_Language",e.Env.getAD_Language(e.Env.getCtx())));var l=this;!function(t,i,a){var n=!!a,o={sql:t,page:1,pageSize:0};i&&(o.param=i);var r=null;s(o,n,(function(t){r=(new e.DB.DataReader).toJson(t),a&&a(r)}))}(o,r,(function(t){if(null!=t){for(var s="";t.read();)l.tableName=t.getString(0),i==t.get(1)?(l.columnSortName=t.getString(2),s=t.getString(3)):a==t.get(1)?l.columnYesNoName=t.getString(2):"Y"==t.getString(4)?l.parentColumnName=t.getString(2):"Y"==t.getString(5)?l.keyColumnName=t.getString(2):"Y"==t.getString(6)&&(l.identifierColumnName=t.getString(2),n&&(l.identifierTranslated="Y"==t.getString(7)));t.close(),l.setLabelName(e.Msg.getMsg("Available"),s)}l=null}))},e.VSortTab.prototype.setVisible=function(e){e?this.getRoot().show():this.getRoot().hide()},e.VSortTab.prototype.loadData=function(){var t=e.Env.getCtx().getWindowContext(this.winNumber,this.parentColumnName),i=e.dataContext.getJSONData(e.Application.contextUrl+"Form/LoadSortData",{AD_Table_ID:this.AD_Table_ID,AD_ColumnSortOrder_ID:this.AD_ColumnSortOrder_ID,AD_ColumnSortYesNo_ID:this.AD_ColumnSortYesNo_ID,AD_Language:e.Env.getAD_Language(e.Env.getCtx()),ID:t,isTrl:!e.Env.isBaseLanguage(e.Env.getCtx(),"")},null),a=(new e.DB.DataReader).toJson(JSON.stringify(i)),s="",n="",o=[];try{for(;a.read();){var r=a.get(0),l=a.getString(1),d=a.get(2),c=0!=d;null!=this.columnYesNoName&&(c="Y"==a.getString(3));var h="<li data-value='"+r+"'>"+l+"</li>";c?(s+=h,o.push({key:r,value:d})):(n+=h,o.push({key:r,value:d}))}a.close(),a.dispose(),this.setOldValues(o),this.setListOptions(n,s)}catch(t){this.log.log(e.Logging.Level.SEVERE,sql,t)}this.notifyFireChanged(!1)},e.VSortTab.prototype.getIsEnabled=function(){var e=!1;return this.aContentPane?e=this.aContentPane.aSave.getIsEnabled():this.aPanel&&(e=this.aPanel.aSave.getIsEnabled()),e},e.VSortTab.prototype.saveData=function(){if(this.getIsEnabled()){var i=this.getlstModel(),a=this.tableName,s=this.columnSortName,n=this.columnYesNoName,o=this.keyColumnName,r=[],l=[];i.each((function(e,i){r.push(t(i).data("value")),l.push("N")})),this.getlstModel(!0).each((function(e,i){r.push(t(i).data("value")),l.push("Y")})),t.ajax({url:e.Application.contextUrl+"Form/SetFieldsSorting",async:!1,type:"POST",data:{values:JSON.stringify(r),noYes:JSON.stringify(l),tableName:a,keyColumnName:o,columnSortName:s,columnYesNoName:n,oldValues:JSON.stringify(this.getOldValues())},success:function(e){},error:function(e){}})}},e.VSortTab.prototype.unRegisterAPanel=function(){this.saveData(),this.aPanel=null},e.VSortTab.prototype.registerAPanel=function(e){this.aPanel=e},e.VSortTab.prototype.addSubTabDataStatusListner=function(e){this.aContentPane=e},e.VSortTab.prototype.removeSubTabDataStatusListner=function(){this.aContentPane=null},e.VSortTab.prototype.sizeChanged=function(e,t){this.getRoot().height(e)},e.VSortTab.prototype.dispose=function(){this.disposeComponent()},e.RecordInfo=function(i,a){var s=i,n=(e.Logging.VLogger.getVLogger("VIS.RecordInfo"),t("<div style='min-width:550px;max-width:600px'>")),o=null,r={CreatedBy:a.CreatedBy,Created:a.Created,Updated:a.Updated,UpdatedBy:a.UpdatedBy,Info:a.Info,AD_Table_ID:a.AD_Table_ID,Record_ID:a.Record_ID};e.dataContext.getJSONData(e.Application.contextUrl+"JsonData/GetRecordInfo",{dse:r},(function(e){if(n.html("<span>"+e.Info+"</span>"),e.ShowGrid){var i=t("<table class='vis-advancedSearchTable'>"),a=t("<div class='vis-advancedSearchTableWrap vis-table-responsive' style='max-height:200px;overflow-y:auto'>").append(i);n.append(a);for(var s="",o="",r=null,l=0,d=e.Rows.length;l<d;l++){if(0==l){s+='<thead><tr class="vis-advancedSearchTableHead">';for(var c=0;c<e.Headers.length;c++)s+="<th>"+e.Headers[c]+"</th>";s+="</tr></thead><tbody>"}o='<tr class="vis-advancedSearchTableRow">',o+="<td>"+(r=e.Rows[l]).AD_Column_ID+"</td><td>"+r.NewValue+"</td><td>"+r.OldValue+"</td><td>"+r.UpdatedBy+"</td><td>"+Globalize.format(new Date(r.Updated),"f")+"</td>",s+=o+="</tr>"}s+="</tbody>",i.html(s)}})),this.show=function(){(o=new e.ChildDialog).setTitle(s),o.setContent(n),o.setPosition({my:"center bottom-3"}),o.close=function(){null,null,n.remove(),n=null},o.show()}},e.AWindow=o,e.AppsAction=r,e.StatusBar=d}(VIS,jQuery)}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";i(3502),i(7428),i(7648),i(1895),i(6251),i(8789),i(7043),i(5155),i(7670),i(7529),i(4072),i(6863),i(7893),i(2496)})()})();